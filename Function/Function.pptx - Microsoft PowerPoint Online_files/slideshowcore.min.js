/*! For license information please see SlideShowCore.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SlideShowCore=t():e.SlideShowCore=t()}(window,(function(){return function(e){function t(t){for(var r,n,a=t[0],o=t[1],s=0,c=[];s<a.length;s++)n=a[s],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&c.push(i[n][0]),i[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(l&&l(t);c.length;)c.shift()()}var r={},i={8:0};function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,n){r=i[e]=[t,n]}));t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({12:"vendors.DOMPurify",13:"vendors.HLS",14:"vendors.officeonlineotel",15:"vendors.officeonlineqossmall"}[e]||e)+".bundle.js"}(e);var l=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(c);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",l.name="ChunkLoadError",l.type=n,l.request=a,r[1](l)}i[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpSscore=window.webpackJsonpSscore||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=o;return n(n.s=79)}([function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(145);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(276);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(150);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(149);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(147);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(278);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(148);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var u=r(73);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}));var d=r(279);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}));var h=r(146);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})}));var f=r(280);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})}));var m=r(112);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(284);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}))},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){e.exports=r(212)},function(e,t){function r(e,t,r,i,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(i,n)}e.exports=function(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var o=e.apply(t,i);function s(e){r(o,n,a,s,l,"next",e)}function l(e){r(o,n,a,s,l,"throw",e)}s(void 0)}))}}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){var i=r(15),n=r(219);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?n(e):t}},function(e,t,r){var i=r(102);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(24);i.__exportStar(r(282),t),i.__exportStar(r(283),t)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getNearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))},t.getGreaterPowerOfTwo=function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))},t.clamp=function(e,t,r){return Math.min(r,Math.max(t,e))},t.inverseLerp=function(e,t,r){var i=(r-e)/(t-e);return Math.min(Math.max(i,0),1)},t.mix=f,t.measureQuadraticLength=m,t.getQuadraticParameterForDistance=p,t.interpolateAngle=function(e,t,r,i){var n=(t-e)/(2*Math.PI);return n-=Math.floor(n),(i&&n>0||null==i&&n>.5)&&n--,f(e,e+n*(2*Math.PI),r)},t.equals=function(e,t){return e==t||null!=e&&null!=t&&e.equals(t)},t.ClipBounds=t.Rect=t.Transform=t.Matrix3=t.Vector3=t.Vector2=t.AlignmentType=t.epsilon=void 0;var n,a=i(r(1)),o=i(r(2));t.epsilon=.001,t.AlignmentType=n,function(e){e[e.topLeft=0]="topLeft",e[e.top=1]="top",e[e.topRight=2]="topRight",e[e.left=3]="left",e[e.center=4]="center",e[e.right=5]="right",e[e.bottomLeft=6]="bottomLeft",e[e.bottom=7]="bottom",e[e.bottomRight=8]="bottomRight"}(n||(t.AlignmentType=n={}));var s=function(){function e(t,r){(0,a.default)(this,e),this.x=t,this.y=r}return(0,o.default)(e,[{key:"negate",value:function(){return new e(-this.x,-this.y)}},{key:"inverse",value:function(){return new e(1/this.x,1/this.y)}},{key:"normalized",value:function(){var e=this.length();return e?this.scale(1/e):void 0}},{key:"abs",value:function(){return new e(Math.abs(this.x),Math.abs(this.y))}},{key:"floor",value:function(){return new e(Math.floor(this.x),Math.floor(this.y))}},{key:"ceil",value:function(){return new e(Math.ceil(this.x),Math.ceil(this.y))}},{key:"sign",value:function(){return new e(this.x<0?-1:1,this.y<0?-1:1)}},{key:"isZero",value:function(){return 0==this.x&&0==this.y}},{key:"isFinite",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return isFinite(this.x)&&isFinite(this.y)}))},{key:"isFinitePositive",value:function(){return this.isFinite()&&this.x>0&&this.y>0}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"equals",value:function(e){return this.x==e.x&&this.y==e.y}},{key:"equalsWithEpsilon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"multiply",value:function(t){return new e(this.x*t.x,this.y*t.y)}},{key:"divide",value:function(t){return new e(this.x/t.x,this.y/t.y)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"scale",value:function(t){return new e(this.x*t,this.y*t)}},{key:"rotate",value:function(t){return t?new e(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t)):this}},{key:"transformVector",value:function(e){return e.transformVector(this)}},{key:"transformPoint",value:function(e){return e.transformPoint(this)}}],[{key:"Flip",value:function(t,r){return new e(t?-1:1,r?-1:1)}},{key:"Distance",value:function(e,t){return e.subtract(t).length()}},{key:"InterpolateLinear",value:function(e,t,r){return e.add(t.subtract(e).scale(r))}},{key:"InterpolateQuadratic",value:function(t,r,i,n){return e.InterpolateLinear(e.InterpolateLinear(t,r,n),e.InterpolateLinear(r,i,n),n)}},{key:"QuadraticTangent",value:function(t,r,i,n){return e.InterpolateLinear(r,i,n).subtract(e.InterpolateLinear(t,r,n)).normalized()}},{key:"CalculateLineIntersection",value:function(t,r,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001,o=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),s=(n.y-i.y)*(r.x-t.x)-(n.x-i.x)*(r.y-t.y);if(Math.abs(s)>a)return e.InterpolateLinear(t,r,o/s)}},{key:"MeasureQuadraticLength",value:function(e,t,r){return m(e.x,e.y,t.x,t.y,r.x,r.y)}},{key:"GetQuadraticParameterForDistance",value:function(e,t,r,i){return p(e.x,e.y,t.x,t.y,r.x,r.y,i,4)}}])}();t.Vector2=s,s.Zero=new s(0,0),s.One=new s(1,1);var l=(0,o.default)((function e(t,r,i){(0,a.default)(this,e),this.x=t,this.y=r,this.z=i}));t.Vector3=l,l.Zero=new l(0,0,0),l.One=new l(1,1,1);var c=function(){function e(t,r,i,n,o,s,l,c,u){(0,a.default)(this,e),this.m=new Float32Array([t,r,i,n,o,s,l,c,u])}return(0,o.default)(e,[{key:"toMatrix3",value:function(){return this}},{key:"isIdentity",value:function(){return this==e.Identity||this.equals(e.Identity)}},{key:"multiply",value:function(t){var r=this.m,i=t.m;return new e(r[0]*i[0]+r[1]*i[3]+r[2]*i[6],r[0]*i[1]+r[1]*i[4]+r[2]*i[7],r[0]*i[2]+r[1]*i[5]+r[2]*i[8],r[3]*i[0]+r[4]*i[3]+r[5]*i[6],r[3]*i[1]+r[4]*i[4]+r[5]*i[7],r[3]*i[2]+r[4]*i[5]+r[5]*i[8],r[6]*i[0]+r[7]*i[3]+r[8]*i[6],r[6]*i[1]+r[7]*i[4]+r[8]*i[7],r[6]*i[2]+r[7]*i[5]+r[8]*i[8])}},{key:"inverse",value:function(){var t=this.m,r=t[0]*t[4]-t[1]*t[3];return 0==r?void 0:new e(t[4]/r,-t[1]/r,0,-t[3]/r,t[0]/r,0,(t[3]*t[7]-t[4]*t[6])/r,(-t[0]*t[7]+t[1]*t[6])/r,1)}},{key:"transformVector",value:function(e){return new s(e.x*this.m[0]+e.y*this.m[3],e.x*this.m[1]+e.y*this.m[4])}},{key:"transformPoint",value:function(e){return new s(e.x*this.m[0]+e.y*this.m[3]+this.m[6],e.x*this.m[1]+e.y*this.m[4]+this.m[7])}},{key:"isSimpleScaleTranslationOnly",value:function(){return 0==this.m[1]&&0==this.m[2]&&0==this.m[3]&&0==this.m[5]&&1==this.m[8]}},{key:"getSimpleScale",value:function(){return new s(this.m[0],this.m[4])}},{key:"getSimpleTranslation",value:function(){return new s(this.m[6],this.m[7])}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(this.m[t]!=e.m[t])return!1;return!0}},{key:"tryGetTransform",value:function(e){var t=this.transformVector(new s(1,0)),r=this.transformVector(new s(0,1));if(!(Math.abs(t.x*r.x+t.y*r.y)>.001)){var i=t.x*r.y-t.y*r.x>0?new s(t.length(),r.length()):new s(t.length(),-r.length()),n=t.y>0?Math.acos(t.x/i.x):-Math.acos(t.x/i.x),a=this.transformPoint(e.negate());return new u(e,i,n,a)}}}],[{key:"Translation2D",value:function(t){return new e(1,0,0,0,1,0,t.x,t.y,1)}},{key:"Scale2D",value:function(t){return new e(t.x,0,0,0,t.y,0,0,0,1)}},{key:"ScaleTranslation2D",value:function(t,r){return new e(t.x,0,0,0,t.y,0,r.x,r.y,1)}},{key:"RotationZ",value:function(t){var r=Math.cos(t),i=Math.sin(t);return new e(r,i,0,-i,r,0,0,0,1)}},{key:"RotationAroundPoint",value:function(e,t){return new u(t.negate(),s.One,e,t).toMatrix3()}},{key:"FromTransforms",value:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(0==r.length)return e.Identity;for(var n=r[0].toMatrix3(),a=1;a<r.length;a++)n=n.multiply(r[a].toMatrix3());return n}}])}();t.Matrix3=c,c.Identity=new c(1,0,0,0,1,0,0,0,1);var u=function(){function e(t,r,i,n){(0,a.default)(this,e),this.preTranslation=t||s.Zero,this.scale=r||s.One,this.rotation=null!=i?i:0,this.translation=n||s.Zero}return(0,o.default)(e,[{key:"toMatrix3",value:function(){var e=Math.cos(this.rotation),t=Math.sin(this.rotation),r=this.scale.x*e,i=this.scale.x*t,n=this.scale.y*-t,a=this.scale.y*e;return new c(r,i,0,n,a,0,this.preTranslation.x*r+this.preTranslation.y*n+this.translation.x,this.preTranslation.y*a+this.preTranslation.x*i+this.translation.y,1)}},{key:"isIdentity",value:function(){return this==e.Identity||this.equals(e.Identity)}},{key:"toInverseMatrix3",value:function(){var e=Math.cos(-this.rotation),t=Math.sin(-this.rotation),r=e/this.scale.x,i=t/this.scale.y,n=-t/this.scale.x,a=e/this.scale.y;return new c(r,i,0,n,a,0,-this.translation.x*r-this.translation.y*n-this.preTranslation.x,-this.translation.y*a-this.translation.x*i-this.preTranslation.y,1)}},{key:"transformVector",value:function(e){return e.multiply(this.scale).rotate(this.rotation)}},{key:"transformPoint",value:function(e){return e.add(this.preTranslation).multiply(this.scale).rotate(this.rotation).add(this.translation)}},{key:"applyScaleAndTranslationBefore",value:function(t,r){return new e(this.preTranslation.add(r).divide(t),this.scale.multiply(t),this.rotation,this.translation)}},{key:"applyTranslationAfter",value:function(t){return new e(this.preTranslation,this.scale,this.rotation,this.translation.add(t))}},{key:"equals",value:function(e){return this.preTranslation.equals(e.preTranslation)&&this.scale.equals(e.scale)&&this.rotation==e.rotation&&this.translation.equals(e.translation)}}],[{key:"fromScaleAndTranslation",value:function(t,r){return new e(void 0,t,void 0,r)}},{key:"fromTransformAndPretranslation",value:function(t,r){return new e(r,t.scale,t.rotation,t.translation)}},{key:"fromTransformAndScale",value:function(t,r){return new e(t.preTranslation,r,t.rotation,t.translation)}},{key:"fromTransformAndRotation",value:function(t,r){return new e(t.preTranslation,t.scale,r,t.translation)}},{key:"fromTransformAndTranslation",value:function(t,r){return new e(t.preTranslation,t.scale,t.rotation,r)}}])}();t.Transform=u,u.Identity=new u;var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,a.default)(this,e),this.left=t,this.top=r,this.right=i,this.bottom=n}return(0,o.default)(e,[{key:"isEmpty",value:function(){return this.left==this.right&&this.top==this.bottom}},{key:"isValid",value:function(){return this.left<=this.right&&this.top<=this.bottom}},{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"size",get:function(){return new s(this.right-this.left,this.bottom-this.top)}},{key:"center",get:function(){return new s((this.left+this.right)/2,(this.top+this.bottom)/2)}},{key:"leftTop",get:function(){return new s(this.left,this.top)}},{key:"rightBottom",get:function(){return new s(this.right,this.bottom)}},{key:"isPointInRect",value:function(e){return this.left<=e.x&&e.x<=this.right&&this.top<=e.y&&e.y<=this.bottom}},{key:"equals",value:function(e){return this.left==e.left&&this.top==e.top&&this.right==e.right&&this.bottom==e.bottom}},{key:"inflate",value:function(t){return new e(this.left-t,this.top-t,this.right+t,this.bottom+t)}},{key:"inflateToInteger",value:function(){return new e(Math.floor(this.left),Math.floor(this.top),Math.ceil(this.right),Math.ceil(this.bottom))}},{key:"multiply",value:function(t){return e.FromPoints(this.leftTop.multiply(t),this.rightBottom.multiply(t))}},{key:"divide",value:function(t){return e.FromPoints(this.leftTop.divide(t),this.rightBottom.divide(t))}},{key:"translate",value:function(t){return new e(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}},{key:"transformedBounds",value:function(t){for(var r=void 0,i=[new s(this.left,this.top),new s(this.right,this.top),new s(this.right,this.bottom),new s(this.left,this.bottom)],n=0;n<4;n++)r=e.UnionPoint(r,i[n].transformPoint(t));return r}},{key:"relativeToAbsolute",value:function(e){return new s(f(this.left,this.right,e.x),f(this.top,this.bottom,e.y))}}],[{key:"FromSize",value:function(t){return new e(0,0,t.x,t.y)}},{key:"FromSizeAndCenter",value:function(t,r){return new e(r.x-.5*t.x,r.y-.5*t.y,r.x+.5*t.x,r.y+.5*t.y)}},{key:"FromPoints",value:function(t,r){return new e(Math.min(t.x,r.x),Math.min(t.y,r.y),Math.max(t.x,r.x),Math.max(t.y,r.y))}},{key:"UnionPoint",value:function(t,r){return t&&t.isValid()?new e(Math.min(t.left,r.x),Math.min(t.top,r.y),Math.max(t.right,r.x),Math.max(t.bottom,r.y)):new e(r.x,r.y,r.x,r.y)}},{key:"UnionRect",value:function(t,r){return t&&r&&t.isValid()&&r.isValid()?new e(Math.min(t.left,r.left),Math.min(t.top,r.top),Math.max(t.right,r.right),Math.max(t.bottom,r.bottom)):t&&t.isValid()?t:r&&r.isValid()?r:void 0}},{key:"IntersectRect",value:function(t,r){if(t&&r&&t.isValid()&&r.isValid()){var i=new e(Math.max(t.left,r.left),Math.max(t.top,r.top),Math.min(t.right,r.right),Math.min(t.bottom,r.bottom));return i.isValid()?i:void 0}}},{key:"SegmentBounds",value:function(t,r){return new e(Math.min(t.x,r.x),Math.min(t.y,r.y),Math.max(t.x,r.x),Math.max(t.y,r.y))}},{key:"QuadraticBezierBounds",value:function(t,r,i){var n;n=e.SegmentBounds(t,i);var a=(t.x-r.x)/(t.x+i.x-2*r.x);0<a&&a<1&&(n=e.UnionPoint(n,s.InterpolateQuadratic(t,r,i,a)));var o=(t.y-r.y)/(t.y+i.y-2*r.y);return 0<o&&o<1&&(n=e.UnionPoint(n,s.InterpolateQuadratic(t,r,i,o))),n}},{key:"InterpolateLinear",value:function(t,r,i){return new e(f(t.left,r.left,i),f(t.top,r.top,i),f(t.right,r.right,i),f(t.bottom,r.bottom,i))}}])}();t.Rect=d,d.Zero=new d(0,0,0,0);var h=function(){function e(t,r,i,n){(0,a.default)(this,e),this.xMin=t,this.yMin=r,this.xMax=i,this.yMax=n}return(0,o.default)(e,[{key:"equals",value:function(e){return this.xMin===e.xMin&&this.yMin===e.yMin&&this.xMax===e.xMax&&this.yMax===e.yMax}},{key:"clip",value:function(e){var t=new d(void 0===this.xMin?e.left:this.xMin,void 0===this.yMin?e.top:this.yMin,void 0===this.xMax?e.right:this.xMax,void 0===this.yMax?e.bottom:this.yMax);return d.IntersectRect(e,t)}}],[{key:"CreateFromRect",value:function(t){return new e(t.left,t.top,t.right,t.bottom)}}])}();function f(e,t,r){return e+(t-e)*r}function m(e,t,r,i,n,a){var o=n-e,s=a-t;if(Math.abs(o*(i-t)-s*(r-e))<.001)return Math.sqrt(o*o+s*s);var l=n-2*r+e,c=a-2*i+t,u=2*r-2*n,d=2*i-2*a,h=4*(l*l+c*c),f=4*(l*u+c*d),m=u*u+d*d,p=2*Math.sqrt(h+f+m),g=Math.sqrt(h),v=2*Math.sqrt(m),y=f/g;return(g*(2*h*p+f*(p-v))+(4*m*h-f*f)*Math.log((2*g+y+p)/(y+v)))/(8*h*g)}function p(e,t,r,i,n,a,o,s){if(s<=0){var l=m(e,t,r,i,n,a);return l>0?o/l:0}var c=.5*e+.5*r,u=.5*t+.5*i,d=.5*r+.5*n,h=.5*i+.5*a,f=.5*c+.5*d,g=.5*u+.5*h,v=m(e,t,c,u,f,g);return o<v?.5*p(e,t,c,u,f,g,o,s-1):.5+.5*p(f,g,d,h,n,a,o-v,s-1)}t.ClipBounds=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Log=t.ExternalCategory=t.ExternalLevel=void 0;var n,a,o=i(r(1)),s=i(r(2));t.ExternalLevel=n,function(e){e[e.Error=10]="Error",e[e.Info=50]="Info"}(n||(t.ExternalLevel=n={})),t.ExternalCategory=a,function(e){e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral"}(a||(t.ExternalCategory=a={}));var l=function(){function e(){(0,o.default)(this,e)}return(0,s.default)(e,null,[{key:"Error",value:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t,r){return e.s_logger.sendTraceTag(t,a.msoulscat_Wac_BrowserGeneral,n.Error,r),new Error(r+" "+t)}))},{key:"Message",value:function(t,r){e.s_logger.sendTraceTag(t,a.msoulscat_Wac_BrowserGeneral,n.Info,r)}},{key:"setLogger",value:function(t){t&&(e.s_logger=t)}}])}();t.Log=l,l.s_logger={sendTraceTag:function(e,t,r,i){console.log(e,i)},shipAssertTag:function(){},debugAssertTag:function(){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(290);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(153);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(154);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(291);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}))},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getBrushImagesFromBrush=j,t.Style=t.PictureFillMode=t.BlendingMode=t.Pen=t.PenTip=t.PenEnd=t.PenLineEndLength=t.PenLineEndWidth=t.PenLineCap=t.PenLineEnd=t.PenAlignment=t.PenCompound=t.LineJoin=t.PenDash=t.SpecialBrush=t.PatternBrush=t.PatternType=t.ImageBrush=t.WrapMode=t.GradientBrush=t.GradientStop=t.SolidBrush=t.Brush=t.BrushType=t.ImageContainer=t.Color=void 0;var n=i(r(18)),a=i(r(9)),o=i(r(8)),s=i(r(10)),l=i(r(19)),c=i(r(1)),u=i(r(2)),d=r(36),h=r(12),f=r(13),m=r(37),p=r(59);function g(e,t,r){return t=(0,o.default)(t),(0,a.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,o.default)(e).constructor):t.apply(e,r))}var v=function(){function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,c.default)(this,e),this.r=t,this.g=r,this.b=i,this.a=n}return(0,u.default)(e,[{key:"equals",value:function(e){return this.r==e.r&&this.g==e.g&&this.b==e.b&&this.a==e.a}},{key:"modulateOpacity",value:function(t){return new e(this.r,this.g,this.b,this.a*t)}},{key:"add",value:function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}},{key:"subtract",value:function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}},{key:"multiply",value:function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}},{key:"divide",value:function(t){return new e(this.r/t.r,this.g/t.g,this.b/t.b,this.a/t.a)}},{key:"scale",value:function(t){return new e(this.r*t,this.g*t,this.b*t,this.a*t)}}],[{key:"Gray",value:function(t){return new e(t,t,t,1)}},{key:"FromRGBA",value:function(t){return new e(t.r,t.g,t.b,t.a)}},{key:"FromHSL",value:function(t,r,i,n){var a=i<=.5?i+i*r:i+r-i*r,o=2*i-a,s=[1/3,0,-1/3].map((function(e){var r=(t+e)%1;return 6*r<1?o+(a-o)*r*6:2*r<1?a:3*r<2?o+(a-o)*(4-6*r):o})),c=(0,l.default)(s,3);return new e(c[0],c[1],c[2],n)}},{key:"InterpolateLinear",value:function(t,r,i){return new e((0,h.clamp)((0,h.mix)(t.r,r.r,i),0,1),(0,h.clamp)((0,h.mix)(t.g,r.g,i),0,1),(0,h.clamp)((0,h.mix)(t.b,r.b,i),0,1),(0,h.clamp)((0,h.mix)(t.a,r.a,i),0,1))}}])}();t.Color=v,v.Transparent=new v(0,0,0,0),v.Black=new v(0,0,0,1),v.White=new v(1,1,1,1),v.Red=new v(1,0,0,1),v.Orange=new v(1,.5,0,1),v.Yellow=new v(1,1,0,1),v.Green=new v(0,1,0,1),v.Cyan=new v(0,1,1,1),v.Blue=new v(0,0,1,1),v.Magenta=new v(1,0,1,1);var y,_=(0,u.default)((function e(){(0,c.default)(this,e),this.renderDataMap={},this.m_changeTracker=new m.ChangeTracker}),[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"id",get:function(){return this.m_id},set:function(e){this.m_id!=e&&(this.m_changeTracker.notifyChange(),this.m_id=e)}},{key:"releaseGeneratedResources",value:function(){for(var e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}}]);t.ImageContainer=_,t.BrushType=y,function(e){e[e.none=0]="none",e[e.solid=1]="solid",e[e.linearGradient=2]="linearGradient",e[e.radialGradient=3]="radialGradient",e[e.rectangularGradient=4]="rectangularGradient",e[e.pathGradient=5]="pathGradient",e[e.image=6]="image",e[e.pattern=7]="pattern",e[e.background=8]="background",e[e.group=9]="group"}(y||(t.BrushType=y={}));var S=(0,u.default)((function e(){(0,c.default)(this,e),this.m_changeTrackers={colorChangeTracker:new m.ChangeTracker,alphaChangeTracker:new m.ChangeTracker}}),[{key:"changeTracker",get:function(){return this.m_changeTrackers.colorChangeTracker}},{key:"version",get:function(){return this.m_changeTrackers.colorChangeTracker.version}},{key:"alphaChangeTracker",get:function(){return this.m_changeTrackers.alphaChangeTracker}},{key:"rotateWithShape",get:function(){return!0}}],[{key:"IsGradient",value:function(e){return y.linearGradient<=e&&e<=y.pathGradient}}]);t.Brush=S;var T=function(e){function t(e){var r;return(0,c.default)(this,t),(r=g(this,t)).m_color=e,r}return(0,s.default)(t,e),(0,u.default)(t,[{key:"clone",value:function(){return new t(this.m_color)}},{key:"color",get:function(){return this.m_color},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_color,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_color.a,e.a),this.m_color=e}},{key:"getType",value:function(){return y.solid}}])}(S);t.SolidBrush=T;var b=(0,u.default)((function e(t,r){(0,c.default)(this,e),this.position=t,this.color=r}),[{key:"equals",value:function(e){return this.position==e.position&&this.color.equals(e.color)}}]);t.GradientStop=b;var C,w=function(e){function t(e,r){var i;return(0,c.default)(this,t),(i=g(this,t)).m_type=e,i.m_angle=0,i.m_fillFromRect=new h.Rect(0,0,1,1),i.m_fillToRect=new h.Rect(.5,.5,.5,.5),i.m_rotateWithShape=!0,i.m_isStretched=!1,i.m_shadeFromTitle=!1,i.m_gradientStops=r?r.slice(0):[],i.m_isGammaCorrected=!0,i.m_alphaGamma=1,m.ChangeTracker.AddListener(i.changeTracker,i.alphaChangeTracker),i}return(0,s.default)(t,e),(0,u.default)(t,[{key:"clone",value:function(){var e=new t(this.m_type,this.m_gradientStops);return e.m_angle=this.m_angle,e.m_fillFromRect=this.m_fillFromRect,e.m_fillToRect=this.m_fillToRect,e.m_rotateWithShape=this.m_rotateWithShape,e.m_isStretched=this.m_isStretched,e.m_shadeFromTitle=this.m_shadeFromTitle,e.m_isGammaCorrected=this.m_isGammaCorrected,e.m_alphaGamma=this.m_alphaGamma,e}},{key:"gradientStops",get:function(){return this.m_gradientStops},set:function(e){(0,p.notifyIfNotEqualsArray)(this.changeTracker,this.m_gradientStops,e),this.m_gradientStops=e.slice(0)}},{key:"angle",get:function(){return this.m_angle},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_angle,e),this.m_angle=e}},{key:"fillFromRect",get:function(){return this.m_fillFromRect},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_fillFromRect,e),this.m_fillFromRect=e}},{key:"fillToRect",get:function(){return this.m_fillToRect},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_fillToRect,e),this.m_fillToRect=e}},{key:"isStretched",get:function(){return this.m_isStretched},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_isStretched,e),this.m_isStretched=e}},{key:"shadeFromTitle",get:function(){return this.m_shadeFromTitle},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_shadeFromTitle,e),this.m_shadeFromTitle=e}},{key:"rotateWithShape",get:function(){return this.m_type==y.pathGradient||this.m_rotateWithShape},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}},{key:"isGammaCorrected",get:function(){return this.m_isGammaCorrected},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_isGammaCorrected,e),this.m_isGammaCorrected=e}},{key:"blendBellShape",get:function(){return this.m_blendBellShape},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_blendBellShape,e),this.m_blendBellShape=e}},{key:"alphaGamma",get:function(){return this.m_alphaGamma},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_alphaGamma,e),this.m_alphaGamma=e}},{key:"getType",value:function(){return this.m_type}}])}(S);t.GradientBrush=w,t.WrapMode=C,function(e){e[e.tile=0]="tile",e[e.tileFlipX=1]="tileFlipX",e[e.tileFlipY=2]="tileFlipY",e[e.tileFlipXY=3]="tileFlipXY",e[e.clamp=4]="clamp"}(C||(t.WrapMode=C={}));var P,I=function(e){function t(e,r){var i;return(0,c.default)(this,t),(i=g(this,t)).m_fillToPreserveAspectRatio=!1,i.m_isAlphaInvariant=!!r,i.changeTracker.replaceListener(void 0,e),i.m_isAlphaInvariant||i.alphaChangeTracker.replaceListener(void 0,e),i.m_image=e,i.m_isStretched=!0,i.m_scale=h.Vector2.One,i.m_offset=h.Vector2.Zero,i.m_rotation=0,i.m_rotationCenter=new h.Vector2(.5,.5),i.m_alignment=h.AlignmentType.center,i.m_opacity=1,i.m_rotateWithShape=!0,i}return(0,s.default)(t,e),(0,u.default)(t,[{key:"clone",value:function(){var e,r=new t(this.m_image);return r.m_isStretched=this.m_isStretched,r.m_scale=this.m_scale,r.m_offset=this.m_offset,r.m_rotation=this.m_rotation,r.m_rotationCenter=this.m_rotationCenter,r.m_alignment=this.m_alignment,r.m_opacity=this.m_opacity,r.m_rotateWithShape=this.m_rotateWithShape,r.m_pictureEffects=null===(e=this.m_pictureEffects)||void 0===e?void 0:e.clone(),r.m_isAlphaInvariant=this.m_isAlphaInvariant,r.m_fillToPreserveAspectRatio=this.m_fillToPreserveAspectRatio,r}},{key:"image",get:function(){return this.m_image},set:function(e){this.changeTracker.replaceListener(this.m_image,e),this.m_isAlphaInvariant||this.alphaChangeTracker.replaceListener(this.m_image,e),this.m_image=e}},{key:"wrapMode",get:function(){return this.m_wrapMode},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_wrapMode,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_wrapMode,e),this.m_wrapMode=e}},{key:"isStretched",get:function(){return this.m_isStretched},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_isStretched,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_isStretched,e),this.m_isStretched=e}},{key:"scale",get:function(){return this.m_scale},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_scale,e),(0,p.notifyIfNotEquals)(this.alphaChangeTracker,this.m_scale,e),this.m_scale=e}},{key:"offset",get:function(){return this.m_offset},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_offset,e),(0,p.notifyIfNotEquals)(this.alphaChangeTracker,this.m_offset,e),this.m_offset=e}},{key:"rotation",get:function(){return this.m_rotation},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_rotation,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_rotation,e),this.m_rotation=e}},{key:"rotationCenter",get:function(){return this.m_rotationCenter},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_rotationCenter,e),(0,p.notifyIfNotEquals)(this.alphaChangeTracker,this.m_rotationCenter,e),this.m_rotationCenter=e}},{key:"alignment",get:function(){return this.m_alignment},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_alignment,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_alignment,e),this.m_alignment=e}},{key:"opacity",get:function(){return this.m_opacity},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_opacity,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_opacity,e),this.m_opacity=e}},{key:"rotateWithShape",get:function(){return this.m_rotateWithShape},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_rotateWithShape,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}},{key:"pictureEffects",get:function(){return this.m_pictureEffects},set:function(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.alphaChangeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}},{key:"isAlphaInvariant",get:function(){return this.m_isAlphaInvariant},set:function(e){this.m_isAlphaInvariant!=e&&(e?this.alphaChangeTracker.replaceListener(this.m_image,void 0):this.alphaChangeTracker.replaceListener(void 0,this.m_image),this.m_isAlphaInvariant=e)}},{key:"fillToPreserveAspectRatio",get:function(){return this.m_fillToPreserveAspectRatio},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_fillToPreserveAspectRatio,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_fillToPreserveAspectRatio,e),this.m_fillToPreserveAspectRatio=e}},{key:"getType",value:function(){return y.image}}])}(S);t.ImageBrush=I,t.PatternType=P,function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",e[e.forwardDiagonal=2]="forwardDiagonal",e[e.backwardDiagonal=3]="backwardDiagonal",e[e.cross=4]="cross",e[e.diagonalCross=5]="diagonalCross",e[e.percent05=6]="percent05",e[e.percent10=7]="percent10",e[e.percent20=8]="percent20",e[e.percent25=9]="percent25",e[e.percent30=10]="percent30",e[e.percent40=11]="percent40",e[e.percent50=12]="percent50",e[e.percent60=13]="percent60",e[e.percent70=14]="percent70",e[e.percent75=15]="percent75",e[e.percent80=16]="percent80",e[e.percent90=17]="percent90",e[e.lightDownwardDiagonal=18]="lightDownwardDiagonal",e[e.lightUpwardDiagonal=19]="lightUpwardDiagonal",e[e.darkDownwardDiagonal=20]="darkDownwardDiagonal",e[e.darkUpwardDiagonal=21]="darkUpwardDiagonal",e[e.wideDownwardDiagonal=22]="wideDownwardDiagonal",e[e.wideUpwardDiagonal=23]="wideUpwardDiagonal",e[e.lightVertical=24]="lightVertical",e[e.lightHorizontal=25]="lightHorizontal",e[e.narrowVertical=26]="narrowVertical",e[e.narrowHorizontal=27]="narrowHorizontal",e[e.darkVertical=28]="darkVertical",e[e.darkHorizontal=29]="darkHorizontal",e[e.dashedDownwardDiagonal=30]="dashedDownwardDiagonal",e[e.dashedUpwardDiagonal=31]="dashedUpwardDiagonal",e[e.dashedHorizontal=32]="dashedHorizontal",e[e.dashedVertical=33]="dashedVertical",e[e.smallConfetti=34]="smallConfetti",e[e.largeConfetti=35]="largeConfetti",e[e.zigZag=36]="zigZag",e[e.wave=37]="wave",e[e.diagonalBrick=38]="diagonalBrick",e[e.horizontalBrick=39]="horizontalBrick",e[e.weave=40]="weave",e[e.plaid=41]="plaid",e[e.divot=42]="divot",e[e.dottedGrid=43]="dottedGrid",e[e.dottedDiamond=44]="dottedDiamond",e[e.shingle=45]="shingle",e[e.trellis=46]="trellis",e[e.sphere=47]="sphere",e[e.smallGrid=48]="smallGrid",e[e.smallCheckerBoard=49]="smallCheckerBoard",e[e.largeCheckerBoard=50]="largeCheckerBoard",e[e.outlinedDiamond=51]="outlinedDiamond",e[e.solidDiamond=52]="solidDiamond",e[e.count=53]="count"}(P||(t.PatternType=P={}));var k=function(e){function t(e,r,i){var n;return(0,c.default)(this,t),(n=g(this,t)).m_pattern=e,n.m_foregroundColor=r,n.m_backgroundColor=i,n}return(0,s.default)(t,e),(0,u.default)(t,[{key:"clone",value:function(){return new t(this.m_pattern,this.m_foregroundColor,this.m_backgroundColor)}},{key:"pattern",get:function(){return this.m_pattern},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_pattern,e),(0,p.notifyIfDifferent)(this.alphaChangeTracker,this.m_pattern,e),this.m_pattern=e}},{key:"foregroundColor",get:function(){return this.m_foregroundColor},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_foregroundColor,e),(0,p.notifyIfDifferent)(this.changeTracker,this.m_foregroundColor.a,e.a),this.m_foregroundColor=e}},{key:"backgroundColor",get:function(){return this.m_backgroundColor},set:function(e){(0,p.notifyIfNotEquals)(this.changeTracker,this.m_backgroundColor,e),(0,p.notifyIfDifferent)(this.changeTracker,this.m_backgroundColor.a,e.a),this.m_backgroundColor=e}},{key:"rotateWithShape",get:function(){return!1}},{key:"getType",value:function(){return y.pattern}}])}(S);t.PatternBrush=k;var E,x,L,A,M,R,O,D,F=function(e){function t(e){var r;return(0,c.default)(this,t),(r=g(this,t)).m_type=e,e!=y.background&&e!=y.group&&f.Log.Error(592520774,"SpecialBrush must be background or group"),r}return(0,s.default)(t,e),(0,u.default)(t,[{key:"clone",value:function(){return new t(this.m_type)}},{key:"getType",value:function(){return this.m_type}}])}(S);t.SpecialBrush=F,t.PenDash=E,function(e){e[e.solid=0]="solid",e[e.sysDash=1]="sysDash",e[e.sysDot=2]="sysDot",e[e.sysDashDot=3]="sysDashDot",e[e.sysDashDotDot=4]="sysDashDotDot",e[e.dot=5]="dot",e[e.dash=6]="dash",e[e.longDash=7]="longDash",e[e.dashDot=8]="dashDot",e[e.longDashDot=9]="longDashDot",e[e.longDashDotDot=10]="longDashDotDot"}(E||(t.PenDash=E={})),t.LineJoin=x,function(e){e[e.bevel=0]="bevel",e[e.miter=1]="miter",e[e.round=2]="round",e[e.miterOrBevel=3]="miterOrBevel"}(x||(t.LineJoin=x={})),t.PenCompound=L,function(e){e[e.simple=0]="simple",e[e.double=1]="double",e[e.thickThin=2]="thickThin",e[e.thinThick=3]="thinThick",e[e.triple=4]="triple"}(L||(t.PenCompound=L={})),t.PenAlignment=A,function(e){e[e.center=0]="center",e[e.in=1]="in",e[e.out=2]="out"}(A||(t.PenAlignment=A={})),t.PenLineEnd=M,function(e){e[e.none=0]="none",e[e.triangle=1]="triangle",e[e.stealth=2]="stealth",e[e.diamond=3]="diamond",e[e.oval=4]="oval",e[e.arrow=5]="arrow"}(M||(t.PenLineEnd=M={})),t.PenLineCap=R,function(e){e[e.round=0]="round",e[e.square=1]="square",e[e.capFlat=2]="capFlat"}(R||(t.PenLineCap=R={})),t.PenLineEndWidth=O,function(e){e[e.narrow=0]="narrow",e[e.medium=1]="medium",e[e.wide=2]="wide"}(O||(t.PenLineEndWidth=O={})),t.PenLineEndLength=D,function(e){e[e.short=0]="short",e[e.medium=1]="medium",e[e.long=2]="long"}(D||(t.PenLineEndLength=D={}));var B,N=(0,u.default)((function e(t,r,i,n,a){(0,c.default)(this,e),this.widthMin=t,this.end=r,this.cap=i,this.width=n,this.length=a}));t.PenEnd=N,t.PenTip=B,function(e){e[e.ball=0]="ball",e[e.square=1]="square"}(B||(t.PenTip=B={}));var V,U,W=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.round,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;(0,c.default)(this,e),this.headEnd=new N(0,M.none,R.round,O.medium,D.medium),this.tailEnd=new N(0,M.none,R.round,O.medium,D.medium),this.m_changeTracker=new m.ChangeTracker,this.m_lineWidth=t,this.m_lineJoin=r,this.m_miterLimit=i,this.m_dashType=E.solid,this.m_compoundType=L.simple,this.m_alignment=A.center,this.m_useRoundDash=!1}return(0,u.default)(e,[{key:"clone",value:function(){var t=new e(this.m_lineWidth);return t.m_lineJoin=this.m_lineJoin,t.m_miterLimit=this.m_miterLimit,t.m_dashType=this.m_dashType,t.m_compoundType=this.m_compoundType,t.m_alignment=this.m_alignment,t.m_useRoundDash=this.m_useRoundDash,t}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"version",get:function(){return this.m_changeTracker.version}},{key:"lineWidth",get:function(){return this.m_lineWidth?this.m_lineWidth:this.m_lineHeight?this.m_lineHeight:0},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_lineWidth,e),this.m_lineWidth=e}},{key:"adjustedLineWidth",get:function(){return Math.max(d.s_minLineWidth,this.lineWidth)}},{key:"adjustedLineWidthForArrowHead",get:function(){return Math.max(d.s_minLineWidthForArrowHead,this.lineWidth)}},{key:"lineHeight",get:function(){return this.m_lineHeight?this.m_lineHeight:this.m_lineWidth?this.m_lineWidth:0},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_lineHeight,e),this.m_lineHeight=e}},{key:"tipScale",get:function(){return this.m_lineWidth&&this.m_lineHeight?new h.Vector2(1,this.m_lineHeight/this.m_lineWidth):h.Vector2.One}},{key:"lineJoin",get:function(){return this.m_lineJoin},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_lineJoin,e),this.m_lineJoin=e}},{key:"miterLimit",get:function(){return this.m_miterLimit},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_miterLimit,e),this.m_miterLimit=e}},{key:"dashType",get:function(){return this.m_dashType},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_dashType,e),this.m_dashType=e}},{key:"useRoundDash",get:function(){return this.m_useRoundDash},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_useRoundDash,e),this.m_useRoundDash=e}},{key:"dashOffset",get:function(){return null==this.m_dashOffset?0:this.m_dashOffset},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_dashOffset,e),this.m_dashOffset=e}},{key:"compoundType",get:function(){return this.m_compoundType},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_compoundType,e),this.m_compoundType=e}},{key:"alignment",get:function(){return this.m_alignment},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_alignment,e),this.m_alignment=e}},{key:"tipType",get:function(){return null==this.m_tipType?B.ball:this.m_tipType},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_tipType,e),this.m_tipType=e}}])}();t.Pen=W,t.BlendingMode=V,function(e){e[e.normal=0]="normal",e[e.darken=1]="darken",e[e.exclusion=2]="exclusion",e[e.cutout=3]="cutout",e[e.add=4]="add",e[e.multiply=5]="multiply",e[e.simulateOverlay=6]="simulateOverlay"}(V||(t.BlendingMode=V={})),t.PictureFillMode=U,function(e){e[e.pictureOverFill=0]="pictureOverFill",e[e.fillMaskedOverPicture=1]="fillMaskedOverPicture",e[e.fillMaskedByPicture=2]="fillMaskedByPicture"}(U||(t.PictureFillMode=U={}));var G=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new W,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:V.normal;(0,c.default)(this,e),this.m_changeTracker=new m.ChangeTracker,this.m_alphaChangeTracker=new m.ChangeTracker,this.m_penChangeTracker=new m.ChangeTracker,this.m_fillChangeTrackers={colorChangeTracker:new m.ChangeTracker,alphaChangeTracker:new m.ChangeTracker},this.m_lineChangeTrackers={colorChangeTracker:new m.ChangeTracker,alphaChangeTracker:new m.ChangeTracker},this.m_pictureChangeTrackers={colorChangeTracker:new m.ChangeTracker,alphaChangeTracker:new m.ChangeTracker},m.ChangeTracker.AddListener(this.m_fillChangeTrackers.colorChangeTracker,this.m_changeTracker),m.ChangeTracker.AddListener(this.m_lineChangeTrackers.colorChangeTracker,this.m_changeTracker),m.ChangeTracker.AddListener(this.m_pictureChangeTrackers.colorChangeTracker,this.m_changeTracker),m.ChangeTracker.AddListener(this.m_fillChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),m.ChangeTracker.AddListener(this.m_lineChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),m.ChangeTracker.AddListener(this.m_pictureChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),m.ChangeTracker.AddListener(this.m_penChangeTracker,this.m_changeTracker),this.m_pen=i,this.fillBrush=t,this.lineBrush=r,this.m_blendingMode=n,this.m_penChangeTracker.replaceListener(void 0,i)}return(0,u.default)(e,[{key:"clone",value:function(){var t=new e;return t.fillBrush=this.m_fillBrush?this.m_fillBrush.clone():void 0,t.lineBrush=this.m_lineBrush?this.m_lineBrush.clone():void 0,t.pictureBrush=this.m_pictureBrush?this.m_pictureBrush.clone():void 0,t.pictureEffects=this.m_pictureEffects?this.m_pictureEffects.clone():void 0,t.m_pictureOverflow=this.m_pictureOverflow,t.pen=this.m_pen.clone(),t.blendingMode=this.m_blendingMode,t.m_hitTransparentFill=this.m_hitTransparentFill,t.m_hitTestSlop=this.m_hitTestSlop,t.m_pictureFillMode=this.m_pictureFillMode,t}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"alphaChangeTracker",get:function(){return this.m_alphaChangeTracker}},{key:"penChangeTracker",get:function(){return this.m_penChangeTracker}},{key:"version",get:function(){return this.m_changeTracker.version}},{key:"fillBrush",get:function(){return this.m_fillBrush},set:function(e){H(this.m_fillChangeTrackers.colorChangeTracker,this.m_fillChangeTrackers.alphaChangeTracker,this.m_fillBrush,e),this.m_fillBrush=e}},{key:"lineBrush",get:function(){return this.m_lineBrush},set:function(e){H(this.m_lineChangeTrackers.colorChangeTracker,this.m_lineChangeTrackers.alphaChangeTracker,this.m_lineBrush,e),this.m_lineBrush=e}},{key:"pictureBrush",get:function(){return this.m_pictureBrush},set:function(e){H(this.m_pictureChangeTrackers.colorChangeTracker,this.m_pictureChangeTrackers.alphaChangeTracker,this.m_pictureBrush,e),this.m_pictureBrush=e}},{key:"pictureEffects",get:function(){return this.m_pictureEffects},set:function(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}},{key:"pictureOverflow",get:function(){return this.m_pictureOverflow||0},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_pictureOverflow,e),this.m_pictureOverflow=e}},{key:"pen",get:function(){return this.m_pen},set:function(e){this.m_penChangeTracker.replaceListener(this.m_pen,e),this.m_pen=e}},{key:"hasLine",get:function(){return null!=this.m_lineBrush}},{key:"blendingMode",get:function(){return this.m_blendingMode},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}},{key:"hitTransparentFill",get:function(){return!!this.m_hitTransparentFill},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_hitTransparentFill,e),this.m_hitTransparentFill=e}},{key:"hitTestSlop",get:function(){return this.m_hitTestSlop},set:function(e){this.m_hitTestSlop!=e&&this.changeTracker.notifyChange(),this.m_hitTestSlop=e}},{key:"pictureFillMode",get:function(){return this.m_pictureFillMode},set:function(e){(0,p.notifyIfDifferent)(this.changeTracker,this.m_pictureFillMode,e),this.m_pictureFillMode=e}},{key:"getBrushImages",value:function(){var e=j(this.fillBrush);return e.push.apply(e,(0,n.default)(j(this.lineBrush))),e.push.apply(e,(0,n.default)(j(this.pictureBrush))),e}}])}();function H(e,t,r,i){r!=i&&(r&&(m.ChangeTracker.RemoveListener(r.changeTracker,e),m.ChangeTracker.RemoveListener(r.alphaChangeTracker,t)),i&&(m.ChangeTracker.AddListener(i.changeTracker,e),m.ChangeTracker.AddListener(i.alphaChangeTracker,t)))}function j(e){var t=[];if(e&&e.getType()==y.image){var r=e;r.image&&t.push(r.image)}return t}t.Style=G},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setVideoLogger=function(e){t.Log=i=e},t.Log=void 0;var i={info:function(e,t){},warn:function(e,t){},error:function(e,t){}};t.Log=i},function(e,t,r){var i=r(213),n=r(214),a=r(127),o=r(215);e.exports=function(e){return i(e)||n(e)||a(e)||o()}},function(e,t,r){var i=r(216),n=r(217),a=r(127),o=r(218);e.exports=function(e,t){return i(e)||n(e,t)||a(e,t)||o()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(101);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(84);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(64);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(262);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(263);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(264);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(271);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var u=r(131);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}));var d=r(51);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}));var h=r(272);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})}));var f=r(38);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})}));var m=r(142);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}));var p=r(143);Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})}));var g=r(144);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logError=function(e){var t=(new Error).stack||"";n.ULS.sendTraceTag(592999624,n.LogCategory.msoulscat_Wac_PptSession,n.TraceLevel.Error,"".concat(e," ").concat(t))},t.isContentTransition=function(e,t){switch(e){case i.kTransitionIds.PPT_TRANSITION_PRISM:return 4==(4&t);case i.kTransitionIds.PPT_TRANSITION_PAN:case i.kTransitionIds.PPT_TRANSITION_CONVEYOR:case i.kTransitionIds.PPT_TRANSITION_CROSSZOOM:case i.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:case i.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:return!0}return!1},t.isTransitionDisabledUtil=a,t.isTransitionDisabled=function(e,t,r){if(t===i.kTransitionIds.PPT_TRANSITION_FADE)return!1;switch(t){case i.kTransitionIds.PPT_TRANSITION_CUT:return a(e,"Cut");case i.kTransitionIds.PPT_TRANSITION_BLINDS:return a(e,"Blinds");case i.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK:return a(e,"FadeThroughBlack");case i.kTransitionIds.PPT_TRANSITION_PUSH:return a(e,"Push");case i.kTransitionIds.PPT_TRANSITION_PRISM:switch(!0){case r<4:return a(e,"Cube");case r<8:return a(e,"Rotate");case r<12:return a(e,"Box");case r<16:return a(e,"Orbit")}break;case i.kTransitionIds.PPT_TRANSITION_WIPE:case i.kTransitionIds.PPT_TRANSITION_STRIPS:return a(e,"Wipe");case i.kTransitionIds.PPT_TRANSITION_SPLIT:return a(e,"Split");case i.kTransitionIds.PPT_TRANSITION_ZOOM:case i.kTransitionIds.PPT_TRANSITION_DIAMOND:case i.kTransitionIds.PPT_TRANSITION_PLUS:case i.kTransitionIds.PPT_TRANSITION_CIRCLE:return a(e,"Shape");case i.kTransitionIds.PPT_TRANSITION_RANDOMBAR:return a(e,"RandomBars");case i.kTransitionIds.PPT_TRANSITION_COMB:return a(e,"Comb");case i.kTransitionIds.PPT_TRANSITION_DISSOLVE:return a(e,"Dissolve");case i.kTransitionIds.PPT_TRANSITION_RANDOM:return a(e,"Random");case i.kTransitionIds.PPT_TRANSITION_COVER:return a(e,"Cover");case i.kTransitionIds.PPT_TRANSITION_UNCOVER:return a(e,"Uncover");case i.kTransitionIds.PPT_TRANSITION_WHEEL:case i.kTransitionIds.PPT_TRANSITION_WHEELREVERSE:case i.kTransitionIds.PPT_TRANSITION_WEDGE:return a(e,"Wheel");case i.kTransitionIds.PPT_TRANSITION_RIPPLE:return a(e,"Ripple");case i.kTransitionIds.PPT_TRANSITION_DRAPE:return a(e,"Drape");case i.kTransitionIds.PPT_TRANSITION_CURTAINS:return a(e,"Curtains");case i.kTransitionIds.PPT_TRANSITION_WIND:return a(e,"Wind");case i.kTransitionIds.PPT_TRANSITION_PRESTIGE:return a(e,"Prestige");case i.kTransitionIds.PPT_TRANSITION_FRACTURE:return a(e,"Fracture");case i.kTransitionIds.PPT_TRANSITION_CRUSH:return a(e,"Crush");case i.kTransitionIds.PPT_TRANSITION_PEELOFF:return a(e,"PeelOff");case i.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:case i.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:return a(e,"PageCurl");case i.kTransitionIds.PPT_TRANSITION_AIRPLANE:return a(e,"Airplane");case i.kTransitionIds.PPT_TRANSITION_ORIGAMI:return a(e,"Origami");case i.kTransitionIds.PPT_TRANSITION_CHECKER:return a(e,"Checker");case i.kTransitionIds.PPT_TRANSITION_VORTEX:return a(e,"Vortex");case i.kTransitionIds.PPT_TRANSITION_SWITCH:return a(e,"Switch");case i.kTransitionIds.PPT_TRANSITION_FALLOVER:return a(e,"FallOver");case i.kTransitionIds.PPT_TRANSITION_FLIP:return a(e,"Flip");case i.kTransitionIds.PPT_TRANSITION_GLITTER:return a(e,"Glitter");case i.kTransitionIds.PPT_TRANSITION_CROSSZOOM:return a(e,"RevealModern");case i.kTransitionIds.PPT_TRANSITION_PAN:return a(e,"Pan");case i.kTransitionIds.PPT_TRANSITION_GALLERY:return a(e,"GalleryIcon");case i.kTransitionIds.PPT_TRANSITION_CONVEYOR:return a(e,"Conveyor");case i.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:return a(e,"Flythrough");case i.kTransitionIds.PPT_TRANSITION_FLYTHROUGH:case i.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN:return a(e,"Zoom");case i.kTransitionIds.PPT_TRANSITION_DOORS:return a(e,"Doors");case i.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:return a(e,"Window")}return!0};var i=r(45),n=r(3);function a(e,t){return!!e&&e.toLowerCase().split(",").includes(t.toLowerCase())}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getEnginesPrograms=m,t.activateShader=function(e,t){var r=m(e);if(r){var i=r[t];if(i){if(i.isReady())return e.enableEffect(i),i;(0,u.logError)("Can not activate shader, program is not ready yet (please await initialization).")}else(0,u.logError)("Can not activate shader, program has not been found.")}else(0,u.logError)("Can not activate shader, ShaderProgram has not been initialiazed (please await initialization).")},t.getShaderCode=function(e){return d[e]},t.getEffectKey=p,t.precompileShader=g,t.precompileShaders=function(e){return y.apply(this,arguments)},t.ShaderProgramsByEngine=t.ShaderDefinition=t.ProgramId=void 0;var n,a=i(r(6)),o=i(r(7)),s=r(132),l=r(87),c=r(357),u=r(21);t.ProgramId=n,function(e){e[e.alpha=0]="alpha",e[e.weave=1]="weave",e[e.model=2]="model",e[e.prism=3]="prism",e[e.ripple=4]="ripple",e[e.vortex=5]="vortex",e[e.custom=6]="custom",e[e.flyThrough=7]="flyThrough",e[e.zoomWithSpin=8]="zoomWithSpin",e[e.gallery=9]="gallery",e[e.count=10]="count"}(n||(t.ProgramId=n={}));var d=[{code:c.tp_0,a:["aPosition","aTexcoord","aDelay"],u:["uModelViewProj","uProgress","uFactor","uStyle"],s:["uSampler1","uSampler2"]},{code:c.tp_1,a:["aPosition","aTexcoord","aDelay","aDirection"],u:["uModelViewProj","uProgress","uFactor","uOpacity"],s:["uSampler1"]},{code:c.tp_2,a:["aPosition","aTexcoord"],u:["uModelViewProj"],s:["uSampler1"]},{code:c.tp_3,a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uProgress","uFactor","uZmovement","uDirection","uAnglePlus","uMaxAngle","uZCenter","uXAxis"],s:["uSampler1"]},{code:c.tp_4,a:["aPosition","aTexcoord","aDistance"],u:["uModelViewProj","uProgress"],s:["uSampler1","uSampler2"]},{code:c.tp_5,a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uFactor","uZmovement","uDirection","uAngle","uXAxis","uBack"],s:["uSampler1"]},{code:c.tp_6,a:["aPosition","aNormal","aTexCoord"],u:["uModelToView","uModelToWorld","uModelToWorldIT","uLightPosition","uAmbientColor","uDiffuseColor","uIsNormalDirectionChangeReq"],s:["uSampler"]},{code:c.tp_7,a:["aPosition","aTexcoord","aCenter"],u:["uModelViewProj","offsetMatrix","uProgress","opacity","style","isX"],s:["uSampler1","uSampler2"]},{code:c.tp_8,a:["aPosition","aTexcoord","aCenter","aDelay"],u:["uModelViewProj","uTime","uSpinFactor","uFactor","uReverseAngle","uGrowFactor","uOpacitySpeed"],s:["uSampler"]},{code:c.tp_9,a:["aPosition","aTexcoord"],u:["uModelViewProj","offsetMatrix","dirMatrix","opacity","isInvX"],s:["uSampler1","uSampler2"]}];t.ShaderDefinition=d;var h=0,f=[];function m(e){return void 0===e.transitionId&&(h+=1,e.transitionId=h),f[h]}function p(e){return"transitions-".concat(e)}function g(e,t,r){return v.apply(this,arguments)}function v(){return(v=(0,o.default)(a.default.mark((function e(t,r,i){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.generatePipelineContext)({shaderNameOrContent:{vertexSource:i.code.v,fragmentSource:i.code.f},key:p(t)},r,l.createPipelineContext.bind(null,r),l._preparePipelineContext);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=(0,o.default)(a.default.mark((function e(t){var r,i=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:d,void 0!==t.TEXTURE_3D){e.next=3;break}return e.abrupt("return",[]);case 3:if(r){e.next=5;break}throw new Error("Shader code array is not provided");case 5:if(!Array.isArray(r)){e.next=7;break}return e.abrupt("return",Promise.all(r.map((function(e,r){return g(r,t,e)}))));case 7:return e.abrupt("return",Promise.all(Object.keys(r).map((function(e){return g(+e,t,r[e])}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.ShaderProgramsByEngine=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindDrawInfo=function(e){return e.engine.enableEffect(e.shaderProgram),e.vertexArrayObject?e.engine.bindVertexArrayObject(e.vertexArrayObject,e.vertexIndexBuffer):e.engine.bindBuffers(e.vertexBuffers,e.vertexIndexBuffer,e.shaderProgram),e.shaderProgram},t.drawTriangles=function(e){e.engine.draw(!0,0,e.vertexIndexLength)},t.createDrawInfo=function(e,t,r,a,o,s,l){var c=(0,i.activateShader)(e,o);if(c){var u,d=t.createVertexBuffers(l),h=t.createIndexBuffer(s),f=s.length,m=e.wrapExternalTexture(r),p=e.wrapExternalTexture(a);return e.getCaps().vertexArrayObject&&(u=t.recordVertexArrayObject(d,h,c)),{engine:e,shaderProgram:c,vertexBuffers:d,vertexIndexBuffer:h,vertexIndexLength:f,incomingSlideTexture:m,outgoingSlideTexture:p,vertexArrayObject:u,autoClear:!0}}(0,n.logError)("Can not init shaders, initialization failed.")},t.setDepthBlendCulling=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.depthCullingState.depthTest=t,e.setTranstionBlend(r),0===i?e.depthCullingState.cull=!1:(e.depthCullingState.cull=!0,e.depthCullingState.cullFace=i)};var i=r(22),n=r(21)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=o,t.__rest=l,t.__decorate=c,t.__param=u,t.__esDecorate=function(e,t,r,i,a,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,c=i.kind,u="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,h=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),f=!1,m=r.length-1;m>=0;m--){var p={};for(var g in i)p[g]="access"===g?{}:i[g];for(var g in i.access)p.access[g]=i.access[g];p.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var v=(0,r[m])("accessor"===c?{get:h.get,set:h.set}:h[u],p);if("accessor"===c){if(void 0===v)continue;if(null===v||"object"!==(0,n.default)(v))throw new TypeError("Object expected");(l=s(v.get))&&(h.get=l),(l=s(v.set))&&(h.set=l),(l=s(v.init))&&a.unshift(l)}else(l=s(v))&&("field"===c?a.unshift(l):h[u]=l)}d&&Object.defineProperty(d,i.name,h),f=!0},t.__runInitializers=function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},t.__propKey=function(e){return"symbol"===(0,n.default)(e)?e:"".concat(e)},t.__setFunctionName=function(e,t,r){return"symbol"===(0,n.default)(t)&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})},t.__metadata=d,t.__awaiter=h,t.__generator=f,t.__exportStar=p,t.__values=g,t.__read=v,t.__spread=y,t.__spreadArrays=_,t.__spreadArray=S,t.__await=T,t.__asyncGenerator=b,t.__asyncDelegator=C,t.__asyncValues=w,t.__makeTemplateObject=P,t.__importStar=k,t.__importDefault=E,t.__classPrivateFieldGet=x,t.__classPrivateFieldSet=L,t.__classPrivateFieldIn=A,t.__addDisposableResource=M,t.__disposeResources=O,t.default=t.__createBinding=t.__assign=void 0;var n=i(r(15)),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return t.__assign=s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function l(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function c(e,t,r,i){var a,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"===("undefined"==typeof Reflect?"undefined":(0,n.default)(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(s=(o<3?a(s):o>3?a(t,r,s):a(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function u(e,t){return function(r,i){t(r,i,e)}}function d(e,t){if("object"===("undefined"==typeof Reflect?"undefined":(0,n.default)(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,i){return new(r||(r=Promise))((function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))}function f(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((n=(n=o.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}t.__assign=s;var m=Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function g(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function _(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i}function S(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){a.push([e,t,r,i])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof T?Promise.resolve(r.value.v).then(l,c):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function C(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:T(e[i](t)),done:!1}:n?n(t):t}:n}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=g(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,n,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}t.__createBinding=m;var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return I(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function L(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function A(e,t){if(null===t||"object"!==(0,n.default)(t)&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function M(e,t,r){if(null!=t){if("object"!==(0,n.default)(t)&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function O(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var i=e.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}var D={__extends:o,__assign:s,__rest:l,__decorate:c,__param:u,__metadata:d,__awaiter:h,__generator:f,__createBinding:m,__exportStar:p,__values:g,__read:v,__spread:y,__spreadArrays:_,__spreadArray:S,__await:T,__asyncGenerator:b,__asyncDelegator:C,__asyncValues:w,__makeTemplateObject:P,__importStar:k,__importDefault:E,__classPrivateFieldGet:x,__classPrivateFieldSet:L,__classPrivateFieldIn:A,__addDisposableResource:M,__disposeResources:O};t.default=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Vector2",{enumerable:!0,get:function(){return f.Vector2}}),Object.defineProperty(t,"Rect",{enumerable:!0,get:function(){return f.Rect}}),t.ShapeType=t.CameoBackgroundType=t.MediaPlayerState=t.MediaType=t.UserMediaActionType=t.MediaEventType=t.ZoomType=t.SplitBy=t.TextRangeType=t.UrlType=void 0;var i,n,a,o,s,l,c,u,d,h,f=r(20);t.UrlType=i,function(e){e[e.Base64=0]="Base64",e[e.ObjectUrl=1]="ObjectUrl"}(i||(t.UrlType=i={})),t.TextRangeType=n,function(e){e[e.character=0]="character",e[e.paragraph=1]="paragraph"}(n||(t.TextRangeType=n={})),t.SplitBy=a,function(e){e[e.letter=0]="letter",e[e.word=1]="word",e[e.whole=2]="whole"}(a||(t.SplitBy=a={})),t.ZoomType=o,function(e){e[e.Slide=0]="Slide",e[e.Section=1]="Section"}(o||(t.ZoomType=o={})),t.MediaEventType=s,function(e){e[e.MediaPaused=0]="MediaPaused",e[e.MediaPlayed=1]="MediaPlayed",e[e.MediaStopped=2]="MediaStopped",e[e.MediaSeeked=3]="MediaSeeked",e[e.MediaVolumeChanged=4]="MediaVolumeChanged",e[e.InitMediaSync=5]="InitMediaSync",e[e.MediaEnded=6]="MediaEnded"}(s||(t.MediaEventType=s={})),t.UserMediaActionType=l,function(e){e[e.PauseButtonClick=0]="PauseButtonClick",e[e.PlayButtonClick=1]="PlayButtonClick",e[e.ProgressSliderInput=3]="ProgressSliderInput",e[e.VolumeButtonClick=4]="VolumeButtonClick",e[e.VolumeSliderInput=5]="VolumeSliderInput",e[e.CustomPlayButtonClick=6]="CustomPlayButtonClick",e[e.VideoFrameClick=7]="VideoFrameClick"}(l||(t.UserMediaActionType=l={})),t.MediaType=c,function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.StreamClassic=2]="StreamClassic",e[e.YouTube=3]="YouTube",e[e.Vimeo=4]="Vimeo",e[e.Flip=5]="Flip",e[e.Ted=6]="Ted",e[e.Stream2=7]="Stream2",e[e.SlideShare=8]="SlideShare",e[e.Other=9]="Other"}(c||(t.MediaType=c={})),t.MediaPlayerState=u,function(e){e[e.MediaPaused=0]="MediaPaused",e[e.MediaPlayed=1]="MediaPlayed",e[e.MediaStopped=2]="MediaStopped",e[e.MediaEnded=6]="MediaEnded"}(u||(t.MediaPlayerState=u={})),t.CameoBackgroundType=d,function(e){e[e.Normal=0]="Normal",e[e.Removed=1]="Removed",e[e.Blur=2]="Blur",e[e.Custom=3]="Custom"}(d||(t.CameoBackgroundType=d={})),t.ShapeType=h,function(e){e[e.Shape=0]="Shape",e[e.Media=1]="Media",e[e.GIF=2]="GIF",e[e.Addin=3]="Addin",e[e.Cameo=4]="Cameo"}(h||(t.ShapeType=h={}))},function(e,t,r){"use strict";var i,n=r(0)(r(15)),a="object"===("undefined"==typeof Reflect?"undefined":(0,n.default)(Reflect))?Reflect:null,o=a&&"function"==typeof a.apply?a.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};i=a&&"function"==typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function l(){l.init.call(this)}e.exports=l,e.exports.once=function(e,t){return new Promise((function(r,i){function n(r){e.removeListener(t,a),i(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}y(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,n)}))},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(0,n.default)(e))}function d(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners}function h(e,t,r,i){var n,a,o,s;if(u(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),o=a[t]),void 0===o)o=a[t]=r,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(n=d(e))>0&&o.length>n&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,s=l,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=f.bind(i);return n.listener=r,i.wrapFn=n,n}function p(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):v(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function y(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(0,n.default)(e));e.addEventListener(t,(function n(a){i.once&&e.removeEventListener(t,n),r(a)}))}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},l.prototype.getMaxListeners=function(){return d(this)},l.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,n=this._events;if(void 0!==n)i=i&&void 0===n.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=n[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=v(l,c);for(r=0;r<c;++r)o(u[r],this,t)}return!0},l.prototype.addListener=function(e,t){return h(this,e,t,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,t){return h(this,e,t,!0)},l.prototype.once=function(e,t){return u(t),this.on(e,m(this,e,t)),this},l.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,m(this,e,t)),this},l.prototype.removeListener=function(e,t){var r,i,n,a,o;if(u(t),void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,n=a;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,a=Object.keys(r);for(i=0;i<a.length;++i)"removeListener"!==(n=a[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},l.prototype.listeners=function(e){return p(this,e,!0)},l.prototype.rawListeners=function(e){return p(this,e,!1)},l.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},l.prototype.listenerCount=g,l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getPointDataSize=g,t.createFiguresFromPathString=function(e){for(var t="["+e.replace(/(M|L|Q|C|A|E|;)/g,(function(e){return"M"==e?"0":"L"==e?"1":"Q"==e?"2":"C"==e?"3":"A"==e?"4":"E"==e?"5":","}))+"]",r=new Float32Array(JSON.parse(t)),i=[],n=void 0,a=0,o=2*Math.PI/216e5;a<r.length;)switch(r[a++]){case 0:if(a+1>=r.length)throw c.Log.Error(592520785,"Invalid LineTo");n&&i.push(n),(n=new y).moveTo(r[a++],r[a++]);break;case 1:if(!n||a+1>=r.length)throw c.Log.Error(592520786,"Invalid LineTo");n.lineTo(r[a++],r[a++]);break;case 2:if(!n||a+3>=r.length)throw c.Log.Error(592520787,"Invalid MoveTo");n.quadBezierTo(r[a++],r[a++],r[a++],r[a++]);break;case 3:if(!n||a+5>=r.length)throw c.Log.Error(592520788,"Invalid CubicBezierTo");n.cubicBezierTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++]);break;case 4:if(!n||a+3>=r.length)throw c.Log.Error(592520789,"Invalid Arc of ellipse");n.arcTo(r[a++],r[a++],r[a++]*o,r[a++]*o);break;case 5:if(!n)throw c.Log.Error(592520790,"All paths should start with a MoveTo");n.close(),i.push(n),n=void 0}return n&&i.push(n),i},t.calculateBoundsOfFigures=S,t.isUntransformedRect=T,t.IncrementalPath=t.FigureBuilder=t.Figure=t.TapeDataFlags=t.pathDistEpsilon=t.Path=t.PathFillMode=t.PointType=void 0;var n,a,o=i(r(1)),s=i(r(2)),l=r(12),c=r(13),u=r(37),d=r(103);function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.PointType=n,function(e){e[e.gap=0]="gap",e[e.corner=1]="corner",e[e.bezier=2]="bezier"}(n||(t.PointType=n={})),t.PathFillMode=a,function(e){e[e.none=0]="none",e[e.normal=1]="normal",e[e.lighten=2]="lighten",e[e.lightenLess=3]="lightenLess",e[e.darken=4]="darken",e[e.darkenLess=5]="darkenLess"}(a||(t.PathFillMode=a={}));var m,p=function(){function e(t,r){if((0,o.default)(this,e),t instanceof e)this.m_sharedPathStorage=t.m_sharedPathStorage,this.m_transform=r||t.transform;else{var i,n=[],s=h(t.figures);try{for(s.s();!(i=s.n()).done;){var c=i.value;n.push(c instanceof y?c.createFigure():c)}}catch(e){s.e(e)}finally{s.f()}this.m_sharedPathStorage={figures:n,fillMode:null==t.fillMode?a.normal:t.fillMode,lineEnabled:null==t.lineEnabled||t.lineEnabled,extrusionEnabled:null==t.extrusionEnabled||t.extrusionEnabled,glyphCacheId:t.glyphCacheId?{fontId:t.glyphCacheId.fontId,glyphId:t.glyphCacheId.glyphId}:void 0,isUntransformedRect:T(n),untransformedBounds:S(n),renderDataMap:{}},this.m_transform=r||(t.transform?t.transform:l.Transform.Identity)}null===d.s_renderDataMapFinalizationRegistry||void 0===d.s_renderDataMapFinalizationRegistry||d.s_renderDataMapFinalizationRegistry.register(this,this.renderDataMap)}return(0,s.default)(e,[{key:"figures",get:function(){return this.m_sharedPathStorage.figures}},{key:"transform",get:function(){return this.m_transform}},{key:"fillMode",get:function(){return this.m_sharedPathStorage.fillMode}},{key:"lineEnabled",get:function(){return this.m_sharedPathStorage.lineEnabled}},{key:"extrusionEnabled",get:function(){return this.m_sharedPathStorage.extrusionEnabled}},{key:"glyphCacheId",get:function(){return this.m_sharedPathStorage.glyphCacheId}},{key:"maxPressure",get:function(){return 4096}},{key:"renderDataMap",get:function(){return this.m_sharedPathStorage.renderDataMap}},{key:"hasPressureInfo",get:function(){return this.figures.some((function(e){return!!(e.format&m.pressure)}))}},{key:"isUntransformedRect",get:function(){return this.m_sharedPathStorage.isUntransformedRect}},{key:"untransformedBounds",get:function(){return this.m_sharedPathStorage.untransformedBounds}},{key:"measureLength",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.Transform.Identity,r=0,i=h(this.figures);try{for(i.s();!(e=i.n()).done;){var n=e.value;r+=n.measureLength(t)}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"equals",value:function(e){return this.m_sharedPathStorage==e.m_sharedPathStorage&&this.m_transform.equals(e.m_transform)}}],[{key:"CreateFromFigure",value:function(t){return new e({figures:[t]})}},{key:"CreateFromRect",value:function(t){return new e({figures:[v.CreateFromRect(t)]})}}])}();function g(e){var t=(e&m.position?2:0)+(e&m.type?1:0)+(e&m.distance?1:0)+(e&m.pressure?1:0)+(e&m.tilt?2:0);return e&m.alignedVec4&&(t=4*Math.ceil(t/4)),t}t.Path=p,t.pathDistEpsilon=.1,t.TapeDataFlags=m,function(e){e[e.none=0]="none",e[e.position=1]="position",e[e.type=2]="type",e[e.distance=4]="distance",e[e.pressure=8]="pressure",e[e.tilt=16]="tilt",e[e.alignedVec4=32]="alignedVec4"}(m||(t.TapeDataFlags=m={}));var v=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.position|m.type;if((0,o.default)(this,e),this.m_points=t,this.m_isClosed=r,this.m_format=i,this.m_pointDataSize=g(i),this.m_points.length%this.m_pointDataSize!=0)throw c.Log.Error(592520776,"list of points invalid")}return(0,s.default)(e,[{key:"points",get:function(){return this.m_points}},{key:"format",get:function(){return this.m_format}},{key:"pointDataSize",get:function(){return this.m_pointDataSize}},{key:"isClosed",get:function(){return this.m_isClosed}},{key:"isLastPointDuplicated",value:function(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}},{key:"getPointCount",value:function(){return this.m_points.length/this.m_pointDataSize}},{key:"getPoint",value:function(e){var t=this.getPointCount(),r=e<0?e%t+t:e%t;return new l.Vector2(this.m_points[r*this.m_pointDataSize],this.m_points[r*this.m_pointDataSize+1])}},{key:"getPointType",value:function(e){if(!(this.m_format&m.type))return n.corner;var t=this.getPointCount(),r=e<0?e%t+t:e%t;return this.m_points[r*this.m_pointDataSize+2]}},{key:"toPolygon",value:function(){for(var e=this.getPointCount(),t=new y([],this.m_isClosed,m.position),r=0;r<e;r++){var i=this.getPoint(r);if(this.getPointType(r)!=n.bezier)t.pushPoint(i.x,i.y);else for(var a=this.getPoint(r-1),o=this.getPoint(r+1),s=1;s<8;s++){var c=l.Vector2.InterpolateQuadratic(a,i,o,s/8);t.pushPoint(c.x,c.y)}}return t.createFigure()}},{key:"transform",value:function(t){for(var r=this.points.slice(0),i=this.pointDataSize,n=0;n<this.getPointCount();n++){var a=this.getPoint(n).transformPoint(t);r[n*i]=a.x,r[n*i+1]=a.y}return new e(r,this.isClosed,this.format)}},{key:"measureLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.Transform.Identity,t=0;return this.forEachSegment((function(e,r,i){return t+=r?l.Vector2.MeasureQuadraticLength(e,r,i):l.Vector2.Distance(e,i),!0}),e),t}},{key:"getPointFromDist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.Transform.Identity,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0,n=void 0;return this.forEachSegment((function(t,r,a){var o=r?l.Vector2.MeasureQuadraticLength(t,r,a):l.Vector2.Distance(t,a);if(i+o>e)if(r){var s=l.Vector2.GetQuadraticParameterForDistance(t,r,a,e-i);n=l.Vector2.InterpolateQuadratic(t,r,a,s)}else{var c=(e-i)/o;n=l.Vector2.InterpolateLinear(t,a,c)}return(i+=o)<=e}),t,r),n||this.getPoint(r?0:this.getPointCount()-1).transformPoint(t)}},{key:"getTangentFromDist",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.Transform.Identity,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=0;if(this.forEachSegment((function(r,i,a){var o=i?l.Vector2.MeasureQuadraticLength(r,i,a):l.Vector2.Distance(r,a);return n+o>e&&(t={a:r,c:i,b:a,segmentLength:o,localDistance:e-n}),(n+=o)<e}),r,i),t){if(t.c){var a=l.Vector2.GetQuadraticParameterForDistance(t.a,t.c,t.b,t.localDistance);return l.Vector2.QuadraticTangent(t.a,t.c,t.b,a)}return t.b.subtract(t.a).scale(1/t.segmentLength)}}},{key:"forEachSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.Transform.Identity,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getPointCount();if(0!=i)for(var a=r?i-1:0,o=r?0:i-1,s=r?-1:1,c=a;c!=o;c+=s){var u=c+s,d=u+s,h=this.getPointType(u)==n.bezier;if(this.getPointType(c)!=n.bezier&&(this.m_isClosed||u==u%i)&&(!h||this.m_isClosed||d==d%i)){var f=this.getPoint(c).transformPoint(t),m=h?this.getPoint(u).transformPoint(t):void 0,p=this.getPoint(h?d:u).transformPoint(t);if(!e(f,m,p))return}}}}],[{key:"CreateFromRect",value:function(t){return new e([t.left,t.top,1,t.right,t.top,1,t.right,t.bottom,1,t.left,t.bottom,1],!0)}},{key:"CreateFromRoundedRect",value:function(e,t){var r=Math.min(t,Math.min(e.width,e.height)/2),i=new y;return i.moveTo(e.center.x-e.width/2,e.center.y-(e.height/2-r)),i.arcTo(r,r,-Math.PI,Math.PI/2),i.lineTo(e.right-r,e.top),i.arcTo(r,r,-Math.PI/2,Math.PI/2),i.lineTo(e.right,e.bottom-r),i.arcTo(r,r,0,Math.PI/2),i.lineTo(e.left+r,e.bottom),i.arcTo(r,r,Math.PI/2,Math.PI/2),i.lineTo(e.left,e.top+r),i.close(),i.createFigure()}}])}();t.Figure=v;var y=(0,s.default)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.position|m.type;if((0,o.default)(this,e),this._points=t,this.isClosed=r,this.format=i,this.pointDataSize=g(i),this.lastPointX=0,this.lastPointY=0,this._points.length%this.pointDataSize!=0)throw c.Log.Error(592520777,"list of points invalid")}),[{key:"createFigure",value:function(){return new v(this._points,this.isClosed,this.format)}},{key:"pushPoint",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.corner,i=arguments.length>3?arguments[3]:void 0;switch(this.lastPointX=e,this.lastPointY=t,this.pointDataSize){case 2:return void this._points.push(e,t);case 3:return void this._points.push(e,t,r);case 4:return void this._points.push(e,t,r,i?i[0]:0);case 5:return void this._points.push(e,t,r,i?i[0]:0,i?i[1]:0);case 6:return void this._points.push(e,t,r,i?i[0]:0,i?i[1]:0,i?i[2]:0);case 7:return void this._points.push(e,t,r,i?i[0]:0,i?i[1]:0,i?i[2]:0,i?i[3]:0)}throw c.Log.Error(592520778,"Unsupported data size")}},{key:"moveTo",value:function(e,t,r){if(0!=this._points.length)throw c.Log.Error(592520779,"Figures should have only one MoveTo");this.pushPoint(e,t,1,r)}},{key:"moveToPoint",value:function(e,t){this.moveTo(e.x,e.y,t)}},{key:"lineTo",value:function(e,t,r){if(this._points.length<this.pointDataSize)throw c.Log.Error(592520780,"All figures should start with a MoveTo");(Math.abs(e-this.lastPointX)>.1||Math.abs(t-this.lastPointY)>.1)&&this.pushPoint(e,t,1,r)}},{key:"lineToPoint",value:function(e,t){this.lineTo(e.x,e.y,t)}},{key:"quadBezierTo",value:function(e,t,r,i,n){if(this._points.length<this.pointDataSize)throw c.Log.Error(592520781,"All figures should start with a MoveTo");var a=this.lastPointX,o=this.lastPointY;if(Math.abs(r-a)>.1||Math.abs(i-o)>.1){var s=Math.sqrt((e-a)*(e-a)+(t-o)*(t-o)),l=Math.sqrt((r-e)*(r-e)+(i-t)*(i-t)),u=Math.abs(e-a)<.1&&Math.abs(t-o)<.1,d=Math.abs(r-e)<.1&&Math.abs(i-t)<.1;!u&&!d&&Math.abs(s/l)>.1&&Math.abs(l/s)>.1?(this.pushPoint(e,t,2),this.pushPoint(r,i,1,n)):this.pushPoint(r,i,1,n)}}},{key:"quadBezierToPoint",value:function(e,t,r){this.quadBezierTo(e.x,e.y,t.x,t.y,r)}},{key:"cubicBezierTo",value:function(e,t,r,i,n,a){this.cubicBezierToPoint(new l.Vector2(e,t),new l.Vector2(r,i),new l.Vector2(n,a))}},{key:"cubicBezierToPoint",value:function(e,t,r){if(this._points.length<this.pointDataSize)throw c.Log.Error(592520782,"All figures should start with a MoveTo");var i=new l.Vector2(this.lastPointX,this.lastPointY),n=Math.abs(e.x-i.x)<.1&&Math.abs(e.y-i.y)<.1,a=Math.abs(t.x-e.x)<.1&&Math.abs(t.y-e.y)<.1,o=Math.abs(r.x-t.x)<.1&&Math.abs(r.y-t.y)<.1;if(a&&(n||o))n!=o&&this.lineToPoint(r);else for(var s=i,u=i,d=e,h=0;h<4;h++){var f=(h+1)/4,m=l.Vector2.InterpolateQuadratic(i,e,t,f),p=l.Vector2.InterpolateQuadratic(e,t,r,f),g=l.Vector2.InterpolateLinear(m,p,f),v=d.subtract(u).normalized(),y=p.subtract(m).normalized(),_=void 0;if(v&&y&&Math.abs(v.dot(y))<Math.sqrt(2)/2)_=l.Vector2.CalculateLineIntersection(u,d,m,p,l.epsilon);else{var S=(h+.5)/4,T=l.Vector2.InterpolateLinear(l.Vector2.InterpolateQuadratic(i,e,t,S),l.Vector2.InterpolateQuadratic(e,t,r,S),S),b=s.add(g).scale(.5);_=b.add(T.subtract(b).scale(2))}_?this.quadBezierTo(_.x,_.y,g.x,g.y):this.lineTo(g.x,g.y),s=g,u=m,d=p}}},{key:"arcTo",value:function(e,t,r,i){if(this._points.length<this.pointDataSize)throw c.Log.Error(592520783,"All figures should start with a MoveTo");var n=2*Math.PI,a=e<l.epsilon||t<l.epsilon,o=a?r:Math.atan2(e*Math.sin(r),t*Math.cos(r)),s=i<0?-1:1,u=Math.abs(i);if(u>=n)u=n;else{var d=r+u*s;(u=((d=a?d:Math.atan2(e*Math.sin(d),t*Math.cos(d)))-o)*s)<0&&(u+=n)}for(var h=this.lastPointX,f=this.lastPointY,m=h-Math.cos(o)*e,p=f-Math.sin(o)*t,g=Math.ceil(8*Math.abs(u)/n),v=0;v<g;v++){var y=s*n/8,_=o+v*y,S=v==g-1?s*u-v*y:y,T=_+S,b=_+S/2,C=1/Math.cos(S/2),w=new l.Vector2(m+Math.cos(b)*C*e,p+Math.sin(b)*C*t),P=new l.Vector2(m+Math.cos(T)*e,p+Math.sin(T)*t);Math.abs(S)>l.epsilon?this.quadBezierTo(w.x,w.y,P.x,P.y):this.lineTo(P.x,P.y)}}},{key:"close",value:function(){if(this._points.length<this.pointDataSize)throw c.Log.Error(592520784,"All figures should start with a MoveTo");this.isClosed=!0}},{key:"isLastPointDuplicated",value:function(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}},{key:"getPointCount",value:function(){return this._points.length/this.pointDataSize}},{key:"getPoint",value:function(e){var t=this.getPointCount(),r=e<0?e%t+t:e%t;return new l.Vector2(this._points[r*this.pointDataSize],this._points[r*this.pointDataSize+1])}},{key:"data",get:function(){return this._points}}]);t.FigureBuilder=y;var _=(0,s.default)((function e(t,r){(0,o.default)(this,e),this.m_changeTracker=new u.ChangeTracker,this.bounds=t,this.format=r,this.pointDataSize=g(r),this.m_figures=[new y([],!1,r)]}),[{key:"currentFigure",get:function(){return this.m_figures[this.m_figures.length-1]}},{key:"figures",get:function(){return this.m_figures}},{key:"newFigure",value:function(){this.currentFigure.getPointCount()>0&&this.m_figures.push(new y([],!1,this.format))}},{key:"changeTracker",get:function(){return this.m_changeTracker}}]);function S(e){var t,r=void 0,i=h(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(!n.cachedBounds){var a=n.points.length/n.pointDataSize;if(a<1)return;for(var o=n.points[0],s=o,c=n.points[1],u=c,d=0;d<a;d++){var f=d*n.pointDataSize,p=(d-1+a)%a*n.pointDataSize,g=(d+1)%a*n.pointDataSize,v=void 0,y=void 0,_=void 0;n.format&m.type?(v=n.points[f+2],y=n.points[p+2],_=n.points[g+2]):v=y=_=1;var S=n.points[f],T=n.points[f+1];if(1==v&&1==_)o=S<o?S:o,s=S>s?S:s,c=T<c?T:c,u=T>u?T:u;else if(1==y&&2==v&&1==_){var b=n.points[p],C=n.points[p+1],w=n.points[g],P=n.points[g+1];o=w<(o=b<o?b:o)?w:o,s=w>(s=b>s?b:s)?w:s,c=P<(c=C<c?C:c)?P:c,u=P>(u=C>u?C:u)?P:u;var I=(b-S)/(b+w-2*S);if(0<I&&I<1){var k=I*I,E=b*(k-2*I+1)+w*k+2*S*(I-k),x=C*(k-2*I+1)+P*k+2*T*(I-k);o=E<o?E:o,s=E>s?E:s,c=x<c?x:c,u=x>u?x:u}var L=(C-T)/(C+P-2*T);if(0<L&&L<1){var A=L*L,M=b*(A-2*L+1)+w*A+2*S*(L-A),R=C*(A-2*L+1)+P*A+2*T*(L-A);o=M<o?M:o,s=M>s?M:s,c=R<c?R:c,u=R>u?R:u}}}n.cachedBounds=new l.Rect(o,c,s,u)}r=l.Rect.UnionRect(r,n.cachedBounds)}}catch(e){i.e(e)}finally{i.f()}return r}function T(e){if(1!=e.length)return!1;var t=e[0];if((4!=t.getPointCount()||!t.isClosed||t.isLastPointDuplicated())&&(5!=t.getPointCount()||!t.isClosed||!t.isLastPointDuplicated()))return!1;for(var r=[t.getPoint(0),t.getPoint(1),t.getPoint(2),t.getPoint(3)],i=new l.Rect(Math.min(r[0].x,r[1].x,r[2].x,r[3].x),Math.min(r[0].y,r[1].y,r[2].y,r[3].y),Math.max(r[0].x,r[1].x,r[2].x,r[3].x),Math.max(r[0].y,r[1].y,r[2].y,r[3].y)),n=0;n<4;n++){var a=r[n],o=r[(n+1)%4];if(a.x!=i.left&&a.x!=i.right||a.y!=i.top&&a.y!=i.bottom||a.x!=o.x&&a.y!=o.y)return!1}return!0}t.IncrementalPath=_},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.identityMatrix=function(){var e=new o;return e.identity(),e},t.translateMatrix=function(e,t,r){var i=new o;return i.translation(e,t,r),i},t.scaleMatrix=function(e,t,r){var i=new o;return i.scaling(e,t,r),i},t.translateScaleMatrix=s,t.defaultViewModelMatrix=l,t.defaultViewModelProjectionMatrix=function(){var e=c(),t=l();return e.multiply(t)},t.perspectiveMatrix=c,t.ThinMatrix=void 0;var n=i(r(1)),a=i(r(2)),o=function(){function e(){(0,n.default)(this,e),this.updateFlag=-1,this._data=new Float32Array(16)}return(0,a.default)(e,[{key:"asArray",value:function(){return Array.from(this._data)}},{key:"toArray",value:function(){return this._data}},{key:"setValues",value:function(t,r,i,n,a,o,s,l,c,u,d,h,f,m,p,g){var v=this._data;return v[0]=t,v[1]=r,v[2]=i,v[3]=n,v[4]=a,v[5]=o,v[6]=s,v[7]=l,v[8]=c,v[9]=u,v[10]=d,v[11]=h,v[12]=f,v[13]=m,v[14]=p,v[15]=g,e._updateFlagSeed+=1,this.updateFlag=e._updateFlagSeed,this}},{key:"getValueAt",value:function(e){return this._data[e]}},{key:"setValueAt",value:function(t,r){return this._data[t]=r,e._updateFlagSeed+=1,this.updateFlag=e._updateFlagSeed,this}},{key:"identity",value:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"translationColumn",value:function(e,t,r){return this.setValues(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}},{key:"translation",value:function(e,t,r){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1),this}},{key:"scaling",value:function(e,t,r){return this.setValues(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}},{key:"translationScaling",value:function(e,t,r,i,n,a){return this.setValues(i,0,0,0,0,n,0,0,0,0,a,0,e*i,t*n,r*a,1),this}},{key:"rotationX",value:function(e){var t=Math.cos(e),r=Math.sin(e);return this.setValues(1,0,0,0,0,t,r,0,0,-r,t,0,0,0,0,1),this}},{key:"rotationY",value:function(e){var t=Math.cos(e),r=Math.sin(e);return this.setValues(t,0,-r,0,0,1,0,0,r,0,t,0,0,0,0,1),this}},{key:"rotationZ",value:function(e){var t=Math.cos(e),r=Math.sin(e);return this.setValues(t,r,0,0,-r,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5;return this.setValues(1,0,0,0,0,1,0,0,e,e,1,2*e,0,0,0,1),this}},{key:"multiply",value:function(e){return this.multiplyToRef(e,this)}},{key:"multiplyToRef",value:function(e,t){var r=this._data,i=e._data,n=r[0],a=r[1],o=r[2],s=r[3],l=r[4],c=r[5],u=r[6],d=r[7],h=r[8],f=r[9],m=r[10],p=r[11],g=r[12],v=r[13],y=r[14],_=r[15],S=i[0],T=i[1],b=i[2],C=i[3],w=i[4],P=i[5],I=i[6],k=i[7],E=i[8],x=i[9],L=i[10],A=i[11],M=i[12],R=i[13],O=i[14],D=i[15],F=n*S+a*w+o*E+s*M,B=n*T+a*P+o*x+s*R,N=n*b+a*I+o*L+s*O,V=n*C+a*k+o*A+s*D,U=l*S+c*w+u*E+d*M,W=l*T+c*P+u*x+d*R,G=l*b+c*I+u*L+d*O,H=l*C+c*k+u*A+d*D,j=h*S+f*w+m*E+p*M,z=h*T+f*P+m*x+p*R,q=h*b+f*I+m*L+p*O,Z=h*C+f*k+m*A+p*D,X=g*S+v*w+y*E+_*M,Y=g*T+v*P+y*x+_*R,J=g*b+v*I+y*L+_*O,K=g*C+v*k+y*A+_*D;return t.setValues(F,B,N,V,U,W,G,H,j,z,q,Z,X,Y,J,K),t}}])}();function s(e,t,r,i,n,a){var s=new o;return s.translationScaling(e,t,r,i,n,a),s}function l(){return s(-.5,-.5,0,2,2,1)}function c(){var e=new o;return e.perspective(),e}t.ThinMatrix=o,o._updateFlagSeed=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aDirection=t.aDistance=t.aCenter=t.aDelay=t.aTexcoord=t.aPosition=void 0,t.aPosition=function(e){return{name:"aPosition",data:e.getVertexPositions(),itemSize:3}},t.aTexcoord=function(e){return{name:"aTexcoord",data:e.getTextureCoords(),itemSize:2}},t.aDelay=function(e){return{name:"aDelay",data:e.getDelays(),itemSize:1}},t.aCenter=function(e){return{name:"aCenter",data:e.getCenter(),itemSize:2}},t.aDistance=function(e){return{name:"aDistance",data:e.getRippleDistance(),itemSize:1}},t.aDirection=function(e,t){return{name:"aDirection",data:e.getDirections(t),itemSize:2}}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.forEachShape=F,t.forEachPath=function(e,t){F(e,(function(e){var r,i=x(e.paths||[]);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(!t(n))return!1}}catch(e){i.e(e)}finally{i.f()}return!0}))},t.getPenAlignmentValue=B,t.getBoundsOfPaths=N,t.getBoundsForEffects=V,t.getAlignmentPoint=G,t.getEffectTransformsMatrix=H,t.GetBrush=function(e,t,r){var i=e.getType();if(i==n.shape){var a=e.style;switch(void 0!==r&&r>=0&&e.effects.echo&&r<e.effects.echo.instances.length&&(a=e.effects.echo.instances.getAt(r).style),t){case U.fill:return a.fillBrush;case U.line:return a.lineBrush;case U.picture:return a.pictureBrush}}if(i==n.group&&t==U.fill)return e.groupFillBrush;b.Log.Error(591192835,"Invalid item or brush")},t.tryGetShapeSimpleImage=function(e){if(e.isSolidRectGeometry()&&!e.style.hasLine&&!e.effects.hasEffects&&!e.shape3D&&!e.text&&(e.style.fillBrush||e.style.pictureBrush)&&(!e.style.fillBrush||!e.style.pictureBrush)){var t=e.style.fillBrush||e.style.pictureBrush;if(t instanceof _.ImageBrush&&t.isStretched&&t.scale.equals(p.Vector2.One)&&t.offset.equals(p.Vector2.Zero)&&t.rotateWithShape&&1===t.opacity)return t.image}},t.ensureTextShapesGenerated=j,t.BrushSource=t.EffectFlags=t.Group=t.Shape=t.Item=t.Instance=t.MergeMode=t.OverlapMode=t.ShapeRole=t.ItemType=void 0;var n,a,o,s,l=i(r(18)),c=i(r(9)),u=i(r(31)),d=i(r(8)),h=i(r(10)),f=i(r(2)),m=i(r(1)),p=r(12),g=r(39),v=r(104),y=r(70),_=r(16),S=r(27),T=r(37),b=r(13),C=r(103),w=r(59),P=r(36),I=r(128),k=r(129);function E(e,t,r){return t=(0,d.default)(t),(0,c.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,d.default)(e).constructor):t.apply(e,r))}function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return L(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.ItemType=n,function(e){e[e.unknown=0]="unknown",e[e.shape=1]="shape",e[e.group=2]="group"}(n||(t.ItemType=n={})),t.ShapeRole=a,function(e){e[e.unknown=0]="unknown",e[e.background=1]="background",e[e.titlePlaceholder=2]="titlePlaceholder",e[e.text=3]="text",e[e.textImageNotLocal=4]="textImageNotLocal"}(a||(t.ShapeRole=a={})),t.OverlapMode=o,function(e){e[e.alternate=0]="alternate",e[e.winding=1]="winding"}(o||(t.OverlapMode=o={})),t.MergeMode=s,function(e){e[e.fragment=0]="fragment",e[e.union=1]="union"}(s||(t.MergeMode=s={}));var A=(0,f.default)((function e(t,r){(0,m.default)(this,e),this.transform=t,this.opacity=null==r?void 0:r.opacity,this.colorMatrix=null==r?void 0:r.colorMatrix,this.colorOffset=null==r?void 0:r.colorOffset,this.colorize=null==r?void 0:r.colorize,this.groupIndex=null==r?void 0:r.groupIndex}));t.Instance=A,A.DefaultArray=[new A(p.Matrix3.Identity)];var M=(0,f.default)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new y.Effects,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.Transform.Identity,i=arguments.length>2?arguments[2]:void 0;(0,m.default)(this,e),this.m_animationChangeTracker=new T.ChangeTracker,this.renderDataMap={},this.m_changeTracker=new T.ChangeTracker(i),this.m_alphaTracker=new T.ChangeTracker(i),this.m_changeTracker.replaceListener(void 0,t),this.m_alphaTracker.replaceListener(void 0,t),T.ChangeTracker.AddListener(null==t?void 0:t.animationChangeTracker,this.m_animationChangeTracker),this.m_effects=t,this.m_isHidden=!1,this.m_isHitTestHidden=!1,this.m_transform=r,null===C.s_renderDataMapFinalizationRegistry||void 0===C.s_renderDataMapFinalizationRegistry||C.s_renderDataMapFinalizationRegistry.register(this,this.renderDataMap)}),[{key:"cloneItemData",value:function(e){var t,r;e.effects=this.m_effects.clone(),e.m_transform=this.m_transform,e.fade=this.m_fade?this.m_fade.clone():void 0,e.m_animationTransform=this.m_animationTransform,e.m_fillBoundsOverride=this.m_fillBoundsOverride,e.m_effectsBoundsOverride=this.m_effectsBoundsOverride,e.m_scene3D=this.m_scene3D,e.m_isHidden=this.m_isHidden,e.m_isHitTestHidden=this.m_isHitTestHidden,e.m_instanceOffsets=null===(t=this.m_instanceOffsets)||void 0===t?void 0:t.slice(0),e.m_instances=null===(r=this.m_instances)||void 0===r?void 0:r.slice(0),e.m_clipBounds=this.m_clipBounds,e.clientData=this.clientData}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"animationChangeTracker",get:function(){return this.m_animationChangeTracker}},{key:"alphaTracker",get:function(){return this.m_alphaTracker}},{key:"notifyChange",value:function(){this.m_changeTracker.notifyChange()}},{key:"version",get:function(){return this.m_changeTracker.version}},{key:"effects",get:function(){return this.m_effects},set:function(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects&&T.ChangeTracker.RemoveListener(this.m_effects.animationChangeTracker,this.m_animationChangeTracker),e&&T.ChangeTracker.AddListener(e.animationChangeTracker,this.m_animationChangeTracker),this.m_effects=e}},{key:"transform",get:function(){return this.m_transform},set:function(e){this.m_transform.equals(e)||(this.onTransformChanged(this.m_transform,e),this.notifyChange(),this.m_transform=e)}},{key:"isHidden",get:function(){return this.m_isHidden},set:function(e){(0,w.notifyIfDifferent)(this.m_changeTracker,this.m_isHidden,e),this.m_isHidden=e}},{key:"isHitTestHidden",get:function(){return this.m_isHitTestHidden},set:function(e){(0,w.notifyIfDifferent)(this.m_changeTracker,this.m_isHitTestHidden,e),this.m_isHitTestHidden=e}},{key:"instanceOffsets",get:function(){return this.m_instanceOffsets},set:function(e){this.m_instanceOffsets=e?e.slice(0):void 0,this.m_instances=e?e.map((function(e){return new A(p.Matrix3.Translation2D(e))})):void 0}},{key:"instances",get:function(){return this.m_instances},set:function(e){this.m_instances=e?e.slice(0):void 0}},{key:"fade",get:function(){return this.m_fade},set:function(e){this.m_animationChangeTracker.replaceListener(this.m_fade,e),this.m_fade=e}},{key:"animationTransform",get:function(){return this.m_animationTransform},set:function(e){(0,w.notifyIfNotEquals)(this.m_animationChangeTracker,this.m_animationTransform,e),this.m_animationTransform=e}},{key:"fillBoundsOverride",get:function(){return this.m_fillBoundsOverride},set:function(e){(0,w.notifyIfNotEquals)(this.m_changeTracker,this.m_fillBoundsOverride,e),this.m_fillBoundsOverride=e}},{key:"effectsBoundsOverride",get:function(){return this.m_effectsBoundsOverride},set:function(e){(0,w.notifyIfNotEquals)(this.m_changeTracker,this.m_effectsBoundsOverride,e),this.m_effectsBoundsOverride=e}},{key:"scene3D",get:function(){return this.m_scene3D},set:function(e){this.m_scene3D!=e&&(this.notifyChange(),this.m_scene3D=e,this.clearCache())}},{key:"clipBounds",get:function(){return this.m_clipBounds},set:function(e){(0,w.notifyIfNotEquals)(this.changeTracker,this.m_clipBounds,e),(0,w.notifyIfNotEquals)(this.alphaTracker,this.m_clipBounds,e),this.m_clipBounds=e}},{key:"getBounds",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return V(this,t,r?O.all:O.none,r?O.all:O.none,null==i?void 0:i.toMatrix3(),!0,void 0,e)}},{key:"onTransformChanged",value:function(e,t){}},{key:"clearCache",value:function(){for(var e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}},{key:"releaseGeneratedResources",value:function(){this.clearCache();var e,t=x(this.getBrushImages());try{for(t.s();!(e=t.n()).done;)e.value.releaseGeneratedResources()}catch(e){t.e(e)}finally{t.f()}}}]);t.Item=M;var R=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _.Style,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new y.Effects,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.Transform.Identity;return(0,m.default)(this,t),(e=E(this,t,[n,l])).m_role=a.unknown,e.m_geometryTracker=new T.ChangeTracker,e.m_paths=r,e.m_overlapMode=o.alternate,e.m_mergeMode=s.fragment,e.changeTracker.replaceListener(void 0,i),T.ChangeTracker.AddListener(i.penChangeTracker,e.m_geometryTracker),T.ChangeTracker.AddListener(i.alphaChangeTracker,e.alphaTracker),T.ChangeTracker.AddListener(e.m_geometryTracker,e.alphaTracker),e.m_style=i,e}return(0,h.default)(t,e),(0,f.default)(t,[{key:"clone",value:function(){var e=new t;return e.paths=this.m_paths?this.m_paths.slice(0):void 0,e.m_overlapMode=this.m_overlapMode,e.m_mergeMode=this.m_mergeMode,e.style=this.m_style.clone(),e.m_shape3D=this.m_shape3D,e.text=this.m_text?this.m_text.clone():void 0,e.m_textEffectMetrics=this.m_textEffectMetrics,e.m_role=this.m_role,this.cloneItemData(e),e}},{key:"paths",get:function(){return this.m_paths},set:function(e){this.clearPathCache(),this.notifyGeometryChange(),this.m_paths=null==e?void 0:e.slice(0)}},{key:"incrementalPath",get:function(){return this.m_incrementalPath},set:function(e){this.changeTracker.replaceListener(this.m_incrementalPath,e),this.alphaTracker.replaceListener(this.m_incrementalPath,e),this.m_incrementalPath=e}},{key:"overlapMode",get:function(){return this.m_overlapMode},set:function(e){this.m_overlapMode!=e&&(this.notifyGeometryChange(),this.m_overlapMode=e)}},{key:"mergeMode",get:function(){return this.m_mergeMode},set:function(e){this.m_mergeMode!=e&&(this.notifyGeometryChange(),this.m_mergeMode=e)}},{key:"style",get:function(){return this.m_style},set:function(e){this.m_style!=e&&(T.ChangeTracker.RemoveListener(this.m_style.penChangeTracker,this.m_geometryTracker),T.ChangeTracker.AddListener(e.penChangeTracker,this.m_geometryTracker),T.ChangeTracker.RemoveListener(this.m_style.alphaChangeTracker,this.alphaTracker),T.ChangeTracker.AddListener(e.alphaChangeTracker,this.alphaTracker),this.changeTracker.replaceListener(this.m_style,e),this.m_style=e)}},{key:"shape3D",get:function(){return this.m_shape3D},set:function(e){this.m_shape3D!=e&&(this.notifyGeometryChange(),this.m_shape3D=e)}},{key:"text",get:function(){return this.m_text},set:function(e){this.m_text!=e&&(this.m_text&&(this.m_text.cache&&this.m_text.cache.clearCache(),T.ChangeTracker.RemoveListener(this.m_text.changeTracker,this.changeTracker),T.ChangeTracker.RemoveListener(this.m_text.changeTracker,this.alphaTracker),T.ChangeTracker.RemoveListener(this.m_text.animationChangeTracker,this.animationChangeTracker)),this.m_text=e,this.m_text&&(T.ChangeTracker.AddListener(this.m_text.changeTracker,this.changeTracker),T.ChangeTracker.AddListener(this.m_text.changeTracker,this.alphaTracker),T.ChangeTracker.AddListener(this.m_text.animationChangeTracker,this.animationChangeTracker)))}},{key:"textEffectMetrics",get:function(){return this.m_textEffectMetrics},set:function(e){(0,w.notifyIfNotEquals)(this.changeTracker,this.m_textEffectMetrics,e),(0,w.notifyIfNotEquals)(this.alphaTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}},{key:"role",get:function(){return this.m_role},set:function(e){this.m_role!=e&&(this.notifyChange(),this.m_geometryTracker.notifyChange(),this.m_role=e)}},{key:"onTransformChanged",value:function(e,t){e.scale.equals(t.scale)||this.m_geometryTracker.notifyChange()}},{key:"clearCache",value:function(){(0,u.default)((0,d.default)(t.prototype),"clearCache",this).call(this),this.text&&this.text.cache&&(this.text.cache.clearCache(),this.text.cache=void 0),this.clearPathCache(),this.clearBoundsCache()}},{key:"clearPathCache",value:function(){var e,t=x(this.paths||[]);try{for(t.s();!(e=t.n()).done;){var r=e.value;for(var i in r.renderDataMap)r.renderDataMap[i].releaseGeneratedResources()}}catch(e){t.e(e)}finally{t.f()}}},{key:"clearBoundsCache",value:function(){this.shapeBoundsCache=void 0}},{key:"geometryTracker",get:function(){return this.m_geometryTracker}},{key:"notifyGeometryChange",value:function(){this.notifyChange(),this.m_geometryTracker.notifyChange(),this.clearBoundsCache()}},{key:"getBrushImages",value:function(){var e=this.style.getBrushImages();return this.text&&e.push.apply(e,(0,l.default)(this.text.getBrushImages())),e}},{key:"isSolidRectGeometry",value:function(){return!(!this.m_paths||1!=this.m_paths.length||!this.m_paths[0].isUntransformedRect||this.m_paths[0].fillMode!=S.PathFillMode.normal||this.m_paths[0].transform instanceof p.Matrix3||this.m_paths[0].transform instanceof p.Transform&&0!=this.m_paths[0].transform.rotation)}},{key:"isSolidRect",value:function(){return!(!this.isSolidRectGeometry()||this.style.hasLine||this.style.pictureOverflow>0||this.text&&this.text.renderMode!=g.TextRenderMode.TextInFrontOfShape)}},{key:"hasSmallDetails",value:function(){return this.role==a.text||this.style.hasLine&&this.style.pen.lineWidth<3||this.m_paths&&this.m_paths.some((function(e){return e.hasPressureInfo}))}},{key:"getType",value:function(){return n.shape}}],[{key:"CreateRectangle",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _.Style,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new y.Effects,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.Transform.Identity;return new t([S.Path.CreateFromRect(e)],r,i,n)}}])}(M);t.Shape=R;var O,D=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new y.Effects,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.Transform.Identity,a=arguments.length>3?arguments[3]:void 0;(0,m.default)(this,t);var o=r instanceof T.TrackableArray?r:new T.TrackableArray(r,a||P.s_deferGroupTracking);return(e=E(this,t,[i,n,a?function(){return""}:o.deferTracking?function(){return o.getHash()}:void 0])).changeTracker.replaceListener(void 0,o),e.alphaTracker.replaceListener(void 0,o),e.m_items=o,e.m_opacity=1,e}return(0,h.default)(t,e),(0,f.default)(t,[{key:"clone",value:function(){var e,r=new t,i=x(this.m_items.elements);try{for(i.s();!(e=i.n()).done;){var n=e.value;r.items.push(n.clone())}}catch(e){i.e(e)}finally{i.f()}return r.groupFillBrush=this.m_groupFillBrush?this.m_groupFillBrush.clone():void 0,r.m_isDocumentShape=this.m_isDocumentShape,this.cloneItemData(r),r}},{key:"items",get:function(){return this.m_items},set:function(e){this.setItems(e)}},{key:"groupFillBrush",get:function(){return this.m_groupFillBrush},set:function(e){this.m_groupFillBrush=e}},{key:"isDocumentShape",get:function(){return this.m_isDocumentShape},set:function(e){this.m_isDocumentShape=e}},{key:"opacity",get:function(){return this.m_opacity},set:function(e){this.m_opacity!=e&&(this.notifyChange(),this.m_opacity=e)}},{key:"setItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=e instanceof T.TrackableArray?e:new T.TrackableArray(e);this.changeTracker.replaceListener(this.m_items,t),this.alphaTracker.replaceListener(this.m_items,t),this.m_items=t}},{key:"clearCache",value:function(){(0,u.default)((0,d.default)(t.prototype),"clearCache",this).call(this);for(var e=0;e<this.m_items.length;e++)this.m_items.getAt(e).clearCache()}},{key:"getBrushImages",value:function(){var e,t=(0,_.getBrushImagesFromBrush)(this.groupFillBrush),r=x(this.m_items.elements);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push.apply(t,(0,l.default)(i.getBrushImages()))}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"getType",value:function(){return n.group}}])}(M);function F(e,t){if(!e)return!0;if(e.getType()==n.shape){var r=e;if(t(r),r.text&&r.text.cache){var i,a=x(r.text.cache.getTextShapes());try{for(a.s();!(i=a.n()).done;)if(!F(i.value,t))return!1}catch(e){a.e(e)}finally{a.f()}var o,s=x(r.text.cache.getSelectionShapes()||[]);try{for(s.s();!(o=s.n()).done;)if(!F(o.value,t))return!1}catch(e){s.e(e)}finally{s.f()}}}else{if(e.getType()!=n.group)throw b.Log.Error(591525086,"Unknown Item type");var l,c=x(e.items.elements);try{for(c.s();!(l=c.n()).done;)if(!F(l.value,t))return!1}catch(e){c.e(e)}finally{c.f()}}return!0}function B(e){return e.alignment==_.PenAlignment.in?-1:e.alignment==_.PenAlignment.out?1:0}function N(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(e.incrementalPath)return r?e.incrementalPath.bounds.transformedBounds(r):e.incrementalPath.bounds;e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version});var i=0;t&&e.style.hasLine&&(i=e.style.pen.adjustedLineWidth*(.5+Math.abs(Math.max(B(e.style.pen))))),t&&e.shape3D&&e.shape3D.adjustedContourWidth>0&&(i+=.5*e.shape3D.adjustedContourWidth);var n=!r||r.isSimpleScaleTranslationOnly(),a=i?e.shapeBoundsCache.pathsBoundsWithLine:e.shapeBoundsCache.pathsBounds;if(!a&&!i&&n&&e.paths&&(a=e.shapeBoundsCache.pathsBounds=(0,v.tryGetQuickBoundsOfPaths)(e.paths)),a){if(!r)return a;if(n)return a.multiply(r.getSimpleScale()).translate(r.getSimpleTranslation())}var o=i?e.shapeBoundsCache.pathsBoundsContributorsWithLine:e.shapeBoundsCache.pathsBoundsContributors;if(!o){var s=p.Matrix3.Scale2D(e.transform.scale);o=[],e.paths&&(0,v.getBoundsContributorsFromPaths)(e.paths,i,e.style,s,null!=e.shape3D,o),i?e.shapeBoundsCache.pathsBoundsContributorsWithLine=o:e.shapeBoundsCache.pathsBoundsContributors=o}var l,c=p.Matrix3.Scale2D(e.transform.scale.inverse()),u=r?c.multiply(r):c,d=void 0,h=x(o||[]);try{for(h.s();!(l=h.n()).done;){var f=l.value,m=(0,v.getBoundsFromContributor)(f,u);d=p.Rect.UnionRect(d,m)}}catch(e){h.e(e)}finally{h.f()}if(d&&n){var g=null==r?void 0:r.getSimpleScale(),y=!r||g&&Math.abs(g.x)>p.epsilon&&Math.abs(g.y)>p.epsilon;if(y){var _=r?d.translate(r.getSimpleTranslation().negate()).multiply(r.getSimpleScale().inverse()):d;t?e.shapeBoundsCache.pathsBoundsWithLine=_:e.shapeBoundsCache.pathsBounds=_}}return d}function V(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=c?e.animationTransform:void 0,d=o&&u?o.multiply(u):o||u,h=d?e.transform.toMatrix3().multiply(d):e.transform.toMatrix3(),f=void 0;if(e.getType()==n.shape){var m=e;if(l||(f=N(m,!0,h)),m.text&&t&&(s||l)){var g=new p.Transform(p.Vector2.Zero,p.Vector2.One,e.transform.rotation,e.transform.translation),v=m.text.hasAnimationProps()?o:d,y=v?g.toMatrix3().multiply(v):g.toMatrix3(),_=j(m);if(_){var S,T=x(_.textShapes);try{for(T.s();!(S=T.n()).done;){var b=S.value;l&&b.textRange&&!l.intersects(b.textRange)||(f=p.Rect.UnionRect(f,b.getBounds(c,t,!0,y)))}}catch(e){T.e(e)}finally{T.f()}}}}else if(e.getType()==n.group&&!l&&s)for(var C=e,w=0;w<C.items.length;w++){var P=C.items.getAt(w),I=P instanceof R&&P.role==a.text;!t&&I||(f=p.Rect.UnionRect(f,V(P,t,i,i,h)))}if(!l){var E,L,A=r&O.replicate&&e.effects&&e.effects.replicate,M=r&O.echo&&e.effects&&e.effects.echo&&e instanceof R,D=r&O.border&&e.effects&&e.effects.border&&e.effects.border.radius,F=r&O.glow&&e.effects&&e.effects.glow&&e.effects.glow.radius,B=r&O.shadow&&e.effects&&e.effects.shadow,U=r&O.reflection&&e.effects&&e.effects.reflection;if((A||M||D||F||B||U)&&(L=d?V(e,t,r,i):f),(B||U)&&(E=e.effectsBoundsOverride?e.effectsBoundsOverride:V(e,!1,O.none,O.echo|O.border|O.glow)),f&&L&&r&O.border&&e.effects&&e.effects.border&&e.effects.border.radius&&(L=L.inflate(e.effects.border.radius),f=f.inflate(e.effects.border.radius)),f&&L&&r&O.replicate&&e.effects.replicate){var W,z=V(e,!0,O.none,O.none),q=(null!==(W=e.effectsBoundsOverride)&&void 0!==W?W:e instanceof R)?N(e,!1,e.transform.toMatrix3()):z;if(q&&z){var Z=(0,k.getBoundsForReplicate)(q,z,e.effects.replicate.bottomSlices||[]),X=(0,k.getBoundsForReplicate)(q,z,e.effects.replicate.topSlices||[]),Y=p.Rect.UnionRect(Z,X);L=p.Rect.UnionRect(L,Y),f=p.Rect.UnionRect(f,d?null==Y?void 0:Y.transformedBounds(d):Y)}}if(f&&L&&r&O.echo&&e.effects&&e.effects.echo&&e instanceof R){var J=N(e,!1);if(J){var K,Q=x(e.effects.echo.instances.elements);try{for(Q.s();!(K=Q.n()).done;){var $,ee,te,re=K.value,ie=null!==($=null!==(ee=null===(te=e.effectsBoundsOverride)||void 0===te?void 0:te.center)&&void 0!==ee?ee:null==J?void 0:J.center.transformPoint(e.transform))&&void 0!==$?$:p.Vector2.Zero,ne=p.Matrix3.FromTransforms(e.transform,p.Matrix3.Translation2D(ie.negate()),re.transform,p.Matrix3.Translation2D(ie));L=p.Rect.UnionRect(L,N(e,!0,ne)),f=p.Rect.UnionRect(f,N(e,!0,d?ne.multiply(d):ne))}}catch(e){Q.e(e)}finally{Q.f()}}}if(f&&L&&r&O.glow&&e.effects&&e.effects.glow&&e.effects.glow.radius&&(L=L.inflate(2*e.effects.glow.radius),f=f.inflate(2*e.effects.glow.radius)),(B||U)&&!t&&e instanceof R&&e.text){var ae=V(e,!0,r,i);ae&&(L=p.Rect.UnionRect(L,ae))}if(f&&L&&E&&r&O.shadow&&e.effects&&e.effects.shadow){var oe=G(e.effects.shadow.alignment,E),se=H(e.effects.shadow.angle,e.effects.shadow.distance,e.effects.shadow.scale,e.effects.shadow.skew,oe),le=(e.effects.shadow.radius?L.inflate(e.effects.shadow.radius):L).transformedBounds(d?se.multiply(d):se),ce=(e.effects.shadow.radius?L.inflate(e.effects.shadow.radius):L).transformedBounds(d?se.multiply(d):se);L=p.Rect.UnionRect(L,le),f=p.Rect.UnionRect(f,ce)}if(f&&L&&E&&r&O.reflection&&e.effects&&e.effects.reflection){var ue=e.effects.reflection,de=E.bottom+e.effects.reflection.distance/2;e instanceof R&&e.textEffectMetrics&&(de-=e.textEffectMetrics.descent);var he=p.Matrix3.Translation2D(new p.Vector2(0,-de)).multiply(p.Matrix3.Scale2D(new p.Vector2(1,-1))).multiply(p.Matrix3.Translation2D(new p.Vector2(0,de))),fe=(ue.radius?L.inflate(ue.radius):L).transformedBounds(he),me=d?(ue.radius?L.inflate(ue.radius):L).transformedBounds(he.multiply(d)):fe;f=p.Rect.UnionRect(f,me)}}return f}t.Group=D,t.EffectFlags=O,function(e){e[e.none=0]="none",e[e.glow=1]="glow",e[e.shadow=2]="shadow",e[e.reflection=4]="reflection",e[e.innerShadow=8]="innerShadow",e[e.softEdges=16]="softEdges",e[e.border=32]="border",e[e.echo=64]="echo",e[e.replicate=128]="replicate",e[e.all=255]="all"}(O||(t.EffectFlags=O={}));var U,W=[new p.Vector2(0,0),new p.Vector2(.5,0),new p.Vector2(1,0),new p.Vector2(0,.5),new p.Vector2(.5,.5),new p.Vector2(1,.5),new p.Vector2(0,1),new p.Vector2(.5,1),new p.Vector2(1,1)];function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t?W[e].multiply(t.size).add(t.leftTop):W[e]}function H(e,t,r,i,n){var a=p.Matrix3.Translation2D(n.negate()),o=new p.Vector2(t,0).rotate(e).add(n),s=new p.Matrix3(r.x,i.y,0,i.x,r.y,0,o.x,o.y,1);return a.multiply(s)}function j(e){if(e.text)return e.text.cache||(e.text.cache=new I.TextGeneratedShapesCache),e.text.cache.update(e.text),e.text.cache}t.BrushSource=U,function(e){e[e.fill=0]="fill",e[e.line=1]="line",e[e.picture=2]="picture"}(U||(t.BrushSource=U={}))},function(e,t,r){var i=r(220);function n(t,r,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=n=Reflect.get:e.exports=n=function(e,t,r){var n=i(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}},n(t,r,a||t)}e.exports=n},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Mesh=t.MeshInfo=t.Vector3=t.Vector2=t.RippleType=t.DelayFormula=t.Direction2D=t.MeshType=void 0;var n,a,o,s,l,c=i(r(5)),u=i(r(2)),d=i(r(1)),h=r(21);t.MeshType=a,function(e){e[e.Smooth=0]="Smooth",e[e.Square=1]="Square",e[e.Diamond=2]="Diamond",e[e.Hexagon=3]="Hexagon",e[e.Radial=4]="Radial",e[e.LinearExplosion=5]="LinearExplosion"}(a||(t.MeshType=a={})),t.Direction2D=o,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e[e.SplitHorizontal=8]="SplitHorizontal",e[e.SplitVertical=9]="SplitVertical",e[e.CombHorizontal=10]="CombHorizontal",e[e.CombVertical=11]="CombVertical",e[e.Radial=12]="Radial",e[e.Random=13]="Random",e[e.MAX=14]="MAX"}(o||(t.Direction2D=o={})),t.DelayFormula=s,function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Top=2]="Top",e[e.TopLeft=3]="TopLeft",e[e.TopRight=4]="TopRight",e[e.SplitHorizontal=5]="SplitHorizontal",e[e.SplitVertical=6]="SplitVertical",e[e.Diamond=7]="Diamond",e[e.Box=8]="Box",e[e.Circle=9]="Circle",e[e.Plus=10]="Plus",e[e.Clock1=11]="Clock1",e[e.Clock2=12]="Clock2",e[e.Clock3=13]="Clock3",e[e.Clock4=14]="Clock4",e[e.Clock8=15]="Clock8",e[e.CounterClock1=16]="CounterClock1",e[e.CounterClock4=17]="CounterClock4",e[e.Wedge=18]="Wedge",e[e.Random=19]="Random",e[e.FromCenter=20]="FromCenter"}(s||(t.DelayFormula=s={})),t.RippleType=l,function(e){e[e.RippleBottomRight=4]="RippleBottomRight",e[e.RippleBottomLeft=5]="RippleBottomLeft",e[e.RippleTopRight=6]="RippleTopRight",e[e.RippleTopLeft=7]="RippleTopLeft",e[e.RippleCenter=29]="RippleCenter"}(l||(t.RippleType=l={}));var f=(0,u.default)((function e(t,r){(0,d.default)(this,e),this.x=t,this.y=r}));t.Vector2=f;var m=(0,u.default)((function e(t,r,i){(0,d.default)(this,e),this.x=t,this.y=r,this.z=i}));t.Vector3=m;var p=(0,u.default)((function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,d.default)(this,e),this.meshType=t.meshType,this.hres=t.hres,this.vres=t.vres,this.delayFormula=t.delayFormula,this.directionFormula=t.directionFormula,this.aspectRatio=t.aspectRatio,this.invertDelay=t.invertDelay,this.forward=t.forward,this.isCenterBufferReq=!!t.isCenterBufferReq||r,this.rippleType=t.m_rippleType,this.randomCenters=t.randomCenters,this.jitter=t.jitter}));t.MeshInfo=p;var g=function(){function e(){(0,d.default)(this,e),this.vertexPositions=new Float32Array,this.vertexIndices=new Uint16Array,this.textureCoords=new Float32Array,this.vertexDelays=new Float32Array,this.rippleDistanceData=new Float32Array,this.center=new Float32Array,this.directionFormulaFunc=C[o.Random],this.delayFormulaFunc=y[s.None]}return(0,u.default)(e,[{key:"addPolygon",value:function(e,t,r,i,n,a,o,s,l,c,u,d){var f=this.meshInfo;if(f){for(var m,p,g,v=0;v<e.length;v+=1){var y=3*(s*e.length+v),_=(l+e[v].x)*o/u,S=(c+e[v].y)*o/d;t[y]=_,t[y+1]=S,t[y+2]=0;var T=2*(s*e.length+v);r[T]=_,r[T+1]=S,this.delayFormulaFunc&&(m||(m=b(l/u,c/d,f.aspectRatio,f.invertDelay,f.jitter,this.delayFormulaFunc)),i[y/3]=m),f.isCenterBufferReq&&(f.randomCenters?(p&&g||(p=this.calculateCenter(l/u,c/d,f.randomCenters).x,g=this.calculateCenter(l/u,c/d,f.randomCenters).y),n&&(n[y/3*2]=p,n[y/3*2+1]=g)):n&&(n[y/3*2]=this.calculateCenter(l/u,c/d,f.randomCenters).x,n[y/3*2+1]=this.calculateCenter(l/u,c/d,f.randomCenters).y))}for(var C=0;C<e.length-2;C+=1){var w=3*(s*(e.length-2)+C),P=s*e.length;a[w]=P,a[w+1]=P+C+1,a[w+2]=P+C+2}}else(0,h.logError)("MeshInfo undefined")}},{key:"createSquare",value:function(e){for(var t=e.hres,r=e.vres,i=[{x:-.5,y:.5},{x:.5,y:.5},{x:.5,y:-.5},{x:-.5,y:-.5}],n=new Float32Array(t*r*3*i.length),a=new Float32Array(t*r*2*i.length),o=new Uint16Array(t*r*3*(i.length-2)),s=new Float32Array(n.length/3),l=e.isCenterBufferReq?new Array(2*n.length/3):void 0,c=0,u=0;u<r;u+=1)for(var d=0;d<t;d+=1)this.addPolygon(i,n,a,s,l,o,1,c,d+.5,u+.5,t,r),c+=1;this.vertexPositions=n,this.vertexIndices=o,this.textureCoords=a,this.vertexDelays=s,this.center=l}},{key:"createRadial",value:function(e){for(var t=4*(e.hres+1),r=new Array(t),i=new Float32Array(2*t*3),n=new Float32Array(2*t*2),a=new Uint16Array(3*t),o=new Float32Array(2*t),s=0,l=0;l<t/4;l+=1)r[s]=new f(l/(t/4),0),s+=1;for(var c=0;c<t/4;c+=1)r[s]=new f(1,c/(t/4)),s+=1;for(var u=t/4;u>0;u-=1)r[s]=new f(u/(t/4),1),s+=1;for(var d=t/4;d>0;d-=1)r[s]=new f(0,d/(t/4)),s+=1;var h=0,m=0,p=0;s=0;for(var g=0,v=r;g<v.length;g++){var y=v[g];p=b(y.x,y.y,e.aspectRatio,e.invertDelay,e.jitter,this.delayFormulaFunc),o[2*s]=p,o[2*s+1]=p,i[h]=y.x,i[h+1]=y.y,i[h+2]=0,i[h+3]=.5,i[h+4]=.5,i[h+5]=0,h+=6,n[m]=y.x,n[m+1]=y.y,n[m+2]=.5,n[m+3]=.5,m+=4,s+=1}for(h=0,s=0;s<t-1;s+=1)a[h]=2*s,a[h+1]=2*s+1,a[h+2]=2*s+2,h+=3;a[h]=2*s,a[h+1]=0,a[h+2]=1,h+=3,this.vertexPositions=i,this.textureCoords=n,this.vertexIndices=a,this.vertexDelays=o}},{key:"createSmooth",value:function(t){this.vertexPositions=e.createPositionBufferList(t.hres,t.vres),this.vertexIndices=e.createIndexBuffer(t.hres,t.vres),this.textureCoords=e.createTextureCoordBuffer(t.hres,t.vres),this.vertexDelays=e.calculateDelays(this.textureCoords,t.aspectRatio,t.invertDelay,t.jitter,this.delayFormulaFunc),t.rippleType&&(this.rippleDistanceData=e.calculateSmoothRippleDistance(this.textureCoords,t.rippleType,t.aspectRatio))}},{key:"createDiamond",value:function(e){for(var t=[{x:-.5,y:0},{x:0,y:.5},{x:.5,y:0},{x:0,y:-.5}],r=e.hres,i=e.vres,n=(r+1)*(i+1)*2,a=new Float32Array(3*n*t.length),o=new Float32Array(2*n*t.length),s=new Uint16Array(3*n*(t.length-2)),l=new Float32Array(a.length/3),c=e.isCenterBufferReq?new Array(2*a.length/3):void 0,u=0,d=0;d<i+1;d+=1)for(var h=0;h<r+1;h+=1)this.addPolygon(t,a,o,l,c,s,1,u,h,d,r,i),u+=1,this.addPolygon(t,a,o,l,c,s,1,u,h+.5,d+.5,r,i),u+=1;this.vertexPositions=a,this.vertexIndices=s,this.textureCoords=o,this.vertexDelays=l,this.center=c}},{key:"createHexagon",value:function(e){for(var t=[{x:-.5,y:.5/3},{x:0,y:1/3},{x:.5,y:.5/3},{x:.5,y:-.5/3},{x:0,y:-1/3},{x:-.5,y:-.5/3}],r=e.hres,i=e.vres,n=r*i*2+r+i+1,a=new Float32Array(3*n*t.length),o=new Float32Array(2*n*t.length),s=new Uint16Array(3*n*(t.length-2)),l=new Float32Array(a.length/3),c=e.isCenterBufferReq?new Array(2*a.length/3):void 0,u=0,d=0;d<i;d+=1)for(var h=0;h<r;h+=1)this.addPolygon(t,a,o,l,c,s,1,u,h,d,r,i),u+=1,this.addPolygon(t,a,o,l,c,s,1,u,h+.5,d+.5,r,i),u+=1;for(var f=0;f<i;f+=1)this.addPolygon(t,a,o,l,c,s,1,u,r,f,r,i),u+=1;for(var m=0;m<r+1;m+=1)this.addPolygon(t,a,o,l,c,s,1,u,m,i,r,i),u+=1;this.vertexPositions=a,this.vertexIndices=s,this.textureCoords=o,this.vertexDelays=l,this.center=c}},{key:"initialize",value:function(e){switch(this.meshInfo=e,this.delayFormulaFunc=function(e){return e in y?y[e]:y[s.None]}(e.delayFormula),this.directionFormulaFunc=function(e){return e in C?C[e]:C[o.Random]}(e.directionFormula),e.meshType){case a.Smooth:this.createSmooth(e);break;case a.Square:this.createSquare(e);break;case a.Diamond:this.createDiamond(e);break;case a.Hexagon:this.createHexagon(e);break;case a.Radial:this.createRadial(e);break;case a.LinearExplosion:throw new Error("MeshType.LinearExplosion is not implemented yet.");default:throw new Error("Could not get meshType.")}}},{key:"getRippleDistance",value:function(){return this.rippleDistanceData}},{key:"getVertexPositions",value:function(){return this.vertexPositions}},{key:"getVertexIndices",value:function(){return this.vertexIndices}},{key:"getTextureCoords",value:function(){return this.textureCoords}},{key:"getDelays",value:function(){return this.vertexDelays}},{key:"getCenter",value:function(){return this.center}},{key:"calculateCenter",value:function(e,t,r){var i=e,n=t;return r&&(i=2*Math.random()-.5,n=2*Math.random()-.5),new f(i,n)}},{key:"getDirections",value:function(e){for(var t,r,i,n,a=e.hres,o=e.vres,s=this.getTextureCoords().length,l=new Float32Array(s),c=0,u=0;u<o;u+=1)for(var d=0;d<a;d+=1)for(var h=(t=(d+.5)/a,r=(u+.5)/o,i=Math.floor(d+.5),n=Math.floor(u+.5),(0,this.directionFormulaFunc)(t,r,i,n)),f=0;f<4;f+=1)l[c]=h.x,l[c+1]=h.y,c+=2;return l}}],[{key:"createPositionBufferList",value:function(e,t){for(var r=new Float32Array((e+1)*(t+1)*3),i=0;i<t+1;i+=1)for(var n=0;n<e+1;n+=1){var a=3*(n+i*(e+1));r[a]=n/e,r[a+1]=i/t,r[a+2]=0}return r}},{key:"calculateSmoothRippleDistance",value:function(e,t,r){for(var i=e.length/2,n=new Float32Array(i),a=0;a<i;a+=1){var o=2*a;n[a]=this.calculateSmoothRippleDistanceUtil(t,e[o],e[o+1],r)}return n}},{key:"calculateSmoothRippleDistanceUtil",value:function(e,t,r,i){var n,a=t,o=r;switch(e){case l.RippleTopLeft:o=1-o,n=new f(1,1);break;case l.RippleTopRight:a=1-a,o=1-o,n=new f(1,1);break;case l.RippleBottomLeft:n=new f(1,1);break;case l.RippleBottomRight:a=1-a,n=new f(1,1);break;case l.RippleCenter:default:a-=.5,o-=.5,n=new f(.5,.5)}return.70710678/_(n.x,n.y)*_(a*=i,o)*Math.PI}}])}();t.Mesh=g,g.createTextureCoordBuffer=function(e,t){for(var r=new Float32Array((e+1)*(t+1)*2),i=0;i<t+1;i+=1)for(var n=0;n<e+1;n+=1){var a=2*(n+i*(e+1));r[a]=n/e,r[a+1]=i/t}return r},g.calculateDelays=function(e,t,r,i,n){for(var a=e.length/2,o=new Float32Array(a),s=0;s<a;s+=1){var l=2*s;o[s]=b(e[l],e[l+1],t,r,i,n)}return o},g.createIndexBuffer=function(e,t){for(var r=new Uint16Array(e*t*6),i=0;i<t;i+=1)for(var n=0;n<e;n+=1){var a=6*(n+i*e),o=n+i*(e+1);r[a]=o,r[a+1]=o+1,r[a+2]=o+1+(e+1),r[a+3]=o,r[a+4]=o+1+(e+1),r[a+5]=o+(e+1)}return r},g.CreateSquareTextureCoordBuffer=function(e,t){for(var r=new Float32Array(e*t*2),i=0;i<t;i+=1)for(var n=0;n<e;n+=1){var a=n+i*e*2;r[a]=n/e,r[a+1]=i/t}return r};var v={},y=(n={},(0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)(n,s.None,(function(e,t,r){return 0})),s.Left,(function(e,t,r){return e})),s.Top,(function(e,t,r){return 1-t})),s.TopLeft,(function(e,t,r){return 2*Math.abs(e-.5)})),s.TopRight,(function(e,t,r){return(1-e+1-t)/2})),s.SplitHorizontal,(function(e,t,r){return 2*Math.abs(e-.5)})),s.SplitVertical,(function(e,t,r){return 2*Math.abs(t-.5)})),s.Diamond,(function(e,t,r){return Math.abs(e-.5)+Math.abs(t-.5)})),s.Box,(function(e,t,r){return e>t?t<1-e?1-t:e:t<1-e?1-e:t})),s.Circle,(function(e,t,r){var i=(e-.5)*r,n=t-.5;return v.Distance(i,n)*(1/Math.sqrt(.25+r*r/4))})),(0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)((0,c.default)(n,s.Plus,(function(e,t,r){var i=Math.abs(e-.5),n=Math.abs(t-.5);return 2*(i<n?i:n)})),s.Clock1,(function(e,t,r){return T(e,t)%1})),s.Clock2,(function(e,t,r){return 2*T(e,t)%1})),s.Clock3,(function(e,t,r){return 3*T(e,t)%1})),s.Clock4,(function(e,t,r){return 4*T(e,t)%1})),s.Clock8,(function(e,t,r){return 8*T(e,t)%1})),s.CounterClock1,(function(e,t,r){return S(e,t)})),s.CounterClock4,(function(e,t,r){return 4*S(e,t)%1})),s.Wedge,(function(e,t,r){return i=e,n=t,(Math.atan2(-1*Math.abs(i-.5),.5-n)+Math.PI)/Math.PI;var i,n})),s.Random,(function(e,t,r){return Math.random()})),(0,c.default)(n,s.FromCenter,(function(e,t,r){return 1.41421*v.Distance(e-.5,t-.5)})));function _(e,t){return Math.sqrt(e*e+t*t)}function S(e,t){return(Math.atan2(e-.4999,.5-t)+Math.PI)/(2*Math.PI)}function T(e,t){return(Math.atan2(.5-e,.5-t)+Math.PI)/(2*Math.PI)}function b(e,t,r,i,n,a){var o=a(e,t,r);return i&&(o=1-o),o+Math.random()*n/100}v.Distance=function(e,t){return _(e,t)};var C=(0,c.default)((0,c.default)((0,c.default)({},o.CombHorizontal,(function(e,t,r,i){return new f(1&i?-1:1,0)})),o.CombVertical,(function(e,t,r,i){return new f(0,1&r?-1:1)})),o.Random,(function(e,t,r,i){var n=w(-1,1),a=w(-1,1);return new f(n,a)}));function w(e,t){return Math.random()*(e-t)+t}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MeshTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(93),u=r(23),d=r(22),h=r(29),f=r(28),m=r(21),p=r(32);function g(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var v=function(e){function t(){return(0,n.default)(this,t),g(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"initModel",value:function(e){e.hres=1,e.vres=1,e.meshType=p.MeshType.Smooth;var t=this.getDrawInfo(d.ProgramId.model,[h.aPosition,h.aTexcoord]);if(t){var r=(0,f.defaultViewModelProjectionMatrix)();return t.shaderProgram.setMatrix("uModelViewProj",r),this.modelDrawInfo=t,t}}},{key:"drawTexture",value:function(e){var t=this.modelDrawInfo;return t?((0,u.bindDrawInfo)(t),t.shaderProgram._bindTexture("uSampler1",e),(0,u.drawTriangles)(t),!0):((0,m.logError)("Can not draw the smooth model, shader program and model is undefined."),!1)}},{key:"internalDraw",value:function(e,t,r){return this.drawTexture(t.forward?r.incomingSlideTexture:r.outgoingSlideTexture)}}])}(c.Transition);t.MeshTransition=v},function(e,t,r){"use strict";var i,n,a,o,s,l,c,u;Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationType=t.SlideShowErrorCode=t.ClientColorSettings=t.SlideshowActionSource=t.PriorityHint=t.OpticalZoomSource=t.SlideShowCoreState=t.BlankSlideState=t.SlideShowRole=t.RequestStatus=void 0,t.RequestStatus=i,function(e){e.Failed="Failed",e.SkippedBusy="Skipped_Busy",e.SkippedNewTarget="Skipped_NewTarget"}(i||(t.RequestStatus=i={})),t.SlideShowRole=n,function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(n||(t.SlideShowRole=n={})),t.BlankSlideState=a,function(e){e.Hidden="Hidden",e.Black="Black",e.White="White",e.EndOfShow="EndOfShow"}(a||(t.BlankSlideState=a={})),t.SlideShowCoreState=o,function(e){e[e.Normal=0]="Normal",e[e.Loading=1]="Loading"}(o||(t.SlideShowCoreState=o={})),t.OpticalZoomSource={Mouse:"mouse",Touch:"touch",Pinch:"pinch",Scroll:"scroll",KeyboardArrowUp:"keyboardArrowUp",KeyboardArrowDown:"keyboardArrowDown",KeyboardArrowLeft:"keyboardArrowLeft",KeyboardArrowRight:"keyboardArrowRight",KeyboardEscape:"keyboardEscape",KeyboardPlus:"keyboardPlus",KeyboardMinus:"keyboardMinus",CtrlWheel:"ctrlWheel",UIPlus:"uiPlus",UIMinus:"uiMinus",SlideLocationChanged:"slideLocationChanged",Sync:"sync",RoleChanged:"roleChanged",EndOfShow:"endOfShow"},t.PriorityHint={Highest:4,High:3,Normal:2,Low:1,Lowest:0},t.SlideshowActionSource=s,function(e){e[e.Touch=0]="Touch",e[e.Mouse=1]="Mouse",e[e.Keyboard=2]="Keyboard",e[e.API=3]="API",e[e.AutoAdvance=4]="AutoAdvance"}(s||(t.SlideshowActionSource=s={})),t.ClientColorSettings=l,function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(l||(t.ClientColorSettings=l={})),t.SlideShowErrorCode=c,function(e){e.LoadFailed="LoadFailed",e.GetItemsFailedInvalidResponse="GetItemsFailedInvalidResponse",e.GetItemsRequestFailed="GetItemsRequestFailed",e.GetItemsFailedDownloadFile="GetItemsFailedDownloadFile",e.GetItemsTimeout="GetItemsTimeout",e.ResourceLoaderFailed="ResourceLoaderFailed",e.EnsureSlideFailed="EnsureSlideFailed",e.SetupWebGLContextFailed="SetupWebGLContextFailed",e.RestoreWebGLContextFailed="RestoreWebGLContextFailed",e.SlideVisualizationFailed="SlideVisualizationFailed",e.Unknown="ErrorUnknown",e.FailedToLaunchApp="FailedToLaunchApp",e.PostBootFailed="PostBootFailed",e.SlideViewElementUndefined="SlideViewElementUndefined",e.CurrentSlideLocationUndefined="CurrentSlideLocationUndefined",e.ViewControllerUndefined="ViewControllerUndefined",e.IsHiddenFailed="IsHiddenFailed"}(c||(t.SlideShowErrorCode=c={})),t.NavigationType=u,function(e){e.Init="init",e.Next="next",e.Prev="prev",e.GoToFirst="gotoFirst",e.GoToLast="gotoLast",e.ClickTarget="clickTarget",e.GoTo="goto"}(u||(t.NavigationType=u={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setupGlobals_SlideVisualizationModule=H,t.ViewController=t.exposed=t.TransitionController=t.MediaCommandScope=t.SlideRenderState=void 0;var n,a,o=i(r(18)),s=i(r(19)),l=i(r(125)),c=i(r(6)),u=i(r(5)),d=i(r(7)),h=i(r(1)),f=i(r(2)),m=r(100),p=r(25),g=r(20),v=r(3),y=r(52),_=r(66),S=r(26),T=r(381),b=r(83),C=r(11),w=r(4),P=r(90),I=r(385),k=r(118),E=r(386),x=r(155),L=r(77),A=r(67),M=r(390),R=r(54),O=r(391),D=r(392),F=["slideRendMap"];function B(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return N(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,u.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.SlideRenderState=n,function(e){e[e.Start=1]="Start",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(n||(t.SlideRenderState=n={})),t.MediaCommandScope=a,function(e){e[e.None=0]="None",e[e.Local=1]="Local",e[e.All=2]="All"}(a||(t.MediaCommandScope=a={}));var W=(0,f.default)((function e(t,r,i,n,a){(0,h.default)(this,e),this.m_transition=t,this.m_duration=r,this.m_fForwards=i,this.m_onDraw=n,this.onDispose=a,this.m_clock=new y.AnimClock,this.m_clock.start(0)}),[{key:"transition",get:function(){return this.m_transition}},{key:"duration",get:function(){return this.m_duration}},{key:"clock",get:function(){return this.m_clock}},{key:"render",value:function(e){var t=Math.max(0,Math.min(1,e/this.m_duration)),r=this.m_fForwards?t:1-t;try{this.m_onDraw(),this.m_transition.draw(r)}catch(e){return v.ULS.sendTraceTag(576583007,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Unexpected exception in m_transition.draw: ".concat(e)),!1}return e<this.m_duration}}]);t.TransitionController=W;var G={};function H(e){e.logger&&(v.ULS.setLogger(e.logger),(0,y.AnimSetLogger)(e.logger),(0,g.setLogger)(e.logger)),e.settings&&(w.Settings.load(e.settings?e.settings.slideshowcore:{}),(0,g.setSettings)(e.settings?e.settings.shapebuilder:{})),e.disabledChangeGates&&C.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=G),(0,y.setupGlobals_Animations)(e),w.Settings.readBooleanOrDefault("useShapeBuilderUlsLogger",!1)&&(0,g.setLogger)(P.ShapeBuilderUlsLogger.getInstance())}t.exposed=G;var j=function(){function e(t,r,i,n,o,s,l,c){var u=this;if((0,h.default)(this,e),this.m_slideSceneView=new Array,this.m_transitionController=null,this.m_isGlobalMute=!1,this.m_fCheckGlyphCacheOnNextRender=!1,this.m_renderStateSnapshot={slideRendMap:{}},this.m_createImageTextureMapDataThrottler=new A.ParallelCriticalAsyncFunctionThrottler(this.createImageTextureMapDataImpl.bind(this),A.executeAllQueueHandler,(function(e){return JSON.stringify(e.slideId)})),this.isAnimating=!1,this.isTransitioning=!1,this.crossSlideMediaMap={},this.mediaCommandScope=a.None,this.events=new S.EventEmitter,H({logger:n,settings:o.settings,disabledChangeGates:o.disabledChangeGates||""}),this.settings=o,this.stringifyError=o.stringifyError,e.ensureRendererEnvironment(o.shapeBuilderCanvasContext),!e.s_preloadedRendererEnvironment)throw v.ULS.sendTraceTag(555268167,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::constructor - s_preloadedRendererEnvironment is null");this.rendererEnvironment=e.s_preloadedRendererEnvironment,this.getBounds=o.getBounds?o.getBounds:new M.GetBounds(t,this.rendererEnvironment),G.this=this,G.getDebugString=this.rendererEnvironment.renderer.getDebugString.bind(this.rendererEnvironment.renderer),G.getGpuMemory=this.getGpuMemory.bind(this),G.checkForLeaks=this.checkForLeaks.bind(this),G.getWebGLState=function(){return u.rendererEnvironment.webGLRenderer&&u.rendererEnvironment.webGLRenderer.getWebGLState()},this.slideSizeEmus=r,this.viewDataManager=i,this.settings.morphEnabled=this.settings.morphEnabled&&this.rendererEnvironment.supportsTransitions,this.rendererEnvironment.viewController=this,l&&(e.appLanguage=l),c&&(this.addinManager=c);var d=this;this.rendererEnvironment.viewControllerInternals={get slideSceneView(){return d.m_slideSceneView},get forwardSceneCount(){return d.m_forwardSceneCount},get backwardSceneCount(){return d.m_backwardSceneCount},get currentSceneCount(){return d.m_currentSceneCount},get transitionFactory(){return d.m_transitionFactory},get settings(){return d.settings},get currentRenderedSlideId(){return d.m_currentRenderedSlideId},get morphCache(){return d.m_morphCache},set transitionController(e){d.m_transitionController=e},deleteScene:this.deleteScene.bind(this),createImageTextureMapData:this.createImageTextureMapData.bind(this)},this.settings.isMultiSlideshowcoreEnabled&&(this.m_viewControllerInternals=this.rendererEnvironment.viewControllerInternals),this.m_forwardSceneCount=w.Settings.readNumberOrDefault("forwardSceneCount",2),this.m_backwardSceneCount=w.Settings.readNumberOrDefault("backwardSceneCount",2),this.m_currentSceneCount=0,this.m_cameoTextureManager=x.CameoTextureManager.getInstance(this),this.m_morphCache=new b.PowerPointResourceProvider({load:this.morphLoader.bind(this)}),this.m_container=t,(0,g.setIsAnimationTransformAbsolute)(!0),this.rendererEnvironment.setupCanvas(this.m_container),this.m_transitionFactory=new _.BabylonTransitionFactory({customTransitionDataLoader:s,transitionDisabledList:w.Settings.readStringOrDefault("transitionDisabledList","")}),this.m_accessibilityLiveRegionContainer=document.createElement("div"),this.m_container.tabIndex=0,this.m_accessibilityLiveRegionContainer.id=e.AccessibilityLiveRegionContainerDivId,this.m_accessibilityLiveRegionContainer.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-live","assertive"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-atomic","true"),this.m_accessibilityLiveRegionContainer.setAttribute("role","alert"),this.m_container.appendChild(this.m_accessibilityLiveRegionContainer),this.m_crossSlideAudioContainer=document.createElement("div"),this.m_crossSlideAudioContainer.style.position="absolute",this.m_crossSlideAudioContainer.style.pointerEvents="none",this.m_crossSlideAudioContainer.id=e.CrossSlideAudioContainerDivId,this.m_slideLevelHtmlElementsParentContainer=document.createElement("div"),this.m_slideLevelHtmlElementsParentContainer.id=e.SlideLevelHtmlElementsParentDivId,w.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.position="absolute",this.m_slideLevelHtmlElementsParentContainer.style.overflow="hidden",this.m_slideLevelHtmlElementsParentContainer.style.pointerEvents="none",this.m_slideLevelHtmlElementsParentContainer.addEventListener("scroll",(function(){u.m_slideLevelHtmlElementsParentContainer.scrollLeft=0,u.m_slideLevelHtmlElementsParentContainer.scrollTop=0}))),this.m_container.appendChild(this.m_slideLevelHtmlElementsParentContainer),this.m_notesPaneParagraphReaderContainer=document.createElement("div"),this.m_notesPaneParagraphReaderContainer.id=e.NotesPaneParagraphReaderId,this.m_notesPaneParagraphReaderContainer.setAttribute("aria-live","assertive"),this.m_notesPaneParagraphReaderContainer.setAttribute("aria-atomic","true"),this.m_notesPaneParagraphReaderContainer.setAttribute("role","alert"),this.m_notesPaneParagraphReaderContainer.classList.add("show-accessibility-element"),this.m_notesPaneParagraphReaderContainer.style.display="",this.m_container.appendChild(this.m_notesPaneParagraphReaderContainer),this.m_clickTargetsReferenceDiv=document.createElement("div"),this.m_clickTargetsReferenceDiv.style.position="absolute",this.m_clickTargetsReferenceDiv.style.zIndex="-1",this.m_clickTargetsReferenceDiv.style.pointerEvents="none",this.m_clickTargetsReferenceDiv.id=e.ClickTargetsReferenceDivId,this.m_container.appendChild(this.m_clickTargetsReferenceDiv),this.m_inScreenCoordsContainer=document.createElement("div"),this.m_inScreenCoordsContainer.id="in-screen-coords",this.m_inScreenCoordsContainer.style.position="absolute",this.m_inScreenCoordsContainer.style.pointerEvents="none",this.m_container.appendChild(this.m_inScreenCoordsContainer),this.m_preActivedAddinsContainer=document.createElement("div"),this.m_preActivedAddinsContainer.id=e.PreactivedAddinsDivId,this.m_preActivedAddinsContainer.style.zIndex="-1",this.m_preActivedAddinsContainer.style.visibility="hidden",this.m_preActivedAddinsContainer.style.display="",this.m_container.appendChild(this.m_preActivedAddinsContainer)}return(0,f.default)(e,[{key:"dispose",value:(J=(0,d.default)(c.default.mark((function r(){return c.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:v.ULS.sendTraceTag(555271248,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::dispose - Disposing rendererEnvironment and removing the elements from the dom tree"),e.s_preloadedRendererEnvironment=void 0,this.m_container.removeChild(this.m_inScreenCoordsContainer),this.m_container.removeChild(this.m_accessibilityLiveRegionContainer),this.m_container.contains(this.m_crossSlideAudioContainer)&&this.m_container.removeChild(this.m_crossSlideAudioContainer),this.cleanUpAccessibilityContainer(),this.m_container.removeChild(this.m_slideLevelHtmlElementsParentContainer),this.m_clickTargetsReferenceDiv&&this.m_container.removeChild(this.m_clickTargetsReferenceDiv),this.m_notesPaneParagraphReaderContainer&&this.m_container.removeChild(this.m_notesPaneParagraphReaderContainer),this.m_preActivedAddinsContainer&&this.m_container.removeChild(this.m_preActivedAddinsContainer),this.rendererEnvironment.removeCanvas(this.m_container),t.exposed=G={};case 12:case"end":return r.stop()}}),r,this)}))),function(){return J.apply(this,arguments)})},{key:"init",value:(Y=(0,d.default)(c.default.mark((function t(){var r=this;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.rendererEnvironment.glContext){t.next=3;break}return t.next=3,e.preloadShaders(this.rendererEnvironment.glContext);case 3:this.isChromeFocusAccessibilityEnabled()&&this.m_container.addEventListener("focus",(function(){return r.updateAccessibilityTag()}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return Y.apply(this,arguments)})},{key:"isChromeFocusAccessibilityEnabled",value:function(){var e=navigator.userAgent.toLowerCase(),t=this.settings.uiHost&&this.settings.uiHost.toLowerCase().search("unified app")>=0;return!!(e.search("edg/")<0&&e.search("chrome/")>=0&&t)}},{key:"slideIdsToMorphKey",value:function(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?"".concat(JSON.stringify(e),"_").concat(JSON.stringify(t)):"".concat(JSON.stringify(t),"_").concat(JSON.stringify(e))}},{key:"morphLoader",value:(X=(0,d.default)(c.default.mark((function e(t,r){var i,n,a,o,s;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&r.meta_prevSlideId&&r.meta_nextSlideId){e.next=3;break}return v.ULS.sendTraceTag(591984859,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"morphLoader: options missing."),e.abrupt("return",{resourceId:t,metadata:{errorName:"missingOptions"}});case 3:return e.next=5,this.viewDataManager.getSlideViewData(r.meta_nextSlideId);case 5:if(i=e.sent,(n=i.resource)&&n.transData&&n.transData.morph){e.next=10;break}return v.ULS.sendTraceTag(591984860,v.LogCategory.msoulscat_Wac_PptSession,n?v.TraceLevel.Info:v.TraceLevel.Warning,"morphLoader: morph data missing. id:".concat(t,", slideViewData exists:").concat(!!n,", transdata exists:").concat(n&&!!n.transData)),e.abrupt("return",{resourceId:t,metadata:{errorName:"missingSlideData"}});case 10:if(a=this.getSlideViewElement(r.meta_prevSlideId),o=this.getSlideViewElement(r.meta_nextSlideId),a&&o){e.next=15;break}return v.ULS.sendTraceTag(591984861,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"morphLoader: slidePrev exists:".concat(!!a," slideNext exists:").concat(!!o,".")),e.abrupt("return",{resourceId:t,metadata:{errorName:"missingSlideViewElement"}});case 15:return s=new T.MorphTransition(this,n.transData.morph,n.transData.type,n.transData.dir,a,o),e.abrupt("return",{resourceId:t,resource:s,metadata:{}});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return X.apply(this,arguments)})},{key:"ensureSlideViewElement",value:(Z=(0,d.default)(c.default.mark((function t(r){var i,n,a;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v.ULS.sendTraceTag(595682653,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureSlideViewElement - slideId:".concat(r.id.sid)),(i={}).getSlideViewData={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},t.next=5,this.viewDataManager.getSlideViewData(r.id);case 5:if(n=t.sent,i.getSlideViewData.end=e.performanceNowTrimmed(),n.resource){t.next=11;break}return v.ULS.sendTraceTag(590104157,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ensureSlideViewElement: missing slideView data. id:".concat(r.id.sid)),n.metadata.hasOwnProperty("errorName")&&(i.errorName=n.metadata.errorName),t.abrupt("return",i);case 11:return v.ULS.sendTraceTag(575193865,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureSlideViewElement - slideSceneViews: ".concat(JSON.stringify(this.m_slideSceneView.map((function(e){return e.slideId.sid}))))),(a=this.m_slideSceneView.find((function(e){return e.slideId.sid===r.id.sid})))?(v.ULS.sendTraceTag(575193867,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureSlideViewElement - slideSceneView already exists for slide ".concat(r.id.sid," sceneExists:").concat(!!a.scene)),a.scene&&this.deleteScene(a),a.slideId=r.id,a.slideViewElement=new m.SlideViewElement(r,n.resource.slideSizePixels,this)):(a={slideId:r.id,slideViewElement:new m.SlideViewElement(r,n.resource.slideSizePixels,this),lastRenderedTimeMs:Number.NEGATIVE_INFINITY},this.m_slideSceneView.push(a),v.ULS.sendTraceTag(575193866,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureSlideViewElement - Created new slideSceneView for slide ".concat(r.id.sid))),this.viewDataManager.slideMetadataMap.set(r.id.sid,{slideId:r.id,isHidden:r.hidden}),v.ULS.sendTraceTag(575193868,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureSlideViewElement - Current SlideMetadataMap:".concat(JSON.stringify(Array.from(this.viewDataManager.slideMetadataMap)))),t.abrupt("return",i);case 17:case"end":return t.stop()}}),t,this)}))),function(e){return Z.apply(this,arguments)})},{key:"ensureTextureLoaded",value:(q=(0,d.default)(c.default.mark((function t(r,i){var n,a,o,s;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v.ULS.sendTraceTag(593835683,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureTextureLoaded - slideId:".concat(r.sid)),n=this.m_slideSceneView.find((function(e){return e.slideId.sid===r.sid}))){t.next=5;break}return v.ULS.sendTraceTag(593346771,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::ensureTextureLoaded - missing scene view. slideId:".concat(r.sid)),t.abrupt("return",{errorName:k.ErrorCode.MissingSceneView});case 5:if(!n.slideViewElement.fImageTextureLoaded){t.next=8;break}return v.ULS.sendTraceTag(593831363,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::ensureTextureLoaded - Texture already loaded for slide:".concat(r.sid)),t.abrupt("return",{});case 8:return a={createTexture:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},t.prev=9,n.slideViewElement.fImageTextureLoading=!0,t.next=13,this.createImageTextureMapData(n);case 13:return o=t.sent,a.createTexture.end=e.performanceNowTrimmed(),t.next=17,n.slideViewElement.ensure(i);case 17:return s=t.sent,t.abrupt("return",U(U(U({},a),o),s));case 21:return t.prev=21,t.t0=t.catch(9),v.ULS.sendTraceTag(576213770,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Unexpected exception in ensureTextureLoaded: ".concat(t.t0)),t.abrupt("return",{errorName:k.ErrorCode.TexturesNotLoaded});case 25:case"end":return t.stop()}}),t,this,[[9,21]])}))),function(e,t){return q.apply(this,arguments)})},{key:"getSlideViewElement",value:function(e){var t=this.m_slideSceneView.find((function(t){return t.slideId.sid===e.sid}));return t?t.slideViewElement:null}},{key:"onResize",value:function(){this.m_captionsRenderer&&this.m_captionsRenderer.onResize()}},{key:"getCaptionsRenderer",get:function(){return this.m_captionsRenderer||(this.m_captionsRenderer=new R.CaptionsRenderer(this.m_container.id,this.m_inScreenCoordsContainer),this.m_captionsRenderer.setDefaultLang=e.accessibilityLanguage),this.m_captionsRenderer}},{key:"renderSlideAnimationFrameById",value:function(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!1,!1,t)}},{key:"renderSlideByIdCollectingPerfData",value:function(e,t,r){return this.renderSlideByIdExtended(e,!0,void 0,void 0,void 0,!0,!(!r||!r.isBoot)&&r.isBoot,t,r)}},{key:"renderSlideById",value:function(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!0,!1,t)}},{key:"renderSlideByIdExtended",value:function(t,r,i,n,a,o,s,l,c){var u=this,d=this.rendererEnvironment.clientSize,h={CanvasWidth:d.x*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,CanvasHeight:d.y*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,DevicePixelRatio:window.devicePixelRatio,devicePixelsToRenderedPixelsScale:this.rendererEnvironment.devicePixelsToRenderedPixelsScale,render:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}};o&&v.ULS.sendTraceTag(559992838,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"renderSlideById slide:".concat(t.sid)),s&&this.rendererEnvironment.glContext&&this.events.emit("renderingStageChanged","FlushingShaders");var f=e.performanceNowTrimmed();h.shaders=e.performanceNowTrimmed()-f,C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta={});var m=e.performanceNowTrimmed(),g=this.m_slideSceneView.find((function(e){return e.slideId.sid===t.sid}));if(!g||!this.rendererEnvironment.isGLContextValid||!this.rendererEnvironment.isSBValid){var y="ViewController::renderSlideById - Cannot render slide:".concat(t.sid," SceneView:").concat(!!g," WebGlContext:").concat(this.rendererEnvironment.isGLContextValid," SBReady:").concat(this.rendererEnvironment.isSBValid);return v.ULS.sendTraceTag(592328654,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,y),this.settings.stringifyError&&v.ULS.sendTraceTag(545404040,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,this.settings.stringifyError(new Error(y))),U(U({},h),{},{errorName:this.rendererEnvironment.isGLContextValid?this.rendererEnvironment.isSBValid?k.ErrorCode.FailedToRenderMissingSceneView:k.ErrorCode.FailedToRenderSBNotReady:k.ErrorCode.FailedToRenderContextLost})}if(!g.slideViewElement.fImageTextureLoaded)return v.ULS.sendTraceTag(593830016,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::renderSlideById - tried to render a slide without loading textures:".concat(t.sid)),U(U({},h),{},{errorName:k.ErrorCode.TexturesNotLoaded});if(!g.scene){for(var _=w.Settings.readBooleanOrDefault("ignoreSceneBeingRendered",!1)?[g.slideId]:[];this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(_););g.scene=this.createNewScene(),g.slideViewElement.fImageTextureLoading=!1,g.slideViewElement.addToScene(g.scene)}if(C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.sceneView=e.performanceNowTrimmed()-m),h.fPrepared=g.slideViewElement.fPrepared,C.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&c&&c.id){this.m_renderStateSnapshot.preRendered=g.slideViewElement.fPrepared,this.m_renderStateSnapshot.prerenWindRange=c&&c.prefetchWindowRange,this.m_renderStateSnapshot.navSlideIndex=c&&c.slideIndex,this.m_renderStateSnapshot.id=c&&c.id,this.m_renderStateSnapshot.step=c&&c.step,this.m_renderStateSnapshot.navType=c&&c.navType,this.m_renderStateSnapshot.navInitTime=c&&c.navInitTimestamp;var S=e.performanceNowTrimmed();this.logSlideRenderSnapshot(),v.ULS.sendTraceTag(507593430,v.LogCategory.msoulscat_Wac_PptSlideshow,v.TraceLevel.Warning,"ViewController::renderSlideByIdExtended: Render Snapshot LogTime: ".concat(e.performanceNowTrimmed()-S))}var T=g.slideViewElement.slideSizePixels;this.showUnderlaysAndOverlays(JSON.stringify(t)),this.showHideCrossSlideAudios(JSON.stringify(t)),g.slideViewElement.updateShapeViewElements(),g.lastRenderedTimeMs=Date.now();var b=d.x/T.x,I=d.y/T.y,E=Math.min(b,I),x=e.performanceNowTrimmed();this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,E,T,!0,l,!0),C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.resizeTransformation=e.performanceNowTrimmed()-x);var L=e.performanceNowTrimmed();(0,P.setShapeBuilderGlobals)(d,T,this.slideSizeEmus,this.stringifyError),C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.setShapeBuilderGlobals=e.performanceNowTrimmed()-L);var A=w.Settings.readNumberOrDefault("bootRenderTimeoutMs",-1);if(this.rendererEnvironment.glContext&&s&&!g.slideViewElement.fPrepared&&A>0){this.events.emit("renderingStageChanged","PreparingSBItems");var M=g.slideViewElement.tryPrepareAllAtOnce(A);if(v.ULS.sendTraceTag(539767630,v.LogCategory.msoulscat_Wac_PptSession,M?v.TraceLevel.Info:v.TraceLevel.Error,JSON.stringify({prepareSucceeded:M})),!M&&w.Settings.readBooleanOrDefault("renderTimeoutReturnEarly",!1))return h.errorName=k.ErrorCode.TryPrepareTimeout,h}s&&this.events.emit("renderingStageChanged","RenderingSlide"),(s||w.Settings.readBooleanOrDefault("hackEnableVerboseRenderLogging",!1))&&this.rendererEnvironment.enableVerboseRenderLogging(!0);var R=e.performanceNowTrimmed(),O=this.rendererEnvironment.calculateRenderTransform(T);if(C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.renderTransform=e.performanceNowTrimmed()-R),w.Settings.readBooleanOrDefault("enableOpticalZoom",!1)){var D=l.zoomLevel*O.scale.x,F=new p.Vector2(l.canvasCenterSlidePointPercent.x*D*T.x,l.canvasCenterSlidePointPercent.y*D*T.y),B=e.performanceNowTrimmed();O=this.rendererEnvironment.calculateRenderTransformWithZoom(new p.Vector2(T.x,T.y),D,F),C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.renderTransformZoom=e.performanceNowTrimmed()-B)}C.ChangeGate.isChangeGateEnabled("SVM.ResetDirtyRectOnOpticalZoomChange")&&(!this.m_lastRenderedOpticalZoomState||this.m_lastRenderedOpticalZoomState.zoomLevel===l.zoomLevel&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.x===l.canvasCenterSlidePointPercent.x&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.y===l.canvasCenterSlidePointPercent.y||(this.m_lastRenderRectMap=void 0),this.m_lastRenderedOpticalZoomState=l),this.m_currentRenderedSlideId=t;var N={filter:n,target:i,transform:O};P.ShapeBuilderUlsLogger.s_isRenderingAnimationFrame=!o;var V=e.performanceNowTrimmed();if(w.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1)&&this.rendererEnvironment.glContext){var W={enableDirtyRect:!0,previousRenderRectMap:this.m_lastRenderRectMap};this.rendererEnvironment.renderer.render(g.scene,a,N,W),this.m_lastRenderRectMap=this.rendererEnvironment.renderer.getLastRenderRectMap()}else this.rendererEnvironment.renderer.render(g.scene,a,N);C.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(h.additionalPerfMeta.shapeBuilderRender=e.performanceNowTrimmed()-V),P.ShapeBuilderUlsLogger.s_isRenderingAnimationFrame=!1,G.lastRenderedScene=g.scene,this.rendererEnvironment.enableVerboseRenderLogging(!1);var H=this.viewDataManager.slideIdOrder.findIndex((function(e){return e.sid===t.sid&&e.cid===t.cid})),j=!1;this.isChromeFocusAccessibilityEnabled()&&(this.m_container.contains(document.activeElement)||(j=!0)),j||g.slideViewElement.updateAccessibilityTag(H,t,this.m_slideLevelHtmlElementsParentContainer);var z=e.getElementFromCollection(this.m_inScreenCoordsContainer.children,e.BlankSlideDivId);z&&this.m_inScreenCoordsContainer.removeChild(z),h.render.end=e.performanceNowTrimmed(),C.ChangeGate.isChangeGateEnabled("SlideshowRenderedVerifyGlyphStartEventRaiseEnabled")&&s&&(this.events.emit("verifyGlyphStart"),v.ULS.sendTraceTag(507249055,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::renderSlideByIdExtended: ".concat(performance.now(),", verifyGlyphStartEvent raised")));var q=w.Settings.readBooleanOrDefault("enableTriangleTest",!1);if(o||this.m_fCheckGlyphCacheOnNextRender){var Z=this.m_fCheckGlyphCacheOnNextRender;this.m_fCheckGlyphCacheOnNextRender=!1;var X=e.performanceNowTrimmed();this.settings.flights&&this.settings.flights.verifyGlyphAsynchronously?C.ChangeGate.isChangeGateEnabled("EnableAsyncVerifyGlyphInvocation")&&setTimeout((function(){X=e.performanceNowTrimmed(),u.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?q&&setTimeout((function(){u.runRenderFidelityTest(q,!1,Z,t)}),0):(h.render.end=e.performanceNowTrimmed(),v.ULS.sendTraceTag(553788171,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"GlyphCacheIntegrity failed"),u.runRenderFidelityTest(q,!0,Z,t),e.s_glyphCacheFailedCount+=1,u.m_fCheckGlyphCacheOnNextRender=!0,u.events.emit("glyphCacheFailed")),v.ULS.sendTraceTag(507605075,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::renderSlideByIdExtended: verifyGlyphs: ".concat(e.performanceNowTrimmed()-X))}),0):(this.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?q&&setTimeout((function(){u.runRenderFidelityTest(q,!1,Z,t)}),0):(h.render.end=e.performanceNowTrimmed(),v.ULS.sendTraceTag(553788171,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"GlyphCacheIntegrity failed"),this.runRenderFidelityTest(q,!0,Z,t),e.s_glyphCacheFailedCount+=1,this.m_fCheckGlyphCacheOnNextRender=!0,this.events.emit("glyphCacheFailed")),h.verifyGlyphs=e.performanceNowTrimmed()-X)}if(r){h.slideWidth=T.x,h.slideHeight=T.y;var Y=this.rendererEnvironment.getPerformanceSummary(),J=Y&&Y.perfInfoCurrentFrame;J&&(w.Settings.readBooleanOrDefault("addSbToNavLogs",!0)?h.sbMs={total:J.totalCostMs,dfSp:J.distanceFieldForShapeCostMs,dfTxt:J.distanceFieldForTextCostMs,dfGph:J.distanceFieldForGlyphTableCostMs,rnd:J.shapeRenderCostMs,tp:J.drawTapeCostMs,spCnt:J.shapeLayerCount,spCntTxt:J.shapeLayerCountText,pCntDf:J.pixelCountDistanceField,pCntSp:J.pixelCountShapeRender,spr:J.cacheToSpriteCostMs,tx:e.trimTo100th(J.fadeTextureCostMs+J.patternTextureCostMs+J.gradientTextureCostMs+J.pathGradientTextureCostMs),res:e.trimTo100th(J.glResetCostMs+J.glRestoreCostMs)}:h.SBTotalCost=J.totalCostMs);var K=U({slideId:t.sid,isBoot:s,isBadGPU:e.s_isBadGpu,SBCurrentFrameSummary:J},h);v.ULS.sendTraceTag(590160843,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,JSON.stringify(K)),v.ULS.sendTraceTag(577885456,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,JSON.stringify(this.getGpuMemory()));try{Object.fromEntries&&v.ULS.sendTraceTag(523342101,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::renderSlideByIdExtended leaks: ".concat(JSON.stringify(Object.fromEntries(this.checkForLeaksByScenario()))))}catch(e){var Q=e;e instanceof Error&&this.stringifyError&&(Q=this.stringifyError(e)),v.ULS.sendTraceTag(522806804,v.LogCategory.msoulscat_Wac_PptSlideshow,v.TraceLevel.Warning,"ViewController::renderSlideByIdExtended Exception calling fromEntries:".concat(Q))}return h}}},{key:"runRenderFidelityTest",value:function(e,t,r,i){var n=!!this.rendererEnvironment.isGLContextValid,a=e?this.rendererEnvironment.webGLRenderer&&this.rendererEnvironment.webGLRenderer.testRenderFidelity():void 0,o=t||r||a&&!a.fSucceeded,s=this.rendererEnvironment.webGLRenderer&&o?this.rendererEnvironment.webGLRenderer.getWebGLState():void 0;v.ULS.sendTraceTag(509387791,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,JSON.stringify({glyphCacheFailed:t,isAfterGlyphCacheRecovery:r,sid:i.sid,glValid:n,enableTriangleTest:e,results:a,webGLState:s}))}},{key:"getRelativeSlideIndex",value:function(e,t){return e-t}},{key:"logSlideRenderSnapshot",value:function(){var e=function(e){return e.slideRendMap,(0,l.default)(e,F)}(this.m_renderStateSnapshot);e.relSlideRendMap={};var t=this.m_renderStateSnapshot.navSlideIndex;if(t)for(var r in this.m_renderStateSnapshot.slideRendMap)e.relSlideRendMap[this.getRelativeSlideIndex(parseInt(r),t)]=this.m_renderStateSnapshot.slideRendMap[r];v.ULS.sendTraceTag(507593429,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,JSON.stringify(e))}},{key:"calculateCanvasCenterSlidePointPercentAfterZoom",value:function(e,t,r,i){var n=this.m_slideSceneView.find((function(e){return e.slideId.sid===r.sid}));if(!n)return v.ULS.sendTraceTag(521491842,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::calculateCanvasCenterSlidePointPercentAfterZoom - missing scene view."),null;var a=new p.Vector2(n.slideViewElement.slideSizePixels.x,n.slideViewElement.slideSizePixels.y),o=this.rendererEnvironment.clientSize,s=new p.Vector2(i.canvasCenterSlidePointPercent.x,i.canvasCenterSlidePointPercent.y),l=this.rendererEnvironment.calculateRenderTransform(a).scale.x,c=i.zoomLevel*l,u=s.scale(c).multiply(a),d=t*l,h=(0,L.calculateZoomTransform)(e,d,u,a,o,c,w.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return(0,L.calculateSlidePoint)(o.scale(.5),h.translation,a,d,w.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(a.scale(d))}},{key:"calculateCanvasCenterPointPercentAfterPan",value:function(e,t,r){var i=this.m_slideSceneView.find((function(e){return e.slideId.sid===t.sid}));if(!i)return v.ULS.sendTraceTag(521491843,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::calculateCanvasCenterPointPercentAfterPan - missing scene view."),null;var n=new p.Vector2(i.slideViewElement.slideSizePixels.x,i.slideViewElement.slideSizePixels.y),a=this.rendererEnvironment.clientSize,o=new p.Vector2(r.canvasCenterSlidePointPercent.x,r.canvasCenterSlidePointPercent.y),s=this.rendererEnvironment.calculateRenderTransform(n).scale.x,l=r.zoomLevel*s,c=o.scale(l).multiply(n),u=(0,L.calculatePanTransform)(new p.Vector2(e.x,e.y),c,n,a,l,w.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return(0,L.calculateSlidePoint)(a.scale(.5),u.translation,n,l,w.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(n.scale(l))}},{key:"getGpuMemory",value:function(){var e=performance.now(),t=this.m_slideSceneView.filter((function(e){return e.scene})).map((function(e){return e.scene})),r=this.m_morphCache.getAllLoadResultsInCache().filter((function(e){return e.resource})).map((function(e){return e.resource.morph})),i=this.rendererEnvironment.generateTextureMemoryReport(t,r),n=0;this.viewDataManager.imageDataMap.forEach((function(e,t){n+=e.size.x*e.size.y*4}));var a,o=(i?i.totalTargetExpected:0)+n+this.viewDataManager.memoryStats.cameoTextures+this.viewDataManager.memoryStats.gifTextures+this.viewDataManager.memoryStats.transitionTextures+this.viewDataManager.memoryStats.transitionsMemoryReport.buffers.count+this.viewDataManager.memoryStats.transitionsMemoryReport.textures.count+this.viewDataManager.memoryStats.videoTextures,l=this.rendererEnvironment.webGLRenderer?this.rendererEnvironment.webGLRenderer.fixedMemoryLeakAmounts:void 0,c=0,u=B(this.checkForLeaksByScenario());try{for(u.s();!(a=u.n()).done;){var d=(0,s.default)(a.value,2);d[0],c+=d[1]}}catch(e){u.e(e)}finally{u.f()}return{gpuMemorySB:i,timeSpentCollecting:performance.now()-e,memoryStats:this.viewDataManager.memoryStats,images:n,total:o,leaksPrevented:l,leaks:c}}},{key:"updateAccessibilityTag",value:function(){if(this.m_currentRenderedSlideId&&this.m_slideSceneView){var e=this.m_currentRenderedSlideId,t=this.m_slideSceneView.find((function(t){return t.slideId.sid===e.sid}));if(t){var r=this.viewDataManager.slideIdOrder.findIndex((function(t){return t.sid===e.sid&&t.cid===e.cid}));t.slideViewElement.updateAccessibilityTag(r,e,this.m_slideLevelHtmlElementsParentContainer)}else v.ULS.sendTraceTag(575955971,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::updateAccessibilityTag scene view is null - slideId:".concat(e.sid))}else v.ULS.sendTraceTag(575955970,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::updateAccessibilityTag sceneView or slideId is null - slideId:".concat(this.m_currentRenderedSlideId))}},{key:"updateAccessibilityContainersLanguage",value:function(e){""===e?(this.m_accessibilityLiveRegionContainer.removeAttribute("lang"),this.m_slideLevelHtmlElementsParentContainer.removeAttribute("lang")):this.m_slideLevelHtmlElementsParentContainer.lang=e}},{key:"updateAccessibilityLanguage",value:function(t){t!==e.accessibilityLanguage&&(e.accessibilityLanguage=t,this.cleanUpAccessibilityContainer(),this.updateAccessibilityContainersLanguage(t),this.m_captionsRenderer&&(this.m_captionsRenderer.setDefaultLang=t))}},{key:"preRenderSlideById",value:function(e,t){var r=this;v.ULS.sendTraceTag(595634143,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::preRenderSlideById - slideId:".concat(e.sid));var i=this.m_slideSceneView.find((function(t){return t.slideId.sid===e.sid}));if(i&&this.rendererEnvironment.isGLContextValid)if(i.scene)i.slideViewElement.fImageTextureLoading=!1;else{for(;this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(););var a=function(){(0,P.setShapeBuilderGlobals)(r.rendererEnvironment.clientSize,i.slideViewElement.slideSizePixels,r.slideSizeEmus,r.stringifyError)};i.scene=this.createNewScene(),i.slideViewElement.fImageTextureLoading=!1,i.slideViewElement.addToScene(i.scene);var o=this.rendererEnvironment.glContext;if(!w.Settings.readBooleanOrDefault("hackSkipPrerender",!1)){var s,l;if(C.ChangeGate.isChangeGateEnabled("logRenderSnapshot")){l=this.viewDataManager.getSlideIndex(e);var u=this.m_renderStateSnapshot.slideRendMap,h=u[l]||(u[l]={});h.sTime=Date.now(),h.state=n.Start,h.idx=l}this.tryPrepareUntilDoneAsync((function(){if(!i.scene&&C.ChangeGate.isChangeGateEnabled("SSC.SkipPreparingEmptyScene"))return!0;if(a(),!C.ChangeGate.isChangeGateEnabled("logRenderSnapshot"))return i.slideViewElement.tryPrepare();l=r.viewDataManager.getSlideIndex(e);var t=r.m_renderStateSnapshot.slideRendMap,o=t[l]||(t[l]={});return s=i.slideViewElement.tryPrepare(),o.eTime=Date.now(),o.state=s?n.Completed:n.Failed,s}),w.Settings.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then((0,d.default)(c.default.mark((function i(){var n,s,l,u;return c.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t&&r.settings.morphEnabled&&o&&!o.isContextLost()){i.next=2;break}return i.abrupt("return");case 2:if(n=r.m_slideSceneView.find((function(e){return e.slideId.sid===t.sid})),s=r.slideIdsToMorphKey(t,e),n&&n.scene&&s){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,r.m_morphCache.load(s,{meta_prevSlideId:t,meta_nextSlideId:e});case 8:l=i.sent,v.ULS.sendTraceTag(522806805,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,JSON.stringify({morphExists:!(!l||!l.resource),morphResourceId:s})),l&&l.resource&&(u=l.resource,r.tryPrepareUntilDoneAsync((function(){return a(),u.tryPrepareMorph(5)}),w.Settings.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then((function(){v.ULS.sendTraceTag(591970573,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"Done preparing morph - slideId:".concat(e.sid))})));case 11:case"end":return i.stop()}}),i)}))))}}}},{key:"sendFrameToCameo",value:function(e,t){this.m_cameoTextureManager.processFrameForCameo(e,t)}},{key:"clearCameo",value:function(){this.m_cameoTextureManager.releaseTexture()}},{key:"setCameoVideoElement",value:function(e){this.m_cameoTextureManager.setVideoElement(e)}},{key:"updateCameoTextureFromVideoElement",value:function(){this.m_cameoTextureManager.updateTextureFromVideoElement()}},{key:"cleanUpAccessibilityContainer",value:function(){for(;this.m_slideLevelHtmlElementsParentContainer&&this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.removeChild(this.m_slideLevelHtmlElementsParentContainer.firstChild);m.SlideViewElement.s_lastAccessibilityTagHash=""}},{key:"tryPrepareUntilDoneAsync",value:(z=(0,d.default)(c.default.mark((function e(t,r){var i;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r;case 1:if(this.rendererEnvironment.isGLContextValid&&!(i<=0)){e.next=4;break}return e.abrupt("return");case 4:if(!this.isAnimating&&!this.isTransitioning&&this.rendererEnvironment.isSBValid){e.next=8;break}return e.next=7,(0,A.waitMsAsync)(10);case 7:return e.abrupt("continue",1);case 8:if(!t()){e.next=10;break}return e.abrupt("return");case 10:return i-=1,e.next=13,(0,A.waitMsAsync)(10);case 13:e.next=1;break;case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return z.apply(this,arguments)})},{key:"setMaxSceneCount",value:function(e,t){this.m_forwardSceneCount!==e&&(this.m_forwardSceneCount=e),this.m_backwardSceneCount!==t&&(this.m_backwardSceneCount=t)}},{key:"deleteOldestScene",value:function(e){for(var t=this,r=-1,i=Number.POSITIVE_INFINITY,n=-1,a=Number.POSITIVE_INFINITY,o=[],s=function(s){return t.m_currentRenderedSlideId&&t.m_currentRenderedSlideId.sid===t.m_slideSceneView[s].slideId.sid||!t.m_slideSceneView[s].scene||e&&e.find((function(e){return e.sid===t.m_slideSceneView[s].slideId.sid}))?0:(o.push({index:s,sid:t.m_slideSceneView[s].slideId.sid,lastRenderedTimeMs:t.m_slideSceneView[s].lastRenderedTimeMs}),t.m_slideSceneView[s].lastRenderedTimeMs<i&&(r=s,i=t.m_slideSceneView[s].lastRenderedTimeMs),void(!t.isAdjacentSlide(t.m_slideSceneView[s].slideId)&&t.m_slideSceneView[s].lastRenderedTimeMs<a&&(n=s,a=t.m_slideSceneView[s].lastRenderedTimeMs)))},l=0;l<this.m_slideSceneView.length;l+=1)s(l);var c=!w.Settings.readBooleanOrDefault("disallowDeletingOldAdjacentScenes",!1),u=-1===n&&c?r:n;return v.ULS.sendTraceTag(520681370,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"deleteOldestScene ".concat(JSON.stringify({allowDeletingOldAdjacentScenes:c,slideToDeleteIndex:u,sceneList:o,scenesToIgnore:e}))),-1!==u&&(this.deleteScene(this.m_slideSceneView[u]),!0)}},{key:"isAdjacentSlide",value:function(e){if(!this.m_currentRenderedSlideId)return!1;if(w.Settings.readBooleanOrDefault("fixIsAdjacentSlide",!1)){var t=this.viewDataManager.getVisibleSlideIndexDifference(this.m_currentRenderedSlideId,e);return void 0!==t&&Math.abs(t)<=(t>0?this.m_forwardSceneCount:this.m_backwardSceneCount)}var r=this.viewDataManager.getVisibleSlideIndex(this.m_currentRenderedSlideId),i=this.viewDataManager.getVisibleSlideIndex(e);return-1!==r&&-1!==i&&r!==i&&Math.abs(r-i)<=(i>r?this.m_forwardSceneCount:this.m_backwardSceneCount)}},{key:"deleteScene",value:function(e){if(e.scene){if(C.ChangeGate.isChangeGateEnabled("logRenderSnapshot")){var t=this.viewDataManager.getSlideIndex(e.slideId);this.m_renderStateSnapshot.slideRendMap[t]&&delete this.m_renderStateSnapshot.slideRendMap[t]}var r,i=new Set,n=this.m_slideSceneView.filter((function(e){return e.scene||e.slideViewElement.fImageTextureLoading})).map((function(e){return e.slideId.sid})),a=this.viewDataManager.imageDataMap.size,l=B(this.viewDataManager.imageDataMap);try{for(l.s();!(r=l.n()).done;){var c=(0,s.default)(r.value,2),u=c[0],d=c[1];if(w.Settings.readBooleanOrDefault("deleteMultiSlideTextures",!1)){if(!d.loadedSlideIDs.some((function(e){return n.some((function(t){return t===e.sid}))}))){this.rendererEnvironment.releaseImageData(d),this.viewDataManager.imageDataMap.delete(u),i.add(u);var h,f=B(this.m_slideSceneView);try{var m=function(){var e=h.value;d.loadedSlideIDs.some((function(t){return e.slideId.sid===t.sid}))&&(e.slideViewElement.fImageTextureLoaded=!1)};for(f.s();!(h=f.n()).done;)m()}catch(e){f.e(e)}finally{f.f()}}}else 1===d.loadedSlideIDs.length&&d.loadedSlideIDs.find((function(t){return t.sid===e.slideId.sid}))&&(this.rendererEnvironment.releaseImageData(d),this.viewDataManager.imageDataMap.delete(u),i.add(u))}}catch(e){l.e(e)}finally{l.f()}var p,g=B(i);try{for(g.s();!(p=g.n()).done;){var y=p.value;this.viewDataManager.onExternalTextureReleased(y)}}catch(e){g.e(e)}finally{g.f()}var _=this.viewDataManager.imageDataMap.size;if(v.ULS.sendTraceTag(576247952,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::deleteScene - slideSceneViews: ".concat(JSON.stringify(this.m_slideSceneView.map((function(e){return e.slideId.sid})))," SlideSID:").concat(e.slideId.sid," before: ").concat(a," after:").concat(_)),v.ULS.sendTraceTag(575758488,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::deleteScene - SlideSID:".concat(e.slideId.sid," keys deleted: [").concat((0,o.default)(i).join(","),"]")),e.slideViewElement.fImageTextureLoaded=!1,e.slideViewElement.removeFromScene(e.scene),e.scene.releaseGeneratedResources(),this.settings.morphEnabled){var S,T=B(this.m_morphCache.getAllLoadResultsInCache());try{for(T.s();!(S=T.n()).done;){var b=S.value;b.resourceId.indexOf(JSON.stringify(e.slideId))>0&&(b.resource&&(b.resource.dispose(),v.ULS.sendTraceTag(577885457,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::deleteScene - cleared morph cache for resourceId:".concat(b.resourceId," SlideSID:").concat(e.slideId.sid))),this.m_morphCache.remove(b.resourceId))}}catch(e){T.e(e)}finally{T.f()}}e.slideViewElement.cleanUp(),e.slideViewElement.fPrepared=!1,e.scene=void 0,this.m_currentSceneCount-=1}else v.ULS.sendTraceTag(595621852,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Warning,"ViewController::deleteScene - slideSceneView doesn't contain a scene. SlideSID:".concat(e.slideId.sid))}},{key:"calculateCanvasSize",value:function(e){var t,r,i=this.getBounds.getBoundingClientRectFromContainer(),n=i.width/(i.height?i.height:i.width);return e.x/e.y<n?(r=Math.round(i.height),t=Math.round(r*e.x/e.y)):(t=Math.round(i.width),r=Math.round(t*e.y/e.x)),new p.Vector2(t,r)}},{key:"resizeViewContainer",value:function(e,t,r){this.m_container.style.display="flex",this.m_container.style.justifyContent="center",this.m_container.style.alignItems="center";var i=this.calculateCanvasSize(t),n=r&&r.canvasScale?r.canvasScale:1;this.rendererEnvironment.setCanvasSize(i,n);var a=this.rendererEnvironment.canvas,o=this.rendererEnvironment.clientSize,s=o.x/t.x,l=o.y/t.y,c=Math.min(s,l);this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,c,t,!0,e,!0),w.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.width=a.style.width,this.m_slideLevelHtmlElementsParentContainer.style.height=a.style.height),this.m_clickTargetsReferenceDiv&&this.applyResizeTransform(this.m_clickTargetsReferenceDiv,c,t,!1,e),this.m_inScreenCoordsContainer.style.width=a.style.width,this.m_inScreenCoordsContainer.style.height=a.style.height}},{key:"applyResizeTransform",value:function(t,r,i,n,a,o){var s=this,l=function(t,n){if(t.id.indexOf(e.SlideLevelHtmlElementsDivId)>-1){var o,l=B(s.m_slideSceneView);try{for(l.s();!(o=l.n()).done;)o.value.slideViewElement.onSlideScaled(r)}catch(e){l.e(e)}finally{l.f()}}if(w.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&t!==s.m_clickTargetsReferenceDiv){var c=w.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*s.rendererEnvironment.devicePixelsToRenderedPixelsScale,u=s.rendererEnvironment.clientSize.scale(.5),d=new p.Vector2(i.x,i.y),h=new p.Vector2(a.canvasCenterSlidePointPercent.x,a.canvasCenterSlidePointPercent.y),f=u.scale(1-a.zoomLevel),m=s.rendererEnvironment.calculateRenderTransform(d).scale.x*a.zoomLevel,g=d.scale(m),v=h.multiply(g),y=(0,L.calculateTranslationForAlignment)(u,v,d,m,c).scale(1/c).subtract(u).add(f),_=r*a.zoomLevel;t.style.top="0",t.style.left="0",t.style.transform="translateX(".concat(y.x,"px) translateY(").concat(y.y,"px) scale(").concat(_,",").concat(_,")")}else t.style.transform="scale(".concat(r,",").concat(r,")"),t.style.top="".concat(s.rendererEnvironment.canvas.offsetTop+(s.rendererEnvironment.canvas.offsetWidth-s.rendererEnvironment.clientSize.x)/2,"px"),t.style.left="".concat(s.rendererEnvironment.canvas.offsetLeft+(s.rendererEnvironment.canvas.offsetHeight-s.rendererEnvironment.clientSize.y)/2,"px");t.style.transformOrigin="top left",n||(t.style.width="".concat(i.x,"px"),t.style.height="".concat(i.y,"px"))};if(n)for(var c=t.childNodes,u=0;u<c.length;u+=1){var d=c[u];o&&d.id.search(e.ShapeAccessibilityElementId)>=0||l(d,!0)}else l(t,!1)}},{key:"createTransition",value:(j=(0,d.default)(c.default.mark((function t(r,i,n,a){var o,s,l,u,d,h,f;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=0,s=0,C.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o=e.performanceNowTrimmed()),t.next=4,this.viewDataManager.getSlideViewData(n?r:i);case 4:if(l=t.sent,C.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(s=e.performanceNowTrimmed()-o),this.m_transitionController&&this.finishTransition(),u={fSuccess:!1},d=0,h=0,C.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(d=e.performanceNowTrimmed()),!((f=l.resource)&&f.transData&&w.Settings.readBooleanOrDefault("hackTransitionsEnabled",!0))){t.next=17;break}return t.next=14,this.rendererEnvironment.createTransition(f.transData,r,i,n,f.slideSizePixels.x/f.slideSizePixels.y,!!this.settings.morphEnabled,a);case 14:u=t.sent,t.next=18;break;case 17:u.metadata=l.metadata;case 18:return C.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(h=e.performanceNowTrimmed()-d),this.hideUnderlaysAndOverlays(),u.metadata||(u.metadata={}),u.metadata.getSlideViewPerfInTransitionMS=s,u.metadata.rendererEnvironment||(u.metadata.rendererEnvironment={}),u.metadata.rendererEnvironment.TotalMS=h,t.abrupt("return",u);case 25:case"end":return t.stop()}}),t,this)}))),function(e,t,r,i){return j.apply(this,arguments)})},{key:"renderBlankSlide",value:function(t,r,i){this.hideUnderlaysAndOverlays();var n=this.m_inScreenCoordsContainer,a=e.getElementFromCollection(n.children,e.BlankSlideDivId);a&&n.removeChild(a);var o=document.createElement("div");if(o.id=e.BlankSlideDivId,o.style.background=t,o.style.width="100%",o.style.height="100%",o.style.position="absolute",o.style.pointerEvents="none",o.style.zIndex="3",r&&i){var s=document.createElement("div");s.style.textAlign="center",s.style.fontSize="120%",s.setAttribute("aria-live","assertive"),s.textContent=r,s.style.color=i,s.style.fontFamily="Segoe UI, sans-serif",o.appendChild(s)}return n.appendChild(o),o}},{key:"finishTransition",value:function(){this.m_transitionController&&(this.m_transitionController.clock.stop(),this.m_transitionController.onDispose(),this.m_transitionController=null)}},{key:"getTransitionController",value:function(){return this.m_transitionController}},{key:"getSlideDimensions",value:function(){if(this.rendererEnvironment.canvas)return new p.Vector2(parseInt(this.rendererEnvironment.canvas.style.width,10),parseInt(this.rendererEnvironment.canvas.style.height,10))}},{key:"getSlideViewBounds",value:function(){var e=this.rendererEnvironment.canvas;if(e){var t=this.getBounds.getBoundingClientRectFromCanvas(),r={top:t.top,bottom:t.bottom,left:t.left,right:t.right};return r.top+=e.clientTop,r.bottom-=e.clientTop,r.left+=e.clientLeft,r.right-=e.clientLeft,r}}},{key:"hideUnderlaysAndOverlays",value:function(){var t=this;Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach((function(r){-1===r.id.search(e.CrossSlideShapeId)&&t.m_slideLevelHtmlElementsParentContainer.removeChild(r)}))}},{key:"showHideCrossSlideAudios",value:function(t){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach((function(t){t&&t.id.search(e.CrossSlideShapeId)>0&&t.firstChild&&(t.firstChild.style.visibility="hidden")}));var r=this.crossSlideMediaMap[t];r&&r.forEach((function(e){var t=document.getElementById(e.mediaElement.id);t&&(t.style.visibility="",e.mediaProps.hideWhenStopped&&(t.style.visibility="hidden"))}))}},{key:"stopCrossSlideAudio",value:function(){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach((function(t){var r=t;r&&r.id.search(e.CrossSlideShapeId)>0&&(r.currentTime=0,r.pause?r.pause():v.ULS.sendTraceTag(539874464,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"Wrong HTML Audio tag ".concat(r.tagName)))}))}},{key:"showUnderlaysAndOverlays",value:function(t){var r=this;Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach((function(i){var n=i;if(!(n.id.search(e.CrossSlideShapeId)>0))try{var a=n.id.split("".concat(e.SlideLevelHtmlElementsDivId,"-")),o=a&&a[1]?JSON.parse(a[1]):null;if(o&&o.slideId&&o.slideId.sid!==JSON.parse(t).sid&&r.m_slideLevelHtmlElementsParentContainer.removeChild(i),(a=n.id.split("".concat(e.ShapeAccessibilityElementId,"-")))&&a[1]){var s=a[1].split("sid:"),l=s&&s[1]?s[1].split("-"):null;l&&l[0]&&parseInt(l[0],10)!==JSON.parse(t).sid&&r.m_slideLevelHtmlElementsParentContainer.removeChild(i)}}catch(e){v.ULS.sendTraceTag(558155866,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Unexpected exception in showUnderlaysAndOverlays: ".concat(e))}}))}},{key:"createNewScene",value:function(){var e=new g.Group;return this.m_currentSceneCount+=1,e}},{key:"createImageTextureMapData",value:(W=(0,d.default)(c.default.mark((function e(t){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w.Settings.readBooleanOrDefault("asyncSafeCreateTextures",!0)){e.next=4;break}return e.next=3,this.m_createImageTextureMapDataThrottler.callAsync(t);case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.createImageTextureMapDataImpl(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return W.apply(this,arguments)})},{key:"createImageTextureMapDataImpl",value:(V=(0,d.default)(c.default.mark((function t(r){var i,n,a,o,s,l,u,d,h,f;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={},v.ULS.sendTraceTag(575758489,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::createImageTextureMapData - beginning"),C.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.textureMetadata={loadTexture:0,slidedata:0}),n=0,C.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n=e.performanceNowTrimmed()),t.next=7,this.viewDataManager.getSlideViewData(r.slideId);case 7:if(a=t.sent,C.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.textureMetadata.slidedata=e.performanceNowTrimmed()-n),!a.resource||!a.resource.resCat){t.next=42;break}o=a.resource,s=0,l=B(o.resCat),t.prev=13,l.s();case 15:if((u=l.n()).done){t.next=32;break}if(d=u.value,this.viewDataManager.imageDataMap.has(d.id)){t.next=27;break}return v.ULS.sendTraceTag(575758490,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::createImageTextureMapData - loading ".concat(d.id)),C.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s=e.performanceNowTrimmed()),t.next=22,this.loadImageTexture(d,o.slideId,o.slideSizePixels);case 22:h=t.sent,C.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.textureMetadata.loadTexture+=e.performanceNowTrimmed()-s),h.hasOwnProperty("errorName")&&(i.hasOwnProperty("invalidImageIds")||(i.invalidImageIds=[]),i.invalidImageIds.push(d.id)),t.next=30;break;case 27:(f=this.viewDataManager.imageDataMap.get(d.id)).loadedSlideIDs.find((function(e){return e.sid===o.slideId.sid}))||f.loadedSlideIDs.push(o.slideId),v.ULS.sendTraceTag(575758491,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::createImageTextureMapData - already loaded ".concat(d.id));case 30:t.next=15;break;case 32:t.next=37;break;case 34:t.prev=34,t.t0=t.catch(13),l.e(t.t0);case 37:return t.prev=37,l.f(),t.finish(37);case 40:v.ULS.sendTraceTag(576247953,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController::createImageTextureMapData - setting fImageTextureLoaded to true for SlideSID:".concat(r.slideId.sid)),r.slideViewElement.fImageTextureLoaded=!0;case 42:return t.abrupt("return",i);case 43:case"end":return t.stop()}}),t,this,[[13,34,37,40]])}))),function(e){return V.apply(this,arguments)})},{key:"loadImageTexture",value:(N=(0,d.default)(c.default.mark((function e(t,r,i){var n=this;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url&&this.rendererEnvironment.isGLContextValid){e.next=3;break}return v.ULS.sendTraceTag(561639896,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Image Failed to load - ".concat(JSON.stringify({id:t.id,hasUrl:!!t.url,mimeType:t.mimeType,urlType:t.urlType,byteCount:t.byteCount,isGLContextValid:this.rendererEnvironment.isGLContextValid}))),e.abrupt("return",{});case 3:return e.abrupt("return",new Promise((function(e){var a=new Image;if(a.ID=t.id,a.onload=function(){try{var o=n.getBounds.getBoundingClientRectFromContainer(),s=n.rendererEnvironment.saveImageData(a,t,r,i,{x:o.width,y:o.height});return e(s),s}catch(t){return v.ULS.sendTraceTag(545927755,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Exception in image.onload for id: ".concat(a.ID," e: ").concat(t)),e({errorName:k.ErrorCode.CannotLoadImageTexture}),{errorName:k.ErrorCode.CannotLoadImageTexture}}},a.onerror=function(){return v.ULS.sendTraceTag(595646167,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"Image Failed to load - ".concat(a.ID)),e({errorName:k.ErrorCode.CannotLoadImageTexture}),{errorName:k.ErrorCode.CannotLoadImageTexture}},a.name=t.name,t.mimeType.startsWith("image/svg+xml")&&t.urlType===p.UrlType.Base64){var o=t.url.indexOf(",");if(C.ChangeGate.isChangeGateEnabled("FireFoxSVGFileRenderingFix")){var s=t.url.substring(0,o+1),l=t.url.substring(o+1),c=(new DOMParser).parseFromString(l,"image/svg+xml");n.ensureSVGWidthHeight(c.documentElement),a.src=s+encodeURIComponent(c.documentElement.outerHTML)}else a.src=t.url.substring(0,o+1)+encodeURIComponent(t.url.substring(o+1))}else a.src=t.url;return{}})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return N.apply(this,arguments)})},{key:"ensureSVGWidthHeight",value:function(e){if(!e.getAttribute("width")||!e.getAttribute("height")){var t=e.getAttribute("viewBox");if(t){var r=t.match(/\w+ \w+ (\w+) (\w+)/);null!=r&&(e.setAttribute("width",r[1]),e.setAttribute("height",r[2]))}}}},{key:"clearNavigationState",value:function(){var e,t=B(this.m_slideSceneView);try{for(t.s();!(e=t.n()).done;){var r,i=e.value,n=B(i.slideViewElement.animTimeline.getTimelineStates(!1)||[]);try{for(n.s();!(r=n.n()).done;){var a=r.value;i.slideViewElement.animTimeline.resetTimeline(a.timelineId),i.slideViewElement.fNeedsDummyClick&&i.slideViewElement.animTimeline.addTimelineClick(y.AnimConstants.MainTimelineId)}}catch(e){n.e(e)}finally{n.f()}i.slideViewElement.animClock.stop()}}catch(e){t.e(e)}finally{t.f()}}},{key:"refreshViewController",value:(u=(0,d.default)(c.default.mark((function t(){var r;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.settings.isMultiSlideshowcoreEnabled&&e.s_preloadedRendererEnvironment&&(C.ChangeGate.isChangeGateEnabled("EnableTriggerAnimation")&&(document.querySelectorAll("#".concat(e.SlideLevelHtmlElementsParentDivId)).forEach((function(e){e.remove()})),(r=document.createElement("div")).id=e.SlideLevelHtmlElementsParentDivId,this.m_container.appendChild(r),this.m_slideLevelHtmlElementsParentContainer=r),this.rendererEnvironment=e.s_preloadedRendererEnvironment,this.getBounds=this.settings.getBounds?this.settings.getBounds:new M.GetBounds(this.m_container,this.rendererEnvironment),this.rendererEnvironment.viewController=this,this.m_viewControllerInternals&&(this.rendererEnvironment.viewControllerInternals=this.m_viewControllerInternals),this.rendererEnvironment.setupCanvas(this.m_container));case 1:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"updateViewDataManager",value:(i=(0,d.default)(c.default.mark((function t(r,i,n){var a,o,s,l,u,d,h,f,m,p,g=this;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a={},o=!(!n||!n.fSkipRendering),s=B(this.m_slideSceneView),t.prev=3,u=c.default.mark((function e(){var t;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.value,!g.m_currentRenderedSlideId||t.slideId.sid!==g.m_currentRenderedSlideId.sid||o){e.next=4;break}return t.slideViewElement.shapeViewElements=[],e.abrupt("return",1);case 4:t.scene&&g.deleteScene(t),t.slideViewElement.shapeViewElements=[],g.m_slideSceneView=g.m_slideSceneView.filter((function(e){return e!==t}));case 7:case"end":return e.stop()}}),e)})),s.s();case 6:if((l=s.n()).done){t.next=12;break}return t.delegateYield(u(),"t0",8);case 8:if(!t.t0){t.next=10;break}return t.abrupt("continue",10);case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(3),s.e(t.t1);case 17:return t.prev=17,s.f(),t.finish(17);case 20:if(this.viewDataManager=r,!this.m_currentRenderedSlideId||o){t.next=46;break}if(v.ULS.sendTraceTag(591927435,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"Rerender the current slide with new ViewDataManager - sid:".concat(this.m_currentRenderedSlideId.sid)),d=this.m_slideSceneView.find((function(e){return e.slideId.sid===g.m_currentRenderedSlideId.sid})),h=e.getElementFromCollection(this.m_inScreenCoordsContainer.children,e.BlankSlideDivId),f=!h||C.ChangeGate.isChangeGateEnabled("SSC.shouldRenderOnBlankSlide"),!d||!f){t.next=46;break}return t.next=29,d.slideViewElement.ensure({loadDataOptions:n});case 29:if(!(m=t.sent).hasOwnProperty("errorName")){t.next=34;break}v.ULS.sendTraceTag(591927436,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::updateViewDataManager: invalid slideViewData. sid:".concat(this.m_currentRenderedSlideId.sid,", ensureResult:").concat(m.errorName)),t.next=45;break;case 34:for(d.scene&&this.deleteScene(d);this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.firstChild.remove();return t.next=38,this.createImageTextureMapData(d);case 38:return p=t.sent,t.next=41,d.slideViewElement.ensure({loadDataOptions:n});case 41:m=t.sent,this.viewDataManager.slideMetadataMap.set(this.m_currentRenderedSlideId.sid,{slideId:this.m_currentRenderedSlideId,isHidden:d.slideViewElement.isHidden}),this.renderSlideById(this.m_currentRenderedSlideId,i),a=U(U({},m),p);case 45:a=U(U({},a),m);case 46:return t.abrupt("return",a);case 47:case"end":return t.stop()}}),t,this,[[3,14,17,20]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"isGlobalMute",get:function(){return this.m_isGlobalMute}},{key:"updateGlobalMute",value:function(e){if(this.m_isGlobalMute!==e){var t,r=B(this.m_slideSceneView);try{for(r.s();!(t=r.n()).done;)t.value.slideViewElement.updateGlobalMute(e)}catch(e){r.e(e)}finally{r.f()}this.m_isGlobalMute=e}}},{key:"muteAllPlayingMedia",value:function(){v.ULS.sendTraceTag(523347020,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Info,"ViewController: Muting all playing media");var e,t=B(this.m_slideSceneView);try{for(t.s();!(e=t.n()).done;)e.value.slideViewElement.muteAllPlayingMedia()}catch(e){t.e(e)}finally{t.f()}}},{key:"checkForLeaksByScenario",value:function(){var e,t=this.checkForLeaks(),r=new Map,i=B(t?t.table:[]);try{for(i.s();!(e=i.n()).done;){var n=e.value;if("DistanceField/glyphPage"!==n.scenario&&"ScratchBuffer"!==n.scenario){n.scenario=n.scenario.split("-")[0];var a=r.get(n.scenario)||0;r.set(n.scenario,a+n.memory)}}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"checkForLeaks",value:function(e){var t=this.rendererEnvironment.webGLRenderer;if(t){var r,i=[],n=B(this.m_slideSceneView);try{for(n.s();!(r=n.n()).done;){var a=r.value;a.scene&&(i.push(a.scene),e&&a.scene.releaseGeneratedResources())}}catch(e){n.e(e)}finally{n.f()}var o,s=B(this.m_morphCache.getAllLoadResultsInCache().filter((function(e){return e.resource})).map((function(e){return e.resource})));try{for(s.s();!(o=s.n()).done;){var l=o.value;e&&l.dispose(),i.push(l.morph);var c,u=B(l.createdItems);try{for(u.s();!(c=u.n()).done;){var d=c.value;i.push(d)}}catch(e){u.e(e)}finally{u.f()}}}catch(e){s.e(e)}finally{s.f()}var h,f=B(this.viewDataManager.externalTexturesToRelease);try{for(f.s();!(h=f.n()).done;){var m=h.value;i.push(m.texture)}}catch(e){f.e(e)}finally{f.f()}return{textures:t.getAllocatedTextures(i),table:t.getAllocatedTexturesDebugTable("clientData.id",i)}}console.log("only supported for webGL")}}],[{key:"s_isGlyphCacheDisabled",get:function(){return e.s_glyphCacheFailedCount>1}},{key:"ensureRendererEnvironment",value:function(t){e.s_preloadedRendererEnvironment||(e.s_preloadedRendererEnvironment=w.Settings.readBooleanOrDefault("forceSvg",!1)?new E.SVGRendererEnvironment:w.Settings.readBooleanOrDefault("useNewWebGLRendererEnvironment",!1)?new I.WebGLRendererEnvironment(t||new O.ShapeBuilderCanvasContext):new D.WebGLRendererEnvironmentDeprecated)}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}},{key:"trimTo100th",value:function(e){return Math.round(1e3*e)/1e3}},{key:"createRenderBackgroundOrForegroundFilter",value:function(e){return function(t){return void 0===(0,P.ensureClientData)(t).isBackground||(0,P.ensureClientData)(t).isBackground===e}}},{key:"preloadShaders",value:(r=(0,d.default)(c.default.mark((function t(r,i){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ensureRendererEnvironment(i?i.shapeBuilderCanvasContext:void 0),!e.s_preloadedRendererEnvironment){t.next=6;break}return t.next=4,e.s_preloadedRendererEnvironment.preloadShadersAsync(r);case 4:t.next=7;break;case 6:v.ULS.sendTraceTag(555246685,v.LogCategory.msoulscat_Wac_PptSession,v.TraceLevel.Error,"ViewController::preloadShaders - s_preloadedRendererEnvironment is null");case 7:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"getElementFromCollection",value:function(e,t){for(var r=0;r<e.length;r+=1)if(e[r].id===t)return e[r]}},{key:"getElementFromCollectionByLocalName",value:function(e,t){for(var r=0;r<e.length;r+=1)if(e[r].localName===t)return e[r]}}]);var r,i,u,N,V,W,j,z,q,Z,X,Y,J}();t.ViewController=j,j.accessibilityLanguage="",j.s_gpuHardwareDisabled=!1,j.s_isBadGpu=!1,j.s_glyphCacheFailedCount=0,j.ClickTargetsReferenceDivId="click-targets-reference",j.BlankSlideDivId="blank-slide",j.CrossSlideAudioContainerDivId="cross-slide-audio",j.AccessibilityLiveRegionContainerDivId="live-region-accessibility-element",j.SlideLevelHtmlElementsParentDivId="slide-level-html-elements-parent",j.SlideLevelHtmlElementsDivId="slide-level-html-elements-transform",j.ShapeAccessibilityElementId="shape-accessibility-element",j.AccessibilitySlideTitleId="accessibility-slide-title",j.CrossSlideShapeId="cross-slide-shape",j.NotesPaneParagraphReaderId="notes-pane-paragraph-reader",j.PreactivedAddinsDivId="cross-slide-preactived-addins"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIsAnimationTransformAbsolute=function(e){t.s_isAnimationTransformAbsolute=a=e},t.setMinLineWidth=function(e,r){t.s_minLineWidth=o=e,t.s_minLineWidthForArrowHead=s=r},t.setHitTestSlop=function(e){t.s_hitTestSlop=l=e},t.setHitTestCache=function(e){t.s_hitTestCache=c=e},t.setUseLegacyBrightness=function(e){t.s_useLegacyBrightness=u=e},t.setUseLegacyContrast=function(e){t.s_useLegacyContrast=d=e},t.setUseLegacySharpness=function(e){i.Log.Message(507581186,"LegacySharpness no longer supported")},t.setDebugMode=function(e){t.debugMode=h=e},t.enableTextLinesDebugMode=function(e){t.s_textLinesDebugModeEnabled=f=e},t.setLogger=function(e){i.Log.setLogger(e)},t.setSettings=function(e){n.Settings.load(e)},t.enableFinalizerWarnings=function(e,r){t.s_finalizerWarningsEnabled=m=e,t.s_finalizerWarningsInfoPath=p=r},t.enableFinalizerCleanup=function(e){t.s_finalizerCleanupEnabled=g=e},t.isChangeTrackerWeakRefSupported=_,t.enableChangeTrackerWeakRef=function(e,r){!e||_()?(t.s_changeTrackerWeakRef=v=e,t.s_changeTrackerWeakRefVerbose=y=r):i.Log.Error(525337747,"ChangeTrackerWeakRef not supported")},t.enableDeferGroupTracking=function(e){t.s_deferGroupTracking=S=e},t.setGlyphCacheTextureResolution=function(e){t.s_glyphCacheTextureResolution=T=e},t.setGlyphCacheMaxFactor=function(e){t.s_glyphCacheMaxFactor=b=e},t.s_glyphCacheMaxFactor=t.s_glyphCacheTextureResolution=t.s_deferGroupTracking=t.s_changeTrackerWeakRefVerbose=t.s_changeTrackerWeakRef=t.s_finalizerWarningsInfoPath=t.s_finalizerCleanupEnabled=t.s_finalizerWarningsEnabled=t.s_textLinesDebugModeEnabled=t.s_debug_thinLine_value=t.debugMode=t.debug_thinLine=t.debug_dash=t.debug_relief=t.debug_signed=t.debug_fill=t.debug_tape=t.debug_edge=t.debug_OFF=t.s_useLegacyContrast=t.s_useLegacyBrightness=t.s_hitTestCache=t.s_hitTestSlop=t.s_minLineWidthForArrowHead=t.s_minLineWidth=t.s_isAnimationTransformAbsolute=void 0;var i=r(13),n=r(50),a=!0;t.s_isAnimationTransformAbsolute=a;var o=1;t.s_minLineWidth=o;var s=8;t.s_minLineWidthForArrowHead=s;var l=16;t.s_hitTestSlop=l;var c=0;t.s_hitTestCache=c;var u=!0;t.s_useLegacyBrightness=u;var d=!0;t.s_useLegacyContrast=d,t.debug_thinLine=7,t.debug_dash=6,t.debug_relief=5,t.debug_signed=4,t.debug_fill=3,t.debug_tape=2,t.debug_edge=1,t.debug_OFF=0;var h=0;t.debugMode=h,t.s_debug_thinLine_value=3;var f=!1;t.s_textLinesDebugModeEnabled=f;var m=!1;t.s_finalizerWarningsEnabled=m;var p,g=!1;t.s_finalizerCleanupEnabled=g,t.s_finalizerWarningsInfoPath=p;var v=!1;t.s_changeTrackerWeakRef=v;var y=!1;function _(){return"undefined"!=typeof WeakRef}t.s_changeTrackerWeakRefVerbose=y;var S=!1;t.s_deferGroupTracking=S;var T=1040;t.s_glyphCacheTextureResolution=T;var b=0;t.s_glyphCacheMaxFactor=b},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeTracker=t.TrackableArray=void 0;var n=i(r(1)),a=i(r(2)),o=r(13),s=r(36);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=(0,a.default)((function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,n.default)(this,e),this.m_changeTracker=new d,this.deferTracking=r,this.m_changeTracker=new d(r?this.getHash:void 0),this.m_elements=[],t&&(this.elements=t)}),[{key:"getHash",value:function(){return this.m_elements.map((function(e){return e.changeTracker.currentUniqueId})).join(",")}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"length",get:function(){return this.m_elements.length}},{key:"elements",get:function(){return this.m_elements},set:function(e){this.removeAll();var t,r=l(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.push(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:"getAt",value:function(e){if(e<0||e>=this.elements.length)throw o.Log.Error(592520775,"Out of range");return this.m_elements[e]}},{key:"setAt",value:function(e,t){this.deferTracking||(d.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),d.AddListener(t.changeTracker,this.m_changeTracker)),this.m_elements[e]=t}},{key:"push",value:function(e){this.deferTracking||d.AddListener(e.changeTracker,this.m_changeTracker),this.m_elements.push(e)}},{key:"insertAt",value:function(e,t){this.deferTracking||d.AddListener(t.changeTracker,this.m_changeTracker),this.m_elements.splice(e,0,t)}},{key:"removeAll",value:function(){if(!this.deferTracking){var e,t=l(this.m_elements);try{for(t.s();!(e=t.n()).done;){var r=e.value;d.RemoveListener(r.changeTracker,this.m_changeTracker)}}catch(e){t.e(e)}finally{t.f()}}this.m_elements=[]}},{key:"removeAt",value:function(e){this.deferTracking||d.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),this.m_elements.splice(e,1)}}]);t.TrackableArray=u;var d=function(){function e(t){(0,n.default)(this,e),this.trackerId=e.s_nextUniqueId++,this.m_version=0,this.m_getDeferedHashFunction=t,this.m_currentUniqueId=this.trackerId+"v0",s.s_changeTrackerWeakRef&&(0,s.isChangeTrackerWeakRefSupported)()?this.m_weakListeners=[]:this.m_listeners=[]}return(0,a.default)(e,[{key:"version",get:function(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_version}},{key:"currentUniqueId",get:function(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_currentUniqueId}},{key:"listenerCount",get:function(){var e,t;return(null===(e=this.m_weakListeners)||void 0===e?void 0:e.length)||(null===(t=this.m_listeners)||void 0===t?void 0:t.length)||0}},{key:"verifyDeferedHash",value:function(){if(this.m_getDeferedHashFunction){var e=this.m_getDeferedHashFunction();e!=this.m_deferedHash&&(this.notifyChange(),this.m_deferedHash=e)}}},{key:"notifyChange",value:function(){if(this.m_version++,this.m_currentUniqueId=this.trackerId+"v"+this.m_version,this.m_weakListeners){var e=this.m_weakListeners.length;this.m_weakListeners=this.m_weakListeners.filter((function(e){return null!=e.deref()})),s.s_changeTrackerWeakRefVerbose&&e!=this.m_weakListeners.length&&o.Log.Message(525337748,"ChangeTracker detaching ".concat(e-this.m_weakListeners.length," zombie dependencies"));var t,r=l(this.m_weakListeners);try{for(r.s();!(t=r.n()).done;){var i;null===(i=t.value.deref())||void 0===i||i.notifyChange()}}catch(e){r.e(e)}finally{r.f()}}else if(this.m_listeners){var n,a=l(this.m_listeners);try{for(a.s();!(n=a.n()).done;)n.value.notifyChange()}catch(e){a.e(e)}finally{a.f()}}}},{key:"replaceListener",value:function(t,r){t!=r&&(t&&e.RemoveListener(t.changeTracker,this),r&&e.AddListener(r.changeTracker,this))}}],[{key:"AddListener",value:function(e,t){if(e)if(e.m_weakListeners){if(void 0===e.m_weakListeners.find((function(e){return e.deref()===t}))){if("undefined"==typeof WeakRef)throw o.Log.Error(525337749,"WeakRef not supported");e.m_weakListeners.push(new WeakRef(t)),t.notifyChange()}}else{if(!e.m_listeners)throw o.Log.Error(525337750,"No dependency array");-1==e.m_listeners.indexOf(t)&&(e.m_listeners.push(t),t.notifyChange())}}},{key:"RemoveListener",value:function(e,t){if(e)if(e.m_weakListeners)e.m_weakListeners=e.m_weakListeners.filter((function(e){return e.deref()!=t})),t.notifyChange();else if(e.m_listeners){var r=e.m_listeners.indexOf(t);-1!=r&&(e.m_listeners.splice(r,1),t.notifyChange())}}}])}();t.ChangeTracker=d,d.s_nextUniqueId=1},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setQuality=function(e){t.distanceFieldQuality=I=t.blurQuality=k=e},t.enableExperimentalGlyphTable=function(e){t.s_enableExperimentalGlyphTable=x=e},t.unrotatedRectLocation=function(e){return{center:e.center,size:e.size,rotation:0,flipX:!1,flipY:!1}},t.transformedRectLocation=function(e,t){return{center:e.center.add(t.preTranslation).multiply(t.scale).rotate(t.rotation).add(t.translation),size:e.size.multiply(t.scale.abs()),rotation:t.rotation,flipX:t.scale.x<0,flipY:t.scale.y<0}},t.applySharpnessFilter=function(e,t,r,i,n,a,o,s){var l=t.originalSize.x/t.originalSize.y;F(e,t,t,n,0,l,[new p.Rect(0,0,t.size.x,t.size.y)],[new p.Rect(0,0,n.size.x,n.size.y)],n.size,i,a,o,s),F(e,t,n,r,1,l,[new p.Rect(0,0,n.size.x,n.size.y)],[new p.Rect(0,0,r.size.x,r.size.y)],r.size,i,a,o,s)},t.rectsToArray=D,t.applySharpnessFilterPass=F,t.drawTexture=function(e,t,r,i,n,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0;if(r.isValidForGraphicsProcessor(e)){var u=Math.max(i.length,n.length);if(0!=u){var d=D(i,r.size,u),f=D(n,a,u),m=e.getBabylonEngine(),v=m.createVertexBuffer(d),y=m.createVertexBuffer(f);if(m.bindInstancesBuffer(v,R,!1),m.bindInstancesBuffer(y,O,!1),t.setTexture("t_0",r.tryUseBabylonTexture(e,void 0,"drawTextureRects")),t.programId!=b.ProgramId.copyTextureDrawMask&&t.getBabylonEffect().setFloat("ufrag_0",s),t.programId==b.ProgramId.copyTexturePictureEffects){var _,S,T=null==c?void 0:c.secondaryTexture;t.setTexture("t_1",null==T?void 0:T.tryUseBabylonTexture(e,void 0,"drawTextureRects/Secondary")),t.getBabylonEffect().setInt("ufrag_1",o),B(t,null==c?void 0:c.pictureEffects),t.getBabylonEffect().setDirectColor4("ufrag_19",l||h.Color.Transparent),t.getBabylonEffect().setVector2("ufrag_22",r.size);var C=null==c?void 0:c.lookupTableTexture;if(null!=c&&null!==(_=c.pictureEffects)&&void 0!==_&&_.lookupTable&&C){var w=null==c?void 0:c.pictureEffects.lookupTable;t.getBabylonEffect().setFloat4("ufrag_23",w.dimensionR,w.dimensionG,w.dimensionB,w.blocksPerRow),t.setTexture("t_2",C.tryUseBabylonTexture(e,void 0,"drawTextureRects/lookupTableTexture"))}else t.getBabylonEffect().setFloat4("ufrag_23",0,0,0,0),t.setTexture("t_2",void 0);var P=null==c?void 0:c.maskTexture;if(P&&null!=c&&null!==(S=c.pictureEffects)&&void 0!==S&&S.mask){var I,k=null==c||null===(I=c.pictureEffects)||void 0===I?void 0:I.maskChannel;t.getBabylonEffect().setInt("ufrag_29",c.pictureEffects.mask.mode+1),t.setTexture("t_4",P.tryUseBabylonTexture(e,void 0,"drawTextureRects/maskTexture")),t.getBabylonEffect().setFloat4("ufrag_30",0!=k&&k?0:1,1==k?1:0,2==k?1:0,3==k?1:0)}else t.getBabylonEffect().setInt("ufrag_29",0),t.setTexture("t_4",void 0);var E=null==c?void 0:c.ditherPalette256;E?(t.getBabylonEffect().setInt("ufrag_24",1),t.setTexture("t_3",E.tryUseBabylonTexture(e,void 0,"drawTextureRects/ditherPalette256"))):(t.getBabylonEffect().setInt("ufrag_24",0),t.setTexture("t_3",void 0))}else if(t.programId==b.ProgramId.copyTextureDrawMask&&null!=c&&c.textureTransform){var x,L,A,M,F,N,V,U,W;t.getBabylonEffect().setVector2("ufrag_22",r.size),t.getBabylonEffect().setMatrix3x3("u_1",null==c?void 0:c.textureTransform.m),t.getBabylonEffect().setInt("ufrag_1",null!==(x=null==c||null===(L=c.drawMaskParams)||void 0===L?void 0:L.drawMaskMode)&&void 0!==x?x:0),t.getBabylonEffect().setFloat("ufrag_2",null!==(A=null==c||null===(M=c.drawMaskParams)||void 0===M?void 0:M.drawMaskParam)&&void 0!==A?A:0),t.getBabylonEffect().setVector2("ufrag_3",null!==(F=null==c||null===(N=c.drawMaskParams)||void 0===N?void 0:N.drawMaskFlipXY)&&void 0!==F?F:p.Vector2.One),t.getBabylonEffect().setInt("ufrag_4",null!==(V=null==c||null===(U=c.drawMaskParams)||void 0===U?void 0:U.drawMaskOrder)&&void 0!==V?V:0),t.getBabylonEffect().setInt("ufrag_5",null!=c&&null!==(W=c.drawMaskParams)&&void 0!==W&&W.drawMaskTransposeXY?1:0)}t.drawQuadInstances(u),t.disableInstanceAttribute("a_0"),t.disableInstanceAttribute("a_1"),m._releaseBuffer(v),m._releaseBuffer(y)}}else g.Log.Error(591192838,"Invalid Texture")},t.scaleImageResolutionToFitShapeBounds=G,t.medianResize=function(e,t,r,i,n){var a=e,o=a.getGraphicsProcessor?a.getGraphicsProcessor():void 0;if(o){if(o.beginRenderScope()){if((0,T.runMedianProgram)(o,t,r,i),n>0){var s=r.size.y/t.size.y;(0,T.applyBlur)(a,r,n*s,S.EffectFlags.none,void 0,void 0)}o.endRenderScope()}}else g.Log.Error(506852387,"No GraphicsProcessor")},t.ditherImageWithPalette256=function(e,t,r,i){e.drawTextureToTexture(t,r,M.pictureEffects,{ditherPalette256:i.ensureTexture(e)})},t.scaleToFitMaxTextureResolution=z,t.isPowerOfTwo=q,t.nextPowerOfTwoDimensions=function(e,t){var r=N(new p.Vector2(e,t));return(e>r.x||t>r.y)&&(r=new p.Vector2(Math.min(2*r.x,m.maxTextureResolution),Math.min(2*r.y,m.maxTextureResolution))),r},t.Palette256=t.ImageTextureLoader=t.ReloadOnStepSizeIncreasePolicy=t.NeverReloadPolicy=t.DrawTextureMode=t.TargetTexture=t.Texture=t.s_enableExperimentalGlyphTable=t.TextureManager=t.TextureReleasePolicy=t.TextureState=t.gradientResolution=t.scratchBufferCount=t.scratchBufferSize=t.distanceFieldMaxRes=t.maxTileTextureResolution=t.blurQuality=t.distanceFieldQuality=void 0;var n=i(r(9)),a=i(r(31)),o=i(r(8)),s=i(r(10)),l=i(r(18)),c=i(r(1)),u=i(r(2)),d=r(40),h=r(16),f=r(37),m=r(131),p=r(12),g=r(13),v=r(51),y=r(133),_=r(50),S=r(20),T=r(89),b=r(41);function C(e,t,r){return t=(0,o.default)(t),(0,n.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,o.default)(e).constructor):t.apply(e,r))}var w,P,I=1,k=1;t.blurQuality=k,t.distanceFieldQuality=I,t.maxTileTextureResolution=2048,t.gradientResolution=256,t.scratchBufferCount=2,t.scratchBufferSize=2048,t.distanceFieldMaxRes=4096,t.TextureState=w,function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.ReleasedWithoutNotification=2]="ReleasedWithoutNotification",e[e.WrongRenderer=3]="WrongRenderer",e[e.WrongContext=4]="WrongContext"}(w||(t.TextureState=w={})),t.TextureReleasePolicy=P,function(e){e[e.KeepUntilRelease=0]="KeepUntilRelease",e[e.DisposableCache=1]="DisposableCache",e[e.ExternallyManaged=2]="ExternallyManaged"}(P||(t.TextureReleasePolicy=P={}));var E=(0,u.default)((function e(){(0,c.default)(this,e),this.textureMemoryAllocated=0,this.allocatedTextures=[]}),[{key:"register",value:function(e){this.textureMemoryAllocated+=e.memoryUsage,this.allocatedTextures.push(e)}},{key:"unregister",value:function(e){this.textureMemoryAllocated-=e.memoryUsage,this.allocatedTextures=this.allocatedTextures.filter((function(t){return t!==e}))}}]);t.TextureManager=E;var x=!0;t.s_enableExperimentalGlyphTable=x;var L=function(){function e(t,r,i,n,a,o,s,l,u){if((0,c.default)(this,e),this.m_originalSize=p.Vector2.Zero,this.m_changeTracker=new f.ChangeTracker,this.m_compatibleGraphicsProcessorId=0,this.m_usageRecord=[],this.isMipMapped=!!l,!r.isValid())throw g.Log.Message(512297123,"Unable to create texture on invalid renderer");V(a),this.wrapMode=o,this.releasePolicy=s,this.scenario=t,this.creationTime=performance.now(),this.m_lastRenderTime=i?performance.now():void 0;var m=r.getMaxSupportedTextureSize(),v=n.x>m||n.y>m;if(v||!n.isFinitePositive()){var y=_.Settings.readBooleanOrDefault("throwOnInvalidTextureSize",!1),S=v?"max: ".concat(m,", "):"",T=g.Log.Error(572319067,"Invalid texture size: ".concat(n.x," x ").concat(n.y,", ").concat(S,"scenario: ").concat(t));if(y)throw T}else{var b=n.ceil();if(b.equals(n)||g.Log.Error(572319068,"Bad texture size. Should be positive integers: ".concat(n.x," x ").concat(n.y,", scenario: ").concat(t)),this.m_graphicsProcessor=r.getGraphicsProcessor(),!this.m_graphicsProcessor)throw g.Log.Error(592525214,"Unable to set texture if processor not initialized");if(this.m_graphicsProcessor.needPowerOf2TexturesForTilingOrMipMap()&&o!==h.WrapMode.clamp&&(!q(b.x)||!q(b.y))){var C=_.Settings.readBooleanOrDefault("throwOnInvalidTextureSize",!1),w=g.Log.Error(507009027,"Incompatible texture size: ".concat(n.x," x ").concat(n.y,", wrapMode:").concat(o,", scenario: ").concat(t));if(C)throw w}if(this.m_originalSize=b,this.m_babylonTexture=i instanceof d.InternalTexture?i:i?this.m_graphicsProcessor.createTextureGraphicsResourceFromExternalWebGLTexture(b,a,i,!0,!!l):void 0,this.m_compatibleGraphicsProcessorId=this.m_graphicsProcessor.getUniqueGraphicsProcessorId(),this.m_babylonTexture&&this.m_graphicsProcessor.needPowerOf2TexturesForTilingOrMipMap()&&o!==h.WrapMode.clamp&&(!q(b.x)||!q(b.y))){if(_.Settings.readBooleanOrDefault("noResample",!1))throw g.Log.Error(572303306,"Invalid texture size for non-clamp scenario: ${scenario}");g.Log.Error(572867283,"Texture size not supported for this wrap mode. The texture will be resampled and the copy will be managed by ShapeBuilder. Please conside resampling explicitely using WrapMode.clamp and cloneWithNewWrapMode when necessary. Scenario: ".concat(t));var I=e.GetRequiredSizeForWrapMode(this.m_graphicsProcessor,b,o),k=e.ResampleBabylonTexture(r,this.m_babylonTexture,this.originalSize,h.WrapMode.clamp,I,o,a);this.releasePolicy==P.ExternallyManaged?this.releasePolicy=P.KeepUntilRelease:this.m_babylonTexture.dispose(),this.m_babylonTexture=k}}var E=r;this.m_textureManager=E.getTextureManager(),u||this.m_textureManager.register(this)}return(0,u.default)(e,[{key:"graphicsProcessor",get:function(){return this.m_graphicsProcessor}},{key:"size",get:function(){return this.m_babylonTexture?new p.Vector2(this.m_babylonTexture.width,this.m_babylonTexture.height):p.Vector2.Zero}},{key:"originalSize",get:function(){return this.m_originalSize},set:function(e){this.m_changeTracker.notifyChange(),this.m_originalSize=e}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"lastUsage",get:function(){return this.m_usageRecord.length>0?Math.max.apply(Math,(0,l.default)(this.m_usageRecord.map((function(e){return e.lastUsage})))):0}},{key:"format",get:function(){return this.m_babylonTexture?this.m_babylonTexture.format:(g.Log.Error(572073351,"No texture, no format"),v.TextureFormat.RGBA)}},{key:"memoryUsage",get:function(){if(!this.graphicsProcessor)return 0;var e=this.getMemUsageData(),t=e.channels,r=e.dataSize,i=e.stencilDataSize;return Math.ceil(this.size.x*this.size.y*(t*r+i)*(this.isMipMapped?4/3:1))}},{key:"usageRecord",get:function(){return this.m_usageRecord}},{key:"lastRenderTime",get:function(){return this.m_lastRenderTime}},{key:"tryUseBabylonTexture",value:function(e,t,r){var i=Y(e),n=this.m_usageRecord.find((function(e){return e.clientObject==t}));return n?(n.lastScenario=r,n.lastUsage=performance.now(),n.usageCount++):this.m_usageRecord.push({clientObject:t,lastScenario:r,lastUsage:performance.now(),usageCount:1}),this.isValidForGraphicsProcessor(i)?this.m_babylonTexture:void 0}},{key:"contentLocation",get:function(){var e=this.size;return this.m_contentLocation?this.m_contentLocation:{logicalCenter:e.scale(.5),logicalSize:e,physicalCenter:e.scale(.5),physicalSize:e,rotation:0,flipX:!1,flipY:!1}},set:function(e){this.m_changeTracker.notifyChange(),this.m_contentLocation=e}},{key:"generateMipMap",value:function(){this.isMipMapped?g.Log.Message(507775135,"generateMipMap no longer necessary. Texture already has auto-henerated mipmaps. Scenario: "+this.scenario):g.Log.Error(507775136,"generateMipMap no longer supported. Please enable mipmaps ar construction time. Scenario: "+this.scenario)}},{key:"isValidForGraphicsProcessor",value:function(e){return this.m_babylonTexture&&this.m_graphicsProcessor==e&&this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}},{key:"isValid",value:function(e){var t=e.getGraphicsProcessor();return t&&this.isValidForGraphicsProcessor(t)}},{key:"getState",value:function(e){var t,r=e.getGraphicsProcessor();return this.m_babylonTexture?r&&this.m_graphicsProcessor==r?this.isValidForGraphicsProcessor(r)?0===(null===(t=this.m_babylonTexture)||void 0===t?void 0:t._references)?w.ReleasedWithoutNotification:w.Valid:w.WrongContext:w.WrongRenderer:w.Empty}},{key:"tryGetWebGLTexture",value:function(){var e;return this.m_babylonTexture&&(null===(e=this.m_babylonTexture._hardwareTexture)||void 0===e?void 0:e.underlyingResource)||void 0}},{key:"unregisterFromTextureManager",value:function(){this.m_textureManager&&(this.m_textureManager.unregister(this),this.m_textureManager=void 0)}},{key:"release",value:function(){var e,t;this.unregisterFromTextureManager(),this.m_babylonTexture&&this.releasePolicy!=P.ExternallyManaged&&this.m_babylonTexture.dispose(),this.m_babylonTexture=void 0,null===(e=this.m_textureConverterCache)||void 0===e||null===(e=e.primary)||void 0===e||e.release(),null===(t=this.m_textureConverterCache)||void 0===t||null===(t=t.secondary)||void 0===t||t.release(),this.m_changeTracker.notifyChange()}},{key:"cloneWithNewWrapMode",value:function(t,r,i,n){var a=this.m_graphicsProcessor;if(a&&this.m_babylonTexture&&this.isValidForGraphicsProcessor(a)){this.wrapMode==i&&g.Log.Error(592472277,"Why cloning if the wrapmode is the same?");var o=e.GetRequiredSizeForWrapMode(a,this.size,i),s=e.ResampleBabylonTexture(r,this.m_babylonTexture,this.originalSize,this.wrapMode,o,i,this.format);if(s){var l=new e(t,r,s,o,this.m_babylonTexture.format,i,n);return l.originalSize=this.originalSize,l}}else g.Log.Error(592472278,"Failed to get graphicsProcessor or valid texture")}},{key:"getMemUsageData",value:function(){var e=v.textureChannelCount[this.format],t=0;if(this.m_babylonTexture)switch(this.m_babylonTexture.type){case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;default:g.Log.Error(572867285,"Unknown texture type")}return{channels:e,dataSize:t,stencilDataSize:0}}}],[{key:"CreateFromByteBuffer",value:function(t,r,i,n,a,o,s,l,c,u,d){return e.CreateOrUpdateFromByteBuffer(t,void 0,r,i,n,a,o,s,l,c,u,d)}},{key:"CreateOrUpdateFromByteBuffer",value:function(t,r,i,n,a,o,s,l,c,u,d,f){if(!i.isValid())throw g.Log.Message(512297122,"Unable to create/update texture on invalid renderer");var m=i.getMaxSupportedTextureSize();if(n.x>m||n.y>m)throw g.Log.Error(507009026,"ByteBuffer too big: ".concat(n.x," x ").concat(n.y,", max: ").concat(m,", scenario: ").concat(t));var y=r,S=i.getGraphicsProcessor();if(!S)throw g.Log.Error(592525215,"No Graphics Processor");var T=o==v.TextureFormat.BGR||o==v.TextureFormat.NV12?v.TextureFormat.RGB:o==v.TextureFormat.BGRA?v.TextureFormat.RGBA:o;if(!y||y.isValidForGraphicsProcessor(S)&&y.size.equals(n)&&y.m_babylonTexture&&y.format==T&&y.wrapMode==s&&y.m_babylonTexture.invertY===!!c||(y.release(),y=void 0),o==v.TextureFormat.RGB||o==v.TextureFormat.RGBA||o==v.TextureFormat.LUMINANCE||o==v.TextureFormat.LUMINANCE_ALPHA){if(y&&y.m_babylonTexture)return S.updateTextureGraphicsResourceFromByteBuffer(y.m_babylonTexture,a,a instanceof Float32Array,f||4),y.changeTracker.notifyChange(),y.m_lastRenderTime=performance.now(),y;var b=S.needPowerOf2TexturesForTilingOrMipMap()&&s!==h.WrapMode.clamp&&!(q(n.x)&&q(n.y)),C=S.createTextureGraphicsResource(n,a,o,a instanceof Float32Array,b?h.WrapMode.clamp:s,l,!!c,f);if(b){if(o==v.TextureFormat.RGB||o==v.TextureFormat.RGBA){if(_.Settings.readBooleanOrDefault("noResample",!1))throw g.Log.Error(507009025,"Invalid ByteBuffer size for non-clamp scenario: ".concat(t));var w=e.GetRequiredSizeForWrapMode(S,n,s),I=e.ResampleBabylonTexture(i,C,n,h.WrapMode.clamp,w,s,o);if(C.dispose(),!I)throw g.Log.Error(507009024,"Failed to resample ByteBuffer size for non-clamp scenario: ".concat(t));return new e(t,i,I,w,o,s,null==u?P.KeepUntilRelease:u)}return g.Log.Error(507008995,"Unable to resample ByteBuffer size for non-clamp with format ".concat(o," scenario: ").concat(t)),new e(t,i,C,n,o,h.WrapMode.clamp,null==u?P.KeepUntilRelease:u)}return new e(t,i,C,n,o,s,null==u?P.KeepUntilRelease:u)}if(o==v.TextureFormat.BGR||o==v.TextureFormat.BGRA||o==v.TextureFormat.NV12){var k,E=(null===(k=y)||void 0===k?void 0:k.m_textureConverterCache)||{},x=o==v.TextureFormat.NV12?v.TextureFormat.LUMINANCE:T,L=o==v.TextureFormat.BGR||o==v.TextureFormat.BGRA;E.primary=e.CreateOrUpdateFromByteBuffer(t+"/primary",E.primary,i,n,a,x,s,l,c,P.KeepUntilRelease,d,f),E.secondary=o==v.TextureFormat.NV12?e.CreateOrUpdateFromByteBuffer(t+"/secondary",E.secondary,i,new p.Vector2(Math.ceil(.5*n.x),Math.ceil(.5*n.y)),a.slice(n.x*Math.ceil(n.y/(f||4))*(f||4)),v.TextureFormat.LUMINANCE_ALPHA,s,l,c,P.KeepUntilRelease,d,f):void 0;var M,R,O=void 0;if(E.primary.m_babylonTexture)if((O=e.ConvertTexture(t,i,y instanceof A?y:void 0,E.primary,L,E.secondary,T))&&d?O.m_textureConverterCache=E:(null===(M=E.primary)||void 0===M||M.release(),null===(R=E.secondary)||void 0===R||R.release()),O)return O.m_lastRenderTime=performance.now(),O}throw g.Log.Error(507910019,"Unsupported texture format")}},{key:"CreateFromHTMLElement",value:function(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.WrapMode.clamp,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5?arguments[5]:void 0;if(!r.isValid())throw g.Log.Message(512297121,"Unable to create texture on invalid renderer");var s=r.getGraphicsProcessor();if(!s)throw g.Log.Error(592525216,"No Graphics Processor");var l=new p.Vector2(i.width,i.height),c=e.GetRequiredSizeForWrapMode(s,l,n),u=X(c,r.getMaxSupportedTextureSize()),d=i;if(!l.equals(u)){var f=_.Settings.readBooleanOrDefault("noResample",!1);if(f)throw g.Log.Error(507008994,"Invalid image size for non-clamp scenario: ".concat(t));d=Z(i,u)}var m=s.createTextureGraphicsResource(u,d,v.TextureFormat.RGBA,!1,n,a,!0,void 0,o),y=new e(t,r,m,u,v.TextureFormat.RGBA,n,P.KeepUntilRelease);return y.originalSize=l,y}},{key:"CreateFromHTMLImageElement",value:function(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.WrapMode.clamp,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5?arguments[5]:void 0;return e.CreateFromHTMLElement(t,r,i,n,a,o)}},{key:"CreateOrUpdateFromHTMLElement",value:function(t,r,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:h.WrapMode.clamp,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6?arguments[6]:void 0;if(!i.isValid())throw g.Log.Message(512297120,"Unable to create/update texture on invalid renderer");var l=i.getGraphicsProcessor();if(!l)throw g.Log.Error(507910018,"No Graphics Processor");var c=new p.Vector2(n.width,n.height);if(r){if(r.isValidForGraphicsProcessor(l)&&r.m_babylonTexture&&r.size.equals(c)&&r.wrapMode==a&&r.isMipMapped==!!s)return l.updateTextureGraphicsResourceFromHTMLElement(r.m_babylonTexture,n,!0),r.changeTracker.notifyChange(),r.m_lastRenderTime=performance.now(),r;r.release()}return e.CreateFromHTMLElement(t,i,n,a,o,s)}},{key:"CreateFromTextureAndMask",value:function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:h.WrapMode.clamp,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:S.MaskMode.alpha,l=t,c=new A(e,t,n,P.KeepUntilRelease,{disableFiltering:!o,wrapMode:a}),u=new S.PictureEffects;return u.mask=new S.Mask(new h.ImageContainer,s),l.drawTextureToTexture(c,r,M.pictureEffects,{pictureEffects:u,maskTexture:i}),c}},{key:"GetRequiredSizeForWrapMode",value:function(e,t,r){return e.needPowerOf2TexturesForTilingOrMipMap()&&r!=h.WrapMode.clamp?q(t.x)&&q(t.y)?t:N(t):t}},{key:"ResampleBabylonTexture",value:function(t,r,i,n,a,o,s){var l=t,c=l.getGraphicsProcessor();if(c){var u=new e("TMP/ResampleSrc",t,r,i,r.format,n,P.ExternallyManaged),d=new A("TMP/ResampleDst",t,a,P.KeepUntilRelease,{disableFiltering:1==r.samplingMode,format:s});l.drawTextureToTexture(d,u,M.noFilter);var h=d.m_babylonTexture;return d.unregisterFromTextureManager(),d.m_babylonTexture=void 0,d.release(),h&&c.setWrapMode(h,o),u.release(),h}g.Log.Error(572867286,"Failed to get graphicsProcessor")}},{key:"ConvertTexture",value:function(e,t,r,i,n,a,o){var s,l=t;if(l.getGraphicsProcessor()){var c=1==(null===(s=i.m_babylonTexture)||void 0===s?void 0:s.samplingMode),u=A.RecycleOrReplace(e,r,t,i.size,P.KeepUntilRelease,{format:o,disableFiltering:c,wrapMode:i.wrapMode});return l.drawTextureToTexture(u,i,n?M.swapRedAndBlue:a?M.nv12:M.noFilter,{secondaryTexture:a}),u}g.Log.Error(526714142,"Failed to get graphicsProcessor")}}])}();t.Texture=L;var A=function(e){function t(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.Vector2.Zero,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if((0,c.default)(this,t),!r.isValid())throw g.Log.Message(512297119,"Unable to create TargetTexture on invalid renderer");var l=a.ceil();if(!l.isFinitePositive()){var u=g.Log.Error(506860951,"Bad TargetTexture size. Should be positive integers: ".concat(a.x," x ").concat(a.y,", scenario: ").concat(e)),d=_.Settings.readBooleanOrDefault("throwOnInvalidTextureSize",!1);if(d)throw u;l=p.Vector2.One}var f=s&&void 0!==s.wrapMode?s.wrapMode:h.WrapMode.clamp,m=r,y=m.getGraphicsProcessor();if(!y)return g.Log.Error(592525217,"Graphics processor not initialized"),(0,n.default)(i);f===h.WrapMode.clamp||q(a.x)&&q(a.y)||(g.Log.Error(507008993,"Incompatible TargetTexture size: ".concat(a.x," x ").concat(a.y,", wrapMode:").concat(f,", scenario: ").concat(e)),f=h.WrapMode.clamp);var S,T,b=s&&s.format?s.format:v.TextureFormat.RGBA;if(V(b),s&&s.externalTexture)T=y.createRenderTargetWrapper(l),S=y.createTextureGraphicsResourceFromExternalWebGLTexture(l,b,s.externalTexture,!s||!s.disableFiltering,!(null==s||!s.isMipMapped)),s.externalFrameBuffer&&(T._framebuffer=s.externalFrameBuffer);else{if(!(T=y.createTextureGraphicsRenderTargetResource(l,void 0,b,!(null==s||!s.useFloat),!(null==s||!s.needsRenderBuffer),f,!s||!s.disableFiltering,!(null==s||!s.isMipMapped))).texture)return g.Log.Error(507011861,"Failed to create render target wrapper"),(0,n.default)(i);S=T.texture}return i=C(this,t,[e,r,S,l,b,f,o,!(null==s||!s.isMipMapped),!0]),T?i.m_renderTargetWrapper=T:g.Log.Error(507011860,"Failed to create render target wrapper"),i.m_textureManager&&i.m_textureManager.register(i),o!=P.ExternallyManaged&&(m.getCurrentFramePerformanceSummary().dynamicTextureAlloc+=i.memoryUsage),i}return(0,s.default)(t,e),(0,u.default)(t,[{key:"release",value:function(){var e;null===(e=this.m_renderTargetWrapper)||void 0===e||e.dispose(),(0,a.default)((0,o.default)(t.prototype),"release",this).call(this)}},{key:"tryGetBabylonTextureForRenderToTexture",value:function(e){var t=Y(e);return this.m_lastRenderTime=performance.now(),this.isValidForGraphicsProcessor(t)?this.m_renderTargetWrapper:void 0}},{key:"tryUseBabylonTargetTexture",value:function(e,t,r){var i=Y(e),n=this.m_usageRecord.find((function(e){return e.clientObject==t}));return n?(n.lastScenario=r,n.lastUsage=performance.now(),n.usageCount++):this.m_usageRecord.push({clientObject:t,lastScenario:r,lastUsage:performance.now(),usageCount:1}),this.isValidForGraphicsProcessor(i)?this.m_renderTargetWrapper:void 0}},{key:"tryConvertToBufferRGBA",value:function(){if(this.m_graphicsProcessor&&this.m_renderTargetWrapper)return this.m_graphicsProcessor.copyTexturePixelsToArray(this.m_renderTargetWrapper,p.Rect.FromSize(this.size),!0)}},{key:"tryConvertToCanvas",value:function(){if(this.m_graphicsProcessor&&this.m_babylonTexture){var e=document.createElement("canvas");e.width=this.m_babylonTexture.width,e.height=this.m_babylonTexture.height;var t=e.getContext("2d");if(t){var r=this.tryConvertToBufferRGBA();if(r){var i=this.size,n=t.createImageData(i.x,i.y);return n.data.set(r),t.putImageData(n,0,0),t.globalCompositeOperation="copy",t.setTransform(1,0,0,-1,0,i.y),t.drawImage(e,0,0),e}}}}},{key:"tryConvertToDataURL",value:function(){var e=this.tryConvertToCanvas();if(e)return e.toDataURL()}},{key:"getMemUsageData",value:function(){var e,r=(0,a.default)((0,o.default)(t.prototype),"getMemUsageData",this).call(this);return{channels:r.channels,dataSize:r.dataSize,stencilDataSize:null!==(e=this.m_renderTargetWrapper)&&void 0!==e&&e._generateStencilBuffer?1:0}}}],[{key:"RecycleOrReplace",value:function(e,r,i,n,a,o){var s,l,c=null!==(s=null==o?void 0:o.format)&&void 0!==s?s:v.TextureFormat.RGBA,u=!(null==o||!o.useFloat),d=!(null==o||!o.disableFiltering),f=null!==(l=null==o?void 0:o.wrapMode)&&void 0!==l?l:h.WrapMode.clamp;V(c);var m=i.getGraphicsProcessor();if(r){var p,y,_=0!=(null===(p=r.m_babylonTexture)||void 0===p?void 0:p.type),S=1==(null===(y=r.m_babylonTexture)||void 0===y?void 0:y.samplingMode);if(m&&r.isValidForGraphicsProcessor(m)&&r.size.equals(n)&&r.m_babylonTexture&&r.m_babylonTexture.format==c&&r.wrapMode==f&&r.isMipMapped==!(null==o||!o.isMipMapped)&&_==u&&S==d)return r.releasePolicy!=a&&g.Log.Error(572867288,"RecycleOrReplace with different releasePolicy"),r;r.release()}return new t(e,i,n,a,o)}}])}(L);t.TargetTexture=A;var M,R=[{attributeName:"a_0",attributeSize:4,offset:0}],O=[{attributeName:"a_1",attributeSize:4,offset:0}];function D(e,t,r){0==e.length&&g.Log.Error(509634196,"Cannot create vertex buffer array from empty rectangle array.");for(var i=new Float32Array(4*r),n=0;n<r;n++){var a=e[Math.min(n,e.length-1)];i[4*n+0]=a.left/t.x,i[4*n+1]=a.top/t.y,i[4*n+2]=a.right/t.x,i[4*n+3]=a.bottom/t.y}return i}function F(e,t,r,i,n,a,o,s,l,c,u,d,f){var m=e.getGraphicsProcessor();if(m&&m.isValid())if(r.isValidForGraphicsProcessor(m)){var p=Math.max(o.length,s.length);if(0!=p){var v=D(o,r.size,p),y=D(s,l,p),_=b.ProgramId.sharpnessFilter,S=m.activateShaderProgram(_);S.begin(i.tryGetBabylonTextureForRenderToTexture(m),h.Color.Transparent,!0);var T=m.getBabylonEngine(),C=T.createVertexBuffer(v),w=T.createVertexBuffer(y);T.bindInstancesBuffer(C,R,!1),T.bindInstancesBuffer(w,O,!1),S.setTexture("t_0",r.tryUseBabylonTexture(m,void 0,"sharpnessFilterPass")),S.setTexture("t_1",t.tryUseBabylonTexture(m,void 0,"sharpnessFilterPass")),d&&void 0!==u?(S.getBabylonEffect().setInt("ufrag_5",u+1),S.setTexture("t_2",d.tryUseBabylonTexture(m,void 0,"drawTextureRects/maskTexture")),S.getBabylonEffect().setFloat4("ufrag_6",0!=f&&f?0:1,1==f?1:0,2==f?1:0,3==f?1:0)):(S.getBabylonEffect().setInt("ufrag_5",0),S.setTexture("t_2",void 0));var P=c.sharpness,I=P<0?10.5*-P:1.25*P,k=P<0?1+.8*-P:1,E=1==n&&P>0;S.getBabylonEffect().setFloat("ufrag_0",I),S.getBabylonEffect().setFloat("ufrag_1",k),S.getBabylonEffect().setFloat("ufrag_2",a),S.getBabylonEffect().setInt("ufrag_3",n),S.getBabylonEffect().setBool("ufrag_4",E),S.getBabylonEffect().setFloat("ufrag_7",c.depthFocus),S.getBabylonEffect().setBool("ufrag_8",c.enableForegroundBlur),S.drawQuadInstances(p),S.disableInstanceAttribute("a_0"),S.disableInstanceAttribute("a_1"),T._releaseBuffer(C),T._releaseBuffer(w),S.end()}}else g.Log.Error(509634335,"Invalid Texture for Sharpness Filter");else g.Log.Error(509634336,"Invalid Graphics Processor for Sharpness Filter")}function B(e,t){var r,i,n=null==t?void 0:t.brightnessContrast;n?(S.s_useLegacyBrightness?(r=1,i=n.brightness):n.brightness>=1?(r=0,i=1):(r=n.brightness>0?1/(1-n.brightness):Math.max(0,1+n.brightness),i=0),e.getBabylonEffect().setInt("ufrag_3",1),e.getBabylonEffect().setArray2("ufrag_4",[r,i]),e.getBabylonEffect().setArray4("ufrag_5",function(e){if(S.s_useLegacyContrast)return[0,0,e,(1-e)/2];var t=Math.min(Math.abs(e/4),1/4-1/65025),r=64*t*t*t-48*t*t-4*t+3,i=-64*t/r,n=96*t/r,a=(r-32*t)/r;if(e>=0)return[i,n,a,0];var o=Math.max(0,(-n+Math.sqrt(n*n-4*i*a))/(2*i));return[(64*t-32*o)/3,-32*t+16*o,(32*t-22*o+3)/3,o]}(n.contrast))):e.getBabylonEffect().setInt("ufrag_3",0);var a=null==t?void 0:t.hueSaturationLuminance;a?(e.getBabylonEffect().setInt("ufrag_6",1),e.getBabylonEffect().setFloat("ufrag_7",a.hueRotation),e.getBabylonEffect().setFloat("ufrag_8",a.saturationFactor),e.getBabylonEffect().setFloat("ufrag_9",a.luminanceFactor)):e.getBabylonEffect().setInt("ufrag_6",0);var o=null==t?void 0:t.recolor;if(o){var s=void 0===o.threshold?1:255,l=void 0===o.threshold?0:.5-s*o.threshold;e.getBabylonEffect().setInt("ufrag_10",1),e.getBabylonEffect().setFloat("ufrag_11",s),e.getBabylonEffect().setFloat("ufrag_12",l),e.getBabylonEffect().setVector3("ufrag_13",{x:o.darkColor.r,y:o.darkColor.g,z:o.darkColor.b}),e.getBabylonEffect().setVector3("ufrag_14",{x:o.brightColor.r,y:o.brightColor.g,z:o.brightColor.b})}else e.getBabylonEffect().setInt("ufrag_10",0);var c=null==t?void 0:t.colorTemperature;c?(e.getBabylonEffect().setInt("ufrag_15",1),e.getBabylonEffect().setFloat("ufrag_16",c.redGain),e.getBabylonEffect().setFloat("ufrag_17",c.blueGain),e.getBabylonEffect().setFloat("ufrag_18",c.greenGain)):e.getBabylonEffect().setInt("ufrag_15",0);var u=null==t?void 0:t.highlightsShadows;u?(e.getBabylonEffect().setInt("ufrag_25",1),e.getBabylonEffect().setDirectColor4("ufrag_26",u.neutral),e.getBabylonEffect().setDirectColor4("ufrag_27",u.positive),e.getBabylonEffect().setDirectColor4("ufrag_28",u.negative)):e.getBabylonEffect().setInt("ufrag_25",0)}function N(e){return new p.Vector2((0,p.clamp)((0,p.getNearestPowerOfTwo)(e.x),1,2048),(0,p.clamp)((0,p.getNearestPowerOfTwo)(e.y),1,2048))}function V(e){switch(e){case v.TextureFormat.RGB:case v.TextureFormat.RGBA:case v.TextureFormat.LUMINANCE:case v.TextureFormat.LUMINANCE_ALPHA:break;default:throw g.Log.Error(507910017,"Unsupported texture format")}}t.DrawTextureMode=M,function(e){e[e.noFilter=0]="noFilter",e[e.pictureEffects=1]="pictureEffects",e[e.swapRedAndBlue=2]="swapRedAndBlue",e[e.nv12=3]="nv12",e[e.drawMask=4]="drawMask"}(M||(t.DrawTextureMode=M={}));var U=(0,u.default)((function e(t){(0,c.default)(this,e),this.renderScale=t}),[{key:"shouldReloadTexture",value:function(e,t,r){return!1}},{key:"determineInitialTextureSize",value:function(e,t){return z(G(e,t.multiply(this.renderScale))).floor()}},{key:"determineReloadedTextureSize",value:function(e,t){return this.determineInitialTextureSize(e,t)}}]);t.NeverReloadPolicy=U;var W=(0,u.default)((function e(t,r){(0,c.default)(this,e),this.m_stepFactor=t,this.renderScale=r}),[{key:"shouldReloadTexture",value:function(e,t,r){var i=z(G(t,r.multiply(this.renderScale))).floor();return i.x>e.x||i.y>e.y}},{key:"determineInitialTextureSize",value:function(e,t){return z(G(e,t.multiply(this.renderScale).scale(this.m_stepFactor))).floor()}},{key:"determineReloadedTextureSize",value:function(e,t){return z(G(e,t.multiply(this.renderScale).scale(this.m_stepFactor))).floor()}}]);function G(e,t){var r=t.x/e.x,i=t.y/e.y,n=Math.max(r,i);return e.scale(n)}t.ReloadOnStepSizeIncreasePolicy=W;var H=(0,u.default)((function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0;(0,c.default)(this,e),this.m_changeTracker=new f.ChangeTracker,this.m_textureLoaded=!1;var u=this;this.m_renderer=t,this.m_loadPolicy=i,this.m_imageElement=new window.Image,this.m_imageElement.crossOrigin=n,this.m_imageElement.onload=function(){try{u.release(),u.m_imageNaturalSize=null!=o?o:new p.Vector2(u.m_imageElement.naturalWidth,u.m_imageElement.naturalHeight);var e=u.m_loadPolicy.determineInitialTextureSize(u.m_imageNaturalSize,a);u.m_imageElement.width=e.x,u.m_imageElement.height=e.y,u.m_texture=L.CreateFromHTMLElement("ImageTextureLoader/InitialTexture",t,u.m_imageElement,void 0,void 0,u.shouldMipMap()),u.m_texture.originalSize=u.m_imageNaturalSize,u.m_changeTracker.replaceListener(void 0,u.m_texture),u.m_textureLoaded=!0,s&&s(u)}catch(e){g.Log.Error(539600867,"exception loading image: "+e),l&&l()}},this.m_imageElement.onerror=function(){g.Log.Error(539600896,"error loading image"),l&&l()},this.m_imageElement.src=r}),[{key:"getTexture",value:function(e){if(this.m_texture){if(this.m_texture.wrapMode==e)return this.m_texture;this.m_wrapTextures||(this.m_wrapTextures=new Map);var t=this.m_wrapTextures.get(e);if(!t){var r=new p.Vector2(this.m_imageElement.width,this.m_imageElement.height);if(e!==h.WrapMode.clamp){var i=N(r);this.m_imageElement.width=i.x,this.m_imageElement.height=i.y}t=L.CreateFromHTMLElement("ImageTextureLoader/Wrap",this.m_renderer,this.m_imageElement,e),e!==h.WrapMode.clamp&&(this.m_imageElement.width=r.x,this.m_imageElement.height=r.y),t.originalSize=this.m_texture.originalSize,t&&this.m_wrapTextures.set(e,t)}return t}}},{key:"lastUsage",get:function(){var e=this.m_texture?this.m_texture.lastUsage:0;return this.m_wrapTextures&&this.m_wrapTextures.forEach((function(t){return e=Math.max(e,t.lastUsage)})),e}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"loadPolicy",get:function(){return this.m_loadPolicy}},{key:"releasePolicy",get:function(){var e;return null===(e=this.m_texture)||void 0===e?void 0:e.releasePolicy}},{key:"textureLoaded",get:function(){return this.m_textureLoaded}},{key:"isValidForGraphicsProcessor",value:function(e){return!!this.m_texture&&this.m_texture.isValidForGraphicsProcessor(e)}},{key:"prepareForRenderSize",value:function(e){if(e=z(e),this.shouldResizeTexture(e)&&this.m_imageNaturalSize){var t=this.m_loadPolicy.determineReloadedTextureSize(this.m_imageNaturalSize,e);this.m_imageElement.width=t.x,this.m_imageElement.height=t.y;var r=this.m_texture;this.m_texture=L.CreateOrUpdateFromHTMLElement("ImageTextureLoader/ResizedTexture",this.m_texture,this.m_renderer,this.m_imageElement,void 0,void 0,this.shouldMipMap()),this.m_texture.originalSize=this.m_imageNaturalSize,this.m_changeTracker.replaceListener(r,this.m_texture)}}},{key:"release",value:function(){this.m_texture&&this.m_texture.release(),this.m_wrapTextures&&(this.m_wrapTextures.forEach((function(e){return e.release()})),this.m_wrapTextures=void 0)}},{key:"shouldResizeTexture",value:function(e){var t;if(!(this.m_imageElement&&this.m_imageElement.complete&&this.m_textureLoaded&&this.m_renderer.isValid()&&this.m_imageNaturalSize))return!1;if(e.x<=0||e.y<=0)return g.Log.Error(539575455,"invalid texture size"),!1;if(null===(t=this.m_texture)||void 0===t||!t.isValid(this.m_renderer))return!0;var r=new p.Vector2(this.m_imageElement.width,this.m_imageElement.height);return this.m_loadPolicy.shouldReloadTexture(r,this.m_imageNaturalSize,e)}},{key:"shouldMipMap",value:function(){var e;return 2==(null===(e=this.m_renderer.getBabylonEngine())||void 0===e?void 0:e.webGLVersion)}}]);t.ImageTextureLoader=H;var j=(0,u.default)((function e(t){(0,c.default)(this,e),this.colorsRGB=t}),[{key:"ensureTexture",value:function(e){var t,r=e.getGraphicsProcessor();if(r)return null!==(t=this.m_texture)&&void 0!==t&&t.isValidForGraphicsProcessor(r)||(this.m_texture&&this.m_texture.release(),this.m_texture=L.CreateFromByteBuffer("Palette256",e,new p.Vector2(256,1),this.colorsRGB,v.TextureFormat.RGB,h.WrapMode.clamp,!1,!1,P.KeepUntilRelease,!1,1)),this.m_texture}},{key:"release",value:function(){var e;null===(e=this.m_texture)||void 0===e||e.release()}}]);function z(e){if(e.x>m.maxTextureResolution||e.y>m.maxTextureResolution){var t=Math.max(e.x,e.y),r=m.maxTextureResolution/t;return new p.Vector2(r*e.x,r*e.y)}return e}function q(e){return 0==(e&e-1)}function Z(e,t){var r=document.createElement("canvas");r.width=t.x,r.height=t.y;var i=r.getContext("2d");if(!i)throw g.Log.Message(507012246,"context2D not supported");return i.drawImage(e,0,0,t.x,t.y),r}function X(e,t){return e.x<=t&&e.y<=t?new p.Vector2(Math.max(1,e.x),Math.max(1,e.y)):e.x>e.y?new p.Vector2(t,Math.max(1,e.y*t/e.x)):new p.Vector2(Math.max(1,e.x*t/e.y),t)}function Y(e){if(e instanceof y.GraphicsProcessor)return e;var t=e;if(t.getGraphicsProcessor){var r=t.getGraphicsProcessor();if(r)return r}throw g.Log.Error(506869774,"Unable to get GraphicsProcessor")}t.Palette256=j},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.rangeDataSetIfNotEqual=function(e,t,r){if(r){var i=e.dataPerRange.find((function(e){return e.range.equals(r)}));if(null!=i&&i.data.equals(t))return}else if(0==e.dataPerRange.length&&e.defaultData.equals(t))return;e.set(t,r)},t.arrayPushIfNotThere=W,t.runStartToRangeList=G,t.TextLayout=t.TextRenderMode=t.TextSplit=t.TextSelectionHighlight=t.TextParagraph=t.TextLine=t.TextEffectMetrics=t.TextBullet=t.TextCharacter=t.TextImage=t.WarpingEnvelope=t.PathingLine=t.TextRunAnimationProps=t.TextStroke=t.TrackableRangeDataPartition=t.RangeDataPartition=t.TextStrokeType=t.TextRange=void 0;var n=i(r(18)),a=i(r(9)),o=i(r(8)),s=i(r(10)),l=i(r(1)),c=i(r(2)),u=r(12),d=r(13),h=r(70),f=r(16),m=r(27),p=r(37),g=r(59);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var _,S=function(){function e(t,r){(0,l.default)(this,e),this.start=t,this.length=r}return(0,c.default)(e,[{key:"last",get:function(){return this.start+this.length-1}},{key:"equals",value:function(e){return this.start==e.start&&this.length==e.length}},{key:"includes",value:function(e){return e>=this.start&&e<=this.last}},{key:"intersects",value:function(e){return this.start<=e.last&&this.last>=e.start}},{key:"contains",value:function(e){return this.start<=e.start&&e.last<=this.last}},{key:"getIntersection",value:function(t){var r=e.FromFirstLast(Math.max(this.start,t.start),Math.min(this.last,t.last));return r.length>=0?r:void 0}},{key:"move",value:function(t){return new e(this.start+t,this.length)}}],[{key:"FromFirstLast",value:function(t,r){return new e(t,r+1-t)}}])}();t.TextRange=S,t.TextStrokeType=_,function(e){e[e.highlighter=0]="highlighter",e[e.single=1]="single",e[e.double=2]="double",e[e.heavy=3]="heavy",e[e.dotted=4]="dotted",e[e.dottedHeavy=5]="dottedHeavy",e[e.dash=6]="dash",e[e.dashHeavy=7]="dashHeavy",e[e.dashLong=8]="dashLong",e[e.dashLongHeavy=9]="dashLongHeavy",e[e.dotDash=10]="dotDash",e[e.dotDashHeavy=11]="dotDashHeavy",e[e.dotDotDash=12]="dotDotDash",e[e.dotDotDashHeavy=13]="dotDotDashHeavy",e[e.wavy=14]="wavy",e[e.wavyHeavy=15]="wavyHeavy",e[e.wavyDouble=16]="wavyDouble"}(_||(t.TextStrokeType=_={}));var T=(0,c.default)((function e(t){(0,l.default)(this,e),this.m_defaultData=t}),[{key:"onDataChange",value:function(){}},{key:"onRangeChange",value:function(){}},{key:"onDataRemoved",value:function(e){}},{key:"onDataAdded",value:function(e){}},{key:"defaultData",get:function(){return this.m_defaultData},set:function(e){this.m_defaultData=e}},{key:"ranges",get:function(){var e,t=[],r=v(this.m_dataPerRange||[]);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push(i.range)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"allData",get:function(){var e,t=[this.m_defaultData],r=v(this.m_dataPerRange||[]);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push(i.data)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"dataPerRange",get:function(){return this.m_dataPerRange||[]}},{key:"set",value:function(e,t){if(this.onDataChange(),t){var r,i=v(this.m_dataPerRange||[]);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.range.start==t.start&&n.range.last==t.last)return this.onDataRemoved(n.data),n.data=e,void this.onDataAdded(n.data)}}catch(e){i.e(e)}finally{i.f()}var a,o=v(this.m_dataPerRange||[]);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.onDataRemoved(s.data)}}catch(e){o.e(e)}finally{o.f()}this.onRangeChange();var l,c=[],u=!1,d=v(this.m_dataPerRange||[]);try{for(d.s();!(l=d.n()).done;){var h=l.value;h.range.start<t.start&&c.push({range:S.FromFirstLast(h.range.start,Math.min(h.range.last,t.start-1)),data:h.data}),t.last<h.range.last&&(u||(c.push({range:t,data:e}),u=!0),c.push({range:S.FromFirstLast(Math.max(h.range.start,t.last+1),h.range.last),data:h.data}))}}catch(e){d.e(e)}finally{d.f()}u||c.push({range:t,data:e}),this.m_dataPerRange=c;var f,m=v(this.m_dataPerRange||[]);try{for(m.s();!(f=m.n()).done;){var p=f.value;this.onDataAdded(p.data)}}catch(e){m.e(e)}finally{m.f()}}else{var g,y=v(this.m_dataPerRange||[]);try{for(y.s();!(g=y.n()).done;){var _=g.value;this.onDataRemoved(_.data)}}catch(e){y.e(e)}finally{y.f()}this.m_defaultData=e,this.m_dataPerRange=void 0}}},{key:"getAt",value:function(e){var t,r=v(this.m_dataPerRange||[]);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.range.start<=e&&e<=i.range.last)return i.data}}catch(e){r.e(e)}finally{r.f()}return this.m_defaultData}},{key:"shiftIndices",value:function(e,t){if(this.m_dataPerRange){var r,i=[],n=t-e.length,a=v(this.m_dataPerRange);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(e.contains(o.range)&&e.start!=o.range.start)this.onDataRemoved(o.data);else if(o.range.includes(e.start)){var s=Math.min(e.length,o.range.last+1-e.start);i.push({range:new S(o.range.start,o.range.length+t-s),data:o.data})}else o.range.start<=e.last&&e.last<=o.range.last?i.push({range:S.FromFirstLast(e.start+t,o.range.last+n),data:o.data}):e.last<o.range.start?i.push({range:o.range.move(n),data:o.data}):i.push(o)}}catch(e){a.e(e)}finally{a.f()}this.m_dataPerRange=i}}}]);t.RangeDataPartition=T;var b=function(e){function t(e){var r;return(0,l.default)(this,t),(r=function(e,t,r){return t=(0,o.default)(t),(0,a.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,o.default)(e).constructor):t.apply(e,r))}(this,t,[e])).m_changeTracker=new p.ChangeTracker,r.m_rangeChangeTracker=new p.ChangeTracker,r.m_changeTracker.replaceListener(void 0,e),r}return(0,s.default)(t,e),(0,c.default)(t,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"rangeChangeTracker",get:function(){return this.m_rangeChangeTracker}},{key:"onDataChange",value:function(){this.m_changeTracker.notifyChange()}},{key:"onRangeChange",value:function(){this.rangeChangeTracker.notifyChange()}},{key:"onDataRemoved",value:function(e){p.ChangeTracker.RemoveListener(e.changeTracker,this.m_changeTracker)}},{key:"onDataAdded",value:function(e){p.ChangeTracker.AddListener(e.changeTracker,this.m_changeTracker)}}])}(T);t.TrackableRangeDataPartition=b;var C=function(){function e(t,r,i,n){(0,l.default)(this,e),this.m_changeTracker=new p.ChangeTracker,this.m_type=t,this.m_verticalCenter=r,this.m_thickness=i,this.style=n}return(0,c.default)(e,[{key:"clone",value:function(){return new e(this.m_type,this.m_verticalCenter,this.m_thickness,this.m_style?this.m_style.clone():void 0)}},{key:"type",get:function(){return this.m_type},set:function(e){(0,g.notifyIfDifferent)(this.changeTracker,this.m_type,e),this.m_type=e}},{key:"verticalCenter",get:function(){return this.m_verticalCenter},set:function(e){(0,g.notifyIfDifferent)(this.changeTracker,this.m_verticalCenter,e),this.m_verticalCenter=e}},{key:"thickness",get:function(){return this.m_thickness},set:function(e){(0,g.notifyIfDifferent)(this.changeTracker,this.m_thickness,e),this.m_thickness=e}},{key:"style",get:function(){return this.m_style},set:function(e){this.changeTracker.replaceListener(this.m_style,e),this.m_style=e}},{key:"changeTracker",get:function(){return this.m_changeTracker}}])}();t.TextStroke=C;var w=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,l.default)(this,e),this.m_changeTracker=new p.ChangeTracker,this.m_animationTransform=r,this.m_isHidden=i,this.fade=t}return(0,c.default)(e,[{key:"clone",value:function(){return new e(this.m_fade?this.m_fade.clone():void 0,this.m_animationTransform)}},{key:"equals",value:function(e){return(this.m_fade==e.m_fade||null!=this.m_fade&&null!=e.m_fade&&this.m_fade.equals(e.m_fade))&&(this.m_animationTransform==e.m_animationTransform||null!=this.m_animationTransform&&null!=e.m_animationTransform&&this.m_animationTransform.equals(e.m_animationTransform))&&this.m_isHidden==e.m_isHidden}},{key:"fade",get:function(){return this.m_fade},set:function(e){this.m_changeTracker.replaceListener(this.m_fade,e),this.m_fade=e}},{key:"animationTransform",get:function(){return this.m_animationTransform},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_animationTransform,e),this.m_animationTransform=e}},{key:"isHidden",get:function(){return!!this.m_isHidden},set:function(e){e!=this.isHidden&&(this.m_changeTracker.notifyChange(),this.m_isHidden=e)}},{key:"changeTracker",get:function(){return this.m_changeTracker}}])}();t.TextRunAnimationProps=w;var P=new u.Matrix3(0,-1,0,1,0,0,0,0,1),I=(0,c.default)((function e(t,r,i,n,a,o){(0,l.default)(this,e),this.lineRect=t,this.path=r,this.alignment=i,this.scale=n,this.pivot=a,this.isVerticalLayout=o,this.pathLength=r.measureLength(),this.equivalentWarpingEnvelope=this.calculateEquivalentWarpingEnvelope()}),[{key:"equals",value:function(e){return this.lineRect.equals(e.lineRect)&&this.path==e.path&&this.alignment==e.alignment&&this.scale==e.scale&&this.pivot==e.pivot&&this.isVerticalLayout==e.isVerticalLayout}},{key:"getPathPosition",value:function(e){var t=this.isVerticalLayout?e.transformedBounds(P):e,r=this.isVerticalLayout?this.lineRect.transformedBounds(P):this.lineRect;if(t&&r){var i=r.width,n=0;if(i*this.scale<this.pathLength){var a=this.pathLength-i*this.scale;n=this.alignment*(a/this.pathLength)}var o=(t.left-r.left)*this.scale/this.pathLength+n;return(o+(o+t.width/this.pathLength*this.scale))/2}}},{key:"getTransform",value:function(e){var t=this.getPathPosition(e),r=this.isVerticalLayout?e.transformedBounds(P):e;if(t&&r){var i=(0,u.clamp)(t,0,1)*this.pathLength,n=this.path.getPointFromDist(i),a=this.path.getTangentFromDist(i);if(a){var o=(r.left+r.right)/2,s=r.top+r.height*this.pivot,l=u.Matrix3.Translation2D(new u.Vector2(-o,-s));l=l.multiply(u.Matrix3.Scale2D(new u.Vector2(this.scale,this.scale)));var c=a.x,d=a.y;return l=(l=l.multiply(new u.Matrix3(c,d,0,-d,c,0,0,0,1))).multiply(u.Matrix3.Translation2D(n)),this.isVerticalLayout&&(l=P.multiply(l)),l}}}},{key:"calculateEquivalentWarpingEnvelope",value:function(){for(var e=new m.FigureBuilder,t=new m.FigureBuilder,r=this.isVerticalLayout?0:this.lineRect.height/2,i=this.isVerticalLayout?this.lineRect.top:this.lineRect.left,n=this.isVerticalLayout?this.lineRect.bottom:this.lineRect.right,a=this.lineRect,o=0;o<=1;o+=1/256){var s=i+(n-i)*o,l=this.isVerticalLayout?new u.Rect(this.lineRect.right,s-r,this.lineRect.left,s+r):new u.Rect(s-r,this.lineRect.top,s+r,this.lineRect.bottom),c=this.getPathPosition(l);if(null!=c&&c>=0&&c<=1){var d=s+(2*o-1)*r,h=this.getTransform(l);if(h){var f=h.transformPoint(this.isVerticalLayout?new u.Vector2(l.left,d):new u.Vector2(d,l.top)),p=h.transformPoint(this.isVerticalLayout?new u.Vector2(l.right,d):new u.Vector2(d,l.bottom));0==e.getPointCount()?(e.moveToPoint(f),t.moveToPoint(p),a=new u.Rect(this.isVerticalLayout?a.left:d,this.isVerticalLayout?d:a.top,a.right,a.bottom)):(e.lineToPoint(f),t.lineToPoint(p),a=new u.Rect(a.left,a.top,this.isVerticalLayout?a.right:d,this.isVerticalLayout?d:a.bottom))}}}return new E(a,e.createFigure(),t.createFigure(),this.isVerticalLayout)}}]);t.PathingLine=I;var k=(0,c.default)((function e(t){(0,l.default)(this,e),this.currentX=0,this.currentY=0,this.m_samplesX=new Float32Array(257),this.m_samplesY=new Float32Array(257);for(var r=t.measureLength(),i=0;i<=256;i++){var n=t.getPointFromDist(r*i/256);this.m_samplesX[i]=n.x,this.m_samplesY[i]=n.y}}),[{key:"moveTo",value:function(e){var t=Math.floor(256*e),r=Math.min(t+1,256),i=256*e-t;this.currentX=this.m_samplesX[t]*(1-i)+this.m_samplesX[r]*i,this.currentY=this.m_samplesY[t]*(1-i)+this.m_samplesY[r]*i}},{key:"equals",value:function(e){for(var t=0;t<=256;t++)if(this.m_samplesX[t]!=e.m_samplesX[t]||this.m_samplesY[t]!=e.m_samplesY[t])return!1;return!0}}]),E=(0,c.default)((function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,l.default)(this,e),this.sourceRect=t,this.topPath=r,this.bottomPath=i,this.isVerticalLayout=n,this.topCurve=new k(r),this.bottomCurve=new k(i)}),[{key:"equals",value:function(e){return this.sourceRect.equals(e.sourceRect)&&this.topCurve.equals(e.topCurve)&&this.bottomCurve.equals(e.bottomCurve)&&this.isVerticalLayout==e.isVerticalLayout}},{key:"warpPoint",value:function(e){var t=(0,u.clamp)(this.isVerticalLayout?(e.y-this.sourceRect.top)/this.sourceRect.height:(e.x-this.sourceRect.left)/this.sourceRect.width,0,1),r=(0,u.clamp)(this.isVerticalLayout?1-(e.x-this.sourceRect.left)/this.sourceRect.width:(e.y-this.sourceRect.top)/this.sourceRect.height,0,1);return this.topCurve.moveTo(t),this.bottomCurve.moveTo(t),new u.Vector2((0,u.mix)(this.topCurve.currentX,this.bottomCurve.currentX,r),(0,u.mix)(this.topCurve.currentY,this.bottomCurve.currentY,r))}},{key:"warpPath",value:function(e){var t,r=this,i=[],n=Math.max(this.sourceRect.width)/4,a=u.Matrix3.FromTransforms(e.transform),o=v(e.figures);try{var s=function(){var e=t.value;if(e.getPointCount()>0){var o=new m.FigureBuilder;o.moveToPoint(r.warpPoint(e.getPoint(0).transformPoint(a))),e.forEachSegment((function(e,t,i){for(var s=t||u.Vector2.InterpolateLinear(e,i,.5),l=n>0?Math.max(1,Math.ceil(Math.abs(i.x-e.x)/n)):1,c=0;c<l;c++){var d=r.warpPoint(u.Vector2.InterpolateQuadratic(e,s,i,c/l).transformPoint(a)),h=r.warpPoint(u.Vector2.InterpolateQuadratic(e,s,i,(c+.5)/l).transformPoint(a)),f=r.warpPoint(u.Vector2.InterpolateQuadratic(e,s,i,(c+1)/l).transformPoint(a)),m=h.add(h.subtract(u.Vector2.InterpolateLinear(d,f,.5)));o.quadBezierToPoint(m,f)}return!0})),e.isClosed&&o.close(),i.push(o.createFigure())}};for(o.s();!(t=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}return new m.Path({figures:i,fillMode:e.fillMode,lineEnabled:e.lineEnabled,extrusionEnabled:e.extrusionEnabled,transform:void 0})}},{key:"unwarpPoint",value:function(e,t){for(var r,i=0,n=1,a=0;a<16;a++){var o=(i+n)/2,s=this.getClosestWarpSample(i,e),l=this.getClosestWarpSample(n,e);s.p.subtract(e).lengthSquared()<l.p.subtract(e).lengthSquared()?(r=s,n=o):(r=l,i=o)}if(!(r&&t&&(r.u<=0||r.u>=1||r.v<=0||r.v>=1)))return r?this.sourceRect.relativeToAbsolute(new u.Vector2(r.u,r.v)):void 0}},{key:"getClosestWarpSample",value:function(e,t){this.topCurve.moveTo(e),this.bottomCurve.moveTo(e);var r=new u.Vector2(this.topCurve.currentX,this.topCurve.currentY),i=new u.Vector2(this.bottomCurve.currentX,this.bottomCurve.currentY),n=i.subtract(r),a=t.subtract(r).dot(n)/n.lengthSquared();return{u:e,v:a,p:u.Vector2.InterpolateLinear(r,i,Math.max(0,Math.min(1,a)))}}}]);t.WarpingEnvelope=E;var x=(0,c.default)((function e(t,r,i,n){(0,l.default)(this,e),this.image=t,this.rect=r,this.transform=i,this.useLocalCordinates=!!n}),[{key:"equals",value:function(e){return this.image==e.image&&this.rect==e.rect}}]);t.TextImage=x;var L=function(){function e(t,r,i,n,a,o,s){(0,l.default)(this,e),this.layoutBounds=t,this.paths=r instanceof Array?r.slice(0):r,this.outlinePath=o instanceof Array?o.slice(0):o,this.forceWarping=i,this.isWhiteSpace=n,this.textImage=a,this.isRTL=s}return(0,c.default)(e,[{key:"equals",value:function(e){return!(!this.layoutBounds.equals(e.layoutBounds)||this.forceWarping!=e.forceWarping||this.isWhiteSpace!=e.isWhiteSpace||this.isRTL!=e.isRTL||this.textImage!=e.textImage||!A(this.paths,e.paths)||!A(this.outlinePath,e.outlinePath)||this.paths||e.paths)}},{key:"getTranslatedCopy",value:function(t){var r=M(this.paths,t),i=M(this.outlinePath,t);return new e(this.layoutBounds.translate(t),r,this.forceWarping,this.isWhiteSpace,this.textImage,i,this.isRTL)}}])}();function A(e,t){if(!e&&!t)return!0;if(e instanceof m.Path&&t instanceof m.Path)return e.equals(t);if(e instanceof Array&&t instanceof Array){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(t[r]))return!1;return!0}return!e&&!t}function M(e,t){var r=void 0;if(e instanceof m.Path)r=new m.Path(e,e.transform.applyTranslationAfter(t));else if(e){r=new Array(e.length);for(var i=0;i<e.length;i++)r[i]=new m.Path(e[i],e[i].transform.applyTranslationAfter(t))}return r}t.TextCharacter=L;var R=function(){function e(t,r,i,n){(0,l.default)(this,e),this.m_changeTracker=new p.ChangeTracker,this.m_character=t,this.style=r,this.effects=i,this.strokes=n}return(0,c.default)(e,[{key:"clone",value:function(){var t=new e(this.m_character,this.m_style?this.m_style.clone():void 0,this.m_effects?this.m_effects.clone():void 0);if(this.m_strokes){t.m_strokes=new p.TrackableArray;var r,i=v(this.m_strokes.elements);try{for(i.s();!(r=i.n()).done;){var n=r.value;t.m_strokes.push(n.clone())}}catch(e){i.e(e)}finally{i.f()}}return t}},{key:"character",get:function(){return this.m_character},set:function(e){this.m_character.equals(e)||(this.m_changeTracker.notifyChange(),this.m_character=e)}},{key:"style",get:function(){return this.m_style},set:function(e){this.m_changeTracker.replaceListener(this.m_style,e),this.m_style=e}},{key:"effects",get:function(){return this.m_effects},set:function(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects=e}},{key:"strokes",get:function(){return this.m_strokes},set:function(e){this.m_changeTracker.replaceListener(this.m_strokes,e),this.m_strokes=e}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"equals",value:function(e){return!!this.m_character.equals(e.m_character)&&this.m_style==e.m_style&&this.m_effects==e.effects&&this.m_strokes==e.m_strokes}}])}();t.TextBullet=R;var O=(0,c.default)((function e(t,r,i){(0,l.default)(this,e),this.ascent=t,this.descent=r,this.fontHeightInPoints=i}),[{key:"equals",value:function(e){return this.ascent==e.ascent&&this.descent==e.descent&&this.fontHeightInPoints==e.fontHeightInPoints}}]);t.TextEffectMetrics=O;var D=function(){function e(t,r){(0,l.default)(this,e),this.m_changeTracker=new p.ChangeTracker,this.m_characters=[],this.m_localRange=t,this.m_layoutBounds=r,this.m_fillBounds=r,this.m_offset=u.Vector2.Zero}return(0,c.default)(e,[{key:"clone",value:function(){var t,r=new e(this.m_localRange,this.m_layoutBounds),i=v(this.m_characters);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.addCharacter(n)}}catch(e){i.e(e)}finally{i.f()}return r.m_offset=this.m_offset,r.m_fillBounds=this.m_fillBounds,r.m_textEffectMetrics=this.m_textEffectMetrics,r.bender=this.m_bender,r}},{key:"characters",get:function(){return this.m_characters},set:function(e){(0,g.notifyIfNotEqualsArray)(this.m_changeTracker,this.m_characters,e),this.m_characters=e.slice(0)}},{key:"localRange",get:function(){return this.m_localRange},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_localRange,e),this.m_localRange=e}},{key:"offset",get:function(){return this.m_offset},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}},{key:"layoutBounds",get:function(){return this.m_layoutBounds},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_layoutBounds,e),this.m_layoutBounds=e}},{key:"fillBounds",get:function(){return this.m_fillBounds},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_fillBounds,e),this.m_fillBounds=e}},{key:"textEffectMetrics",get:function(){return this.m_textEffectMetrics},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}},{key:"bender",get:function(){return this.m_bender},set:function(e){this.bender==e||this.bender instanceof I&&e instanceof I&&this.bender.equals(e)||this.bender instanceof E&&e instanceof E&&this.bender.equals(e)||(this.m_changeTracker.notifyChange(),this.m_bender=e)}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"removeAllCharacters",value:function(){this.characters=[]}},{key:"addCharacter",value:function(e){this.m_changeTracker.notifyChange(),this.m_characters.push(e)}}])}();t.TextLine=D;var F=function(){function e(t,r){(0,l.default)(this,e),this.m_lines=[],this.m_localWordRanges=[],this.m_changeTracker=new p.ChangeTracker,this.m_globalRange=t,this.m_stylePerLocalRange=new b(r),this.m_effectsPerLocalRange=new b(new h.Effects),this.m_strokesPerLocalRange=new b(new p.TrackableArray),this.m_changeTracker.replaceListener(void 0,this.m_stylePerLocalRange),this.m_offset=u.Vector2.Zero}return(0,c.default)(e,[{key:"clone",value:function(){var t,r=new e(this.m_globalRange,this.m_stylePerLocalRange.defaultData),i=v(this.m_lines);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.addLine(n.clone())}}catch(e){i.e(e)}finally{i.f()}r.m_offset=this.m_offset,r.bullet=this.m_bullet?this.m_bullet.clone():void 0;var a,o=v(this.m_stylePerLocalRange.ranges);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.m_stylePerLocalRange.set(this.m_stylePerLocalRange.getAt(s.start).clone(),s)}}catch(e){o.e(e)}finally{o.f()}r.m_effectsPerLocalRange.defaultData=this.m_effectsPerLocalRange.defaultData;var l,c=v(this.m_effectsPerLocalRange.ranges);try{for(c.s();!(l=c.n()).done;){var u=l.value;r.m_effectsPerLocalRange.set(this.m_effectsPerLocalRange.getAt(u.start).clone(),u)}}catch(e){c.e(e)}finally{c.f()}r.m_strokesPerLocalRange.defaultData=this.m_strokesPerLocalRange.defaultData;var d,h=v(this.m_strokesPerLocalRange.ranges);try{for(h.s();!(d=h.n()).done;){var f,m=d.value,g=this.m_strokesPerLocalRange.getAt(m.start),y=new p.TrackableArray,_=v(g.elements);try{for(_.s();!(f=_.n()).done;){var S=f.value;y.push(S.clone())}}catch(e){_.e(e)}finally{_.f()}r.m_strokesPerLocalRange.set(y,m)}}catch(e){h.e(e)}finally{h.f()}return r.m_localWordRanges=this.m_localWordRanges.slice(0),r}},{key:"lines",get:function(){return this.m_lines},set:function(e){this.removeAllLines();var t,r=v(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.addLine(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:"stylePerLocalRange",get:function(){return this.m_stylePerLocalRange},set:function(e){this.m_changeTracker.replaceListener(this.m_stylePerLocalRange,e),this.m_stylePerLocalRange=e}},{key:"effectsPerLocalRange",get:function(){return this.m_effectsPerLocalRange},set:function(e){this.m_changeTracker.replaceListener(this.m_effectsPerLocalRange,e),this.m_effectsPerLocalRange=e}},{key:"strokesPerLocalRange",get:function(){return this.m_strokesPerLocalRange},set:function(e){this.m_changeTracker.replaceListener(this.m_strokesPerLocalRange,e),this.m_strokesPerLocalRange=e}},{key:"globalRange",get:function(){return this.m_globalRange},set:function(e){this.m_globalRange.equals(e)||(this.m_changeTracker.notifyChange(),this.m_globalRange=e)}},{key:"offset",get:function(){return this.m_offset},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}},{key:"bullet",get:function(){return this.m_bullet},set:function(e){this.m_changeTracker.replaceListener(this.m_bullet,e),this.m_bullet=e}},{key:"localWordRanges",get:function(){return this.m_localWordRanges},set:function(e){(0,g.notifyIfNotEqualsArray)(this.m_changeTracker,this.m_localWordRanges,e),this.m_localWordRanges=e.slice(0)}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"removeAllLocalWordRanges",value:function(){this.localWordRanges=[]}},{key:"addLocalWordRange",value:function(e){this.m_changeTracker.notifyChange(),this.m_localWordRanges.push(e)}},{key:"removeAllLines",value:function(){var e,t=v(this.m_lines);try{for(t.s();!(e=t.n()).done;){var r=e.value;p.ChangeTracker.RemoveListener(r.changeTracker,this.m_changeTracker)}}catch(e){t.e(e)}finally{t.f()}this.m_lines=[]}},{key:"addLine",value:function(e){p.ChangeTracker.AddListener(e.changeTracker,this.m_changeTracker),this.m_lines.push(e)}}])}();t.TextParagraph=F;var B,N,V=function(){function e(t,r,i,n){(0,l.default)(this,e),this.m_isAnchoredToPrevious=!1,this.m_changeTracker=new p.ChangeTracker,this.m_changeTracker.replaceListener(void 0,r),this.m_range=t,this.m_style=r,this.m_caretWidth=i,this.m_isAnchoredToPrevious=n}return(0,c.default)(e,[{key:"clone",value:function(){return new e(this.m_range,this.m_style.clone(),this.m_caretWidth,this.m_isAnchoredToPrevious)}},{key:"range",get:function(){return this.m_range},set:function(e){this.m_range.equals(e)||(this.m_changeTracker.notifyChange(),this.m_range=e)}},{key:"style",get:function(){return this.m_style},set:function(e){this.m_changeTracker.replaceListener(this.m_style,e),this.m_style=e}},{key:"caretWidth",get:function(){return this.m_caretWidth},set:function(e){(0,g.notifyIfDifferent)(this.m_changeTracker,this.m_caretWidth,e),this.m_caretWidth=e}},{key:"isAnchoredToPrevious",get:function(){return this.m_isAnchoredToPrevious},set:function(e){(0,g.notifyIfDifferent)(this.m_changeTracker,this.m_isAnchoredToPrevious,e),this.m_isAnchoredToPrevious=e}},{key:"changeTracker",get:function(){return this.m_changeTracker}}],[{key:"CreateCaret",value:function(t,r,i,n){return new e(new S(t,0),n||new f.Style(new f.SolidBrush(f.Color.White),void 0,new f.Pen,f.BlendingMode.exclusion),r,i)}},{key:"CreateRangeSelection",value:function(t,r){return new e(t,r,0,!1)}}])}();t.TextSelectionHighlight=V,t.TextSplit=B,function(e){e[e.AllAtOnce=0]="AllAtOnce",e[e.ByWord=1]="ByWord",e[e.ByLetter=2]="ByLetter"}(B||(t.TextSplit=B={})),t.TextRenderMode=N,function(e){e[e.TextInFrontOfShape=0]="TextInFrontOfShape",e[e.ShapeStyleOnText=1]="ShapeStyleOnText",e[e.ShapeCutout=2]="ShapeCutout",e[e.LinesCutout=3]="LinesCutout"}(N||(t.TextRenderMode=N={}));var U=function(){function e(){(0,l.default)(this,e),this.m_paragraphs=[],this.m_changeTracker=new p.ChangeTracker,this.m_animationChangeTracker=new p.ChangeTracker,this.m_selectionChangeTracker=new p.ChangeTracker,this.m_layoutToFrame=u.Transform.Identity,this.m_frameToShape=u.Transform.Identity,this.m_renderMode=N.TextInFrontOfShape}return(0,c.default)(e,[{key:"clone",value:function(){var t,r=new e,i=v(this.m_paragraphs);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.addParagraph(n.clone())}}catch(e){i.e(e)}finally{i.f()}if(r.m_layoutToFrame=this.m_layoutToFrame,r.m_frameToShape=this.m_frameToShape,this.m_animationProps){r.m_animationProps=new b(new w),r.m_animationProps.defaultData=this.m_animationProps.defaultData;var a,o=v(this.m_animationProps.ranges);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.m_animationProps.set(this.m_animationProps.getAt(s.start).clone(),s)}}catch(e){o.e(e)}finally{o.f()}}if(this.m_selectionHighlights){r.m_selectionHighlights=[];var l,c=v(this.m_selectionHighlights);try{for(c.s();!(l=c.n()).done;){var u=l.value;r.m_selectionHighlights.push(u.clone())}}catch(e){c.e(e)}finally{c.f()}}return r}},{key:"createAnimationProps",value:function(){this.animationProps=new b(new w)}},{key:"hasAnimationProps",value:function(){return!!this.animationProps}},{key:"paragraphs",get:function(){return this.m_paragraphs},set:function(e){if(this.m_paragraphs!=e){this.removeAllParagraphs();var t,r=v(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.addParagraph(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"layoutToFrame",get:function(){return this.m_layoutToFrame},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_layoutToFrame,e),this.m_layoutToFrame=e}},{key:"frameToShape",get:function(){return this.m_frameToShape},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_frameToShape,e),this.m_frameToShape=e}},{key:"animationProps",get:function(){return this.m_animationProps},set:function(e){this.m_animationProps!=e&&(this.m_animationProps&&(p.ChangeTracker.RemoveListener(this.m_animationProps.changeTracker,this.m_animationChangeTracker),p.ChangeTracker.RemoveListener(this.m_animationProps.rangeChangeTracker,this.m_changeTracker)),e&&(p.ChangeTracker.AddListener(e.changeTracker,this.m_animationChangeTracker),p.ChangeTracker.AddListener(e.rangeChangeTracker,this.m_changeTracker)),this.m_animationProps=e)}},{key:"selectionHighlights",get:function(){return this.m_selectionHighlights},set:function(e){(0,g.notifyIfDifferentArray)(this.m_selectionChangeTracker,this.m_selectionHighlights,e),this.m_selectionHighlights=e?e.slice(0):void 0}},{key:"clipBounds",get:function(){return this.m_clipBounds},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_clipBounds,e),this.m_clipBounds=e}},{key:"applyEffectsPerCharacter",get:function(){return!!this.m_applyEffectsPerCharacter},set:function(e){(0,g.notifyIfDifferent)(this.m_changeTracker,!!this.m_applyEffectsPerCharacter,e),this.m_applyEffectsPerCharacter=e}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"animationChangeTracker",get:function(){return this.m_animationChangeTracker}},{key:"textVersion",get:function(){return this.m_changeTracker.version}},{key:"selectionVersion",get:function(){return this.m_selectionChangeTracker.version}},{key:"renderMode",get:function(){return this.m_renderMode},set:function(e){(0,g.notifyIfDifferent)(this.m_changeTracker,this.m_renderMode,e),this.m_renderMode=e}},{key:"linesCutoutMargin",get:function(){return this.m_linesCutoutMargin||u.Vector2.Zero},set:function(e){(0,g.notifyIfNotEquals)(this.m_changeTracker,this.m_linesCutoutMargin,e),this.m_linesCutoutMargin=e}},{key:"spreadFill",get:function(){return!!this.m_spreadFill},set:function(e){(0,g.notifyIfDifferent)(this.m_changeTracker,!!this.m_spreadFill,e),this.m_spreadFill=e}},{key:"forceSplit",value:function(e){(!this.m_explicitTextSplit||e>this.m_explicitTextSplit)&&(this.m_changeTracker.notifyChange(),this.m_explicitTextSplit=e)}},{key:"removeAllParagraphs",value:function(){var e,t=v(this.m_paragraphs);try{for(t.s();!(e=t.n()).done;){var r=e.value;p.ChangeTracker.RemoveListener(r.changeTracker,this.m_changeTracker)}}catch(e){t.e(e)}finally{t.f()}this.m_paragraphs=[]}},{key:"addParagraph",value:function(e){p.ChangeTracker.AddListener(e.changeTracker,this.m_changeTracker),this.m_paragraphs.push(e)}},{key:"removeParagraph",value:function(e){p.ChangeTracker.RemoveListener(this.m_paragraphs[e].changeTracker,this.m_changeTracker),this.m_paragraphs.splice(e)}},{key:"getFullRange",value:function(){return this.paragraphs.length<1?void 0:S.FromFirstLast(this.paragraphs[0].globalRange.start,this.paragraphs[this.paragraphs.length-1].globalRange.last)}},{key:"getRunRanges",value:function(){var e=this.getFullRange();if(e){var t,r=[],i=v(this.paragraphs);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(this.m_explicitTextSplit==B.ByLetter||this.applyEffectsPerCharacter)for(var a=n.globalRange.start;a<=n.globalRange.last;a++)W(r,a);else{var o,s=n.globalRange.start,l=v(n.lines);try{for(l.s();!(o=l.n()).done;){var c=o.value;W(r,s+c.localRange.start),W(r,s+c.localRange.last+1)}}catch(e){l.e(e)}finally{l.f()}var u,d=v(n.stylePerLocalRange.ranges);try{for(d.s();!(u=d.n()).done;){var h=u.value;W(r,s+h.start),W(r,s+h.last+1)}}catch(e){d.e(e)}finally{d.f()}var f,m=v(n.effectsPerLocalRange.ranges);try{for(m.s();!(f=m.n()).done;){var p=f.value;W(r,s+p.start),W(r,s+p.last+1)}}catch(e){m.e(e)}finally{m.f()}var g,y=v(n.strokesPerLocalRange.ranges);try{for(y.s();!(g=y.n()).done;){var _=g.value;W(r,s+_.start),W(r,s+_.last+1)}}catch(e){y.e(e)}finally{y.f()}if(this.m_explicitTextSplit==B.ByWord){var S,T=v(n.localWordRanges);try{for(T.s();!(S=T.n()).done;){var b=S.value;W(r,s+b.start),W(r,s+b.last+1)}}catch(e){T.e(e)}finally{T.f()}}}}}catch(e){i.e(e)}finally{i.f()}if(this.animationProps){var C,w=v(this.animationProps.ranges);try{var P=function(){var e=C.value;r.some((function(t){return t==e.start}))||r.push(e.start),r.some((function(t){return t==e.last+1}))||r.push(e.last+1)};for(w.s();!(C=w.n()).done;)P()}catch(e){w.e(e)}finally{w.f()}}return G(r,e)}return[]}},{key:"getAnimatablePartRanges",value:function(e,t,r){var i=t||this.getFullRange();if(i&&0!=i.length){if(t&&r){if(t.start<0||t.start>=this.paragraphs.length||t.last<0||t.last>=this.paragraphs.length)return void d.Log.Error(592525336,"bad paragraph range");i=S.FromFirstLast(this.paragraphs[t.start].globalRange.start,this.paragraphs[t.last].globalRange.last)}if(e==B.AllAtOnce)return i?[i]:void 0;var n,a=[],o=v(this.paragraphs);try{for(o.s();!(n=o.n()).done;){var s,l=n.value,c=l.globalRange.start,u=v(l.lines);try{for(u.s();!(s=u.n()).done;){var h=s.value;if(W(a,c+h.localRange.start),W(a,c+h.localRange.last+1),e==B.ByLetter)for(var f=c+h.localRange.start,m=!1,p=0;p<h.characters.length;p++)m||W(a,f+p),m=1==h.characters[p].isWhiteSpace}}catch(e){u.e(e)}finally{u.f()}if(e==B.ByWord){var g,y=v(l.localWordRanges);try{for(y.s();!(g=y.n()).done;)W(a,c+g.value.start)}catch(e){y.e(e)}finally{y.f()}}}}catch(e){o.e(e)}finally{o.f()}return G(a,i)}}},{key:"getTextPathsForCharacter",value:function(e,t,r,i){var n,a=[],o=i&&e.outlinePath?e.outlinePath:e.paths,s=v(o instanceof m.Path?[o]:null!=o?o:[]);try{for(s.s();!(n=s.n()).done;){var l=n.value;if(l.figures.length>0){var c=u.Matrix3.Translation2D(t).multiply(this.layoutToFrame.toMatrix3()),h=l.transform.toMatrix3().multiply(c).tryGetTransform(l.transform.preTranslation);if(!h)throw d.Log.Error(592525337,"unexpected transform");var f=new m.Path(l,h),p=r instanceof E?r:void 0;if(r instanceof I){var g=e.layoutBounds.isEmpty()?void 0:e.layoutBounds.transformedBounds(c);if(e.forceWarping||!g)p=r.equivalentWarpingEnvelope;else{var y=r.getTransform(g);y&&(f=(h=h.toMatrix3().multiply(y.toMatrix3()).tryGetTransform(l.transform.preTranslation))?new m.Path(l,h):void 0)}}p&&f&&(f=p.warpPath(f)),f&&a.push(f)}}}catch(e){s.e(e)}finally{s.f()}return a}},{key:"getTextPathsForRange",value:function(e,t){var r,i=[],a=v(this.paragraphs);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.globalRange.intersects(e)){var s,l=v(o.lines);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=new S(0,c.characters.length).getIntersection(e.move(-o.globalRange.start-c.localRange.start));if(u)for(var d=u.start;d<=u.last;d++){var h=this.getTextPathsForCharacter(c.characters[d],c.offset.add(o.offset),c.bender,t);i.push.apply(i,(0,n.default)(h))}}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){a.e(e)}finally{a.f()}return i}},{key:"getLineAndParagraphAt",value:function(e){var t,r=v(this.paragraphs);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.globalRange.includes(e)){var n,a=e-i.globalRange.start,o=v(i.lines);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.localRange.includes(a))return{line:s,paragraph:i}}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){r.e(e)}finally{r.f()}}},{key:"getStyleAt",value:function(e){var t,r=v(this.paragraphs);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.globalRange.includes(e))return i.stylePerLocalRange.getAt(e-i.globalRange.start)}}catch(e){r.e(e)}finally{r.f()}}},{key:"getEffetcsAt",value:function(e){var t,r=v(this.paragraphs);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.globalRange.includes(e))return i.effectsPerLocalRange.getAt(e-i.globalRange.start)}}catch(e){r.e(e)}finally{r.f()}}},{key:"getStrokesAt",value:function(e){var t,r=v(this.paragraphs);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.globalRange.includes(e))return i.strokesPerLocalRange.getAt(e-i.globalRange.start)}}catch(e){r.e(e)}finally{r.f()}}},{key:"getPathFromLayoutRect",value:function(e,t,r){var i=u.Matrix3.Translation2D(r).multiply(this.layoutToFrame.toMatrix3()).tryGetTransform(u.Vector2.Zero);if(i){var n=new m.Path({figures:[m.Figure.CreateFromRect(e)],transform:i}),a=t.bender instanceof I?t.bender.equivalentWarpingEnvelope:t.bender;return a&&(n=a.warpPath(n)),n}}},{key:"getSelectionRectPaths",value:function(e){var t,r=void 0,i=v(this.paragraphs);try{for(i.s();!(t=i.n()).done;){var n,a=t.value,o=e?e.move(-a.globalRange.start):void 0,s=v(a.lines);try{for(s.s();!(n=s.n()).done;){var l=n.value,c=void 0;if(!o||l.characters&&o.intersects(l.localRange))for(var d=0;d<l.characters.length;d++){var h=l.localRange.start+d;(!o||o.start<=h&&h<=o.last)&&(c=u.Rect.UnionRect(c,l.characters[d].layoutBounds))}if(c){var f=this.getPathFromLayoutRect(c,l,l.offset.add(a.offset));f&&(r||(r=[]),r.push(f))}}}catch(e){s.e(e)}finally{s.f()}}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"getCutoutLinePath",value:function(e,t){var r,i=void 0,n=[],a=v(this.paragraphs);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,l=e?e.move(-s.globalRange.start):void 0,c=v(s.lines);try{for(c.s();!(o=c.n()).done;){var h=o.value,f=void 0;if(!l||h.characters&&l.intersects(h.localRange))for(var p=0;p<h.characters.length;p++){var g=h.localRange.start+p;(!l||l.start<=g&&g<=l.last)&&(f=u.Rect.UnionRect(f,h.characters[p].layoutBounds))}if(f){var y=h.offset.add(s.offset),_=u.Matrix3.Translation2D(y).multiply(this.layoutToFrame.toMatrix3());f=f.transformedBounds(_)}h.bender&&d.Log.Error(528320162,"LinesCutout currently not supported with Benders."),f&&n.push(new u.Rect(f.left-t.x,f.top-t.y,f.right+t.x,f.bottom+t.y))}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}if(n.length>0){var S=new m.FigureBuilder;S.moveTo(n[0].left,n[0].top),S.lineTo(n[0].right,n[0].top);for(var T=0;T<n.length-1;T++){var b=n[T].right,C=n[T+1].right,w=b>C?n[T].bottom:n[T+1].top;S.lineTo(b,w),S.lineTo(C,w)}S.lineTo(n[n.length-1].right,n[n.length-1].bottom),S.lineTo(n[n.length-1].left,n[n.length-1].bottom);for(var P=n.length-1;P>0;P--){var I=n[P].left,k=n[P-1].left,E=I<k?n[P].top:n[P-1].bottom;S.lineTo(I,E),S.lineTo(k,E)}S.close(),i=[m.Path.CreateFromFigure(S.createFigure())]}return i}},{key:"getBoundsOfRange",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r||!this.animationProps)return this.getBoundsOfRangeStatic(e,t);var i=this.getFullRange();if(i){var n,a=[],o=v(this.animationProps.ranges);try{for(o.s();!(n=o.n()).done;){var s=n.value;W(a,s.start),W(a,s.last+1)}}catch(e){o.e(e)}finally{o.f()}var l,c,d=G(a,i),h=v(d);try{for(h.s();!(c=h.n()).done;){var f=c.value,m=this.animationProps.getAt(f.start).animationTransform,p=t&&m?t.toMatrix3().multiply(m):t||m;l=u.Rect.UnionRect(l,this.getBoundsOfRangeStatic(f,p))}}catch(e){h.e(e)}finally{h.f()}return l}}},{key:"getBoundsOfRangeStatic",value:function(e,t){var r,i,n=t?this.frameToShape.toMatrix3().multiply(t.toMatrix3()):this.frameToShape,a=this.getSelectionRectPaths(e),o=v(this.paragraphs);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s.bullet&&s.lines.length>0&&(!e||e.includes(s.globalRange.start))){var l=this.getPathFromLayoutRect(s.bullet.character.layoutBounds,s.lines[0],s.offset);l&&(a=a?a.concat(l):[l])}}}catch(e){o.e(e)}finally{o.f()}var c,d=v(a||[]);try{for(d.s();!(c=d.n()).done;){var h=c.value;h.untransformedBounds&&(r=u.Rect.UnionRect(r,h.untransformedBounds.transformedBounds(h.transform.toMatrix3().multiply(n.toMatrix3()))))}}catch(e){d.e(e)}finally{d.f()}return r}},{key:"getSelectionLayoutCaretPath",value:function(e,t,r){var i,n=v(this.paragraphs);try{for(n.s();!(i=n.n()).done;){var a,o=i.value,s=e-o.globalRange.start,l=v(o.lines);try{for(l.s();!(a=l.n()).done;){var c=a.value;c.localRange.length!=c.characters.length&&d.Log.Error(592525338,"character count mismatch");var h=s-c.localRange.start,f=void 0;if(0<=h&&h<c.characters.length){var m=c.characters[h].layoutBounds,p=c.characters[h].isRTL?m.right:m.left;f=new u.Rect(p-.5*t,m.top,p+.5*t,m.bottom)}else if(0==h&&0==c.characters.length){var g=c.layoutBounds.left;f=new u.Rect(g-.5*t,c.layoutBounds.top,g+.5*t,c.layoutBounds.bottom)}else if(r&&s==c.localRange.last+1){var y=c.characters[c.characters.length-1].layoutBounds,_=c.characters[c.characters.length-1].isRTL?y.left:y.right;f=new u.Rect(_-.5*t,y.top,_+.5*t,y.bottom)}if(f)return this.getPathFromLayoutRect(f,c,c.offset.add(o.offset))}}catch(e){l.e(e)}finally{l.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"getLineAndParagraphFromLayoutPosition",value:function(e){var t,r=void 0,i=void 0,n=v(this.paragraphs);try{for(n.s();!(t=n.n()).done;){var a,o=t.value,s=v(o.lines);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(e.subtract(o.offset).subtract(l.offset).y<l.layoutBounds.bottom)return{paragraph:o,line:l};r=l,i=o}}catch(e){s.e(e)}finally{s.f()}}}catch(e){n.e(e)}finally{n.f()}return{paragraph:i,line:r}}},{key:"getSelectionFromLayoutPosition",value:function(e){var t=this.getLineAndParagraphFromLayoutPosition(e),r=t.paragraph,i=t.line;if(r&&i&&i.characters){for(var n,a,o,s=e.subtract(r.offset).subtract(i.offset),l=!1,c=0;c<i.characters.length;c++){var u=i.characters[c].layoutBounds,d=i.characters[c].isRTL?u.right:u.left,h=Math.abs(d-s.x),f=Math.abs(u.center.x-s.x);(void 0===a||void 0===o||h<a||h==a&&f<o)&&(n=c,a=h,o=f)}if(n==i.characters.length-1){var m=i.characters[n].layoutBounds.center.x;(s.x-m)*(i.characters[n].isRTL?-1:1)>0&&(n++,l=!0)}if(void 0!==n)return{characterIndex:r.globalRange.start+i.localRange.start+n,isAnchoredToPrevious:l}}}},{key:"hitTest",value:function(e){var t,r=v(this.paragraphs);try{for(r.s();!(t=r.n()).done;){var i,n=t.value,a=v(n.lines||[]);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e;if(o.bender){var l=e.transformPoint(this.layoutToFrame.toMatrix3()),c=(o.bender instanceof I?o.bender.equivalentWarpingEnvelope:o.bender).unwarpPoint(l,!0);if(!c)return!1;s=c.transformPoint(this.layoutToFrame.toInverseMatrix3())}var u=s.subtract(n.offset).subtract(o.offset);if(o.layoutBounds.isPointInRect(u))return!0}}catch(e){a.e(e)}finally{a.f()}}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"getBrushImages",value:function(){var e,t=[],r=v(this.paragraphs);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.bullet&&i.bullet.style&&t.push.apply(t,(0,n.default)(i.bullet.style.getBrushImages())),i.stylePerLocalRange.allData.forEach((function(e){t.push.apply(t,(0,n.default)(e.getBrushImages()))})),i.strokesPerLocalRange.allData.forEach((function(e){var r,i=v(e.elements);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.style&&t.push.apply(t,(0,n.default)(a.style.getBrushImages()))}}catch(e){i.e(e)}finally{i.f()}}));var a,o=v(i.lines);try{for(o.s();!(a=o.n()).done;){var s,l=v(a.value.characters);try{for(l.s();!(s=l.n()).done;){var c=s.value;c.textImage&&t.push(c.textImage.image)}}catch(e){l.e(e)}finally{l.f()}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}return t}}])}();function W(e,t){e.some((function(e){return e==t}))||e.push(t)}function G(e,t){W(e,t.start),W(e,t.last+1),e.sort((function(e,t){return e-t}));for(var r=[],i=0;i<e.length-1;i++){var n=S.FromFirstLast(e[i],e[i+1]-1).getIntersection(t);n&&n.length>0&&r.push(n)}return r}t.TextLayout=U},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.InternalTexture=t.InternalTextureSource=void 0;var n,a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(8)),c=i(r(10)),u=r(86),d=r(225);function h(e,t,r){return t=(0,l.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}t.InternalTextureSource=n,function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(n||(t.InternalTextureSource=n={}));var f=function(e){function t(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,a.default)(this,t),(i=h(this,t)).isReady=!1,i.isCube=!1,i.is3D=!1,i.is2DArray=!1,i.isMultiview=!1,i.url="",i.generateMipMaps=!1,i.samples=0,i.type=-1,i.format=-1,i.onLoadedObservable=new u.Observable,i.onErrorObservable=new u.Observable,i.onRebuildCallback=null,i.width=0,i.height=0,i.depth=0,i.baseWidth=0,i.baseHeight=0,i.baseDepth=0,i.invertY=!1,i._invertVScale=!1,i._associatedChannel=-1,i._source=n.Unknown,i._buffer=null,i._bufferView=null,i._bufferViewArray=null,i._bufferViewArrayArray=null,i._size=0,i._extension="",i._files=null,i._workingCanvas=null,i._workingContext=null,i._cachedCoordinatesMode=null,i._isDisabled=!1,i._compression=null,i._sphericalPolynomial=null,i._sphericalPolynomialPromise=null,i._sphericalPolynomialComputed=!1,i._lodGenerationScale=0,i._lodGenerationOffset=0,i._useSRGBBuffer=!1,i._creationFlags=0,i._lodTextureHigh=null,i._lodTextureMid=null,i._lodTextureLow=null,i._isRGBD=!1,i._linearSpecularLOD=!1,i._irradianceTexture=null,i._hardwareTexture=null,i._maxLodLevel=null,i._references=1,i._gammaSpace=null,i._premulAlpha=!1,i._dynamicTextureSource=null,i._engine=e,i._source=r,i._uniqueId=t._Counter++,o||(i._hardwareTexture=e._createHardwareTexture()),i}return(0,c.default)(t,e),(0,o.default)(t,[{key:"useMipMaps",get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e}},{key:"uniqueId",get:function(){return this._uniqueId}},{key:"_setUniqueId",value:function(e){this._uniqueId=e}},{key:"getEngine",value:function(){return this._engine}},{key:"source",get:function(){return this._source}},{key:"incrementReferences",value:function(){this._references++}},{key:"updateSize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,e,t,r),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r}},{key:"_rebuild",value:function(){var e,t,r=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var i=this.onRebuildCallback(this),a=function(e){e._swapAndDie(r,!1),r.isReady=i.isReady};i.isAsync?i.proxy.then(a):a(i.proxy)}else{var o;switch(this.source){case n.Temp:break;case n.Url:return void(o=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(e){e._swapAndDie(r,!1),r.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case n.Raw:(o=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer))._swapAndDie(this,!1),this.isReady=!0;break;case n.Raw3D:(o=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case n.Raw2DArray:(o=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case n.Dynamic:(o=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case n.Cube:return void(o=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){o._swapAndDie(r,!1),r.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case n.CubeRaw:(o=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,null!==(t=this._originalFormat)&&void 0!==t?t:this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case n.CubeRawRGBD:return;case n.CubePrefiltered:return void((o=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(r,!1),r.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial);case n.DepthStencil:case n.Depth:}}}},{key:"_swapAndDie",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===(t=this._hardwareTexture)||void 0===t||t.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,r&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var i=this._engine.getLoadedTexturesCache(),n=i.indexOf(this);-1!==n&&i.splice(n,1),-1===(n=i.indexOf(e))&&i.push(e)}},{key:"dispose",value:function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}])}(d.TextureSampler);t.InternalTexture=f,f._Counter=0},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getShaderCode=function(e){return u[e]},t.setShaderCode=function(e,t){u[e]=t},t.getEffectKey=d,t.precompileShaders=function(e,t){return m.apply(this,arguments)},t.ProgramId=void 0;var n,a=i(r(6)),o=i(r(5)),s=i(r(7)),l=r(132),c=r(13);t.ProgramId=n,function(e){e[e.distanceField=0]="distanceField",e[e.shapeRender=1]="shapeRender",e[e.gradient=2]="gradient",e[e.blur=3]="blur",e[e.fade=4]="fade",e[e.copyTexture=5]="copyTexture",e[e.copyTexturePictureEffects=6]="copyTexturePictureEffects",e[e.draw3D=7]="draw3D",e[e.copyTextureDrawMask=8]="copyTextureDrawMask",e[e.sharpnessFilter=9]="sharpnessFilter",e[e.magic=10]="magic",e[e.median=11]="median",e[e.count=12]="count",e[e.countMinimalSet=2]="countMinimalSet"}(n||(t.ProgramId=n={}));var u={};function d(e){return"sb-".concat(e)}function h(e,t,r){return f.apply(this,arguments)}function f(){return(f=(0,s.default)(a.default.mark((function e(t,r,i){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.Log.Message(507008354,"Compiling shader: "+t+" (precompile)"),u[t]=i,e.next=4,(0,l.generatePipelineContext)({shaderNameOrContent:{vertexSource:i.v,fragmentSource:i.f},key:d(t)},r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,s.default)(a.default.mark((function e(t,i){var s,l;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.TEXTURE_3D){e.next=2;break}return e.abrupt("return",[]);case 2:if(void 0!==i){e.next=7;break}return e.next=5,Promise.resolve().then(r.t.bind(null,138,7));case 5:l=e.sent,s={},(0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)((0,o.default)(s,n.distanceField,l.p_0),n.shapeRender,l.p_1),n.gradient,l.p_2),n.blur,l.p_3),n.fade,l.p_4),n.copyTexture,l.p_5),n.copyTexturePictureEffects,l.p_6),n.draw3D,l.p_7),n.copyTextureDrawMask,l.p_8),n.sharpnessFilter,l.p_9),i=(0,o.default)((0,o.default)(s,n.magic,l.p_10),n.median,l.p_11);case 7:if(i){e.next=9;break}throw new Error("Shader code array is not provided");case 9:if(!Array.isArray(i)){e.next=13;break}return e.abrupt("return",Promise.all(i.map((function(e,r){return h(r,t,e)}))));case 13:return e.abrupt("return",Promise.all(Object.keys(i).map((function(e){var r,n=null===(r=i)||void 0===r?void 0:r[e];n&&h(+e,t,n)}))));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeViewElementUtils=void 0;var n=i(r(1)),a=i(r(2)),o=r(35),s=r(52),l=r(20),c=r(25),u=r(295),d=r(3),h=r(90),f=r(4);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var g=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"initShapeItem",value:function(t,r,i,n,a,o){var s;if(i.shapeBuilderData){try{s=u.ParseJson.convertDocShapeOrGroup(i.shapeBuilderData,o.viewDataManager.glyphStore,n,h.ParseJsonUlsLogger.getInstance(),{defaultClientData:{shapeId:a}})}catch(e){return void d.ULS.sendTraceTag(593356505,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"ShapeViewElement::init: ParseJson.convertDocShapeOrGroup threw exception ".concat(e,"."))}if(!s)return void d.ULS.sendTraceTag(593356506,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"ShapeViewElement::init: invalid shapeItem after convertRenderData.");var p,g=m(t);try{for(g.s();!(p=g.n()).done;){var v,y=p.value,_=[],S=m(y.parts);try{for(S.s();!(v=S.n()).done;){var T=v.value,b=e.toPositionSize(T.regionPos),C=(0,h.getTextItem)(s),w=void 0;if(T.fText&&C&&C.text){var P=void 0;switch(T.splitBy){case c.SplitBy.letter:P=l.TextSplit.ByLetter;break;case c.SplitBy.word:P=l.TextSplit.ByWord;break;default:P=l.TextSplit.AllAtOnce}w=T.textRange?l.TextRange.FromFirstLast(T.textRange.begin,T.textRange.begin+T.textRange.length-1):C.text.getFullRange();var I=C.text.getAnimatablePartRanges(P,w,!1);if(!I)continue;var k,E=m(I);try{for(E.s();!(k=E.n()).done;){var x=k.value,L=void 0;if(T.fShape||!f.Settings.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1))L=b;else{var A=new l.Transform(c.Vector2.Zero,c.Vector2.One,C.transform.rotation,C.transform.translation),M=C.text.getBoundsOfRange(x,A);if(!M)continue;L={position:M.leftTop,size:M.size}}var R=x;P!==l.TextSplit.AllAtOnce||T.textRange||(R=void 0);var O={fShape:T.fShape,fText:T.fText,bigParts:T.bigParts,position:L.position,size:L.size,shapeId:T.shapeId,textRange:R};_.push(O)}}catch(e){E.e(e)}finally{E.f()}}else{var D={fShape:T.fShape,fText:T.fText,bigParts:T.bigParts,position:b.position,size:b.size,shapeId:T.shapeId,textRange:w};_.push(D)}}}catch(e){S.e(e)}finally{S.f()}r.push({id:y.id,parts:_})}}catch(e){g.e(e)}finally{g.f()}}else{var F,B=[],N=m(t);try{for(N.s();!(F=N.n()).done;){var V,U=F.value,W=[],G=m(U.parts);try{for(G.s();!(V=G.n()).done;){var H=V.value,j=e.toPositionSize(H.regionPos),z=new l.ImageContainer;z.id=H.regionPos.region.imgID;var q=new l.ImageBrush(z),Z=l.Shape.CreateRectangle(l.Rect.FromSize(j.size),new l.Style(q),void 0,new l.Transform(j.position));(0,h.ensureClientData)(Z).shapeId=a,(0,h.ensureClientData)(Z).partId=H.bigParts.length>0?H.bigParts[0]:"",B.push(Z);var X={fShape:!0,fText:!0,bigParts:H.bigParts,position:new c.Vector2(H.regionPos.pos.x,H.regionPos.pos.y),size:new c.Vector2(H.regionPos.region.rect.right-H.regionPos.region.rect.left,H.regionPos.region.rect.bottom-H.regionPos.region.rect.top),shapeId:H.shapeId};W.push(X)}}catch(e){G.e(e)}finally{G.f()}r.push({id:U.id,parts:W})}}catch(e){N.e(e)}finally{N.f()}1===B.length?s=B[0]:(s=new l.Group(B),(0,h.ensureClientData)(s).shapeId=a)}return(0,h.ensureClientData)(s).isBackground=i.isBackground,s}},{key:"attachTextures",value:function(t,r,i,n){var a={},o=t.viewDataManager.imageDataMap;if(!i.shapeBuilderData){var s,u=m(i.animatableContents);try{for(u.s();!(s=u.n()).done;){var h,p=m(s.value.parts);try{for(p.s();!(h=p.n()).done;){var g=h.value,v=e.toPositionSize(g.regionPos);if(o.has(g.regionPos.region.imgID)){var y=o.get(g.regionPos.region.imgID),_=y.size;if(!_)return a;var S=new c.Vector2((g.regionPos.region.rect.right+g.regionPos.region.rect.left)/2,(g.regionPos.region.rect.bottom+g.regionPos.region.rect.top)/2);e.verifyTextureSize(t,"attachTextures_fallback",v.size);var T=new l.ImageContainer;T.id=g.regionPos.region.imgID;var b=n&&n.shapeId&&f.Settings.readBooleanOrDefault("useDetailedTextureScenario",!0)?"FallbackShape-Slide:".concat(n.shapeId.slideId.sid,"-Shape:").concat(n.shapeId.shapeId,"-Image:").concat(T.id):"FallbackShape";t.rendererEnvironment.attachImage(b,T,y,v.size),y.loadedShapeIDs.push(i.shapeId.shapeId);var C=new l.ImageBrush(T);C.scale=_.divide(v.size),C.offset=_.scale(.5).subtract(S).divide(v.size);var w=e.findShapeWithImageId(r,g.regionPos.region.imgID);w&&(w.style=new l.Style(C))}}}catch(e){p.e(e)}finally{p.f()}}}catch(e){u.e(e)}finally{u.f()}return a}var P,I=m(r.getBrushImages());try{for(I.s();!(P=I.n()).done;){var k=P.value;if(k.id)if(o.has(k.id)){var E=o.get(k.id);e.verifyTextureSize(t,"attachTextures_nonfallback",E.size),t.rendererEnvironment.attachImage("Shape",k,E,E.size),E.loadedShapeIDs.push(i.shapeId.shapeId)}else d.ULS.sendTraceTag(594641554,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"ShapeViewElement::attachTextures: Missing texture. Id: ".concat(k.id,", imageDataMap:").concat(!!o.has(k.id))),a.hasOwnProperty("missingTextureIds")||(a.missingTextureIds=[]),a.missingTextureIds.push(k.id)}}catch(e){I.e(e)}finally{I.f()}return a}},{key:"toPositionSize",value:function(e){return{position:e?new c.Vector2(e.pos.x,e.pos.y):c.Vector2.Zero,size:e?new c.Vector2(e.region.rect.right-e.region.rect.left,e.region.rect.bottom-e.region.rect.top):c.Vector2.One}}},{key:"removeFromScene",value:function(e,t){var r=e.items.elements.slice(0);r.splice(e.items.elements.indexOf(t),1),e.setItems(r)}},{key:"applyAnimationToShapeItemAndClickTarget",value:function(t,r,i){var n,a=t.Attributes,o=t.Shape,u=new c.Vector2(o.position.x,o.position.y),d=new c.Vector2(o.size.x,o.size.y),p={position:new c.Vector2(s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.PosX,u.x),s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.PosY,u.y)),scale:new c.Vector2(s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.ScaleW,1),s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.ScaleH,1)),fadeMaskInfo:s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.FadeMaskInfo,void 0),fadeMaskProgress:s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.FadeMaskProgress,0),angle:s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.Rotate,0),startingPosition:u,visible:s.AnimAttributeHelper.getAnimAttributeValue(a,s.AnimAttributeId.Visible,0)},g=new c.Vector2(p.position.x-p.startingPosition.x,p.position.y-p.startingPosition.y),v=u.add(d.scale(.5)),y=new l.Transform(v.negate(),p.scale,p.angle,g.add(v)),_=!p.visible;if(p.fadeMaskInfo){var S=!!(1&p.fadeMaskInfo.flags),T=!!(2&p.fadeMaskInfo.flags),b=!!(4&p.fadeMaskInfo.flags),C=!!(8&p.fadeMaskInfo.flags),w=!!(16&p.fadeMaskInfo.flags);(n=new l.Fade(p.fadeMaskInfo.preset,p.fadeMaskInfo.param,b,C,S,T,w)).progress=p.fadeMaskProgress}var P,I=m((0,h.findItems)(r,o.bigParts)||[r]);try{for(I.s();!(P=I.n()).done;){var k=P.value;if(o.fShape&&(k.animationTransform=y.toMatrix3(),k.isHidden=_,k.fade=n),o.fText){var E=(0,h.getTextItem)(k);if(E&&E.text&&o.textRange){var x=new l.TextRunAnimationProps,L=o.textRange;x.animationTransform=y.toMatrix3(),x.fade=n,x.isHidden=_,E.text.animationProps||E.text.createAnimationProps(),E.text.animationProps&&E.text.animationProps.set(x,L)}}}}catch(e){I.e(e)}finally{I.f()}if(i.clickTargets)for(var A=0;A<i.clickTargets.length;A+=1){var M=i.clickTargets[A],R=document.getElementById("sp-".concat(JSON.stringify(i.shapeId),"-i-").concat(A));if(R&&e.getAnimatableContentIdFromClickTarget(M)===(-1!==t.Id.indexOf("c")?t.Id.split("c")[0]:t.Id))if(p.visible){var O=f.Settings.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1)?l.Rect.FromSize(d):e.getAnimatableContentRegionFromClickTarget(M);O&&(e.setClickTargetRegion(R,O,p.position),R.style.display="block")}else R.style.display="none"}}},{key:"setClickTargetRegion",value:function(t,r,i){t.style.position="absolute",t.style.left="".concat(i.x+r.left,"px"),t.style.top="".concat(i.y+r.top,"px");var n={left:i.x+r.left,top:i.y+r.top,right:i.x+r.right,bottom:i.y+r.bottom},a=document.getElementById(o.ViewController.ClickTargetsReferenceDivId);if(a){var s={left:0,top:0,right:a.offsetWidth,bottom:a.offsetHeight},l=f.Settings.readBooleanOrDefault("hackClickTargets",!1)?n:e.findIntersectingRect(n,s);if(!l)return t.style.display="none",t.style.width="0px",void(t.style.height="0px");t.style.display="block",t.style.width="".concat(l.right-l.left,"px"),t.style.height="".concat(l.bottom-l.top,"px")}}},{key:"findShapeWithImageId",value:function(e,t){if(e){var r=function(e){return e.getBrushImages().findIndex((function(e){return e.id===t}))>=0};if(e.getType()===l.ItemType.shape){var i=e;return r(i)?i:void 0}if(e.getType()===l.ItemType.group){var n,a=m(e.items.elements);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.getType()!==l.ItemType.shape)return;var s=o;if(r(s))return s}}catch(e){a.e(e)}finally{a.f()}}}}},{key:"getAnimatableContentIdFromClickTarget",value:function(e){return e.action?e.action.animatableContentId:e.animation?e.animation.animatableContentId:e.hyperlink?e.hyperlink.animatableContentId:void 0}},{key:"getAnimatableContentRegionFromClickTarget",value:function(e){return e.action?e.action.region:e.animation?e.animation.region:e.hyperlink?e.hyperlink.region:void 0}},{key:"findIntersectingRect",value:function(e,t){var r=Math.max(e.left,t.left),i=Math.min(e.right,t.right),n=Math.max(e.top,t.top),a=Math.min(e.bottom,t.bottom);if(i>=r&&a>=n)return{left:r,top:n,right:i,bottom:a}}},{key:"verifyTextureSize",value:function(e,t,r){!e.stringifyError||"number"==typeof r.x&&r.x>0&&"number"==typeof r.y&&r.y>0||d.ULS.sendTraceTag(545404041,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,e.stringifyError(new Error("verifyTextureSize: invalid size. scenario: ".concat(t,", x:").concat(r.x,", y:").concat(r.y))))}},{key:"ensureShapeViewElementParentDiv",value:function(e,t,r){var i=r?"".concat(o.ViewController.SlideLevelHtmlElementsDivId,"-").concat(JSON.stringify(e),"-").concat(o.ViewController.CrossSlideShapeId):"".concat(o.ViewController.SlideLevelHtmlElementsDivId,"-").concat(JSON.stringify(e)),n=document.getElementById(i);if(n)return n;var a=document.getElementById(o.ViewController.SlideLevelHtmlElementsParentDivId);return(n=document.createElement("div")).style.position="absolute",n.id=i,n.style.zIndex=t,a&&a.appendChild(n),n}},{key:"ensureAccessibilityElement",value:function(e){var t=document.getElementById(o.ViewController.SlideLevelHtmlElementsParentDivId);if(t){var r=this.generateShapeLevelAccessibilityElementId(e);if(document.getElementById(r))return;var i=document.createElement("div");i.id=r,i.style.display="none",t.appendChild(i)}}},{key:"ensureSlideTitleElement",value:function(){var e=document.getElementById(o.ViewController.AccessibilitySlideTitleId);if(e)return e;var t=document.getElementById(o.ViewController.SlideLevelHtmlElementsParentDivId);return(e=document.createElement("span")).id=o.ViewController.AccessibilitySlideTitleId,t&&t.firstChild?t.insertBefore(e,t.firstChild):t&&t.appendChild(e),e}},{key:"generateShapeLevelAccessibilityElementId",value:function(e){return"".concat(o.ViewController.ShapeAccessibilityElementId,"-sid:").concat(e.slideId.sid,"-shapeId:").concat(e.shapeId)}},{key:"generateShapeIdString",value:function(e){return"sid:".concat(e.slideId.sid,"-shapeId:").concat(e.shapeId)}}])}();t.ShapeViewElementUtils=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ARIA_HIDDEN=t.ARIA_VALUETEXT=t.ARIA_LABEL=t.ARIA_HASPOPUP=t.ARIA_EXPANDED=t.ARIA_CHECKED=t.ONLINE_VIDEO_PROVIDER_URL_SCHEMES=t.HUBBLE_403_ERROR_MESSAGE=t.HUBBLE_500_ERROR_MESSAGE=t.HUBBLE_400_ERROR_MESSAGE=t.HUBBLE_404_ERROR_MESSAGE=t.HEADER_AUTHORIZATION=t.HEADER_ACCEPT_LANGUAGE=t.HEADER_CORRELATION_ID=t.HEADER_CONTENT_TYPE=t.HUBBLE_MEDIAOEMBEDVIDEO_URI=t.HUBBLE_GETOEMBEDPROVIDERS_URI=t.MENU_SCROLL_WAIT=t.MENU_SCROLL_INCREMENT=t.CAPTIONS_BOTTOM_POSITION_PORTION=t.CAPTIONS_WIDTH_PORTION=t.CAPTIONS_LAST_SELECTED_LABEL=t.CAPTIONS_LAST_SELECTED_LANG=t.VIDEO_CAPTIONS_RENDER_WINDOW_ID=t.BUTTON_SIZE=t.PLAYBACK_SPEED_LABEL=t.PLAYBACK_SPEEDS=t.PROGRESS_BAR_LOAD_COLOR_HIGHCONTRAST=t.PROGRESS_BAR_RIGHT_COLOR_HIGHCONTRAST=t.PROGRESS_BAR_LEFT_COLOR_HIGHCONTRAST=t.PROGRESS_BAR_LOAD_COLOR=t.PROGRESS_BAR_RIGHT_COLOR=t.PROGRESS_BAR_LEFT_COLOR=t.YOUTUBE_IFRAME_API=t.CUE_PREVIEW_END_TIME_TOLERANCE=t.CUE_PREVIEW_START_TIME_TOLERANCE=t.EDITOR_UPDATED_PLAYBUTTON_LENGTH=t.EDITOR_PLAYBUTTON_LENGTH=t.VIDEO_Z_INDEX=t.PLAYBUTTON_LENGTH=t.YOUTUBE_HOSTNAME=t.VIMEO_HOSTNAME=t.TED_EMBED_HOSTNAME=t.TED_HOSTNAME=t.SLIDESHARE_HOSTNAME=t.MICROSOFT_STREAM_GENERIC_HOSTNAME=t.FLIP_HOSTNAME=t.FLIPGRID_HOSTNAME=t.FLIPGRID_SHORTS_HOSTNAME=t.AZURE_MEDIA_SERVICE_HOSTNAME=void 0,t.AZURE_MEDIA_SERVICE_HOSTNAME="dashproto-uswe.streaming.media.azure.net",t.FLIPGRID_SHORTS_HOSTNAME="shorts.flipgrid.com",t.FLIPGRID_HOSTNAME="flipgrid.com",t.FLIP_HOSTNAME="flip.com",t.MICROSOFT_STREAM_GENERIC_HOSTNAME="microsoftstream.com",t.SLIDESHARE_HOSTNAME="www.slideshare.net",t.TED_HOSTNAME="www.ted.com",t.TED_EMBED_HOSTNAME="embed.ted.com",t.VIMEO_HOSTNAME="player.vimeo.com",t.YOUTUBE_HOSTNAME="www.youtube.com",t.PLAYBUTTON_LENGTH=56.6,t.VIDEO_Z_INDEX=6,t.EDITOR_PLAYBUTTON_LENGTH=60,t.EDITOR_UPDATED_PLAYBUTTON_LENGTH=96,t.CUE_PREVIEW_START_TIME_TOLERANCE=.1,t.CUE_PREVIEW_END_TIME_TOLERANCE=.25,t.YOUTUBE_IFRAME_API="https://www.youtube.com/iframe_api",t.PROGRESS_BAR_LEFT_COLOR="#FFFFFF",t.PROGRESS_BAR_RIGHT_COLOR="#FFFFFF59",t.PROGRESS_BAR_LOAD_COLOR="#FFFFFFB2",t.PROGRESS_BAR_LEFT_COLOR_HIGHCONTRAST="Highlight",t.PROGRESS_BAR_RIGHT_COLOR_HIGHCONTRAST="ButtonFace",t.PROGRESS_BAR_LOAD_COLOR_HIGHCONTRAST="ButtonText",t.PLAYBACK_SPEEDS=[2,1.75,1.5,1.25,1,.5],t.PLAYBACK_SPEED_LABEL="x",t.BUTTON_SIZE=36,t.VIDEO_CAPTIONS_RENDER_WINDOW_ID="video-captions-render-window",t.CAPTIONS_LAST_SELECTED_LANG="CaptionsLang",t.CAPTIONS_LAST_SELECTED_LABEL="CaptionsLabel",t.CAPTIONS_WIDTH_PORTION=.6,t.CAPTIONS_BOTTOM_POSITION_PORTION=.04,t.MENU_SCROLL_INCREMENT=35,t.MENU_SCROLL_WAIT=35,t.HUBBLE_GETOEMBEDPROVIDERS_URI="/mediasvc/api/media/getoembedproviders",t.HUBBLE_MEDIAOEMBEDVIDEO_URI="/mediasvc/api/media/oembed",t.HEADER_CONTENT_TYPE="Content-Type",t.HEADER_CORRELATION_ID="X-CorrelationId",t.HEADER_ACCEPT_LANGUAGE="Accept-Language",t.HEADER_AUTHORIZATION="Authorization",t.HUBBLE_404_ERROR_MESSAGE="Inserted URL is either not a valid video or can't be embedded",t.HUBBLE_400_ERROR_MESSAGE="Inserted URL is not from a currently supported video provider",t.HUBBLE_500_ERROR_MESSAGE="The online video service failed, please try again",t.HUBBLE_403_ERROR_MESSAGE="This video could not be played because it either was not found or you do not have access to it.",t.ONLINE_VIDEO_PROVIDER_URL_SCHEMES={YouTube:["https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist|v|embed)/.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist)\\?.*","https://youtu\\.be/.*","https://youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/shorts.*"],Vimeo:["https://(\\w+\\.)?(player\\.)?vimeo\\.com/.*"],Flip:["https://(\\w+\\.)?flipgrid\\.com/s/.*","https://(\\w+\\.)?flip\\.com/s/.*","https://(\\w+\\.)?shorts\\.flipgrid\\.com/watch/.*","https://(\\w+\\.)?shorts\\.flip\\.com/watch/.*"],StreamClassic:["https://(\\w+\\.)?microsoftstream\\.com/embed/video/.*","https://(\\w+\\.)?microsoftstream\\.com/video/.*"],Ted:["https://embed\\.ted\\.com/talks/.*","https://www\\.ted\\.com/talks/.*","https://www\\.ted\\.com/index\\.php/talks/.*\\.html.*"],SlideShare:["https://(\\w+\\.)?slideshare\\.net/.*"]},t.ARIA_CHECKED="aria-checked",t.ARIA_EXPANDED="aria-expanded",t.ARIA_HASPOPUP="aria-haspopup",t.ARIA_LABEL="aria-label",t.ARIA_VALUETEXT="aria-valuetext",t.ARIA_HIDDEN="aria-hidden"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSettingCallbacks=function(e){t.Settings=i=e},t.Settings=void 0;var i={getBoolean:function(e){return!1},getNumber:function(e){},getString:function(e){}};t.Settings=i},function(e,t,r){"use strict";var i,n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.FlyDoorTypes=t.FlySlideDrawType=t.FlyReflectionTypes=t.kTransitionPattern=t.kTransitionIds=t.kTransitionEffectOptions=t.kPerspective=t.kTransformStyle=t.kBackfaceVisibility=t.kSlideB=t.kSlideA=void 0,t.kSlideA=0,t.kSlideB=1,t.kBackfaceVisibility="hidden",t.kTransformStyle="preserve-3d",t.kPerspective=4e3,t.kTransitionEffectOptions={Left:0,Top:1,Right:2,Bottom:3,TopLeft:4,TopRight:5,BottomLeft:6,BottomRight:7,HorizontalOut:0,HorizontalIn:1,VerticalOut:2,VerticalIn:3,Horizontal:0,Vertical:1,ZoomOut:0,ZoomIn:1,Anywhere:0,BlackFromLeft:1,BlackFromRight:3,GoIn:0,GoOut:1,InBounce:4,OutBounce:5},t.kTransitionIds={PPT_TRANSITION_CUT:0,PPT_TRANSITION_RANDOM:1,PPT_TRANSITION_FADE:23,PPT_TRANSITION_FADE_THROUGH_BLACK:6,PPT_TRANSITION_PUSH:20,PPT_TRANSITION_FLIP:43,PPT_TRANSITION_PRISM:44,PPT_TRANSITION_MORPH:60,PPT_TRANSITION_WIPE:10,PPT_TRANSITION_STRIPS:9,PPT_TRANSITION_SPLIT:13,PPT_TRANSITION_ZOOM:11,PPT_TRANSITION_DIAMOND:17,PPT_TRANSITION_PLUS:18,PPT_TRANSITION_CIRCLE:27,PPT_TRANSITION_RANDOMBAR:8,PPT_TRANSITION_COMB:21,PPT_TRANSITION_DISSOLVE:5,PPT_TRANSITION_COVER:4,PPT_TRANSITION_UNCOVER:7,PPT_TRANSITION_WHEEL:26,PPT_TRANSITION_WHEELREVERSE:47,PPT_TRANSITION_WEDGE:19,PPT_TRANSITION_RIPPLE:29,PPT_TRANSITION_BLINDS:2,PPT_TRANSITION_CHECKER:3,PPT_TRANSITION_VORTEX:28,PPT_TRANSITION_SWITCH:42,PPT_TRANSITION_FALLOVER:48,PPT_TRANSITION_DRAPE:49,PPT_TRANSITION_CURTAINS:50,PPT_TRANSITION_WIND:51,PPT_TRANSITION_PRESTIGE:52,PPT_TRANSITION_FRACTURE:53,PPT_TRANSITION_CRUSH:54,PPT_TRANSITION_PEELOFF:55,PPT_TRANSITION_PAGECURLSINGLE:56,PPT_TRANSITION_PAGECURLDOUBLE:57,PPT_TRANSITION_AIRPLANE:58,PPT_TRANSITION_ORIGAMI:59,PPT_TRANSITION_GLITTER:30,PPT_TRANSITION_GALLERY:38,PPT_TRANSITION_PAN:36,PPT_TRANSITION_CONVEYOR:37,PPT_TRANSITION_CROSSZOOM:39,PPT_TRANSITION_FLYTHROUGH:31,PPT_TRANSITION_FLYTHROUGH_CONTENT:32,PPT_TRANSITION_ZOOM_WITH_SPIN:22,PPT_TRANSITION_DOORS:33,PPT_TRANSITION_DOORS_CONTENT:34},t.kTransitionPattern={PatternDiamond:0,PatternHexagon:1},t.FlyReflectionTypes=i,function(e){e[e.ReflectionNone=0]="ReflectionNone",e[e.ReflectionSimple=1]="ReflectionSimple",e[e.ReflectionAngled=2]="ReflectionAngled",e[e.ReflectionShrink=3]="ReflectionShrink"}(i||(t.FlyReflectionTypes=i={})),t.FlySlideDrawType=n,function(e){e[e.DrawPreviousSlide=0]="DrawPreviousSlide",e[e.DrawNextSlide=1]="DrawNextSlide",e[e.DrawNextSlideReflection=2]="DrawNextSlideReflection"}(n||(t.FlySlideDrawType=n={})),t.FlyDoorTypes=a,function(e){e[e.DoorNone=0]="DoorNone",e[e.DoorHorizontal=1]="DoorHorizontal",e[e.DoorVertical=2]="DoorVertical",e[e.DoorSlidingHorizontal=3]="DoorSlidingHorizontal",e[e.DoorSlidingVertical=4]="DoorSlidingVertical"}(a||(t.FlyDoorTypes=a={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(35);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(393);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(25);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(77);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(100);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(395);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SessionUtils=void 0;var n=i(r(18)),a=i(r(5)),o=i(r(1)),s=i(r(2)),l=r(14),c=r(3),u=r(122),d=r(181),h=r(195),f=r(4);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var y=function(){function e(){(0,o.default)(this,e)}return(0,s.default)(e,null,[{key:"init",value:function(t,r,i,n){e.m_userSessionId=t.appSettings.userSessionId;var a=(new u.UAParser).getResult();e.m_sessionConfig={browserName:a.browser.name,browserMajor:a.browser.major,osName:a.os.name,osVersion:a.os.version,uiHost:t.appSettings.uiHost,pkgVersion:r,svmVersion:i,sbVersion:n,browserLCID:navigator.language};var o={appMetadata:{initTime:t.appSettings.initTime,uiHost:t.appSettings.uiHost,serverUrl:t.appSettings.serverUrl,scenario:t.appSettings.scenario,useDocCache:t.appSettings.useDocCache,useSnapDownloadUrl:t.appSettings.useSnapDownloadUrl,userId:t.appSettings.userId,ring:t.appSettings.ring,fileHost:t.appSettings.fileHost},config:e.m_sessionConfig,uaStr:a.ua,pkgVersion:r,svmVersion:i,sbVersion:n};c.ULS.sendTraceTag(572289233,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,JSON.stringify(t));var s=t.slideShowCoreSettings.settings,l=f.Settings.readStringOrDefault("SSSessionSettingsToLogAsWarning","");if(s)for(var h in s)for(var m in s[h]){var p=l.indexOf("".concat(m,";"))>=0;c.ULS.sendTraceTag(537522828,c.LogCategory.msoulscat_Wac_PptSlideshow,p?c.TraceLevel.Warning:c.TraceLevel.Info,"".concat(h,".").concat(m,":").concat(s[h][m]))}if(t.slideShowCoreSettings.disabledChangeGates){var v,y=g(t.slideShowCoreSettings.disabledChangeGates.split(";"));try{for(y.s();!(v=y.n()).done;){var _=v.value;c.ULS.sendTraceTag(537522829,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,_)}}catch(e){y.e(e)}finally{y.f()}}c.ULS.sendTraceTag(595641932,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,d.NavigationLogger.getLogString("SSCoreConstructor",o))}},{key:"logSessionStart",value:function(t){e.m_sessionStats={};var r=p({userSessionId:e.m_userSessionId,startFromTime:t},e.getSessionConfig());for(var i in e.m_sessionStats)r[i]=e.m_sessionStats[i];c.ULS.sendTraceTag(594137685,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,d.NavigationLogger.getLogString("sessionStart",r)),e.startFrom=t}},{key:"logSessionEnd",value:function(t){var r={sessionId:e.m_userSessionId,startFromTime:e.startFrom,exitFromTime:t||performance.now(),vetos:(0,n.default)(l.VetoUtils.getSessionVetos().keys())};for(var i in h.AnnotationLogger.logInkActivity("SessionEnd"),e.m_sessionStats)r[i]=e.m_sessionStats[i];if(e.startFrom=0,c.ULS.sendTraceTag(594650329,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,d.NavigationLogger.getLogString("sessionEnd",r)),Object.keys(e.m_sessionTransitionStats).length>0){var a={sessionId:e.m_userSessionId,startFromTime:e.startFrom,TransitionUsageData:e.m_sessionTransitionStats};c.ULS.sendTraceTag(592843211,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,d.NavigationLogger.getLogString("transitionLogObject",a))}}},{key:"recordSessionTransitionStats",value:function(t){if(t.effectId){if(e.m_sessionTransitionStats[t.effectId]){var r=e.m_sessionTransitionStats[t.effectId].count;e.m_sessionTransitionStats[t.effectId].count=r+1}else e.m_sessionTransitionStats[t.effectId]={count:1,isSupported:t.isSupported};t.metadata&&Object.keys(t.metadata).length>0&&(e.m_sessionTransitionStats[t.effectId].hasOwnProperty("metadata")?e.m_sessionTransitionStats[t.effectId].metadata.push(t.metadata):e.m_sessionTransitionStats[t.effectId].metadata=[t.metadata]),60!==t.effectId||e.getSessionStats("hasMorph")||e.recordSessionStats({hasMorph:!0})}}},{key:"recordSessionStats",value:function(t){var r={sessionId:e.m_userSessionId,startFromTime:e.startFrom};c.ULS.sendTraceTag(593295362,c.LogCategory.msoulscat_Wac_PptSlideshow,t.hasOwnProperty("errorName")?c.TraceLevel.Warning:c.TraceLevel.Info,"SessionUtils::recordSessionStats: ".concat(JSON.stringify(p(p({},t),r))));for(var i=0,n=Object.keys(t);i<n.length;i++){var a=n[i];"metadata"===a?(e.m_sessionStats.hasOwnProperty(a)||(e.m_sessionStats[a]=[]),e.m_sessionStats[a].includes(t[a])||(e.m_sessionStats[a]=e.m_sessionStats[a].concat(t[a]))):"errorName"===a?l.VetoUtils.recordVeto("ACE",{msg:t[a]}):e.m_sessionStats[a]=t[a]}}},{key:"getSessionStats",value:function(t){return e.m_sessionStats[t]}},{key:"getSessionConfig",value:function(){return e.m_sessionConfig}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}}])}();t.SessionUtils=y,y.m_sessionStats={},y.m_sessionTransitionStats={},y.m_sessionConfig={},y.startFrom=0},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderLanguage=void 0,t.ShaderLanguage=i,function(e){e[e.GLSL=0]="GLSL",e[e.WGSL=1]="WGSL"}(i||(t.ShaderLanguage=i={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getUIHostType=m,t.isTeams=p,t.isTeamsWeb=function(e){return!!p(e)&&(_(e)?g():-1===window.navigator.userAgent.indexOf("Electron"))},t.isTeamsDesktop=function(e){return p(e)&&-1!==window.navigator.userAgent.indexOf("Electron")},t.isPPTO=function(e){return m(e)===a.UnifiedApp||m(e)===a.BlueChicken||m(e)===a.SSCTestApp},t.isMobileWeb=g,t.isHostTypeIOS=v,t.isHostIOS=y,t.isMobileDevice=_,t.updateMediaSyncMetadataAndLog=function(e,t,r){if(r.metadata&&r.metadata.mediaSyncTimeLine){var i="".concat(t,": ").concat(e);r.metadata.mediaSyncTimeLine.push(i),u.ULS.sendTraceTag(542955610,u.LogCategory.msoulscat_Wac_PptLive,u.TraceLevel.Info,JSON.stringify({fileName:t,mediaSyncState:r}))}else u.ULS.sendTraceTag(525103627,u.LogCategory.msoulscat_Wac_PptLive,u.TraceLevel.Info,"".concat(t,"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine."))},t.logPlaybackControlsVeto=function(e){f.VetoUtils.recordVeto("CustomControlFailure",{errorName:e,qosVeto:"CustomControlFailure",isIntentional:!0})},t.StreamPlayerAuthMessagingContext=t.MediaHelper=t.TranscodedMediaQuality=t.UIHostType=t.RenderAs=void 0;var n,a,o,s=i(r(15)),l=i(r(1)),c=i(r(2)),u=r(3),d=r(54),h=r(4),f=r(14);function m(e){return e.settings&&e.settings.uiHost?e.settings.uiHost.toLowerCase().indexOf("msteams")>-1?a.MSTeams:e.settings.uiHost.toLowerCase().indexOf("teamsandroid")>-1?a.TeamsAndroid:e.settings.uiHost.toLowerCase().indexOf("teamsios")>-1?a.TeamsiOS:e.settings.uiHost.toLowerCase().indexOf("unified app")>-1?a.UnifiedApp:e.settings.uiHost.toLowerCase().indexOf("bluechicken")>-1?a.BlueChicken:e.settings.uiHost.toLowerCase().indexOf("ssctestapp")>-1?a.SSCTestApp:(u.ULS.sendTraceTag(543454660,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"MediaHelper::getUIHostType Host type does not match known hosts. uiHost: ".concat(e.settings.uiHost)),a.Unknown):(u.ULS.sendTraceTag(543454659,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"MediaHelper::getUIHostType Unknown host type due to null settings or uiHost"),a.Unknown)}function p(e){return!(!e.settings||!e.settings.uiHost)&&-1!==e.settings.uiHost.toLowerCase().indexOf("teams")}function g(){var e=window.navigator.userAgent||window.navigator.vendor;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))}function v(e){return!!h.Settings.readBooleanOrDefault("iOSHostOverride",!1)||e===a.TeamsiOS}function y(e){return!!h.Settings.readBooleanOrDefault("iOSHostOverride",!1)||v(m(e))}function _(e){return y(e)||m(e)===a.TeamsAndroid||g()}t.RenderAs=n,function(e){e[e.None=0]="None",e[e.Image=1]="Image",e[e.Hlink=2]="Hlink",e[e.Silverlight=3]="Silverlight",e[e.HTML5=4]="HTML5",e[e.FlashObject=5]="FlashObject"}(n||(t.RenderAs=n={})),t.UIHostType=a,function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.BlueChicken=4]="BlueChicken",e[e.SSCTestApp=5]="SSCTestApp",e[e.Unknown=6]="Unknown"}(a||(t.UIHostType=a={})),t.TranscodedMediaQuality=o,function(e){e[e.Low=0]="Low",e[e.Med=1]="Med",e[e.High=2]="High",e[e.Raw=3]="Raw"}(o||(t.TranscodedMediaQuality=o={}));var S=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,null,[{key:"getCanPlayType",value:function(e){var t;if(-1!==e.indexOf("video"))t=document.createElement("video");else{if(-1===e.indexOf("audio"))return u.ULS.sendTraceTag(595637718,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"MediaHelper::getCanPlayType(): Unexpected contentType ".concat(e,".")),"";t=document.createElement("audio")}if(!t)return"";var r="";try{r=t.canPlayType(e)}catch(e){u.ULS.sendTraceTag(595637719,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"MediaHelper::getCanPlayType() throws exception: ".concat(e,"."))}return r}},{key:"getMediaRenderAs",value:function(t){if("application/x-shockwave-flash"===t)return n.FlashObject;var r=e.getCanPlayType(t);return"probably"===r||"maybe"===r||"video/quicktime"===t.toLowerCase()?n.HTML5:n.None}},{key:"getTranscodeMediaQuality",value:function(e,t,r,i){var n=o.Raw,a=o.Raw;h.Settings.readBooleanOrDefault("useNetworkForTranscodedMediaQuality",!0)&&e&&(a=e>=5?o.High:e>=2.5?o.Med:o.Low);var s=o.Low,l=t.y*r.y;t&&(s=l>=900?o.High:l>=600?o.Med:o.Low);var c=_(i),d=c?o.Low:o.High;return n=Math.min(a,s,d),u.ULS.sendTraceTag(527028749,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,JSON.stringify({connectionSpeedInMbps:e,mediaSize:l,isMobile:c,networkBasedQuality:a,sizeBasedQuality:s,deviceBasedQuality:d,selectedMediaQuality:n})),n}},{key:"isStreamURL",value:function(e){try{return new URL(e).hostname.toLowerCase().endsWith("microsoftstream.com")}catch(e){return!1}}},{key:"convertYouTubeFlashUrlToIFrameUrl",value:function(e){var t=e,r=t.indexOf("?");r>=0&&(t=t.substring(0,r));var i="youtube.com/v/".length,n=t.toLowerCase().indexOf("youtube.com/v/");return n>=0?t=t.substring(0,n)+"youtube.com/embed/"+t.substring(n+i,t.length):e}},{key:"fIsSafeHyperlink",value:function(t){var r=document.createElement("a");r.href=t;try{return e.isLinkable(r.href)}catch(e){return!1}}},{key:"stripIgnoredLinkChars",value:function(e){for(var t=0,r=e.length;r>t&&-1!=="#%&*{}:<>?+.;(),!']\"".indexOf(e.charAt(r-1));)r-=1;for(;t<r&&-1!=="(['\"".indexOf(e.charAt(t));)t+=1;return e.substr(t,r-t)}},{key:"isLinkable",value:function(t){var r=["http://","https://","file://","file:\\\\","ftp://","mailto:","news:","\\\\","www.","onenote:"],i=t.toLowerCase();i=e.stripIgnoredLinkChars(i);for(var n=r.length,a=0;a<n;a+=1)if(t.startsWith(r[a]))return!0;return!1}},{key:"controlVersion",value:function(){var e,t;try{e=(t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")).GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e="WIN 6,0,21,0",t.AllowScriptAccess="always",e=t.GetVariable("$version")}catch(e){}if(!e)try{e=(t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3")).GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),e="WIN 3,0,18,0"}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e="WIN 2,0,0,11"}catch(t){e=-1}return e}},{key:"getSwfVer",value:function(){var t=-1!==navigator.appVersion.indexOf("MSIE"),r=-1!==navigator.appVersion.toLowerCase().indexOf("win"),i=-1!==navigator.userAgent.indexOf("Opera"),n="-1";if(null!=navigator.plugins&&navigator.plugins.length>0){if("object"===(0,s.default)(navigator.plugins.namedItem("Shockwave Flash 2.0"))||"object"===(0,s.default)(navigator.plugins.namedItem("Shockwave Flash"))){var a="object"===(0,s.default)(navigator.plugins.namedItem("Shockwave Flash 2.0"))?" 2.0":"",o=navigator.plugins.namedItem("Shockwave Flash".concat(a)).description.split(" "),l=o[2].split("."),c=l[0],u=l[1],d=o[3];""===d&&(d=o[4]),"d"===d[0]?d=d.substring(1):"r"===d[0]&&(d=d.substring(1)).indexOf("d")>0&&(d=d.substring(0,d.indexOf("d"))),n="".concat(c,".").concat(u,".").concat(d)}}else-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?n="4":-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?n="3":-1!==navigator.userAgent.toLowerCase().indexOf("webtv")?n="2":t&&r&&!i&&(n=e.controlVersion());return n}},{key:"fFlashInstalled",get:function(){var t,r=e.getSwfVer();if("-1"===r)return!1;if("0"!==r){var i=(t=-1!==r.indexOf("WIN")?r.split(" ")[1].split(","):r.split("."))[0],n=t[1],a=t[2];if(parseFloat(i)>10)return!0;if(10===parseFloat(i)){if(parseFloat(n)>1)return!0;if(1===parseFloat(n)&&parseFloat(a)>=0)return!0}return!1}return!1}},{key:"parseSeekTimeFromMediaCommandString",value:function(e,t){if(!e)return-1;var r=e.toLowerCase();if(r.length<=0)return-1;var i=r.indexOf("(");if(i<=0)return-1;var n=r.substring(0,i);if(n.length<=0)return-1;var a=r.indexOf(")");if("playfrom"===n){var o=r.substring(i+1,a),s=parseFloat(o);return isNaN(s)?-1:s}if("playfrombookmark"===n){var l=r.substring(i+1,a),c=t.find((function(e){return l.indexOf(e.name.toLowerCase())>=0}));return c?c.time/1e3:-1}return-1}},{key:"getMediaTypeFromContentType",value:function(e){var t=e.indexOf("/");if(t>0)switch(e.substring(0,t)){case"video":return"Video";case"audio":return"Audio";default:return""}return""}},{key:"isBrowserSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}])}();t.MediaHelper=S;var T=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,null,[{key:"setNewStreamPlayer",value:function(t){void 0!==t?e.newStreamPlayer=t:u.ULS.sendTraceTag(543994250,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"StreamAuth: Trying to set newStreamPlayer when newStreamPlayer is undefined")}},{key:"postAadTokenToStream",value:function(e){d.OnlineVideoPlayer.setAADToken(e),void 0===this.newStreamPlayer||this.newStreamPlayer.postAuthToken(e)}}])}();t.StreamPlayerAuthMessagingContext=T,T.newStreamPlayer=void 0},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var n=i(r(15)),a=i(r(1)),o=i(r(2)),s=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"load",value:function(t){e.m_settings=t}},{key:"readBooleanOrDefault",value:function(t,r){var i=void 0===e.m_settings?"":(0,n.default)(e.m_settings[t]);return"string"===i?"true"===e.m_settings[t].toLowerCase():"boolean"===i?e.m_settings[t]:r}},{key:"readNumberOrDefault",value:function(t,r){var i=void 0===e.m_settings?"":(0,n.default)(e.m_settings[t]);return"string"===i||"number"===i?Number(e.m_settings[t]):r}},{key:"readStringOrDefault",value:function(t,r){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?r:e.m_settings[t]}}])}();t.Settings=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ProgramId",{enumerable:!0,get:function(){return s.ProgramId}}),t.FixedMemoryLeakAmounts=t.ScenePerformanceSummary=t.FramePerformanceSummary=t.textureChannelCount=t.TextureFormat=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(41);t.TextureFormat=n,function(e){e[e.RGB=4]="RGB",e[e.RGBA=5]="RGBA",e[e.LUMINANCE=1]="LUMINANCE",e[e.LUMINANCE_ALPHA=2]="LUMINANCE_ALPHA",e[e.BGR=-1]="BGR",e[e.BGRA=-2]="BGRA",e[e.NV12=-3]="NV12"}(n||(t.TextureFormat=n={})),t.textureChannelCount=[0,1,2,0,3,4];var l=(0,o.default)((function e(){(0,a.default)(this,e),this.totalCostMs=0,this.shapeRenderCostMs=0,this.distanceFieldForTextCostMs=0,this.distanceFieldForGlyphTableCostMs=0,this.distanceFieldForShapeCostMs=0,this.patternTextureCostMs=0,this.pathGradientTextureCostMs=0,this.gradientTextureCostMs=0,this.fadeTextureCostMs=0,this.effectsCostMs=0,this.cacheToSpriteCostMs=0,this.drawTapeCostMs=0,this.glResetCostMs=0,this.glRestoreCostMs=0,this.pathCount=0,this.glyphCount=0,this.glyphCountAddedToCache=0,this.glyphCountReadFromCache=0,this.glyphCountRenderedAsPath=0,this.glyphCountLargeText=0,this.glyphCountTextOutline=0,this.pixelCountDistanceField=0,this.pixelCountShapeRender=0,this.shapeLayerCount=0,this.shapeLayerCountText=0,this.dynamicTextureAlloc=0,this.beginTime=0,this.endTime=0}),[{key:"add",value:function(e){this.totalCostMs+=e.totalCostMs,this.shapeRenderCostMs+=e.shapeRenderCostMs,this.distanceFieldForTextCostMs+=e.distanceFieldForTextCostMs,this.distanceFieldForGlyphTableCostMs+=e.distanceFieldForGlyphTableCostMs,this.distanceFieldForShapeCostMs+=e.distanceFieldForShapeCostMs,this.patternTextureCostMs+=e.patternTextureCostMs,this.pathGradientTextureCostMs+=e.pathGradientTextureCostMs,this.gradientTextureCostMs+=e.gradientTextureCostMs,this.fadeTextureCostMs+=e.fadeTextureCostMs,this.effectsCostMs+=e.effectsCostMs,this.cacheToSpriteCostMs+=e.cacheToSpriteCostMs,this.drawTapeCostMs+=e.drawTapeCostMs,this.glResetCostMs+=e.glResetCostMs,this.glRestoreCostMs+=e.glRestoreCostMs,this.pathCount+=e.pathCount,this.glyphCount+=e.glyphCount,this.glyphCountAddedToCache+=e.glyphCountAddedToCache,this.glyphCountReadFromCache+=e.glyphCountReadFromCache,this.glyphCountRenderedAsPath+=e.glyphCountRenderedAsPath,this.glyphCountLargeText+=e.glyphCountLargeText,this.glyphCountTextOutline+=e.glyphCountTextOutline,this.pixelCountDistanceField+=e.pixelCountDistanceField,this.pixelCountShapeRender+=e.pixelCountShapeRender,this.shapeLayerCount+=e.shapeLayerCount,this.shapeLayerCountText+=e.shapeLayerCountText,this.dynamicTextureAlloc+=e.dynamicTextureAlloc,this.beginTime=0,this.endTime=0}}]);t.FramePerformanceSummary=l;var c=(0,o.default)((function e(){(0,a.default)(this,e),this.frameCount=0}));t.ScenePerformanceSummary=c;var u=(0,o.default)((function e(){(0,a.default)(this,e),this.recreatingSprites=0,this.pictureCropBWTextures=0}));t.FixedMemoryLeakAmounts=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(281);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(285);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(113);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(287);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(53);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(74);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(288);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var u=r(152);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}));var d=r(294);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MotionPathCommandType=t.Fade=t.AnimDirConstants=t.FadePreset=t.AnimMediaEffectId=t.AnimEntranceExitEffectId=t.AnimEmphasisEffectId=t.AnimAfterEffectType=t.AnimStartTrig=t.AnimEffectCategory=t.AnimAggregateRule=t.AnimAttributeId=t.AnimEvaluatorId=t.AnimConstants=void 0;var n,a,o,s,l,c,u,d,h,f,m,p,g=i(r(2)),v=i(r(1)),y=i(r(5)),_=(0,g.default)((function e(){(0,v.default)(this,e)}));t.AnimConstants=_,(0,y.default)(_,"Undefined",-1),(0,y.default)(_,"RepeatForever",-1),(0,y.default)(_,"MainTimelineId","0_anim"),(0,y.default)(_,"RepeatUntilClick",-2),(0,y.default)(_,"RepeatUntilEnd",-1),(0,y.default)(_,"Zoom_InFromCenterFactor",.5),(0,y.default)(_,"Zoom_InSlightlyScaleInit",2/3),(0,y.default)(_,"Zoom_OutScaleInit",3),(0,y.default)(_,"Zoom_OutFromBottomScaleFactor",5),(0,y.default)(_,"Zoom_OutSlightlyScaleInit",5/4),(0,y.default)(_,"Boomerang_XOffs",500),(0,y.default)(_,"Boomerang_YOffs1",-200),(0,y.default)(_,"Boomerang_YOffs2",100),(0,y.default)(_,"BoomerangRot",-Math.PI/2),(0,y.default)(_,"Float_XOffs1",350),(0,y.default)(_,"Float_XOffs2",-40),(0,y.default)(_,"Float_YOffs1",-250),(0,y.default)(_,"Float_YOffs2",60),(0,y.default)(_,"FloatRot",-Math.PI/2),(0,y.default)(_,"GrownAndTurn_ScaleInit",.25),(0,y.default)(_,"GrowAndTurn_Rotations",Math.PI/2),(0,y.default)(_,"Ascend_Offs",60),(0,y.default)(_,"Descend_Offs",-60),(0,y.default)(_,"PinWheel_Rotations",3*Math.PI),(0,y.default)(_,"RiseUp_YOffs1",600),(0,y.default)(_,"RiseUp_YOffs2",-20),(0,y.default)(_,"RiseUp_Seg1Fraction",.9),(0,y.default)(_,"Swish_DropFraction",.6),(0,y.default)(_,"Swish_BounceOffs",-40),(0,y.default)(_,"Swish_Theta",-Math.PI/6),(0,y.default)(_,"ThinLine_XOffs",-400),(0,y.default)(_,"ThinLine_HInit",.05),(0,y.default)(_,"ThinLine_WInit",1.4),(0,y.default)(_,"Spinner_Rotations",1*Math.PI),(0,y.default)(_,"Spinner_ScaleInit",.25),(0,y.default)(_,"Whip_MidScale",1.1),(0,y.default)(_,"Whip_XOffs",300),(0,y.default)(_,"Unfold_XOffs",-200),(0,y.default)(_,"Sling_Rot",Math.PI/2),(0,y.default)(_,"Sling_XMid_Offs",-100),(0,y.default)(_,"ExpandWidthFactor",.5),(0,y.default)(_,"CompressWidthFactor",1.75),(0,y.default)(_,"Zip_YOffs_Ratio",.85),(0,y.default)(_,"Zip_Midscale",2.5),(0,y.default)(_,"Glide_XOffs",-40),(0,y.default)(_,"Flip_Rotations",4*Math.PI),(0,y.default)(_,"BezierLengthEstimateDivisions",10),(0,y.default)(_,"Blink_Alpha",0),(0,y.default)(_,"Shimmer_Theta",Math.PI/8),(0,y.default)(_,"Wave_Theta",-Math.PI/8),(0,y.default)(_,"Wave_YOffs",-100),(0,y.default)(_,"FlashBulb_ScaleOffs",1.1),(0,y.default)(_,"FlashBulb_Alpha",.2),(0,y.default)(_,"GrowShrink_DefaultDuration",200),t.AnimEvaluatorId=a,function(e){e[e.None=0]="None",e[e.Constant=1]="Constant",e[e.Linear=2]="Linear",e[e.Bezier=3]="Bezier",e[e.VisTrack=4]="VisTrack",e[e.SmoothHelper=5]="SmoothHelper",e[e.ConstantObject=6]="ConstantObject"}(a||(t.AnimEvaluatorId=a={})),t.AnimAttributeId=o,function(e){e[e.None=0]="None",e[e.Src=1]="Src",e[e.Html=2]="Html",e[e.NativeW=3]="NativeW",e[e.NativeH=4]="NativeH",e[e.ScaleW=5]="ScaleW",e[e.ScaleH=6]="ScaleH",e[e.CropL=7]="CropL",e[e.CropT=8]="CropT",e[e.CropR=9]="CropR",e[e.CropB=10]="CropB",e[e.PosX=11]="PosX",e[e.PosY=12]="PosY",e[e.Alpha=13]="Alpha",e[e.Rotate=14]="Rotate",e[e.Visible=15]="Visible",e[e.RenderAs=16]="RenderAs",e[e.MediaProperties=17]="MediaProperties",e[e.ImageId=43]="ImageId",e[e.ShapeId=44]="ShapeId",e[e.ChildShapeId=45]="ChildShapeId",e[e.ObjectRotationX=46]="ObjectRotationX",e[e.ObjectRotationY=47]="ObjectRotationY",e[e.ObjectRotationZ=48]="ObjectRotationZ",e[e.ObjectScaleX=49]="ObjectScaleX",e[e.ObjectScaleY=50]="ObjectScaleY",e[e.ObjectScaleZ=51]="ObjectScaleZ",e[e.ObjectTranslateX=52]="ObjectTranslateX",e[e.ObjectTranslateY=53]="ObjectTranslateY",e[e.ObjectTranslateZ=54]="ObjectTranslateZ",e[e.ViewRotationX=55]="ViewRotationX",e[e.ViewRotationY=56]="ViewRotationY",e[e.ViewRotationZ=57]="ViewRotationZ",e[e.ViewScaleX=58]="ViewScaleX",e[e.ViewScaleY=59]="ViewScaleY",e[e.ViewScaleZ=60]="ViewScaleZ",e[e.ViewTranslateX=61]="ViewTranslateX",e[e.ViewTranslateY=62]="ViewTranslateY",e[e.ViewTranslateZ=63]="ViewTranslateZ",e[e.LocalRenderingProperties=64]="LocalRenderingProperties",e[e.CropOffsetX=65]="CropOffsetX",e[e.CropOffsetY=66]="CropOffsetY",e[e.Is3DRunning=67]="Is3DRunning",e[e.FadeMaskInfo=68]="FadeMaskInfo",e[e.FadeMaskProgress=69]="FadeMaskProgress",e[e.MediaPlaybackCmd=70]="MediaPlaybackCmd",e[e.EmbeddedAnimId=71]="EmbeddedAnimId",e[e.EmbeddedAnimProgress=72]="EmbeddedAnimProgress"}(o||(t.AnimAttributeId=o={})),t.AnimAggregateRule=s,function(e){e[e.Add=0]="Add",e[e.Mult=1]="Mult",e[e.BaselineOnly=2]="BaselineOnly",e[e.First=3]="First",e[e.Last=4]="Last"}(s||(t.AnimAggregateRule=s={})),t.AnimEffectCategory=l,function(e){e[e.Entrance=0]="Entrance",e[e.Exit=1]="Exit",e[e.MotionPath=2]="MotionPath",e[e.Emphasis=3]="Emphasis",e[e.Media=4]="Media"}(l||(t.AnimEffectCategory=l={})),t.AnimStartTrig=c,function(e){e[e.OnClick=0]="OnClick",e[e.WithPrevious=1]="WithPrevious",e[e.AfterPrevious=2]="AfterPrevious"}(c||(t.AnimStartTrig=c={})),t.AnimAfterEffectType=u,function(e){e[e.None=0]="None",e[e.HideOnNextClick=1]="HideOnNextClick",e[e.HideImmediatelyAfter=2]="HideImmediatelyAfter"}(u||(t.AnimAfterEffectType=u={})),t.AnimEmphasisEffectId=d,function(e){e[e.None=0]="None",e[e.ChangeFillColor=1]="ChangeFillColor",e[e.ChangeFont=2]="ChangeFont",e[e.ChangeFontColor=3]="ChangeFontColor",e[e.ChangeFontSize=4]="ChangeFontSize",e[e.ChangeFontStyle=5]="ChangeFontStyle",e[e.GrowShrink=6]="GrowShrink",e[e.ChangeLineColor=7]="ChangeLineColor",e[e.Spin=8]="Spin",e[e.Transparency=9]="Transparency",e[e.BoldFlash=10]="BoldFlash",e[e.Blast=14]="Blast",e[e.BoldReveal=15]="BoldReveal",e[e.BrushOnColor=16]="BrushOnColor",e[e.BrushOnUnderline=18]="BrushOnUnderline",e[e.ColorBlend=19]="ColorBlend",e[e.ColorWave=20]="ColorWave",e[e.ComplementaryColor=21]="ComplementaryColor",e[e.ComplementaryColor2=22]="ComplementaryColor2",e[e.ContrastingColor=23]="ContrastingColor",e[e.Darken=24]="Darken",e[e.Desaturate=25]="Desaturate",e[e.FlashBulb=26]="FlashBulb",e[e.Flicker=27]="Flicker",e[e.GrowWithColor=28]="GrowWithColor",e[e.Lighten=30]="Lighten",e[e.StyleEmphasis=31]="StyleEmphasis",e[e.Teeter=32]="Teeter",e[e.VerticalHighlight=33]="VerticalHighlight",e[e.Wave=34]="Wave",e[e.Blink=35]="Blink",e[e.Shimmer=36]="Shimmer",e[e.Turntable3D=37]="Turntable3D",e[e.Swing3D=38]="Swing3D",e[e.JumpAndTurn3D=39]="JumpAndTurn3D",e[e.Embedded1=100]="Embedded1",e[e.Embedded2=101]="Embedded2",e[e.Embedded3=102]="Embedded3",e[e.Embedded4=103]="Embedded4",e[e.Embedded5=104]="Embedded5",e[e.Embedded6=105]="Embedded6",e[e.Embedded7=106]="Embedded7",e[e.Embedded8=107]="Embedded8",e[e.Embedded9=108]="Embedded9",e[e.Embedded10=109]="Embedded10",e[e.Embedded11=110]="Embedded11",e[e.Embedded12=111]="Embedded12",e[e.Embedded13=112]="Embedded13",e[e.Embedded14=113]="Embedded14",e[e.Embedded15=114]="Embedded15",e[e.Embedded16=115]="Embedded16",e[e.Embedded17=116]="Embedded17",e[e.Embedded18=117]="Embedded18"}(d||(t.AnimEmphasisEffectId=d={})),t.AnimEntranceExitEffectId=h,function(e){e[e.None=0]="None",e[e.Appear=1]="Appear",e[e.Fly=2]="Fly",e[e.Blinds=3]="Blinds",e[e.Box=4]="Box",e[e.Checkerboard=5]="Checkerboard",e[e.Circle=6]="Circle",e[e.Crawl=7]="Crawl",e[e.Diamond=8]="Diamond",e[e.Dissolve=9]="Dissolve",e[e.Fade=10]="Fade",e[e.FlashOnce=11]="FlashOnce",e[e.Peek=12]="Peek",e[e.Plus=13]="Plus",e[e.RandomBars=14]="RandomBars",e[e.Spiral=15]="Spiral",e[e.Split=16]="Split",e[e.Stretch=17]="Stretch",e[e.Strips=18]="Strips",e[e.Swivel=19]="Swivel",e[e.Wedge=20]="Wedge",e[e.Wheel=21]="Wheel",e[e.Wipe=22]="Wipe",e[e.Zoom=23]="Zoom",e[e.RandomEffects=24]="RandomEffects",e[e.Boomerang=25]="Boomerang",e[e.Bounce=26]="Bounce",e[e.ColorReveal=27]="ColorReveal",e[e.Credits=28]="Credits",e[e.EaseIn=29]="EaseIn",e[e.Float=30]="Float",e[e.GrowAndTurn=31]="GrowAndTurn",e[e.Lightspeed=34]="Lightspeed",e[e.Pinwheel=35]="Pinwheel",e[e.RiseUp=37]="RiseUp",e[e.Swish=38]="Swish",e[e.ThinLine=39]="ThinLine",e[e.Unfold=40]="Unfold",e[e.Whip=41]="Whip",e[e.Ascend=42]="Ascend",e[e.CenterRevolve=43]="CenterRevolve",e[e.FadedSwivel=45]="FadedSwivel",e[e.Descend=47]="Descend",e[e.Sling=48]="Sling",e[e.Spinner=49]="Spinner",e[e.Compress=50]="Compress",e[e.Zip=51]="Zip",e[e.Arcup=52]="Arcup",e[e.FadedZoom=53]="FadedZoom",e[e.Glide=54]="Glide",e[e.Expand=55]="Expand",e[e.Flip=56]="Flip",e[e.Fold=58]="Fold",e[e.Arrive3D=60]="Arrive3D",e[e.FlyIn3D=61]="FlyIn3D",e[e.Draw=63]="Draw"}(h||(t.AnimEntranceExitEffectId=h={})),t.AnimMediaEffectId=f,function(e){e[e.None=0]="None",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e[e.Stop=3]="Stop",e[e.PlayFromBookmark=4]="PlayFromBookmark"}(f||(t.AnimMediaEffectId=f={})),t.FadePreset=m,function(e){e[e.uniform=0]="uniform",e[e.blinds=1]="blinds",e[e.box=2]="box",e[e.checkerBoard=3]="checkerBoard",e[e.circle=4]="circle",e[e.diamond=5]="diamond",e[e.dissolve=6]="dissolve",e[e.plus=7]="plus",e[e.randomBars=8]="randomBars",e[e.split=9]="split",e[e.strips=10]="strips",e[e.wedge=11]="wedge",e[e.wheel=12]="wheel",e[e.draw=13]="draw"}(m||(t.FadePreset=m={})),t.AnimDirConstants=p,function(e){e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=4]="Bottom",e[e.Left=8]="Left",e[e.TopRight=3]="TopRight",e[e.TopLeft=9]="TopLeft",e[e.BottomRight=6]="BottomRight",e[e.BottomLeft=12]="BottomLeft",e[e.In_=16]="In_",e[e.Out=32]="Out",e[e.Ppt_ZoomIn=16]="Ppt_ZoomIn",e[e.Ppt_ZoomOut=32]="Ppt_ZoomOut",e[e.Ppt_ZoomSlightly=256]="Ppt_ZoomSlightly",e[e.Ppt_ZoomCenter=512]="Ppt_ZoomCenter",e[e.Stretch_FromTop=1]="Stretch_FromTop",e[e.Stretch_FromRight=2]="Stretch_FromRight",e[e.Stretch_FromBottom=4]="Stretch_FromBottom",e[e.Stretch_FromLeft=8]="Stretch_FromLeft",e[e.Stretch_Across=10]="Stretch_Across",e[e.Swivel_Vertical=5]="Swivel_Vertical",e[e.Swivel_Horizontal=10]="Swivel_Horizontal",e[e.ComplexClip_BlindsHoriz=10]="ComplexClip_BlindsHoriz",e[e.ComplexClip_BlindsVert=5]="ComplexClip_BlindsVert",e[e.ComplexClip_PlusIn=16]="ComplexClip_PlusIn",e[e.ComplexClip_PlusOut=32]="ComplexClip_PlusOut",e[e.ComplexClip_StripsLeftDown=12]="ComplexClip_StripsLeftDown",e[e.ComplexClip_StripsLeftUp=9]="ComplexClip_StripsLeftUp",e[e.ComplexClip_StripsRightDown=6]="ComplexClip_StripsRightDown",e[e.ComplexClip_StripsRightUp=3]="ComplexClip_StripsRightUp",e[e.ComplexClip_BoxIn=16]="ComplexClip_BoxIn",e[e.ComplexClip_BoxOut=32]="ComplexClip_BoxOut",e[e.ComplexClip_CheckerboardAcross=10]="ComplexClip_CheckerboardAcross",e[e.ComplexClip_CheckerboardDown=5]="ComplexClip_CheckerboardDown",e[e.ComplexClip_RandomBarsHoriz=10]="ComplexClip_RandomBarsHoriz",e[e.ComplexClip_RandomBarsVert=5]="ComplexClip_RandomBarsVert",e[e.ComplexClip_SplitHorizIn=26]="ComplexClip_SplitHorizIn",e[e.ComplexClip_SplitHorizOut=42]="ComplexClip_SplitHorizOut",e[e.ComplexClip_SplitVertIn=21]="ComplexClip_SplitVertIn",e[e.ComplexClip_SplitVertOut=37]="ComplexClip_SplitVertOut",e[e.ComplexClip_WipeUp=1]="ComplexClip_WipeUp",e[e.ComplexClip_WipeDown=4]="ComplexClip_WipeDown",e[e.ComplexClip_WipeLeft=8]="ComplexClip_WipeLeft",e[e.ComplexClip_WipeRight=2]="ComplexClip_WipeRight",e[e.ComplexClip_Wheel1=1]="ComplexClip_Wheel1",e[e.ComplexClip_Wheel2=2]="ComplexClip_Wheel2",e[e.ComplexClip_Wheel3=3]="ComplexClip_Wheel3",e[e.ComplexClip_Wheel4=4]="ComplexClip_Wheel4",e[e.ComplexClip_Wheel8=8]="ComplexClip_Wheel8",e[e.ComplexClip_CircleIn=16]="ComplexClip_CircleIn",e[e.ComplexClip_CircleOut=32]="ComplexClip_CircleOut",e[e.ComplexClip_DiamondIn=16]="ComplexClip_DiamondIn",e[e.ComplexClip_DiamondOut=32]="ComplexClip_DiamondOut",e[e.Zoom_In=0]="Zoom_In",e[e.Zoom_InFromCenter=1]="Zoom_InFromCenter",e[e.Zoom_InSlightly=2]="Zoom_InSlightly",e[e.Zoom_Out=3]="Zoom_Out",e[e.Zoom_OutFromBottom=4]="Zoom_OutFromBottom",e[e.Zoom_OutSlightly=5]="Zoom_OutSlightly",e[e.ObjRotLeft=2]="ObjRotLeft",e[e.ObjRotRight=4]="ObjRotRight",e[e.ObjRotBack=8]="ObjRotBack",e[e.ObjRotFront=16]="ObjRotFront",e[e.ObjRotCounterclockwise=32]="ObjRotCounterclockwise",e[e.ObjRotClockwise=64]="ObjRotClockwise",e[e.ViewRotRight=128]="ViewRotRight",e[e.ViewRotLeft=256]="ViewRotLeft",e[e.ViewRotUp=512]="ViewRotUp",e[e.ViewRotDown=1024]="ViewRotDown",e[e.ViewRotClockwise=2048]="ViewRotClockwise",e[e.ViewRotCounterclockwise=4096]="ViewRotCounterclockwise",e[e.ObjTransLeft=8192]="ObjTransLeft",e[e.ObjTransRight=16384]="ObjTransRight",e[e.ObjTransUp=32768]="ObjTransUp",e[e.ObjTransDown=65536]="ObjTransDown",e[e.ObjTransBack=131072]="ObjTransBack",e[e.ObjTransFront=262144]="ObjTransFront",e[e.ViewTransRight=524288]="ViewTransRight",e[e.ViewTransLeft=1048576]="ViewTransLeft",e[e.ViewTransUp=2097152]="ViewTransUp",e[e.ViewTransDown=4194304]="ViewTransDown",e[e.ViewTransBack=8388608]="ViewTransBack",e[e.ViewTransFront=16777216]="ViewTransFront",e[e.DrawProgress=0]="DrawProgress",e[e.DrawProgressAllAtOnce=1]="DrawProgressAllAtOnce"}(p||(t.AnimDirConstants=p={}));var S,T=(0,g.default)((function e(){(0,v.default)(this,e)}));t.Fade=T,n=T,(0,y.default)(T,"Transpose",1),(0,y.default)(T,"Invert",2),(0,y.default)(T,"FlipHorz",4),(0,y.default)(T,"FlipVert",8),(0,y.default)(T,"IsDistributedByLength",16),(0,y.default)(T,"EffectMap",[{FxId:h.Split,Dir:p.ComplexClip_SplitVertIn,Preset:m.split,Param:0,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Split,Dir:p.ComplexClip_SplitVertOut,Preset:m.split,Param:0,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Split,Dir:p.ComplexClip_SplitHorizIn,Preset:m.split,Param:0,EntFlags:n.Transpose,ExitFlags:n.Transpose|n.Invert},{FxId:h.Split,Dir:p.ComplexClip_SplitHorizOut,Preset:m.split,Param:0,EntFlags:n.Transpose|n.Invert,ExitFlags:n.Transpose},{FxId:h.Blinds,Dir:p.ComplexClip_BlindsHoriz,Preset:m.blinds,Param:6,EntFlags:n.Transpose,ExitFlags:n.Transpose},{FxId:h.Blinds,Dir:p.ComplexClip_BlindsVert,Preset:m.blinds,Param:6,EntFlags:0,ExitFlags:0},{FxId:h.Checkerboard,Dir:p.ComplexClip_CheckerboardAcross,Preset:m.checkerBoard,Param:6,EntFlags:0,ExitFlags:0},{FxId:h.Checkerboard,Dir:p.ComplexClip_CheckerboardDown,Preset:m.checkerBoard,Param:6,EntFlags:n.Transpose,ExitFlags:n.Transpose},{FxId:h.Circle,Dir:p.ComplexClip_CircleIn,Preset:m.circle,Param:0,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Circle,Dir:p.ComplexClip_CircleOut,Preset:m.circle,Param:0,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Diamond,Dir:p.ComplexClip_DiamondIn,Preset:m.diamond,Param:0,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Diamond,Dir:p.ComplexClip_DiamondOut,Preset:m.diamond,Param:0,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Plus,Dir:p.ComplexClip_PlusIn,Preset:m.plus,Param:0,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Plus,Dir:p.ComplexClip_PlusOut,Preset:m.plus,Param:0,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Dissolve,Dir:0,Preset:m.dissolve,Param:0,EntFlags:0,ExitFlags:0},{FxId:h.Fade,Dir:0,Preset:m.uniform,Param:0,EntFlags:0,ExitFlags:0},{FxId:h.RandomBars,Dir:p.ComplexClip_RandomBarsHoriz,Preset:m.randomBars,Param:0,EntFlags:n.Transpose,ExitFlags:n.Transpose},{FxId:h.RandomBars,Dir:p.ComplexClip_RandomBarsVert,Preset:m.randomBars,Param:0,EntFlags:0,ExitFlags:0},{FxId:h.Box,Dir:p.ComplexClip_BoxIn,Preset:m.box,Param:0,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Box,Dir:p.ComplexClip_BoxOut,Preset:m.box,Param:0,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Strips,Dir:p.ComplexClip_StripsLeftUp,Preset:m.strips,Param:16,EntFlags:n.Invert,ExitFlags:n.Invert},{FxId:h.Strips,Dir:p.ComplexClip_StripsLeftDown,Preset:m.strips,Param:16,EntFlags:n.FlipHorz,ExitFlags:n.FlipHorz},{FxId:h.Strips,Dir:p.ComplexClip_StripsRightUp,Preset:m.strips,Param:16,EntFlags:n.FlipVert,ExitFlags:n.FlipVert},{FxId:h.Strips,Dir:p.ComplexClip_StripsRightDown,Preset:m.strips,Param:16,EntFlags:0,ExitFlags:0},{FxId:h.Wedge,Dir:0,Preset:m.wedge,Param:2,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Wheel,Dir:p.ComplexClip_Wheel1,Preset:m.wheel,Param:1,EntFlags:0,ExitFlags:n.FlipHorz},{FxId:h.Wheel,Dir:p.ComplexClip_Wheel2,Preset:m.wheel,Param:2,EntFlags:0,ExitFlags:n.FlipHorz},{FxId:h.Wheel,Dir:p.ComplexClip_Wheel3,Preset:m.wheel,Param:3,EntFlags:0,ExitFlags:n.FlipHorz},{FxId:h.Wheel,Dir:p.ComplexClip_Wheel4,Preset:m.wheel,Param:4,EntFlags:0,ExitFlags:n.FlipHorz},{FxId:h.Wheel,Dir:p.ComplexClip_Wheel8,Preset:m.wheel,Param:8,EntFlags:0,ExitFlags:n.FlipHorz},{FxId:h.Wipe,Dir:p.ComplexClip_WipeUp,Preset:m.blinds,Param:1,EntFlags:n.Transpose,ExitFlags:n.Transpose|n.Invert},{FxId:h.Wipe,Dir:p.ComplexClip_WipeDown,Preset:m.blinds,Param:1,EntFlags:n.Transpose|n.Invert,ExitFlags:n.Transpose},{FxId:h.Wipe,Dir:p.ComplexClip_WipeLeft,Preset:m.blinds,Param:1,EntFlags:0,ExitFlags:n.Invert},{FxId:h.Wipe,Dir:p.ComplexClip_WipeRight,Preset:m.blinds,Param:1,EntFlags:n.Invert,ExitFlags:0},{FxId:h.Draw,Dir:p.DrawProgress,Preset:m.draw,Param:0,EntFlags:n.IsDistributedByLength,ExitFlags:n.IsDistributedByLength},{FxId:h.Draw,Dir:p.DrawProgressAllAtOnce,Preset:m.draw,Param:0,EntFlags:0,ExitFlags:0}]),t.MotionPathCommandType=S,function(e){e[e.MoveTo=0]="MoveTo",e[e.LineTo=1]="LineTo",e[e.CurveTo=2]="CurveTo"}(S||(t.MotionPathCommandType=S={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={setVideoLogger:!0,createSvgPlayButton:!0,PLAYBUTTON_LENGTH:!0,getProviderName:!0,requestOEmbedProviderList:!0,setSettingCallbacks:!0};Object.defineProperty(t,"setVideoLogger",{enumerable:!0,get:function(){return l.setVideoLogger}}),Object.defineProperty(t,"createSvgPlayButton",{enumerable:!0,get:function(){return c.createSvgPlayButton}}),Object.defineProperty(t,"PLAYBUTTON_LENGTH",{enumerable:!0,get:function(){return u.PLAYBUTTON_LENGTH}}),Object.defineProperty(t,"getProviderName",{enumerable:!0,get:function(){return d.getProviderName}}),Object.defineProperty(t,"requestOEmbedProviderList",{enumerable:!0,get:function(){return d.requestOEmbedProviderList}}),Object.defineProperty(t,"setSettingCallbacks",{enumerable:!0,get:function(){return h.setSettingCallbacks}});var n=r(156);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var a=r(304);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}));var o=r(320);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var s=r(157);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var l=r(17),c=r(167),u=r(43),d=r(115),h=r(44)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaTransition=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(8)),c=i(r(10)),u=r(28),d=r(22),h=r(29),f=r(23),m=r(93),p=r(32);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t=(0,l.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var _=(0,u.defaultViewModelMatrix)(),S=function(e){function t(){var e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,a.default)(this,t),(e=y(this,t)).delayDuration=0,e.style=1,e.autoClear=r,e}return(0,c.default)(t,e),(0,o.default)(t,[{key:"internalInit",value:function(e){var t=this.getDrawInfo(d.ProgramId.alpha,[h.aPosition,h.aTexcoord,h.aDelay]);if(t)return this.delayDuration=e.delayFormula==p.DelayFormula.None?0:1,this.textureInfo={incomingSlideTexture:t.incomingSlideTexture,outgoingSlideTexture:t.outgoingSlideTexture},v(v({},t),{},{autoClear:this.autoClear})}},{key:"internalDraw",value:function(e,t,r){this.autoClear&&(0,f.setDepthBlendCulling)(r.engine);var i=e*(this.delayDuration+1/t.factor+t.jitter/100),n=(0,f.bindDrawInfo)(r);n.setFloat("uStyle",this.style),n.setMatrix("uModelViewProj",_),n.setFloat("uProgress",i),n.setFloat("uFactor",t.factor);var a=r.incomingSlideTexture,o=r.outgoingSlideTexture;return n._bindTexture("uSampler1",t.forward?o:a),n._bindTexture("uSampler2",t.forward?a:o),(0,f.drawTriangles)(r),!0}},{key:"getTextureInfo",value:function(){return this.textureInfo}}])}(m.Transition);t.AlphaTransition=S},function(e,t,r){var i=r(434),n=i.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=o),o.prototype=Object.create(n.prototype),a(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,r){"use strict";var i,n=r(0)(r(15));i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":(0,n.default)(window))&&(i=window)}e.exports=i},function(e,t,r){var i=r(344),n=r(345),a=n;a.v1=i,a.v4=n,e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notifyIfDifferent=function(e,t,r){t!=r&&e.notifyChange()},t.notifyIfNotEquals=function(e,t,r){t==r||t&&r&&t.equals(r)||e.notifyChange()},t.notifyIfDifferentArray=function(e,t,r){if(t!=r)if(t&&r&&t.length==r.length){for(var i=0;i<t.length;i++)if(t[i]!=r[i])return void e.notifyChange()}else e.notifyChange()},t.notifyIfNotEqualsArray=function(e,t,r){if(t!=r)if(t&&r&&t.length==r.length){for(var i=0;i<t.length;i++)if(!t[i].equals(r[i]))return void e.notifyChange()}else e.notifyChange()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._ConcatenateShader=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r+(t?t+"\n":"")+e},t._loadFile=function(e,t,r,n,o,s,l){var c=l||a.loadFile;if(c)return c(e,t,r,n,o,s);throw(0,i._WarnImport)("FileTools")},t.getHostDocument=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e&&e.ownerDocument?e.ownerDocument:(0,n.IsDocumentAvailable)()?document:null},t._getGlobalDefines=function(e,t,r,i){if(e)return t?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,r?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(i?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);var n="";return t&&(n+="#define IS_NDC_HALF_ZRANGE"),r&&(n&&(n+="\n"),n+="#define USE_REVERSE_DEPTHBUFFER"),i&&(n&&(n+="\n"),n+="#define USE_EXACT_SRGB_CONVERSIONS"),n},t.EngineFunctionContext=void 0;var i=r(107),n=r(71),a={};t.EngineFunctionContext=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var n=i(r(18)),a=i(r(1)),o=i(r(2)),s=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"_CheckLimit",value:function(t,r){var i=e._LogLimitOutputs[t];return i?i.current++:(i={limit:r,current:1},e._LogLimitOutputs[t]=i),i.current<=i.limit}},{key:"_GenerateLimitMessage",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e._LogLimitOutputs[t];if(i&&e.MessageLimitReached){var n,a=this._Levels[r];i.current===i.limit&&e[a.name](e.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,null!==(n=a.name)&&void 0!==n?n:""))}}},{key:"_AddLogEntry",value:function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)}},{key:"_FormatMessage",value:function(e){var t=function(e){return e<10?"0"+e:""+e},r=new Date;return"["+t(r.getHours())+":"+t(r.getMinutes())+":"+t(r.getSeconds())+"]: "+e}},{key:"_LogDisabled",value:function(e,t){}},{key:"_LogEnabled",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=Array.isArray(r)?r[0]:r;if(void 0===i||e._CheckLimit(a,i)){var o=e._FormatMessage(a),s=this._Levels[t],l=Array.isArray(r)?r.slice(1):[];s.logFunc&&s.logFunc.apply(s,["BJS - "+o].concat((0,n.default)(l)));var c="<div style='color:".concat(s.color,"'>").concat(o,"</div><br>");e._AddLogEntry(c),e._GenerateLimitMessage(a,t)}}},{key:"LogCache",get:function(){return e._LogCache}},{key:"ClearLogCache",value:function(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0}},{key:"LogLevels",set:function(t){var r=this;e.Log=e._LogDisabled,e.Warn=e._LogDisabled,e.Error=e._LogDisabled,[e.MessageLogLevel,e.WarningLogLevel,e.ErrorLogLevel].forEach((function(i){(t&i)===i&&(e[r._Levels[i].name]=e._LogEnabled.bind(e,i))}))}}])}();t.Logger=s,s.NoneLogLevel=0,s.MessageLogLevel=1,s.WarningLogLevel=2,s.ErrorLogLevel=4,s.AllLogLevel=7,s.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",s._LogCache="",s._LogLimitOutputs={},s._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],s.errorsCount=0,s.Log=s._LogEnabled.bind(s,s.MessageLogLevel),s.Warn=s._LogEnabled.bind(s,s.WarningLogLevel),s.Error=s._LogEnabled.bind(s,s.ErrorLogLevel)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ThinEngine=void 0;var n=i(r(15)),a=i(r(9)),o=i(r(31)),s=i(r(8)),l=i(r(10)),c=i(r(2)),u=i(r(1)),d=r(87),h=r(236),f=r(61),m=r(71),p=r(134),g=r(135),v=r(237),y=r(238),_=r(137),S=r(110),T=r(48),b=r(40),C=r(88),w=r(60),P=r(106);function I(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return k(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function E(e,t,r){return t=(0,s.default)(t),(0,a.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var x=(0,c.default)((function e(){(0,u.default)(this,e)})),L=function(e){function t(e,r,i,n){var o;if((0,u.default)(this,t),i=i||{},(o=E(this,t,[null!=r?r:i.antialias,i,n]))._name="WebGL",o.forcePOTTextures=!1,o.validateShaderPrograms=!1,o.disableUniformBuffers=!1,o._webGLVersion=1,o._vertexAttribArraysEnabled=[],o._uintIndicesCurrentlySet=!1,o._currentBoundBuffer=new Array,o._currentFramebuffer=null,o._dummyFramebuffer=null,o._currentBufferPointers=new Array,o._currentInstanceLocations=new Array,o._currentInstanceBuffers=new Array,o._vaoRecordInProgress=!1,o._mustWipeVertexAttributes=!1,o._nextFreeTextureSlots=new Array,o._maxSimultaneousTextures=0,o._maxMSAASamplesOverride=null,o._unpackFlipYCached=null,o.enableUnpackFlipYCached=!0,o._boundUniforms={},!e)return(0,a.default)(o);var s=null;if(e.getContext){if(s=e,o._renderingCanvas=s,void 0===i.preserveDrawingBuffer&&(i.preserveDrawingBuffer=!1),void 0===i.xrCompatible&&(i.xrCompatible=!1),navigator&&navigator.userAgent){o._setupMobileChecks();var l,c=navigator.userAgent,h=I(t.ExceptionList);try{for(h.s();!(l=h.n()).done;){var m=l.value,v=m.key,y=m.targets;if(new RegExp(v).test(c)){if(m.capture&&m.captureConstraint){var _=m.capture,S=m.captureConstraint,T=new RegExp(_).exec(c);if(T&&T.length>0&&parseInt(T[T.length-1])>=S)continue}var b,C=I(y);try{for(C.s();!(b=C.n()).done;)switch(b.value){case"uniformBuffer":o.disableUniformBuffers=!0;break;case"vao":o.disableVertexArrayObjects=!0;break;case"antialias":i.antialias=!1;break;case"maxMSAASamples":o._maxMSAASamplesOverride=1}}catch(e){C.e(e)}finally{C.f()}}}}catch(e){h.e(e)}finally{h.f()}}if(o._doNotHandleContextLost||(o._onContextLost=function(e){e.preventDefault(),o._contextWasLost=!0,f.Logger.Warn("WebGL context lost."),o.onContextLostObservable.notifyObservers(o)},o._onContextRestored=function(){o._restoreEngineAfterContextLost((function(){return o._initGLContext()}))},s.addEventListener("webglcontextlost",o._onContextLost,!1),s.addEventListener("webglcontextrestored",o._onContextRestored,!1),i.powerPreference=i.powerPreference||"high-performance"),o._badDesktopOS&&(i.xrCompatible=!1),!i.disableWebGL2Support)try{o._gl=s.getContext("webgl2",i)||s.getContext("experimental-webgl2",i),o._gl&&(o._webGLVersion=2,o._shaderPlatformName="WEBGL2",o._gl.deleteQuery||(o._webGLVersion=1,o._shaderPlatformName="WEBGL1"))}catch(e){}if(!o._gl){if(!s)throw new Error("The provided canvas is null or undefined.");try{o._gl=s.getContext("webgl",i)||s.getContext("experimental-webgl",i)}catch(e){throw new Error("WebGL not supported")}}if(!o._gl)throw new Error("WebGL not supported")}else{o._gl=e,o._renderingCanvas=o._gl.canvas,o._gl.renderbufferStorageMultisample?(o._webGLVersion=2,o._shaderPlatformName="WEBGL2"):o._shaderPlatformName="WEBGL1";var w=o._gl.getContextAttributes();w&&(i.stencil=w.stencil)}o._gl.pixelStorei(o._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,o._gl.NONE),void 0!==i.useHighPrecisionFloats&&(o._highPrecisionShadersAllowed=i.useHighPrecisionFloats),o.resize(),o._initGLContext(),o._initFeatures();for(var P=0;P<o._caps.maxVertexAttribs;P++)o._currentBufferPointers[P]=new x;o._shaderProcessor=o.webGLVersion>1?new g.WebGL2ShaderProcessor:new p.WebGLShaderProcessor;var k="Babylon.js v".concat(t.Version);f.Logger.Log(k+" - ".concat(o.description)),o._renderingCanvas&&o._renderingCanvas.setAttribute&&o._renderingCanvas.setAttribute("data-engine",k);var L=(0,d.getStateObject)(o._gl);return L.validateShaderPrograms=o.validateShaderPrograms,L.parallelShaderCompile=o._caps.parallelShaderCompile,o}return(0,l.default)(t,e),(0,c.default)(t,[{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"version",get:function(){return this._webGLVersion}},{key:"supportsUniformBuffers",get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers}},{key:"needPOTTextures",get:function(){return this._webGLVersion<2||this.forcePOTTextures}},{key:"_supportsHardwareTextureRescaling",get:function(){return!1}},{key:"framebufferDimensionsObject",set:function(e){this._framebufferDimensionsObject=e}},{key:"snapshotRenderingReset",value:function(){this.snapshotRendering=!1}},{key:"_clearEmptyResources",value:function(){this._dummyFramebuffer=null,(0,o.default)((0,s.default)(t.prototype),"_clearEmptyResources",this).call(this)}},{key:"_getShaderProcessingContext",value:function(e){return null}},{key:"areAllEffectsReady",value:function(){for(var e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0}},{key:"_initGLContext",value:function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),supportFloatTexturesResolve:!1,rg11b10ufColorRenderable:!1,colorBufferHalfFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_half_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),texelFetch:1!==this._webGLVersion,blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS):128,disableMorphTargetTexture:!1},this._caps.supportFloatTexturesResolve=this._caps.colorBufferFloat,this._caps.rg11b10ufColorRenderable=this._caps.colorBufferFloat,this._glVersion=this._gl.getParameter(this._gl.VERSION);var e,t=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=t&&(this._glRenderer=this._gl.getParameter(t.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(t.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=(null!==(e=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))&&void 0!==e?e:0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{var r=this._gl.getExtension("WEBGL_draw_buffers");if(null!==r){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=r.drawBuffersWEBGL.bind(r),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var i=0;i<16;i++)this._gl["COLOR_ATTACHMENT"+i+"_WEBGL"]=r["COLOR_ATTACHMENT"+i+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var n=this._gl.getExtension("WEBGL_depth_texture");null!=n&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=n.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var a=this._gl.getExtension("OES_vertex_array_object");null!=a&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=a.createVertexArrayOES.bind(a),this._gl.bindVertexArray=a.bindVertexArrayOES.bind(a),this._gl.deleteVertexArray=a.deleteVertexArrayOES.bind(a))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var o=this._gl.getExtension("ANGLE_instanced_arrays");null!=o?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=o.drawArraysInstancedANGLE.bind(o),this._gl.drawElementsInstanced=o.drawElementsInstancedANGLE.bind(o),this._gl.vertexAttribDivisor=o.vertexAttribDivisorANGLE.bind(o)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),l=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&l&&(this._caps.highPrecisionShaderSupported=0!==s.precision&&0!==l.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var c=this._gl.getExtension("EXT_blend_minmax");null!=c&&(this._caps.blendMinMax=!0,this._gl.MAX=c.MAX_EXT,this._gl.MIN=c.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:WebGL2RenderingContext.SRGB,SRGB8:WebGL2RenderingContext.SRGB8,SRGB8_ALPHA8:WebGL2RenderingContext.SRGB8_ALPHA8};else{var u=this._gl.getExtension("EXT_sRGB");null!=u&&(this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:u.SRGB_EXT,SRGB8:u.SRGB_ALPHA_EXT,SRGB8_ALPHA8:u.SRGB_ALPHA_EXT})}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var d=0;d<this._maxSimultaneousTextures;d++)this._nextFreeTextureSlots.push(d);"Mali-G72"===this._glRenderer&&(this._caps.disableMorphTargetTexture=!0)}},{key:"_initFeatures",value:function(){this._features={forceBitmapOverHTMLImageElement:"undefined"==typeof HTMLImageElement,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,forceVertexBufferStrideAndOffsetMultiple4Bytes:!1,_checkNonFloatVertexBuffersDontRecreatePipelineContext:!1,_collectUbosUpdatedInFrame:!1}}},{key:"webGLVersion",get:function(){return this._webGLVersion}},{key:"getClassName",value:function(){return"ThinEngine"}},{key:"_prepareWorkingCanvas",value:function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}}},{key:"getInfo",value:function(){return this.getGlInfo()}},{key:"getGlInfo",value:function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}},{key:"extractDriverInfo",value:function(){var e=this.getGlInfo();return e&&e.renderer?e.renderer:""}},{key:"getRenderWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}},{key:"getRenderHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight}},{key:"clear",value:function(e,r,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=a;var o=0;if(r&&e){var s=!0;if(this._currentRenderTarget){var l,c=null===(l=this._currentRenderTarget.texture)||void 0===l?void 0:l.format;if(8===c||9===c||10===c||11===c){var u,d=null===(u=this._currentRenderTarget.texture)||void 0===u?void 0:u.type;7===d||5===d?(t._TempClearColorUint32[0]=255*e.r,t._TempClearColorUint32[1]=255*e.g,t._TempClearColorUint32[2]=255*e.b,t._TempClearColorUint32[3]=255*e.a,this._gl.clearBufferuiv(this._gl.COLOR,0,t._TempClearColorUint32),s=!1):(t._TempClearColorInt32[0]=255*e.r,t._TempClearColorInt32[1]=255*e.g,t._TempClearColorInt32[2]=255*e.b,t._TempClearColorInt32[3]=255*e.a,this._gl.clearBufferiv(this._gl.COLOR,0,t._TempClearColorInt32),s=!1)}}s&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),o|=this._gl.COLOR_BUFFER_BIT)}i&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),o|=this._gl.DEPTH_BUFFER_BIT),n&&(this._gl.clearStencil(0),o|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(o)}},{key:"_viewport",value:function(e,t,r,i){e===this._viewportCached.x&&t===this._viewportCached.y&&r===this._viewportCached.z&&i===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=r,this._viewportCached.w=i,this._gl.viewport(e,t,r,i))}},{key:"endFrame",value:function(){(0,o.default)((0,s.default)(t.prototype),"endFrame",this).call(this),this._badOS&&this.flushFramebuffer()}},{key:"performanceMonitor",get:function(){throw new Error("Not Supported by ThinEngine")}},{key:"bindFramebuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(s._MSAAFramebuffer?s._MSAAFramebuffer:s._framebuffer);var l,c=this._gl;if(!e.isMulti)if(e.is2DArray||e.is3D)c.framebufferTextureLayer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,null===(l=e.texture._hardwareTexture)||void 0===l?void 0:l.underlyingResource,a,o);else if(e.isCube){var u;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(u=e.texture._hardwareTexture)||void 0===u?void 0:u.underlyingResource,a)}else if(s._currentLOD!==a){var d;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null===(d=e.texture._hardwareTexture)||void 0===d?void 0:d.underlyingResource,a),s._currentLOD=a}var h=e._depthStencilTexture;if(h){e.is3D&&(e.texture.width===h.width&&e.texture.height===h.height&&e.texture.depth===h.depth||f.Logger.Warn("Depth/Stencil attachment for 3D target must have same dimensions as color attachment"));var m,p=e._depthStencilTextureWithStencil?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT;if(e.is2DArray||e.is3D)c.framebufferTextureLayer(c.FRAMEBUFFER,p,null===(m=h._hardwareTexture)||void 0===m?void 0:m.underlyingResource,a,o);else if(e.isCube){var g;c.framebufferTexture2D(c.FRAMEBUFFER,p,c.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(g=h._hardwareTexture)||void 0===g?void 0:g.underlyingResource,a)}else{var v;c.framebufferTexture2D(c.FRAMEBUFFER,p,c.TEXTURE_2D,null===(v=h._hardwareTexture)||void 0===v?void 0:v.underlyingResource,a)}}this._cachedViewport&&!n?this.setViewport(this._cachedViewport,r,i):(r||(r=e.width,a&&(r/=Math.pow(2,a))),i||(i=e.height,a&&(i/=Math.pow(2,a))),this._viewport(0,0,r,i)),this.wipeCaches()}},{key:"setState",value:function(e){var t,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;(this._depthCullingState.cull!==e||n)&&(this._depthCullingState.cull=e);var c=null===(t=null!==(r=this.cullBackFaces)&&void 0!==r?r:o)||void 0===t||t?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==c||n)&&(this._depthCullingState.cullFace=c),this.setZOffset(i),this.setZOffsetUnits(l);var u=a?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==u||n)&&(this._depthCullingState.frontFace=u),this._stencilStateComposer.stencilMaterial=s}},{key:"_bindUnboundFramebuffer",value:function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)}},{key:"_currentFrameBufferIsDefaultFrameBuffer",value:function(){return null===this._currentFramebuffer}},{key:"generateMipmaps",value:function(e){var t=this._getTextureTarget(e);this._bindTextureDirectly(t,e,!0),this._gl.generateMipmap(t),this._bindTextureDirectly(t,null)}},{key:"unBindFramebuffer",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=e;this._currentRenderTarget=null;var a=this._gl;if(n._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,r,i);a.bindFramebuffer(a.READ_FRAMEBUFFER,n._MSAAFramebuffer),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,n._framebuffer),a.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,a.COLOR_BUFFER_BIT,a.NEAREST)}null===(t=e.texture)||void 0===t||!t.generateMipMaps||r||e.isCube||this.generateMipmaps(e.texture),i&&(n._MSAAFramebuffer&&this._bindUnboundFramebuffer(n._framebuffer),i()),this._bindUnboundFramebuffer(null)}},{key:"flushFramebuffer",value:function(){this._gl.flush()}},{key:"restoreDefaultFramebuffer",value:function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()}},{key:"_resetVertexBufferBinding",value:function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null}},{key:"createVertexBuffer",value:function(e,t,r){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)}},{key:"_createVertexBuffer",value:function(e,t){var r=this._gl.createBuffer();if(!r)throw new Error("Unable to create vertex buffer");var i=new v.WebGLDataBuffer(r);return this.bindArrayBuffer(i),"number"!=typeof e?e instanceof Array?(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t),i.capacity=4*e.length):(this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),i.capacity=e.byteLength):(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Uint8Array(e),t),i.capacity=e),this._resetVertexBufferBinding(),i.references=1,i}},{key:"createDynamicVertexBuffer",value:function(e,t){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)}},{key:"_resetIndexBufferBinding",value:function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null}},{key:"createIndexBuffer",value:function(e,t,r){var i=this._gl.createBuffer(),n=new v.WebGLDataBuffer(i);if(!i)throw new Error("Unable to create index buffer");this.bindIndexBuffer(n);var a=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),n.references=1,n.is32Bits=4===a.BYTES_PER_ELEMENT,n}},{key:"_normalizeIndexData",value:function(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)}},{key:"bindArrayBuffer",value:function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)}},{key:"bindUniformBlock",value:function(e,t,r){var i=e.program,n=this._gl.getUniformBlockIndex(i,t);this._gl.uniformBlockBinding(i,n,r)}},{key:"bindIndexBuffer",value:function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)}},{key:"_bindBuffer",value:function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)}},{key:"updateArrayBuffer",value:function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)}},{key:"_vertexAttribPointer",value:function(e,t,r,i,n,a,o){var s=this._currentBufferPointers[t];if(s){var l=!1;s.active?(s.buffer!==e&&(s.buffer=e,l=!0),s.size!==r&&(s.size=r,l=!0),s.type!==i&&(s.type=i,l=!0),s.normalized!==n&&(s.normalized=n,l=!0),s.stride!==a&&(s.stride=a,l=!0),s.offset!==o&&(s.offset=o,l=!0)):(l=!0,s.active=!0,s.index=t,s.size=r,s.type=i,s.normalized=n,s.stride=a,s.offset=o,s.buffer=e),(l||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),i===this._gl.UNSIGNED_INT||i===this._gl.INT?this._gl.vertexAttribIPointer(t,r,i,a,o):this._gl.vertexAttribPointer(t,r,i,n,a,o))}}},{key:"_bindIndexBufferWithCache",value:function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)}},{key:"_bindVertexBuffersAttributes",value:function(e,t,r){var i=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var n=0;n<i.length;n++){var a=t.getAttributeLocation(n);if(a>=0){var o=i[n],s=null;if(r&&(s=r[o]),s||(s=e[o]),!s)continue;this._gl.enableVertexAttribArray(a),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[a]=!0);var l=s.getBuffer();l&&(this._vertexAttribPointer(l,a,s.getSize(),s.type,s.normalized,s.byteStride,s.byteOffset),s.getIsInstanced()&&(this._gl.vertexAttribDivisor(a,s.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(a),this._currentInstanceBuffers.push(l))))}}}},{key:"recordVertexArrayObject",value:function(e,t,r,i){var n=this._gl.createVertexArray();if(!n)throw new Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(n),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,r,i),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),n}},{key:"bindVertexArrayObject",value:function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)}},{key:"bindBuffersDirectly",value:function(e,t,r,i,n){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==n){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=n;var a=n.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var o=0,s=0;s<a;s++)if(s<r.length){var l=n.getAttributeLocation(s);l>=0&&(this._gl.enableVertexAttribArray(l),this._vertexAttribArraysEnabled[l]=!0,this._vertexAttribPointer(e,l,r[s],this._gl.FLOAT,!1,i,o)),o+=4*r[s]}}this._bindIndexBufferWithCache(t)}},{key:"_unbindVertexArrayObject",value:function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}},{key:"bindBuffers",value:function(e,t,r,i){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===r||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=r,this._bindVertexBuffersAttributes(e,r,i)),this._bindIndexBufferWithCache(t)}},{key:"unbindInstanceAttributes",value:function(){for(var e,t=0,r=this._currentInstanceLocations.length;t<r;t++){var i=this._currentInstanceBuffers[t];e!=i&&i.references&&(e=i,this.bindArrayBuffer(i));var n=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(n,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0}},{key:"releaseVertexArrayObject",value:function(e){this._gl.deleteVertexArray(e)}},{key:"_releaseBuffer",value:function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)}},{key:"_deleteBuffer",value:function(e){this._gl.deleteBuffer(e.underlyingResource)}},{key:"updateAndBindInstancesBuffer",value:function(e,t,r){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==r[0].index)this.bindInstancesBuffer(e,r,!0);else for(var i=0;i<4;i++){var n=r[i];this._vertexAttribArraysEnabled[n]||(this._gl.enableVertexAttribArray(n),this._vertexAttribArraysEnabled[n]=!0),this._vertexAttribPointer(e,n,4,this._gl.FLOAT,!1,64,16*i),this._gl.vertexAttribDivisor(n,1),this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(e)}}},{key:"bindInstancesBuffer",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.bindArrayBuffer(e);var i=0;if(r)for(var n=0;n<t.length;n++){var a=t[n];i+=4*a.attributeSize}for(var o=0;o<t.length;o++){var s=t[o];void 0===s.index&&(s.index=this._currentEffect.getAttributeLocationByName(s.attributeName)),s.index<0||(this._vertexAttribArraysEnabled[s.index]||(this._gl.enableVertexAttribArray(s.index),this._vertexAttribArraysEnabled[s.index]=!0),this._vertexAttribPointer(e,s.index,s.attributeSize,s.attributeType||this._gl.FLOAT,s.normalized||!1,i,s.offset),this._gl.vertexAttribDivisor(s.index,void 0===s.divisor?1:s.divisor),this._currentInstanceLocations.push(s.index),this._currentInstanceBuffers.push(e))}}},{key:"disableInstanceAttributeByName",value:function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}}},{key:"disableInstanceAttribute",value:function(e){for(var t,r=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),r=!0,t=this._currentInstanceLocations.indexOf(e);r&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))}},{key:"disableAttributeByIndex",value:function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1}},{key:"draw",value:function(e,t,r,i){this.drawElementsType(e?0:1,t,r,i)}},{key:"drawPointClouds",value:function(e,t,r){this.drawArraysType(2,e,t,r)}},{key:"drawUnIndexed",value:function(e,t,r,i){this.drawArraysType(e?0:1,t,r,i)}},{key:"drawElementsType",value:function(e,t,r,i){this.applyStates(),this._reportDrawCall();var n=this._drawMode(e),a=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,o=this._uintIndicesCurrentlySet?4:2;i?this._gl.drawElementsInstanced(n,r,a,t*o,i):this._gl.drawElements(n,r,a,t*o)}},{key:"drawArraysType",value:function(e,t,r,i){this.applyStates(),this._reportDrawCall();var n=this._drawMode(e);i?this._gl.drawArraysInstanced(n,t,r,i):this._gl.drawArrays(n,t,r)}},{key:"_drawMode",value:function(e){switch(e){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}}},{key:"_releaseEffect",value:function(e){this._compiledEffects[e._key]&&delete this._compiledEffects[e._key];var t=e.getPipelineContext();t&&this._deletePipelineContext(t)}},{key:"_deletePipelineContext",value:function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,(0,P.resetCachedPipeline)(t),this._gl.deleteProgram(t.program))}},{key:"_getGlobalDefines",value:function(e){return(0,w._getGlobalDefines)(e,this.isNDCHalfZRange,this.useReverseDepthBuffer,this.useExactSrgbConversions)}},{key:"createEffect",value:function(e,t,r,i,n,a,o,s,l){var c,u,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:T.ShaderLanguage.GLSL,f="string"==typeof e?e:e.vertexToken||e.vertexSource||e.vertexElement||e.vertex,m="string"==typeof e?e:e.fragmentToken||e.fragmentSource||e.fragmentElement||e.fragment,p=this._getGlobalDefines(),g=null!==(c=null!=n?n:t.defines)&&void 0!==c?c:"";p&&(g+=p);var v=f+"+"+m+"@"+g;if(this._compiledEffects[v]){var y=this._compiledEffects[v];return o&&y.isReady()&&o(y),y}this._gl&&(0,d.getStateObject)(this._gl);var _=new C.Effect(e,t,r,i,this,n,a,o,s,l,v,null!==(u=t.shaderLanguage)&&void 0!==u?u:h);return this._compiledEffects[v]=_,_}},{key:"_getShaderSource",value:function(e){return this._gl.getShaderSource(e)}},{key:"createRawShaderProgram",value:function(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=(0,d.getStateObject)(this._gl);return a._contextWasLost=this._contextWasLost,a.validateShaderPrograms=this.validateShaderPrograms,(0,d.createRawShaderProgram)(e,t,r,i||this._gl,n)}},{key:"createShaderProgram",value:function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=(0,d.getStateObject)(this._gl);return o._contextWasLost=this._contextWasLost,o.validateShaderPrograms=this.validateShaderPrograms,(0,d.createShaderProgram)(e,t,r,i,n||this._gl,a)}},{key:"inlineShaderCode",value:function(e){return e}},{key:"createPipelineContext",value:function(e){this._gl&&((0,d.getStateObject)(this._gl).parallelShaderCompile=this._caps.parallelShaderCompile);var t=(0,d.createPipelineContext)(this._gl,e);return t.engine=this,t}},{key:"createMaterialContext",value:function(){}},{key:"createDrawContext",value:function(){}},{key:"_finalizePipelineContext",value:function(e){return(0,d._finalizePipelineContext)(e,this._gl,this.validateShaderPrograms)}},{key:"_preparePipelineContext",value:function(e,t,r,i,n,a,o,s,l,c){var u=(0,d.getStateObject)(this._gl);return u._contextWasLost=this._contextWasLost,u.validateShaderPrograms=this.validateShaderPrograms,u._createShaderProgramInjection=this._createShaderProgram.bind(this),u.createRawShaderProgramInjection=this.createRawShaderProgram.bind(this),u.createShaderProgramInjection=this.createShaderProgram.bind(this),u.loadFileInjection=this._loadFile.bind(this),(0,d._preparePipelineContext)(e,t,r,i,n,a,o,s,l,c)}},{key:"_createShaderProgram",value:function(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,d._createShaderProgram)(e,t,r,i,n)}},{key:"_isRenderingStateCompiled",value:function(e){var t=e;return!(this._isDisposed||t._isDisposed||!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)||(this._finalizePipelineContext(t),0))}},{key:"_executeWhenRenderingStateIsCompiled",value:function(e,t){(0,d._executeWhenRenderingStateIsCompiled)(e,t)}},{key:"getUniforms",value:function(e,t){for(var r=new Array,i=e,n=0;n<t.length;n++)r.push(this._gl.getUniformLocation(i.program,t[n]));return r}},{key:"getAttributes",value:function(e,t){for(var r=[],i=e,n=0;n<t.length;n++)try{r.push(this._gl.getAttribLocation(i.program,t[n]))}catch(e){r.push(-1)}return r}},{key:"enableEffect",value:function(e){(e=null!==e&&(0,h.IsWrapper)(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,e=e,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))}},{key:"setInt",value:function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)}},{key:"setInt2",value:function(e,t,r){return!!e&&(this._gl.uniform2i(e,t,r),!0)}},{key:"setInt3",value:function(e,t,r,i){return!!e&&(this._gl.uniform3i(e,t,r,i),!0)}},{key:"setInt4",value:function(e,t,r,i,n){return!!e&&(this._gl.uniform4i(e,t,r,i,n),!0)}},{key:"setIntArray",value:function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)}},{key:"setIntArray2",value:function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))}},{key:"setIntArray3",value:function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))}},{key:"setIntArray4",value:function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))}},{key:"setUInt",value:function(e,t){return!!e&&(this._gl.uniform1ui(e,t),!0)}},{key:"setUInt2",value:function(e,t,r){return!!e&&(this._gl.uniform2ui(e,t,r),!0)}},{key:"setUInt3",value:function(e,t,r,i){return!!e&&(this._gl.uniform3ui(e,t,r,i),!0)}},{key:"setUInt4",value:function(e,t,r,i,n){return!!e&&(this._gl.uniform4ui(e,t,r,i,n),!0)}},{key:"setUIntArray",value:function(e,t){return!!e&&(this._gl.uniform1uiv(e,t),!0)}},{key:"setUIntArray2",value:function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2uiv(e,t),0))}},{key:"setUIntArray3",value:function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3uiv(e,t),0))}},{key:"setUIntArray4",value:function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4uiv(e,t),0))}},{key:"setArray",value:function(e,t){return!(!e||t.length<1||(this._gl.uniform1fv(e,t),0))}},{key:"setArray2",value:function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))}},{key:"setArray3",value:function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))}},{key:"setArray4",value:function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))}},{key:"setMatrices",value:function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)}},{key:"setMatrix3x3",value:function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)}},{key:"setMatrix2x2",value:function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)}},{key:"setFloat",value:function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)}},{key:"setFloat2",value:function(e,t,r){return!!e&&(this._gl.uniform2f(e,t,r),!0)}},{key:"setFloat3",value:function(e,t,r,i){return!!e&&(this._gl.uniform3f(e,t,r,i),!0)}},{key:"setFloat4",value:function(e,t,r,i,n){return!!e&&(this._gl.uniform4f(e,t,r,i,n),!0)}},{key:"applyStates",value:function(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}}},{key:"wipeCaches",value:function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}},{key:"_getSamplingParameters",value:function(e,t){var r=this._gl,i=r.NEAREST,n=r.NEAREST;switch(e){case 11:i=r.LINEAR,n=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case 3:i=r.LINEAR,n=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case 8:i=r.NEAREST,n=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case 4:i=r.NEAREST,n=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case 5:i=r.NEAREST,n=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case 6:i=r.NEAREST,n=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case 7:i=r.NEAREST,n=r.LINEAR;break;case 1:i=r.NEAREST,n=r.NEAREST;break;case 9:i=r.LINEAR,n=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case 10:i=r.LINEAR,n=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case 2:i=r.LINEAR,n=r.LINEAR;break;case 12:i=r.LINEAR,n=r.NEAREST}return{min:n,mag:i}}},{key:"_createTexture",value:function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e}},{key:"_createHardwareTexture",value:function(){return new S.WebGLHardwareTexture(this._createTexture(),this._gl)}},{key:"_createInternalTexture",value:function(e,t){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.InternalTextureSource.Unknown,o=!1,s=0,l=3,c=5,u=!1,d=1;void 0!==t&&"object"===(0,n.default)(t)?(o=!!t.generateMipMaps,s=void 0===t.type?0:t.type,l=void 0===t.samplingMode?3:t.samplingMode,c=void 0===t.format?5:t.format,u=void 0!==t.useSRGBBuffer&&t.useSRGBBuffer,d=null!==(i=t.samples)&&void 0!==i?i:1,r=t.label):o=!!t,u&&(u=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(1!==s||this._caps.textureFloatLinearFiltering)&&(2!==s||this._caps.textureHalfFloatLinearFiltering)||(l=1),1!==s||this._caps.textureFloat||(s=0,f.Logger.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));var h=this._gl,m=new b.InternalTexture(this,a),p=e.width||e,g=e.height||e,v=e.depth||0,y=e.layers||0,_=this._getSamplingParameters(l,o),S=0!==y?h.TEXTURE_2D_ARRAY:0!==v?h.TEXTURE_3D:h.TEXTURE_2D,T=this._getRGBABufferInternalSizedFormat(s,c,u),C=this._getInternalFormat(c),w=this._getWebGLTextureType(s);return this._bindTextureDirectly(S,m),0!==y?(m.is2DArray=!0,h.texImage3D(S,0,T,p,g,y,0,C,w,null)):0!==v?(m.is3D=!0,h.texImage3D(S,0,T,p,g,v,0,C,w,null)):h.texImage2D(S,0,T,p,g,0,C,w,null),h.texParameteri(S,h.TEXTURE_MAG_FILTER,_.mag),h.texParameteri(S,h.TEXTURE_MIN_FILTER,_.min),h.texParameteri(S,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(S,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),o&&this._gl.generateMipmap(S),this._bindTextureDirectly(S,null),m._useSRGBBuffer=u,m.baseWidth=p,m.baseHeight=g,m.width=p,m.height=g,m.depth=y,m.isReady=!0,m.samples=d,m.generateMipMaps=o,m.samplingMode=l,m.type=s,m.format=c,m.label=r,this._internalTexturesCache.push(m),m}},{key:"_getUseSRGBBuffer",value:function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||t)}},{key:"createTexture",value:function(e,t,r,i){var n=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,h=arguments.length>11?arguments[11]:void 0,f=arguments.length>12?arguments[12]:void 0,m=arguments.length>13?arguments[13]:void 0,p=arguments.length>14?arguments[14]:void 0;return this._createTextureBase(e,t,r,i,a,o,s,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n._prepareWebGLTexture.apply(n,t.concat([u]))}),(function(e,t,r,a,o,s){var l=n._gl,c=r.width===e&&r.height===t;o._creationFlags=null!=m?m:0;var u=n._getTexImageParametersForCreateTexture(o.format,o._useSRGBBuffer);if(c)return l.texImage2D(l.TEXTURE_2D,0,u.internalFormat,u.format,u.type,r),!1;var d=n._caps.maxTextureSize;if(r.width>d||r.height>d||!n._supportsHardwareTextureRescaling)return n._prepareWorkingCanvas(),!(!n._workingCanvas||!n._workingContext||(n._workingCanvas.width=e,n._workingCanvas.height=t,n._workingContext.drawImage(r,0,0,r.width,r.height,0,0,e,t),l.texImage2D(l.TEXTURE_2D,0,u.internalFormat,u.format,u.type,n._workingCanvas),o.width=e,o.height=t,1));var h=new b.InternalTexture(n,b.InternalTextureSource.Temp);return n._bindTextureDirectly(l.TEXTURE_2D,h,!0),l.texImage2D(l.TEXTURE_2D,0,u.internalFormat,u.format,u.type,r),n._rescaleTexture(h,o,i,u.format,(function(){n._releaseTexture(h),n._bindTextureDirectly(l.TEXTURE_2D,o,!0),s()})),!0}),l,c,u,d,h,f,p)}},{key:"_getTexImageParametersForCreateTexture",value:function(e,t){var r,i;return 1===this.webGLVersion?i=r=this._getInternalFormat(e,t):(r=this._getInternalFormat(e,!1),i=this._getRGBABufferInternalSizedFormat(0,e,t)),{internalFormat:i,format:r,type:this._gl.UNSIGNED_BYTE}}},{key:"_rescaleTexture",value:function(e,t,r,i,n){}},{key:"_unpackFlipY",value:function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))}},{key:"_getUnpackAlignement",value:function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}},{key:"_getTextureTarget",value:function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}},{key:"updateTextureSamplingMode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._getTextureTarget(t),n=this._getSamplingParameters(e,t.useMipMaps||r);this._setTextureParameterInteger(i,this._gl.TEXTURE_MAG_FILTER,n.mag,t),this._setTextureParameterInteger(i,this._gl.TEXTURE_MIN_FILTER,n.min),r&&(t.generateMipMaps=!0,this._gl.generateMipmap(i)),this._bindTextureDirectly(i,null),t.samplingMode=e}},{key:"updateTextureDimensions",value:function(e,t,r){}},{key:"updateTextureWrappingMode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==r&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(r),e),e._cachedWrapV=r),(e.is2DArray||e.is3D)&&null!==i&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(i),e),e._cachedWrapR=i),this._bindTextureDirectly(n,null)}},{key:"_uploadCompressedDataToTextureDirectly",value:function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=this._gl,l=s.TEXTURE_2D;if(e.isCube&&(l=s.TEXTURE_CUBE_MAP_POSITIVE_X+a),e._useSRGBBuffer)switch(t){case 37492:case 36196:this._caps.etc2?t=s.COMPRESSED_SRGB8_ETC2:e._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?t=s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e._useSRGBBuffer=!1;break;case 36492:t=s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(l,o,t,r,i,0,n)}},{key:"_uploadDataToTextureDirectly",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this._gl,s=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format),c=void 0===n?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(n,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var u=o.TEXTURE_2D;e.isCube&&(u=o.TEXTURE_CUBE_MAP_POSITIVE_X+r);var d=Math.round(Math.log(e.width)*Math.LOG2E),h=Math.round(Math.log(e.height)*Math.LOG2E),f=a?e.width:Math.pow(2,Math.max(d-i,0)),m=a?e.height:Math.pow(2,Math.max(h-i,0));o.texImage2D(u,i,c,f,m,0,l,s,t)}},{key:"updateTextureData",value:function(e,t,r,i,n,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=this._gl,u=this._getWebGLTextureType(e.type),d=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var h=c.TEXTURE_2D,f=c.TEXTURE_2D;e.isCube&&(f=c.TEXTURE_CUBE_MAP_POSITIVE_X+o,h=c.TEXTURE_CUBE_MAP),this._bindTextureDirectly(h,e,!0),c.texSubImage2D(f,s,r,i,n,a,d,u,t),l&&this._gl.generateMipmap(f),this._bindTextureDirectly(h,null)}},{key:"_uploadArrayBufferViewToTexture",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=this._gl,a=e.isCube?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D;this._bindTextureDirectly(a,e,!0),this._uploadDataToTextureDirectly(e,t,r,i),this._bindTextureDirectly(a,null,!0)}},{key:"_prepareWebGLTextureContinuation",value:function(e,t,r,i,n){var a=this._gl;if(a){var o=this._getSamplingParameters(n,!r);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,o.mag),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,o.min),r||i||a.generateMipmap(a.TEXTURE_2D),this._bindTextureDirectly(a.TEXTURE_2D,null),t&&t.removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}}},{key:"_prepareWebGLTexture",value:function(e,t,r,i,n,a,o,s,l,c){var u=this,d=this.getCaps().maxTextureSize,h=Math.min(d,this.needPOTTextures?(0,y.GetExponentOfTwo)(i.width,d):i.width),f=Math.min(d,this.needPOTTextures?(0,y.GetExponentOfTwo)(i.height,d):i.height),m=this._gl;m&&(e._hardwareTexture?(this._bindTextureDirectly(m.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===n||!!n),e.baseWidth=i.width,e.baseHeight=i.height,e.width=h,e.height=f,e.isReady=!0,e.type=-1!==e.type?e.type:0,e.format=-1!==e.format?e.format:null!=c?c:".jpg"!==t||e._useSRGBBuffer?5:4,s(h,f,i,t,e,(function(){u._prepareWebGLTextureContinuation(e,r,a,o,l)}))||this._prepareWebGLTextureContinuation(e,r,a,o,l)):r&&r.removePendingData(e))}},{key:"_setupFramebufferDepthAttachments",value:function(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=this._gl;if(e&&t)return this._createRenderBuffer(r,i,n,a.DEPTH_STENCIL,a.DEPTH24_STENCIL8,a.DEPTH_STENCIL_ATTACHMENT);if(t){var o=a.DEPTH_COMPONENT16;return this._webGLVersion>1&&(o=a.DEPTH_COMPONENT32F),this._createRenderBuffer(r,i,n,o,o,a.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(r,i,n,a.STENCIL_INDEX8,a.STENCIL_INDEX8,a.STENCIL_ATTACHMENT):null}},{key:"_createRenderBuffer",value:function(e,t,r,i,n,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=this._gl,l=s.createRenderbuffer();return this._updateRenderBuffer(l,e,t,r,i,n,a,o)}},{key:"_updateRenderBuffer",value:function(e,t,r,i,n,a,o){var s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=this._gl;return l.bindRenderbuffer(l.RENDERBUFFER,e),i>1&&l.renderbufferStorageMultisample?l.renderbufferStorageMultisample(l.RENDERBUFFER,i,a,t,r):l.renderbufferStorage(l.RENDERBUFFER,n,t,r),l.framebufferRenderbuffer(l.FRAMEBUFFER,o,l.RENDERBUFFER,e),s&&l.bindRenderbuffer(l.RENDERBUFFER,null),e}},{key:"_releaseTexture",value:function(e){this._deleteTexture(e._hardwareTexture),this.unbindAllTextures();var t=this._internalTexturesCache.indexOf(e);-1!==t&&this._internalTexturesCache.splice(t,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()}},{key:"_deleteTexture",value:function(e){null==e||e.release()}},{key:"_setProgram",value:function(e){this._currentProgram!==e&&((0,d._setProgram)(e,this._gl),this._currentProgram=e)}},{key:"bindSamplers",value:function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var r=e.getSamplers(),i=0;i<r.length;i++){var n=e.getUniform(r[i]);n&&(this._boundUniforms[i]=n)}this._currentEffect=null}},{key:"_activateCurrentTexture",value:function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}},{key:"_bindTextureDirectly",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=!1,a=t&&t._associatedChannel>-1;r&&a&&(this._activeChannel=t._associatedChannel);var o=this._boundTexturesCache[this._activeChannel];if(o!==t||i){if(this._activateCurrentTexture(),t&&t.isMultiview)throw f.Logger.Error(["_bindTextureDirectly called with a multiview texture!",e,t]),"_bindTextureDirectly called with a multiview texture!";var s,l;this._gl.bindTexture(e,null!==(s=null==t||null===(l=t._hardwareTexture)||void 0===l?void 0:l.underlyingResource)&&void 0!==s?s:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else r&&(n=!0,this._activateCurrentTexture());return a&&!r&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),n}},{key:"_bindTexture",value:function(e,t,r){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var i=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(i,t)}}},{key:"unbindAllTextures",value:function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}},{key:"setTexture",value:function(e,t,r,i){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,r))}},{key:"_bindSamplerUniformToChannel",value:function(e,t){var r=this._boundUniforms[e];r&&r._currentState!==t&&(this._gl.uniform1i(r,t),r._currentState=t)}},{key:"_getTextureWrapMode",value:function(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}},{key:"_setTexture",value:function(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video){this._activeChannel=e;var a=t.getInternalTexture();a&&(a._associatedChannel=e),t.update()}else if(4===t.delayLoadState)return t.delayLoad(),!1;r=n?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!i&&r&&(r._associatedChannel=e);var o=!0;this._boundTexturesCache[e]===r&&(i||this._bindSamplerUniformToChannel(r._associatedChannel,e),o=!1),this._activeChannel=e;var s=this._getTextureTarget(r);if(o&&this._bindTextureDirectly(s,r,i),r&&!r.isMultiview){if(r.isCube&&r._cachedCoordinatesMode!==t.coordinatesMode){r._cachedCoordinatesMode=t.coordinatesMode;var l=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=l,t.wrapV=l}r._cachedWrapU!==t.wrapU&&(r._cachedWrapU=t.wrapU,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),r)),r._cachedWrapV!==t.wrapV&&(r._cachedWrapV=t.wrapV,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),r)),r.is3D&&r._cachedWrapR!==t.wrapR&&(r._cachedWrapR=t.wrapR,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),r)),this._setAnisotropicLevel(s,r,t.anisotropicFilteringLevel)}return!0}},{key:"setTextureArray",value:function(e,t,r,i){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===r.length||(this._textureUnits=new Int32Array(r.length));for(var n=0;n<r.length;n++){var a=r[n].getInternalTexture();a?(this._textureUnits[n]=e+n,a._associatedChannel=e+n):this._textureUnits[n]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var o=0;o<r.length;o++)this._setTexture(this._textureUnits[o],r[o],!0)}}},{key:"_setAnisotropicLevel",value:function(e,t,r){var i=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(r=1),i&&t._cachedAnisotropicFilteringLevel!==r&&(this._setTextureParameterFloat(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=r)}},{key:"_setTextureParameterFloat",value:function(e,t,r,i){this._bindTextureDirectly(e,i,!0,!0),this._gl.texParameterf(e,t,r)}},{key:"_setTextureParameterInteger",value:function(e,t,r,i){i&&this._bindTextureDirectly(e,i,!0,!0),this._gl.texParameteri(e,t,r)}},{key:"unbindAllAttributes",value:function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else for(var t=0,r=this._vertexAttribArraysEnabled.length;t<r;t++)t>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[t]||this.disableAttributeByIndex(t)}},{key:"releaseEffects",value:function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}}},{key:"dispose",value:function(){var e;(0,m.IsWindowObjectExist)()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored))),(0,o.default)((0,s.default)(t.prototype),"dispose",this).call(this),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.unbindAllAttributes(),this._boundUniforms={},this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._currentProgram=null,this._creationOptions.loseContextOnDispose&&(null===(e=this._gl.getExtension("WEBGL_lose_context"))||void 0===e||e.loseContext()),(0,d.deleteStateObject)(this._gl)}},{key:"attachContextLostEvent",value:function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)}},{key:"attachContextRestoredEvent",value:function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)}},{key:"getError",value:function(){return this._gl.getError()}},{key:"_canRenderToFloatFramebuffer",value:function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}},{key:"_canRenderToHalfFloatFramebuffer",value:function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}},{key:"_canRenderToFramebuffer",value:function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var r=!0,i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER);if((r=(r=r&&a===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),r=r&&t.getError()===t.NO_ERROR),r){t.bindFramebuffer(t.FRAMEBUFFER,null);var o=t.RGBA,s=t.UNSIGNED_BYTE,l=new Uint8Array(4);t.readPixels(0,0,1,1,o,s,l),r=r&&t.getError()===t.NO_ERROR}for(t.deleteTexture(i),t.deleteFramebuffer(n),t.bindFramebuffer(t.FRAMEBUFFER,null);!r&&t.getError()!==t.NO_ERROR;);return r}},{key:"_getWebGLTextureType",value:function(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}},{key:"_getInternalFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:r=this._gl.ALPHA;break;case 1:r=this._gl.LUMINANCE;break;case 2:r=this._gl.LUMINANCE_ALPHA;break;case 6:r=this._gl.RED;break;case 7:r=this._gl.RG;break;case 4:r=t?this._glSRGBExtensionValues.SRGB:this._gl.RGB;break;case 5:r=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:r=this._gl.RED_INTEGER;break;case 9:r=this._gl.RG_INTEGER;break;case 10:r=this._gl.RGB_INTEGER;break;case 11:r=this._gl.RGBA_INTEGER}return r}},{key:"_getRGBABufferInternalSizedFormat",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return r?this._glSRGBExtensionValues.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return r?this._glSRGBExtensionValues.SRGB8:this._gl.RGB8;case 5:return r?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(t){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return r?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8}},{key:"readPixels",value:function(e,t,r,i){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=n?4:3,s=n?this._gl.RGBA:this._gl.RGB,l=new Uint8Array(i*r*o);return a&&this.flushFramebuffer(),this._gl.readPixels(e,t,r,i,s,this._gl.UNSIGNED_BYTE,l),Promise.resolve(l)}}],[{key:"ShadersRepository",get:function(){return C.Effect.ShadersRepository},set:function(e){C.Effect.ShadersRepository=e}},{key:"IsSupportedAsync",get:function(){return Promise.resolve(this.isSupported())}},{key:"IsSupported",get:function(){return this.isSupported()}},{key:"isSupported",value:function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=_.AbstractEngine._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported}},{key:"HasMajorPerformanceCaveat",get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=_.AbstractEngine._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}}])}(_.AbstractEngine);t.ThinEngine=L,L._TempClearColorUint32=new Uint32Array(4),L._TempClearColorInt32=new Int32Array(4),L.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/12\\d\\..+?Mobile",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}],L.CollisionsEpsilon=.001,L._ConcatenateShader=w._ConcatenateShader,L._IsSupported=null,L._HasMajorPerformanceCaveat=null,L.CeilingPOT=y.CeilingPOT,L.FloorPOT=y.FloorPOT,L.NearestPOT=y.NearestPOT,L.GetExponentOfTwo=y.GetExponentOfTwo,L.QueueNewFrame=_.QueueNewFrame},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getMaxTapeFloatsOrThrow=function(){return 4096},t.Mesh=void 0;var n=i(r(1)),a=i(r(2)),o=r(12),s=function(){function e(t,r,i,a){(0,n.default)(this,e),this.triangleCount=r,this.vertexBuffer=i,this.indexBuffer=a,this.m_engine=t.getBabylonEngine(),this.m_compatibleGraphicsProcessorId=t.getUniqueGraphicsProcessorId()}return(0,a.default)(e,[{key:"isValid",value:function(e){return this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}},{key:"discard",value:function(){this.m_engine._releaseBuffer(this.vertexBuffer),this.m_engine._releaseBuffer(this.indexBuffer)}}],[{key:"CreateGridXY",value:function(t,r,i,n){for(var a=new Float32Array(r*i*2),s=0;s<i;s++)for(var l=(0,o.mix)(n.top,n.bottom,s/(i-1)),c=0;c<r;c++){var u=2*(c+s*r);a[u]=(0,o.mix)(n.left,n.right,c/(r-1)),a[u+1]=l}for(var d=new Uint16Array((r-1)*(i-1)*2*3),h=0;h<i-1;h++)for(var f=0;f<r-1;f++)d.set([f+h*r,f+1+h*r,f+(h+1)*r,f+1+(h+1)*r,f+(h+1)*r,f+1+h*r],6*(f+h*(r-1)));var m=t.getBabylonEngine();return new e(t,(r-1)*(i-1)*2,m.createVertexBuffer(a),m.createIndexBuffer(d))}}])}();t.Mesh=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DebugTool=t.ImageContainerState=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(30),l=r(50);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.ImageContainerState=n,function(e){e[e.uninitialized=0]="uninitialized",e[e.assigned=1]="assigned",e[e.deleted=2]="deleted"}(n||(t.ImageContainerState=n={}));var d=function(){function e(){(0,a.default)(this,e),this.renderers=[]}return(0,o.default)(e,[{key:"dumpLastScene",value:function(){console.log(this.lastRenderer&&this.lastScene?this.lastRenderer.getDebugString(this.lastScene):void 0)}}],[{key:"OnRender",value:function(t,r){if(l.Settings.readBooleanOrDefault("debugTool",!1)){var i=window;i.shapeBuilderDebugTool||(i.shapeBuilderDebugTool=new e);var n=i.shapeBuilderDebugTool;if(n.lastRenderer=t,n.lastScene=1==r.length?r[0].item:void 0,r.length>1){var a,o=new s.Group,u=c(r);try{for(u.s();!(a=u.n()).done;){var d=a.value;o.items.push(d.item)}}catch(e){u.e(e)}finally{u.f()}n.lastScene=o}n.renderers.includes(t)||n.renderers.push(t)}}}])}();t.DebugTool=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultStyles=function(e){(0,n.setStyles)(e,{zIndex:"".concat(i.VIDEO_Z_INDEX),pointerEvents:"all",position:"absolute",objectFit:"fill",height:"100%",width:"100%"})};var i=r(43),n=r(75)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={initializeAsync:!0};Object.defineProperty(t,"initializeAsync",{enumerable:!0,get:function(){return a.initializeAsync}});var n=r(32);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var a=r(116),o=r(173);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}));var s=r(363);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var l=r(45);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}));var c=r(174);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var u=r(378);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var d=r(380);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}}))}));var h=r(177);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}}))}));var f=r(175);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}}))}));var m=r(117);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}}))}));var p=r(21);Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}}))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(24);i.__exportStar(r(180),t),i.__exportStar(r(387),t),i.__exportStar(r(388),t),i.__exportStar(r(389),t)},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){var i=r(56).Buffer;function n(e,t){this._block=i.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}n.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=i.from(e,t));for(var r=this._block,n=this._blockSize,a=e.length,o=this._len,s=0;s<a;){for(var l=o%n,c=Math.min(a-s,n-l),u=0;u<c;u++)r[l+u]=e[s+u];s+=c,(o+=c)%n==0&&this._update(r)}return this._len+=a,this},n.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var i=(4294967295&r)>>>0,n=(r-i)/4294967296;this._block.writeUInt32BE(n,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a},n.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=n},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Effects=t.Replicate=t.ReplicateSlice=t.Echo=t.EchoInstance=t.SoftEdges=t.Reflection=t.InnerShadow=t.Shadow=t.ShadowType=t.Border=t.Glow=void 0;var n=i(r(1)),a=i(r(2)),o=r(16),s=r(12),l=r(37),c=r(59),u=r(27),d=r(13),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.Color.Transparent,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.BlendingMode.normal,a=arguments.length>3?arguments[3]:void 0;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_animationChangeTracker=new l.ChangeTracker,this.m_color=t,this.m_radius=r,this.m_blendingMode=i,this.m_image=a}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"animationChangeTracker",get:function(){return this.m_animationChangeTracker}},{key:"color",get:function(){return this.m_color},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_color,e),this.m_color=e}},{key:"radius",get:function(){return this.m_radius},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}},{key:"blendingMode",get:function(){return this.m_blendingMode},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}},{key:"image",get:function(){return this.m_image},set:function(e){this.m_image!=e&&(this.m_animationChangeTracker.replaceListener(this.m_image,e),this.m_image=e)}},{key:"clone",value:function(){return new e(this.m_color,this.m_radius,this.m_blendingMode,this.m_image)}}])}();t.Glow=h;var f,m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.Color.Transparent,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_color=t,this.m_radius=r}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"color",get:function(){return this.m_color},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_color,e),this.m_color=e}},{key:"radius",get:function(){return this.m_radius},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}},{key:"clone",value:function(){return new e(this.m_color,this.m_radius)}}])}();t.Border=m,t.ShadowType=f,function(e){e[e.singleShadow=0]="singleShadow",e[e.doubleShadow=1]="doubleShadow",e[e.embossShadow=2]="embossShadow",e[e.textEmbossShadow=3]="textEmbossShadow"}(f||(t.ShadowType=f={}));var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.Color.Transparent,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.Vector2.One,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.Vector2.Zero,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:s.AlignmentType.center,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:f.singleShadow;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_color=t,this.m_radius=r,this.m_angle=i,this.m_distance=a,this.m_scale=c,this.m_skew=u,this.m_alignment=d,this.m_rotateWithShape=h,this.m_shadowType=m}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"color",get:function(){return this.m_color},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_color,e),this.m_color=e}},{key:"radius",get:function(){return this.m_radius},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}},{key:"angle",get:function(){return this.m_angle},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}},{key:"distance",get:function(){return this.m_distance},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}},{key:"scale",get:function(){return this.m_scale},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_scale,e),this.m_scale=e}},{key:"skew",get:function(){return this.m_skew},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_skew,e),this.m_skew=e}},{key:"alignment",get:function(){return this.m_alignment},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_alignment,e),this.m_alignment=e}},{key:"rotateWithShape",get:function(){return this.m_rotateWithShape},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}},{key:"shadowType",get:function(){return this.m_shadowType},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_shadowType,e),this.m_shadowType=e}},{key:"clone",value:function(){return new e(this.m_color,this.m_radius,this.m_angle,this.m_distance,this.m_scale,this.m_skew,this.m_alignment,this.m_rotateWithShape,this.m_shadowType)}}])}();t.Shadow=p;var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.Color.Transparent,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_color=t,this.m_radius=r,this.m_angle=i,this.m_distance=a}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"color",get:function(){return this.m_color},set:function(e){(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_color,e),this.m_color=e}},{key:"radius",get:function(){return this.m_radius},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}},{key:"angle",get:function(){return this.m_angle},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}},{key:"distance",get:function(){return this.m_distance},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}},{key:"clone",value:function(){return new e(this.m_color,this.m_radius,this.m_angle,this.m_distance)}}])}();t.InnerShadow=g;var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_radius=t,this.m_startAlpha=r,this.m_startPosition=i,this.m_endAlpha=a,this.m_endPosition=o,this.m_distance=s}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"radius",get:function(){return this.m_radius},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}},{key:"startAlpha",get:function(){return this.m_startAlpha},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_startAlpha,e),this.m_startAlpha=e}},{key:"startPosition",get:function(){return this.m_startPosition},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_startPosition,e),this.m_startPosition=e}},{key:"endAlpha",get:function(){return this.m_endAlpha},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_endAlpha,e),this.m_endAlpha=e}},{key:"endPosition",get:function(){return this.m_endPosition},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_endPosition,e),this.m_endPosition=e}},{key:"distance",get:function(){return this.m_distance},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}},{key:"clone",value:function(){return new e(this.m_radius,this.m_startAlpha,this.m_startPosition,this.m_endAlpha,this.m_endPosition,this.m_distance)}}])}();t.Reflection=v;var y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_radius=t}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"notifyChange",value:function(){this.m_changeTracker.notifyChange()}},{key:"radius",get:function(){return this.m_radius},set:function(e){this.m_radius!=e&&(this.notifyChange(),this.m_radius=e)}},{key:"clone",value:function(){return new e(this.m_radius)}}])}();t.SoftEdges=y;var _=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_style=t,this.m_transform=r}),[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"style",get:function(){return this.m_style},set:function(e){this.m_changeTracker.replaceListener(this.m_style,e),this.m_style=e}},{key:"transform",get:function(){return this.m_transform},set:function(e){this.m_transform instanceof s.Transform&&e instanceof s.Transform||this.m_transform instanceof s.Matrix3&&e instanceof s.Matrix3?(0,c.notifyIfNotEquals)(this.m_changeTracker,this.m_transform,e):this.m_changeTracker.notifyChange(),this.m_transform=e}}]);t.EchoInstance=_;var S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;(0,n.default)(this,e),this.m_instances=new l.TrackableArray,this.m_changeTracker=new l.ChangeTracker,this.setInstances(t),d.Log.Error(506848276,"Do not use Echo, this effect is no longer supported")}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"instances",get:function(){return this.m_instances},set:function(e){this.setInstances(e)}},{key:"setInstances",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=e instanceof l.TrackableArray?e:new l.TrackableArray(e);this.changeTracker.replaceListener(this.m_instances,t),this.m_instances=t}},{key:"clone",value:function(){return new e(this.m_instances)}}])}();t.Echo=S;var T=(0,a.default)((function e(t){var r,i,a,o;(0,n.default)(this,e),this.count=null!==(r=t.count)&&void 0!==r?r:1,this.push=null!==(i=t.push)&&void 0!==i?i:s.Vector2.Zero,this.scale=null!==(a=t.scale)&&void 0!==a?a:1,this.rotate=null!==(o=t.rotate)&&void 0!==o?o:0,this.recolor=t.recolor,this.recolorSolid=!!t.recolorSolid,this.recolorInterpolate=!!t.recolorInterpolate,this.opacity=t.opacity,this.opacityInterpolate=!!t.opacityInterpolate}),[{key:"equals",value:function(e){if(this.count!=e.count||this.scale!=e.scale||this.rotate!=e.rotate||this.recolorSolid!=e.recolorSolid||this.recolorInterpolate!=e.recolorInterpolate||this.opacity!=e.opacity||this.opacityInterpolate!=e.opacityInterpolate)return!1;if(this.push instanceof s.Vector2&&!(e.push instanceof s.Vector2&&e.push.equals(this.push)))return!1;if(this.push instanceof u.Figure&&e.push!==this.push)return!1;if(this.recolor||e.recolor){if(!this.recolor||!e.recolor)return!1;if(this.recolor instanceof o.Color){if(!(e.recolor instanceof o.Color))return!1;if(!e.recolor.equals(this.recolor))return!1}else if(this.recolor!=e.recolor)return!1}return!0}}]);t.ReplicateSlice=T;var b=function(){function e(t){var r,i,a,s;(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_bottomSlices=null==t?void 0:t.bottomSlices,this.m_topSlices=null==t?void 0:t.topSlices,this.m_bottomFilter=null!==(r=null==t?void 0:t.bottomFilter)&&void 0!==r?r:3,this.m_mainFilter=null!==(i=null==t?void 0:t.mainFilter)&&void 0!==i?i:3,this.m_topFilter=null!==(a=null==t?void 0:t.topFilter)&&void 0!==a?a:3,this.m_blendingMode=null!==(s=null==t?void 0:t.blendingMode)&&void 0!==s?s:o.BlendingMode.normal}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"bottomSlices",get:function(){return this.m_bottomSlices},set:function(e){(0,c.notifyIfNotEqualsArray)(this.m_changeTracker,this.m_bottomSlices,e),this.m_bottomSlices=null==e?void 0:e.slice(0)}},{key:"topSlices",get:function(){return this.m_topSlices},set:function(e){(0,c.notifyIfNotEqualsArray)(this.m_changeTracker,this.m_topSlices,e),this.m_topSlices=null==e?void 0:e.slice(0)}},{key:"bottomFilter",get:function(){return this.m_bottomFilter},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_bottomFilter,e),this.m_bottomFilter=e}},{key:"mainFilter",get:function(){return this.m_mainFilter},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_mainFilter,e),this.m_mainFilter=e}},{key:"topFilter",get:function(){return this.m_topFilter},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_topFilter,e),this.m_topFilter=e}},{key:"blendingMode",get:function(){return this.m_blendingMode},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}},{key:"clone",value:function(){var t=new e;return t.bottomSlices=this.bottomSlices,t.topSlices=this.topSlices,t.bottomFilter=this.bottomFilter,t.mainFilter=this.mainFilter,t.topFilter=this.topFilter,t.blendingMode=this.blendingMode,t}}])}();t.Replicate=b;var C=function(){function e(t,r,i,a,o,s,c,u){(0,n.default)(this,e),this.m_changeTracker=new l.ChangeTracker,this.m_animationChangeTracker=new l.ChangeTracker,this.glow=t,this.shadow=r,this.innerShadow=i,this.reflection=a,this.softEdges=o,this.border=s,this.echo=c,this.replicate=u,l.ChangeTracker.AddListener(null==t?void 0:t.animationChangeTracker,this.m_animationChangeTracker)}return(0,a.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"notifyChange",value:function(){this.m_changeTracker.notifyChange()}},{key:"animationChangeTracker",get:function(){return this.m_animationChangeTracker}},{key:"glow",get:function(){return this.m_glow},set:function(e){this.m_glow!=e&&(this.m_changeTracker.replaceListener(this.m_glow,e),this.m_glow&&l.ChangeTracker.RemoveListener(this.m_glow.animationChangeTracker,this.m_animationChangeTracker),e&&l.ChangeTracker.AddListener(e.animationChangeTracker,this.m_animationChangeTracker),this.m_glow=e)}},{key:"shadow",get:function(){return this.m_shadow},set:function(e){this.m_changeTracker.replaceListener(this.m_shadow,e),this.m_shadow=e}},{key:"innerShadow",get:function(){return this.m_innerShadow},set:function(e){this.m_changeTracker.replaceListener(this.m_innerShadow,e),this.m_innerShadow=e}},{key:"reflection",get:function(){return this.m_reflection},set:function(e){this.m_changeTracker.replaceListener(this.m_reflection,e),this.m_reflection=e}},{key:"softEdges",get:function(){return this.m_softEdges},set:function(e){this.m_changeTracker.replaceListener(this.m_softEdges,e),this.m_softEdges=e}},{key:"echo",get:function(){return this.m_echo},set:function(e){this.m_changeTracker.replaceListener(this.m_echo,e),this.m_echo=e}},{key:"replicate",get:function(){return this.m_replicate},set:function(e){this.m_changeTracker.replaceListener(this.m_replicate,e),this.m_replicate=e}},{key:"direction",get:function(){return this.m_direction||0},set:function(e){(0,c.notifyIfDifferent)(this.m_changeTracker,this.m_direction,e),this.m_direction=e}},{key:"border",get:function(){return this.m_border},set:function(e){this.m_changeTracker.replaceListener(this.m_border,e),this.m_border=e}},{key:"hasEffects",get:function(){return!!(this.m_glow||this.m_shadow||this.m_innerShadow||this.m_reflection||this.m_softEdges||this.m_border||this.m_echo||this.m_replicate)}},{key:"clone",value:function(){var t=new e(this.m_glow?this.m_glow.clone():void 0,this.m_shadow?this.m_shadow.clone():void 0,this.m_innerShadow?this.m_innerShadow.clone():void 0,this.m_reflection?this.m_reflection.clone():void 0,this.m_softEdges?this.m_softEdges.clone():void 0,this.m_border?this.m_border.clone():void 0,this.m_echo?this.m_echo.clone():void 0,this.m_replicate?this.m_replicate.clone():void 0);return t.direction=this.direction,t}}])}();t.Effects=C},function(e,t,r){"use strict";function i(){return"undefined"!=typeof window}function n(){return"undefined"!=typeof navigator}function a(){return"undefined"!=typeof document}function o(e){for(var t="",r=e.firstChild;r;)3===r.nodeType&&(t+=r.textContent),r=r.nextSibling;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.IsWindowObjectExist=i,t.IsNavigatorAvailable=n,t.IsDocumentAvailable=a,t.GetDOMTextContent=o,t.DomManagement=void 0;var s={IsWindowObjectExist:i,IsNavigatorAvailable:n,IsDocumentAvailable:a,GetDOMTextContent:o};t.DomManagement=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderDefineExpression=void 0;var n=i(r(1)),a=i(r(2));function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"isTrue",value:function(e){return!0}}],[{key:"postfixToInfix",value:function(t){var r,i=[],n=o(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(void 0===e._OperatorPriority[a])i.push(a);else{var s=i[i.length-1],l=i[i.length-2];i.length-=2,i.push("(".concat(l).concat(a).concat(s,")"))}}}catch(e){n.e(e)}finally{n.f()}return i[i.length-1]}},{key:"infixToPostfix",value:function(t){var r=e._InfixToPostfixCache.get(t);if(r)return r.accessTime=Date.now(),r.result;if(!(t.includes("&&")||t.includes("||")||t.includes(")")||t.includes("(")))return[t];for(var i=[],n=-1,a=function(){""!==(u=u.trim())&&(i.push(u),u="")},o=function(t){n<e._Stack.length-1&&(e._Stack[++n]=t)},s=function(){return e._Stack[n]},l=function(){return-1===n?"!!INVALID EXPRESSION!!":e._Stack[n--]},c=0,u="";c<t.length;){var d=t.charAt(c),h=c<t.length-1?t.substr(c,2):"";if("("===d)u="",o(d);else if(")"===d){for(a();-1!==n&&"("!==s();)i.push(l());l()}else if(e._OperatorPriority[h]>1){for(a();-1!==n&&e._OperatorPriority[s()]>=e._OperatorPriority[h];)i.push(l());o(h),c++}else u+=d;c++}for(a();-1!==n;)"("===s()?l():i.push(l());return e._InfixToPostfixCache.size>=e.InfixToPostfixCacheLimitSize&&e.ClearCache(),e._InfixToPostfixCache.set(t,{result:i,accessTime:Date.now()}),i}},{key:"ClearCache",value:function(){for(var t=Array.from(e._InfixToPostfixCache.entries()).sort((function(e,t){return e[1].accessTime-t[1].accessTime})),r=0;r<e.InfixToPostfixCacheCleanupSize;r++)e._InfixToPostfixCache.delete(t[r][0])}}])}();t.ShaderDefineExpression=l,l.InfixToPostfixCacheLimitSize=5e4,l.InfixToPostfixCacheCleanupSize=25e3,l._InfixToPostfixCache=new Map,l._OperatorPriority={")":0,"(":1,"||":2,"&&":3},l._Stack=["","","","","","","","","","","","","","","","","","","",""]},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,t.TraceLevel=i,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(t.TraceLevel=i={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BezierHelper=t.AnimTimeSmoother=t.AnimVisTrack=t.AnimVisTrackResolvedMarker=t.AnimAttributeHelper=t.AnimObject=t.RestEvalHelperEntry=t.AnimClickTime=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(53),l=r(113),c=r(151);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var h=(0,a.default)((function e(t){(0,n.default)(this,e),(0,o.default)(this,"ClickTime",void 0),this.ClickTime=t}),[{key:"HasOccurred",get:function(){return this.ClickTime!==s.AnimConstants.Undefined}}]);t.AnimClickTime=h;var f=(0,a.default)((function e(t,r,i,a,s,l){(0,n.default)(this,e),(0,o.default)(this,"m_startPath",void 0),(0,o.default)(this,"m_timelineId",void 0),(0,o.default)(this,"m_click",void 0),(0,o.default)(this,"m_offs",void 0),(0,o.default)(this,"m_xTarget",void 0),(0,o.default)(this,"m_yTarget",void 0),this.m_startPath=t,this.m_timelineId=r,this.m_click=i,this.m_offs=a,this.m_xTarget=s,this.m_yTarget=l}),[{key:"FStartPath",get:function(){return this.m_startPath}},{key:"TimeLineId",get:function(){return this.m_timelineId}},{key:"Click",get:function(){return this.m_click}},{key:"Offs",get:function(){return this.m_offs}},{key:"XTarget",get:function(){return this.m_xTarget}},{key:"YTarget",get:function(){return this.m_yTarget}}]);t.RestEvalHelperEntry=f;var m=(0,a.default)((function e(t,r){(0,n.default)(this,e),(0,o.default)(this,"Id",void 0),(0,o.default)(this,"Shape",void 0),(0,o.default)(this,"m_attributes",void 0),(0,o.default)(this,"m_visAttributeIndex",void 0),this.Id=t,this.Shape=r,this.m_attributes=[],this.m_visAttributeIndex=s.AnimConstants.Undefined}),[{key:"Attributes",get:function(){return this.m_attributes}},{key:"registerAnimAttribute",value:function(e,t){var r,i=u(this.m_attributes);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.AttrId===e.AttrId)return void n.mergeWith(e)}}catch(e){i.e(e)}finally{i.f()}if(t&&this.m_visAttributeIndex!==s.AnimConstants.Undefined)return this.m_attributes.splice(this.m_visAttributeIndex,0,e),void(this.m_visAttributeIndex+=1);this.m_attributes.push(e),e.AttrId===s.AnimAttributeId.Visible&&(this.m_visAttributeIndex=this.m_attributes.length-1)}},{key:"getRegisteredAttribute",value:function(e){var t,r=u(this.m_attributes);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.AttrId===e)return i}}catch(e){r.e(e)}finally{r.f()}}},{key:"aggregateAllAttributesForTime",value:function(e){var t,r=!1,i=u(this.m_attributes);try{for(i.s();!(t=i.n()).done;)t.value.fUpdateAggregateValue(e)&&(r=!0)}catch(e){i.e(e)}finally{i.f()}return r}},{key:"clearCachedAttributeValues",value:function(){var e,t=u(this.m_attributes);try{for(t.s();!(e=t.n()).done;)e.value.clearCachedValue()}catch(e){t.e(e)}finally{t.f()}}},{key:"getAnimEndTime",value:function(){var e,t=new Map,r=u(this.m_attributes);try{for(r.s();!(e=r.n()).done;){var i,n=u(e.value.Evaluators);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.EvalId===s.AnimEvaluatorId.VisTrack)for(var o=a,l=void 0,c=0;c<o.VisTrack.Length;c+=1){var d=o.VisTrack.getMarker(c);d&&(null==(l=t.get(d.TimelineId))&&(l={ClickNum:d.ClickNum,Offs:d.Offs},t.set(d.TimelineId,l)),d.ClickNum>=l.ClickNum&&(l.ClickNum=d.ClickNum,d.Offs>=l.Offs&&(l.Offs=d.Offs)))}else{var h=a;if(null==h.TimeSpan)continue;var f=t.get(h.TimelineId);if(null==f&&(f={ClickNum:h.TimeSpan.Start.ClickNum,Offs:h.TimeSpan.Start.Offs+h.TimeSpan.End.Offs},t.set(h.TimelineId,f)),h.TimeSpan.Start.ClickNum>=f.ClickNum){f.ClickNum=h.TimeSpan.Start.ClickNum;var m=h.TimeSpan.Start.Offs+h.TimeSpan.End.Offs;m>=f.Offs&&(f.Offs=m)}}}}catch(e){n.e(e)}finally{n.f()}}}catch(e){r.e(e)}finally{r.f()}return t}}]);t.AnimObject=m;var p=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"getAnimAttributeValue",value:function(e,t,r){var i,n=u(e);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.AttrId===t){if(a instanceof l.NumberAnimAttribute)return a.Value;if(a instanceof l.ObjectAnimAttribute)return a.Value}}}catch(e){n.e(e)}finally{n.f()}return r}}]);t.AnimAttributeHelper=p;var g=(0,a.default)((function e(t,r,i,a){(0,n.default)(this,e),(0,o.default)(this,"FVisible",void 0),(0,o.default)(this,"TimelineId",void 0),(0,o.default)(this,"ClickNum",void 0),(0,o.default)(this,"Offs",void 0),this.FVisible=t,this.TimelineId=r,this.ClickNum=i,this.Offs=a})),v=(0,a.default)((function e(t,r,i){(0,n.default)(this,e),(0,o.default)(this,"ResolvedTime",void 0),(0,o.default)(this,"FVisible",void 0),(0,o.default)(this,"MarkerIndex",void 0),this.ResolvedTime=t,this.FVisible=r,this.MarkerIndex=i}),null,[{key:"sortFunction",value:function(e,t){return e.ResolvedTime!==t.ResolvedTime?e.ResolvedTime===s.AnimConstants.Undefined&&t.ResolvedTime!==s.AnimConstants.Undefined?1:t.ResolvedTime===s.AnimConstants.Undefined&&e.ResolvedTime!==s.AnimConstants.Undefined||e.ResolvedTime<t.ResolvedTime?-1:1:e.MarkerIndex<t.MarkerIndex?-1:t.MarkerIndex<e.MarkerIndex?1:0}}]);t.AnimVisTrackResolvedMarker=v;var y=(0,a.default)((function e(){(0,n.default)(this,e),(0,o.default)(this,"m_track",[])}),[{key:"Length",get:function(){return this.m_track.length}},{key:"getMarker",value:function(e){return e<this.m_track.length?this.m_track[e]:null}},{key:"becomesVisibleAt",value:function(e,t,r){this.m_track.push(new g(!0,e,t,r))}},{key:"becomesInvisibleAt",value:function(e,t,r){this.m_track.push(new g(!1,e,t,r))}}]);t.AnimVisTrack=y;var _=(0,a.default)((function e(t,r,i,a,s,l,u){(0,n.default)(this,e),(0,o.default)(this,"m_helperEvaluator",void 0),(0,o.default)(this,"m_smoothStartFactor",void 0),(0,o.default)(this,"m_smoothEndFactor",void 0),(0,o.default)(this,"m_vTarget",void 0),(0,o.default)(this,"m_tAOverPi",void 0),(0,o.default)(this,"m_linearOffset",void 0),(0,o.default)(this,"m_tBOverPi",void 0),this.m_helperEvaluator=new c.SmoothHelperAnimEvaluator(t,r,i,a,s),this.m_smoothStartFactor=Math.max(0,Math.min(l,1)),this.m_smoothEndFactor=Math.max(0,Math.min(u,1-this.m_smoothStartFactor)),this.m_vTarget=1/(1-this.m_smoothStartFactor/2-this.m_smoothEndFactor/2),this.m_tAOverPi=this.m_smoothStartFactor/Math.PI,this.m_tBOverPi=this.m_smoothEndFactor/Math.PI,this.m_linearOffset=-this.m_vTarget*this.m_smoothStartFactor/2}),[{key:"smooth",value:function(e){if(!this.m_helperEvaluator.fInRange(e))return e;if(this.m_helperEvaluator.AdjustedEndTime===s.AnimConstants.Undefined)return e;var t=this.m_helperEvaluator.AdjustedEndTime-this.m_helperEvaluator.AdjustedStartTime;if(t<=0)return e;var r,i=(this.m_helperEvaluator.getEquivalentTime(e)-this.m_helperEvaluator.AdjustedStartTime)/t;if(i<this.m_smoothStartFactor)r=this.m_vTarget/2*(i-this.m_tAOverPi*Math.sin(i/this.m_tAOverPi));else if(i>1-this.m_smoothEndFactor){var n=1-i;r=1-this.m_vTarget/2*(n-this.m_tBOverPi*Math.sin(n/this.m_tBOverPi))}else r=i*this.m_vTarget+this.m_linearOffset;return r*t+this.m_helperEvaluator.AdjustedStartTime}}]);t.AnimTimeSmoother=_;var S=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"calculateBezierCoordinate",value:function(e,t,r,i,n){var a=e+n*(t-e),o=t+n*(r-t),s=a+n*(o-a);return s+n*(o+n*(r+n*(i-r)-o)-s)}}]);t.BezierHelper=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setStyles=function(e,t){Object.assign(e.style,t)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MotionFilter=t.MotionType=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(362);t.MotionType=n,function(e){e[e.MotionQuadratic=0]="MotionQuadratic",e[e.MotionLinear=1]="MotionLinear",e[e.MotionQuadraticHard=2]="MotionQuadraticHard",e[e.MotionQuadraticBounce=3]="MotionQuadraticBounce",e[e.MotionCubicHard=4]="MotionCubicHard"}(n||(t.MotionType=n={}));var l=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"getScaledProgress",value:function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;switch(t){case n.MotionLinear:return r;case n.MotionQuadratic:var o=4;return e.getPositionFromTime(r,o,0,.5,1,!0);case n.MotionQuadraticHard:return r*r;case n.MotionQuadraticBounce:var s=2;if(r>1-i){var l=(r-(1-i))/i;return 1+e.getBounce(l,s,i,a)}var c=r/(1-i);return e.getLocation(s,0,0,c);case n.MotionCubicHard:return r*r*r;default:return 0}}},{key:"getLocation",value:function(e,t,r,i){return.5*e*i*i+t*i+r}},{key:"getPositionFromTime",value:function(e,t,r,i,n,a){var o=0;if(e>r){var s=a?-t:0,l=i-r;o=e<=i?this.getLocation(t,0,0,e-r):e<n?this.getLocation(s,t*l,this.getLocation(t,0,0,l),e-i):this.getLocation(s,t*l,this.getLocation(t,0,0,l),n-i)}return o}},{key:"getVelocityFromTime",value:function(e,t,r,i,n,a){var o=a?-t:0,s=i-r;return e<=i?t*(e-r):e<n?o*(e-i)+t*s:o*(n-i)+t*s}},{key:"getBounce",value:function(e,t,r,i){var n=2*e*Math.PI;return 1/i*(1-e)*r*Math.sin(n)*t}},{key:"doSwivel",value:function(e,t,r){var i,n,a=e,o=t,l=r.m_swivelTime/100,c=r.m_waitTime/100,u=-r.m_swivelAngle*Math.PI/180,d=r.m_swivelZoom/100;return a<l+c?(a>l&&(a=l),i=1-(l-a)/l,n=0):a<1-l?(i=1,n=(a-l)/(1-2*l)):(i=(1-a)/l,n=1),o=(0,s.mat16Mul)(o,(0,s.mat16Translate)(0,0,i*d)),{scaledProgress:n,offset:o=(0,s.mat16Mul)(o,(0,s.mat16RotateY)(i*u)),swivelPercent:i}}}])}();t.MotionFilter=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTranslationForAlignment=n,t.calculateSlidePoint=a,t.calculateZoomTransform=function(e,t,r,i,s,l,c){var u=n(s.scale(.5),r,i,l,c);return o(n(e,a(e,u,i,l,c).scale(t/l),i,t,c),i,s,l,c,t)},t.calculatePanTransform=function(e,t,r,i,a,s){return o(n(i.scale(.5),t,r,a,s).add(e.scale(s)),r,i,a,s)},t.limitTranslationToBounds=o;var i=r(20);function n(e,t,r,i,n){return e.scale(n).add(r.scale(i/2)).subtract(t)}function a(e,t,r,i,n){return e.scale(n).add(r.scale(i/2)).subtract(t)}function o(e,t,r,n,a,o){var s=o,l=e.x,c=e.y;s||(s=n);var u=new i.Vector2(t.x/2,t.y/2);return l=Math.min(l,u.x*s),l=Math.max(l,r.x*a-u.x*s),c=Math.min(c,u.y*s),c=Math.max(c,r.y*a-u.y*s),new i.Transform(u.scale(-1),new i.Vector2(s,s),void 0,new i.Vector2(l,c))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(422);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(187);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(188);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(34);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(96);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(419);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(420);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(124);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(202);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(80);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var u=r(186);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}));var d=r(203);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}));var h=r(204);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})}));var f=r(205);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})}));var m=r(426);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}));var p=r(123);Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})}));var g=r(428);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})}));var v=r(207);Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedContentLogger=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(11),c=r(14),u=r(4);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=function(){function e(t){var r=this;(0,a.default)(this,e),this.m_frameData=[],this.m_metadata=t,this.m_metadata.dirtyRectTracking=u.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=u.Settings.readStringOrDefault("hostContainer","undefined"),this.m_percentiles=u.Settings.readStringOrDefault("animLogPercentiles","0, 25, 50, 75, 95, 99, 100").split(",").map(Number),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&(r.m_startTime=void 0)}))}return(0,o.default)(e,[{key:"logFrameData",value:function(t,r){var i=Date.now();if("hidden"!==document.visibilityState){if(!this.m_startTime&&t)this.m_startTime=i,this.m_lastFrameTime=this.m_startTime,this.m_frameData=[];else if(this.m_startTime&&t&&this.m_lastFrameTime)this.m_frameData.push(i-this.m_lastFrameTime),this.m_lastFrameTime=i;else if(this.m_startTime&&!t){var n=i-this.m_startTime;if(this.m_startTime=void 0,0===n||n<=u.Settings.readNumberOrDefault("animLogMinDurationMs",700))return;var a=this.m_frameData.length+1,o=1e3*a/n;this.m_frameData.sort((function(e,t){return e-t}));var d,m={},p=f(this.m_percentiles);try{for(p.s();!(d=p.n()).done;){var g=d.value,v=e.percentile(this.m_frameData,g);v&&(m[g.toString()]=v)}}catch(e){p.e(e)}finally{p.f()}var y=this.m_frameData.splice(-u.Settings.readNumberOrDefault("animLogWorstFrameCount",5)),_={Metadata:h(h({},this.m_metadata),r?r.metadata:void 0),FrameRate:o.toFixed(2),Duration:n,RenderedFrames:a,Worst:y,Percentile:m};if(s.ULS.sendTraceTag(595653954,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,JSON.stringify(_)),n<=u.Settings.readNumberOrDefault("animLogVetoMinDurationMs",1e3))return void s.ULS.sendTraceTag(595641933,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"AnimatedContentLogger::LogFrameData: Animation is too short, skip checking veto. duration:".concat(n));var S="SlideshowFPSSlow",T=u.Settings.readNumberOrDefault("animLogVetoMinFPS",24);if(l.ChangeGate.isChangeGateEnabled("SSC.SeparateSlowFPSVeto")&&r&&(r.qosVetoName&&(S=r.qosVetoName),r.vetoFps&&(T=r.vetoFps)),o<T&&!this.m_metadata.ignoreVeto&&c.VetoUtils.recordVeto("VetoedFPS".concat(this.m_metadata.type||""),{Info:_||this.m_metadata,FPS:o.toFixed(2),vetoFps:T,qosVeto:S}),y&&y.length>0){var b=u.Settings.readNumberOrDefault("animLogVetoWorstFrameIndex",2),C=Math.min(Math.max(b,0),y.length-1),w=y[y.length-1-C];w>u.Settings.readNumberOrDefault("animLogVetoMaxFrameDurationMs",300)&&c.VetoUtils.recordVeto("VetoedFrameDuration".concat(this.m_metadata.type||""),{Info:_||this.m_metadata,FrameDuration:w,qosVeto:S})}}}else this.m_startTime=void 0}},{key:"hasLogIntervalStarted",get:function(){return!!this.m_startTime}}],[{key:"percentile",value:function(e,t){if(0!==e.length)return 0===t?e[0]:e[Math.ceil(e.length*(t/100))-1];s.ULS.sendTraceTag(595653955,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"AnimatedContentLogger::percentile: invalid frameData.length . frameData:".concat(!!e,", percentile:").concat(!!t))}}])}();t.AnimatedContentLogger=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addErrorHandler=function(){window.addEventListener("error",(function(e){e.message.includes("ResizeObserver loop")||h(e.error||{message:e.message,name:""},e.filename,e.lineno,e.colno)})),window.addEventListener("unhandledrejection",(function(e){i.ULS.sendTraceTag(574883276,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Warning,"unhandledrejection: Reason:".concat(e.reason)),e.reason instanceof Error&&h(e.reason)}))},t.stringifyError=d,t.stringifyException=function(e){return e instanceof Error?d(e):"".concat(e)};var i=r(3),n=r(11),a=r(14),o=r(404);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function c(e){try{if(!e||!n.ChangeGate.isChangeGateEnabled("SSC.AllowLoggingStackFileNames"))return;var t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return void i.ULS.sendTraceTag(574883277,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Warning,"sanitizeUrl exception")}}function u(e,t,r,n){var a="",l=[];try{e.stack&&(l=(0,o.parse)(e))}catch(e){i.ULS.sendTraceTag(545122112,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Warning,"errorStackParser.parse exception")}var u,d=s(l);try{for(d.s();!(u=d.n()).done;){var h=u.value;h.fileName&&(h.fileName=c(h.fileName)),a&&(a+="\n"),a+=h.toString()}}catch(e){d.e(e)}finally{d.f()}return{msg:e.message,name:e.name,filename:c(t),lineno:r,colno:n,stack:a}}function d(e,t,r,i){return JSON.stringify(u(e,t,r,i))}function h(e,t,r,n){var o=u(e,t,r,n);i.ULS.sendTraceTag(574883278,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Warning,JSON.stringify(o)),a.VetoUtils.recordVeto("Crash",o)}},function(e,t,r){"use strict";var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowRole=t.SlideShowUIContainerNames=void 0,function(e){e.SlideShowUIRootContainer="SlideShowUIRootContainer",e.ThumbnailStrip="ThumbnailStrip",e.NotesPane="NotesPane",e.SlideShowToolbar="SlideShowToolbar",e.GridView="GridView",e.ResumeSlideShow="ResumeSlideShow",e.SlideShowTop="SlideShowTop",e.OpticalZoomPopover="OpticalZoomPopover"}(i||(t.SlideShowUIContainerNames=i={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(n||(t.SlideShowRole=n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(178);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(382);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(383);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(384);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(179);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(221);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(105);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(37);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(70);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(85);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(12);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(103);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}));var u=r(30);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})}));var d=r(130);Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}));var h=r(27);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})}));var f=r(222);Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})}));var m=r(36);Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}));var p=r(224);Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})}));var g=r(16);Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})}));var v=r(39);Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Fade=t.DrawFadeOptions=t.DrawFadeOrder=t.DrawFadeMode=t.FadePreset=void 0;var n,a,o,s=i(r(1)),l=i(r(2)),c=r(37),u=r(12),d=r(59);t.FadePreset=n,function(e){e[e.uniform=0]="uniform",e[e.blinds=1]="blinds",e[e.box=2]="box",e[e.checkerBoard=3]="checkerBoard",e[e.circle=4]="circle",e[e.diamond=5]="diamond",e[e.dissolve=6]="dissolve",e[e.plus=7]="plus",e[e.randomBars=8]="randomBars",e[e.split=9]="split",e[e.strips=10]="strips",e[e.wedge=11]="wedge",e[e.wheel=12]="wheel",e[e.draw=13]="draw"}(n||(t.FadePreset=n={})),t.DrawFadeMode=a,function(e){e[e.simple=0]="simple",e[e.zigzag=1]="zigzag",e[e.corner=2]="corner",e[e.center=3]="center",e[e.lines=4]="lines",e[e.randomLines=5]="randomLines",e[e.spiral=6]="spiral"}(a||(t.DrawFadeMode=a={})),t.DrawFadeOrder=o,function(e){e[e.together=0]="together",e[e.darkFirst=1]="darkFirst",e[e.brightFirst=2]="brightFirst"}(o||(t.DrawFadeOrder=o={}));var h=function(){function e(t,r){(0,s.default)(this,e),this.mode=t,this.order=r}return(0,l.default)(e,[{key:"clone",value:function(){return new e(this.mode,this.order)}},{key:"equals",value:function(e){return this.mode==e.mode&&this.order==e.order}}])}();t.DrawFadeOptions=h,h.Default=new h(a.zigzag,o.darkFirst);var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.uniform,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];(0,s.default)(this,e),this.m_changeTracker=new c.ChangeTracker,this.m_presetChangeTracker=new c.ChangeTracker,this.m_preset=t,this.m_param=r,this.m_flipX=i,this.m_flipY=a,this.m_transposeXY=o,this.m_reverse=l,this.m_isDistributedByLength=u,this.m_progress=0}return(0,l.default)(e,[{key:"clone",value:function(){var t=new e(this.m_preset,this.m_param,this.m_flipX,this.m_flipY,this.m_transposeXY,this.m_reverse,this.m_isDistributedByLength);return t.m_drawFadeOptions=this.m_drawFadeOptions,t.m_progress=this.m_progress,t}},{key:"equals",value:function(e){return this.m_progress==e.m_progress&&this.m_preset==e.m_preset&&this.m_param==e.m_param&&this.m_flipX==e.m_flipX&&this.m_flipY==e.m_flipY&&this.m_transposeXY==e.m_transposeXY&&this.m_reverse==e.m_reverse&&this.m_isDistributedByLength==e.m_isDistributedByLength&&this.m_drawFadeOptions==e.m_drawFadeOptions}},{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"presetChangeTracker",get:function(){return this.m_presetChangeTracker}},{key:"progress",get:function(){return this.m_progress},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_progress,e),this.m_progress=e}},{key:"preset",get:function(){return this.m_preset},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_preset,e),(0,d.notifyIfDifferent)(this.m_presetChangeTracker,this.m_preset,e),this.m_preset=e}},{key:"param",get:function(){return this.m_param},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_param,e),this.m_param=e}},{key:"flipX",get:function(){return this.m_flipX},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_flipX,e),this.m_flipX=e}},{key:"flipY",get:function(){return this.m_flipY},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_flipY,e),this.m_flipY=e}},{key:"transposeXY",get:function(){return this.m_transposeXY},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_transposeXY,e),this.m_transposeXY=e}},{key:"reverse",get:function(){return this.m_reverse},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_reverse,e),this.m_reverse=e}},{key:"isDistributedByLength",get:function(){return this.m_isDistributedByLength},set:function(e){(0,d.notifyIfDifferent)(this.m_changeTracker,this.m_isDistributedByLength,e),this.m_isDistributedByLength=e}},{key:"drawFadeOptions",get:function(){return this.m_drawFadeOptions},set:function(e){(0,d.notifyIfNotEquals)(this.m_changeTracker,this.m_drawFadeOptions,e),this.m_drawFadeOptions=e}},{key:"getFadeTransform",value:function(){var e=u.Vector2.Flip(this.flipX,this.flipY);return new u.Matrix3(this.transposeXY?0:e.x,this.transposeXY?e.x:0,0,this.transposeXY?e.y:0,this.transposeXY?0:e.y,0,0,0,1)}}])}();t.Fade=f},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=t.Observer=t.EventState=void 0;var n=i(r(1)),a=i(r(2));function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var l=(0,a.default)((function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;(0,n.default)(this,e),this.initialize(t,r,i,a)}),[{key:"initialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this.mask=e,this.skipNextObservers=t,this.target=r,this.currentTarget=i,this}}]);t.EventState=l;var c=(0,a.default)((function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,n.default)(this,e),this.callback=t,this.mask=r,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}),[{key:"remove",value:function(){this._remove&&this._remove()}}]);t.Observer=c;var u=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,n.default)(this,e),this.notifyIfTriggered=r,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new l(0),t&&(this._onObserverAdded=t)}return(0,a.default)(e,[{key:"observers",get:function(){return this._observers}},{key:"add",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;var o=new c(e,r,n);return o.unregisterOnNextCall=a,i?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(o,this._lastNotifiedValue),o._remove=function(){t.remove(o)},o}},{key:"addOnce",value:function(e){return this.add(e,void 0,void 0,void 0,!0)}},{key:"remove",value:function(e){return!!e&&(e._remove=null,-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))}},{key:"removeCallback",value:function(e,t){for(var r=0;r<this._observers.length;r++){var i=this._observers[r];if(!(i._willBeUnregistered||i.callback!==e||t&&t!==i.scope))return this._deferUnregister(i),!0}return!1}},{key:"_deferUnregister",value:function(e){var t=this;e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((function(){t._remove(e)}),0))}},{key:"_remove",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;var r=this._observers.indexOf(e);return-1!==r&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(r,1),!0)}},{key:"makeObserverTopPriority",value:function(e){this._remove(e,!1),this._observers.unshift(e)}},{key:"makeObserverBottomPriority",value:function(e){this._remove(e,!1),this._observers.push(e)}},{key:"notifyObservers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;var a=this._eventState;a.mask=t,a.target=r,a.currentTarget=i,a.skipNextObservers=!1,a.lastReturnValue=e,a.userInfo=n;var s,l=o(this._observers);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(!c._willBeUnregistered&&(c.mask&t&&(c.unregisterOnNextCall&&this._deferUnregister(c),c.scope?a.lastReturnValue=c.callback.apply(c.scope,[e,a]):a.lastReturnValue=c.callback(e,a)),a.skipNextObservers))return!1}}catch(e){l.e(e)}finally{l.f()}return!0}},{key:"notifyObserver",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),!e._willBeUnregistered){var i=this._eventState;i.mask=r,i.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,i)}}},{key:"hasObservers",value:function(){return this._observers.length-this._numObserversMarkedAsDeleted>0}},{key:"clear",value:function(){for(;this._observers.length;){var e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}},{key:"cleanLastNotifiedState",value:function(){this._hasNotified=!1,this._lastNotifiedValue=void 0}},{key:"clone",value:function(){var t=new e;return t._observers=this._observers.slice(0),t}},{key:"hasSpecificMask",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=o(this._observers);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.mask&t||i.mask===t)return!0}}catch(e){r.e(e)}finally{r.f()}return!1}}],[{key:"FromPromise",value:function(t,r){var i=new e;return t.then((function(e){i.notifyObservers(e)})).catch((function(e){if(!r)throw e;r.notifyObservers(e)})),i}}])}();t.Observable=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStateObject=s,t.deleteStateObject=function(e){a.delete(e)},t.createRawShaderProgram=l,t.createShaderProgram=c,t.createPipelineContext=function(e,t){var r=new i.WebGLPipelineContext,n=s(e);return n.parallelShaderCompile&&(r.isParallelCompiled=!0),r.context=n._context,r},t._createShaderProgram=u,t._finalizePipelineContext=d,t._preparePipelineContext=function(e,t,r,i,n,a,o,u,d){var h,f,m=arguments.length>10?arguments[10]:void 0,p=arguments.length>11?arguments[11]:void 0,g=s(e.context);m||(m=null!==(h=g.createRawShaderProgramInjection)&&void 0!==h?h:l),p||(p=null!==(f=g.createShaderProgramInjection)&&void 0!==f?f:c);var v=e;v.program=i?m(v,t,r,v.context,d):p(v,t,r,u,v.context,d),v.program.__SPECTOR_rebuildProgram=o},t._setProgram=function(e,t){t.useProgram(e)},t._executeWhenRenderingStateIsCompiled=function(e,t){var r=e;if(r.isParallelCompiled){var i=r.onCompiled;r.onCompiled=function(){null==i||i(),t(e)}}else t(e)};var i=r(226),n=r(60),a=new WeakMap,o={_webGLVersion:2,cachedPipelines:{}};function s(e){var t=a.get(e);if(!t){if(!e)return o;t={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,cachedPipelines:{}},a.set(e,t)}return t}function l(e,t,r,i,n,a){var o,l=s(i);return a||(a=null!==(o=l._createShaderProgramInjection)&&void 0!==o?o:u),a(e,f(t,"vertex",i,l._contextWasLost),f(r,"fragment",i,l._contextWasLost),i,n,l.validateShaderPrograms)}function c(e,t,r,i,n){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6?arguments[6]:void 0,c=s(n);l||(l=null!==(a=c._createShaderProgramInjection)&&void 0!==a?a:u);var d=c._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",f=h(t,"vertex",i,d,n,c._contextWasLost),m=h(r,"fragment",i,d,n,c._contextWasLost);return l(e,f,m,n,o,c.validateShaderPrograms)}function u(e,t,r,i){var n=arguments.length>5?arguments[5]:void 0,a=i.createProgram();if(e.program=a,!a)throw new Error("Unable to create program");return i.attachShader(a,t),i.attachShader(a,r),i.linkProgram(a),e.context=i,e.vertexShader=t,e.fragmentShader=r,e.isParallelCompiled||d(e,i,n),a}function d(e,t,r){var i=e.context,n=e.vertexShader,a=e.fragmentShader,o=e.program;if(!i.getProgramParameter(o,i.LINK_STATUS)){if(!t.getShaderParameter(n,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(n);if(s)throw e.vertexCompilationError=s,new Error("VERTEX SHADER "+s)}if(!t.getShaderParameter(a,t.COMPILE_STATUS)){var l=t.getShaderInfoLog(a);if(l)throw e.fragmentCompilationError=l,new Error("FRAGMENT SHADER "+l)}var c=i.getProgramInfoLog(o);if(c)throw e.programLinkError=c,new Error(c)}if(r&&(i.validateProgram(o),!i.getProgramParameter(o,i.VALIDATE_STATUS))){var u=i.getProgramInfoLog(o);if(u)throw e.programValidationError=u,new Error(u)}i.deleteShader(n),i.deleteShader(a),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function h(e,t,r,i,a,o){return f((0,n._ConcatenateShader)(e,r,i),t,a,o)}function f(e,t,r,i){var n=r.createShader("vertex"===t?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!n){for(var a=r.NO_ERROR,o=r.NO_ERROR;(o=r.getError())!==r.NO_ERROR;)a=o;throw new Error("Something went wrong while creating a gl ".concat(t," shader object. gl error=").concat(a,", gl isContextLost=").concat(r.isContextLost(),", _contextWasLost=").concat(i))}return r.shaderSource(n,e),r.compileShader(n),n}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Effect=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(86),l=r(61),c=r(108),u=r(48),d=r(106);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var f=function(){function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,m=arguments.length>9?arguments[9]:void 0,p=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",g=arguments.length>11&&void 0!==arguments[11]?arguments[11]:u.ShaderLanguage.GLSL;(0,a.default)(this,e),this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new s.Observable,this.onErrorObservable=new s.Observable,this._onBindObservable=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=t,this._key=p;var v,y=this._key.replace(/\r/g,"").replace(/\n/g,"|"),_=void 0;if(r.attributes){var S,T,b,C=r;if(this._engine=i,this._attributesNames=C.attributes,this._uniformsNames=C.uniformsNames.concat(C.samplers),this._samplerList=C.samplers.slice(),this.defines=C.defines,this.onError=C.onError,this.onCompiled=C.onCompiled,this._fallbacks=C.fallbacks,this._indexParameters=C.indexParameters,this._transformFeedbackVaryings=C.transformFeedbackVaryings||null,this._multiTarget=!!C.multiTarget,this._shaderLanguage=null!==(S=C.shaderLanguage)&&void 0!==S?S:u.ShaderLanguage.GLSL,C.uniformBuffersNames){this._uniformBuffersNamesList=C.uniformBuffersNames.slice();for(var w=0;w<C.uniformBuffersNames.length;w++)this._uniformBuffersNames[C.uniformBuffersNames[w]]=w}this._processFinalCode=null!==(T=C.processFinalCode)&&void 0!==T?T:null,this._processCodeAfterIncludes=null!==(b=C.processCodeAfterIncludes)&&void 0!==b?b:void 0,_=C.existingPipelineContext}else this._engine=o,this.defines=null==l?"":l,this._uniformsNames=i.concat(n),this._samplerList=n?n.slice():[],this._attributesNames=r,this._uniformBuffersNamesList=[],this._shaderLanguage=g,this.onError=f,this.onCompiled=h,this._indexParameters=m,this._fallbacks=c;"WEBGL2"===this._engine.shaderPlatformName&&(_=null!==(v=(0,d.getCachedPipeline)(y,this._engine._gl))&&void 0!==v?v:_),this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++,_?(this._pipelineContext=_,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCode()}return(0,o.default)(e,[{key:"onBindObservable",get:function(){return this._onBindObservable||(this._onBindObservable=new s.Observable),this._onBindObservable}},{key:"shaderLanguage",get:function(){return this._shaderLanguage}},{key:"_processShaderCode",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._processingContext=i||this._engine._getShaderProcessingContext(this._shaderLanguage);var n={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:null!=t?t:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:c.ShaderStore.GetShadersRepository(this._shaderLanguage),includesShadersStore:c.ShaderStore.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,d._processShaderCode)(n,this.name,this._processFinalCode,(function(t,i){e._vertexSourceCode=t,e._fragmentSourceCode=i,e._prepareEffect(r)}),this._shaderLanguage,this._engine,this)}},{key:"key",get:function(){return this._key}},{key:"isReady",value:function(){try{return this._isReadyInternal()}catch(e){return!1}}},{key:"_isReadyInternal",value:function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}},{key:"getEngine",value:function(){return this._engine}},{key:"getPipelineContext",value:function(){return this._pipelineContext}},{key:"getAttributesNames",value:function(){return this._attributesNames}},{key:"getAttributeLocation",value:function(e){return this._attributes[e]}},{key:"getAttributeLocationByName",value:function(e){return this._attributeLocationByName[e]}},{key:"getAttributesCount",value:function(){return this._attributes.length}},{key:"getUniformIndex",value:function(e){return this._uniformsNames.indexOf(e)}},{key:"getUniform",value:function(e){return this._uniforms[e]}},{key:"getSamplers",value:function(){return this._samplerList}},{key:"getUniformNames",value:function(){return this._uniformsNames}},{key:"getUniformBuffersNames",value:function(){return this._uniformBuffersNamesList}},{key:"getIndexParameters",value:function(){return this._indexParameters}},{key:"getCompilationError",value:function(){return this._compilationError}},{key:"allFallbacksProcessed",value:function(){return this._allFallbacksProcessed}},{key:"executeWhenCompiled",value:function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((function(){t._checkIsReady(null)}),16))}},{key:"_checkIsReady",value:function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}this._isDisposed||setTimeout((function(){t._checkIsReady(e)}),16)}},{key:"vertexSourceCode",get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getVertexShaderCode())&&void 0!==e?e:this._vertexSourceCode}},{key:"fragmentSourceCode",get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode())&&void 0!==e?e:this._fragmentSourceCode}},{key:"vertexSourceCodeBeforeMigration",get:function(){return this._vertexSourceCodeBeforeMigration}},{key:"fragmentSourceCodeBeforeMigration",get:function(){return this._fragmentSourceCodeBeforeMigration}},{key:"rawVertexSourceCode",get:function(){return this._rawVertexSourceCode}},{key:"rawFragmentSourceCode",get:function(){return this._rawFragmentSourceCode}},{key:"getPipelineGenerationOptions",value:function(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}},{key:"_rebuildProgram",value:function(e,t,r,i){var n=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){i&&i(t)},this.onCompiled=function(){var e,t,i=n.getEngine().scenes;if(i)for(var a=0;a<i.length;a++)i[a].markAllMaterialsAsDirty(63);null===(e=(t=n._pipelineContext)._handlesSpectorRebuildCallback)||void 0===e||e.call(t,r)},this._fallbacks=null,this._prepareEffect()}},{key:"_onRenderingStateCompiled",value:function(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(var t=0;t<this._attributesNames.length;t++){var r=this._attributesNames[t];this._attributeLocationByName[r]=this._attributes[t]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh()}},{key:"_prepareEffect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this._pipelineContext;this._isReady=!1;try{var i=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),n=i?null:this.defines,a=i?this._vertexSourceCodeOverride:this._vertexSourceCode,o=i?this._fragmentSourceCodeOverride:this._fragmentSourceCode,s=this._engine;this._pipelineContext=(0,d.createAndPreparePipelineContext)({existingPipelineContext:t?r:null,vertex:a,fragment:o,context:"WEBGL2"===s.shaderPlatformName?s._gl:void 0,rebuildRebind:function(t,r,i,n){return e._rebuildProgram(t,r,i,n)},defines:n,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:i,parallelShaderCompile:s._caps.parallelShaderCompile,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:function(i){r&&!t&&e._engine._deletePipelineContext(r),i&&e._onRenderingStateCompiled(i)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContext.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(e){this._processCompilationErrors(e,r)}}},{key:"_getShaderCodeAndErrorLine",value:function(e,t,r){var i=r?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,n=null;if(t&&e){var a=t.match(i);if(a&&2===a.length){var o=parseInt(a[1]),s=e.split("\n",-1);s.length>=o&&(n="Offending line [".concat(o,"] in ").concat(r?"fragment":"vertex"," code: ").concat(s[o-1]))}}return[e,n]}},{key:"_processCompilationErrors",value:function(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=t.message;var a=this._attributesNames,o=this._fallbacks;if(l.Logger.Error("Unable to compile effect:"),l.Logger.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),l.Logger.Error("Attributes: "+a.map((function(e){return" "+e}))),l.Logger.Error("Defines:\n"+this.defines),e.LogShaderCodeOnCompilationError){var s,c,u=null,d=null,h=null;if(null!==(s=this._pipelineContext)&&void 0!==s&&s._getVertexShaderCode()){var f=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),m=(0,n.default)(f,2);h=m[0],u=m[1],h&&(l.Logger.Error("Vertex code:"),l.Logger.Error(h))}if(null!==(c=this._pipelineContext)&&void 0!==c&&c._getFragmentShaderCode()){var p,g=this._getShaderCodeAndErrorLine(null===(p=this._pipelineContext)||void 0===p?void 0:p._getFragmentShaderCode(),this._compilationError,!0),v=(0,n.default)(g,2);h=v[0],d=v[1],h&&(l.Logger.Error("Fragment code:"),l.Logger.Error(h))}u&&l.Logger.Error(u),d&&l.Logger.Error(d)}l.Logger.Error("Error: "+this._compilationError);var y=function(){r.onError&&r.onError(r,r._compilationError),r.onErrorObservable.notifyObservers(r)};i&&(this._pipelineContext=i,this._isReady=!0,y()),o?(this._pipelineContext=null,o.hasMoreFallbacks?(this._allFallbacksProcessed=!1,l.Logger.Error("Trying next fallback."),this.defines=o.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,y(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,i||y())}},{key:"isSupported",get:function(){return""===this._compilationError}},{key:"_bindTexture",value:function(e,t){this._engine._bindTexture(this._samplers[e],t,e)}},{key:"setTexture",value:function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}},{key:"setTextureArray",value:function(e,t){var r=e+"Ex";if(-1===this._samplerList.indexOf(r+"0")){for(var i=this._samplerList.indexOf(e),n=1;n<t.length;n++){var a=r+(n-1).toString();this._samplerList.splice(i+n,0,a)}var o,s=0,l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this._samplerList);try{for(l.s();!(o=l.n()).done;){var c=o.value;this._samplers[c]=s,s+=1}}catch(e){l.e(e)}finally{l.f()}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}},{key:"bindUniformBuffer",value:function(t,r){var i=this._uniformBuffersNames[r];void 0===i||e._BaseCache[i]===t&&this._engine._features.useUBOBindingCache||(e._BaseCache[i]=t,this._engine.bindUniformBufferBase(t,i,r))}},{key:"bindUniformBlock",value:function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}},{key:"setInt",value:function(e,t){return this._pipelineContext.setInt(e,t),this}},{key:"setInt2",value:function(e,t,r){return this._pipelineContext.setInt2(e,t,r),this}},{key:"setInt3",value:function(e,t,r,i){return this._pipelineContext.setInt3(e,t,r,i),this}},{key:"setInt4",value:function(e,t,r,i,n){return this._pipelineContext.setInt4(e,t,r,i,n),this}},{key:"setIntArray",value:function(e,t){return this._pipelineContext.setIntArray(e,t),this}},{key:"setIntArray2",value:function(e,t){return this._pipelineContext.setIntArray2(e,t),this}},{key:"setIntArray3",value:function(e,t){return this._pipelineContext.setIntArray3(e,t),this}},{key:"setIntArray4",value:function(e,t){return this._pipelineContext.setIntArray4(e,t),this}},{key:"setUInt",value:function(e,t){return this._pipelineContext.setUInt(e,t),this}},{key:"setUInt2",value:function(e,t,r){return this._pipelineContext.setUInt2(e,t,r),this}},{key:"setUInt3",value:function(e,t,r,i){return this._pipelineContext.setUInt3(e,t,r,i),this}},{key:"setUInt4",value:function(e,t,r,i,n){return this._pipelineContext.setUInt4(e,t,r,i,n),this}},{key:"setUIntArray",value:function(e,t){return this._pipelineContext.setUIntArray(e,t),this}},{key:"setUIntArray2",value:function(e,t){return this._pipelineContext.setUIntArray2(e,t),this}},{key:"setUIntArray3",value:function(e,t){return this._pipelineContext.setUIntArray3(e,t),this}},{key:"setUIntArray4",value:function(e,t){return this._pipelineContext.setUIntArray4(e,t),this}},{key:"setFloatArray",value:function(e,t){return this._pipelineContext.setArray(e,t),this}},{key:"setFloatArray2",value:function(e,t){return this._pipelineContext.setArray2(e,t),this}},{key:"setFloatArray3",value:function(e,t){return this._pipelineContext.setArray3(e,t),this}},{key:"setFloatArray4",value:function(e,t){return this._pipelineContext.setArray4(e,t),this}},{key:"setArray",value:function(e,t){return this._pipelineContext.setArray(e,t),this}},{key:"setArray2",value:function(e,t){return this._pipelineContext.setArray2(e,t),this}},{key:"setArray3",value:function(e,t){return this._pipelineContext.setArray3(e,t),this}},{key:"setArray4",value:function(e,t){return this._pipelineContext.setArray4(e,t),this}},{key:"setMatrices",value:function(e,t){return this._pipelineContext.setMatrices(e,t),this}},{key:"setMatrix",value:function(e,t){return this._pipelineContext.setMatrix(e,t),this}},{key:"setMatrix3x3",value:function(e,t){return this._pipelineContext.setMatrix3x3(e,t),this}},{key:"setMatrix2x2",value:function(e,t){return this._pipelineContext.setMatrix2x2(e,t),this}},{key:"setFloat",value:function(e,t){return this._pipelineContext.setFloat(e,t),this}},{key:"setBool",value:function(e,t){return this._pipelineContext.setInt(e,t?1:0),this}},{key:"setVector2",value:function(e,t){return this._pipelineContext.setVector2(e,t),this}},{key:"setFloat2",value:function(e,t,r){return this._pipelineContext.setFloat2(e,t,r),this}},{key:"setVector3",value:function(e,t){return this._pipelineContext.setVector3(e,t),this}},{key:"setFloat3",value:function(e,t,r,i){return this._pipelineContext.setFloat3(e,t,r,i),this}},{key:"setVector4",value:function(e,t){return this._pipelineContext.setVector4(e,t),this}},{key:"setQuaternion",value:function(e,t){return this._pipelineContext.setQuaternion(e,t),this}},{key:"setFloat4",value:function(e,t,r,i,n){return this._pipelineContext.setFloat4(e,t,r,i,n),this}},{key:"setColor3",value:function(e,t){return this._pipelineContext.setColor3(e,t),this}},{key:"setColor4",value:function(e,t,r){return this._pipelineContext.setColor4(e,t,r),this}},{key:"setDirectColor4",value:function(e,t){return this._pipelineContext.setDirectColor4(e,t),this}},{key:"dispose",value:function(){this._pipelineContext&&(0,d.resetCachedPipeline)(this._pipelineContext),this._engine._releaseEffect(this),this._isDisposed=!0}}],[{key:"ShadersRepository",get:function(){return c.ShaderStore.ShadersRepository},set:function(e){c.ShaderStore.ShadersRepository=e}},{key:"RegisterShader",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.ShaderLanguage.GLSL;t&&(c.ShaderStore.GetShadersStore(i)["".concat(e,"PixelShader")]=t),r&&(c.ShaderStore.GetShadersStore(i)["".concat(e,"VertexShader")]=r)}},{key:"ResetCache",value:function(){e._BaseCache={}}}])}();t.Effect=f,f.LogShaderCodeOnCompilationError=!0,f._UniqueIdSeed=0,f._BaseCache={},f.ShadersStore=c.ShaderStore.ShadersStore,f.IncludesShadersStore=c.ShaderStore.IncludesShadersStore},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.applyBlur=function(e,t,r,i,n,a){var o=e.getGraphicsProcessor();if(o){var s=e.ensureScratchBuffers(),l=s[0],h=s[1],f=i==u.EffectFlags.glow?.12*r:i==u.EffectFlags.softEdges?.47*r:i==u.EffectFlags.border?.5*r:r,m=i==u.EffectFlags.glow?.3*r:i==u.EffectFlags.softEdges?r:i==u.EffectFlags.border?.5*r:r,g=i==u.EffectFlags.glow||i==u.EffectFlags.border?3:i==u.EffectFlags.softEdges?2:n?1:0,v=i==u.EffectFlags.border?3:n?1:0,y=i!=u.EffectFlags.glow&&i!=u.EffectFlags.softEdges;_(o,h.size.divide(t.size),t,h,n?d.Color.Black:void 0,f,g,new c.Vector2(1,0),y,i==u.EffectFlags.border,a),_(o,c.Vector2.One,h,l,n?d.Color.Black:void 0,f,g,new c.Vector2(0,1),y,i==u.EffectFlags.border,void 0),_(o,c.Vector2.One,l,h,n?d.Color.Black:void 0,m,v,new c.Vector2(1,0),!0,i==u.EffectFlags.border,void 0),_(o,t.size.divide(l.size),h,t,n,m,v,new c.Vector2(0,1),!0,i==u.EffectFlags.border,void 0)}else p.Log.Error(592525249,"No GraphicsProcessor")},t.runMedianProgram=function(e,t,r,i){var n=e.activateShaderProgram(m.ProgramId.median);n.begin(r.tryUseBabylonTargetTexture(e,void 0,"medianResize/destination"),d.Color.Red,!1);var a=n.getBabylonEffect(),o=c.Vector2.One.divide(t.size);n.setTexture("t_0",t.tryUseBabylonTexture(e,void 0,"medianResize/source")),a.setVector2("ufrag_0",o),a.setDirectColor4("ufrag_1",i),n.drawQuads(1),n.end()},t.getTextureContentTransformUV=S,t.getPictureOverflowBounds=x,t.drawLayer=function(e,t,r,i,n,a,o){var s,l,m,g,_,T=t instanceof C?t:void 0,b=t instanceof w?t:void 0,k=t instanceof P?t:void 0,R=b?b.textureA:T?T.texture:void 0,O=b?b.textureB:T?T.mask:void 0,D=b&&b.panVector&&(!R||!O),F=0;b&&(F=D?R?0:1:b.progress);var B=T?T.reflectionGradient:void 0,N=t instanceof I&&!R;if(N||R&&R.isValidForGraphicsProcessor(e)||O&&O.isValidForGraphicsProcessor(e)){var V=t.contentCenter,U=c.Matrix3.Identity,W=c.Matrix3.Identity,G=r.getBabylonEffect(),H=r.getBabylonEngine();if(b&&b.morphingGrid&&2==b.morphingGrid.length)G.setInt("u_16",1),G.setFloat("u_17",b.progress),H.bindInstancesBuffer(b.morphingGrid[0],v),H.bindInstancesBuffer(b.morphingGrid[1],y),U=c.Matrix3.Scale2D(t.contentSize),W=c.Matrix3.Scale2D(t.contentSize);else{G.setInt("u_16",0),G.setFloat("u_17",0),r.setDummyPointerAttribute("a_0"),r.setDummyPointerAttribute("a_1");var j=R?E(R.contentLocation,t.contentSize,t.contentCenter):N?c.Rect.FromSizeAndCenter(t.contentSize,t.contentCenter):void 0,z=O?E(O.contentLocation,t.contentSize,t.contentCenter):void 0,q=j&&z?c.Rect.UnionRect(j,z):j||z;if(t instanceof I&&t.style.pictureOverflow>0&&t.style.pictureBrush&&t.pictureTexture){var Z=x(t.fillBoundsOverride?t.fillBoundsOverride:c.Rect.FromSizeAndCenter(t.contentSize,t.contentCenter),t.style.pictureBrush,t.pictureTexture);Z&&(q=c.Rect.UnionRect(q,Z))}if(!q)return void p.Log.Error(592525253,"Undefined physical bounds");if(q=q.translate(t.contentCenter.negate()),!(q=(q=t.effectTransform?q.transformedBounds(t.effectTransform):q)&&t.localClipRect?c.Rect.IntersectRect(q,t.localClipRect):q))return;q=q.translate(t.contentCenter),U=c.Matrix3.ScaleTranslation2D(q.size,q.center.subtract(V));var X=t.effectTransform?t.effectTransform.inverse():void 0;W=X?U.multiply(X):U}var Y=R?W.multiply(S(R,t.contentSize)):c.Matrix3.Identity,J=O?W.multiply(S(O,t.contentSize)):c.Matrix3.Identity,K=c.Matrix3.Identity;if(t instanceof I&&t.textCutoutTexture&&R){var Q=t.textCutoutTransform||c.Matrix3.Identity;K=W.multiply(Q).multiply(S(t.textCutoutTexture,t.contentSize))}var $=V;D&&b&&b.panVector&&($=V.add(b.panVector.scale(b.progress-(O?1:0))));var ee=c.Matrix3.RotationZ(t.contentRotation).multiply(c.Matrix3.Translation2D($));n&&(ee=ee.multiply(n)),t.textureFlip&&(U=U.multiply(c.Matrix3.Scale2D(t.textureFlip))),G.setMatrix3x3("u_0",U.m),G.setVector2("u_15",t.contentFlip),G.setMatrix3x3("u_1",ee.m),G.setVector2("u_2",i),G.setMatrix3x3("u_3",Y.m),G.setMatrix3x3("u_11",K.m),G.setMatrix3x3("u_4",J.m),G.setFloat2("ufrag_12",B?B.opacity0:1,B?B.opacity1:1),G.setVector2("u_20",B?B.pos0:c.Vector2.Zero),G.setVector2("u_21",B?B.pos1:c.Vector2.Zero),G.setDirectColor4("ufrag_13",a||d.Color.Transparent),G.setFloat("ufrag_36",F);var te=t.fadeInfo?t.fadeInfo.fadeTexture:void 0;r.setTexture("t_3",te?te.tryUseBabylonTexture(e,t.clientObject,"fadeTexture"):void 0);var re,ie=0;if(t.fadeInfo&&t.fadeInfo.fade){ie=t.fadeInfo.fadeMode;var ne=t.fadeInfo.fade,ae=ne.reverse?1-ne.progress:ne.progress;G.setVector2("ufrag_17",function(e,t,r){var i=10;if(e.preset==h.FadePreset.uniform)i=1;else if(e.preset==h.FadePreset.draw){var n,a=null!==(n=e.drawFadeOptions)&&void 0!==n?n:h.DrawFadeOptions.Default;i=r&&a.mode==h.DrawFadeMode.simple?1:Math.max(10,30)}return e.reverse?new c.Vector2(i-1,1-t*i):new c.Vector2(1-i,t*i)}(ne,ae,t instanceof I&&void 0!==t.pictureTexture)),ne.preset!=h.FadePreset.uniform&&(t.fadeInfo.fadeTexture&&t.fadeInfo.fadeTexture.isValidForGraphicsProcessor(e)?G.setMatrix3x3("u_10",ne.preset==h.FadePreset.draw?W.multiply(S(t.fadeInfo.fadeTexture,t.contentSize)).m:Y.multiply(ne.getFadeTransform()).m):p.Log.Error(592525254,"fade texture missing"))}if(G.setInt("ufrag_16",ie),G.setFloat("u_18",t.depthFar),G.setFloat("u_19",t.depthNear),G.setFloat("ufrag_41",t.overallOpacity),G.setMatrix3x3("ufrag_42",null!==(s=null===(l=t.colorMatrix)||void 0===l?void 0:l.m)&&void 0!==s?s:c.Matrix3.Identity.m),G.setVector3("ufrag_43",null!==(m=t.colorOffset)&&void 0!==m?m:c.Vector3.Zero),G.setDirectColor4("ufrag_44",null!==(g=t.colorize)&&void 0!==g?g:d.Color.Transparent),G.setInt("ufrag_45",null!==(_=t.pictureFillMode)&&void 0!==_?_:0),t instanceof I)!function(e,t,r,i,n,a){var o=r.texture,s=r.style;t.setFloat("ufrag_0",r.distRangeSize?.5/r.distRangeSize:1),t.setInt("ufrag_34",o?0:1);var l=7==a&&s.hitTransparentFill,h=s.fillBrush,m=l?d.BrushType.solid:h?h.getType():d.BrushType.none,g=m==d.BrushType.image?r.fillTexture:void 0;m!=d.BrushType.image||g||(m=d.BrushType.none);var v=h instanceof d.SolidBrush?!h.color.equals(d.Color.Transparent):m!=d.BrushType.none;if(t.setInt("ufrag_10",r.hideFill?d.BrushType.none:m),m==d.BrushType.rectangularGradient)t.setFloatArray4("ufrag_3",A(h));else{var y=l?d.Color.White:m==d.BrushType.solid?h.color:m==d.BrushType.pattern?h.foregroundColor:d.Color.Transparent;t.setDirectColor4("ufrag_3",y)}t.setInt("ufrag_18",m==d.BrushType.image&&g&&g.wrapMode==d.WrapMode.clamp?1:0),t.setFloat("ufrag_20",m==d.BrushType.image?h.opacity:1),t.setInt("u_13",m==d.BrushType.pattern?1:0),t.setMatrix3x3("u_4",r.fillTransformUV?m==d.BrushType.pattern?r.fillTransformUV.m:i.multiply(r.fillTransformUV).m:i.m),t.setDirectColor4("ufrag_22",m==d.BrushType.pattern?h.backgroundColor:d.Color.Transparent),t.setFloat("ufrag_28",r.fillBrightness);var _=r.pictureTexture;if(t.setInt("ufrag_30",r.hideFill||!_?0:1),_){var T=s.pictureBrush;t.setInt("ufrag_31",_&&_.wrapMode==d.WrapMode.clamp?1:0),t.setFloat("ufrag_32",T.opacity),t.setMatrix3x3("u_5",r.pictureTransformUV?i.multiply(r.pictureTransformUV).m:c.Matrix3.Identity.m)}var b=0;if(f.debugMode==f.debug_thinLine)b=f.s_debug_thinLine_value;else if(7==a&&s.hasLine&&!v&&!_){var C;b=null!==(C=s.hitTestSlop)&&void 0!==C?C:f.s_hitTestSlop}var w=r.hideLine||2==a||!s.lineBrush?d.BrushType.none:s.lineBrush.getType(),P=w==d.BrushType.image?r.lineTexture:void 0;w!=d.BrushType.image||P||(w=d.BrushType.none),b&&(w=d.BrushType.solid);var I=f.debugMode==f.debug_thinLine?b:Math.max(b,s.hasLine?s.pen.adjustedLineWidth:0);if(t.setFloat("ufrag_1",I),t.setInt("ufrag_11",w),w==d.BrushType.rectangularGradient)t.setFloatArray4("ufrag_4",A(s.lineBrush));else{var k=d.Color.Transparent;b?k=f.debugMode==f.debug_thinLine?d.Color.Red:d.Color.White:w==d.BrushType.solid?k=s.lineBrush.color:w==d.BrushType.pattern&&(k=s.lineBrush.foregroundColor),t.setDirectColor4("ufrag_4",k)}t.setInt("ufrag_19",w==d.BrushType.image&&P&&P.wrapMode==d.WrapMode.clamp?1:0),t.setFloat("ufrag_21",w==d.BrushType.image?s.lineBrush.opacity:1),t.setInt("u_14",w==d.BrushType.pattern?1:0),t.setMatrix3x3("u_6",r.lineTransformUV?w==d.BrushType.pattern?r.lineTransformUV.m:i.multiply(r.lineTransformUV).m:i.m),t.setDirectColor4("ufrag_23",w==d.BrushType.pattern?s.lineBrush.backgroundColor:d.Color.Transparent),t.setFloat("ufrag_29",r.mergeMode==u.MergeMode.union?1:0),t.setFloat("ufrag_6",s.pen&&s.pen.dashType!=d.PenDash.solid&&s.pen.useRoundDash?1:0);var E=b?M[d.PenCompound.simple]:function(e){return!e.compoundType||e.tipType?M[d.PenCompound.simple]:e.compoundType>=0&&e.compoundType<M.length?M[e.compoundType]:(p.Log.Error(587220940,"unsupported compoundType"),M[d.PenCompound.simple])}(s.pen);t.setFloatArray3("ufrag_8",E.centers),t.setFloatArray3("ufrag_9",E.slopes);var x=Math.sqrt(2)/2,L=new c.Vector2(x,x),R=n?n.transformVector(L).length():1;if(t.setFloat("ufrag_2",1/R),t.setFloat("ufrag_27",(0,c.clamp)((0,u.getPenAlignmentValue)(s.pen),-1,1)*I/2),t.setInt("ufrag_37",o&&2==r.distanceFieldMode?1:0),t.setInt("ufrag_38",s.pen.dashType==d.PenDash.solid&&s.pen.compoundType==d.PenCompound.simple||7==a?1:0),r.softEdges&&r.softEdges.radius>0&&r.softEdgesTexture&&r.softEdgesTexture.isValidForGraphicsProcessor(e)?(t.setInt("ufrag_24",1),t.setMatrix3x3("u_7",i.multiply(S(r.softEdgesTexture,r.contentSize)).m)):(t.setInt("ufrag_24",0),r.softEdges&&r.softEdges.radius>0&&p.Log.Error(588006213,"soft edges texture not ready")),r.innerShadow&&r.innerShadow.color.a>0&&r.innerShadowTexture&&r.innerShadowTexture.isValidForGraphicsProcessor(e)){var O=new c.Vector2(r.innerShadow.distance,0).rotate(r.innerShadow.angle),D=i.multiply(c.Matrix3.Translation2D(O)).multiply(S(r.innerShadowTexture,r.contentSize));t.setInt("ufrag_25",1),t.setMatrix3x3("u_8",D.m),t.setDirectColor4("ufrag_26",r.innerShadow.color)}else t.setInt("ufrag_25",0),r.innerShadow&&r.innerShadow.color.a>0&&p.Log.Error(588006214,"inner shadow  exture not ready");t.setInt("ufrag_39",r.textRenderMode||0),t.setFloat("ufrag_40",s.pictureOverflow),t.setInt("ufrag_15",7==a||5==a?1:f.debugMode==f.debug_relief?10:f.debugMode!=f.debug_OFF&&7!=f.debugMode?f.debugMode+10:0),f.debugMode==f.debug_thinLine&&(t.setInt("ufrag_10",0),t.setInt("ufrag_11",1)),0==a&&r.blendingMode==d.BlendingMode.cutout&&t.setDirectColor4("ufrag_13",d.Color.White)}(e,G,t,W,n,o),r.setTexture("t_0",R?R.tryUseBabylonTexture(e,t.clientObject,"distanceField"):void 0),r.setTexture("t_1",t.fillTexture?t.fillTexture.tryUseBabylonTexture(e,t.clientObject,"fillTexture"):void 0),r.setTexture("t_2",t.lineTexture?t.lineTexture.tryUseBabylonTexture(e,t.clientObject,"lineTexture"):void 0),r.setTexture("t_4",t.softEdgesTexture?t.softEdgesTexture.tryUseBabylonTexture(e,t.clientObject,"softEdgesTexture"):void 0),r.setTexture("t_5",t.innerShadowTexture?t.innerShadowTexture.tryUseBabylonTexture(e,t.clientObject,"innerShadowTexture"):void 0),t.pictureTexture&&7==o&&t.style.hitTransparentFill?re=e.whiteTexture:t.pictureTexture&&(re=t.pictureTexture.tryUseBabylonTexture(e,t.clientObject,"pictureTexture")),r.setTexture("t_6",re),r.setTexture("t_7",t.textCutoutTexture?t.textCutoutTexture.tryUseBabylonTexture(e,t.clientObject,"textCutoutTexture"):void 0);else!function(e){e.setFloat("ufrag_0",0),e.setFloat("ufrag_1",0),e.setFloat("ufrag_2",0),e.setDirectColor4("ufrag_3",d.Color.Transparent),e.setDirectColor4("ufrag_4",d.Color.Transparent),e.setFloat("ufrag_6",0),e.setFloatArray3("ufrag_8",new Float32Array([0,0,0])),e.setFloatArray3("ufrag_9",new Float32Array([0,0,0])),e.setInt("ufrag_10",0),e.setInt("ufrag_11",0),e.setInt("ufrag_18",0),e.setInt("ufrag_19",0),e.setFloat("ufrag_20",1),e.setFloat("ufrag_21",1),e.setDirectColor4("ufrag_22",d.Color.Transparent),e.setDirectColor4("ufrag_23",d.Color.Transparent),e.setInt("ufrag_24",0),e.setInt("ufrag_25",0),e.setDirectColor4("ufrag_26",d.Color.Transparent),e.setFloat("ufrag_27",0),e.setFloat("ufrag_28",0),e.setFloat("ufrag_29",0),e.setInt("ufrag_30",0),e.setInt("ufrag_31",0),e.setFloat("ufrag_32",0),e.setInt("ufrag_34",0),e.setInt("u_13",0),e.setInt("u_14",0),e.setInt("ufrag_39",0),e.setFloat("ufrag_40",0)}(G),G.setInt("ufrag_15",k?3:null!=T&&T.mask?4:2),r.setTexture("t_0",R?R.tryUseBabylonTexture(e,t.clientObject,t instanceof w?"morphA":"sprite"):void 0),r.setTexture("t_1",O?O.tryUseBabylonTexture(e,t.clientObject,t instanceof w?"morphB":"spriteMask"):void 0),r.setTexture("t_2",k?k.textureDeltaWhiteA.tryUseBabylonTexture(e,t.clientObject,"morphAW"):void 0),r.setTexture("t_4",k?k.textureDeltaWhiteB.tryUseBabylonTexture(e,t.clientObject,"morphBW"):void 0),r.setTexture("t_5",k?k.texturePictureA.tryUseBabylonTexture(e,t.clientObject,"morphAP"):void 0),r.setTexture("t_6",k?k.texturePictureB.tryUseBabylonTexture(e,t.clientObject,"morphBP"):void 0),r.setTexture("t_7",void 0),k&&G.setMatrix3x3("u_5",k.pictureTransformUV?W.multiply(k.pictureTransformUV).m:c.Matrix3.Identity.m);var oe=0==o,se=t.blendingMode==d.BlendingMode.darken||t.blendingMode==d.BlendingMode.multiply;oe&&t.blendingMode==d.BlendingMode.simulateOverlay?(G.setInt("ufrag_35",2),r.setBlendingMode(d.BlendingMode.multiply),L(r,t),G.setInt("ufrag_35",3),r.setBlendingMode(d.BlendingMode.add),L(r,t)):(G.setInt("ufrag_35",oe&&se?1:0),r.setBlendingMode(oe?t.blendingMode:d.BlendingMode.normal),L(r,t))}else p.Log.Error(592525252,"No Texture")},t.getRectangularGradientSlopes=A,t.DistanceFieldSpriteLayer=t.PictureMorphLayer=t.MorphLayer=t.SpriteLayer=t.Layer=t.s_enableDepthBufferInMorph=void 0;var n=i(r(9)),a=i(r(8)),o=i(r(10)),s=i(r(1)),l=i(r(2)),c=r(12),u=r(30),d=r(16),h=r(85),f=r(36),m=r(41),p=r(13);function g(e,t,r){return t=(0,a.default)(t),(0,n.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,a.default)(e).constructor):t.apply(e,r))}t.s_enableDepthBufferInMorph=!1;var v=[{attributeName:"a_0",attributeSize:2,offset:0,divisor:0}],y=[{attributeName:"a_1",attributeSize:2,offset:0,divisor:0}];function _(e,t,r,i,n,a,o,s,l,c,u){var h=r.tryUseBabylonTexture(e,u,"blurSrc");if(h){var f=i.tryGetBabylonTextureForRenderToTexture(e);if(f){var g=e.activateShaderProgram(m.ProgramId.blur);g.begin(f,d.Color.Transparent,!1);var v=g.getBabylonEffect();v.setFloat("u_0",a),v.setVector2("u_1",t),v.setVector2("u_2",s),v.setVector2("u_3",r.size),v.setInt("u_4",l?1:2),g.setTexture("tex_0",h),v.setDirectColor4("ufrag_0",n||d.Color.Transparent),v.setFloat("ufrag_2",c?0:Math.log(a/4)/Math.log(2)),v.setInt("ufrag_3",o),v.setInt("ufrag_4",l?1:2),g.drawQuads(1),g.end()}else p.Log.Error(572867298,"Invalid Texture")}else p.Log.Error(592525250,"Invalid Texture")}function S(e,t){var r=k(t,e.contentLocation.logicalSize),i=c.Matrix3.Scale2D(r.multiply(c.Vector2.Flip(e.contentLocation.flipX,e.contentLocation.flipY)));return(i=(i=(i=i.multiply(c.Matrix3.RotationZ(e.contentLocation.rotation))).multiply(c.Matrix3.Translation2D(e.contentLocation.logicalCenter))).multiply(c.Matrix3.Scale2D(e.size.inverse()))).multiply(c.Matrix3.Translation2D(new c.Vector2(-.5,-.5)))}function T(e){return e?e.size.x+"x"+e.size.y:"undefined"}var b=(0,l.default)((function e(t,r){(0,s.default)(this,e),this.contentRotation=0,this.depth=0,this.depthFar=0,this.depthNear=0,this.blendingMode=d.BlendingMode.normal,this.overallOpacity=1,this.contentCenter=t?t.center:c.Vector2.Zero,this.contentSize=t?t.size:c.Vector2.One,this.contentFlip=t?c.Vector2.Flip(t.flipX,t.flipY):c.Vector2.One,this.contentRotation=t?t.rotation:0,this.customMesh=r}),[{key:"getDebugStringInfo",value:function(){return["Layer"]}}]);t.Layer=b;var C=function(e){function t(e,r,i,n){var a;return(0,s.default)(this,t),(a=g(this,t,[r,i])).texture=e,a.mask=n,a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"getDebugStringInfo",value:function(){return["Texture: "+T(this.texture)+", Mask: "+T(this.mask),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}}])}(b);t.SpriteLayer=C;var w=function(e){function t(e,r,i,n,a,o){var l;return(0,s.default)(this,t),(l=g(this,t,[{center:c.Vector2.Zero,size:c.Vector2.One,rotation:0,flipX:!1,flipY:!1},a])).progress=0,l.textureA=e,l.textureB=r,l.panVector=o,i&&n&&(l.morphingGrid=[i,n]),l}return(0,o.default)(t,e),(0,l.default)(t,[{key:"getDebugStringInfo",value:function(){return["Textures: "+T(this.textureA)+"  "+T(this.textureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}}])}(b);t.MorphLayer=w;var P=function(e){function t(e,r,i,n,a,o,l,c,u,d){var h;return(0,s.default)(this,t),(h=g(this,t,[e,r,l,c,u,d])).textureDeltaWhiteA=i,h.textureDeltaWhiteB=n,h.texturePictureA=a,h.texturePictureB=o,h}return(0,o.default)(t,e),(0,l.default)(t,[{key:"getDebugStringInfo",value:function(){return["Textures: "+T(this.textureA)+"  "+T(this.textureB),"TexturesW: "+T(this.textureDeltaWhiteA)+"  "+T(this.textureDeltaWhiteB),"TextureP: "+T(this.texturePictureA)+"  "+T(this.texturePictureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}}])}(w);t.PictureMorphLayer=P;var I=function(e){function t(e,r,i,n){var a;return(0,s.default)(this,t),(a=g(this,t,[e,r,n])).fillBrightness=0,a.distanceFieldMode=2,a.style=i,a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"getDebugStringInfo",value:function(){return["Texture: "+T(this.texture),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}}])}(C);function k(e,t){return 0!=e.x&&0!=e.y?t.divide(e):0!=e.x?c.Vector2.One.scale(t.x/e.x):0!=e.y?c.Vector2.One.scale(t.y/e.y):c.Vector2.Zero}function E(e,t,r){var i=k(t,e.logicalSize),n=c.Rect.FromSizeAndCenter(e.physicalSize,e.physicalCenter.subtract(e.logicalCenter)),a=c.Matrix3.RotationZ(-e.rotation),o=c.Matrix3.ScaleTranslation2D(c.Vector2.Flip(e.flipX,e.flipY).divide(i),r);return n.transformedBounds(a.multiply(o))}function x(e,t,r,i){var n=(0,u.getAlignmentPoint)(t.alignment,e),a=t.isStretched?e:e.transformedBounds(new c.Transform(n.negate(),r.originalSize.divide(e.size),0,n));if(a){var o=t.isStretched?t.offset.multiply(a.size):t.offset,s=t.scale;if(t.isStretched&&t.fillToPreserveAspectRatio){var l=r.originalSize.x/r.originalSize.y,d=e.size.x/e.size.y;s=s.multiply(new c.Vector2(l>d?l/d:1,l<d?d/l:1))}var h=t.rotation?c.Matrix3.RotationAroundPoint(t.rotation,a.relativeToAbsolute(t.rotationCenter)):c.Transform.Identity,f=new c.Transform(n.negate(),s,0,n.add(o)),m=a.transformedBounds(c.Matrix3.FromTransforms(h,f));return m&&i?m.transformedBounds(i):m}}function L(e,t){t.customMesh?e.drawMesh(t.customMesh):e.drawQuads(1)}function A(e){var t=e.fillToRect?e.fillToRect:new c.Rect(.5,.5,.5,.5),r=e.fillFromRect?e.fillFromRect:new c.Rect(0,0,1,1),i=t.translate(r.leftTop.negate()).multiply(r.size.inverse());return new Float32Array([1/i.left,1/i.top,1/(1-i.right),1/(1-i.bottom)])}t.DistanceFieldSpriteLayer=I;var M=[{centers:new Float32Array([0,0,0]),slopes:new Float32Array([1,1,1])},{centers:new Float32Array([-2/3,2/3,2/3]),slopes:new Float32Array([3,3,3])},{centers:new Float32Array([-.4,.8,.8]),slopes:new Float32Array([5/3,5,5])},{centers:new Float32Array([-.8,.4,.4]),slopes:new Float32Array([5,5/3,5/3])},{centers:new Float32Array([-5/6,0,5/6]),slopes:new Float32Array([6,3,6])}]},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ensureClientData=m,t.findItems=function e(t,r){if(!r||0===r.length)return[t];var i,n=m(t).partId||"",a=u(r);try{for(a.s();!(i=a.n()).done;){if(n===i.value)return[t]}}catch(e){a.e(e)}finally{a.f()}if(t.getType()!==s.ItemType.group)return null;var o,l=[],c=u(t.items.elements);try{for(c.s();!(o=c.n()).done;){var d=e(o.value,r);d&&(l=l.concat(d))}}catch(e){c.e(e)}finally{c.f()}return 0===l.length?null:l},t.findItem=function e(t,r){if(!r)return t;if((m(t).partId||"")===r)return t;if(t.getType()!==s.ItemType.group)return null;var i,n=u(t.items.elements);try{for(n.s();!(i=n.n()).done;){var a=e(i.value,r);if(a)return a}}catch(e){n.e(e)}finally{n.f()}return null},t.getTextItem=function(e){return e.getType()===s.ItemType.shape?e:e.getType()===s.ItemType.group&&e.items.getAt(0).getType()===s.ItemType.shape?e.items.getAt(0):void 0},t.setShapeBuilderGlobals=function(e,t,r,i){var n=window.devicePixelRatio||1,a=e.x/t.x,o=e.y/t.y,u=Math.min(a,o)*n,d=new s.Vector2(e.x*n,e.y*n);u*=Math.min(1,Math.sqrt(Math.sqrt(2073600/(d.x*d.y)))),u*=l.Settings.readNumberOrDefault("hackShapeBuilderQualityScale",1);var h=t.x/r.x,f=t.x/d.x,m=25400*h,p=!!(e.x&&e.y&&u);if(p)(0,s.setQuality)(u),(0,s.setMinLineWidth)(f,m);else{var v="attempted to set invalid shapebuilder quality";c.ULS.sendTraceTag(545277320,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,i?i(new Error(v)):v)}var y=JSON.stringify({quality:u,minLineWidth:f,minLineWidthForArrowHead:m,devicePixelRatio:n,clientWidth:e.x,clientHeight:e.y,slideSizePixels:t,isValid:p});y!==g&&c.ULS.sendTraceTag(546096137,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,y),g=y},t.ShapeBuilderUlsLogger=t.ParseJsonUlsLogger=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(20),l=r(4),c=r(3);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var h=(0,o.default)((function e(t,r,i){(0,a.default)(this,e),this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=t,this.m_timeoutMs=r,this.m_startTimeMs=Date.now(),this.updateTimeout()}),[{key:"pause",value:function(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}},{key:"resume",value:function(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}},{key:"setTime",value:function(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}},{key:"addTime",value:function(e){this.m_timeoutMs+=e,this.updateTimeout()}},{key:"abort",value:function(){window.clearTimeout(this.m_timeoutId),this.m_callback=function(){}}},{key:"isPaused",get:function(){return this.m_pausedTimeMs>this.m_resumedTimeMs}},{key:"updateTimeout",value:function(){window.clearTimeout(this.m_timeoutId);var e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}}]);function f(e){var t="abcdefghijklmnopqrstuvwxyz0123456789";return e<=65535?e.toString():e>>24>=36?String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e):t.charAt(e>>24&63)+t.charAt(e>>18&63)+t.charAt(e>>12&63)+t.charAt(e>>6&63)+t.charAt(63&e)}function m(e){return e.clientData?e.clientData:e.clientData={}}var p=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,[{key:"Error",value:function(e,t){c.ULS.sendTraceTag(e,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,t)}},{key:"Message",value:function(e,t){c.ULS.sendTraceTag(e,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,t)}}],[{key:"getInstance",value:function(){return e.s_instance||(e.s_instance=new e)}}])}();t.ParseJsonUlsLogger=p;var g,v=function(){function e(){(0,a.default)(this,e),this.renderingLogCount=new Map}return(0,o.default)(e,[{key:"sendTraceTag",value:function(t,r,i,a){var o=this;if(e.s_isRenderingAnimationFrame){var s=l.Settings.readNumberOrDefault("maxLogsDuringAnimationByTagCooldownMs",1e3),d=l.Settings.readNumberOrDefault("maxLogsDuringAnimationByTag",100);this.resetRenderingLogCountTimeoutClock?this.resetRenderingLogCountTimeoutClock.setTime(s):this.resetRenderingLogCountTimeoutClock=new h((function(){var e,t=[],i=u(o.renderingLogCount);try{for(i.s();!(e=i.n()).done;){var a=(0,n.default)(e.value,2),s=a[0];a[1]>=d&&t.push(f(s))}}catch(e){i.e(e)}finally{i.f()}t.length>0&&c.ULS.sendTraceTag(509437461,r,c.TraceLevel.Info,"log cooldown reached, reenabling tags:".concat(t,"}")),o.renderingLogCount.clear(),o.resetRenderingLogCountTimeoutClock=void 0}),s);var m=this.renderingLogCount.get(t)||0;if(this.renderingLogCount.set(t,m+1),m>=d)return void(m===d&&c.ULS.sendTraceTag(509437460,r,c.TraceLevel.Warning,"too many logs during animation, disabling tag:".concat(f(t),"}")))}c.ULS.sendTraceTag(t,r,i,a)}},{key:"shipAssertTag",value:function(e,t,r,i){c.ULS.shipAssertTag(e,t,r,i)}},{key:"debugAssertTag",value:function(e,t,r,i){c.ULS.debugAssertTag(e,t,r,i)}}],[{key:"getInstance",value:function(){return e.s_instance||(e.s_instance=new e)}}])}();t.ShapeBuilderUlsLogger=v,v.s_isRenderingAnimationFrame=!1},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;for(var n=i(r(92)),a=[],o=0;o<256;++o)a.push((o+256).toString(16).substr(1));t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!(0,n.default)(r))throw TypeError("Stringified UUID is invalid");return r}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(307));t.default=function(e){return"string"==typeof e&&n.default.test(e)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Transition=void 0;var n=i(r(1)),a=i(r(2)),o=r(172),s=r(23),l=r(21),c=r(32),u=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"init",value:function(e,t){e?e.engine?(this.drawInfo&&this.dispose(),this.props=e,this.engine=e.engine,this.resourcesManager=new o.ResourcesManager(this.engine,t),this.drawInfo=this.internalInit(e,this.resourcesManager,t),this.drawInfo||(this.dispose(),(0,l.logError)("Can not init shaders, or draw info, initialization failed."))):(0,l.logError)("No engine has been provided for the transition"):(0,l.logError)("No Props have been provided for the transition")}},{key:"draw",value:function(e){var t=this.drawInfo;return t&&this.props?t.engine.isContextLost()?((0,l.logError)("Context has been lost"),!1):(t.autoClear&&(t.engine.resetViewport(),t.engine.clearToBlack()),this.internalDraw(e,this.props,t)):((0,l.logError)("Transition has not been initialized"),!1)}},{key:"getDrawInfo",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.engine&&this.resourcesManager&&this.props){var i=new c.MeshInfo(this.props,r),n=new c.Mesh;n.initialize(i);for(var a=new Array(t.length),o=0;o<t.length;o+=1)a[o]=t[o](n,i);var u=(0,s.createDrawInfo)(this.engine,this.resourcesManager,this.props.incomingSlideBackground,this.props.outgoingSlideBackground,e,n.getVertexIndices(),a);return u}(0,l.logError)("Transition has not been initialized")}},{key:"dispose",value:function(){this.resourcesManager&&this.resourcesManager.dispose()}}]);t.Transition=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Helper=t.ThemeColor=t.ThemeFontScheme=t.ThemeColorScheme=t.AppForOfficeTheme=void 0;t.AppForOfficeTheme=function(e,t,r){this.fIsEmpty=!0,this.colorScheme=e,this.fontScheme=t,this.backgroundColor=r,this.fIsEmpty=!e&&!t&&!r};t.ThemeColorScheme=function(){};t.ThemeFontScheme=function(){};var i=function(){function e(e){this.red=0,this.green=0,this.blue=0,this.intColor=0,this.fValid=!1,this.INVALID=-1,null!=e&&3===e.length&&(this.red=e[2],this.green=e[1],this.blue=e[0],this.fValid=this.isColorValid(),this.intColor=this.convertToInteger())}return e.prototype.convertToInteger=function(){return this.fValid?(this.intColor=this.blue,this.intColor+=this.green<<8,this.intColor+=this.red<<16):this.intColor=this.INVALID,this.intColor},e.prototype.isColorValid=function(){return!n.isNullOrUndefined(this.red)&&this.red>=0&&!n.isNullOrUndefined(this.green)&&this.green>=0&&!n.isNullOrUndefined(this.blue)&&this.blue>=0},e}();t.ThemeColor=i;var n=function(){function e(){}return e.isNullOrUndefined=function(e){return null==e||void 0===e},e.validateArgument=function(t){if(e.isNullOrUndefined(t))throw Error("");return t},e}();t.Helper=n},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MediaStreamError=void 0,t.MediaStreamError=i,function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidStartInput="ErrorInvalidStartInput",e.ErrorStreamStartFailure="ErrorStreamStartFailure",e.ErrorNoVideoTracks="ErrorNoVideoTracks",e.ErrorWebView2NotAvailable="ErrorWebView2NotAvailable",e.ErrorVideoPlaybackFailed="ErrorVideoPlaybackFailed",e.ErrorUnknown="ErrorUnknown"}(i||(t.MediaStreamError=i={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setupGlobals_SlideShowCore=re,t.SlideShowCore=t.exposed=void 0;var n=i(r(125)),a=i(r(6)),o=i(r(5)),s=i(r(7)),l=i(r(15)),c=i(r(1)),u=i(r(2)),d=r(34),h=r(46),f=r(26),m=r(83),p=r(3),g=r(52),v=r(14),y=r(47),_=i(r(201)),S=r(66),T=r(398),b=r(181),C=r(58),w=r(399),P=r(400),I=r(401),k=r(182),E=r(402),x=r(11),L=r(403),A=r(4),M=r(81),R=r(97),O=r(415),D=r(416),F=r(123),B=r(417),N=r(67),V=r(185),U=r(100),W=r(418),G=["metrics"];function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return q(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var Z,X,Y=r(98);function J(e,t,r,i,n,a,o,s,l,c,u,d,f){var m=A.Settings.readBooleanOrDefault("maxDPRForGetItemsEnabled",!1)?A.Settings.readNumberOrDefault("maxDPRForGetItems",5):5,g=Math.min(window.devicePixelRatio||1,m),v=new h.Vector2(t.x*g,t.y*g),y=!1;if(i){var _=function(){try{var e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){var t=null!=e.downlink?e.downlink:void 0;return p.ULS.sendTraceTag(538784080,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::getNetworkDownlink client network info - downlinkSpeed: ".concat(t,"Mbps")),t}}catch(e){p.ULS.sendTraceTag(538784081,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::getNetworkDownlink network information API not supported by the browser")}}();y=!!_&&_/8<A.Settings.readNumberOrDefault("downlinkSpeedCutoffForSlowClientsMBps",.77)}var S=Q(f,v);S&&(e.meta_clientWidthReduced=S.x,e.meta_clientHeightReduced=S.y);var T=Q(f,{x:0,y:0});T&&i&&(e.meta_clientWidthMin=T.x,e.meta_clientHeightMin=T.y);var b=A.Settings.readNumberOrDefault("overrideDownloadTimeoutIfBadNetworkMs",0);switch(b>0&&i&&(e.meta_overrideDownloadTimeoutIfBadNetworkMs=b),r){case Z.FixedSize:K(l,e);break;case Z.FlexibleSizeWithMinMax:0!==v.x&&0!==v.y||!l?s&&o&&K({x:Math.min(Math.max(v.x,s.x),o.x),y:Math.min(Math.max(v.y,s.y),o.y)},e):K(l,e);break;case Z.BucketedSize:var C=c;i&&p.ULS.sendTraceTag(527485004,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,JSON.stringify({useSmallResolutionSizeForSlowNetworkClient:A.Settings.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1),uiHost:n,DPR:window.devicePixelRatio,cappedDPR:g,useSmallResolutionSize:a,isSlowNetworkClient:y,specifiedSlideSize:v})),a&&(!A.Settings.readBooleanOrDefault("useSmallResolutionSizeForBootOnly",!1)||i)||y&&i&&A.Settings.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1)?C=f:u&&(C=d),function(e,t,r,i){var n=Q(e,r);n&&(K(n,t),i&&p.ULS.sendTraceTag(541868834,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,JSON.stringify({assignedWidth:n.x,assignedHeight:n.y,slideWidth:r.x,slideHeight:r.y})))}(C,e,v,i)}return e.meta_clientWidth&&e.meta_clientHeight||K(v,e),e}function K(e,t){e&&(t.meta_clientWidth=A.Settings.readNumberOrDefault("hackClientWidth",e.x),t.meta_clientHeight=A.Settings.readNumberOrDefault("hackClientHeight",e.y))}function Q(e,t){if(e&&e[0]){var r,i=e[0],n=function(e){return t.x>t.y?e.x:e.y},a=function(e,t){return Math.abs(n(e)-n(t))},o=a(i,t),s=z(e);try{for(s.s();!(r=s.n()).done;){var l=r.value;a(l,t)<o&&(o=a(l,t),i=l)}}catch(e){s.e(e)}finally{s.f()}return i}}!function(e){e.FixedSize="FixedSize",e.BucketedSize="BucketedSize",e.FlexibleSizeWithMinMax="FlexibleSizeWithMinMax"}(Z||(Z={})),function(e){e.InitPresInfo="initPresInfo",e.GotoSlideEnsureSlide="gotoSlideEnsureSlide",e.GotoSlideRenderSlide="gotoSlideRenderSlide",e.UpdateResourceProvidersPresInfo="updateResourceProvidersPresInfo",e.UpdateViewDataManager="updateViewDataManager",e.PrefetchEnsureSlide="prefetchEnsureSlide",e.GotoSlideRenderTransition="GotoSlideRenderTransition",e.CheckHidden="checkHidden"}(X||(X={}));var $,ee=!1,te={};function re(e){if(e.logger&&(p.ULS.setLogger(e.logger),ie.logger=e.logger,!ee)){p.ULS.sendTraceTag(523531085,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore Version: ".concat("5.3.54",", SVM Version: ").concat("9.19.117",", SB Version: ").concat("1.9.11")),(0,M.addErrorHandler)();var t=e.logger;$=function(){"flushOnClose"in t&&t.flushOnClose()},window.addEventListener("beforeunload",$),ee=!0}e.logger&&e.vetoSessionId&&v.VetoUtils.setVetoUtil({SessionId:e.vetoSessionId},e.logger),e.settings&&A.Settings.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&x.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.ssc=te),(0,h.setupGlobals_SlideVisualizationModule)(e),(0,m.setupGlobals_ResourceProvider)({logger:e.logger,stringifyError:M.stringifyError})}t.exposed=te;var ie=function(){function e(t,i,n,o,u){var m=this;(0,c.default)(this,e),this.events=new f.EventEmitter,this.enableOpticalZoom=!1,this.prefetchWindowRange={first:-1,last:-1},this.m_isHandlingResourceInconsistent=!1,this.m_slideIdOrder=[],this.m_defaultSlideIdOrder=[],this.m_customShows=[],this.m_currentCustomShowIndex=-1,this.m_isCustomSlideShowActive=!1,this.m_hiddenSlideIdOrder=[],this.m_currentTimelineStates=null,this.m_isAnimating=!1,this.m_isTransitioning=!1,this.m_isSlideIdOrderUpdated=!1,this.m_blankSlideState=d.BlankSlideState.Hidden,this.m_contextIsLoaded=!1,this.m_gotoSlideRequestCount=0,this.m_cameoDetectedInPresentation=!1,this.m_cameoPresenceCache={},this.m_isCameoActive=!1,this.m_fMediaDetectedInPresentation=!1,this.m_slideRefreshNeeded=!1,this.m_networkHealthChangedEvents=[],this.m_source=1,this.m_updateResourceProvidersThrottler=new N.CriticalAsyncFunctionThrottler(this.updateResourceProvidersAsyncImplAsync.bind(this),e.updateResourceProvidersQueueHandler),this.m_ensureSlideViewElementThrottler=new N.ParallelCriticalAsyncFunctionThrottler(this.ensureSlideViewElementImplAsync.bind(this),N.executeAllQueueHandler,(function(e){return JSON.stringify(e)})),this.m_customShowReceivedTime=0,this.m_customShowRequestedTime=0,this.m_logger=n,window.exposed instanceof Object||(window.exposed={}),re({logger:n,settings:o.slideShowCoreSettings.settings,disabledChangeGates:o.slideShowCoreSettings.disabledChangeGates,vetoSessionId:o.appSettings.userSessionId,exposed:window.exposed}),te.this=this,te.appVersion="5.3.54",te.svmVersion="9.19.117",te.sbVersion="1.9.11",te.settings=o.slideShowCoreSettings.settings,te.sessionId=o.appSettings.userSessionId,p.ULS.sendTraceTag(576021338,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,JSON.stringify({uintTest:A.Settings.readNumberOrDefault("uintTest",0),boolTest:A.Settings.readBooleanOrDefault("boolTest",!1),strTest:A.Settings.readStringOrDefault("strTest","")})),this.m_sessionSettings=o,y.SessionUtils.init(o,"5.3.54","9.19.117","1.9.11"),y.SessionUtils.logSessionStart(0),x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?(this.m_navigationLoggerNew=new T.NavigationLoggerNew,this.m_navigationLoggerNew.init(o)):b.NavigationLogger.init(o),this.m_transitionResourceLoader=new S.TransitionResourceLoader(this.m_sessionSettings.slideShowCoreSettings.transitionResourceCDNPath,!0),this.m_sessionSettings.appSettings.jsScriptsBasePath&&""!==this.m_sessionSettings.appSettings.jsScriptsBasePath&&(r.p=this.m_sessionSettings.appSettings.jsScriptsBasePath),this.m_viewDataManager=new h.ViewDataManager(this.addClientSizeToLoader(i.slideViewData),this.addClientSizeToLoader(i.shapeViewData),i.localizedString),A.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new I.ZoomManager(this.m_viewDataManager)),A.Settings.readBooleanOrDefault("enableAddinViewElement",!1)&&this.ensureAppForOfficeManager();var g=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;this.m_viewControllerSettings={sessionId:this.m_sessionSettings.appSettings.userSessionId,editAudioEnabled:this.m_sessionSettings.slideShowCoreSettings.editAudioEnabled,transparentCanvasForVideoEnabled:A.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!A.Settings.readBooleanOrDefault("forceSvg",!1)||!1,serverUrl:this.m_sessionSettings.appSettings.serverUrl,uiHost:this.m_sessionSettings.appSettings.uiHost||"",morphEnabled:A.Settings.readBooleanOrDefault("morphEnabled",!0),disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates||"",showCustomPlayButtonForVideo:this.m_sessionSettings.slideShowCoreSettings.showCustomPlayButtonForVideo,stringifyError:M.stringifyError,settings:this.m_sessionSettings.slideShowCoreSettings.settings,jsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath||"",applicationLcid:this.m_sessionSettings.appSettings.applicationLcid||"",startFromTime:g,initTime:this.m_sessionSettings.appSettings.initTime||0,hubbleVideoEndpoint:this.m_sessionSettings.appSettings.hubbleVideoEndpoint,acceptLanguage:this.m_sessionSettings.appSettings.acceptLanguage,teamsCallId:this.m_sessionSettings.appSettings.teamsCallId,isMultiSlideshowcoreEnabled:this.m_sessionSettings.slideShowCoreSettings.isMultiSlideshowcoreEnabled||!1,flights:this.m_sessionSettings.flights||{},shapeBuilderCanvasContext:u&&"object"===(0,l.default)(u)?u.shapeBuilderCanvasContext:void 0},t.style.outline="none",this.m_container=t,x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")&&u&&"object"!==(0,l.default)(u)&&(this.m_source=u),void 0!==this.m_sessionSettings.slideShowCoreSettings.instanceSource&&(this.m_source=this.m_sessionSettings.slideShowCoreSettings.instanceSource);var v="undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.SlideShowAccessibilityLabelCurrentSlidePane:"Current Slide Pane";if(this.m_container.setAttribute("aria-label",v),this.m_stateManager=new P.SlideShowCoreStateManager(d.SlideShowCoreState.Normal,new w.LoadingUI(t)),this.m_providers=i,this.m_lastRequestedSlideState={},window.addEventListener("beforeunload",(function(){m.flushSessionEndLogs()})),$&&window.removeEventListener("beforeunload",$),new L.MemoryLogger,A.Settings.readBooleanOrDefault("pingEnabled",!1)){if(A.Settings.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)){var _=A.Settings.readNumberOrDefault("AddedTimeoutTimeMs",13e4);_?setTimeout((function(){return m.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:_})}),0):setTimeout((0,s.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.events.emit("networkHealthChanged",{isHealthy:!1,addTimeoutTimeMs:13e4}),e.next=3,(0,N.waitMsAsync)(100);case 3:m.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:13e4});case 4:case"end":return e.stop()}}),e)}))),0)}this.m_customShowRequestedTime=Date.now();var C="".concat(this.m_sessionSettings.appSettings.serverUrl,"/resources/").concat(this.m_sessionSettings.appSettings.applicationLcid,"/progress.gif");this.m_networkHealthManager=new D.NetworkHealthManager(C),this.m_networkHealthManager.startPinging();var k=this.m_networkHealthManager;this.m_networkHealthManager.events.on("isHealthyChanged",(function(){0===m.m_networkHealthChangedEvents.length&&p.ULS.sendTraceTag(526237827,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify({datetime:Date.now(),perf:performance.now()})),m.m_networkHealthChangedEvents.push({time:performance.now(),isHealthy:k.isHealthy});var e=k.isHealthy?0:A.Settings.readNumberOrDefault("AddedTimeoutTimeIfBadNetworkMs",13e4);A.Settings.readBooleanOrDefault("networkHealthChangedEventEnabled",!1)&&m.events.emit("networkHealthChanged",{isHealthy:k.isHealthy,addedTimeoutTimeIfBadNetworkMs:e})})),setTimeout((function(){var e,t=[],r=!0,i=0,n=z(m.m_networkHealthChangedEvents);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.isHealthy!==r&&(a.isHealthy?(t.push({start:i,length:a.time-i}),i=0):i=a.time,r=a.isHealthy)}}catch(e){n.e(e)}finally{n.f()}i>0&&t.push({start:i,length:performance.now()-i}),p.ULS.sendTraceTag(526713538,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(JSON.stringify(t)))}),5e4-performance.now())}this.m_opticalZoomStateInfo={currentState:{zoomLevel:A.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:new h.Vector2(.5,.5)}},this.m_zoomAnimationController=new B.OpticalZoomAnimationController(this)}return(0,u.default)(e,[{key:"shouldFetchCustomShows",get:function(){return this.m_customShowRequestedTime>this.m_customShowReceivedTime}},{key:"addClientSizeToLoader",value:function(e){var t=this;return{load:function(r,i){var n=t.addCommonResourceMetadata(i||{});return e.load(r,n)}}}},{key:"endSession",value:function(e){this.setBlankSlideState(d.BlankSlideState.Black),x.ChangeGate.isChangeGateEnabled("RestoreSlideIdOrder")&&this.m_isSlideIdOrderUpdated&&this.restoreSlideIdOrder(),this.m_isCustomSlideShowActive&&this.restoreSlideIdOrder(),this.m_viewController&&(this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer()),this.m_cameoPresenceCache={},this.flushSessionEndLogs(e),this.events.emit("sessionEnded")}},{key:"raiseSlideshowRenderedEvent",value:function(){this.events.emit("slideShowRenderedToCanvas"),p.ULS.sendTraceTag(507249056,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::raiseSlideshowRenderedEvent: ".concat(performance.now(),", slideShowRenderedEvent raised"))}},{key:"init",value:(Ee=(0,s.default)(a.default.mark((function t(){var r,i,n,o,l,c,u,f,m,g,v,S,T=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,C.v4)(),(i={correlationId:r})[b.ActionType.Init]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},this.m_sessionSettings.bootMetrics&&(this.m_sessionSettings.bootMetrics.initSlideShowCoreTime=i[b.ActionType.Init].start),i.getPresInfo={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},this.m_stateManager.setState(d.SlideShowCoreState.Loading),n={slideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!0},t.next=9,this.getPresInfoItem(r,b.ActionType.Init,n);case 9:if((o=t.sent)&&o.resource){t.next=18;break}if("ServerErrorFileDownloadResourceInconsistent"!==(l=o&&o.metadata&&o.metadata.hasOwnProperty("errorName")?o.metadata.errorName:"ErrorFailedToLoadPresInfo")){t.next=15;break}return p.ULS.sendTraceTag(541403220,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::init - Failed to get PresInfo due to handling resource incosistent status"),t.abrupt("return",{fSucceeded:!1,metrics:i});case 15:return this.handleErrors({errorName:l},{errorAction:X.InitPresInfo}),p.ULS.sendTraceTag(593827929,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::init - Failed to get PresInfo. correlation:".concat(r,", ErrorName:").concat(l)),t.abrupt("return",{fSucceeded:!1,metrics:i});case 18:if(p.ULS.sendTraceTag(571332639,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - Got PresInfo. correlation:".concat(r)),this.events.emit("bootStageChanged","InitViewController"),o&&o.metadata&&o.metadata.hasOwnProperty(b.NavigationLogger.GetItemsResult)&&(i[b.NavigationLogger.GetItemsResult]=o.metadata[b.NavigationLogger.GetItemsResult]),i.getPresInfo.end=y.SessionUtils.performanceNowTrimmed(),this.m_viewController=new h.ViewController(this.m_container,new h.Vector2(o.resource.SlideEmuWidth,o.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager),this.m_viewController.rendererEnvironment.glContext||A.Settings.readBooleanOrDefault("forceSvg",!1)){t.next=32;break}return p.ULS.sendTraceTag(555229313,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::SetupWebGLContextFailed - Switching renderingMode from webGL to SVG on boot"),A.Settings.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),re({logger:this.m_logger,settings:this.m_sessionSettings.slideShowCoreSettings.settings,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=A.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!A.Settings.readBooleanOrDefault("forceSvg",!1)||!1,t.next=30,this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0});case 30:this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new h.ViewController(this.m_container,new h.Vector2(o.resource.SlideEmuWidth,o.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager);case 32:return t.next=34,this.m_viewController.init();case 34:if(x.ChangeGate.isChangeGateEnabled("SSC.SetMediaCommandScope")&&(this.m_sessionSettings.appSettings.initialSlideShowRole?this.m_viewController.mediaCommandScope=this.m_sessionSettings.appSettings.initialSlideShowRole===d.SlideShowRole.Presenter?h.MediaCommandScope.All:h.MediaCommandScope.Local:this.m_viewController.mediaCommandScope=h.MediaCommandScope.None),p.ULS.sendTraceTag(571332640,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - ViewController Initialized. "),this.m_contextIsLoaded=!0,this.m_viewController.rendererEnvironment.glContext&&this.m_viewController.events.on("renderingStageChanged",(function(e){return T.events.emit("bootStageChanged",e)})),this.m_viewController.events.on("webglcontextlost",(function(){if(T.m_contextIsLoaded=!1,T.m_currentSlideLocation&&T.m_viewController){var e=T.m_viewController.getSlideViewElement(T.m_currentSlideLocation.slideId);e&&e.animClock.pause(),T.pauseTransition()}else p.ULS.sendTraceTag(571332641,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - Raised event WebGLContext lost currentSlideLocation: ".concat(!!T.m_currentSlideLocation,", viewController: ").concat(!!T.m_viewController,". "))})),this.m_viewController.events.on("webglcontextrestored",(function(){if(T.m_contextIsLoaded=!0,T.m_currentSlideLocation&&T.m_viewController){var t=T.m_viewController.getSlideViewElement(T.m_currentSlideLocation.slideId);t&&t.animClock.resume(),T.resumeTransition(),T.setOpticalZoomState({currentState:e.s_defaultOpticalZoomState,metadata:{source:"webglcontextrestored"}}),T.events.emit("webglcontextrestored")}else p.ULS.sendTraceTag(571332642,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - Raised event webglcontextrestored currentSlideLocation: ".concat(!!T.m_currentSlideLocation,", viewController: ").concat(!!T.m_viewController,". "))})),this.m_viewController.events.on("restoreWebGLContextFailed",(0,s.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.changeRenderingModeToSVG();case 2:p.ULS.sendTraceTag(555229314,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::restoreWebGLContextFailed - Switching renderingMode from webGL to SVG midsession");case 3:case"end":return e.stop()}}),e)})))),this.m_viewController.events.on("glyphCacheFailed",(function(){T.m_slideRefreshNeeded=!0})),x.ChangeGate.isChangeGateEnabled("SlideshowRenderedVerifyGlyphStartEventRaiseEnabled")&&this.m_viewController.events.on("verifyGlyphStart",(function(){T.raiseSlideshowRenderedEvent()})),A.Settings.readBooleanOrDefault("avoidResizeObserverPolyfill",!1))try{c=new ResizeObserver(this.onResizeObservedAsync.bind(this))}catch(e){p.ULS.sendTraceTag(521164243,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"ResizeObserver not supported")}if(c||(c=new _.default(this.onResizeObservedAsync.bind(this))),c.observe(this.m_container),this.m_stateManager.setState(d.SlideShowCoreState.Normal),f=void 0,A.Settings.readBooleanOrDefault("enableNoFirstVisibleSlideCallDuringInit",!1)){t.next=59;break}return t.next=51,this.getFirstVisibleSlideIndex();case 51:if(!(f=t.sent).hasOwnProperty("errorName")){t.next=55;break}return x.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&p.ULS.sendTraceTag(507909345,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::init - getFirstVisibleSlideResult return with error: ".concat(f.errorName,".")),t.abrupt("return",{fSucceeded:!1,metrics:i});case 55:f[b.ActionType.CheckHidden]&&(i[b.ActionType.CheckHidden]=f[b.ActionType.CheckHidden]),this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(u=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)||this.resolvePartialSlideLocation({slideId:f.slideId})),t.next=70;break;case 59:if(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(p.ULS.sendTraceTag(556847945,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - try to get targetSlideLocation from setting's startingSlideLocation."),u=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)),u){t.next=70;break}return p.ULS.sendTraceTag(556847946,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::init - no valid SlideLocation from setting, try to get first visible slide."),t.next=64,this.getFirstVisibleSlideIndex();case 64:if(!(f=t.sent).hasOwnProperty("errorName")){t.next=68;break}return p.ULS.sendTraceTag(556847947,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::init - getFirstVisibleSlideResult return with error: ".concat(f.errorName,", return from init.")),t.abrupt("return",{fSucceeded:!1,metrics:i});case 68:f[b.ActionType.CheckHidden]&&(i[b.ActionType.CheckHidden]=f[b.ActionType.CheckHidden]),u=this.resolvePartialSlideLocation({slideId:f.slideId});case 70:if(this.m_lastRequestedSlideState={slideLocation:u,options:{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState}},p.ULS.sendTraceTag(571332643,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - Begin GoToSlide. "),this.events.emit("bootStageChanged","GotoTargetSlide"),!u){t.next=82;break}return p.ULS.sendTraceTag(556847948,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - call gotoSlide with targetSlideLocation: ".concat(JSON.stringify(u),". ")),i[b.ActionType.Goto]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},m=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0,t.next=79,this.gotoSlide(u,{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState,actionContext:{navigationType:d.NavigationType.Init,startFromTime:m,bootMetrics:this.m_sessionSettings.bootMetrics}});case 79:i[b.ActionType.Goto].end=y.SessionUtils.performanceNowTrimmed(),t.next=88;break;case 82:if(p.ULS.sendTraceTag(556847949,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - continue init without targetSlideLocation and try to use getFirstVisibleSlideResult."),f){t.next=86;break}return p.ULS.sendTraceTag(556847950,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::init - getFirstVisibleSlideResult not valid."),t.abrupt("return",{fSucceeded:!1,metrics:i});case 86:(g=this.resolvePartialSlideLocation({slideId:f.slideId}))&&(v=(0,C.v4)(),S=this.addCommonResourceMetadata({meta_correlationId:v,meta_isInit:!0}),this.m_viewDataManager.getSlideViewData(g.slideId,S).then((function(e){e.resource&&T.m_viewController&&e.resource.slideSizePixels?(T.m_viewController.resizeViewContainer(T.m_opticalZoomStateInfo.currentState,e.resource.slideSizePixels),T.prefetchSlide(g,!0),T.events.emit("prefetchOnInit",g)):p.ULS.sendTraceTag(591734977,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::init - Failed to get slideViewData. sid:".concat(g.slideId.sid,", errorName:").concat(e.metadata.errorName,", correlation:").concat(v))})));case 88:return p.ULS.sendTraceTag(571332672,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::init - End GoToSlide. "),i[b.ActionType.Init].end=y.SessionUtils.performanceNowTrimmed(),x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordInitData(j({correlationId:r},i)):b.NavigationLogger.recordInitData(j({correlationId:r},i)),t.abrupt("return",{fSucceeded:!0,metrics:i});case 92:case"end":return t.stop()}}),t,this)}))),function(){return Ee.apply(this,arguments)})},{key:"updateSlideIdOrder",value:function(e){var t=this;this.m_isSlideIdOrderUpdated=!0,this.m_slideIdOrder=[],e.forEach((function(e){t.m_slideIdOrder.push({sid:e,cid:0})})),this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}},{key:"onResizeObservedAsync",value:(ke=(0,s.default)(a.default.mark((function e(t){var r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=z(t),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=10;break}if(i.value.target.id!==this.m_container.id){e.next=8;break}return e.next=8,this.resizeAsync(0);case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))),function(e){return ke.apply(this,arguments)})},{key:"resizeAsync",value:(Ie=(0,s.default)(a.default.mark((function e(t){var r,i,n,o,s=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_viewController&&(A.Settings.readBooleanOrDefault("forceSvg",!1)||this.m_contextIsLoaded)&&this.m_container.offsetParent){e.next=3;break}return p.ULS.sendTraceTag(575017310,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"Resize returning early, ".concat(JSON.stringify({viewController:!!this.m_viewController,contextIsLoaded:this.m_contextIsLoaded,forceSVG:A.Settings.readBooleanOrDefault("forceSvg",!1),offsetParent:!!this.m_container.offsetParent}))),e.abrupt("return");case 3:if(this.m_viewController.onResize(),!this.m_currentSlideLocation){e.next=18;break}if(!(r=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId))){e.next=18;break}if(this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,r.slideSizePixels),this.m_blankSlideState!==d.BlankSlideState.Hidden){e.next=18;break}if(r.fImageTextureLoaded){e.next=13;break}return p.ULS.sendTraceTag(520945794,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"ResizeObserver textures not loaded for current slide, reloading"),e.next=13,this.m_viewController.ensureTextureLoaded(this.m_currentSlideLocation.slideId);case 13:i=this.m_viewController.rendererEnvironment.canvas,n=this.m_viewController.getBounds.getClientSizeFromContainer(),o=this.m_viewController.getBounds.getClientSizeFromCanvas(),p.ULS.sendTraceTag(575776400,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"ResizeObserver ".concat(JSON.stringify({reRenderingSlideId:this.m_currentSlideLocation.slideId,containerSize:"".concat(this.m_container.clientWidth,"x").concat(this.m_container.clientHeight),canvasSize:"".concat(i.clientWidth,"x").concat(i.clientHeight),containerSizeCached:"".concat(n.x,"x").concat(n.y),canvasSizeCached:"".concat(o.x,"x").concat(o.y),isTiny:Math.min(o.x,o.y)<A.Settings.readNumberOrDefault("tinySizeForContainer",50)}))),A.Settings.readBooleanOrDefault("useDirtyFlagForResize",!1)?(this.m_slideRefreshNeeded=!0,this.events.once("animatedContentStateChanged",(function(){s.onRenderAfterResize(t)}))):(this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.onRenderAfterResize(t));case 18:this.events.emit("slideDimensionsChanged");case 19:case"end":return e.stop()}}),e,this)}))),function(e){return Ie.apply(this,arguments)})},{key:"onRenderAfterResize",value:function(e){var t=this;if(this.m_viewController){var r=this.m_viewController.rendererEnvironment.canvas,i=this.m_viewController.getBounds.getClientSizeFromContainer(),n=this.m_viewController.getBounds.getClientSizeFromCanvas(),a=Math.min(n.x,n.y)<A.Settings.readNumberOrDefault("tinySizeForContainer",50);if(p.ULS.sendTraceTag(521164242,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"First render after resize ".concat(JSON.stringify({containerSize:"".concat(this.m_container.clientWidth,"x").concat(this.m_container.clientHeight),canvasSize:"".concat(r.clientWidth,"x").concat(r.clientHeight),containerSizeCached:"".concat(i.x,"x").concat(i.y),canvasSizeCached:"".concat(n.x,"x").concat(n.y),isTiny:a}))),0===e&&this.m_resizeAfterTinyCanvasTC&&(this.m_resizeAfterTinyCanvasTC.abort(),this.m_resizeAfterTinyCanvasTC=void 0),a){var o=A.Settings.readNumberOrDefault("maxRetriesForTinySize",0);e<o&&(this.m_resizeAfterTinyCanvasTC=new V.TimeoutClock((function(){t.resizeAsync(e+1)}),A.Settings.readNumberOrDefault("retryTimeoutForTinySizeMs",1e3)))}if(a){var s=A.Settings.readNumberOrDefault("tinySizeTimeout",4e3);this.m_tinyCanvasTooLongTC&&0===e?this.m_tinyCanvasTooLongTC.setTime(s):this.m_tinyCanvasTooLongTC=new V.TimeoutClock((function(){p.ULS.sendTraceTag(520945793,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"Canvas still tiny ".concat(s,"ms after last resize"))}),s)}!a&&this.m_tinyCanvasTooLongTC&&(this.m_tinyCanvasTooLongTC.abort(),this.m_tinyCanvasTooLongTC=void 0)}}},{key:"changeRenderingModeToSVG",value:(Pe=(0,s.default)(a.default.mark((function e(t){var r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.ULS.sendTraceTag(555229315,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::changeRenderingModeToSVG - Switching renderingMode from webGL to SVG"),r=Date.now(),A.Settings.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),re({settings:this.m_sessionSettings.slideShowCoreSettings.settings}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=A.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!A.Settings.readBooleanOrDefault("forceSvg",!1)||!1,e.next=7,this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0,switchToSvg:!0});case 7:if(!(i=t&&t.location?t.location:this.m_currentSlideLocation)){e.next=12;break}return this.m_viewDataManager.imageDataMap=new Map,e.next=12,this.gotoSlide(i,{actionContext:{navigationType:d.NavigationType.Init},animationState:this.getAnimationState(!0),fForceRetry:!0,fForceNavigate:!0,fSkipTransition:!0,fSuppressNavigatedFromEvent:A.Settings.readBooleanOrDefault("enableSuppressingNavigatedFromEvent",!1)});case 12:p.ULS.sendTraceTag(555229316,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::changeRenderingModeToSVG - Switched renderingMode from webGL to SVG in ".concat(Date.now()-r," ms")),this.events.emit("renderingModeChangedToSVG");case 14:case"end":return e.stop()}}),e,this)}))),function(e){return Pe.apply(this,arguments)})},{key:"ensureAppForOfficeManager",value:function(){var e=this;if(this.m_appForOfficeManager||(this.m_appForOfficeManager=new R.AppForOfficeManager,this.m_appForOfficeManager.ApiFacade=new O.SlideShowAppForOfficeApiImpl(this),this.m_appForOfficeManager.events.on("frameTrustCheck",(function(){e.events.emit("frameTrustCheck")}))),this.m_appForOfficeManager&&!this.m_appForOfficeManager.fInitialized()){var t={IsRtl:void 0!==this.m_sessionSettings.appSettings.isRtl&&this.m_sessionSettings.appSettings.isRtl,AppForOfficeAllowExternalMarketplace:A.Settings.readBooleanOrDefault("appForOfficeAllowExternalMarketplace",!0),AppLcid:this.m_sessionSettings.appSettings.applicationLcid&&this.m_sessionSettings.appSettings.applicationLcid.length>0?this.m_sessionSettings.appSettings.applicationLcid:"1033",AppUILocale:this.m_sessionSettings.appSettings.applicationLocaleName&&this.m_sessionSettings.appSettings.applicationLocaleName.length>0?this.m_sessionSettings.appSettings.applicationLocaleName:"en-US",AppForOfficeOmexBaseUrl:A.Settings.readStringOrDefault("appForOfficeOmexBaseUrl","https://store.office.com"),ServerUrl:this.m_sessionSettings.appSettings.serverUrl,AppForOfficeTrustUXIsEnabledForPowerPoint:A.Settings.readBooleanOrDefault("appForOfficeTrustUXIsEnabledForPowerPoint",!0),AppsForOfficePrivateCatalogEnabled:A.Settings.readBooleanOrDefault("appsForOfficePrivateCatalogEnabled",!0),UploadFileDevCatalogIsDisabled:A.Settings.readBooleanOrDefault("uploadFileDevCatalogIsDisabled",!1),AreThirdPartyAddInsAllowed:this.m_sessionSettings.appSettings.areThirdPartyAddInsAllowed||A.Settings.readBooleanOrDefault("areThirdPartyAddInsAllowed",!1),JsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath,UiHost:this.m_sessionSettings.appSettings.uiHost,SlideShowRole:this.m_sessionSettings.appSettings.initialSlideShowRole,TeamsCallId:this.m_sessionSettings.appSettings.teamsCallId,TheWsaClient:this.m_sessionSettings.appSettings.theWsaClient,ExtLogger:this.m_logger,AppForOfficeContextActivationParameters:this.m_sessionSettings.appSettings.appForOfficeContextActivationParameters,CoreSettings:this.m_sessionSettings.slideShowCoreSettings.settings,AppsForOfficeAuthFactory:this.m_sessionSettings.appSettings.appForOfficeAuthFactory,SdxCdnUrl:"",Sdx1CdnUrl:"",ForceUseSdx1Cdn:!1,SdxDmsUrl:"",SovereignFederationDMSToken:"",SovereignFederationDMSTokenSuffix:""};this.m_appForOfficeManager.initialize(null,t)}}},{key:"getPresInfoItem",value:(we=(0,s.default)(a.default.mark((function e(t,r,i){var n,o,s,l,c,u;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o={meta_correlationId:t,meta_requestInfo:{ActionType:r}}).meta_filterHiddenSlideInfo=i&&i.isBootRequest,o.meta_includeSections=A.Settings.readBooleanOrDefault("enableSectionsData",!1),o.meta_isInit=r===b.ActionType.Init,!i){e.next=17;break}if(!(this.m_sessionSettings&&this.m_sessionSettings.slideShowCoreSettings&&this.m_sessionSettings.slideShowCoreSettings.usePresInfoFromClient&&i.isPresInfoFromClient)){e.next=11;break}return e.next=8,this.m_providers.presInfo.load("",this.addCommonResourceMetadata(o));case 8:n=e.sent,e.next=15;break;case 11:return p.ULS.sendTraceTag(577065923,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::getPresInfoItem - slidelocation:".concat(JSON.stringify(i.slideLocation),", correlation:").concat(t)),e.next=14,this.m_providers.presInfoAndSlideInfo.load(i.slideLocation?JSON.stringify(i.slideLocation):JSON.stringify({slideIndex:0}),this.addCommonResourceMetadata(o));case 14:n=e.sent;case 15:e.next=20;break;case 17:return e.next=19,this.m_providers.presInfo.load("",this.addCommonResourceMetadata(o));case 19:n=e.sent;case 20:if(n&&n.resource){e.next=22;break}return e.abrupt("return",n);case 22:if(n.resource.Sections&&(this.m_viewDataManager.sections=n.resource.Sections),this.m_customShowRequestedTime=Date.now(),s=[],this.m_isCustomSlideShowActive&&(x.ChangeGate.isChangeGateEnabled("FixDeleteSlideCustomSlideShow")&&-1!==this.m_currentCustomShowIndex&&this.handleCustomSlideshow(this.m_currentCustomShowIndex),s=this.m_slideIdOrder),n.resource.SlideShowProperties.Item){if(n.resource.SlideShowProperties.Item.start)l=n.resource.SlideShowProperties.Item,this.m_slideIdOrder=n.resource.SlideOrder.slice(0,l.end-l.start);else if(n.resource.SlideShowProperties.Item.sid)for(this.m_slideIdOrder=[],c=n.resource.SlideShowProperties.Item,u=0;u<c.sid.length;u+=1)this.m_slideIdOrder.push({sid:c.sid[u],cid:0})}else this.m_slideIdOrder=n.resource.SlideOrder;return this.m_defaultSlideIdOrder=this.m_slideIdOrder,this.m_isCustomSlideShowActive&&s&&s.length>0&&(this.m_slideIdOrder=s),this.m_hiddenSlideIdOrder=n.resource.HiddenSlideOrder,i&&i.isBootRequest?this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder):this.m_viewDataManager.setSlideIdOrderWithHidden(this.m_slideIdOrder,this.m_hiddenSlideIdOrder),y.SessionUtils.recordSessionStats({SlideCount:this.m_slideIdOrder.length}),e.abrupt("return",n);case 33:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return we.apply(this,arguments)})},{key:"flushSessionEndLogs",value:function(e){x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.logPerfData():b.NavigationLogger.logPerfData(),this.events.emit("logSessionEnd");var t=L.MemoryLogger.getMemoryUsage();if(t&&y.SessionUtils.recordSessionStats(t),this.m_viewController){var r=this.m_viewController.getGpuMemory();y.SessionUtils.recordSessionStats({gpuMemoryTotal:r.total,gpuMemoryImages:r.images,leaksPrevented:r.leaksPrevented})}y.SessionUtils.logSessionEnd(e),"flushOnClose"in this.m_logger&&this.m_logger.flushOnClose()}},{key:"addCommonResourceMetadata",value:function(e){var t=[],r=[],i=[];if(A.Settings.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1))try{t=JSON.parse(A.Settings.readStringOrDefault("availableRenderSlideSizes","[]")),r=JSON.parse(A.Settings.readStringOrDefault("availableRenderSlideSizesLowConfigClient","[]")),i=JSON.parse(A.Settings.readStringOrDefault("availableRenderSlideSizesSlowNetworkClient","[]"))}catch(e){p.ULS.sendTraceTag(541868835,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"addCommonResourceMetadata failed to parse availableRenderSlideSizes: ".concat(e))}var n=e.meta_isInit,a=Z.FixedSize;this.m_sessionSettings.slideShowCoreSettings.enableSlideSizeAdjust?a=Z.FlexibleSizeWithMinMax:A.Settings.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1)&&(a=Z.BucketedSize);var o=JSON.parse(A.Settings.readStringOrDefault("slideSizeDefault",'{"x":1504,"y":849}')),s=JSON.parse(A.Settings.readStringOrDefault("slideSizeMax",'{"x":1504,"y":849}')),l=JSON.parse(A.Settings.readStringOrDefault("slideSizeMin",'{"x":348,"y":261}'));return J(e,this.m_viewController?this.m_viewController.getBounds.getClientSizeFromContainer():new h.Vector2(this.m_container.clientWidth,this.m_container.clientHeight),a,n,this.m_sessionSettings.appSettings.uiHost,this.m_sessionSettings.slideShowCoreSettings.useSmallResolutionSize,s,l,o,t,A.Settings.readBooleanOrDefault("isLowConfigClient",!1),r,i),this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&(e.meta_isHighContrast=!0),this.m_sessionSettings.slideShowCoreSettings.colorMode&&(e.meta_colorMode=this.m_sessionSettings.slideShowCoreSettings.colorMode),e.meta_translateLanguage=this.m_sessionSettings.slideShowCoreSettings.translateLanguage?this.m_sessionSettings.slideShowCoreSettings.translateLanguage:"",this.m_sessionSettings.slideShowCoreSettings.clientColorSettings&&(e.meta_clientColorSettings=this.m_sessionSettings.slideShowCoreSettings.clientColorSettings),A.Settings.readBooleanOrDefault("morphEnabled",!0)&&(e.meta_enableMorph=!0),e.meta_imageAppendOption=this.m_sessionSettings.slideShowCoreSettings.imageSettings?this.m_sessionSettings.slideShowCoreSettings.imageSettings.imageAppendOption:"embed",e.meta_enableClustering=!!this.m_sessionSettings.slideShowCoreSettings.imageSettings&&this.m_sessionSettings.slideShowCoreSettings.imageSettings.enableClustering,e.meta_enableSVGAsWebGLTexture=A.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0),e.meta_convertGifToVideo=!0===this.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,A.Settings.readBooleanOrDefault("enableKnownGlyphsOptimization",!0)&&(e.meta_knownGlyphs=this.m_viewDataManager.glyphStore.knownGlyphsString),A.Settings.readBooleanOrDefault("enableRegionalFormattingOnBoot",!1)&&(e.meta_localeName=this.m_sessionSettings.appSettings.applicationLocaleName),e}},{key:"updateLastRequestedSlideState",value:function(e){this.m_lastRequestedSlideState=e}},{key:"getGpuMemory",value:function(){if(this.m_viewController){var e=this.m_viewController.getGpuMemory();return{total:e.total,images:e.images,leaks:e.leaks}}}},{key:"handleCustomSlideshow",value:function(e){if(p.ULS.sendTraceTag(507257231,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlide: Custom Slideshow, customShowIndex:".concat(e)),this.shouldFetchCustomShows){var t=this.m_providers.presInfo.getLoadResultInCache("");if(!(t&&t.resource&&t.resource.CustomShows))return void(t&&t.resource?p.ULS.sendTraceTag(507257230,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::gotoSlide: Custom Slideshow, CustomShows not found in presItem present in cache"):p.ULS.sendTraceTag(507127391,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::gotoSlide: Custom Slideshow, presItem not found in cache"));this.m_customShows=t.resource.CustomShows,this.m_customShowReceivedTime=Date.now()}if(this.m_customShows)if(e>=0&&e<this.m_customShows.length){var r=this.m_customShows[e];r&&r.sid&&r.sid.length>0&&(this.m_currentCustomShowIndex=e,this.setSlideIdOrderforCustomSlideShow(r))}else p.ULS.sendTraceTag(507257229,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::gotoSlide: Custom Slideshow, Invalid customShowIndex")}},{key:"handleSlideIdOrderDuringSlideShowLaunch",value:function(e){-1!==e?this.handleCustomSlideshow(e):(this.m_isCustomSlideShowActive||x.ChangeGate.isChangeGateEnabled("RestoreSlideIdOrder")&&this.m_isSlideIdOrderUpdated)&&this.restoreSlideIdOrder()}},{key:"gotoSlideImpl",value:(Ce=(0,s.default)(a.default.mark((function t(r,i){var n,o,s,l,c,u,f,m,g,_,S,w,P,I,k,E,L,M,R,O,D,F,B,N,V,U,W,G,H,z=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i?i.actionContext:void 0,p.ULS.sendTraceTag(576979914,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlide: currentSlideLocation:".concat(JSON.stringify(this.m_currentSlideLocation),",\n      slideState:").concat(JSON.stringify(r),",\n      animationState:").concat(JSON.stringify(i?i.animationState:""),",\n      skipTansition:").concat(i?i.fSkipTransition:"",",\n      fForceRetry:").concat(i?i.fForceRetry:"",",\n      fForceNavigate:").concat(i?i.fForceNavigate:"",",\n      fSuppressNavigatedFromEvent:").concat(i?i.fSuppressNavigatedFromEvent:"",",\n      fClearNavigationState:").concat(i?i.fClearNavigationState:"")),r&&null!==r.customShowIndex&&void 0!==r.customShowIndex&&this.handleSlideIdOrderDuringSlideShowLaunch(r.customShowIndex),x.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")&&i&&i.fClearNavigationState&&this.clearNavigationState(),n&&n.startFromTime&&(y.SessionUtils.logSessionStart(n.startFromTime),v.VetoUtils.setVetoUtil({SessionId:this.m_sessionSettings.appSettings.userSessionId,StartFromTime:n.startFromTime},this.m_logger)),o=(0,C.v4)(),s={renderTransition:{},renderSlide:{},createTexture:{},id:o},!A.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)||!this.m_presInfoPromise){t.next=11;break}return p.ULS.sendTraceTag(507855134,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoSlide: : m_presInfoPromise is not resolved yet."),t.next=11,this.m_presInfoPromise;case 11:if(!(!this.m_viewController||this.m_stateManager.state===d.SlideShowCoreState.Loading||this.m_zoomAnimationController.isZooming||this.isTransitioning&&this.cancelTransition())){t.next=14;break}return p.ULS.sendTraceTag(592483859,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoSlide returns early. m_viewController:".concat(!!this.m_viewController,",\n          this.m_stateManager.state:").concat(this.m_stateManager.state,",\n          isInitialized:").concat(!!y.SessionUtils.getSessionStats("initDur"),",\n          bootMetrics:").concat(!(!n||!n.bootMetrics),",\n          navMetrics:").concat(!(!n||!n.navMetrics),",\n          isZooming:").concat(this.m_zoomAnimationController.isZooming," due to ").concat(this.m_zoomAnimationController.zoomSource,",\n          this.isTransitioning:").concat(this.isTransitioning,"\n          navigationType:").concat(n?n.navigationType:"")),t.abrupt("return",{fSucceeded:!1,error:d.RequestStatus.SkippedBusy});case 14:if((l={})[b.ActionType.Goto]={start:y.SessionUtils.performanceNowTrimmed()},l[b.BootSegmentType.EnsureSlideView]={start:y.SessionUtils.performanceNowTrimmed()},c=this.resolvePartialSlideLocation(r),u=!Y(c,this.m_currentSlideLocation),f=!(!n||n.navigationType!==d.NavigationType.Init),m=!(!i||!i.fForceNavigate)&&i.fForceNavigate,g=!(!i||!i.fSuppressNavigatedFromEvent)&&i.fSuppressNavigatedFromEvent,_=u||f||m,S=u||m,f&&(this.m_cameoPresenceCache={}),p.ULS.sendTraceTag(545886353,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlide: ".concat(JSON.stringify({shouldNavigate:_,targetSlideHasNewContent:S,isDifferentSlide:u,isInit:f,isForceNavigate:m,suppressNavigatedFromEvent:g}))),w={},!c||!_){t.next=135;break}if(A.Settings.readBooleanOrDefault("emitSlideNavigationStartedEvents",!1)&&this.events.emit("slideNavigationStarted",{targetSlideLocation:c,actionContext:n}),!A.Settings.readBooleanOrDefault("enableOpticalZoom",!1)||!u){t.next=37;break}if(!i||!i.fSkipTransition){t.next=35;break}this.m_zoomAnimationController.stopZoomAnimation(),this.setOpticalZoomState({currentState:e.s_defaultOpticalZoomState,metadata:{source:"slideLocationChanged"}}),t.next=37;break;case 35:return t.next=37,this.zoomToAsync(1,void 0,{fAnimate:!0,source:d.OpticalZoomSource.SlideLocationChanged});case 37:return S&&(this.m_currentSlideLocation&&this.onNavigatingFrom(this.m_currentSlideLocation.slideId),this.onNavigatingTo(c.slideId)),P=(0,C.v4)(),l=j(j({},l),{sid:c.slideId.sid,correlationId:P,step:this.m_currentSlideLocation?c.slideIndex-this.m_currentSlideLocation.slideIndex:0}),I=y.SessionUtils.performanceNowTrimmed(),this.m_stateManager.setState(d.SlideShowCoreState.Loading),k=setTimeout((function(){0!==y.SessionUtils.startFrom&&n&&!n.bootMetrics&&v.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",j(j({},l),{},{reportTime:y.SessionUtils.performanceNowTrimmed(),qosVeto:"SlideShowNavSlow"}))}),A.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)),t.next=45,this.ensureSlideViewElementAsync(c.slideId,!0,P,b.ActionType.Goto,f,n);case 45:if(E=t.sent,clearTimeout(k),n&&n.navMetrics&&(l.navMetrics=n.navMetrics),x.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&n&&n.additionalMetrics&&(L=!n.additionalMetrics.isUpdateResourceProviderCalled&&n.additionalMetrics.isSlideCached,p.ULS.sendTraceTag(508067914,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify({isSlideCached:L,isSlideCachedRaw:!!n.additionalMetrics.isSlideCached,isUpdateResourceProviderCalled:!!n.additionalMetrics.isUpdateResourceProviderCalled,id:n.id}))),this.handleErrors(E,{errorAction:X.GotoSlideEnsureSlide,navigationType:n?n.navigationType:void 0}),M=this.m_viewController.getSlideViewElement(c.slideId),!this.m_isHandlingResourceInconsistent){t.next=55;break}p.ULS.sendTraceTag(541180366,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlide: skip rendering due to handling resource incosistent status"),t.next=127;break;case 55:if(M){t.next=62;break}if(p.ULS.sendTraceTag(593860625,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoSlide slideViewElement of targetSlideLocation is missing. Reverting to previous slide.\n          bootMetrics:".concat(!(!n||!n.bootMetrics),",\n          navMetrics:").concat(!(!n||!n.navMetrics))),this.m_stateManager.setState(d.SlideShowCoreState.Normal),this.m_currentSlideLocation&&S&&(this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(this.m_currentSlideLocation.slideId)),!x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")){t.next=61;break}return t.abrupt("return",{fSucceeded:!1,error:d.RequestStatus.Failed,errorName:E.hasOwnProperty("errorName")?E.errorName:d.SlideShowErrorCode.SlideViewElementUndefined,metrics:l});case 61:return t.abrupt("return",{fSucceeded:!1,error:d.RequestStatus.Failed});case 62:if(l[b.BootSegmentType.EnsureSlideView].end=y.SessionUtils.performanceNowTrimmed(),l[b.BootSegmentType.ResizeViewContainer]={start:y.SessionUtils.performanceNowTrimmed()},this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,M.slideSizePixels),l[b.BootSegmentType.ResizeViewContainer].end=y.SessionUtils.performanceNowTrimmed(),A.Settings.readBooleanOrDefault("allowSkipRenderInSetBlankSlideState",!1)?this.setBlankSlideStateInternal(d.BlankSlideState.Hidden,{fSkipRenderSlide:f}):this.setBlankSlideState(d.BlankSlideState.Hidden),l[b.BootSegmentType.RenderTransition]={start:y.SessionUtils.performanceNowTrimmed()},R=this.m_container.contains(document.activeElement),i&&i.fSkipTransition||!this.m_currentSlideLocation){t.next=75;break}return f&&this.events.emit("bootStageChanged","RenderingTransition"),t.next=73,this.renderTransition(c,this.m_currentSlideLocation,{correlationId:P});case 73:(O=t.sent)&&this.handleErrors(O,{errorAction:X.GotoSlideRenderTransition,navigationType:n?n.navigationType:void 0});case 75:if(this.m_stateManager.setState(d.SlideShowCoreState.Normal),l.spinnerDisplayTime=y.SessionUtils.performanceNowTrimmed()-I,l[b.BootSegmentType.RenderTransition].end=y.SessionUtils.performanceNowTrimmed(),l[b.BootSegmentType.RenderSlide]={start:y.SessionUtils.performanceNowTrimmed()},F=0,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(F=h.ViewController.performanceNowTrimmed()),this.onBeforeFirstRenderAfterNavigation(M.slideId),x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s.renderSlide.preRenderEventDuration=h.ViewController.performanceNowTrimmed()-F),p.ULS.sendTraceTag(575776401,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlideImpl - Rendering SlideId: ".concat(c.slideId.sid)),B=0,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(B=h.ViewController.performanceNowTrimmed()),D=x.ChangeGate.isChangeGateEnabled("logRenderSnapshot")?this.m_viewController.renderSlideByIdCollectingPerfData(c.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:f,slideIndex:c.slideIndex,id:o,prefetchWindowRange:this.prefetchWindowRange,navType:n&&n.navigationType,step:this.m_currentSlideLocation?c.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:i&&i.navInitTimestamp}):this.m_viewController.renderSlideByIdCollectingPerfData(c.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:f}),x.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&D&&D.hasOwnProperty("additionalPerfMeta")&&(D.additionalPerfMeta=void 0),x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s.renderSlide.renderSlideById=h.ViewController.performanceNowTrimmed()-B),!D||!D.hasOwnProperty("errorName")){t.next=115;break}if("TryPrepareTimeout"!==D.errorName){t.next=99;break}if(f&&this.events.emit("bootStageChanged","SwitchingToSVG"),N=0,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(N=h.ViewController.performanceNowTrimmed()),window.setTimeout((function(){return z.changeRenderingModeToSVG({location:c})}),0),x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s.renderSlide.switchSVG=h.ViewController.performanceNowTrimmed()-N),!x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")){t.next=98;break}return t.abrupt("return",{fSucceeded:!1,error:d.RequestStatus.Failed,errorName:D.errorName,metrics:l});case 98:return t.abrupt("return",{fSucceeded:!1,error:d.RequestStatus.Failed});case 99:if("TexturesNotLoaded"!==D.errorName){t.next=115;break}return p.ULS.sendTraceTag(575193410,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlideImpl - Before Reloading textures for SlideId: ".concat(c.slideId.sid," RenderResult: ").concat(JSON.stringify(D))),l[b.BootSegmentType.ReloadTexture]={start:y.SessionUtils.performanceNowTrimmed()},f&&this.events.emit("bootStageChanged","ReEnsureTextureLoaded"),V=0,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(V=h.ViewController.performanceNowTrimmed()),t.next=107,this.m_viewController.ensureTextureLoaded(c.slideId);case 107:U=t.sent,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s.renderSlide.ensureTexture=h.ViewController.performanceNowTrimmed()-V),l[b.BootSegmentType.ReloadTexture].end=y.SessionUtils.performanceNowTrimmed(),W=0,x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(W=h.ViewController.performanceNowTrimmed()),D=x.ChangeGate.isChangeGateEnabled("logRenderSnapshot")?this.m_viewController.renderSlideByIdCollectingPerfData(c.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:f,slideIndex:c.slideIndex,id:o,prefetchWindowRange:this.prefetchWindowRange,navType:n&&n.navigationType,step:this.m_currentSlideLocation?c.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:i&&i.navInitTimestamp}):this.m_viewController.renderSlideByIdCollectingPerfData(c.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:f}),x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(s.renderSlide.renderSlideById2=h.ViewController.performanceNowTrimmed()-W),p.ULS.sendTraceTag(575193411,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlideImpl - After Reloading textures for SlideId: ".concat(c.slideId.sid," TextureLoadResult:").concat(JSON.stringify(U)," RenderResult: ").concat(JSON.stringify(D)));case 115:D&&D.hasOwnProperty("errorName")&&this.handleErrors(D,{errorAction:X.GotoSlideRenderSlide,navigationType:n?n.navigationType:void 0}),R&&!A.Settings.readBooleanOrDefault("disableFocusCallAfterGoToSlide",!1)&&this.m_container.focus(),l[b.BootSegmentType.RenderSlide].end=y.SessionUtils.performanceNowTrimmed(),l[b.ActionType.Goto].end=y.SessionUtils.performanceNowTrimmed(),x.ChangeGate.isChangeGateEnabled("SSEUPLBugTelemetry")&&n&&n.bootMetrics&&n.startFromTime&&0!==n.startFromTime&&p.ULS.sendTraceTag(508355610,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoSlide: New EUPL: ".concat(l[b.ActionType.Goto].end-n.startFromTime)),G=[],E.hasOwnProperty("errorName")&&G.push(E.errorName),O&&O.hasOwnProperty("errorName")&&G.push(O.errorName),D&&D.hasOwnProperty("errorName")&&G.push(D.errorName),H=G.length?{errorName:G}:{},x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(O&&O.hasOwnProperty("createTransition")&&O.createTransition.hasOwnProperty("rendererEnvironment")&&(O.createTransition.rendererEnvironment.hasOwnProperty(T.NavigationLoggerNew.RenderTransitionTextures)&&(s.renderTransition.renderTransitionTextures=O.createTransition.rendererEnvironment[T.NavigationLoggerNew.RenderTransitionTextures]),O.createTransition.rendererEnvironment.hasOwnProperty(T.NavigationLoggerNew.GenerateMorphResource)&&(s.renderTransition.generateMorphResource=O.createTransition.rendererEnvironment[T.NavigationLoggerNew.GenerateMorphResource]),O.createTransition.rendererEnvironment.hasOwnProperty(T.NavigationLoggerNew.RenderToTexture)&&(s.renderTransition.renderToTexture=O.createTransition.rendererEnvironment[T.NavigationLoggerNew.RenderToTexture])),E&&E.hasOwnProperty(T.NavigationLoggerNew.TextureMetadata)&&(s.createTexture=E[T.NavigationLoggerNew.TextureMetadata]),p.ULS.sendTraceTag(507834826,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(s))),x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,b.ActionType.Goto,j(j(j(j(j(j(j({sr:A.Settings.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source},x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")?{id:s.id}:null),this.m_stateManager.getTelemetry()),E),O),D),l),H),n):b.NavigationLogger.recordNavData(this.m_viewController.viewDataManager,b.ActionType.Goto,j(j(j(j(j(j(j({sr:A.Settings.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source},x.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")?{id:s.id}:{}),this.m_stateManager.getTelemetry()),E),O),D),l),H),n);case 127:!S&&x.ChangeGate.isChangeGateEnabled("PreventNavEventForNoChangeInSlide")||(this.m_currentSlideLocation&&!g&&this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(c.slideId)),this.m_currentTimelineStates=[],M&&(this.m_currentTimelineStates=M.animTimeline.getTimelineStates(!1)),p.ULS.sendTraceTag(577245973,p.LogCategory.msoulscat_Wac_PptSlideshow,c?p.TraceLevel.Info:p.TraceLevel.Error,"SlideShowCore::gotoSlide: reset global animationTimeline targetSlideLocation:".concat(JSON.stringify(c)," currentSlideLocation:").concat(JSON.stringify(this.m_currentSlideLocation),", target SlideViewElement is null:").concat(!M)),this.m_currentSlideLocation=c,this.events.emit("slideLocationChanged",{actionContext:n}),t.next=136;break;case 135:p.ULS.sendTraceTag(592229825,p.LogCategory.msoulscat_Wac_PptSlideshow,c?p.TraceLevel.Info:p.TraceLevel.Error,"SlideShowCore::gotoSlide: targetSlideLocation:".concat(JSON.stringify(c)," currentSlideLocation:").concat(JSON.stringify(this.m_currentSlideLocation)," slideState:").concat(JSON.stringify(r)));case 136:if(i&&i.animationState&&(this.gotoAnimationState(i.animationState,A.Settings.readBooleanOrDefault("emitActionContextWithAnimationState",!1)?n:void 0),this.setBlankSlideState(d.BlankSlideState.Hidden)),p.ULS.sendTraceTag(540058966,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::gotoSlide: Sucessfully navigated to targetSlideLocation:".concat(JSON.stringify(c)," currentSlideLocation:").concat(JSON.stringify(this.m_currentSlideLocation)," slideState:").concat(JSON.stringify(r))),!x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")){t.next=142;break}if(!x.ChangeGate.isChangeGateEnabled("LoggingEnsureSlideResult")){t.next=141;break}return t.abrupt("return",{fSucceeded:!0,metrics:{gotoSlideResult:l,ensureSlideResult:w}});case 141:return t.abrupt("return",{fSucceeded:!0,metrics:l});case 142:return t.abrupt("return",{fSucceeded:!0});case 143:case"end":return t.stop()}}),t,this)}))),function(e,t){return Ce.apply(this,arguments)})},{key:"gotoSlide",value:(be=(0,s.default)(a.default.mark((function t(r,i){var n,o,l,c,u,h,f,m,g=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A.Settings.readBooleanOrDefault("EnableSourceAppType",!1)&&i&&i.actionContext&&i.actionContext.bootMetrics&&i.actionContext.bootMetrics.sr&&(this.m_appType=i.actionContext.bootMetrics.sr),o=i&&i.actionContext&&i.actionContext.navMetrics?i.actionContext.navMetrics:{},l=!!o.isForceRetry,n=l?void 0!==o.requestId?o.requestId:-1:this.m_gotoSlideRequestCount+=1,t.next=6,this.gotoSlideImpl(r,i);case 6:if(c=t.sent,u=i&&i.fClearNavigationState,p.ULS.sendTraceTag(508078273,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoSlide:result:".concat(c.fSucceeded,",Navigation Type:").concat(i&&i.actionContext?i.actionContext.navigationType:"")),h={slideLocation:r,options:i},this.m_networkHealthManager&&this.m_networkHealthManager.stopPinging(),f={requestId:n,stateRequested:JSON.stringify(h),isRetryRequest:l,fRetryAttempted:!1,fRetrySet:!1,stateRequestedForRetry:"",stateRetryWasCalledWith:"",fSucceededAndStateMatchesRetry:!1,fSucceededAndRunningRetry:!1},!(c.error&&c.error===d.RequestStatus.SkippedBusy&&i&&i.fForceRetry)){t.next=24;break}if(f.fRetryAttempted=!0,this.fAreSlideStatesEqual(h,this.m_lastRequestedSlideState,u)){t.next=22;break}return f.fRetrySet=!0,this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!1,error:d.RequestStatus.SkippedNewTarget}),this.m_lastRequestedSlideStateResolveFunction=void 0),A.Settings.readBooleanOrDefault("updateLastRequestedSlideState",!0)||(this.m_lastRequestedSlideState={slideLocation:r,options:j(j({},i),{},{requestId:n})}),f.stateRequestedForRetry=JSON.stringify(this.m_lastRequestedSlideState),t.next=21,new Promise(function(){var e=(0,s.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.m_lastRequestedSlideStateResolveFunction=t;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 21:m=t.sent;case 22:t.next=25;break;case 24:if(c.fSucceeded&&h&&this.m_lastRequestedSlideState&&h.slideLocation&&this.m_lastRequestedSlideState.slideLocation)if(this.fAreSlideStatesEqual(h,this.m_lastRequestedSlideState,u))this.m_lastRequestedSlideState={},this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!0}),this.m_lastRequestedSlideStateResolveFunction=void 0),f.fSucceededAndStateMatchesRetry=!0;else try{p.ULS.sendTraceTag(577573152,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"goToSlide: Just went to ".concat(h.slideLocation.slideIndex,", ")+"".concat(JSON.stringify(h.options?h.options.animationState:""),". ")+"Try to go to this.m_lastRequestedSlide: ".concat(JSON.stringify(this.m_lastRequestedSlideState.slideLocation),", ")+"".concat(JSON.stringify(this.m_lastRequestedSlideState.options?this.m_lastRequestedSlideState.options.animationState:""))),this.m_lastRequestedSlideState.options&&this.m_lastRequestedSlideState.options.actionContext&&this.m_lastRequestedSlideState.options.actionContext.navMetrics&&(this.m_lastRequestedSlideState.options.actionContext.navMetrics.isForceRetry=!0,this.m_lastRequestedSlideState.options.actionContext.navMetrics.requestId=this.m_lastRequestedSlideState.options.requestId),f.fSucceededAndRunningRetry=!0,f.stateRetryWasCalledWith=JSON.stringify(this.m_lastRequestedSlideState),this.gotoSlide(this.m_lastRequestedSlideState.slideLocation,this.m_lastRequestedSlideState.options)}catch(e){p.ULS.sendTraceTag(572057293,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"goToSlide retry caught exception: ".concat(e))}case 25:return p.ULS.sendTraceTag(507307999,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"gotoSlide controlFlowTelemetry: ".concat(JSON.stringify(j(j({},f),{},{retryResult:e.copyWithoutMetrics(m),navigationResult:e.copyWithoutMetrics(c)})))),t.abrupt("return",m||c);case 27:case"end":return t.stop()}}),t,this)}))),function(e,t){return be.apply(this,arguments)})},{key:"setSlideIdOrderforCustomSlideShow",value:function(e){this.m_isCustomSlideShowActive=!0,this.m_slideIdOrder=[];var t,r=z(e.sid);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.m_slideIdOrder.push({sid:i,cid:0})}}catch(e){r.e(e)}finally{r.f()}this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}},{key:"restoreSlideIdOrder",value:function(){this.m_isCustomSlideShowActive=!1,this.m_currentCustomShowIndex=-1,this.m_isSlideIdOrderUpdated=!1,this.m_slideIdOrder=this.m_defaultSlideIdOrder,this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder)}},{key:"fAreSlideStatesEqual",value:function(e,t,r){if(x.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")&&r)return!1;if(!e.slideLocation&&!t.slideLocation)return!0;if(e.slideLocation&&t.slideLocation&&e.slideLocation.slideIndex===t.slideLocation.slideIndex&&e.slideLocation.slideId===t.slideLocation.slideId){if(!e.options&&!t.options)return!0;if(e.options&&t.options&&Y(e.options.animationState,t.options.animationState))return!0}return!1}},{key:"handleErrors",value:function(e,t){var r=[],i=t.errorAction,n=t.navigationType;if(this.m_isHandlingResourceInconsistent){var a=e.hasOwnProperty("errorName")?e.errorName:"";p.ULS.sendTraceTag(541403222,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::handleErrors - not triggering slideshow error due to handling resource inconsistent status. action:".concat(i,", error:").concat(a," "))}else{if(e.hasOwnProperty("errorName")){var o=e.errorName,s=E.ErrorUtils.convertToSlideShowError(o);""===o&&(s="".concat(i,"EmptyError"),e.errorName=s),t.errorCode=s,s!==d.SlideShowErrorCode.SlideVisualizationFailed&&(s===d.SlideShowErrorCode.GetItemsFailedDownloadFile?(this.events.emit("slideshowError",t),y.SessionUtils.recordSessionStats({downloadFileFailed:"handleErrors-".concat(i)}),p.ULS.sendTraceTag(507127109,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors - slideshowError emitted for navigationType: ".concat(n,", errorCode: ").concat(s,", errorAction: ").concat(i))):(0!==y.SessionUtils.startFrom&&i!==X.PrefetchEnsureSlide||i===X.InitPresInfo||i===X.CheckHidden)&&(this.events.emit("slideshowError",t),p.ULS.sendTraceTag(507127108,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors - slideshowError emitted for navigationType: ".concat(n,", errorCode: ").concat(s,", errorAction: ").concat(i)))),r.push({errorName:o,errorInfo:s})}if(e.hasOwnProperty("imgErrorName")){var l=e.imgErrorName;e.hasOwnProperty("errorName")||(e.errorName="IMG".concat(l)),r.push({errorName:l,errorInfo:E.ErrorUtils.convertToSlideShowError(e.imgErrorName)})}if(e.hasOwnProperty("invalidImageIds")&&(p.ULS.sendTraceTag(556045641,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors. action:".concat(i,", startFrom:").concat(y.SessionUtils.startFrom,", ").concat(JSON.stringify(e))),r.push({errorName:"InvalidImages",errorInfo:e.invalidImageIds}),e.hasOwnProperty("errorName")||(e.errorName="InvalidImage"),e.invalidImageIds=""),e.hasOwnProperty("missingTextureIds")&&(p.ULS.sendTraceTag(556045642,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors. action:".concat(i,", startFrom:").concat(y.SessionUtils.startFrom,", ").concat(JSON.stringify(e))),r.push({errorName:"missingTextureIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="MissingTexture"),e.missingTextureIds=""),e.hasOwnProperty("invalidShapeIds")&&(p.ULS.sendTraceTag(556045643,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors. action:".concat(i,", startFrom:").concat(y.SessionUtils.startFrom,", ").concat(JSON.stringify(e))),r.push({errorName:"invalidShapeIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="InvalidShape"),e.invalidShapeIds=""),e.hasOwnProperty("axError")){var c=e.axError;r.push({errorName:"missingAccessabilityModel",errorInfo:c}),e.hasOwnProperty("errorName")||(e.errorName="AX".concat(c))}if(e.hasOwnProperty("imagesMissingFromServer")){var u=e.imagesMissingFromServer;r.push({errorName:"imagesMissingFromServer",errorInfo:u}),e.hasOwnProperty("errorName")||(e.errorName="ImagesMissingFromServer")}0!==y.SessionUtils.startFrom&&r.length>0&&i!==X.PrefetchEnsureSlide&&(r.find((function(e){return e.errorInfo===d.SlideShowErrorCode.GetItemsFailedDownloadFile}))?v.VetoUtils.recordVeto("NavigationInterruption",j(j({},e),{},{qosVeto:"ContentRenderFailed"})):(e.hasOwnProperty("errorName")||(e.errorName="".concat(i,"EmptyError")),v.VetoUtils.recordVeto("ACE",j(j({},e),{},{action:i,qosVeto:"ContentRenderFailed"})))),r.length>0&&p.ULS.sendTraceTag(593757456,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::handleErrors. action:".concat(i,", startFrom:").concat(y.SessionUtils.startFrom,", ").concat(JSON.stringify(r))),r.length>0&&r.find((function(e){return e.errorInfo===d.SlideShowErrorCode.GetItemsFailedDownloadFile}))||!y.SessionUtils.getSessionStats("downloadFileFailed")||y.SessionUtils.recordSessionStats({downloadFileFailed:"EnsureSlideViewElementSucceeded"})}}},{key:"updateSlideResources",value:(Te=(0,s.default)(a.default.mark((function t(r,i,n){var o,s,l,c,u,h,f,m,g,v,_,S;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={loadImagesGetSlideViewData:{start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()}},t.next=3,this.m_viewDataManager.getSlideViewData(r.id);case 3:if(s=t.sent,o.loadImagesGetSlideViewData.end=y.SessionUtils.performanceNowTrimmed(),s.resource&&this.m_viewController){t.next=9;break}return p.ULS.sendTraceTag(591734978,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::updateSlideResources. missing slideViewData. slideViewData:".concat(!!s.resource,", viewController:").concat(!!this.m_viewController,", currentSlideLocation:").concat(this.m_currentSlideLocation?this.m_currentSlideLocation.slideId.sid:"")),s.metadata.hasOwnProperty("errorName")&&(o.errorName=s.metadata.errorName),t.abrupt("return",o);case 9:if(l=s.resource,(c=e.filterToResourceEntriesWithMissingImages(l.resCat))&&0!==c.length){t.next=13;break}return t.abrupt("return",o);case 13:u=[],h={meta_slideId:r.id,meta_resourceEntries:c,meta_correlationId:i,meta_isInit:n},this.addCommonResourceMetadata(h),f=z(c);try{for(f.s();!(m=f.n()).done;)g=m.value,u.push(this.m_providers.imageData.load(g.id,h))}catch(e){f.e(e)}finally{f.f()}return o.loadImages={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},t.next=21,Promise.all(u);case 21:return v=t.sent,o.loadImages.end=y.SessionUtils.performanceNowTrimmed(),(_=l.resCat.find((function(e){return""===e.url})))&&(o.missingResourceId=_.id,S=new Set,v.forEach((function(e){e.metadata&&e.metadata.hasOwnProperty("errorName")&&S.add(e.metadata.errorName)})),0===S.size&&S.add(d.SlideShowErrorCode.LoadFailed),o.imgErrorName=Array.from(S),p.ULS.sendTraceTag(593847575,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(o))),t.abrupt("return",o);case 26:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return Te.apply(this,arguments)})},{key:"renderTransition",value:(Se=(0,s.default)(a.default.mark((function e(t,r,i){var n,o,l,c,u=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.slideId.cid!==r.slideId.cid||t.slideId.sid!==r.slideId.sid){e.next=2;break}return e.abrupt("return");case 2:if(n=this.m_viewController){e.next=5;break}return e.abrupt("return");case 5:return o=t.slideIndex>=r.slideIndex,l={createTransition:{start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()}},e.next=9,n.createTransition(t.slideId,r.slideId,o,i);case 9:if(c=e.sent,this.m_stateManager.setState(d.SlideShowCoreState.Normal),l.createTransition.end=y.SessionUtils.performanceNowTrimmed(),x.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&c.metadata&&(c.metadata.getSlideViewPerfInTransitionMS&&(l.createTransition.slideVInT=c.metadata.getSlideViewPerfInTransitionMS),c.metadata.rendererEnvironment&&(l.createTransition.rendererEnvironment=c.metadata.rendererEnvironment)),!c.fSuccess){e.next=19;break}return c.effectId&&void 0!==c.isSupported&&y.SessionUtils.recordSessionTransitionStats(c),l.metadata=["transition-".concat(c.effectId)],l[b.NavigationLogger.PlayTransitionMs]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},this.setTransitionState(!0,c),e.abrupt("return",new Promise((function(e){var t=n.getTransitionController();if(!t)return u.setTransitionState(!1,c),void e(l);var r=-1,i=function(){"hidden"===document.visibilityState&&u.isTransitioning?r=window.setTimeout((function(){n.finishTransition(),r=-1}),t.duration-t.clock.currentTimeMs):window.clearTimeout(r)};t.clock.events.on("tick",function(){var r=(0,s.default)(a.default.mark((function r(o){return a.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return document.addEventListener("visibilitychange",i),u.setTransitionState(t.render(o),c),u.isTransitioning||(n.finishTransition(),e(l)),r.abrupt("return",l);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),t.clock.events.on("notRunning",(0,s.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:document.removeEventListener("visibilitychange",i),u.setTransitionState(!1,c),l[b.NavigationLogger.PlayTransitionMs].end=y.SessionUtils.performanceNowTrimmed(),e(l);case 4:case"end":return t.stop()}}),t)}))))})));case 19:return c.metadata&&c.metadata.hasOwnProperty("errorName")&&p.ULS.sendTraceTag(591734979,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::renderTransition: create transition failed. from:".concat(r.slideId.sid,", to:").concat(t.slideId.sid,", effectId:").concat(c.effectId,", isSupported:").concat(c.isSupported,", errorName:").concat(c.metadata?c.metadata.errorName:"")),e.abrupt("return",l);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return Se.apply(this,arguments)})},{key:"isHiddenFromHiddenList",value:function(e){var t=this;return this.m_hiddenSlideIdOrder.some((function(r){return r.sid===t.m_slideIdOrder[e].sid&&r.cid===t.m_slideIdOrder[e].cid}))}},{key:"isHidden",value:(_e=(0,s.default)(a.default.mark((function e(t){var r,i,n,o,s,l;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,i={},!A.Settings.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)||!this.m_presInfoPromise){e.next=8;break}return p.ULS.sendTraceTag(507855133,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::isHidden: : m_presInfoPromise is not resolved yet."),e.next=6,this.m_presInfoPromise;case 6:n=e.sent,x.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&(r=!n||!n.resource);case 8:if(o=this.m_slideIdOrder[t],(s=this.m_viewDataManager.slideMetadataMap.get(o.sid))&&void 0!==s.isHidden){e.next=21;break}return this.logSlideMetadataMapContentWithMessage("Slide Data not found in slideMetadataMap. Trying to Ensure SlideViewElement."),i.ensureSlideStart=y.SessionUtils.performanceNowTrimmed(),e.next=15,this.ensureSlideViewElementAsync(o,!1,(0,C.v4)(),b.ActionType.CheckHidden,!1);case 15:l=e.sent,i.ensureSlideEnd=y.SessionUtils.performanceNowTrimmed(),i.ensureSlideResult=l,(s=this.m_viewDataManager.slideMetadataMap.get(o.sid))&&void 0!==s.isHidden||(this.logSlideMetadataMapContentWithMessage("Slide Data not found in slideMetadataMap after ensure SlideViewElement."),x.ChangeGate.isChangeGateEnabled("SlideShowErrorLoggingFix")?l.hasOwnProperty("errorName")||(s?void 0===s.isHidden&&(l.errorName="InvalidHiddenSlideInfo"):l.errorName="SlideMetadataNotFound",i.errorName=l.errorName):l.hasOwnProperty("errorName")||(l.errorName="InvalidHiddenSlideInfo",i.errorName=l.errorName),p.ULS.sendTraceTag(576264263,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::isHidden: invalid slideMetadata or undefined isHidden property after ensure SlideViewElement. slideMetadata:".concat(!!s,", Sid:").concat(o.sid,", presInfoFailed:").concat(r))),this.handleErrors(l,{errorAction:X.CheckHidden});case 21:return i.isHidden=s?s.isHidden:void 0,e.abrupt("return",i);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return _e.apply(this,arguments)})},{key:"logSlideMetadataMapContentWithMessage",value:function(e){x.ChangeGate.isChangeGateEnabled("SlideShowSlideMetadataLogging")&&p.ULS.sendTraceTag(507371542,p.LogCategory.msoulscat_Wac_PptSession,p.TraceLevel.Info,"SlideShowCore::isHidden: ".concat(e,":").concat(JSON.stringify(Array.from(this.m_viewDataManager.slideMetadataMap))))}},{key:"getSlideLocation",value:function(){return this.m_currentSlideLocation||p.ULS.sendTraceTag(592229826,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::getSlideLocation: Undefined m_currentSlideLocation"),this.m_currentSlideLocation}},{key:"nextSlide",value:(ye=(0,s.default)(a.default.mark((function e(t){var r,i,n,o,s,l,c,u,h,f,m,v,_,S,T,C,w,P,I,k,E,L,M;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r={fSucceeded:!1}).metrics={},!(!this.m_viewController||!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!0)||this.m_stateManager.state===d.SlideShowCoreState.Loading||this.isTransitioning&&this.cancelTransition())){e.next=5;break}return x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.SlideShowCoreState=this.m_stateManager.state,r.metrics.isTransitioning=this.isTransitioning,r.metrics.returnEarly=!0),e.abrupt("return",r);case 5:if(x.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(i=Date.now()),n=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId),!(!t||n&&n.animTimeline.hasTimelineFinished(g.AnimConstants.MainTimelineId))){e.next=72;break}if((o={})[b.ActionType.CheckHidden]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},!A.Settings.readBooleanOrDefault("enableSummaryZoom",!1)){e.next=49;break}if(!this.m_zoomManager||!this.m_zoomManager.needsToReturnOnNext(this.m_currentSlideLocation.slideId)){e.next=21;break}if(p.ULS.sendTraceTag(522311769,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::nextSlide - Zoom returning to parent"),!(s=this.m_zoomManager.nextReturnToParentId(this.m_currentSlideLocation.slideId))){e.next=19;break}return e.next=17,this.gotoSlide({slideId:s},{actionContext:{navigationType:d.NavigationType.Next},navInitTimestamp:i});case 17:l=e.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.gotoSlideResult=l,r.fSucceeded=l.fSucceeded,r.errorName=l.errorName?l.errorName:l.error);case 19:e.next=47;break;case 21:c=this.m_currentSlideLocation,u=!1,this.m_zoomManager&&((u=this.m_zoomManager.needsToJumpOnNext(this.m_currentSlideLocation.slideId))&&(p.ULS.sendTraceTag(522311770,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::nextSlide - Zoom Jumping Slides"),f=this.m_zoomManager.slideWhereZoomLeftOff(this.m_currentSlideLocation.slideId),h=this.resolvePartialSlideLocation({slideId:f})),c=h||c),m=c.slideIndex+1;case 25:if(!(m<this.m_slideIdOrder.length)){e.next=46;break}return e.next=28,this.isHidden(m);case 28:if(v=e.sent,_=v.isHidden,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.isHiddenResult=v),void 0!==_){e.next=34;break}return r.errorName=v.hasOwnProperty("errorName")?v.errorName:d.SlideShowErrorCode.IsHiddenFailed,e.abrupt("return",r);case 34:if(_){e.next=43;break}return o[b.ActionType.CheckHidden].end=y.SessionUtils.performanceNowTrimmed(),S=this.resolvePartialSlideLocation({slideIndex:m}),n&&this.m_zoomManager&&S&&(T=n.getAllZoomsOnSlide(),!this.m_zoomManager.zoomOnCurrentSlide(S.slideId,T,this.m_currentSlideLocation.slideId)&&u&&(p.ULS.sendTraceTag(522311771,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::nextSlide - matching zoom not detected on slide"),this.m_zoomManager.addSlide(S.slideId,this.m_currentSlideLocation.slideId,!1))),e.next=40,this.gotoSlide({slideIndex:m},{actionContext:{navigationType:d.NavigationType.Next,navMetrics:o},navInitTimestamp:i});case 40:return C=e.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.gotoSlideResult=C,r.fSucceeded=C.fSucceeded,r.errorName=C.errorName?C.errorName:C.error),e.abrupt("return",r);case 43:m+=1,e.next=25;break;case 46:this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||(this.setBlankSlideState(d.BlankSlideState.EndOfShow),r.metrics.endOfShow=!0,r.fSucceeded=!0);case 47:e.next=70;break;case 49:w=this.m_currentSlideLocation.slideIndex+1;case 50:if(!(w<this.m_slideIdOrder.length)){e.next=69;break}return e.next=53,this.isHidden(w);case 53:if(P=e.sent,I=P.isHidden,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.isHiddenResult=P),void 0!==I){e.next=59;break}return r.errorName=P.hasOwnProperty("errorName")?P.errorName:d.SlideShowErrorCode.IsHiddenFailed,e.abrupt("return",r);case 59:if(I){e.next=66;break}return o[b.ActionType.CheckHidden].end=y.SessionUtils.performanceNowTrimmed(),e.next=63,this.gotoSlide({slideIndex:w},{actionContext:{navigationType:d.NavigationType.Next,navMetrics:o},navInitTimestamp:i});case 63:return k=e.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.gotoSlideResult=k,r.fSucceeded=k.fSucceeded,r.errorName=k.errorName?k.errorName:k.error),e.abrupt("return",r);case 66:w+=1,e.next=50;break;case 69:this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||(this.setBlankSlideState(d.BlankSlideState.EndOfShow),r.metrics.endOfShow=!0,r.fSucceeded=!0);case 70:e.next=82;break;case 72:if(!n){e.next=82;break}if(E=n.animTimeline.getTimelineStates(!1)){e.next=76;break}return e.abrupt("return",r);case 76:if(L=E.filter((function(e){return e.timelineId===g.AnimConstants.MainTimelineId}))[0],M=n.animTimeline.getEndTime(g.AnimConstants.MainTimelineId)){e.next=80;break}return e.abrupt("return",r);case 80:L.step=M.ClickNum+1,this.gotoAnimationState({timelineStates:[L]});case 82:return e.abrupt("return",r);case 83:case"end":return e.stop()}}),e,this)}))),function(e){return ye.apply(this,arguments)})},{key:"prevSlide",value:(ve=(0,s.default)(a.default.mark((function e(t){var r,i,n,o,s,l,c,u,h,f;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r={fSucceeded:!1}).metrics={},!(!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!1)||this.m_stateManager.state===d.SlideShowCoreState.Loading||this.isTransitioning&&this.cancelTransition())&&this.m_viewController){e.next=5;break}return x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.SlideShowCoreState=this.m_stateManager.state,r.metrics.isTransitioning=this.isTransitioning,r.metrics.returnEarly=!0),e.abrupt("return",r);case 5:if(x.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(i=Date.now()),!(A.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&this.m_zoomManager&&this.m_zoomManager.checkZoomGoBack(this.m_currentSlideLocation.slideId))){e.next=15;break}if(p.ULS.sendTraceTag(522311772,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::prevSlide - Zoom: different previous slide"),!(n=this.m_zoomManager.zoomGoBack(this.m_currentSlideLocation.slideId))){e.next=14;break}return e.next=12,this.gotoSlide({slideId:n},{actionContext:{navigationType:d.NavigationType.Prev},navInitTimestamp:i});case 12:o=e.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.gotoSlideResult=o,r.fSucceeded=o.fSucceeded,r.errorName=o.errorName?o.errorName:o.error);case 14:return e.abrupt("return",r);case 15:if(s=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId),t&&(!s||0!==s.animTimeline.getNumTimelineClicks(g.AnimConstants.MainTimelineId))){e.next=43;break}(l={})[b.ActionType.CheckHidden]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},c=this.m_currentSlideLocation.slideIndex-1;case 20:if(!(c>=0)){e.next=38;break}return e.next=23,this.isHidden(c);case 23:if(u=e.sent,h=u.isHidden,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.isHiddenResult=u),void 0!==h){e.next=29;break}return r.errorName=u.hasOwnProperty("errorName")?u.errorName:d.SlideShowErrorCode.IsHiddenFailed,e.abrupt("return",r);case 29:if(h){e.next=35;break}return e.next=32,this.gotoSlide({slideIndex:c},{actionContext:{navigationType:d.NavigationType.Prev,navMetrics:l},navInitTimestamp:i});case 32:return f=e.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&(r.metrics.gotoSlideResult=f,r.fSucceeded=f.fSucceeded,r.errorName=f.errorName?f.errorName:f.error),e.abrupt("break",38);case 35:c-=1,e.next=20;break;case 38:if(!x.ChangeGate.isChangeGateEnabled("FixForPreviousNavigationOnFirstSlide")){e.next=41;break}return r.fSucceeded=!0,e.abrupt("return",r);case 41:e.next=44;break;case 43:s&&(s.animTimeline.resetTimeline(g.AnimConstants.MainTimelineId),this.checkForAnimationStateChanges());case 44:return e.abrupt("return",r);case 45:case"end":return e.stop()}}),e,this)}))),function(e){return ve.apply(this,arguments)})},{key:"getFirstVisibleSlideIndex",value:(ge=(0,s.default)(a.default.mark((function e(){var t,r,i,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.ULS.sendTraceTag(556847951,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore - call getFirstVisibleSlideIndex"),(t={})[b.ActionType.CheckHidden]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},t.slideId=this.m_slideIdOrder[0],t.isHiddenResult={},r=0;case 6:if(!(r<this.m_slideIdOrder.length)){e.next=21;break}return e.next=9,this.isHidden(r);case 9:if(i=e.sent,n=i.isHidden,x.ChangeGate.isChangeGateEnabled("LoggingIsHiddenResult")&&(t.isHiddenResult[r]=i),void 0!==n){e.next=15;break}return t.errorName="invalidHiddenSlideInfo",e.abrupt("return",t);case 15:if(n){e.next=18;break}return t.slideId=this.m_slideIdOrder[r],e.abrupt("break",21);case 18:r+=1,e.next=6;break;case 21:return t[b.ActionType.CheckHidden].end=y.SessionUtils.performanceNowTrimmed(),e.abrupt("return",t);case 23:case"end":return e.stop()}}),e,this)}))),function(){return ge.apply(this,arguments)})},{key:"getLastVisibleSlideIndex",value:(pe=(0,s.default)(a.default.mark((function e(){var t,r,i,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t={})[b.ActionType.CheckHidden]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},t.slideId=this.m_slideIdOrder[this.m_slideIdOrder.length-1],r=this.m_slideIdOrder.length-1;case 4:if(!(r>=0)){e.next=18;break}return e.next=7,this.isHidden(r);case 7:if(i=e.sent,void 0!==(n=i.isHidden)){e.next=12;break}return t.errorName="invalidHiddenSlideInfo",e.abrupt("return",t);case 12:if(n){e.next=15;break}return t.slideId=this.m_slideIdOrder[r],e.abrupt("break",18);case 15:r-=1,e.next=4;break;case 18:return t[b.ActionType.CheckHidden].end=y.SessionUtils.performanceNowTrimmed(),e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this)}))),function(){return pe.apply(this,arguments)})},{key:"gotoFirstSlideOptions",value:(me=(0,s.default)(a.default.mark((function e(t,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gotoFirstSlide(t,void 0,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return me.apply(this,arguments)})},{key:"gotoFirstSlide",value:(fe=(0,s.default)(a.default.mark((function t(r,i,n){var o,s,l,c,u,h,f;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=n&&n.actionContext||i||{}).navigationType||(o.navigationType=d.NavigationType.GoToFirst),s={slideIndex:0},l={},!r){t.next=18;break}return e.addStartEndToDict(l,"getFirstVisibleSlideResult",!0),t.next=8,this.getFirstVisibleSlideIndex();case 8:if(c=t.sent,e.addStartEndToDict(l,"getFirstVisibleSlideResult",!1),l.getFirstVisibleSlideResult=c,!c.hasOwnProperty("errorName")){t.next=16;break}return x.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&p.ULS.sendTraceTag(507909343,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::gotoFirstSlide - getFirstVisibleSlideResult return with error: ".concat(c.errorName,".")),u={fSucceeded:!1,error:c.errorName},x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(l.getFirstVisibleSlideError=c.errorName,u.metrics={getFirstVisibleSlideResult:l}),t.abrupt("return",u);case 16:o.navMetrics=c[b.ActionType.CheckHidden],s={slideId:c.slideId};case 18:if(!x.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")){t.next=25;break}return f=n&&n.fClearNavigationState,t.next=22,this.gotoSlide(s,{actionContext:o,fSkipTransition:!0,fClearNavigationState:f});case 22:h=t.sent,t.next=28;break;case 25:return t.next=27,this.gotoSlide(s,{actionContext:o,fSkipTransition:!0});case 27:h=t.sent;case 28:return x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(h.metrics?h.metrics.getFirstVisibleSlideResult=l:h.metrics={getFirstVisibleSlideResult:l}),t.abrupt("return",h);case 30:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return fe.apply(this,arguments)})},{key:"gotoLastSlide",value:(he=(0,s.default)(a.default.mark((function e(t){var r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={slideIndex:this.m_slideIdOrder.length-1},!t){e.next=8;break}return e.next=4,this.getLastVisibleSlideIndex();case 4:if(!(i=e.sent).hasOwnProperty("errorName")){e.next=7;break}return e.abrupt("return");case 7:r={slideId:i.slideId};case 8:return e.next=10,this.gotoSlide(r,{actionContext:{navigationType:d.NavigationType.GoToLast},fSkipTransition:!0});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return he.apply(this,arguments)})},{key:"getSlideCount",value:function(){return this.m_slideIdOrder.length}},{key:"refreshViewControllerSSC",value:(de=(0,s.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.m_viewController&&this.setTransitionState(!1);case 1:case"end":return e.stop()}}),e,this)}))),function(){return de.apply(this,arguments)})},{key:"clearNavigationState",value:function(){this.m_viewController&&this.m_viewController.clearNavigationState(),this.setBlankSlideState(d.BlankSlideState.Black);var e=A.Settings.readBooleanOrDefault("preventRenderingOldSlide",!1);this.m_viewController&&this.m_currentSlideLocation&&!e&&this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.m_zoomManager&&x.ChangeGate.isChangeGateEnabled("FixSummaryZoomNavigation")&&this.m_zoomManager.clear()}},{key:"invalidateProviderCacheBySlideID",value:(ue=(0,s.default)(a.default.mark((function e(t,r){var i,n,o,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return i={},n=this.addCommonResourceMetadata(i),o=JSON.parse(r),s={sid:o.Sid,cid:o.Cid},e.next=7,t.invalidateSlideAsync(s,n);case 7:return e.abrupt("return",e.sent);case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return ue.apply(this,arguments)})},{key:"updateResourceProviders",value:(ce=(0,s.default)(a.default.mark((function e(t,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_updateResourceProvidersThrottler.callAsync(t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return ce.apply(this,arguments)})},{key:"updateResourceProvidersAsyncImplAsync",value:(le=(0,s.default)(a.default.mark((function t(r,i){var n,o,s,l,c,u,f,m,g,v,_,S,T,w;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={},e.addStartEndToDict(n,"updateResourceProviders",!0),o=i&&i.switchToSvg,i&&i.shouldResetProviders&&r.resetProviders(),i&&i.isCacheRetentionEnabled&&i.updateSlideShowCoreAfterLaunch||this.m_stateManager.setState(d.SlideShowCoreState.Loading),this.m_providers=r,this.m_viewDataManager=new h.ViewDataManager(this.addClientSizeToLoader(r.slideViewData),this.addClientSizeToLoader(r.shapeViewData),r.localizedString),A.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new I.ZoomManager(this.m_viewDataManager)),e.addStartEndToDict(n,"getPresInfo",!0),s=(0,C.v4)(),l={slideLocation:A.Settings.readBooleanOrDefault("enableFetchSlideInfoForCurrentSlide",!1)&&i&&i.startSlideIndex?{slideIndex:i.startSlideIndex}:this.m_currentSlideLocation?this.m_currentSlideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!1,isPresInfoFromClient:i&&i.isPresInfoFromClient},c=o?b.ActionType.ChangeRenderingModeToSVG:b.ActionType.UpdateResourceProviders,!A.Settings.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)){t.next=20;break}return this.m_presInfoPromise=this.getPresInfoItem(s,c,l),t.next=16,this.m_presInfoPromise;case 16:u=t.sent,this.m_presInfoPromise=void 0,t.next=23;break;case 20:return t.next=22,this.getPresInfoItem(s,c,l);case 22:u=t.sent;case 23:if(e.addStartEndToDict(n,"getPresInfo",!1),A.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)&&this.m_stateManager.setState(d.SlideShowCoreState.Normal),u&&u.resource){t.next=30;break}return p.ULS.sendTraceTag(591734980,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::updateResourceProviders - getPresInfo. correlation:".concat(s,", errorName:").concat(u.metadata.errorName,", actionType:").concat(c)),this.handleErrors(u.metadata,{errorAction:o?X.InitPresInfo:X.UpdateResourceProvidersPresInfo}),x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(n.getPresInfoError=u.metadata.errorName),t.abrupt("return",{fSucceeded:!1,metrics:n});case 30:if(!o){t.next=37;break}return e.addStartEndToDict(n,"switchToSvg",!0),this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new h.ViewController(this.m_container,new h.Vector2(u.resource.SlideEmuWidth,u.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid),t.next=36,this.m_viewController.init();case 36:e.addStartEndToDict(n,"switchToSvg",!1);case 37:if(!this.m_viewController){t.next=63;break}if(void 0!==(f=this.m_sessionSettings.slideShowCoreSettings.translateLanguage)&&this.m_viewController.updateAccessibilityLanguage(f),!i||!i.shouldRerenderSlide||i.fSetBlankSlideToBlack||!this.m_currentSlideLocation){t.next=52;break}return e.addStartEndToDict(n,"ensureSlideView",!0),m=(0,C.v4)(),t.next=45,this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,m,b.ActionType.UpdateResourceProviders,!1);case 45:g=t.sent,e.addStartEndToDict(n,"ensureSlideView",!1),p.ULS.sendTraceTag(541180367,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::updateResourceProviders - ensureSlideViewElement. Correlation:".concat(m,", ErrorName:").concat(g&&g.hasOwnProperty("errorName")?g.errorName:"")),e.addStartEndToDict(n,"renderSlide",!0),v=this.m_viewController.renderSlideByIdCollectingPerfData(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),e.addStartEndToDict(n,"renderSlide",!1),v&&v.hasOwnProperty("errorName")&&p.ULS.sendTraceTag(541180368,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::updateResourceProviders - renderSlide return with error:".concat(v.errorName,", sid:").concat(v.hasOwnProperty("sid")?v.sid:""));case 52:return i&&i.fSetBlankSlideToBlack&&this.setBlankSlideState(d.BlankSlideState.Black),e.addStartEndToDict(n,"updateViewDataManager",!0),_=(0,C.v4)(),S=this.addCommonResourceMetadata({meta_correlationId:_,fSkipRendering:i&&i.fSetBlankSlideToBlack}),t.next=58,this.m_viewController.updateViewDataManager(this.m_viewDataManager,this.m_opticalZoomStateInfo.currentState,S);case 58:T=t.sent,e.addStartEndToDict(n,"updateViewDataManager",!1),p.ULS.sendTraceTag(591734981,p.LogCategory.msoulscat_Wac_PptSlideshow,T.hasOwnProperty("errorName")?p.TraceLevel.Error:p.TraceLevel.Info,"SlideShowCore::updateResourceProviders - updateViewDataManager. Correlation:".concat(_,", errorName:").concat(T.errorName,", sid:").concat(T.hasOwnProperty("sid")?T.sid:"")),this.handleErrors(T,{errorAction:X.UpdateViewDataManager}),T.hasOwnProperty("errorName")||(y.SessionUtils.getSessionStats("downloadFileFailed")?y.SessionUtils.recordSessionStats({downloadFileFailed:"UpdateResourceProvidersSucceeded"}):y.SessionUtils.recordSessionStats({resourceProvidersUpdated:!0}));case 63:return A.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)||this.m_stateManager.setState(d.SlideShowCoreState.Normal),e.addStartEndToDict(n,"triggerPrefetch",!0),!this.m_currentSlideLocation||i&&i.skipPrefetchSlides||(this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+2},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-2},!0)),e.addStartEndToDict(n,"triggerPrefetch",!1),e.addStartEndToDict(n,"initMedia",!0),this.m_viewController&&this.m_currentSlideLocation&&(w=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId))&&w.initMediaAfterSlideContentChanged(),e.addStartEndToDict(n,"initMedia",!1),e.addStartEndToDict(n,"updateResourceProviders",!1),t.abrupt("return",{fSucceeded:!0,metrics:n});case 72:case"end":return t.stop()}}),t,this)}))),function(e,t){return le.apply(this,arguments)})},{key:"setBlankSlideState",value:function(e){this.setBlankSlideStateInternal(e)}},{key:"setBlankSlideStateInternal",value:function(t,r){if(this.m_blankSlideState!==t&&this.m_viewController&&this.m_currentSlideLocation){switch(this.cancelTransition(),t){case d.BlankSlideState.Black:if(this.m_blankSlideState===d.BlankSlideState.EndOfShow)return;this.m_viewController.renderBlankSlide("black");break;case d.BlankSlideState.White:if(this.m_blankSlideState===d.BlankSlideState.EndOfShow)return;this.m_viewController.renderBlankSlide("white");break;case d.BlankSlideState.EndOfShow:if(!this.m_sessionSettings.slideShowCoreSettings.endOfShowText)return;this.setOpticalZoomState({currentState:e.s_defaultOpticalZoomState,metadata:{source:d.OpticalZoomSource.EndOfShow}}),this.m_viewController.renderBlankSlide("black",this.m_sessionSettings.slideShowCoreSettings.endOfShowText,"white"),this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer();break;default:p.ULS.sendTraceTag(575776402,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::setBlankSlideState - Rendering SlideId: ".concat(this.m_currentSlideLocation.slideId)),r&&r.fSkipRenderSlide&&t===d.BlankSlideState.Hidden&&A.Settings.readBooleanOrDefault("allowSkipRenderInSetBlankSlideState",!1)||this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState)}var i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&(t===d.BlankSlideState.Hidden?i.animClock.resume():i.animClock.pause()),this.m_blankSlideState=t,this.events.emit("blankSlideStateChanged",t)}}},{key:"showLoadingSpinner",value:function(){this.m_viewController&&this.m_stateManager&&(p.ULS.sendTraceTag(508923985,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::showLoadingSpinner"),this.m_stateManager.setState(d.SlideShowCoreState.Loading))}},{key:"hideLoadingSpinner",value:function(){this.m_viewController&&this.m_stateManager&&this.m_stateManager.setState(d.SlideShowCoreState.Normal)}},{key:"prefetchOnPodSessionRefresh",value:(se=(0,s.default)(a.default.mark((function e(){var t,r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!A.Settings.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){e.next=10;break}return e.next=3,this.getFirstVisibleSlideIndex();case 3:if(!(t=e.sent).hasOwnProperty("errorName")){e.next=7;break}return x.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&p.ULS.sendTraceTag(507909342,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::prefetchOnPodSessionRefresh - getFirstVisibleSlideResult return with error: ".concat(t.errorName,".")),e.abrupt("return");case 7:r=this.resolvePartialSlideLocation({slideId:t.slideId}),i=r||{slideIndex:0},this.events.emit("prefetchOnRefreshPodSession",i);case 10:case"end":return e.stop()}}),e,this)}))),function(){return se.apply(this,arguments)})},{key:"handleBlankSlideNavigation",value:function(e){return this.m_blankSlideState===d.BlankSlideState.EndOfShow&&(e?this.events.emit("exitFromEndOfShow"):this.setBlankSlideState(d.BlankSlideState.Hidden),!0)}},{key:"gotoAnimationState",value:function(e,t){if(!this.m_currentSlideLocation||!this.m_viewController||this.m_stateManager.state===d.SlideShowCoreState.Loading)return!1;this.setBlankSlideState(d.BlankSlideState.Hidden);var r=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return!!r&&(r.animTimeline.setTimelineStates(e.timelineStates),null!=e.startTimeOffset&&r.animClock.start(e.startTimeOffset),this.checkForAnimationStateChanges(t),!0)}},{key:"getAnimationState",value:function(e){if(!this.m_currentSlideLocation||!this.m_viewController)return{timelineStates:[]};var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!t)return{timelineStates:[]};var r=t.animTimeline.getTimelineStates(e)||[];return e?{timelineStates:r,startTimeOffset:t.animClock.currentTimeMs}:{timelineStates:r}}},{key:"nextStep",value:(oe=(0,s.default)(a.default.mark((function t(r,i){var n,o,s,l,c,u;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=y.SessionUtils.performanceNowTrimmed(),o=(0,C.v4)(),p.ULS.sendTraceTag(576979915,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::nextStep: CurrentSlideLocation:".concat(JSON.stringify(this.m_currentSlideLocation),",\n       timelineId:").concat(r,"; source: ").concat(i,", correlationId: ").concat(o)),s=this.handleBlankSlideNavigation(!0),!(!this.m_currentSlideLocation||!this.m_viewController||s||this.isTransitioning&&this.cancelTransition()||this.m_stateManager.state===d.SlideShowCoreState.Loading)){t.next=8;break}return p.ULS.sendTraceTag(576979916,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::nextStep returns early. m_viewController:".concat(!!this.m_viewController,", \n          this.m_currentSlideLocation:").concat(!!this.m_currentSlideLocation,",\n          this.handleBlankSlideNavigation:").concat(s,",\n          this.m_stateManager.state:").concat(this.m_stateManager.state,", \n          this.isTransitioning:").concat(this.isTransitioning,",\n          correlationId: ").concat(o)),this.m_currentSlideLocation&&this.m_viewController||this.raiseSlideShowNavErrorEvent(this.m_currentSlideLocation?d.SlideShowErrorCode.ViewControllerUndefined:d.SlideShowErrorCode.CurrentSlideLocationUndefined,d.NavigationType.Next),t.abrupt("return");case 8:if(l=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId)){t.next=20;break}if(c={},!A.Settings.readBooleanOrDefault("ensureSlideOnSVEUndefined",!1)){t.next=16;break}return t.next=14,this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,o,b.ActionType.Goto,!1);case 14:c=t.sent,l=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);case 16:if(l){t.next=20;break}return p.ULS.sendTraceTag(507127107,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::nextStep returns as slideViewElement is undefined with correlationId: ".concat(o,", ensureSlideResult: ").concat(JSON.stringify(c))),this.raiseSlideShowNavErrorEvent(d.SlideShowErrorCode.SlideViewElementUndefined,d.NavigationType.Next),t.abrupt("return");case 20:if(r!==g.AnimConstants.MainTimelineId||!l.animTimeline.hasTimelineFinished(r)||i===d.SlideshowActionSource.Mouse&&!l.fOnMouseClickAdvance){t.next=27;break}return t.next=23,this.nextSlide(e.c_preferFullyBuilt);case 23:u=t.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&!u.fSucceeded&&(u.metrics&&(u.metrics.startTime=n,u.metrics.endTime=y.SessionUtils.performanceNowTrimmed(),u.metrics.correlationId=o,u.metrics.fromIndex=this.m_currentSlideLocation.slideIndex),p.ULS.sendTraceTag(507127106,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,JSON.stringify(u.metrics?u.metrics:{})),this.raiseSlideShowNavErrorEvent(u.errorName?u.errorName:d.SlideShowErrorCode.Unknown,d.NavigationType.Next)),t.next=28;break;case 27:r!==g.AnimConstants.MainTimelineId&&l.animTimeline.hasTimelineFinished(r)?(l.animTimeline.resetTimeline(r),l.animTimeline.addTimelineClick(r),this.checkForAnimationStateChanges(),i!==d.SlideshowActionSource.AutoAdvance&&this.events.emit("stopAutoAdvance"),this.logAnimationNavClicks(n,d.NavigationType.Next,o)):(l.animTimeline.addTimelineClick(r),this.checkForAnimationStateChanges(),i!==d.SlideshowActionSource.AutoAdvance&&this.events.emit("stopAutoAdvance"),this.logAnimationNavClicks(n,d.NavigationType.Next,o));case 28:case"end":return t.stop()}}),t,this)}))),function(e,t){return oe.apply(this,arguments)})},{key:"prevStep",value:(ae=(0,s.default)(a.default.mark((function t(r,i){var n,o,s,l,c,u;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=y.SessionUtils.performanceNowTrimmed(),o=(0,C.v4)(),p.ULS.sendTraceTag(576979917,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::prevStep: CurrentSlideLocation:".concat(JSON.stringify(this.m_currentSlideLocation),",\n       timelineId:").concat(r,"; source: ").concat(void 0!==i?i:"None",", correlationId: ").concat(o)),s=this.handleBlankSlideNavigation(!1),!(!this.m_currentSlideLocation||!this.m_viewController||s||this.isTransitioning&&this.cancelTransition()||this.m_stateManager.state===d.SlideShowCoreState.Loading)){t.next=8;break}return p.ULS.sendTraceTag(576979918,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::prevStep returns early. m_viewController:".concat(!!this.m_viewController,", \n          this.m_currentSlideLocation:").concat(!!this.m_currentSlideLocation,",\n          this.handleBlankSlideNavigation:").concat(s,",\n          this.m_stateManager.state:").concat(this.m_stateManager.state,", \n          this.isTransitioning:").concat(this.isTransitioning,",\n          correlationId: ").concat(o)),this.m_currentSlideLocation&&this.m_viewController||this.raiseSlideShowNavErrorEvent(this.m_currentSlideLocation?d.SlideShowErrorCode.ViewControllerUndefined:d.SlideShowErrorCode.CurrentSlideLocationUndefined,d.NavigationType.Prev),t.abrupt("return");case 8:if(l=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId)){t.next=20;break}if(c={},!A.Settings.readBooleanOrDefault("ensureSlideOnSVEUndefined",!1)){t.next=16;break}return t.next=14,this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,o,b.ActionType.Goto,!1);case 14:c=t.sent,l=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);case 16:if(l){t.next=20;break}return p.ULS.sendTraceTag(507127075,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::prevStep returns as slideViewElement is undefined with correlationId: ".concat(o,", ensureSlideResult: ").concat(JSON.stringify(c))),this.raiseSlideShowNavErrorEvent(d.SlideShowErrorCode.SlideViewElementUndefined,d.NavigationType.Prev),t.abrupt("return");case 20:if(r!==g.AnimConstants.MainTimelineId||0!==l.animTimeline.getNumTimelineClicks(r)){t.next=27;break}return t.next=23,this.prevSlide(e.c_preferFullyBuilt);case 23:u=t.sent,x.ChangeGate.isChangeGateEnabled("AddNavigationLog")&&!u.fSucceeded&&(u.metrics&&(u.metrics.startTime=n,u.metrics.endTime=y.SessionUtils.performanceNowTrimmed(),u.metrics.correlationId=o,u.metrics.fromIndex=this.m_currentSlideLocation.slideIndex),p.ULS.sendTraceTag(507127074,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,JSON.stringify(u.metrics?u.metrics:{})),this.raiseSlideShowNavErrorEvent(u.errorName?u.errorName:d.SlideShowErrorCode.Unknown,d.NavigationType.Prev)),t.next=30;break;case 27:l.animTimeline.removeTimelineClick(r),this.checkForAnimationStateChanges(),this.logAnimationNavClicks(n,d.NavigationType.Prev,o);case 30:case"end":return t.stop()}}),t,this)}))),function(e,t){return ae.apply(this,arguments)})},{key:"raiseSlideShowNavErrorEvent",value:function(e,t){if(x.ChangeGate.isChangeGateEnabled("RaiseSSNavErrorEvent")){var r={errorCode:e,navigationType:t};this.events.emit("slideshowNavigationError",r)}}},{key:"logAnimationNavClicks",value:function(e,t,r){x.ChangeGate.isChangeGateEnabled("LogSSAnimationNavClicks")&&p.ULS.sendTraceTag(506994954,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::logAnimationNavClicks startTime: ".concat(e,", endTime: ").concat(y.SessionUtils.performanceNowTrimmed(),", navType: ").concat(t,", correlationId: ").concat(r))}},{key:"playMedia",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,h.MediaEventType.MediaPlayed)}}},{key:"pauseMedia",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,h.MediaEventType.MediaPaused)}}},{key:"seekMedia",value:function(e,t){if(this.m_viewController&&this.m_currentSlideLocation){var r=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);r&&r.updateMediaViewElement(e,h.MediaEventType.MediaSeeked,t)}}},{key:"getMediaNamesBySlideIndex",value:function(e){if(this.m_viewController&&!(this.m_slideIdOrder.length<=e)){var t=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[e]);if(t)return t.getMediaNamesOnSlide()}}},{key:"isMediaPresentInSlide",value:(ne=(0,s.default)(a.default.mark((function e(t){var r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_viewController&&!(this.m_slideIdOrder.length<=t)){e.next=2;break}return e.abrupt("return");case 2:if(r=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[t])){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,r.isMediaPresentInSlideAsync();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return ne.apply(this,arguments)})},{key:"getMediaInfo",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return t?t.getMediaInfo(e):void 0}}},{key:"updateMediaState",value:function(e,t){var r="Blocking - ".concat(this.m_viewController?"m_currentSlideLocation":"m_viewController"," undefined");if(this.m_viewController&&this.m_currentSlideLocation){var i=void 0!==t?t.slideId:this.m_currentSlideLocation.slideId,n=this.m_viewController.getSlideViewElement(i);if(r=n?"Passing to SlideViewElement":"Blocking - SlideViewElement undefined",n)return F.MediaAddon.updateMediaSyncMetadataAndLog(r,"SlideShowCore",e),void n.updateMediaState(e)}F.MediaAddon.updateMediaSyncMetadataAndLog(r,"SlideShowCore",e)}},{key:"setAddinSyncState",value:function(e){this.m_appForOfficeManager?this.m_appForOfficeManager.updateAddinSyncState(e):p.ULS.sendTraceTag(520426954,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,"SlideShowCore::setAddinSyncState: recieving addin sync state before AppForOfficeManager initialized.")}},{key:"setVideoPlayButtonVisibility",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateVideoPlayButtonVisibility(e)}}},{key:"setMediaCommandScope",value:function(e){this.m_viewController&&(this.m_viewController.mediaCommandScope=e)}},{key:"restoreFocus",value:function(){this.m_container.focus()}},{key:"getCurrentSlideDimensions",value:function(){return this.m_viewController?this.m_viewController.getSlideDimensions():void 0}},{key:"getCurrentSlideViewBounds",value:function(){return this.m_viewController?this.m_viewController.getSlideViewBounds():void 0}},{key:"prefetchSlide",value:(ie=(0,s.default)(a.default.mark((function e(t){var r,i,n,o,s,l,c,u,d,h=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>1&&void 0!==h[1]&&h[1],i=h.length>2?h[2]:void 0,(n=this.resolvePartialSlideLocation(t))&&this.m_viewController){e.next=5;break}return e.abrupt("return");case 5:return o=(0,C.v4)(),(s={})[b.ActionType.Prefetch]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},e.next=10,this.ensureSlideViewElementAsync(n.slideId,!1,o,b.ActionType.Prefetch,!1);case 10:if(l=e.sent,this.handleErrors(l,{errorAction:X.PrefetchEnsureSlide}),c=i&&i.source?i.source:"unknown",x.ChangeGate.isChangeGateEnabled("TelemetryForPrefetchFailure")&&l.hasOwnProperty("errorName")&&p.ULS.sendTraceTag(507779139,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::prefetchSlide - ensureSlideResult return with error: ".concat(l.errorName," at SlideLocation:").concat(n," during prefetch at:").concat(c,".")),u={},!r||this.isHiddenFromHiddenList(n.slideIndex)||l.hasOwnProperty("errorName")){e.next=24;break}return s[b.ActionType.Prerender]={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},e.next=19,this.m_viewController.ensureTextureLoaded(n.slideId,{isPrefetch:!0});case 19:return u=e.sent,d=this.resolvePartialSlideLocation({slideIndex:n.slideIndex-1}),e.next=23,this.m_viewController.preRenderSlideById(n.slideId,d?d.slideId:void 0);case 23:s[b.ActionType.Prerender].end=y.SessionUtils.performanceNowTrimmed();case 24:return this.emitIfCameoDetected(n.slideIndex),e.next=27,this.emitIfMediaDetected(n.slideIndex);case 27:s[b.ActionType.Prefetch].end=y.SessionUtils.performanceNowTrimmed(),x.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,b.ActionType.Prefetch,j(j(j({sid:n.slideId.sid,correlationId:o,sr:A.Settings.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source},l),u),s)):b.NavigationLogger.recordNavData(this.m_viewController.viewDataManager,b.ActionType.Prefetch,j(j(j({sr:A.Settings.readBooleanOrDefault("EnableSourceAppType",!1)?this.m_appType:this.m_source,sid:n.slideId.sid,correlationId:o},l),u),s));case 29:case"end":return e.stop()}}),e,this)}))),function(e){return ie.apply(this,arguments)})},{key:"getSlideShowTimings",value:(ee=(0,s.default)(a.default.mark((function e(t){var r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.addCommonResourceMetadata({meta_correlationId:(0,C.v4)()}),e.next=3,this.m_providers.slide.load(JSON.stringify(t.slideId),r);case 3:return i=e.sent.resource,e.abrupt("return",i?i.ssTimes:void 0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return ee.apply(this,arguments)})},{key:"getSlideTitle",value:(Q=(0,s.default)(a.default.mark((function e(){var t,r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.m_currentSlideLocation){e.next=10;break}return e.next=4,this.m_viewDataManager.getSlideViewData(this.m_currentSlideLocation.slideId);case 4:if(!(r=e.sent).resource||!r.resource.accessibilityModelPromise){e.next=10;break}return e.next=8,r.resource.accessibilityModelPromise;case 8:i=e.sent,t=i.slideTitleString;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return Q.apply(this,arguments)})},{key:"isAnimating",get:function(){return this.m_isAnimating}},{key:"setIsAnimating",value:function(t){t!==this.m_isAnimating&&(this.m_isAnimating=t,this.m_viewController&&(this.m_viewController.isAnimating=this.m_isAnimating)),this.events.emit("animationStateChanging",{isAnimating:this.m_isAnimating,metadata:{isGpuHardwareDisabled:h.ViewController.s_gpuHardwareDisabled,rendererTech:h.ViewController.s_rendererTech,isBadGPU:h.ViewController.s_isBadGpu,isSvg:A.Settings.readBooleanOrDefault("forceSvg",!1),isGlyphCacheDisabled:h.ViewController.s_isGlyphCacheDisabled,scale:e.getScaleForAnimations(),hostExperience:this.m_sessionSettings.appSettings.hostExperience}})}},{key:"isCameoActive",get:function(){return this.m_isCameoActive},set:function(e){e!==this.m_isCameoActive&&(this.m_isCameoActive=e,e||(this.m_slideRefreshNeeded=!0))}},{key:"isMediaPlaying",value:function(){if(!this.m_viewController||!this.m_currentSlideLocation)return!1;var e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return null!==e&&e.isMediaPlayingOnSlideCanvas()}},{key:"setTransitionState",value:function(e,t){e!==this.m_isTransitioning&&(this.m_isTransitioning=e,this.m_viewController&&(this.m_viewController.isTransitioning=this.m_isTransitioning));var r=t||{};r.isGpuHardwareDisabled=h.ViewController.s_gpuHardwareDisabled,r.rendererTech=h.ViewController.s_rendererTech,r.isBadGPU=h.ViewController.s_isBadGpu,r.isGlyphCacheDisabled=h.ViewController.s_isGlyphCacheDisabled,r.isSvg=A.Settings.readBooleanOrDefault("forceSvg",!1),r.hostExperience=this.m_sessionSettings.appSettings.hostExperience,this.events.emit("slideLocationChanging",{isTransitioning:this.m_isTransitioning,metadata:r})}},{key:"isTransitioning",get:function(){return this.m_isTransitioning}},{key:"ensureSlideViewElementAsync",value:(K=(0,s.default)(a.default.mark((function e(t,r,i,n,o,s){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_ensureSlideViewElementThrottler.callAsync(t,r,i,n,o,n===b.ActionType.Prefetch,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i,n,a){return K.apply(this,arguments)})},{key:"registerMediaEventHandlers",value:function(e){var t=this;e.on("mediaPlayed",(function(e){t.events.emit("slideMediaEvent",e)})),e.on("mediaPaused",(function(e){t.events.emit("slideMediaEvent",e)})),e.on("mediaSeeked",(function(e){t.events.emit("slideMediaEvent",e)})),e.on("mediaVolumeChanged",(function(e){t.events.emit("slideMediaEvent",e)})),e.on("mediaEnded",(function(e){t.events.emit("slideMediaEvent",e)})),e.on("aadTokenRequest",(function(e){t.events.emit("aadTokenRequest",e)})),e.on("mediaInitState",(function(e){t.events.emit("mediaInitState",e)})),e.on("userMediaAction",(function(e){t.events.emit("userMediaAction",e)}))}},{key:"ensureSlideViewElementImplAsync",value:(q=(0,s.default)(a.default.mark((function t(r,i,n,o,l,c,u){var f,m,_,S,T,C,w,P,I,E,L,M,R,O,D,F,B,N,V,U,G=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.m_viewController){t.next=2;break}return t.abrupt("return",{});case 2:if(!(f=this.m_viewController.getSlideViewElement(r))||o===b.ActionType.UpdateResourceProviders){t.next=21;break}if(!i||f.fImageTextureLoaded){t.next=8;break}return t.next=7,this.m_viewController.ensureTextureLoaded(r,{isPrefetch:c});case 7:m=t.sent;case 8:if(_={slideId:r.sid,correlation:n},S=this.m_providers.slide,(T=S.getLoadResultInCache(JSON.stringify(r)))&&T.resource){t.next=15;break}return T&&T.metadata&&T.metadata.hasOwnProperty("errorName")&&(_.errorName=T.metadata.errorName),p.ULS.sendTraceTag(540587299,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(_)),t.abrupt("return",j(j({},_),m));case 15:return _[b.NavigationLogger.CachedInServer]=!(!T.hasOwnProperty("metadata")||!T.metadata.hasOwnProperty(b.NavigationLogger.CachedInServer))&&T.metadata[b.NavigationLogger.CachedInServer],_[b.NavigationLogger.RequestInfo]=T.hasOwnProperty("metadata")&&T.metadata.hasOwnProperty(b.NavigationLogger.RequestInfo)?T.metadata[b.NavigationLogger.RequestInfo]:void 0,_[b.NavigationLogger.GetItemsResult]=T.hasOwnProperty("metadata")&&T.metadata.hasOwnProperty(b.NavigationLogger.GetItemsResult)?T.metadata[b.NavigationLogger.GetItemsResult]:void 0,p.ULS.sendTraceTag(574919713,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::ensureSlideViewElement: slideViewElement exists, fLoadTexture:".concat(i,", fImageTextureLoaded:").concat(f.fImageTextureLoaded,".")),x.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&u&&u.additionalMetrics&&(u.additionalMetrics.isSlideCached=!0),t.abrupt("return",j(j({},_),m));case 21:return C={loadSlide:{start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},slideId:r.sid,correlation:n},w={meta_correlationId:n},o===b.ActionType.Prefetch&&A.Settings.readBooleanOrDefault("enableSequentialGetItems",!1)&&(w.meta_priorityHint=d.PriorityHint.Low),w.meta_requestInfo={ActionType:o},w.meta_isInit=l,P=this.addCommonResourceMetadata(w),x.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&u&&u.additionalMetrics&&(u.additionalMetrics.isSlideCached=this.m_providers.isSlideCached(JSON.stringify(r))),t.next=30,this.m_providers.slide.load(JSON.stringify(r),P);case 30:if(I=t.sent,C.loadSlide.end=y.SessionUtils.performanceNowTrimmed(),I&&I.resource){t.next=36;break}return I&&I.metadata&&I.metadata.hasOwnProperty("errorName")&&(C.errorName=I.metadata.errorName),p.ULS.sendTraceTag(593847576,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(C)),t.abrupt("return",C);case 36:return I.metadata.axErrorName&&(C.axError=I.metadata.axErrorName),C[b.NavigationLogger.CachedInServer]=!(!I.hasOwnProperty("metadata")||!I.metadata.hasOwnProperty(b.NavigationLogger.CachedInServer))&&I.metadata[b.NavigationLogger.CachedInServer],C[b.NavigationLogger.RequestInfo]=I.hasOwnProperty("metadata")&&I.metadata.hasOwnProperty(b.NavigationLogger.RequestInfo)?I.metadata[b.NavigationLogger.RequestInfo]:void 0,C[b.NavigationLogger.GetItemsResult]=I.hasOwnProperty("metadata")&&I.metadata.hasOwnProperty(b.NavigationLogger.GetItemsResult)?I.metadata[b.NavigationLogger.GetItemsResult]:void 0,C.loadSlideViewData={start:y.SessionUtils.performanceNowTrimmed(),end:y.SessionUtils.performanceNowTrimmed()},t.next=43,this.m_viewDataManager.getSlideViewData(I.resource.id);case 43:if((E=t.sent).resource){t.next=48;break}return E.metadata.hasOwnProperty("errorName")&&(C.errorName=E.metadata.errorName),p.ULS.sendTraceTag(589910426,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(C)),t.abrupt("return",j(j({},C),E));case 48:if((L=E.resource)&&L.transData&&this.m_transitionResourceLoader.load(L.transData.type),C.loadSlideViewData.end=y.SessionUtils.performanceNowTrimmed(),M={},!A.Settings.readBooleanOrDefault("enableUpdateSlideResources",!0)){t.next=56;break}return t.next=55,this.updateSlideResources(I.resource,n,l);case 55:M=t.sent;case 56:if(!x.ChangeGate.isChangeGateEnabled("SSC.logMissingImages")||!L){t.next=68;break}if(!((R=e.filterToResourceEntriesWithMissingImages(L.resCat))&&R.length>0)){t.next=68;break}O=new Set,D=z(R);try{for(D.s();!(F=D.n()).done;)!(B=F.value).id.includes(".")&&B.name.lastIndexOf(".")>0&&B.name.substring(B.name.lastIndexOf(".")).length<6&&B.name.substring(B.name.lastIndexOf(".")),O.add(B.id)}catch(e){D.e(e)}finally{D.f()}if(N=Array.from(O),C.imagesMissingFromServer=N,p.ULS.sendTraceTag(507388675,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,"SlideShowCore::ensureSlideViewElement ImagesMissingFromServer:".concat(JSON.stringify(N))),A.Settings.readBooleanOrDefault("missingImagesVetoEnabled",!1)&&v.VetoUtils.recordVeto("ImagesMissingFromServer",{missingImages:N}),!A.Settings.readBooleanOrDefault("missingImagesReturnEarlyEnabled",!1)){t.next=68;break}return t.abrupt("return",j(j({},C),M));case 68:if(!(f=this.m_viewController.getSlideViewElement(I.resource.id))||o===b.ActionType.UpdateResourceProviders){t.next=75;break}if(!i&&f.fImageTextureLoaded){t.next=74;break}return t.next=73,this.m_viewController.ensureTextureLoaded(I.resource.id,{isPrefetch:c});case 73:m=t.sent;case 74:return t.abrupt("return",j(j(j({},C),M),m));case 75:return t.next=77,this.m_viewController.ensureSlideViewElement(I.resource);case 77:if(!(V=t.sent).hasOwnProperty("errorName")){t.next=82;break}return C.errorName=V.metadata.errorName,p.ULS.sendTraceTag(589910427,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Warning,JSON.stringify(C)),t.abrupt("return",j(j(j({},C),M),V));case 82:if(!i){t.next=86;break}return t.next=85,this.m_viewController.ensureTextureLoaded(I.resource.id,{isPrefetch:c});case 85:m=t.sent;case 86:return f=this.m_viewController.getSlideViewElement(I.resource.id),U=0,f&&(f.animClock.events.on("tick",function(){var t=(0,s.default)(a.default.mark((function t(r){var i,n,o,s,l,c,u,d,m,g;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f&&G.m_viewController&&G.m_currentSlideLocation&&G.m_currentSlideLocation.slideId.sid===f.slideId.sid){t.next=2;break}return t.abrupt("return");case 2:if(i=performance.now(),A.Settings.readBooleanOrDefault("hackLogAnimationFrameTime",!1)&&console.log("Time between Frames: ".concat(i-U)),n=G.isAnimating,o=f.animTimeline.setTimeAndCalculate(r),s=f.fHasContinuouslyAnimatedContent&&G.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,l=A.Settings.readBooleanOrDefault("useIsMediaPlaying",!0)&&G.isMediaPlaying(),!x.ChangeGate.isChangeGateEnabled("SSC.CameoSlidePresenceCheck")){t.next=17;break}if(t.t1=G.isCameoActive,!t.t1){t.next=14;break}return t.next=13,G.isCameoDetectedOnCurrentSlideAsync();case 13:t.t1=t.sent;case 14:t.t0=t.t1,t.next=18;break;case 17:t.t0=G.isCameoActive;case 18:c=t.t0,(u=A.Settings.readBooleanOrDefault("lowResAnimsEnabled",!1))||G.setIsAnimating(o),((u?n:o)||s||c||l||G.m_slideRefreshNeeded||G.m_zoomAnimationController.isZooming&&!A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1))&&(d=1,u&&(d=o?e.getScaleForAnimations():1,G.m_viewController.resizeViewContainer(G.m_opticalZoomStateInfo.currentState,f.slideSizePixels,{canvasScale:d})),(A.Settings.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||A.Settings.readBooleanOrDefault("enableCameoInT2",!1))&&c&&G.m_viewController.updateCameoTextureFromVideoElement(),G.m_viewController.renderSlideAnimationFrameById(G.m_currentSlideLocation.slideId,G.m_opticalZoomStateInfo.currentState),G.events.emit("animatedContentStateChanged",{hasContinuouslyAnimatedContent:s||c||l,metadata:{isGpuHardwareDisabled:h.ViewController.s_gpuHardwareDisabled,rendererTech:h.ViewController.s_rendererTech,isBadGPU:h.ViewController.s_isBadGpu,isGlyphCacheDisabled:h.ViewController.s_isGlyphCacheDisabled,isSvg:A.Settings.readBooleanOrDefault("forceSvg",!1),scale:d,hostExperience:G.m_sessionSettings.appSettings.hostExperience}}),A.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)?W.ActionToRenderLogger.recordRender():G.m_slideRefreshNeeded&&G.m_opticalZoomRenderPerfStartTime&&(m=performance.now(),p.ULS.sendTraceTag(512278924,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"Optical Zoom time from zoom invocation to render: ".concat(m-G.m_opticalZoomRenderPerfStartTime,"ms")),G.m_opticalZoomRenderPerfStartTime=void 0),G.m_slideRefreshNeeded=!1),u&&G.setIsAnimating(o),A.Settings.readBooleanOrDefault("hackLogAnimationFrameTime",!1)&&(g=performance.now(),console.log("Frame Duration: ".concat(g-i)),U=g);case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),f.animClock.events.on("notRunning",(function(){G.setIsAnimating(!1)})),f.events.on("clickTarget-interactiveAnimation",(function(e){G.nextStep(e,d.SlideshowActionSource.Mouse)})),f.events.on("mediaAnimation-nextStep",(function(){G.nextStep(g.AnimConstants.MainTimelineId,d.SlideshowActionSource.API)})),f.events.on("clickTarget-gotoSlide",(function(e){G.gotoSlide({slideId:e},{actionContext:{navigationType:d.NavigationType.ClickTarget}}).then((function(e){x.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&p.ULS.sendTraceTag(507064862,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,JSON.stringify(e.metrics))}))})),f.events.on("clickTarget-gotoZoomSlide",(function(e){G.m_currentSlideLocation&&e.slideId&&G.m_zoomManager&&G.m_zoomManager.addSlide(e.slideId,G.m_currentSlideLocation.slideId,e.returnToParent),G.gotoSlide({slideId:e.slideId},{actionContext:{navigationType:d.NavigationType.ClickTarget}}).then((function(e){x.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&p.ULS.sendTraceTag(507064861,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,JSON.stringify(e.metrics))}))})),f.events.on("clickTarget-gotoZoomSection",(function(e){if(G.m_currentSlideLocation&&e.sectionId&&G.m_zoomManager){var t=(0,k.getFirstSlideIdFromSection)(e.sectionId,G.m_viewDataManager.sections);G.m_zoomManager.addSection(e.sectionId,G.m_currentSlideLocation.slideId,e.returnToParent),t&&G.gotoSlide({slideId:t},{actionContext:{navigationType:d.NavigationType.ClickTarget}}).then((function(e){x.ChangeGate.isChangeGateEnabled("ClickTargetGotoSlideTelemetry")&&!e.fSucceeded&&p.ULS.sendTraceTag(507064860,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Error,JSON.stringify(e.metrics))}))}})),this.registerMediaEventHandlers(f.events)),t.abrupt("return",j(j({},C),m));case 90:case"end":return t.stop()}}),t,this)}))),function(e,t,r,i,n,a,o){return q.apply(this,arguments)})},{key:"onNavigatingFrom",value:function(e){if(this.m_viewController){var t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.pause(),t.events.emit("navigatingFrom"))}}},{key:"onNavigatedTo",value:function(e){if(this.m_viewController){var t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.resume(),t.events.emit("navigatedTo"))}}},{key:"onNavigatedFrom",value:function(e){if(this.m_viewController){var t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatedFrom")}}},{key:"onNavigatingTo",value:function(e){if(this.m_viewController){var t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatingTo")}}},{key:"onBeforeFirstRenderAfterNavigation",value:function(e){if(this.m_viewController){var t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("beforeFirstRenderAfterNavigation")}}},{key:"resolvePartialSlideLocation",value:function(e){var t=this.m_slideIdOrder.map((function(e,t){return{slideId:e,index:t}}));if(void 0!==e.slideId){if((t=t.filter((function(t){return t.slideId.cid===e.slideId.cid&&t.slideId.sid===e.slideId.sid}))).length>1&&void 0!==e.slideIndex){var r=t.filter((function(t){return t.index===e.slideIndex}));0!==r.length&&(t=r)}}else void 0!==e.slideIndex&&(t=t.filter((function(t){return t.index===e.slideIndex})));if(0!==t.length&&(void 0!==e.slideId||void 0!==e.slideIndex))return{slideId:t[0].slideId,slideIndex:t[0].index}}},{key:"checkForAnimationStateChanges",value:function(e){if(!this.m_currentSlideLocation||!this.m_viewController)return!1;var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!t)return!1;var r=t.animTimeline.getTimelineStates(!1);return JSON.stringify(this.m_currentTimelineStates)!==JSON.stringify(r)&&(this.m_currentTimelineStates=r,this.events.emit("animationStateChanged",e?{actionContext:e}:void 0)),!0}},{key:"getTransitionController",value:function(){return this.m_viewController?this.m_viewController.getTransitionController():null}},{key:"cancelTransition",value:function(){if(this.isTransitioning){var e=this.getTransitionController();return e&&e.clock.stop(),!0}return!1}},{key:"pauseTransition",value:function(){if(this.isTransitioning){var e=this.getTransitionController();return e&&e.clock.pause(),!0}return!1}},{key:"resumeTransition",value:function(){if(!this.isTransitioning){var e=this.getTransitionController();return e&&e.clock.resume(),!0}return!1}},{key:"isCameoDetectedOnCurrentSlideAsync",value:(H=(0,s.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_currentSlideLocation){e.next=2;break}return e.abrupt("return",!1);case 2:return t=this.m_currentSlideLocation.slideIndex,e.next=5,this.isCameoDetectedAtSlideIndexAsync(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"recordSessionStats",value:function(e){y.SessionUtils.recordSessionStats(e)}},{key:"setMaxSceneCount",value:function(e,t){this.m_viewController&&this.m_viewController.setMaxSceneCount(e,t)}},{key:"setAadToken",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(t)return void t.setAadToken(e)}x.ChangeGate.isChangeGateEnabled("SSC.Stream2AadToken")&&U.SlideViewElement.setStream2AadToken(e)}},{key:"setFrameTrustStatus",value:function(e){this.m_appForOfficeManager&&this.m_appForOfficeManager.setFrameTrustStatus(e)}},{key:"isCameoDetectedAtSlideIndexAsync",value:(m=(0,s.default)(a.default.mark((function e(t){var r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!this.m_viewController||t<0||t>=this.m_slideIdOrder.length)){e.next=2;break}return e.abrupt("return",!1);case 2:if(r=this.m_slideIdOrder[t]){e.next=5;break}return e.abrupt("return",!1);case 5:if(t in this.m_cameoPresenceCache){e.next=12;break}if(i=this.m_viewController.getSlideViewElement(r)){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,i.isCameoPresentInSlideAsync();case 11:this.m_cameoPresenceCache[t]=e.sent;case 12:return e.abrupt("return",this.m_cameoPresenceCache[t]);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"isCameoDetectedNearbyAsync",value:(o=(0,s.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_currentSlideLocation){e.next=2;break}return e.abrupt("return",!1);case 2:return t=this.m_currentSlideLocation.slideIndex,e.next=5,this.isCameoDetectedAtSlideIndexAsync(t);case 5:if(e.t1=e.sent,e.t1){e.next=10;break}return e.next=9,this.isCameoDetectedAtSlideIndexAsync(t-1);case 9:e.t1=e.sent;case 10:if(e.t0=e.t1,e.t0){e.next=15;break}return e.next=14,this.isCameoDetectedAtSlideIndexAsync(t+1);case 14:e.t0=e.sent;case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"emitIfCameoDetected",value:function(e){var t=this;this.isCameoDetectedAtSlideIndexAsync(e).then((function(e){!t.m_cameoDetectedInPresentation&&e&&(t.m_cameoDetectedInPresentation=!0,p.ULS.sendTraceTag(541180369,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::emitIfCameoDetected - Cameo detected in Presentation"),t.events.emit("cameoDetectedInPresentation",{cameoDetected:!0}))}))}},{key:"getCameoInfoFromActiveSlide",value:function(){if(this.m_viewController&&this.m_currentSlideLocation){var e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(e){var t=e.getCameoInfoInSlide();return p.ULS.sendTraceTag(541180370,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::getCameoInfoFromActiveSlide - Cameo details - ".concat(JSON.stringify(t)," in slide ").concat(JSON.stringify(this.m_currentSlideLocation),"}")),t}}}},{key:"setCameoVideoElement",value:function(e){this.m_viewController&&this.m_viewController.setCameoVideoElement(e)}},{key:"videoFrameToPptForCameo",value:function(e,t){this.m_viewController&&this.m_viewController.sendFrameToCameo(e,t)}},{key:"clearCameo",value:function(){this.m_viewController&&this.m_viewController.clearCameo()}},{key:"emitIfMediaDetected",value:(i=(0,s.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.m_fMediaDetectedInPresentation){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.isMediaPresentInSlide(t);case 4:e.sent&&(this.m_fMediaDetectedInPresentation=!0,p.ULS.sendTraceTag(509641879,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::emitIfMediaDetected - Media detected in Presentation"),this.events.emit("mediaDetectedInPresentation"));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getContentInfoFromActiveSlide",value:function(){if(!this.m_viewController||!this.m_currentSlideLocation)return{};var e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return e?e.slideContentTelemetry:{}}},{key:"getMediaCurrentState",value:function(e){if(this.m_viewController&&this.m_currentSlideLocation){var t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(null!==t)return t.getMediaCurrentState(e)}}},{key:"isHandlingResourceInconsistent",get:function(){return this.m_isHandlingResourceInconsistent},set:function(e){this.m_isHandlingResourceInconsistent=e}},{key:"setGlobalMute",value:function(e){this.m_viewController&&this.m_viewController.updateGlobalMute(e)}},{key:"opticalZoomStateInfo",get:function(){return this.m_opticalZoomStateInfo}},{key:"getGlobalMute",value:function(){return this.m_viewController?this.m_viewController.isGlobalMute:void 0}},{key:"setOpticalZoomState",value:function(e,t){var r=A.Settings.readNumberOrDefault("minimumZoom",1),i=A.Settings.readNumberOrDefault("maximumZoom",2);if(!(e.currentState.canvasCenterSlidePointPercent.x<0||e.currentState.canvasCenterSlidePointPercent.x>1||e.currentState.canvasCenterSlidePointPercent.y<0||e.currentState.canvasCenterSlidePointPercent.y>1)){var n=Math.min(i,Math.max(r,e.currentState.zoomLevel)),a=n===this.m_opticalZoomStateInfo.currentState.zoomLevel,o=e.currentState.canvasCenterSlidePointPercent.x===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.x&&e.currentState.canvasCenterSlidePointPercent.y===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.y,s=Y(this.m_opticalZoomStateInfo.animationData,e.animationData);if(A.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&!a&&(n>r?(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"):this.m_container.style.cursor="auto"),A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)){if(a&&o&&s)return}else if(a&&o)return;A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)&&t&&t.fEndZoomAnimation&&this.m_zoomAnimationController.finishZoomAnimation(),this.m_opticalZoomStateInfo.currentState={zoomLevel:n,canvasCenterSlidePointPercent:e.currentState.canvasCenterSlidePointPercent},A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)&&(this.m_opticalZoomStateInfo.animationData=e.animationData,this.m_slideRefreshNeeded=!0),this.events.emit("opticalZoomStateChanged",e)}}},{key:"zoomToAsync",value:(t=(0,s.default)(a.default.mark((function e(t,r,i){var n,o,s,l,c,u,f,m,g,v,y,_,S,T;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.m_blankSlideState!==d.BlankSlideState.Hidden||this.m_isTransitioning||this.m_zoomAnimationController.isZooming,this.enableOpticalZoom&&this.m_viewController&&this.m_currentSlideLocation&&!n){e.next=3;break}return e.abrupt("return");case 3:if(o=A.Settings.readNumberOrDefault("maximumZoom",2),s=A.Settings.readNumberOrDefault("minimumZoom",1),!((l=this.m_opticalZoomStateInfo.currentState.zoomLevel)<=s&&t<=l||l>=o&&t>=l||t===l)){e.next=8;break}return e.abrupt("return");case 8:if(A.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&i&&!i.fAnimate&&i.source?W.ActionToRenderLogger.recordInput(i.source):i&&i.source&&(i.source===d.OpticalZoomSource.KeyboardPlus||i.source===d.OpticalZoomSource.KeyboardMinus||i.source===d.OpticalZoomSource.UIPlus||i.source===d.OpticalZoomSource.UIMinus)&&(this.m_opticalZoomRenderPerfStartTime=performance.now()),c=Math.max(s,Math.min(o,t)),u=this.m_viewController.getBounds.getBoundingClientRectFromCanvas(),f=this.m_viewController.getBounds.getClientSizeFromCanvas(),m=r?new h.Vector2(r.x-u.left,r.y-u.top):f.scale(.5),!(A.Settings.readBooleanOrDefault("enableOpticalZoomAnimation",!1)&&i&&i.fAnimate)){e.next=26;break}if(g=!0,x.ChangeGate.isChangeGateEnabled("SSC.ZoomOutBasedOnOSSetting")&&(v=window.matchMedia("(prefers-reduced-motion: no-preference)"),g=v.matches||A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)),!g){e.next=26;break}if(y=i.fAnimationDurationInMs&&i.fAnimationDurationInMs>0?i.fAnimationDurationInMs:A.Settings.readNumberOrDefault("zoomAnimationDurationMs",250),A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)){e.next=23;break}return e.next=21,this.m_zoomAnimationController.animateZoomAsync(c,y,this.m_viewController,m,i?i.source:void 0);case 21:return this.m_slideRefreshNeeded=!0,e.abrupt("return");case 23:return e.next=25,this.m_zoomAnimationController.animateZoomWithAnimationProgressEventsAsync(c,y,this.m_viewController,{canvasZoomPositionInPixels:m,source:i?i.source:void 0});case 25:return e.abrupt("return");case 26:if(_=this.m_viewController.calculateCanvasCenterSlidePointPercentAfterZoom(m,c,this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState)){e.next=29;break}return e.abrupt("return");case 29:(isNaN(_.x)||isNaN(_.y))&&(_=new h.Vector2(.5,.5),p.ULS.sendTraceTag(520978769,p.LogCategory.msoulscat_Wac_PptSlideshow,p.TraceLevel.Info,"SlideShowCore::zoomToAsync - Defaulting canvasCenterSlidePointPercent due to NaN")),S={currentState:{zoomLevel:c,canvasCenterSlidePointPercent:_},metadata:i&&i.source?{source:i.source}:void 0},this.setOpticalZoomState(S),A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),A.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!A.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&(T={width:u.width*c,height:u.height*c,zoomPositionX:m.x,zoomPositionY:m.y,containerSizeChanged:!1},this.events.emit("updateCanvasZoom",T));case 34:case"end":return e.stop()}}),e,this)}))),function(e,r,i){return t.apply(this,arguments)})},{key:"panByAmount",value:function(e,t){var r=this.m_blankSlideState!==d.BlankSlideState.Hidden||this.m_isTransitioning||this.m_zoomAnimationController.isZooming;if(this.enableOpticalZoom&&this.m_viewController&&this.m_currentSlideLocation&&!r&&(!x.ChangeGate.isChangeGateEnabled("SSC.PreventPanIfZoomAtMinimum")||this.m_opticalZoomStateInfo.currentState.zoomLevel!==A.Settings.readNumberOrDefault("minimumZoom",1))){var i=this.m_viewController.calculateCanvasCenterPointPercentAfterPan(new h.Vector2(e.x,e.y),this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);if(i){var n=this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent;if(n.x!==i.x||n.y!==i.y){A.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&t&&t.source&&W.ActionToRenderLogger.recordInput(t.source);var a={zoomLevel:this.m_opticalZoomStateInfo.currentState.zoomLevel,canvasCenterSlidePointPercent:i};this.setOpticalZoomState({currentState:a,metadata:t&&t.source?{source:t.source}:void 0}),A.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),A.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!A.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&this.events.emit("updateCanvasPan",{x:e.x,y:e.y})}}}}}],[{key:"copyWithoutMetrics",value:function(e){if(e)return e.metrics,(0,n.default)(e,G)}},{key:"filterToResourceEntriesWithMissingImages",value:function(e){return x.ChangeGate.isChangeGateEnabled("SSC.IgnoreMissingImagesFromGif")?e.filter((function(e){return""===e.url&&!e.name.startsWith("./getmedia.ashx")&&!e.name.endsWith(".gif")})):e.filter((function(e){return""===e.url&&!e.name.startsWith("./getmedia.ashx")}))}},{key:"updateResourceProvidersQueueHandler",value:function(e){return{nextArg:e.map((function(e){return e.args})).reduce((function(e,t){var r=[];r[0]=t[0];var i=e[1],n=t[1];return r[1]={shouldResetProviders:n&&n.shouldResetProviders,shouldRerenderSlide:i&&i.shouldRerenderSlide||n&&n.shouldRerenderSlide,switchToSvg:i&&i.switchToSvg||n&&n.switchToSvg},r})),handledRequests:e,remainingRequests:[]}}},{key:"addStartEndToDict",value:function(e,t,r){x.ChangeGate.isChangeGateEnabled("TelemetryForSSLayerCake")&&(r?e[t]={start:y.SessionUtils.performanceNowTrimmed()}:e[t].end=y.SessionUtils.performanceNowTrimmed())}},{key:"preloadShaders",value:function(e){var t;if(e&&e.shapeBuilderCanvasContext&&(t=e.shapeBuilderCanvasContext.gl),!t){var r=document.createElement("canvas");t=A.Settings.readBooleanOrDefault("webgl2Enabled",!1)&&r.getContext("webgl2")||r.getContext("webgl")||r.getContext("experimental-webgl")}return!!t&&(h.ViewController.preloadShaders(t,e),!0)}},{key:"getScaleForAnimations",value:function(){var e=A.Settings.readNumberOrDefault("maxDprForAnimations",1);return A.Settings.readBooleanOrDefault("lowResAnimsEnabled",!1)&&window.devicePixelRatio>e?e/window.devicePixelRatio:1}}]);var t,i,o,m,H,q,K,Q,ee,ie,ne,ae,oe,se,le,ce,ue,de,he,fe,me,pe,ge,ve,ye,_e,Se,Te,be,Ce,we,Pe,Ie,ke,Ee}();t.SlideShowCore=ie,ie.c_preferFullyBuilt=!0,ie.s_defaultOpticalZoomState={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(119);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(406);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(183);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(184);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var s=r(413);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}));var l=r(94);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})}));var c=r(414);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}))},function(e,t,r){"use strict";(function(e,i){var n=r(0)(r(15)),a="[object Arguments]",o="[object Map]",s="[object Object]",l="[object Set]",c=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[a]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[o]=d["[object Number]"]=d[s]=d["[object RegExp]"]=d[l]=d["[object String]"]=d["[object WeakMap]"]=!1;var h="object"==(void 0===e?"undefined":(0,n.default)(e))&&e&&e.Object===Object&&e,f="object"==("undefined"==typeof self?"undefined":(0,n.default)(self))&&self&&self.Object===Object&&self,m=h||f||Function("return this")(),p="object"==(0,n.default)(t)&&t&&!t.nodeType&&t,g=p&&"object"==(0,n.default)(i)&&i&&!i.nodeType&&i,v=g&&g.exports===p,y=v&&h.process,_=function(){try{return y&&y.binding&&y.binding("util")}catch(e){}}(),S=_&&_.isTypedArray;function T(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function b(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}function C(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var w,P,I,k=Array.prototype,E=Function.prototype,x=Object.prototype,L=m["__core-js_shared__"],A=E.toString,M=x.hasOwnProperty,R=(w=/[^.]+$/.exec(L&&L.keys&&L.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",O=x.toString,D=RegExp("^"+A.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=v?m.Buffer:void 0,B=m.Symbol,N=m.Uint8Array,V=x.propertyIsEnumerable,U=k.splice,W=B?B.toStringTag:void 0,G=Object.getOwnPropertySymbols,H=F?F.isBuffer:void 0,j=(P=Object.keys,I=Object,function(e){return P(I(e))}),z=ge(m,"DataView"),q=ge(m,"Map"),Z=ge(m,"Promise"),X=ge(m,"Set"),Y=ge(m,"WeakMap"),J=ge(Object,"create"),K=Se(z),Q=Se(q),$=Se(Z),ee=Se(X),te=Se(Y),re=B?B.prototype:void 0,ie=re?re.valueOf:void 0;function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ae(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function se(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new oe;++t<r;)this.add(e[t])}function le(e){var t=this.__data__=new ae(e);this.size=t.size}function ce(e,t){for(var r=e.length;r--;)if(Te(e[r][0],t))return r;return-1}function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":W&&W in Object(e)?function(e){var t=M.call(e,W),r=e[W];try{e[W]=void 0;var i=!0}catch(e){}var n=O.call(e);return i&&(t?e[W]=r:delete e[W]),n}(e):function(e){return O.call(e)}(e)}function de(e){return Ee(e)&&ue(e)==a}function he(e,t,r,i,n){return e===t||(null==e||null==t||!Ee(e)&&!Ee(t)?e!=e&&t!=t:function(e,t,r,i,n,c){var u=Ce(e),d=Ce(t),h=u?"[object Array]":ye(e),f=d?"[object Array]":ye(t),m=(h=h==a?s:h)==s,p=(f=f==a?s:f)==s,g=h==f;if(g&&we(e)){if(!we(t))return!1;u=!0,m=!1}if(g&&!m)return c||(c=new le),u||xe(e)?fe(e,t,r,i,n,c):function(e,t,r,i,n,a,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new N(e),new N(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Te(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case o:var c=b;case l:var u=1&i;if(c||(c=C),e.size!=t.size&&!u)return!1;var d=s.get(e);if(d)return d==t;i|=2,s.set(e,t);var h=fe(c(e),c(t),i,n,a,s);return s.delete(e),h;case"[object Symbol]":if(ie)return ie.call(e)==ie.call(t)}return!1}(e,t,h,r,i,n,c);if(!(1&r)){var v=m&&M.call(e,"__wrapped__"),y=p&&M.call(t,"__wrapped__");if(v||y){var _=v?e.value():e,S=y?t.value():t;return c||(c=new le),n(_,S,r,i,c)}}return!!g&&(c||(c=new le),function(e,t,r,i,n,a){var o=1&r,s=me(e),l=s.length;if(l!=me(t).length&&!o)return!1;for(var c=l;c--;){var u=s[c];if(!(o?u in t:M.call(t,u)))return!1}var d=a.get(e);if(d&&a.get(t))return d==t;var h=!0;a.set(e,t),a.set(t,e);for(var f=o;++c<l;){var m=e[u=s[c]],p=t[u];if(i)var g=o?i(p,m,u,t,e,a):i(m,p,u,e,t,a);if(!(void 0===g?m===p||n(m,p,r,i,a):g)){h=!1;break}f||(f="constructor"==u)}if(h&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(h=!1)}return a.delete(e),a.delete(t),h}(e,t,r,i,n,c))}(e,t,r,i,he,n))}function fe(e,t,r,i,n,a){var o=1&r,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var u=-1,d=!0,h=2&r?new se:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var f=e[u],m=t[u];if(i)var p=o?i(m,f,u,t,e,a):i(f,m,u,e,t,a);if(void 0!==p){if(p)continue;d=!1;break}if(h){if(!T(t,(function(e,t){if(o=t,!h.has(o)&&(f===e||n(f,e,r,i,a)))return h.push(t);var o}))){d=!1;break}}else if(f!==m&&!n(f,m,r,i,a)){d=!1;break}}return a.delete(e),a.delete(t),d}function me(e){return function(e,t,r){var i=t(e);return Ce(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,Le,ve)}function pe(e,t){var r,i,a=e.__data__;return r=t,("string"==(i=(0,n.default)(r))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?a["string"==typeof t?"string":"hash"]:a.map}function ge(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ke(e)||function(e){return!!R&&R in e}(e))&&(Pe(e)?D:c).test(Se(e))}(r)?r:void 0}ne.prototype.clear=function(){this.__data__=J?J(null):{},this.size=0},ne.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ne.prototype.get=function(e){var t=this.__data__;if(J){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return M.call(t,e)?t[e]:void 0},ne.prototype.has=function(e){var t=this.__data__;return J?void 0!==t[e]:M.call(t,e)},ne.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=J&&void 0===t?"__lodash_hash_undefined__":t,this},ae.prototype.clear=function(){this.__data__=[],this.size=0},ae.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0||(r==t.length-1?t.pop():U.call(t,r,1),--this.size,0))},ae.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},ae.prototype.has=function(e){return ce(this.__data__,e)>-1},ae.prototype.set=function(e,t){var r=this.__data__,i=ce(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},oe.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(q||ae),string:new ne}},oe.prototype.delete=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t},oe.prototype.get=function(e){return pe(this,e).get(e)},oe.prototype.has=function(e){return pe(this,e).has(e)},oe.prototype.set=function(e,t){var r=pe(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},se.prototype.add=se.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},se.prototype.has=function(e){return this.__data__.has(e)},le.prototype.clear=function(){this.__data__=new ae,this.size=0},le.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},le.prototype.get=function(e){return this.__data__.get(e)},le.prototype.has=function(e){return this.__data__.has(e)},le.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ae){var i=r.__data__;if(!q||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new oe(i)}return r.set(e,t),this.size=r.size,this};var ve=G?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,a=[];++r<i;){var o=e[r];t(o)&&(a[n++]=o)}return a}(G(e),(function(t){return V.call(e,t)})))}:function(){return[]},ye=ue;function _e(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}function Se(e){if(null!=e){try{return A.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Te(e,t){return e===t||e!=e&&t!=t}(z&&"[object DataView]"!=ye(new z(new ArrayBuffer(1)))||q&&ye(new q)!=o||Z&&"[object Promise]"!=ye(Z.resolve())||X&&ye(new X)!=l||Y&&"[object WeakMap]"!=ye(new Y))&&(ye=function(e){var t=ue(e),r=t==s?e.constructor:void 0,i=r?Se(r):"";if(i)switch(i){case K:return"[object DataView]";case Q:return o;case $:return"[object Promise]";case ee:return l;case te:return"[object WeakMap]"}return t});var be=de(function(){return arguments}())?de:function(e){return Ee(e)&&M.call(e,"callee")&&!V.call(e,"callee")},Ce=Array.isArray,we=H||function(){return!1};function Pe(e){if(!ke(e))return!1;var t=ue(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ie(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function ke(e){var t=(0,n.default)(e);return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==(0,n.default)(e)}var xe=S?function(e){return function(t){return e(t)}}(S):function(e){return Ee(e)&&Ie(e.length)&&!!d[ue(e)]};function Le(e){return null!=(t=e)&&Ie(t.length)&&!Pe(t)?function(e,t){var r=Ce(e),i=!r&&be(e),n=!r&&!i&&we(e),a=!r&&!i&&!n&&xe(e),o=r||i||n||a,s=o?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=s.length;for(var c in e)!t&&!M.call(e,c)||o&&("length"==c||n&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_e(c,l))||s.push(c);return s}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||x))return j(e);var t,r,i=[];for(var n in Object(e))M.call(e,n)&&"constructor"!=n&&i.push(n);return i}(e);var t}i.exports=function(e,t){return he(e,t)}}).call(this,r(57),r(99)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideViewElement=void 0;var n=i(r(6)),a=i(r(18)),o=i(r(5)),s=i(r(7)),l=i(r(1)),c=i(r(2)),u=r(25),d=r(275),h=r(3),f=r(20),m=r(52),p=r(26),g=r(35),v=r(298),y=r(299),_=r(49),S=r(355),T=r(42),b=r(4),C=r(356),w=r(90),P=r(54);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var L=function(){function e(t,r,i){(0,l.default)(this,e),this.shapeViewElements=[],this.events=new p.EventEmitter,this.fImageTextureLoaded=!1,this.fImageTextureLoading=!1,this.fOnMouseClickAdvance=!0,this.fHasContinuouslyAnimatedContent=!1,this.fNeedsDummyClick=!1,this.isHidden=!1,this.fHasAddin=!1,this.slideContentTelemetry=[],this.m_animObjects=[],this.m_fPrepared=!1,this.m_timeoutMs=5,this.slideId=t.id,this.m_slide=t,this.animTimeline=new m.AnimTimeline,this.animClock=new m.AnimClock,this.m_environment=i,this.m_slideSizePixels=new f.Vector2(r.x,r.y),this.isHidden=t.hidden,this.m_slide.ssTimes&&(this.fOnMouseClickAdvance=this.m_slide.ssTimes.manualAdv)}return(0,c.default)(e,[{key:"ensure",value:(L=(0,s.default)(n.default.mark((function t(r){var i,a,o,s,l,c,u,d;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={sid:this.slideId.sid,ensureSlideViewData:{start:g.ViewController.performanceNowTrimmed(),end:g.ViewController.performanceNowTrimmed()}},t.next=3,this.m_environment.viewDataManager.getSlideViewData(this.slideId,r?r.loadDataOptions:void 0);case 3:if(a=t.sent,i.ensureSlideViewData.end=g.ViewController.performanceNowTrimmed(),a.resource){t.next=9;break}return h.ULS.sendTraceTag(591927437,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Warning,"SlideViewElement::ensure: missing slideViewData. sid:".concat(this.slideId.sid,", correlation:").concat(r?r.loadDataOptions?r.loadDataOptions.meta_correlationId:"":void 0,", errorName:").concat(a.metadata.errorName)),a.metadata.hasOwnProperty("errorName")&&(i.errorName=a.metadata.errorName),t.abrupt("return",i);case 9:if(o=a.resource,this.m_slideSizePixels=new f.Vector2(o.slideSizePixels.x,o.slideSizePixels.y),s={},0!==this.shapeViewElements.length){t.next=22;break}if(!(o.fHasAddinShape&&o.fHasAddinShape&&this.m_environment.addinManager)||this.m_environment.addinManager.fOsfruntimeLoaded()){t.next=17;break}return t.next=16,this.m_environment.addinManager.loadOsfRuntime();case 16:i.loadOsfRuntime=t.sent;case 17:return t.next=19,this.init(o,r);case 19:s=t.sent,t.next=24;break;case 22:l=E(this.shapeViewElements);try{for(l.s();!(c=l.n()).done;)u=c.value,d=u.ensure(),e.processEnsureShapeResult(i,d,u.id.shapeId)}catch(e){l.e(e)}finally{l.f()}case 24:return t.abrupt("return",k(k({},i),s));case 25:case"end":return t.stop()}}),t,this)}))),function(e){return L.apply(this,arguments)})},{key:"init",value:(x=(0,s.default)(n.default.mark((function t(r,i){var o,s,l,c,u,p,_,T,P,I,k,x,L,A,M,R,O,D,F,B,N,V,U,W,G,H,j,z,q,Z,X,Y,J,K,Q;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s={initSlideVE_bg:{start:g.ViewController.performanceNowTrimmed(),end:g.ViewController.performanceNowTrimmed()}},l={slideId:this.slideId,shapeId:-1},c=this.m_slideSizePixels.x/this.m_environment.slideSizeEmus.x,p={shapeId:l,isBackground:!0,shapeBuilderData:{},animatableContents:[]},r.slideBackground&&r.slideBackground.solidFill?(_=r.slideBackground.solidFill.t/100,T=new f.Color(Math.floor(255*_+(1-_)*r.slideBackground.solidFill.r)/255,Math.floor(255*_+(1-_)*r.slideBackground.solidFill.g)/255,Math.floor(255*_+(1-_)*r.slideBackground.solidFill.b)/255,1),u=f.Shape.CreateRectangle(new f.Rect(0,0,this.m_slideSizePixels.x,this.m_slideSizePixels.y),new f.Style(new f.SolidBrush(T)))):r.slideBackground&&r.slideBackground.imageFill&&((P=new f.ImageContainer).id=r.slideBackground.imageFill.imgID,I=new f.ImageBrush(P),u=f.Shape.CreateRectangle(f.Rect.FromSize(new f.Vector2(this.m_slideSizePixels.x,this.m_slideSizePixels.y)),new f.Style(I))),u?((0,w.ensureClientData)(u).isBackground=!0,(k=new d.ShapeViewElement({id:p.shapeId},p,c,this.events,this.m_environment,{item:u})).ensure(),this.shapeViewElements.push(k)):h.ULS.sendTraceTag(559269019,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Error,"failed to create background"),s.initSlideVE_bg.end=g.ViewController.performanceNowTrimmed(),this.m_slide.spLst){t.next=9;break}return t.abrupt("return",s);case 9:return s.initSlideVE_shapeViewData={start:g.ViewController.performanceNowTrimmed(),end:g.ViewController.performanceNowTrimmed()},t.next=12,this.getShapeViewDataInSlideAsync();case 12:x=t.sent,s.initSlideVE_shapeViewData.end=g.ViewController.performanceNowTrimmed(),s.initSlideVE_ensureShapeVE={start:g.ViewController.performanceNowTrimmed(),end:g.ViewController.performanceNowTrimmed()},L={Media:0,Media_canvas:0,Gif:0,Addin:0,Cameo:0,Shape:0},A=0;case 17:if(!(A<this.m_slide.spLst.length)){t.next=26;break}if(M=x[A]){t.next=22;break}return h.ULS.sendTraceTag(595657629,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Error,"SlideViewElement::init: Invalid shapeViewData. Continue..."),t.abrupt("continue",23);case 22:M.media?(R=y.MediaViewElement.getMediaType(M.media),h.ULS.sendTraceTag(555792223,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Info,"SlideViewElement::init: MediaType:".concat(R,", glContext:").concat(this.m_environment.rendererEnvironment.glContext)),O=new y.MediaViewElement(this.m_slide.spLst[A],M,c,this.m_environment,this.m_slideSizePixels,this.events,!!i&&i.isPrefetch),D=O.ensure(),s.hasOwnProperty("metadata")?s.metadata.push(D):s.metadata=[D],e.processEnsureShapeResult(s,D,M.shapeId.shapeId),this.shapeViewElements.push(O),this.fHasContinuouslyAnimatedContent||b.Settings.readBooleanOrDefault("useIsMediaPlaying",!0)||(this.fHasContinuouslyAnimatedContent=O.shouldRenderToCanvas),O.shouldRenderToCanvas?L.Media_canvas+=1:L.Media+=1):M.gif&&this.m_environment.rendererEnvironment.supportsGif?(F=new S.GifViewElement(this.m_slide.spLst[A],M,c,this.events,this.m_environment,this.m_slideSizePixels),(B=F.ensure()).hasOwnProperty("mediaType")&&(s.hasOwnProperty("metadata")?s.metadata.includes(B.mediaType)||s.metadata.push(B.mediaType):s.metadata=[B.mediaType]),e.processEnsureShapeResult(s,B,M.shapeId.shapeId),this.shapeViewElements.push(F),this.fHasContinuouslyAnimatedContent=!0,L.Gif+=1):M.appForOffice?(N=new C.AddinViewElement(this.m_slide.spLst[A],M,c,this.m_environment),V=N.ensure(),e.processEnsureShapeResult(s,V,M.shapeId.shapeId),h.ULS.sendTraceTag(541673088,h.LogCategory.msoulscat_Wac_PptSlideshow,h.TraceLevel.Info,"initSlideVE::ensureAddinVE::".concat(JSON.stringify(V))),this.shapeViewElements.push(N),L.Addin+=1):M.cameo?(U=new v.CameoViewElement(this.m_slide.spLst[A],M,c,this.m_environment),W=U.ensure(),e.processEnsureShapeResult(s,W,M.shapeId.shapeId),this.shapeViewElements.push(U),L.Cameo+=1):(G=new d.ShapeViewElement(this.m_slide.spLst[A],M,c,this.events,this.m_environment),H=G.ensure(),e.processEnsureShapeResult(s,H,G.id.shapeId),this.shapeViewElements.push(G),L.Shape+=1);case 23:A+=1,t.next=17;break;case 26:s.initSlideVE_ensureShapeVE.end=g.ViewController.performanceNowTrimmed(),this.slideContentTelemetry.contentCounts=L,j=(o=[]).concat.apply(o,(0,a.default)(this.shapeViewElements.map((function(e){return e.animatableContentViewElements})))),b.Settings.readBooleanOrDefault("hackAnimationsEnabled",!0)||(this.m_slide.animSeqs=[{AnimationList:[],SequenceId:"0_anim"}]),z=new m.AnimTranslate(this.animTimeline).createAnimObjectListForSlide(this.m_slide.animSeqs,j,this.m_slideSizePixels),q=z.animObjectList,Z=z.needsDummyClick,this.fNeedsDummyClick=Z,this.m_animObjects=q,X=this.m_slide.animSeqs.map((function(e){return e.SequenceId})),Y=new Map,J=E(X);try{for(J.s();!(K=J.n()).done;)Q=K.value,Y.set(Q,{ClickNum:Z&&Q===m.AnimConstants.MainTimelineId?1:0,Offs:0})}catch(e){J.e(e)}finally{J.f()}return this.animTimeline.initTimeline(this.m_animObjects,X,Y,0),t.abrupt("return",s);case 39:case"end":return t.stop()}}),t,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"getShapeViewDataInSlideAsync",value:(I=(0,s.default)(n.default.mark((function e(){var t=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.m_slide.spLst.map((function(e){return t.m_environment.viewDataManager.getShapeViewData(t.m_slide.id,e.id)}))||[]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"slideSizePixels",get:function(){return this.m_slideSizePixels}},{key:"fPrepared",get:function(){return this.m_fPrepared},set:function(e){if(e!==this.m_fPrepared){this.m_fPrepared=e;var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;)t.value.fPrepared=this.m_fPrepared}catch(e){r.e(e)}finally{r.f()}}}},{key:"tryPrepare",value:function(){var e,t=E(this.shapeViewElements);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!r.fPrepared){try{r.tryPrepare(this.m_timeoutMs)?this.m_timeoutMs=5:this.m_timeoutMs=2*this.m_timeoutMs}catch(e){var i=e;e instanceof Error&&this.m_environment.stringifyError&&(i=this.m_environment.stringifyError(e)),h.ULS.sendTraceTag(592328460,h.LogCategory.msoulscat_Wac_PptSlideshow,h.TraceLevel.Error,"SlideViewElement::preRender Exception while in tryPrepare:".concat(i))}return!1}}}catch(e){t.e(e)}finally{t.f()}return this.m_fPrepared=!0,h.ULS.sendTraceTag(595634144,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Info,"SlideViewElement::preRender Done preRendering - slideId:".concat(this.slideId.sid)),!0}},{key:"tryPrepareAllAtOnce",value:function(e){var t,r=performance.now(),i=E(this.shapeViewElements);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=e-(performance.now()-r);if(!n.fPrepared)try{if(!n.tryPrepare(a))return!1}catch(e){var o=e;e instanceof Error&&this.m_environment.stringifyError&&(o=this.m_environment.stringifyError(e)),h.ULS.sendTraceTag(539767631,h.LogCategory.msoulscat_Wac_PptSlideshow,h.TraceLevel.Error,"SlideViewElement::preRender Exception while in tryPrepare:".concat(o))}}}catch(e){i.e(e)}finally{i.f()}return this.m_fPrepared=!0,!0}},{key:"updateAccessibilityTag",value:(o=(0,s.default)(n.default.mark((function t(r,i,a){var o,s,l,c,u,d,f,p,v;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.m_environment.viewDataManager.getSlideViewData(i);case 4:if(!(o=t.sent).resource||!o.resource.accessibilityModelPromise){t.next=23;break}return t.next=8,o.resource.accessibilityModelPromise;case 8:if(s=t.sent,l=this.animTimeline.getEndTime(m.AnimConstants.MainTimelineId),c=l?l.ClickNum:0,u=(u=this.animTimeline.getNumTimelineClicks(m.AnimConstants.MainTimelineId))>c?c:u,d=JSON.stringify({slideIndex:r,sldId:i,animationIndex:u}),e.s_lastAccessibilityTagHash!==d){t.next=16;break}return t.abrupt("return");case 16:return e.s_lastAccessibilityTagHash=d,t.next=19,this.updateAccessibilityLiveRegion(r,s,u,c);case 19:f=e.getLocalizedString(),s&&s.shapeAccessibilityDataList&&(s.shapeAccessibilityDataList.forEach((function(e){var t={slideId:e.slideId,shapeId:parseInt(e.shapeId?e.shapeId:"",10)},r=T.ShapeViewElementUtils.generateShapeLevelAccessibilityElementId(t),i=document.getElementById(r);i&&(i.appendChild(e.val),i.classList.add("show-accessibility-element"),i.style.display="")})),(p=T.ShapeViewElementUtils.ensureSlideTitleElement())&&(p.innerText=this.getSlideTitleElementStr(f.slideTitleElementStr,r,s.slideTitleString),p.classList.add("show-accessibility-element"),p.style.display="")),t.next=26;break;case 23:(v=document.getElementById(g.ViewController.AccessibilitySlideTitleId))&&(v.style.display="none"),h.ULS.sendTraceTag(591927438,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Error,"SlideViewElement::updateAccessibilityTag - missing slideViewData. sid:".concat(this.slideId.sid));case 26:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"updateAccessibilityLiveRegion",value:(i=(0,s.default)(n.default.mark((function t(r,i,a,o){var s,l,c,u,d,h,f,m,p,v;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e.getLocalizedString(),(l=document.getElementById(g.ViewController.AccessibilityLiveRegionContainerDivId))&&(""!==g.ViewController.accessibilityLanguage&&g.ViewController.appLanguage&&!g.ViewController.appLanguage.includes(g.ViewController.accessibilityLanguage)?l=this.addLangAttributeToLiveRegion(l):(""===g.ViewController.accessibilityLanguage||g.ViewController.appLanguage&&g.ViewController.appLanguage.includes(g.ViewController.accessibilityLanguage))&&l.removeAttribute("lang"),l.innerText=this.getSlideTitleElementStr(s.slideTitleElementStr,r,i.slideTitleString)),c=a,u=o,this.fNeedsDummyClick&&(c-=1,u-=1),c<=0?u>0&&(d=1===o?s.animTotalSingularStr:s.animTotalPluralStr)&&l&&(d=d.replace("{0}","".concat(u)),l.innerText=s.accessibilityLiveRegionAnimStepStr.replace("{0}","".concat(r+1)).replace("{1}",i.slideTitleString).replace("{2}",d)):(h=i.slideTitleString?s.slideNameWithTooltipStr:s.slideNameWithoutTooltipStr,f=s.slideStr,m=s.animNumStr,h&&m&&f&&(p=h.replace("{0}","".concat(f)).replace("{1}","".concat(r+1)).replace("{2}","".concat(i.slideTitleString)),v=m.replace("{0}","".concat(c)).replace("{1}","".concat(u)).replace("{2}","".concat(p)),l&&(l.innerText=v)));case 7:case"end":return t.stop()}}),t,this)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"addLangAttributeToLiveRegion",value:function(e){var t=document.createElement("div");t.id=g.ViewController.AccessibilityLiveRegionContainerDivId,t.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),t.setAttribute("role","alert"),t.setAttribute("lang",g.ViewController.accessibilityLanguage);var r=document.getElementsByClassName("slide-container-class");return r.length>0&&r[0]&&r[0].replaceChild(t,e),t}},{key:"getSlideTitleElementStr",value:function(e,t,r){return e.replace("{0}","".concat(t+1)).replace("{1}",r)}},{key:"updateShapeViewElements",value:function(){var e,t=this,r=E(this.shapeViewElements);try{for(r.s();!(e=r.n()).done;){var i=e.value;-1!==i.id.shapeId&&i.update()}}catch(e){r.e(e)}finally{r.f()}var n,a=E(this.m_animObjects);try{var o=function(){var e=n.value,r=e.Shape.shapeId,i=t.shapeViewElements.find((function(e){return e.id.shapeId===r.shapeId&&e.id.slideId.sid===r.slideId.sid}));if(i){var a=t.animTimeline.getEndTime(m.AnimConstants.MainTimelineId),o=a?a.ClickNum:0;i.applyAnimation(e,o)}};for(a.s();!(n=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}}},{key:"updateMediaViewElement",value:function(e,t,r){var i,n=E(this.shapeViewElements);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.shapeType===u.ShapeType.Media&&a.getMediaName()===e)switch(t){case u.MediaEventType.MediaPlayed:a.playMedia();break;case u.MediaEventType.MediaPaused:a.pauseMedia();break;case u.MediaEventType.MediaSeeked:a.seekMedia(r||0)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"updateMediaState",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.shapeType===u.ShapeType.Media&&i.getMediaName()===e.mediaName)return(0,_.updateMediaSyncMetadataAndLog)("Passing to MediaViewElement","SlideViewElement",e),void i.updateMediaState(e)}}catch(e){r.e(e)}finally{r.f()}(0,_.updateMediaSyncMetadataAndLog)("Blocking - MediaViewElement of media wasn't found","SlideViewElement",e)}},{key:"initMediaAfterSlideContentChanged",value:function(){var e,t=E(this.shapeViewElements);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.shapeType===u.ShapeType.Media&&r.initAfterSlideContentChanged()}}catch(e){t.e(e)}finally{t.f()}}},{key:"updateVideoPlayButtonVisibility",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.shapeType===u.ShapeType.Media&&i.updateVideoPlayButtonVisibility(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"setAadToken",value:function(e){_.StreamPlayerAuthMessagingContext.postAadTokenToStream(e)}},{key:"getMediaNamesOnSlide",value:function(){var e,t=[],r=E(this.shapeViewElements);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.shapeType===u.ShapeType.Media&&t.push(i.getMediaName())}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"isMediaPresentInSlideAsync",value:(r=(0,s.default)(n.default.mark((function e(){var t,r,i,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getShapeViewDataInSlideAsync();case 2:t=e.sent,r=E(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=12;break}if(!(a=i.value)||void 0===a.media){e.next=10;break}return e.abrupt("return",!0);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))),function(){return r.apply(this,arguments)})},{key:"getAllZoomsOnSlide",value:function(){var e,t=[],r=E(this.shapeViewElements);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.shapeType===u.ShapeType.Shape){var n,a=E(i.getAllZoomsOnShape());try{for(a.s();!(n=a.n()).done;){var o=n.value;t.push(o)}}catch(e){a.e(e)}finally{a.f()}}}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"isCameoPresentInSlideAsync",value:(t=(0,s.default)(n.default.mark((function e(){var t,r,i,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getShapeViewDataInSlideAsync();case 2:t=e.sent,r=E(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=12;break}if(!(a=i.value)||void 0===a.cameo){e.next=10;break}return e.abrupt("return",!0);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))),function(){return t.apply(this,arguments)})},{key:"getCameoInfoInSlide",value:function(){var e,t=[],r=E(this.shapeViewElements);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.shapeType===u.ShapeType.Cameo&&t.push(i.getCameoInfo())}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"addToScene",value:function(e){for(var t=0;t<this.shapeViewElements.length;t+=1)this.shapeViewElements[t].addToScene(e)}},{key:"removeFromScene",value:function(e){for(var t=0;t<this.shapeViewElements.length;t+=1)this.shapeViewElements[t].shapeType===u.ShapeType.Cameo&&this.shapeViewElements[t].removeFromScene(e)}},{key:"cleanUp",value:function(){for(var e=0;e<this.shapeViewElements.length;e+=1)this.shapeViewElements[e].cleanUp()}},{key:"getMediaCurrentState",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.shapeType===u.ShapeType.Media&&i.getMediaName()===e)return i.getMediaCurrentState()}}catch(e){r.e(e)}finally{r.f()}}},{key:"updateGlobalMute",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.shapeType===u.ShapeType.Media&&i.updateGlobalMute(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"onSlideScaled",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.shapeType===u.ShapeType.Media&&i.resizeToScale(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"muteAllPlayingMedia",value:function(){var e,t=E(this.shapeViewElements);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.shapeType===u.ShapeType.Media&&r.mutePlayingMedia()}}catch(e){t.e(e)}finally{t.f()}}},{key:"getMediaInfo",value:function(e){var t,r=E(this.shapeViewElements);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.shapeType===u.ShapeType.Media&&i.getMediaName()===e)return i.getMediaInfo()}}catch(e){r.e(e)}finally{r.f()}}},{key:"isMediaPlayingOnSlideCanvas",value:function(){var e,t=E(this.shapeViewElements);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.shapeType===u.ShapeType.Media&&r.shouldUpdateMediaOnCanvas())return!0}}catch(e){t.e(e)}finally{t.f()}return!1}}],[{key:"processEnsureShapeResult",value:function(e,t,r){var i;t.hasOwnProperty("missingTextureIds")&&(e.hasOwnProperty("missingTextureIds")||(e.missingTextureIds=[]),(i=e.missingTextureIds).push.apply(i,(0,a.default)(t.missingTextureIds))),t.hasOwnProperty("invalidShape")&&t.invalidShape&&(e.hasOwnProperty("invalidShapeIds")||(e.invalidShapeIds=[]),e.invalidShapeIds.push(r)),t.hasOwnProperty("showAppForOffice")&&t.showAppForOffice&&(e.hasOwnProperty("initSlideVE_ensureAddinVEs")||(e.initSlideVE_ensureAddinVEs=[]),e.initSlideVE_ensureAddinVEs.push(t.showAppForOffice))}},{key:"getLocalizedString",value:function(){return"undefined"!=typeof PowerpointSlideshowStrings?{slideTitleElementStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideIndexAndSlideTitle,animTotalSingularStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalSingular,animTotalPluralStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalPlural,accessibilityLiveRegionAnimStepStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelForLiveRegionAnimationStepReadout,slideNameWithTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithTooltip,slideNameWithoutTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithoutTooltip,slideStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideStr,animNumStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimationNumber}:{slideTitleElementStr:"Slide {0}:{1}. ",animTotalSingularStr:"Has 1 animation",animTotalPluralStr:"Has {0} animations",accessibilityLiveRegionAnimStepStr:"Slide {0}:{1}, {2}",slideNameWithTooltipStr:"{0} {1} - {2}",slideNameWithoutTooltipStr:"{0} {1}",slideStr:"Slide",animNumStr:"Animation {0} of {1} on {2}"}}},{key:"setStream2AadToken",value:function(e){P.OnlineVideoPlayer.setAADToken(e)}}]);var t,r,i,o,I,x,L}();t.SlideViewElement=L,L.s_lastAccessibilityTagHash=""},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getDebugStringTree=g,t.getDebugStringInfo=v,t.getTextDebugStringInfo=y,t.getDebugRaster=_,t.getDebugRasterShapePaths=S,t.countToString=T,t.brushToString=C,t.penLineEndToString=function(e){switch(e){case u.PenLineEnd.arrow:return">";case u.PenLineEnd.diamond:return"";case u.PenLineEnd.none:return"";case u.PenLineEnd.oval:return"";case u.PenLineEnd.stealth:return"";case u.PenLineEnd.triangle:return""}},t.penLineEndsToString=w,t.penLineEndWidthToString=P,t.penLineEndLengthToString=I,t.penEndToString=k,t.styleToString=E,t.effectsToString=x,t.vector2ToString=L,t.vector2ToStringWithArrow=A,t.matrix3ToString=function(e){return"[["+e.m[0]+", "+e.m[1]+", "+e.m[2]+"], ["+e.m[3]+", "+e.m[4]+", "+e.m[5]+"], ["+e.m[6]+", "+e.m[7]+", "+e.m[8]+"]]"},t.transformToMultiLine=function(e){var t=[];return 0==e.preTranslation.x&&0==e.preTranslation.y||t.push("PreTranslation "+A(e.preTranslation,!0)),1==e.scale.x&&1==e.scale.y||t.push("Scale x"+L(e.scale)),0!=e.rotation&&t.push("Rotation "+(e.rotation>0?"":"")+Math.round(180*e.rotation/Math.PI)+""),0==e.translation.x&&0==e.translation.y||t.push("Translation "+A(e.translation,!0)),0==t.length&&t.push("No Transform"),t},t.transformToString=M,t.rectToString=R,t.rangeToString=O,t.colorToString=D,t.strokesToString=F,t.getDebugStringMorph=N,t.DebugStringProvider=void 0;var n=i(r(18)),a=i(r(1)),o=i(r(2)),s=r(12),l=r(39),c=r(30),u=r(16),d=r(27),h=r(64);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=(0,o.default)((function e(){(0,a.default)(this,e)}),[{key:"getDebugStringForItem",value:function(e,t){return g(e,0,t)}},{key:"getDebugStringForMorph",value:function(e,t){return N(e,t)}}]);function g(e,t,r){for(var i="",n=v(e,!0,r),a=0;a<n.length;a++)i+=" ".repeat(t+(0==a?0:2))+n[a]+"\n";if(e instanceof c.Group){var o,s=f(e.items.elements);try{for(s.s();!(o=s.n()).done;)i+=g(o.value,t+1,r)}catch(e){s.e(e)}finally{s.f()}}return i}function v(e,t,r){if(e instanceof c.Shape){var i,a=e.role==c.ShapeRole.background?" background":e.role==c.ShapeRole.titlePlaceholder?" title Placeholder":e.role==c.ShapeRole.text?" text":"";if(e.isSolidRect())i=[" Solid rect"];else if(e.isSolidRectGeometry())i=[" Rect with line"];else if(i=[e.paths?""+T(e.paths.length,"path"):" no paths!"],t&&e.paths instanceof Array){var o,l=f(e.paths);try{for(l.s();!(o=l.n()).done;){var u,d,h=o.value,m=[" "," "," "," "],p=f(h.figures);try{for(p.s();!(d=p.n()).done;)_(d.value,m,8)}catch(e){p.e(e)}finally{p.f()}if(h.glyphCacheId&&r){var g=r.getDebugGlyphCacheInfo(h.glyphCacheId);i.push(" Font:"+h.glyphCacheId.fontId+", Glyph: "+h.glyphCacheId.glyphId+g==void 0?"Not cached":"Cached on page ".concat(g))}(u=i).push.apply(u,m)}}catch(e){l.e(e)}finally{l.f()}}var v=e.getBounds()?R(e.getBounds()||s.Rect.Zero):"undefined:",S=[(e.isHidden?" HIDDEN":"")+" Shape"+a+", Bounds: "+v+(e.textRange?", TextRange: "+O(e.textRange):"")].concat((0,n.default)(i),[" Transform: "+M(e.transform)," Style: "+E(e.style,r)]);return(e.effects.replicate||e.effects.echo||e.effects.glow||e.effects.border||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&S.push(" Effects: "+x(e.effects)),e.text&&S.push.apply(S,(0,n.default)(y(e.text,r))),S}if(e instanceof c.Group){var b=e.getBounds()?R(e.getBounds()||s.Rect.Zero):"undefined:",w=[(e.isHidden?" HIDDEN":"")+" Group: "+T(e.items.length,"item")+", Bounds: "+b," Transform: "+M(e.transform)];return(e.effects.replicate||e.effects.echo||e.effects.glow||e.effects.border||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&w.push(" Effects: "+x(e.effects)),e.groupFillBrush&&w.push(" Group Fill: "+C(e.groupFillBrush,r)),w}return["Unknown"]}function y(e,t){var r=[" Text "+T(e.paragraphs.length,"paragraph")];r.push(" LayoutToFrame: "+M(e.layoutToFrame)),r.push(" FrameToShape:  "+M(e.frameToShape));for(var i=0;i<e.paragraphs.length;i++){var n=e.paragraphs[i];r.push("  Paragraph "+i+(n.bullet?" (with bullet)":" ")+"globalRange: "+O(n.globalRange)+", "+n.globalRange.length+" characters");var a=n.stylePerLocalRange.dataPerRange,o=n.effectsPerLocalRange.dataPerRange,s=n.strokesPerLocalRange.dataPerRange;if(a){for(var c="",u=0;u<a.length;u++)c+=(0==u?"":", ")+O(a[u].range)+"("+E(a[u].data,t)+")";r.push("   Styles:  "+c)}if(o){for(var h="",m=0;m<o.length;m++)h+=(0==m?"":", ")+O(o[m].range)+"("+x(o[m].data)+")";r.push("   Effects: "+h)}if(s){for(var p="",g=0;g<s.length;g++)p+=(0==g?"":", ")+O(s[g].range)+"("+F(s[g].data)+")";r.push("   Stokes:  "+p)}for(var v=0;v<n.lines.length;v++){var y=n.lines[v];r.push("   Line "+v+" localRange:"+O(y.localRange)+", bounds:"+R(y.layoutBounds));var _,S="     Paths/Char: ",b=f(y.characters);try{for(b.s();!(_=b.n()).done;){var C=_.value;S+=C.textImage?"":C.paths instanceof d.Path?"":C.paths?0==C.paths.length?"":C.paths.length>9?"+":C.paths.length:""}}catch(e){b.e(e)}finally{b.f()}r.push(S),y.bender instanceof l.WarpingEnvelope?r.push("    Warping Source Bounds "+R(y.bender.sourceRect)):y.bender instanceof l.PathingLine&&r.push("    Pathing Source Bounds "+R(y.bender.lineRect))}}return r}function _(e,t,r){var i=new s.Vector2(2*r,2*t.length),n=new Array(i.x*i.y).fill(!1),a=function(e,t){e[(0,s.clamp)(Math.floor(t.x),0,i.x-1)+(0,s.clamp)(Math.floor(t.y),0,i.y-1)*i.x]=!0},o=(0,d.calculateBoundsOfFigures)([e]);o&&i.x>0&&e.forEachSegment((function(e,t,r){for(var o=0;o<=1;o+=1/i.x)a(n,t?s.Vector2.InterpolateQuadratic(e,t,r,o):s.Vector2.InterpolateLinear(e,r,o));return!0}),new s.Transform(o.leftTop.negate(),i.scale(1/Math.max(o.size.x,o.size.y))));for(var l=0;l<t.length;l++)for(var c=0;c<r;c++){var u=2*c+2*l*i.x;t[l]=t[l]+" "[(n[u]?1:0)+(n[u+1]?2:0)+(n[u+i.x]?4:0)+(n[u+1+i.x]?8:0)]+(c==r-1?"  ":"")}}function S(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.Matrix3.Identity,n=new s.Vector2(2*r,2*t.length),a=new Array(n.x*n.y).fill(!1),o=function(e,t){e[(0,s.clamp)(Math.floor(t.x),0,n.x-1)+(0,s.clamp)(Math.floor(t.y),0,n.y-1)*n.x]=!0},l=(0,c.getBoundsOfPaths)(e,!1,i);if(l&&n.x>0){var u,d=f(e.paths||[]);try{for(d.s();!(u=d.n()).done;){var h,m=u.value,p=f(m.figures);try{for(p.s();!(h=p.n()).done;){var g=h.value;g.forEachSegment((function(e,t,r){for(var i=0;i<=1;i+=1/n.x)o(a,t?s.Vector2.InterpolateQuadratic(e,t,r,i):s.Vector2.InterpolateLinear(e,r,i));return!0}),s.Matrix3.FromTransforms(m.transform,i,new s.Transform(l.leftTop.negate(),n.scale(1/Math.max(l.size.x,l.size.y)))))}}catch(e){p.e(e)}finally{p.f()}}}catch(e){d.e(e)}finally{d.f()}}for(var v=0;v<t.length;v++)for(var y=0;y<r;y++){var _=2*y+2*v*n.x;t[v]=t[v]+" "[(a[_]?1:0)+(a[_+1]?2:0)+(a[_+n.x]?4:0)+(a[_+1+n.x]?8:0)]+(y==r-1?"  ":"")}}function T(e,t){return e+" "+(e>1?t+"s":t)}function b(e){var t=Math.round(1e4*e)/1e4;return e!=t?t+"":t}function C(e,t){if(e instanceof u.SolidBrush)return D(e.color);if(e instanceof u.GradientBrush)return" "+["Linear","Radial","Rectangular","Path"][e.getType()-u.BrushType.linearGradient]+" Gradient";if(e instanceof u.ImageBrush){var r=" ImageBrush(";if(e.image){if(e.image.id&&(r+="id:"+e.image.id+" "),t){var i=t.tryGetImageDebugData(e.image);if(i){var n=i.getState(),a=i.getSize();n==h.ImageContainerState.uninitialized?r+="uninitialized":n==h.ImageContainerState.deleted?r+="deleted":r+=a?a.x+"x"+a.y:"no texture + bad state"}}}else r+="no image";return 1!=e.opacity&&(r+=", opacity="+e.opacity),r+")"}return e instanceof u.PatternBrush?" Pattern":e instanceof u.SpecialBrush?e.getType()==u.BrushType.background?"Background":e.getType()==u.BrushType.group?"Group":" Unknown Custom":" Unknown Brush"}function w(e,t){var r="";switch(e){case u.PenLineEnd.arrow:r+="<";break;case u.PenLineEnd.diamond:r+="";break;case u.PenLineEnd.none:r+="";break;case u.PenLineEnd.oval:r+="";break;case u.PenLineEnd.stealth:r+="";break;case u.PenLineEnd.triangle:r+=""}switch(r+="",t){case u.PenLineEnd.arrow:r+=">";break;case u.PenLineEnd.diamond:r+="";break;case u.PenLineEnd.none:r+="";break;case u.PenLineEnd.oval:r+="";break;case u.PenLineEnd.stealth:r+="";break;case u.PenLineEnd.triangle:r+=""}return r}function P(e){switch(e){case u.PenLineEndWidth.medium:return"medium";case u.PenLineEndWidth.narrow:return"narrow";case u.PenLineEndWidth.wide:return"wide"}}function I(e){switch(e){case u.PenLineEndLength.long:return"long";case u.PenLineEndLength.medium:return"medium";case u.PenLineEndLength.short:return"short"}}function k(e){var t="(";return e.cap!=u.PenLineCap.round&&(t+=(e.cap==u.PenLineCap.square?"square":"flat")+"cap"),t+=", "+P(e.width),(t+=", "+I(e.length))+")"}function E(e,t){var r=(e.fillBrush?C(e.fillBrush,t):"No ")+" fill";return e.pictureBrush&&(r+=" + Picture "+C(e.pictureBrush,t)),e.lineBrush&&(r+=", "+C(e.lineBrush,t)+" line, width="+b(e.pen.lineWidth),e.pen.lineHeight!=e.pen.lineWidth&&(r+=", height="+b(e.pen.lineHeight)),e.pen.tipType==u.PenTip.square?r+=",  Square Tip":e.pen.tipType==u.PenTip.ball&&(r+=",  Ball Tip"),e.pen.headEnd.end==u.PenLineEnd.none&&e.pen.tailEnd.end==u.PenLineEnd.none||(r+=", LineEnd ("+w(e.pen.headEnd.end,e.pen.tailEnd.end),e.pen.headEnd.end!=u.PenLineEnd.none&&(r+=" head "+k(e.pen.headEnd)),e.pen.tailEnd.end!=u.PenLineEnd.none&&(r+=" tail "+k(e.pen.tailEnd)),r+=")")),e.blendingMode!=u.BlendingMode.normal&&(r+=", blendingMode: "+(e.blendingMode==u.BlendingMode.cutout?"cutout":e.blendingMode==u.BlendingMode.darken?"darken":e.blendingMode==u.BlendingMode.exclusion?"exclusion":" unknown")),r}function x(e){return(e.glow?"Glow ":"")+(e.shadow?"Shadow ":"")+(e.innerShadow?"InnerShadow ":"")+(e.reflection?"Reflection ":"")+(e.softEdges?"SoftEdges ":"")+(e.border?"Border ":"")+(e.echo?"Echo ":"")+(e.replicate?"Replicate ":"")}function L(e){return"("+b(e.x)+", "+b(e.y)+")"}function A(e,t){var r=Math.round(10*e.x)/10,i=Math.round(10*(t?e.y:-e.y))/10;return(i<0?r<0?"":0==r?"":"":0==i?r<0?"":0==r?"":"":r<0?"":0==r?"":"")+L(e)}function M(e){var t="";return 0!=e.preTranslation.x&&0!=e.preTranslation.y&&(t+="PreTranslation "+A(e.preTranslation,!0)),1!=e.scale.x&&1!=e.scale.y&&(t+=", Scale x"+L(e.scale)),0!=e.rotation&&(t+=", Rotation "+(e.rotation>0?"":"")+Math.round(180*e.rotation/Math.PI)+""),t+", Translation "+A(e.translation,!0)}function R(e){return"[("+b(e.left)+", "+b(e.top)+"), ("+b(e.right)+", "+b(e.bottom)+")]"}function O(e){return 0==e.length?"]"+e.start+"[":1==e.length?"["+e.start+"]":e.length>1?"["+e.start+"-"+e.last+"]":"invalid(start="+e.start+", length="+e.length+")"}function D(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(e){var t=Math.floor(255*e);return t<16?"0"+t.toString(16):t.toString(16)};if(t)return"#"+r(e.r)+r(e.g)+r(e.b);var i="#"+r(e.r)+r(e.g)+r(e.b)+r(e.a);switch(i){case"#00000000":return"Transparent";case"#000000ff":return"Black";case"#ffffffff":return"White";case"#ff0000ff":return"Red";case"fffff00ff":return"Yellow";case"#00ff00ff":return"Green";case"#0000ffff":return"Blue"}return i}function F(e){var t="";if(e.elements)for(var r=0;r<e.elements.length;r++)switch(t+=0==r?"":", ",e.elements[r].type){case l.TextStrokeType.highlighter:t+="";break;case l.TextStrokeType.single:t+="-";break;case l.TextStrokeType.double:t+="=";break;default:t+="~"}return t}function B(e,t,r,i){var n=new Array(r);if(!e)return n.fill(" ".repeat(t)),n[Math.floor(r/2)]=" ".repeat(Math.floor((t-1)/2))+"",n[Math.floor(r/2)]+=" ".repeat(t-n[r/2].length),n;i?n=function(e,t,r,i){var n=new Array(r);if(n.fill(""),i){var a=i.tryGetImageDebugDataForMorphKeyFrame(e);if(a){var o=a.getSize();if(o){var s=a.tryConvertToBufferRGBA();if(s){for(var l=Math.max(o.x,o.y),c=Math.max(1,Math.floor(l/t)),u=Math.max(1,Math.floor(l/r)),d=1/(255*c*u),h=0;h<r;h++)for(var f=0;f<t;f++)if(f*c<o.x&&h*u<o.y){for(var m=0,p=0,g=0,v=0,y=0;y<u;y++)for(var _=0;_<c;_++){var S=4*(Math.min(f*c+_,o.x-1)+(o.y-1-Math.min(h*u+y,o.y-1))*o.x);m+=s[S]*d,p+=s[S+1]*d,g+=s[S+2]*d,v+=s[S+3]*d}var T=0==v?0:(.2126*m+.7152*p+.0722*g)/v;n[h]+=v<.1?"":" "[Math.max(0,Math.min(4,Math.floor(5*T)))]}else n[h]+=" ";var b=a.getLogicalCenter();if(b){var C=Math.floor(b.x/c),w=Math.floor(b.y/u);C>=0&&C<t&&w>=0&&w<r&&(n[w]=n[w].slice(0,C)+"X"+n[w].slice(C+1,n[w].length))}}else n[0]=" Failed to get bufffer"}else n[0]="No texture yet?"}for(var P=0;P<r;P++)n[P].length<t&&(n[P]+=" ".repeat(t-n[P].length)),n[P].length>t&&(n[P]=n[P].slice(0,t));return n}return n}(e,2*r,r,i):n.fill(" ".repeat(t));var a=[];if(0==e.contents.length)a.push(" KeyFrame has no content");else if(1==e.contents.length){var o=e.contents[0];if(o.item instanceof c.Shape){var l;if(o.textRange)a.push("TEXT Only: "+O(o.textRange)),o.item.text?l=new c.Shape(o.item.text.getTextPathsForRange(o.textRange)):a.push(" Shape has no text");else{a.push(o.includeSubtree?"SHAPE + Text":"SHAPE Only");var u=o.item.getBounds();a.push("Bounds:"+(u?R(u):" bad rect")),o.item.paths||a.push(" Shape has no path"),o.item.paths&&o.item.isSolidRectGeometry()?a.push("Rect Geometry"):l=o.item,a.push((o.item.style.fillBrush?C(o.item.style.fillBrush,i):"No ")+" fill"),o.item.style.pictureBrush&&a.push("+  picture"),o.item.style.lineBrush&&(a.push(C(o.item.style.lineBrush,i)+" line"),a.push("width = "+b(o.item.style.pen.lineWidth)))}if(l){var d=[" "," "," "," "," "," "],h=t-2*r-2;S(l,d,h,s.Matrix3.Scale2D(new s.Vector2(2,h/d.length)));for(var m=0,p=d;m<p.length;m++){var g=p[m];a.push(g)}}}else if(o.item instanceof c.Group){a.push(o.textRange?" Group with TextRange ?!":o.includeSubtree?"Group + Subtree":"Group Effects Only"),a.push(function e(t){var r,i="",n=f(t.items.elements);try{for(n.s();!(r=n.n()).done;){var a=r.value;i+=a instanceof c.Group?"G("+e(a)+")":a instanceof c.Shape?"S":""}}catch(e){n.e(e)}finally{n.f()}return i}(o.item));var v=o.item.getBounds();a.push("Bounds:"+(v?R(v):" bad rect"))}}else{a.push(T(e.contents.length,"content"));for(var y="",_=0;_<e.contents.length;_++){var w=e.contents[_];w.item instanceof c.Shape?y+=w.textRange?"T"+O(w.textRange):w.includeSubtree?"S+":"S-":w.item instanceof c.Group&&(y+=w.textRange?"GT":w.includeSubtree?"G+":"G-"),_!=e.contents.length-1&&(y+=",")}a.push(y)}a.push(""),a.push("Center: ("+Math.floor(e.location.center.x)+", "+Math.floor(e.location.center.y)+")"),a.push("Size: "+Math.floor(e.location.size.x)+" x "+Math.floor(e.location.size.y)),a.push("Rotation: "+Math.round(180*e.location.rotation/Math.PI)),a.push("Flip: "+(e.location.flipX||e.location.flipY?(e.location.flipX?"FlipX ":"")+(e.location.flipY?"FlipY":""):"none")),a.push("Grid: "+(e.morphingGrid?e.morphingGrid.size.x+"x"+e.morphingGrid.size.y:"none")),a.push("ZPos: "+e.zPosition);for(var P=0;P<r;P++)P<a.length&&(n[P]+=" "+a[P]),n[P].length<t&&(n[P]+=" ".repeat(t-n[P].length)),n[P].length>t&&(n[P]=n[P].slice(0,t));return n}function N(e,t){for(var r="Morph "+T(e.elements.length,"MorphElement")+":\n",i=0;i<e.elements.length;i++){var n,a=e.elements[i],o=[],s=f(a.keyFrames);try{for(s.s();!(n=s.n()).done;){var l=n.value;o.push(B(l,70,16,t))}}catch(e){s.e(e)}finally{s.f()}var c="-----"+"-".repeat(71).repeat(a.keyFrames.length);0==i&&(r+=c+"\n");for(var u=0;u<16;u++){r+="|",r+=3==u?i<10?" "+i+" ":i<100?" "+i:i<1e3?i:"1K+":5==u?null==a.rotateClockwise?"   ":a.rotateClockwise?"  ":"  ":"   ";for(var d=0;d<o.length;d++)r+="|"+o[d][u];r+="|\n"}r+=c+"\n"}return r}t.DebugStringProvider=p},function(e,t){function r(t,i){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,i)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.s_renderDataMapFinalizationRegistry=void 0;var i="undefined"!=typeof FinalizationRegistry?new FinalizationRegistry((function(e){var t=e;for(var r in t)t[r].onFinalization()})):void 0;t.s_renderDataMapFinalizationRegistry=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundsContributorsFromPaths=function(e,t,r,i,o,l){var u,d=s(e);try{for(d.s();!(u=d.n()).done;){var h,f=u.value,m=f.transform.toMatrix3().multiply(i),p=s(f.figures);try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.push(c(g,m,t,o?a.LineJoin.miter:r.pen.lineJoin,r.pen.miterLimit)),t&&!g.isClosed&&r.pen){if(r.pen.headEnd&&r.pen.headEnd.end!=a.PenLineEnd.none){var v=(0,n.getArrowHeadFigure)(r.pen.headEnd,r.pen.adjustedLineWidthForArrowHead);if(v){var y=(0,n.getArrowHeadTransform)(g,!1,r.pen.headEnd,2*t,m);y&&l.push(c(v,y,t,a.LineJoin.miter,r.pen.miterLimit))}}if(r.pen.tailEnd&&r.pen.tailEnd.end!=a.PenLineEnd.none){var _=(0,n.getArrowHeadFigure)(r.pen.tailEnd,r.pen.adjustedLineWidthForArrowHead);if(_){var S=(0,n.getArrowHeadTransform)(g,!0,r.pen.tailEnd,2*t,m);S&&l.push(c(_,S,t,a.LineJoin.miter,r.pen.miterLimit))}}}}}catch(e){p.e(e)}finally{p.f()}}}catch(e){d.e(e)}finally{d.f()}},t.getBoundsFromContributor=function(e,t){var r=!0,n=0,a=0,o=0,l=0,c=e.transform&&t?e.transform.multiply(t):t||e.transform,u=!c||c.isSimpleScaleTranslationOnly(),d=u?void 0:c,h=e.points,f=e.curves,m=h&&h.length>0?h[0]:f&&f.length>0?f[0][0]:void 0;if(m){var p=0,g=0,v=0,y=0,_=0,S=0;if(d&&(p=d.m[0],g=d.m[1],v=d.m[3],y=d.m[4],_=d.m[6],S=d.m[7]),r&&(a=n=d?m.x*p+m.y*v+_:m.x,l=o=d?m.x*g+m.y*y+S:m.y,r=!1),h&&h.length>0)for(var T=1;T<h.length;T++){var b=h[T],C=d?b.x*p+b.y*v+_:b.x,w=d?b.x*g+b.y*y+S:b.y;n=C<n?C:n,a=C>a?C:a,o=w<o?w:o,l=w>l?w:l}var P,I=s(f||[]);try{for(I.s();!(P=I.n()).done;){var k=P.value,E=k[0],x=k[1],L=k[2],A=d?E.x*p+E.y*v+_:E.x,M=d?E.x*g+E.y*y+S:E.y,R=d?x.x*p+x.y*v+_:x.x,O=d?x.x*g+x.y*y+S:x.y,D=d?L.x*p+L.y*v+_:L.x,F=d?L.x*g+L.y*y+S:L.y;n=D<(n=A<n?A:n)?D:n,a=D>(a=A>a?A:a)?D:a,o=F<(o=M<o?M:o)?F:o,l=F>(l=M>l?M:l)?F:l;var B=(A-R)/(A+D-2*R);if(0<B&&B<1){var N=B*B,V=A*(N-2*B+1)+D*N+2*R*(B-N),U=M*(N-2*B+1)+F*N+2*O*(B-N);n=V<n?V:n,a=V>a?V:a,o=U<o?U:o,l=U>l?U:l}var W=(M-O)/(M+F-2*O);if(0<W&&W<1){var G=W*W,H=A*(G-2*W+1)+D*G+2*R*(W-G),j=M*(G-2*W+1)+F*G+2*O*(W-G);n=H<n?H:n,a=H>a?H:a,o=j<o?j:o,l=j>l?j:l}}}catch(e){I.e(e)}finally{I.f()}var z=new i.Rect(n,o,a,l);return u&&(z=c?z.multiply(c.getSimpleScale()).translate(c.getSimpleTranslation()):z),z}},t.tryGetQuickBoundsOfPaths=function(e){var t,r=void 0,n=s(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(0!=a.transform.rotation)return;var o=a.untransformedBounds;o&&(r=i.Rect.UnionRect(r,o.transformedBounds(a.transform)))}}catch(e){n.e(e)}finally{n.f()}return r};var i=r(12),n=r(105),a=r(16),o=r(27);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function c(e,t,r,n,s){if(0==r&&e.cachedBoundsContributor)return{points:e.cachedBoundsContributor.points,curves:e.cachedBoundsContributor.curves,transform:t};for(var l=0!=r,c={points:new Array,curves:new Array,transform:l?void 0:t},u=e.getPointCount(),d=0;d<u;d++){var h=e.getPoint(d-1),f=e.getPoint(d),m=e.getPoint(d+1);if(l&&(h=t.transformPoint(h),f=t.transformPoint(f),m=t.transformPoint(m)),e.getPointType(d)==o.PointType.bezier)r?(c.curves.push([h.add(new i.Vector2(-r,0)),f.add(new i.Vector2(-r,0)),m.add(new i.Vector2(-r,0))]),c.curves.push([h.add(new i.Vector2(r,0)),f.add(new i.Vector2(r,0)),m.add(new i.Vector2(r,0))]),c.curves.push([h.add(new i.Vector2(0,-r)),f.add(new i.Vector2(0,-r)),m.add(new i.Vector2(0,-r))]),c.curves.push([h.add(new i.Vector2(0,r)),f.add(new i.Vector2(0,r)),m.add(new i.Vector2(0,r))])):c.curves.push([h,f,m]);else if(c.points.push(f),r)if(n==a.LineJoin.round)r?(c.points.push(f.add(new i.Vector2(-r,0))),c.points.push(f.add(new i.Vector2(r,0))),c.points.push(f.add(new i.Vector2(0,-r))),c.points.push(f.add(new i.Vector2(0,r)))):c.points.push(f);else{var p=f.subtract(h).normalized(),g=m.subtract(f).normalized();if(p&&g){p=p.scale(r),g=g.scale(r);var v=new i.Vector2(-p.y,p.x),y=new i.Vector2(-g.y,g.x);p.dot(y)<0&&(v=v.negate(),y=y.negate());var _=f.add(v),S=f.add(y);if(c.points.push(_),c.points.push(S),n==a.LineJoin.miter||n==a.LineJoin.miterOrBevel){var T=i.Vector2.CalculateLineIntersection(_,_.add(p),S,S.subtract(g));T&&(i.Vector2.Distance(T,f)<s*r?c.points.push(T):n==a.LineJoin.miter&&(c.points.push(_.add(p.scale(s))),c.points.push(S.subtract(g.scale(s)))))}}}}return 0!=r||e.cachedBoundsContributor||(e.cachedBoundsContributor={points:c.points,curves:c.curves,transform:void 0}),c}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getArrowHeadFigure=function(e,t){var r,c=new i.Vector2(t*s(e.width,e.end),t*l(e.length,e.end));if(e.end==a.PenLineEnd.triangle||e.end==a.PenLineEnd.arrow)r=new o.Figure([-.5*c.x,-1*c.y,1,0,0,1,.5*c.x,-1*c.y,1],e.end==a.PenLineEnd.triangle);else if(e.end==a.PenLineEnd.stealth)r=new o.Figure([-.5*c.x,-1*c.y,1,0,0,1,.5*c.x,-1*c.y,1,0,-.5*c.y,1],!0);else if(e.end==a.PenLineEnd.diamond)r=new o.Figure([0,.5*c.y,1,.5*c.x,0,1,0,-.5*c.y,1,-.5*c.x,0,1],!0);else if(e.end==a.PenLineEnd.oval){var u=new o.FigureBuilder;u.moveTo(.5*c.x,0),u.arcTo(.5*c.x,.5*c.y,0,2*Math.PI),u.close(),r=u.createFigure()}return r||n.Log.Error(572867280,"bad arrow head"),r},t.getArrowHeadWidthScale=s,t.getArrowHeadLengthScale=l,t.getArrowHeadTransform=function(e,t,r,n,o){var s=(r.end==a.PenLineEnd.diamond||r.end==a.PenLineEnd.oval?.5:1)*l(r.length,r.end)*n,c=(t?e.getPoint(e.getPointCount()-1):e.getPoint(0)).transformPoint(o),u=e.getPointFromDist(s,o,t),d=c.subtract(u).normalized();if(d){var h=new i.Vector2(-d.y,d.x);return new i.Matrix3(h.x,h.y,0,d.x,d.y,0,0,0,1).multiply(i.Matrix3.Translation2D(c))}},t.getEndGapsForArrowHead=function(e,t){return e?e.end==a.PenLineEnd.none||e.end==a.PenLineEnd.oval||e.end==a.PenLineEnd.diamond?0:e.end==a.PenLineEnd.arrow||e.end==a.PenLineEnd.stealth?t*l(e.length,e.end)/s(e.width,e.end):2*t:0};var i=r(12),n=r(13),a=r(16),o=r(27);function s(e,t){return e==a.PenLineEndWidth.narrow?t==a.PenLineEnd.arrow?2.5:2:e==a.PenLineEndWidth.medium?t==a.PenLineEnd.arrow?3.5:3:e==a.PenLineEndWidth.wide?(a.PenLineEnd.arrow,5):(n.Log.Error(572867281,"bad arrow head"),0)}function l(e,t){return e==a.PenLineEndLength.short?(a.PenLineEnd.arrow,2):e==a.PenLineEndLength.medium?(a.PenLineEnd.arrow,3):e==a.PenLineEndLength.long?t==a.PenLineEnd.arrow?4.5:5:(n.Log.Error(572867282,"bad arrow head"),0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCachedPipeline=function(e,t){return(0,a.getStateObject)(t).cachedPipelines[e]},t.resetCachedPipeline=function(e){var t=e._name,r=e.context;if(t&&r){var i=(0,a.getStateObject)(r),n=i.cachedPipelines[t];null==n||n.dispose(),delete i.cachedPipelines[t]}},t._processShaderCode=function(e,t,r,a,o,s,c){var d,h,f=(0,i.IsWindowObjectExist)()?null==s?void 0:s.getHostDocument():null;d="string"==typeof t?t:t.vertexSource?"source:"+t.vertexSource:t.vertexElement?(null==f?void 0:f.getElementById(t.vertexElement))||t.vertexElement:t.vertex||t,h="string"==typeof t?t:t.fragmentSource?"source:"+t.fragmentSource:t.fragmentElement?(null==f?void 0:f.getElementById(t.fragmentElement))||t.fragmentElement:t.fragment||t;var m=[void 0,void 0],p=function(){if(m[0]&&m[1]){e.isFragment=!0;var i=m[0],u=m[1];(0,l.Process)(u,e,(function(s,u){c&&(c._fragmentSourceCodeBeforeMigration=u),r&&(s=r("fragment",s));var d=(0,l.Finalize)(i,s,e);e=null;var h=function(e,t,r,i){if(r){var a=r.vertexElement||r.vertex||r.spectorName||r,o=r.fragmentElement||r.fragment||r.spectorName||r;return{vertexSourceCode:(i===n.ShaderLanguage.WGSL?"//":"")+"#define SHADER_NAME vertex:"+a+"\n"+e,fragmentSourceCode:(i===n.ShaderLanguage.WGSL?"//":"")+"#define SHADER_NAME fragment:"+o+"\n"+t}}return{vertexSourceCode:e,fragmentSourceCode:t}}(d.vertexCode,d.fragmentCode,t,o);null==a||a(h.vertexSourceCode,h.fragmentSourceCode)}),s)}};u(d,"Vertex","",(function(t){(0,l.Initialize)(e),(0,l.Process)(t,e,(function(e,i){c&&(c._rawVertexSourceCode=t,c._vertexSourceCodeBeforeMigration=i),r&&(e=r("vertex",e)),m[0]=e,p()}),s)}),o),u(h,"Fragment","Pixel",(function(e){c&&(c._rawFragmentSourceCode=e),m[1]=e,p()}),o)},t.createAndPreparePipelineContext=void 0;var i=r(71),n=r(48),a=r(87),o=r(108),s=r(61),l=r(227),c=r(60);function u(e,t,r,n,a,s){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)n((0,i.GetDOMTextContent)(e));else if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var l=o.ShaderStore.GetShadersStore(a);if(l[e+t+"Shader"])n(l[e+t+"Shader"]);else if(r&&l[e+r+"Shader"])n(l[e+r+"Shader"]);else{var u;if(u="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:o.ShaderStore.GetShadersRepository(a)+e,!(s=s||c._loadFile))throw new Error("loadFileInjection is not defined");s(u+"."+t.toLowerCase()+".fx",n)}}else n(window.atob(e.substr(7)));else n(e.substr(7))}t.createAndPreparePipelineContext=function(e,t,r,i){try{var n=e.existingPipelineContext||t(e.shaderProcessingContext);return n._name=e.name,e.name&&e.context&&((0,a.getStateObject)(e.context).cachedPipelines[e.name]=n),r(n,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,""),i(n,(function(){var t;null===(t=e.onRenderingStateCompiled)||void 0===t||t.call(e,n)})),n}catch(e){throw s.Logger.Error("Error compiling effect"),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._WarnImport=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||!i[e])return i[e]=!0,"".concat(e," needs to be imported before as it contains a side-effect required by your code.")};var i={}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderStore=void 0;var n=i(r(1)),a=i(r(2)),o=r(48),s=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"GetShadersRepository",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.ShaderLanguage.GLSL;return t===o.ShaderLanguage.GLSL?e.ShadersRepository:e.ShadersRepositoryWGSL}},{key:"GetShadersStore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.ShaderLanguage.GLSL;return t===o.ShaderLanguage.GLSL?e.ShadersStore:e.ShadersStoreWGSL}},{key:"GetIncludesShadersStore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.ShaderLanguage.GLSL;return t===o.ShaderLanguage.GLSL?e.IncludesShadersStore:e.IncludesShadersStoreWGSL}}])}();t.ShaderStore=s,s.ShadersRepository="src/Shaders/",s.ShadersStore={},s.IncludesShadersStore={},s.ShadersRepositoryWGSL="src/ShadersWGSL/",s.ShadersStoreWGSL={},s.IncludesShadersStoreWGSL={}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderCodeNode=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this.children=[]}),[{key:"isValid",value:function(e){return!0}},{key:"process",value:function(e,t){var r="";if(this.line){var i=this.line,n=t.processor;if(n){var a,o,s,l,c,u,d;n.lineProcessor&&(i=n.lineProcessor(i,t.isFragment,t.processingContext));var h=null!==(a=null===(o=t.processor)||void 0===o?void 0:o.attributeKeywordName)&&void 0!==a?a:"attribute",f=t.isFragment&&null!==(s=t.processor)&&void 0!==s&&s.varyingFragmentKeywordName?null===(l=t.processor)||void 0===l?void 0:l.varyingFragmentKeywordName:!t.isFragment&&null!==(c=t.processor)&&void 0!==c&&c.varyingVertexKeywordName?null===(u=t.processor)||void 0===u?void 0:u.varyingVertexKeywordName:"varying";!t.isFragment&&n.attributeProcessor&&this.line.startsWith(h)?i=n.attributeProcessor(this.line,e,t.processingContext):n.varyingProcessor&&(null!==(d=n.varyingCheck)&&void 0!==d&&d.call(n,this.line,t.isFragment)||!n.varyingCheck&&this.line.startsWith(f))?i=n.varyingProcessor(this.line,t.isFragment,e,t.processingContext):n.uniformProcessor&&n.uniformRegexp&&n.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(i=n.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):n.uniformBufferProcessor&&n.uniformBufferRegexp&&n.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(i=n.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):n.textureProcessor&&n.textureRegexp&&n.textureRegexp.test(this.line)?i=n.textureProcessor(this.line,t.isFragment,e,t.processingContext):(n.uniformProcessor||n.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?n.uniformProcessor&&(i=n.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):n.uniformBufferProcessor&&(i=n.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,n.endOfUniformBufferProcessor&&(i=n.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}r+=i+"\n"}return this.children.forEach((function(i){r+=i.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),r}}]);t.ShaderCodeNode=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLHardwareTexture=void 0;var n=i(r(1));function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var o=(0,i(r(2)).default)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;if((0,n.default)(this,e),this._MSAARenderBuffers=null,this._context=r,!t&&!(t=r.createTexture()))throw new Error("Unable to create webGL texture");this.set(t)}),[{key:"underlyingResource",get:function(){return this._webGLTexture}},{key:"setUsage",value:function(){}},{key:"set",value:function(e){this._webGLTexture=e}},{key:"reset",value:function(){this._webGLTexture=null,this._MSAARenderBuffers=null}},{key:"addMSAARenderBuffer",value:function(e){this._MSAARenderBuffers||(this._MSAARenderBuffers=[]),this._MSAARenderBuffers.push(e)}},{key:"releaseMSAARenderBuffers",value:function(){if(this._MSAARenderBuffers){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}(this._MSAARenderBuffers);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._context.deleteRenderbuffer(r)}}catch(e){t.e(e)}finally{t.f()}this._MSAARenderBuffers=null}}},{key:"getMSAARenderBuffer",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!==(e=null===(t=this._MSAARenderBuffers)||void 0===t?void 0:t[r])&&void 0!==e?e:null}},{key:"release",value:function(){this.releaseMSAARenderBuffers(),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}]);t.WebGLHardwareTexture=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTapeBuffersForPath=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,s=a.TapeDataFlags.alignedVec4|a.TapeDataFlags.position|a.TapeDataFlags.type|a.TapeDataFlags.pressure,l=[],u=i?[]:void 0;if(!e.figures||0==e.figures.length)return{buffers:l,endDistance:0};for(var h=4,f=0,m=0;m<e.figures.length;m++){var p=r?e.figures[m].toPolygon():e.figures[m],g=(0,a.getPointDataSize)(s),v=p.isLastPointDuplicated(),y=p.isClosed||v,_=c(p.points,p.format,s,0,v?p.points.length-p.pointDataSize:p.points.length,1,3,y,e.maxPressure),S=_.length/g,T=void 0;if(i){var b=d(_,s,y,f,o,1,3);T=b.distanceArray,f=b.endDistance}var C=_.length;if(C>t)for(var w=t/g-h,P=Math.ceil((S-h)/w),I=w+h,k=0,E=0;E<P;E++){var x=Math.min(I,S-k),L=x-h;l.push(_.subarray(k*g,(k+x)*g)),u&&T&&u.push(T.subarray(k,k+x)),k+=L}else{var A=new Float32Array(4*Math.ceil(C/4));A.set(_,0),l.push(A),u&&T&&u.push(T)}}return u&&u.length!=l.length&&n.Log.Error(592525388,"Invalid distance array"),{buffers:l,distanceBuffers:u,endDistance:f}},t.measureTapeDistances=d;var i=r(12),n=r(13),a=r(27);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var l=[a.TapeDataFlags.position,a.TapeDataFlags.position,a.TapeDataFlags.type,a.TapeDataFlags.distance,a.TapeDataFlags.pressure,a.TapeDataFlags.tilt,a.TapeDataFlags.tilt];function c(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,f=(0,a.getPointDataSize)(t),m=s-i;if(!(m%f==0&&t&a.TapeDataFlags.position&&r&a.TapeDataFlags.position))throw n.Log.Error(592525389,"list of source points invalid");var p=e,g=m/f;1==g&&((p=new Float32Array(2*e.length)).set(e,0),p.set(e,e.length),g=2);var v=f;f=(0,a.getPointDataSize)(r);for(var y=new Float32Array((c+g+u)*f),_=0;_<g;_++){var S,T=i+_*v,b=(c+_)*f,C=o(l);try{for(C.s();!(S=C.n()).done;){var w=S.value;w&r&&(w==a.TapeDataFlags.pressure?y[b]=w&t?p[T]/h:1:y[b]=w&t?p[T]:w==a.TapeDataFlags.type?1:0,b++),w&t&&T++}}catch(e){C.e(e)}finally{C.f()}}if((c||u)&&(c>0&&y.copyWithin(0,y.length-(c+u)*f,y.length-u*f),u>0&&y.copyWithin(y.length-u*f,c*f,(c+u)*f),!d&&r&a.TapeDataFlags.type)){for(var P=0;P<c;P++)y[P*f+2]=0;for(var I=0;I<u;I++)y[y.length-(I+1)*f+2]=0}return y}function u(e,t,r){var i=(0,a.getPointDataSize)(t);if(0==i||e.length%i!=0||!(t&a.TapeDataFlags.position))throw n.Log.Error(592525390,"list of points for invalid for measuring distance");for(var o=r.m,s=new Float32Array(e),l=0;l<e.length;l+=i){var c=e[l],u=e[l+1];s[l]=c*o[0]+u*o[3]+o[6],s[l+1]=c*o[1]+u*o[4]+o[7]}return s}function d(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=s?u(e,t,s):e,h=(0,a.getPointDataSize)(t);if(0==h||d.length%h!=0||d.length/h<l+c+1||!(t&a.TapeDataFlags.position))throw n.Log.Error(587534800,"list of points for invalid for measuring distance");for(var f=new Float32Array(d.length/h),m=l*h,p=d.length-c*h,g=(p-m)/h,v=t&a.TapeDataFlags.type,y=o||0,_=0;_<g;_++){var S=m+_*h,T=v?d[S+2]:a.PointType.corner;if(T!=a.PointType.bezier&&(f[l+_]=y,r||_<g-1)){var b=m+(_+1)%g*h,C=v?d[b+2]:a.PointType.corner;if(C!=a.PointType.bezier){var w=d[b]-d[S],P=d[b+1]-d[S+1];y+=Math.sqrt(w*w+P*P)}else if(C==a.PointType.bezier&&(r||_<g-2)){var I=m+(_+2)%g*h,k=d[S],E=d[S+1],x=d[b],L=d[b+1],A=d[I],M=d[I+1];y+=(0,i.measureQuadraticLength)(k,E,x,L,A,M)}}}for(var R=y-o,O=0;O<l;O++)f[O]=f[l+g-l+O]-R;for(var D=l+g;D<d.length/h;D++)f[D]=f[D+l-(l+g)]+R;for(var F=0;F<g;F++){var B=m+F*h;if(v&&d[B+2]==a.PointType.bezier){var N=0==l&&0==F?g-1:l+F-1,V=0==c&&F==g-1?l:l+F+1;f[l+F]=.5*(f[N]+f[V])}}return{distanceArray:f,endDistance:y}}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NoopLogger=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){(0,n.default)(this,e)}),[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]);t.NoopLogger=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectAnimAttribute=t.NumberAnimAttribute=t.BaseAnimAttribute=void 0;var n=i(r(9)),a=i(r(8)),o=i(r(10)),s=i(r(1)),l=i(r(2)),c=i(r(5)),u=r(53);function d(e,t,r){return t=(0,a.default)(t),(0,n.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,a.default)(e).constructor):t.apply(e,r))}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var m=(0,l.default)((function e(t,r){(0,s.default)(this,e),(0,c.default)(this,"m_id",void 0),(0,c.default)(this,"m_aggregateRule",void 0),(0,c.default)(this,"m_evaluators",void 0),(0,c.default)(this,"m_fHasCachedValue",void 0),this.m_id=t,this.m_evaluators=[],this.m_aggregateRule=r,this.m_fHasCachedValue=!1}),[{key:"registerAnimEvaluator",value:function(e){this.m_evaluators.push(e)}},{key:"mergeWith",value:function(e){if(this!==e){if(this.m_aggregateRule===u.AnimAggregateRule.BaselineOnly)this.m_aggregateRule=e.AggregateRule;else if(this.m_aggregateRule!==e.AggregateRule)return;var t,r=h(e.Evaluators);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.registerAnimEvaluator(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"AttrId",get:function(){return this.m_id}},{key:"Evaluators",get:function(){return this.m_evaluators}},{key:"AggregateRule",get:function(){return this.m_aggregateRule}},{key:"clearCachedValue",value:function(){this.m_fHasCachedValue=!1}}]);t.BaseAnimAttribute=m;var p=function(e){function t(e,r,i){var n;return(0,s.default)(this,t),n=d(this,t,[e,i]),(0,c.default)(n,"m_baseLineValue",void 0),(0,c.default)(n,"m_cachedValue",void 0),n.m_baseLineValue=r,n}return(0,o.default)(t,e),(0,l.default)(t,[{key:"fUpdateAggregateValue",value:function(e){var t=this.m_baseLineValue;switch(this.m_aggregateRule){case u.AnimAggregateRule.Add:var r,i=h(this.m_evaluators);try{for(i.s();!(r=i.n()).done;)t+=r.value.evaluate(e,0)}catch(e){i.e(e)}finally{i.f()}break;case u.AnimAggregateRule.Mult:var n,a=h(this.m_evaluators);try{for(a.s();!(n=a.n()).done;)t*=n.value.evaluate(e,this.m_baseLineValue)}catch(e){a.e(e)}finally{a.f()}break;case u.AnimAggregateRule.First:var o,s=h(this.m_evaluators);try{for(s.s();!(o=s.n()).done&&(t=o.value.evaluate(e,this.m_baseLineValue))===this.m_baseLineValue;);}catch(e){s.e(e)}finally{s.f()}break;case u.AnimAggregateRule.Last:for(var l=this.m_evaluators.length-1;l>=0&&(t=this.m_evaluators[l].evaluate(e,this.m_baseLineValue))===this.m_baseLineValue;l-=1);break;case u.AnimAggregateRule.BaselineOnly:}var c=this.m_cachedValue!==t||!this.m_fHasCachedValue;return c&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),c}},{key:"Value",get:function(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baseLineValue}}])}(m);t.NumberAnimAttribute=p;var g=function(e){function t(e,r,i){var n;return(0,s.default)(this,t),n=d(this,t,[e,i]),(0,c.default)(n,"m_baselineValue",void 0),(0,c.default)(n,"m_cachedValue",void 0),n.m_baselineValue=r,n.m_cachedValue=null,n}return(0,o.default)(t,e),(0,l.default)(t,[{key:"fUpdateAggregateValue",value:function(e){var t=this.m_baselineValue;switch(this.m_aggregateRule){case u.AnimAggregateRule.First:var r,i=h(this.m_evaluators);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.EvalId===u.AnimEvaluatorId.ConstantObject&&(t=n.evaluateObject(e,this.m_baselineValue))!==this.m_baselineValue)break}}catch(e){i.e(e)}finally{i.f()}break;case u.AnimAggregateRule.Last:for(var a=this.m_evaluators.length-1;a>=0;a-=1){var o=this.m_evaluators[a];if(o.EvalId===u.AnimEvaluatorId.ConstantObject&&(t=o.evaluateObject(e,this.m_baselineValue))!==this.m_baselineValue)break}break;case u.AnimAggregateRule.Add:case u.AnimAggregateRule.Mult:case u.AnimAggregateRule.BaselineOnly:}var s=this.m_cachedValue!==t||!this.m_fHasCachedValue;return s&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),s}},{key:"Value",get:function(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baselineValue}}])}(m);t.ObjectAnimAttribute=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return h.default}});var n=i(r(306)),a=i(r(308)),o=i(r(310)),s=i(r(311)),l=i(r(313)),c=i(r(314)),u=i(r(92)),d=i(r(91)),h=i(r(163))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getProviderName=function(e){for(var t=0,r=Object.entries(m.ONLINE_VIDEO_PROVIDER_URL_SCHEMES);t<r.length;t++){var i,n=(0,a.default)(r[t],2),o=n[0],s=p(n[1]);try{for(s.s();!(i=s.n()).done;){var l=i.value;if(new RegExp(l).test(e))return o}}catch(e){s.e(e)}finally{s.f()}}f.Log.error(512271065,"Error getting provider name from URL (scheme not found in ONLINE_PROVIDER_URL_SCHEMES)")},t.requestHubbleMediaOEmbed=function(e,t){return(0,h.__awaiter)(this,void 0,void 0,n.default.mark((function r(){var i,a,o,s,l;return n.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=y(t,m.HUBBLE_MEDIAOEMBEDVIDEO_URI),a=_(t),i.searchParams.set("url",e),r.next=5,fetch(i.toString(),{method:"GET",headers:a});case 5:return o=r.sent,r.next=8,o.json();case 8:if(s=r.sent,o.ok){r.next=13;break}throw l="status: ".concat(o.status),void 0!==s.Error&&void 0!==s.Error.Message&&(l+=", message: ".concat(s.Error.Message)),new v(o.status,l);case 13:return r.abrupt("return",s);case 14:case"end":return r.stop()}}),r)})))},t.requestOEmbedProviderList=function(e){return(0,h.__awaiter)(this,void 0,void 0,n.default.mark((function t(){var r,i,a,o;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=y(e,m.HUBBLE_GETOEMBEDPROVIDERS_URI),i=_(e),r.searchParams.set("type","video"),r.searchParams.set("displayname","1"),r.searchParams.set("endpoints","1"),r.searchParams.set("requirements","1"),t.next=8,fetch(r.toString(),{method:"GET",headers:i});case 8:return a=t.sent,t.next=11,a.json();case 11:if(o=t.sent,a.ok){t.next=14;break}throw new v(a.status,"status: ".concat(a.status));case 14:return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t)})))},t.HubbleError=void 0;var n=i(r(6)),a=i(r(19)),o=i(r(2)),s=i(r(1)),l=i(r(9)),c=i(r(8)),u=i(r(10)),d=i(r(322)),h=r(24),f=r(17),m=r(43);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var v=function(e){function t(e,r){var i;return(0,s.default)(this,t),(i=function(e,t,r){return t=(0,c.default)(t),(0,l.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}(this,t,[r])).statusCode=e,i}return(0,u.default)(t,e),(0,o.default)(t)}((0,d.default)(Error));function y(e,t){if(void 0===e.apiBaseUrl)throw new Error("Hubble API base URL is undefined");var r=new URL(e.apiBaseUrl);if(r.pathname=t,void 0!==e.app){var i=function(e){if(void 0!==e)switch(e){case"Word":return"0";case"Excel":return"1";case"Teams":case"PowerPoint":return"3";case"Outlook":return"5";case"OneNote":return"8";case"Publisher":return"10";case"Visio":return"12";case"SharePoint":return"1001";default:return}}(e.app);void 0!==i&&r.searchParams.set("app",i)}return void 0!==e.appPlatform&&r.searchParams.set("platform",e.appPlatform),r}function _(e){var t=new Headers;return void 0!==e.correlationId&&t.set(m.HEADER_CORRELATION_ID,e.correlationId),void 0!==e.acceptLanguage&&t.set(m.HEADER_ACCEPT_LANGUAGE,e.acceptLanguage),void 0!==e.aadToken&&t.set(m.HEADER_AUTHORIZATION,e.aadToken),t.set(m.HEADER_CONTENT_TYPE,"application/json; charset=utf-8"),t}t.HubbleError=v},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeAsync=function(e){return m.apply(this,arguments)},t.disposePrograms=function(e){if(!e)throw(0,s.logError)("Engine should be defined.");var t=(0,l.getEnginesPrograms)(e);if(t)for(var r=0;r<l.ProgramId.count;r++){var i=t[r];i&&i.dispose(),t[r]=void 0}},Object.defineProperty(t,"ThinEngine",{enumerable:!0,get:function(){return f.ThinEngine}});var n=i(r(6)),a=i(r(7)),o=r(88),s=r(21),l=r(22);r(358);var c=r(359),u=r(172),d=r(361),h=r(40),f=r(62);function m(){return(m=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.BabylonImportedModules.VertexBuffer=d.VertexBuffer,u.BabylonImportedModules.InternalTexture=h.InternalTexture,(0,c.applyEngineExtensions)(),t){e.next=5;break}throw(0,s.logError)("Engine should be defined.");case 5:if(!(0,l.getEnginesPrograms)(t)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,p(t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=(0,a.default)(n.default.mark((function e(t){var r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],(0,l.getEnginesPrograms)(t)||(l.ShaderProgramsByEngine[t.transitionId]=new Array(l.ProgramId.count)),i=0;i<l.ProgramId.count;i++)r.push(v(t,i));return e.abrupt("return",Promise.all(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return y.apply(this,arguments)}function y(){return(y=(0,a.default)(n.default.mark((function e(t,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,l.getEnginesPrograms)(t)){e.next=3;break}throw(0,s.logError)("Shader Programs should be defined.");case 3:return i[r]||(i[r]=_(t,r)),e.abrupt("return",new Promise((function(e,t){var n,a,o;null!==(n=i[r])&&void 0!==n&&n.isReady()?e():(null===(a=i[r])||void 0===a||a.onCompileObservable.add((function(){return e()})),null===(o=i[r])||void 0===o||o.onErrorObservable.add(t))})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){var r=l.ShaderDefinition[t];return new o.Effect({vertexSource:r.code.v,fragmentSource:r.code.f},r.a,r.u,r.s,e,void 0,void 0,void 0,(function(e,r){!function(e,t,r){if(r){var i="Program ".concat(e," "),n=t.getPipelineContext();n.vertexCompilationError&&(0,s.logError)("".concat(i," V compile failed: ").concat(n.vertexCompilationError)),n.fragmentCompilationError&&(0,s.logError)("".concat(i," F compile failed: ").concat(n.fragmentCompilationError)),n.programLinkError&&(0,s.logError)("".concat(i," link failed: ").concat(n.programLinkError)),n.programValidationError&&(0,s.logError)("".concat(i," validation failed: ").concat(n.programValidationError)),(0,s.logError)("".concat(i," preparation failed: ").concat(r))}}(t,e,r)}),void 0,(0,l.getEffectKey)(t))}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryReport=void 0;var n=i(r(2)),a=i(r(1)),o=(0,n.default)((function e(){(0,a.default)(this,e),this.textures={count:0},this.buffers={count:0},this.vaos={count:0}}));t.MemoryReport=o},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0,t.ErrorCode=i,function(e){e.SetupWebGLContextFailed="SetupWebGLContextFailed",e.RestoreWebGLContextFailed="RestoreWebGLContextFailed",e.CannotLoadTextureNoWebGLContext="CannotLoadTextureNoWebGLContext",e.CreateTextureFailed="CreateTextureFailed",e.CannotLoadImageTexture="CannotLoadImageTexture",e.FailedToRenderContextLost="FailedToRenderContextLost",e.FailedToRenderSBNotReady="FailedToRenderSBNotReady",e.FailedToRenderMissingSceneView="FailedToRenderMissingSceneView",e.TexturesNotLoaded="TexturesNotLoaded",e.MissingSceneView="MissingSceneView",e.TryPrepareTimeout="TryPrepareTimeout"}(i||(t.ErrorCode=i={}))},function(e,t,r){"use strict";var i,n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.UIHostType=t.SlideShowRole=t.OsfControlTarget=void 0,t.OsfControlTarget=i,function(e){e[e.Undefined=-1]="Undefined",e[e.InContent=0]="InContent",e[e.TaskPane=1]="TaskPane",e[e.Contextual=2]="Contextual"}(i||(t.OsfControlTarget=i={})),t.SlideShowRole=n,function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(n||(t.SlideShowRole=n={})),t.UIHostType=a,function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.Unknown=4]="Unknown"}(a||(t.UIHostType=a={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiResponseKeyStrings=t.EventRegistrationParams=t.AppForOfficeApiAdapter=void 0;var i=r(3),n=function(){function e(e,t){this.m_methodFactory=e,this.m_eventStore=t,this.m_eventStore}return e.prototype.InvokeDdaMethod=function(e,t,r){var n=e.DdaMethod.DispatchId,a=this.m_methodFactory.getApiMethod(n);null!=a?(a.Parameters=e,a.Callback=t,a.AdditionalParameters=r,a.AppId=e.DdaMethod.ControlId,a.go()):(i.ULS.sendTraceTag(508688329,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Error,"API Call for method ID ".concat(n," does not exist.")),this.callbackWithInternalFailure(t))},e.prototype.RegisterDdaEventAsync=function(e,t,r,n,a){var o=this.m_eventStore.getApiEvent(e);null!=o?o.addHandler(t,n,a,r):(i.ULS.sendTraceTag(508688328,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Error,"Event for dispatch ID ".concat(e," does not exist.")),this.callbackWithInternalFailure(a))},e.prototype.UnregisterDdaEventAsync=function(e,t,r,n,a){var o=this.m_eventStore.getApiEvent(e);null!=o?o.removeHandler(t,n,a,r):(i.ULS.sendTraceTag(508688327,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Error,"Event for dispatch ID ".concat(e,"  does not exist:")),this.callbackWithInternalFailure(a))},e.prototype.callbackWithInternalFailure=function(e){if(null!=e){var t={};t[a.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e(t)}},e}();t.AppForOfficeApiAdapter=n;t.EventRegistrationParams=function(e,t,r,i,n){this.EventDispId=e,this.ControlId=t,this.TargetId=r,this.Handler=i,this.Callback=n};var a=function(){function e(){}return e.c_Error="Error",e}();t.ApiResponseKeyStrings=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateViewingEnterSource=t.SyncEventSource=t.AppSessionLoggingConstants=void 0;var n,a,o=i(r(2)),s=i(r(1)),l=(0,o.default)((function e(){(0,s.default)(this,e)}));t.AppSessionLoggingConstants=l,l.skewEmitter="Skew_Emitter",l.skewReceiver="Skew_Receiver",l.teamsNotified="Teams_Notified",l.teamsLocal="Teams_Local",l.elapsedTime="Total_Elapsed_MS",l.mediaEventEmitted="PPT_ModernSS_Emit_Media",l.mediaEventCompleted="PPT_ModernSS_Complete_Media",l.mediaEventOutOfOrder="Media_Event_Out_Of_Order",l.mediaEventDuplicate="Media_Event_Duplicate",l.stateNotified="State_Notified",l.stateLocal="State_Local",l.annotationEventEmitted="PPT_ModernSS_Emit_Annotation",l.annotationEventCompleted="PPT_ModernSS_Complete_Annotation",l.bootstrapperNotified="Bootstrapper_Notified",l.bootstrapperLocal="Bootstrapper_Local",l.ic3Notified="Teams_Notified_IC3",l.ic3Local="Teams_Local_IC3",l.mediaEventType="mediaEventType",l.mediaSyncTimeLine="mediaSyncTimeLine",l.senderId="senderId",l.senderIdSystem="system",l.syncEventEmitTime="PPT_ModernSS_Emit_Time_Ms",l.syncEventCompleteTime="PPT_ModernSS_Complete_Time_Ms",t.SyncEventSource=n,function(e){e.Unknown="srcUNKNOWN",e.Teams="srcTEAMS",e.State="srcSTATE"}(n||(t.SyncEventSource=n={})),t.PrivateViewingEnterSource=a,function(e){e.Media="Media",e.SyncStateManager="SyncStateManager"}(a||(t.PrivateViewingEnterSource=a={}))},function(e,t,r){"use strict";(function(e){var i,n=r(0)(r(15));!function(a,o){var s="model",l="name",c="type",u="vendor",d="version",h="mobile",f="tablet",m="smarttv",p=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},g=function(e,t){return"string"===(0,n.default)(e)&&-1!==v(t).indexOf(v(e))},v=function(e){return e.toLowerCase()},y=function(e,t){if("string"===(0,n.default)(e))return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),"undefined"===(0,n.default)(t)?e:e.substring(0,255)},_=function(e,t){for(var r,i,a,o,s,l,c=0;c<t.length&&!s;){var u=t[c],d=t[c+1];for(r=i=0;r<u.length&&!s;)if(s=u[r++].exec(e))for(a=0;a<d.length;a++)l=s[++i],o=d[a],"object"===(0,n.default)(o)&&o.length>0?2===o.length?"function"==(0,n.default)(o[1])?this[o[0]]=o[1].call(this,l):this[o[0]]=o[1]:3===o.length?"function"!==(0,n.default)(o[1])||o[1].exec&&o[1].test?this[o[0]]=l?l.replace(o[1],o[2]):void 0:this[o[0]]=l?o[1].call(this,l,o[2]):void 0:4===o.length&&(this[o[0]]=l?o[3].call(this,l.replace(o[1],o[2])):void 0):this[o]=l||void 0;c+=2}},S=function(e,t){for(var r in t)if("object"===(0,n.default)(t[r])&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(g(t[r][i],e))return"?"===r?void 0:r}else if(g(t[r],e))return"?"===r?void 0:r;return e},T={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},b={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,d],[/opios[\/ ]+([\w\.]+)/i],[d,[l,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[d,[l,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[l,d],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[d,[l,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[d,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[d,[l,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure Browser"],d],[/\bfocus\/([\w\.]+)/i],[d,[l,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[d,[l,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[d,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[l,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[d,[l,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[d,[l,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],d],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,d],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,"Facebook"],d],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,d],[/\bgsa\/([\w\.]+) .*safari\//i],[d,[l,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[d,[l,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,"Chrome WebView"],d],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[d,[l,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,d],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[d,[l,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[d,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[d,S,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,d],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],d],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[d,[l,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[l,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",v]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",v]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",v]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[s,[u,"Samsung"],[c,f]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[s,[u,"Samsung"],[c,h]],[/\((ip(?:hone|od)[\w ]*);/i],[s,[u,"Apple"],[c,h]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[s,[u,"Apple"],[c,f]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[s,[u,"Huawei"],[c,f]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[s,[u,"Huawei"],[c,h]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[s,/_/g," "],[u,"Xiaomi"],[c,h]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[s,/_/g," "],[u,"Xiaomi"],[c,f]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[s,[u,"OPPO"],[c,h]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[s,[u,"Vivo"],[c,h]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[s,[u,"Realme"],[c,h]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[s,[u,"Motorola"],[c,h]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[s,[u,"Motorola"],[c,f]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[s,[u,"LG"],[c,f]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[s,[u,"LG"],[c,h]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[s,[u,"Lenovo"],[c,f]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[s,/_/g," "],[u,"Nokia"],[c,h]],[/(pixel c)\b/i],[s,[u,"Google"],[c,f]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[s,[u,"Google"],[c,h]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[u,"Sony"],[c,h]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[s,"Xperia Tablet"],[u,"Sony"],[c,f]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[s,[u,"OnePlus"],[c,h]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[s,[u,"Amazon"],[c,f]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[s,/(.+)/g,"Fire Phone $1"],[u,"Amazon"],[c,h]],[/(playbook);[-\w\),; ]+(rim)/i],[s,u,[c,f]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[s,[u,"BlackBerry"],[c,h]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[s,[u,"ASUS"],[c,f]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[s,[u,"ASUS"],[c,h]],[/(nexus 9)/i],[s,[u,"HTC"],[c,f]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[u,[s,/_/g," "],[c,h]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[s,[u,"Acer"],[c,f]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[s,[u,"Meizu"],[c,h]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[s,[u,"Sharp"],[c,h]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[u,s,[c,h]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[u,s,[c,f]],[/(surface duo)/i],[s,[u,"Microsoft"],[c,f]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[s,[u,"Fairphone"],[c,h]],[/(u304aa)/i],[s,[u,"AT&T"],[c,h]],[/\bsie-(\w*)/i],[s,[u,"Siemens"],[c,h]],[/\b(rct\w+) b/i],[s,[u,"RCA"],[c,f]],[/\b(venue[\d ]{2,7}) b/i],[s,[u,"Dell"],[c,f]],[/\b(q(?:mv|ta)\w+) b/i],[s,[u,"Verizon"],[c,f]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[s,[u,"Barnes & Noble"],[c,f]],[/\b(tm\d{3}\w+) b/i],[s,[u,"NuVision"],[c,f]],[/\b(k88) b/i],[s,[u,"ZTE"],[c,f]],[/\b(nx\d{3}j) b/i],[s,[u,"ZTE"],[c,h]],[/\b(gen\d{3}) b.+49h/i],[s,[u,"Swiss"],[c,h]],[/\b(zur\d{3}) b/i],[s,[u,"Swiss"],[c,f]],[/\b((zeki)?tb.*\b) b/i],[s,[u,"Zeki"],[c,f]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[u,"Dragon Touch"],s,[c,f]],[/\b(ns-?\w{0,9}) b/i],[s,[u,"Insignia"],[c,f]],[/\b((nxa|next)-?\w{0,9}) b/i],[s,[u,"NextBook"],[c,f]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[u,"Voice"],s,[c,h]],[/\b(lvtel\-)?(v1[12]) b/i],[[u,"LvTel"],s,[c,h]],[/\b(ph-1) /i],[s,[u,"Essential"],[c,h]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[s,[u,"Envizen"],[c,f]],[/\b(trio[-\w\. ]+) b/i],[s,[u,"MachSpeed"],[c,f]],[/\btu_(1491) b/i],[s,[u,"Rotor"],[c,f]],[/(shield[\w ]+) b/i],[s,[u,"Nvidia"],[c,f]],[/(sprint) (\w+)/i],[u,s,[c,h]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[u,"Microsoft"],[c,h]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[s,[u,"Zebra"],[c,f]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[s,[u,"Zebra"],[c,h]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[u,s,[c,"console"]],[/droid.+; (shield) bui/i],[s,[u,"Nvidia"],[c,"console"]],[/(playstation [345portablevi]+)/i],[s,[u,"Sony"],[c,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[s,[u,"Microsoft"],[c,"console"]],[/smart-tv.+(samsung)/i],[u,[c,m]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[u,"Samsung"],[c,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[u,"LG"],[c,m]],[/(apple) ?tv/i],[u,[s,"Apple TV"],[c,m]],[/crkey/i],[[s,"Chromecast"],[u,"Google"],[c,m]],[/droid.+aft(\w)( bui|\))/i],[s,[u,"Amazon"],[c,m]],[/\(dtv[\);].+(aquos)/i],[s,[u,"Sharp"],[c,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[u,y],[s,y],[c,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[c,m]],[/((pebble))app/i],[u,s,[c,"wearable"]],[/droid.+; (glass) \d/i],[s,[u,"Google"],[c,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[s,[u,"Zebra"],[c,"wearable"]],[/(quest( 2)?)/i],[s,[u,"Facebook"],[c,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[u,[c,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[s,[c,h]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[s,[c,f]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[c,f]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[c,h]],[/(android[-\w\. ]{0,9});.+buil/i],[s,[u,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[d,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[l,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,d],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[d,S,T]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[d,S,T]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"],[d,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[d,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,d],[/\(bb(10);/i],[d,[l,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[d,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[d,[l,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[l,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[l,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[l,"Chromium OS"],d],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,d],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],d],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[l,d]]},C=function e(t,r){if("object"===(0,n.default)(t)&&(r=t,t=void 0),!(this instanceof e))return new e(t,r).getResult();var i=t||("undefined"!==(0,n.default)(a)&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:""),o=r?function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r}(b,r):b;return this.getBrowser=function(){var e,t={name:void 0,version:void 0};return _.call(t,i,o.browser),t.major=(e=t.version,"string"===(0,n.default)(e)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0),t},this.getCPU=function(){var e={architecture:void 0};return _.call(e,i,o.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return _.call(e,i,o.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return _.call(e,i,o.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return _.call(e,i,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i="string"===(0,n.default)(e)&&e.length>255?y(e,255):e,this},this.setUA(i),this};C.VERSION="0.7.31",C.BROWSER=p([l,d,"major"]),C.CPU=p(["architecture"]),C.DEVICE=p([s,u,c,"console",h,m,f,"wearable","embedded"]),C.ENGINE=C.OS=p([l,d]),"undefined"!==(0,n.default)(t)?("undefined"!==(0,n.default)(e)&&e.exports&&(t=e.exports=C),t.UAParser=C):"function"===(0,n.default)(r(396))&&r(397)?void 0===(i=function(){return C}.call(t,r,t,e))||(e.exports=i):"undefined"!==(0,n.default)(a)&&(a.UAParser=C);var w="undefined"!==(0,n.default)(a)&&(a.jQuery||a.Zepto);if(w&&!w.ua){var P=new C;w.ua=P.getResult(),w.ua.get=function(){return P.getUA()},w.ua.set=function(e){P.setUA(e);var t=P.getResult();for(var r in t)w.ua[r]=t[r]}}}("object"===("undefined"==typeof window?"undefined":(0,n.default)(window))?window:this)}).call(this,r(99)(e))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaAddon=void 0;var n=i(r(1)),a=i(r(2)),o=r(46),s=r(3),l=r(121),c=r(82),u=r(58),d=r(14);function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var m=function(){function e(t,r,i,a,o){(0,n.default)(this,e),this.m_slideShowCore=t,this.m_mediaStateMap=new Map,s.ULS.setLogger(r),this.m_slideShowAppEvents=i,this.m_sourceIdentifier=l.PrivateViewingEnterSource.Media,this.m_slideShowRole=a,this.m_slideShowUIEvents=o,this.registerAppEventListeners()}return(0,a.default)(e,[{key:"updateMediaStateCache",value:function(t){var r=this.m_mediaStateMap.has(t.mediaName)?"Updated MediaStateCache With Received State":"Set New MediaStateCache With Received State",i=0;t.metadata&&t.metadata.timeStamps&&(i=t.metadata.timeStamps.Total_Elapsed_MS),this.m_mediaStateMap.set(t.mediaName,{mediaSyncState:t,lastCacheUpdateTimestampMs:Date.now(),latencyTimeMs:i}),e.updateMediaSyncMetadataAndLog(r,"MediaAddon",t)}},{key:"shouldSendMediaSyncMessage",value:function(e,t){var r=this.m_slideShowRole===c.SlideShowRole.Presenter?"Passing":"Blocking";return s.ULS.sendTraceTag(527257823,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"MediaAddon: ".concat(r," Media Sync ").concat(t?"Initial State":"Event",": ").concat(JSON.stringify(e))),this.m_slideShowRole===c.SlideShowRole.Presenter}},{key:"isInPrivateViewing",value:function(){return this.m_slideShowRole===c.SlideShowRole.PrivateViewing}},{key:"registerAppEventListeners",value:function(){var e=this;this.m_slideShowCore.events.on("mediaInitState",(function(t){e.onMediaInitState(t.mediaSlideInfo,t.mediaSyncInitState)})),this.m_slideShowAppEvents.on("cleanupMediaStateCache",(function(t){return e.cleanupMediaStateCache(t.isNavTriggerSSInBoundMessage,t.mediaNamesBySlideId)})),this.m_slideShowAppEvents.on("returnToPresenterUpdateAllMedia",(function(t){return e.returnToPresenterUpdateAllMedia(t.slideId,t.slideIndex)})),this.registerSlideShowUIEvents()}},{key:"returnToPresenterUpdateAllMedia",value:function(e,t){var r=this;if(t){var i=this.m_slideShowCore.getMediaNamesBySlideIndex(t);this.cleanupMediaStateCache(!0,i)}this.m_mediaStateMap.forEach((function(t,i){if(e){var n={slideId:e,mediaName:i};r.sendUpdatedMediaState(t,n)}else r.sendUpdatedMediaState(t)}))}},{key:"onMediaInitState",value:function(e,t){s.ULS.sendTraceTag(544285633,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"MediaAddon::onMediaInitState: Received mediaInitState event from media in slide: ".concat(JSON.stringify(e),", initState: ").concat(JSON.stringify(t)));var r=t.mediaName;this.m_mediaStateMap.get(r)?(s.ULS.sendTraceTag(523776394,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"MediaAddon::onMediaInitState: Discard local mediaInitState ".concat(JSON.stringify(t)," and update media with state cached ").concat(JSON.stringify(this.m_mediaStateMap.get(r)))),this.updateMediaState(e)):this.shouldSendMediaSyncMessage(t,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",t)}},{key:"updateMediaState",value:function(e){if(this.m_slideShowRole!==c.SlideShowRole.PrivateViewing){var t=e.mediaName,r=this.m_mediaStateMap.get(t);this.sendUpdatedMediaState(r,e,!0)}}},{key:"sendUpdatedMediaState",value:function(t,r,i){if(void 0!==t){this.addTimeToPlayerPositionSkew(t),t.mediaSyncState.origin.isFromLocalCache=!0;var n="Passing Media State to SlideShowCore on ".concat(i?"Player Ready":"Sync Back To Presenter");e.updateMediaSyncMetadataAndLog(n,"MediaAddon",t.mediaSyncState),s.ULS.sendTraceTag(556372385,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"MediaAddOn: Retrieving cached Media Sync state (".concat(JSON.stringify(t.mediaSyncState),")")),this.m_slideShowCore.updateMediaState(t.mediaSyncState,r)}}},{key:"addTimeToPlayerPositionSkew",value:function(e){var t=e.mediaSyncState;t.state.playerState===o.MediaPlayerState.MediaPlayed&&(t.state.playerPositionSkew=e.latencyTimeMs+Date.now()-e.lastCacheUpdateTimestampMs)}},{key:"cleanupMediaStateCache",value:function(e,t){if(e||this.m_slideShowRole===c.SlideShowRole.Presenter){if(!t)return void(this.m_slideShowRole===c.SlideShowRole.Presenter&&this.m_mediaStateMap.clear());var r,i=h(this.m_mediaStateMap.keys());try{for(i.s();!(r=i.n()).done;){var n=r.value;t.includes(n)||this.m_mediaStateMap.delete(n)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"registerSlideShowUIEvents",value:function(){var e=this;this.m_slideShowUIEvents&&this.m_slideShowUIEvents.on("roleChanged",(function(t){var r=e.m_slideShowRole;e.m_slideShowRole=t,t===c.SlideShowRole.Presenter&&r!==c.SlideShowRole.Presenter&&e.emitStateOfMediaInSlide();var i=t===c.SlideShowRole.Presenter;e.updateVideoPlayButtonVisibility(i),e.updateMediaCommandScope()}))}},{key:"emitStateOfMediaInSlide",value:function(){var e=this.m_slideShowCore.getSlideLocation();if(void 0!==e){var t=this.m_slideShowCore.getMediaNamesBySlideIndex(e.slideIndex);if(t){var r,i=h(t);try{for(i.s();!(r=i.n()).done;){var n=r.value,a=this.m_slideShowCore.getMediaCurrentState(n);if(a){var s=this.m_slideShowCore.getMediaInfo(n);if(!s||!s.isLoopingBackgroundVideo){var l={mediaName:n,state:a,origin:{hostName:s?o.MediaType[s.type]:"undefined",isInitial:!1,isFromRoleChange:!0},correlationId:(0,u.v4)()};this.m_slideShowCore.getGlobalMute()&&(l.state.muted=void 0),this.shouldSendMediaSyncMessage(l,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",l)}}}}catch(e){i.e(e)}finally{i.f()}}}}},{key:"slideShowUIEvents",get:function(){return this.m_slideShowUIEvents},set:function(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}},{key:"onUserMediaAction",value:function(e){if(this.m_slideShowRole===c.SlideShowRole.Attendee){var t;switch(e.actionType){case o.UserMediaActionType.PauseButtonClick:case o.UserMediaActionType.PlayButtonClick:case o.UserMediaActionType.ProgressSliderInput:case o.UserMediaActionType.CustomPlayButtonClick:case o.UserMediaActionType.VideoFrameClick:t=!0;break;default:t=!1}var r=!0,i=!0,n=e.mediaName,a=this.m_slideShowCore.getSlideLocation();if(a){var l=this.m_slideShowCore.getMediaNamesBySlideIndex(a.slideIndex);l&&-1!==l.indexOf(n)||(r=!1,i=!1)}else s.ULS.sendTraceTag(520148322,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"MediaAddon::onUserMediaAction: Couldn't check if media ".concat(e.mediaName," is in the current slide"));this.m_slideShowCore.getMediaCurrentState(e.mediaName)||(i=!1),r?i||e.actionType===o.UserMediaActionType.CustomPlayButtonClick||s.ULS.sendTraceTag(520148320,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't ready \n          (actionInfo: ".concat(JSON.stringify(e),")")):s.ULS.sendTraceTag(520148321,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't in the current slide \n          (actionInfo: ".concat(JSON.stringify(e),")")),t&&(s.ULS.sendTraceTag(520148319,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"MediaAddon::onUserMediaAction: Entering Private Viewing mode (actionInfo: ".concat(JSON.stringify(e),")")),this.m_slideShowAppEvents.emit("requestPrivateViewingChanged",{isInPrivateViewing:!0,source:this.m_sourceIdentifier}),r&&(i||e.actionType===o.UserMediaActionType.CustomPlayButtonClick)||d.VetoUtils.recordVeto("Media_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",isMediaOnCurrentSlide:r,isMediaReady:i,actionInfo:e}))}}},{key:"updateVideoPlayButtonVisibility",value:function(e){this.m_slideShowCore.setVideoPlayButtonVisibility(e)}},{key:"updateMediaCommandScope",value:function(){this.m_slideShowCore.setMediaCommandScope(this.m_slideShowRole===c.SlideShowRole.Presenter?o.MediaCommandScope.All:o.MediaCommandScope.Local)}}],[{key:"updateMediaSyncMetadataAndLog",value:function(e,t,r){if(r.metadata&&r.metadata.mediaSyncTimeLine){var i="".concat(t,": ").concat(e);r.metadata.mediaSyncTimeLine.push(i),s.ULS.sendTraceTag(524853467,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,JSON.stringify({fileName:t,mediaSyncState:r}))}else s.ULS.sendTraceTag(524853466,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,"".concat(t,"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine."))}}])}();t.MediaAddon=m},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PerfCheckerAddon=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(4),u=r(80),d=r(11),h=r(67);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=function(){function e(t,r,i){(0,o.default)(this,e),this.m_startedTests=!1,this.m_isAnimating=!1,this.m_runTestsTimeoutId=0,this.m_slideshowCore=t;var n=r.slideShowCoreSettings.settings;c.Settings.load(n?n.slideshowcore:{}),l.ULS.setLogger(i),d.ChangeGate.initSettings({disabledChangeGates:r.slideShowCoreSettings.disabledChangeGates||""}),this.m_settings=r,t.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),t.events.on("animationStateChanging",this.logFrameData.bind(this)),d.ChangeGate.isChangeGateEnabled("SSC.bootPayloadTest")&&this.bootPayloadTest()}return(0,s.default)(e,[{key:"logFrameData",value:function(e){this.m_isAnimating=e.isAnimating}},{key:"onSlideLocationChanged",value:function(e){this.m_startedTests||(window.clearTimeout(this.m_runTestsTimeoutId),window.setTimeout(this.runTestsAsync.bind(this),1e3*c.Settings.readNumberOrDefault("perfCheckerDelaySec",60)))}},{key:"runTestsAsync",value:(p=(0,a.default)(n.default.mark((function t(){var r;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.m_startedTests&&!this.m_isAnimating){t.next=2;break}return t.abrupt("return");case 2:if(this.m_startedTests=!0,(r=navigator.connection)&&(e.logNetworkInformation(r,!1),r.addEventListener("change",(function(){return e.logNetworkInformation(r,!0)}))),c.Settings.readBooleanOrDefault("cpuSpeedTestEnabled",!0)&&l.ULS.sendTraceTag(545378498,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon CPU Speed: ".concat(JSON.stringify(e.calculatePI(10)))),!c.Settings.readBooleanOrDefault("networkBandwidthTestEnabled",!1)||r&&r.saveData&&c.Settings.readBooleanOrDefault("respectSaveDataForTesting",!1)){t.next=9;break}return t.next=9,this.runNetworkBandwidthTestAsync();case 9:if(!c.Settings.readBooleanOrDefault("networkRttTestEnabled",!1)){t.next=12;break}return t.next=12,e.runNetworkRttTestAsync("".concat(this.m_settings.appSettings.serverUrl,"/podhandler.ashx?action=GetSessionUTC&format=jsms"));case 12:if(!c.Settings.readBooleanOrDefault("longRunningFramesTestEnabled",!0)){t.next=15;break}return t.next=15,this.longRunningFramesTestAsync();case 15:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"bootPayloadTest",value:function(){try{var t,r=this.m_settings.bootMetrics&&void 0!==this.m_settings.bootMetrics.aspxTime?this.m_settings.bootMetrics.aspxTime:this.m_settings.appSettings.initTime,i=[],n=0,a=0,o=0,s=0,c=f(performance.getEntriesByType("resource"));try{for(c.s();!(t=c.n()).done;){var u=t.value,d=e.sanitizeUrl(u.name),h=e.getJsonFromPerformanceEntry(u),m=h?h.encodedBodySize:0,p=d.toLowerCase();if("slideshowcore.js"===p||"slideshowcore.min.js"===p||"slideshowapp.js"===p)return n+=m,void l.ULS.sendTraceTag(545052236,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon Boot Payload: ".concat(JSON.stringify({totalSize:n,bootJsSize:m,jsSize:a,cssSize:o,otherSize:s,timings:i})));if(u.startTime>r){var g={name:d,encodedSize:m,startTime:u.startTime,duration:u.duration};i.push(g),n+=g.encodedSize,d.endsWith(".js")?a+=g.encodedSize:d.endsWith(".css")?o+=g.encodedSize:s+=g.encodedSize}}}catch(e){c.e(e)}finally{c.f()}}catch(e){l.ULS.sendTraceTag(545051671,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon::bootPayloadTest exception: ".concat(e))}}},{key:"runNetworkBandwidthTestAsync",value:(m=(0,a.default)(n.default.mark((function t(){var r,i,a,o,s,u,d,m,p,g,v,y,_,S,T,b,C,w=arguments;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=w.length>0&&void 0!==w[0]?w[0]:0,i=w.length>1&&void 0!==w[1]?w[1]:0,a=1e3*c.Settings.readNumberOrDefault("networkEmptyWaitTimeForTestsSec",30),o=f(performance.getEntriesByType("resource")),t.prev=4,o.s();case 6:if((s=o.n()).done){t.next=17;break}if(!((u=s.value).name.indexOf("getitems.ashx")>=0&&performance.now()-u.responseEnd<a)){t.next=15;break}if(!(r<100)){t.next=14;break}return t.next=12,(0,h.waitMsAsync)(a);case 12:return t.next=14,this.runNetworkBandwidthTestAsync(r+1,i);case 14:return t.abrupt("return");case 15:t.next=6;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(4),o.e(t.t0);case 22:return t.prev=22,o.f(),t.finish(22);case 25:return d=performance.now(),m="https://cdn.hubblecontent.osi.office.net/getty/publish/transitions/curtainsdata.json?r=".concat(Date.now()),p=new AbortController,g=function(){return p.abort()},this.m_slideshowCore.events.on("slideLocationChanged",g),t.prev=30,t.next=33,fetch(m,{signal:p.signal});case 33:v=t.sent,t.next=40;break;case 36:t.prev=36,t.t1=t.catch(30),"AbortError"!==t.t1.name&&l.ULS.sendTraceTag(545122070,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PerfCheckerAddon Network Bandwidth: unexpected fetch exception: ".concat(t.t1));case 40:if(!v){t.next=44;break}return t.next=43,e.waitForPerformanceEntryAsync(m);case 43:y=t.sent;case 44:if(this.m_slideshowCore.events.off("slideLocationChanged",g),_=performance.now(),v&&y&&200===v.status){t.next=53;break}if(!(i<3)){t.next=52;break}return t.next=50,(0,h.waitMsAsync)(a);case 50:return t.next=52,this.runNetworkBandwidthTestAsync(r,i+1);case 52:return t.abrupt("return");case 53:S=!1,(T=Number(v.headers.get("content-length")))||(T=814493,S=!0),b=8*T/1048576,C=(y.responseEnd-y.responseStart)/1e3,l.ULS.sendTraceTag(545122072,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon Network Bandwidth: ".concat(JSON.stringify({estimatedMbps:b/C,actualTimeMs:Math.round(_-d),guessedContentLength:S,requestData:y})));case 59:case"end":return t.stop()}}),t,this,[[4,19,22,25],[30,36]])}))),function(){return m.apply(this,arguments)})},{key:"longRunningFramesTestAsync",value:(i=(0,a.default)(n.default.mark((function e(){var t,r,i,a=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:0,!this.m_isAnimating){e.next=8;break}if(!(t<100)){e.next=8;break}return e.next=5,(0,h.waitMsAsync)(3e4);case 5:return e.next=7,this.longRunningFramesTestAsync(t+1);case 7:return e.abrupt("return");case 8:return r=performance.now(),i=new u.AnimatedContentLogger({type:"LongRunningFramesTest",ignoreVeto:!0}),e.next=12,this.startMeasuringFramesAsync(r,i,t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"startMeasuringFramesAsync",value:function(e,t,r){var i=this;return new Promise((function(n){requestAnimationFrame((function(){return i.measureFrameAsync(e,t,r,n)}))}))}},{key:"measureFrameAsync",value:(r=(0,a.default)(n.default.mark((function e(t,r,i,a){var o=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.m_isAnimating){e.next=5;break}return e.next=3,this.longRunningFramesTestAsync(i);case 3:return a(),e.abrupt("return");case 5:if(!(performance.now()-t>c.Settings.readNumberOrDefault("longRunningFramesTestTimeLimitMs",1e4))){e.next=9;break}return r.logFrameData(!1),a(),e.abrupt("return");case 9:r.logFrameData(!0),requestAnimationFrame((function(){return o.measureFrameAsync(t,r,i,a)}));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,i,n){return r.apply(this,arguments)})}],[{key:"sanitizeUrl",value:function(e){try{if(!e)return"";var t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return""}}},{key:"logNetworkInformation",value:function(e,t){var r={isOnNetworkChanged:t,downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData};l.ULS.sendTraceTag(545122069,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon NetworkInformation: ".concat(JSON.stringify(r)))}},{key:"calculatePI",value:function(e){for(var t=0,r=0,i=performance.now(),n=1;r%100||performance.now()-i<e;)t+=4/n,t-=4/(n+=2),n+=2,r+=1;return{numIterations:r,timeLimitMs:e,pi:t}}},{key:"waitForPerformanceEntryAsync",value:function(t){return new Promise((function(r){var i,n=f(performance.getEntriesByType("resource"));try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.name===t)return void r(e.getJsonFromPerformanceEntry(a))}}catch(e){n.e(e)}finally{n.f()}var o=new PerformanceObserver((function(i){var n,a=f(i.getEntriesByType("resource"));try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s.name===t)return r(e.getJsonFromPerformanceEntry(s)),void o.disconnect()}}catch(e){a.e(e)}finally{a.f()}}));o.observe({entryTypes:["resource"]})}))}},{key:"getJsonFromPerformanceEntry",value:function(e){var t=e.toJSON();for(var r in t)"number"==typeof t[r]&&(t[r]=Math.round(t[r])),t.name=void 0;return t}},{key:"runNetworkRttTestAsync",value:(t=(0,a.default)(n.default.mark((function e(t){var r,i,a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,i=0,a=5,o=0;case 4:if(!(o<a)){e.next=13;break}return s=performance.now(),e.next=8,fetch(t);case 8:200===e.sent.status&&(r=performance.now()-s,i+=1);case 10:o+=1,e.next=4;break;case 13:l.ULS.sendTraceTag(545122073,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PerfCheckerAddon Network Rtt: ".concat(JSON.stringify({rttMs:Math.round(r/i),numSuccess:i,numAttempts:a})));case 14:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]);var t,r,i,m,p}();t.PerfCheckerAddon=p},function(e,t,r){var i=r(211);e.exports=function(e,t){if(null==e)return{};var r,n,a=i(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}},function(e,t,r){var i=r(126);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.makeStrokeFigures=S,t.changeCharactersInLine=T,t.changeCharacters=function(e,t,r,i){for(var n=0,a=0,o=0;o<e.paragraphs.length;o++){var l=e.paragraphs[o];if(t.contains(l.globalRange)&&t.start!=l.globalRange.start){if(l.lines.length>0)for(var u=o+1;u<e.paragraphs.length;u++)if(e.paragraphs[u].lines.length>0){a-=e.paragraphs[u].lines[0].layoutBounds.top-l.lines[0].layoutBounds.top;break}e.removeParagraph(o),o--}else{var d=l.globalRange.includes(t.start),h=t.move(-l.globalRange.start),f=h.getIntersection(new c.TextRange(0,l.globalRange.length));if(d||f){for(var m=0;m<l.lines.length;m++){var p=l.lines[m];if(!h.contains(p.localRange)||h.start==p.localRange.start&&0!=r.length){if(p.localRange.includes(h.start)){var g=h.getIntersection(p.localRange);g&&(T(p,g,r,i),n+=r.length-g.length)}else if(h.start<p.localRange.start){if(0!=a){var v=new s.Vector2(0,a);p.layoutBounds=p.layoutBounds.translate(v),p.offset=p.offset.add(v)}0!=n&&(p.localRange=new c.TextRange(p.localRange.start+n,p.characters.length));var y=h.move(n).getIntersection(p.localRange);y&&(T(p,y,[],i),n+=-y.length)}}else{a-=m+1<l.lines.length?l.lines[m+1].layoutBounds.top-p.layoutBounds.top:p.layoutBounds.height,n-=p.localRange.length;var _=l.lines.slice(0);_.splice(m),l.lines=_,m--}}l.globalRange.includes(t.start)?l.globalRange=new c.TextRange(l.globalRange.start,l.globalRange.length+n):l.globalRange=l.globalRange.move(t.last+1-l.globalRange.start)}else t.last<l.globalRange.start&&(0!=n&&(l.globalRange=l.globalRange.move(n)),0!=a&&(l.offset=new s.Vector2(l.offset.x,l.offset.y+a)));var S=d?r.length:0;f&&(l.stylePerLocalRange.shiftIndices(f,S),l.effectsPerLocalRange.shiftIndices(f,S),l.strokesPerLocalRange.shiftIndices(f,S))}}},t.adjustTextEffects=b,t.TextGeneratedShapesCache=void 0;var n=i(r(18)),a=i(r(1)),o=i(r(2)),s=r(12),l=r(27),c=r(39),u=r(13),d=r(30),h=r(70),f=r(16),m=r(36);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var v=(0,o.default)((function e(){(0,a.default)(this,e),this.textShapes=[],this.hitTestLineShapes=[]}),[{key:"clearCache",value:function(){var e,t=p(this.textShapes);try{for(t.s();!(e=t.n()).done;)e.value.clearCache()}catch(e){t.e(e)}finally{t.f()}var r,i=p(this.hitTestLineShapes);try{for(i.s();!(r=i.n()).done;)r.value.clearCache()}catch(e){i.e(e)}finally{i.f()}var n,a=p(this.selectionShapes||[]);try{for(a.s();!(n=a.n()).done;)n.value.clearCache()}catch(e){a.e(e)}finally{a.f()}}},{key:"getTextShapes",value:function(){return this.textShapes}},{key:"getSelectionShapes",value:function(){return this.selectionShapes||[]}},{key:"initShapeEffectsAndBoundsOverrides",value:function(e,t,r,i,n,a){if(t.effects=b(e.getEffetcsAt(n),r?r.textEffectMetrics:void 0,-e.frameToShape.rotation)||new h.Effects,!r.bender){if(e.applyEffectsPerCharacter||a){var o=e.getBoundsOfRange(new c.TextRange(n,1));t.effectsBoundsOverride=o,a&&t.style.fillBrush instanceof f.ImageBrush||(t.fillBoundsOverride=o)}else{var l=r.fillBounds.translate(i).transformedBounds(s.Matrix3.FromTransforms(e.layoutToFrame,e.frameToShape));t.effectsBoundsOverride=l,t.fillBoundsOverride=e.spreadFill?e.getBoundsOfRange(void 0):l}t.textEffectMetrics=r.textEffectMetrics}}},{key:"getTextShape",value:function(e,t){var r=e.getStyleAt(t.start),i=e.getTextPathsForRange(t,null==r?void 0:r.hasLine),n=new d.Shape(i,r),a=e.getLineAndParagraphAt(t.start);return a&&this.initShapeEffectsAndBoundsOverrides(e,n,a.line,a.line.offset.add(a.paragraph.offset),t.start,!1),n.role=d.ShapeRole.text,n.textRange=t,n.overlapMode=d.OverlapMode.winding,n.transform=e.frameToShape,n}},{key:"getStrokeShape",value:function(e,t,r){var i=new d.Shape(this.getStrokePaths(e,t,r),r.style?r.style:e.getStyleAt(t.start)),n=e.getLineAndParagraphAt(t.start);return n&&this.initShapeEffectsAndBoundsOverrides(e,i,n.line,n.line.offset.add(n.paragraph.offset),t.start,!1),i.role=d.ShapeRole.text,i.textRange=t,i.overlapMode=d.OverlapMode.winding,i.transform=e.frameToShape,i}},{key:"getSelectionHighlightShapes",value:function(e){if(e.selectionHighlights){var t,r=[],i=p(e.selectionHighlights);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.range.length>0){var a=e.getSelectionRectPaths(n.range);a&&r.push(new d.Shape(a,n.style))}else{var o=e.getSelectionLayoutCaretPath(n.range.start,n.caretWidth,n.isAnchoredToPrevious);o&&r.push(new d.Shape([o],n.style))}}}catch(e){i.e(e)}finally{i.f()}return r}}},{key:"update",value:function(e){if(e.textVersion!=this.lastKnownTextVersion){var t,r;this.lastKnownTextVersion=e.textVersion,this.clearCache(),this.textShapes=[],this.hitTestLineShapes=[];var i=[],a=[];e.renderMode!=c.TextRenderMode.TextInFrontOfShape&&(this.cutoutLayerPaths=void 0);var o,u=p(e.paragraphs);try{for(u.s();!(o=u.n()).done;){var h=o.value;if(h.bullet){var g=e.getLineAndParagraphAt(h.globalRange.start);if(g){var v,y=new c.TextRange(h.globalRange.start,0),_=p(h.bullet.strokes?h.bullet.strokes.elements:[]);try{for(_.s();!(v=_.n()).done;){var S=v.value;S.type==c.TextStrokeType.highlighter?i.push(this.getStrokeShape(e,y,S)):a.push(this.getStrokeShape(e,y,S))}}catch(e){_.e(e)}finally{_.f()}var T=e.getTextPathsForCharacter(h.bullet.character,h.offset,h.lines.length>0?h.lines[0].bender:void 0),b=new d.Shape(T,h.bullet.style?h.bullet.style:e.getStyleAt(y.start));this.initShapeEffectsAndBoundsOverrides(e,b,g.line,g.paragraph.offset,y.start,!0),b.role=d.ShapeRole.text,b.textRange=new c.TextRange(h.globalRange.start,0),b.transform=e.frameToShape,a.push(b)}}}}catch(e){u.e(e)}finally{u.f()}var C,w=p(e.getSelectionRectPaths(void 0)||[]);try{for(w.s();!(C=w.n()).done;){var P=C.value,I=new d.Shape([P],new f.Style(new f.SolidBrush(f.Color.Black)));I.transform=e.frameToShape,this.hitTestLineShapes.push(I)}}catch(e){w.e(e)}finally{w.f()}var k,E=[],x=p(e.getRunRanges());try{for(x.s();!(k=x.n()).done;){var L=k.value,A=e.getBoundsOfRange(L);if(A&&A.width>2048)for(var M=Math.ceil(A.width/2048),R=0;R<M;R++){var O=Math.floor(L.start+R*L.length/M),D=R==M-1?L.last+1:Math.floor(L.start+(R+1)*L.length/M);O<D&&E.push(c.TextRange.FromFirstLast(O,D-1))}else E.push(L)}}catch(e){x.e(e)}finally{x.f()}for(var F=0,B=E;F<B.length;F++){var N=B[F];a.push(this.getTextShape(e,N))}for(var V=0,U=E;V<U.length;V++){var W,G=U[V],H=e.getStrokesAt(G.start),j=p(H?H.elements:[]);try{for(j.s();!(W=j.n()).done;){var z=W.value;z.type==c.TextStrokeType.highlighter?i.push(this.getStrokeShape(e,G,z)):a.push(this.getStrokeShape(e,G,z))}}catch(e){j.e(e)}finally{j.f()}}var q,Z=p(e.paragraphs);try{for(Z.s();!(q=Z.n()).done;){var X,Y=q.value,J=p(Y.lines);try{for(J.s();!(X=J.n()).done;)for(var K=X.value,Q=0;Q<K.characters.length;Q++){var $=K.characters[Q];if($.textImage){var ee=l.Figure.CreateFromRect($.textImage.rect);$.textImage.useLocalCordinates&&(ee=ee.transform(s.Matrix3.FromTransforms($.textImage.transform,s.Matrix3.Translation2D(K.offset.add(Y.offset)),e.layoutToFrame)));var te=new d.Shape([new l.Path({figures:[ee]})],new f.Style(new f.ImageBrush($.textImage.image)));te.role=$.textImage.useLocalCordinates?d.ShapeRole.text:d.ShapeRole.textImageNotLocal,te.textRange=new c.TextRange(Q+K.localRange.start+Y.globalRange.start,1),te.transform=$.textImage.useLocalCordinates?e.frameToShape:$.textImage.transform,a.push(te)}}}catch(e){J.e(e)}finally{J.f()}}}catch(e){Z.e(e)}finally{Z.f()}if(m.s_textLinesDebugModeEnabled){var re,ie=p(e.paragraphs);try{for(ie.s();!(re=ie.n()).done;){var ne,ae=re.value,oe=p(ae.lines);try{for(oe.s();!(ne=oe.n()).done;){var se=ne.value;if(se.bender instanceof c.WarpingEnvelope){var le=new d.Shape([l.Path.CreateFromFigure(se.bender.topPath)],new f.Style(void 0,new f.SolidBrush(f.Color.Cyan),new f.Pen(1))),ce=new d.Shape([l.Path.CreateFromFigure(se.bender.bottomPath)],new f.Style(void 0,new f.SolidBrush(f.Color.Magenta),new f.Pen(1)));le.textRange=ce.textRange=se.localRange.move(ae.globalRange.start),le.transform=e.frameToShape,ce.transform=e.frameToShape,a.push(le),a.push(ce)}else if(se.bender instanceof c.PathingLine){var ue=new d.Shape([l.Path.CreateFromFigure(se.bender.path)],new f.Style(void 0,new f.SolidBrush(f.Color.Yellow),new f.Pen(1)));ue.textRange=se.localRange.move(ae.globalRange.start),ue.transform=e.frameToShape,a.push(ue)}}}catch(e){oe.e(e)}finally{oe.f()}}}catch(e){ie.e(e)}finally{ie.f()}var de,he=p(e.getAnimatablePartRanges(c.TextSplit.ByLetter,void 0,!0)||[]);try{for(he.s();!(de=he.n()).done;){var fe=de.value,me=e.getBoundsOfRange(fe);if(me){var pe=new d.Shape([l.Path.CreateFromRect(me)],new f.Style(void 0,new f.SolidBrush(f.Color.Blue),new f.Pen(1)));pe.textRange=fe,a.push(pe)}}}catch(e){he.e(e)}finally{he.f()}var ge,ve=p(e.paragraphs);try{for(ve.s();!(ge=ve.n()).done;){var ye,_e=ge.value,Se=p(_e.lines);try{for(Se.s();!(ye=Se.n()).done;){var Te=ye.value,be=Te.fillBounds.translate(Te.offset.add(_e.offset)).transformedBounds(s.Matrix3.FromTransforms(e.layoutToFrame,e.frameToShape));if(be&&Te.textEffectMetrics){var Ce=new s.Rect(be.left,be.top,be.right,be.top+Te.textEffectMetrics.ascent),we=new s.Rect(be.left,be.bottom-Te.textEffectMetrics.descent,be.right,be.bottom),Pe=new d.Shape([l.Path.CreateFromRect(Ce)],new f.Style(void 0,new f.SolidBrush(f.Color.Red),new f.Pen(1))),Ie=new d.Shape([l.Path.CreateFromRect(we)],new f.Style(void 0,new f.SolidBrush(f.Color.Green),new f.Pen(1)));Pe.textRange=Te.localRange.move(_e.globalRange.start),Ie.textRange=Te.localRange.move(_e.globalRange.start),a.push(Pe),a.push(Ie)}}}catch(e){Se.e(e)}finally{Se.f()}}}catch(e){ve.e(e)}finally{ve.f()}}(t=this.textShapes).push.apply(t,i),(r=this.textShapes).push.apply(r,a);var ke,Ee=p(this.textShapes);try{for(Ee.s();!(ke=Ee.n()).done;){var xe=ke.value;if(xe.role==d.ShapeRole.textImageNotLocal){if(e.clipBounds){var Le=xe.getBounds(!1,!1,!0),Ae=null==Le?void 0:Le.transformedBounds(e.frameToShape.toInverseMatrix3()),Me=Ae?e.clipBounds.clip(Ae):void 0,Re=null==Me?void 0:Me.transformedBounds(e.frameToShape.toMatrix3().multiply(xe.transform.toInverseMatrix3()));xe.clipBounds=Re?s.ClipBounds.CreateFromRect(Re):void 0,Re||(xe.paths=[])}}else xe.clipBounds=e.clipBounds}}catch(e){Ee.e(e)}finally{Ee.f()}if(e.renderMode!=c.TextRenderMode.TextInFrontOfShape){if(this.cutoutLayerPaths=[],e.renderMode==c.TextRenderMode.LinesCutout){var Oe,De=p(e.getCutoutLinePath(void 0,e.linesCutoutMargin)||[]);try{for(De.s();!(Oe=De.n()).done;){var Fe=Oe.value;this.cutoutLayerPaths.push(Fe)}}catch(e){De.e(e)}finally{De.f()}}var Be,Ne=p(i);try{for(Ne.s();!(Be=Ne.n()).done;){var Ve,Ue=Be.value;(Ve=this.cutoutLayerPaths).push.apply(Ve,(0,n.default)(Ue.paths||[]))}}catch(e){Ne.e(e)}finally{Ne.f()}var We,Ge=p(a);try{for(Ge.s();!(We=Ge.n()).done;){var He,je=We.value;(He=this.cutoutLayerPaths).push.apply(He,(0,n.default)(je.paths||[]))}}catch(e){Ge.e(e)}finally{Ge.f()}}}if(e.selectionVersion!=this.lastKnownSelectionVersion){this.lastKnownSelectionVersion=e.selectionVersion;var ze=this.getSelectionHighlightShapes(e);if(ze){if(this.selectionShapes=[],new f.Style(new f.SolidBrush(f.Color.White)).blendingMode=f.BlendingMode.exclusion,ze){var qe;(qe=this.selectionShapes).push.apply(qe,(0,n.default)(ze));var Ze,Xe=p(this.selectionShapes);try{for(Xe.s();!(Ze=Xe.n()).done;)Ze.value.transform=e.frameToShape}catch(e){Xe.e(e)}finally{Xe.f()}}}else{var Ye,Je=p(this.selectionShapes||[]);try{for(Je.s();!(Ye=Je.n()).done;)Ye.value.clearCache()}catch(e){Je.e(e)}finally{Je.f()}this.selectionShapes=void 0}}}},{key:"getStrokePaths",value:function(e,t,r){var i,n=[],a=p(e.paragraphs);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o.globalRange.intersects(t)){var u,d=p(o.lines);try{for(d.s();!(u=d.n()).done;){var h=u.value,f=void 0,m=void 0,g=new c.TextRange(0,h.characters.length).getIntersection(t.move(-o.globalRange.start-h.localRange.start));if(g)for(var v=g.start;v<=g.last;v++){var y=h.characters[v].layoutBounds;y.isEmpty()||(f=null==f?y.left:Math.min(f,y.left),m=null==m?y.right:Math.max(m,y.right))}if(null!=f&&null!=m&&f<m){var _=s.Matrix3.Translation2D(h.offset.add(o.offset)).multiply(e.layoutToFrame.toMatrix3()).tryGetTransform(s.Vector2.Zero);if(_){var T=new l.Path({figures:S(r,f,m),transform:_}),b=h.bender instanceof c.PathingLine?h.bender.equivalentWarpingEnvelope:h.bender;b&&(T=b.warpPath(T)),n.push(T)}}}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){a.e(e)}finally{a.f()}return n}}]);function y(e,t,r){var i=t.y-r,n=Math.ceil(t.x/(2*i)),a=e.x,o=new l.FigureBuilder;o.moveTo(a,e.y),o.lineTo(a,e.y+r);for(var s=0;s<n;s++)a+=i,o.lineTo(a,e.y+t.y),a+=i,o.lineTo(a,e.y+r);o.lineTo(a,e.y);for(var c=0;c<n;c++)a-=i,o.lineTo(a,e.y+t.y-r),a-=i,o.lineTo(a,e.y);return o.close(),o.createFigure()}function _(e,t,r,i,n,a){for(var o=[],c=e.x,u=t.y,d=t.y*r,h=t.y*i,f=a?e.y-t.y:e.y,m=a?e.y+t.y/2:e.y+t.y,p=0;c<e.x+t.x;){var g=n&&p%(n+1)!=0?u:d,v=Math.min(c+g,t.x+e.x);o.push(l.Figure.CreateFromRect(new s.Rect(c,f,v,m))),c+=h+g,p++}return o}function S(e,t,r){var i=new s.Vector2(t,e.verticalCenter-.5*e.thickness),a=new s.Vector2(r-t,e.thickness),o=[],d=e.type==c.TextStrokeType.heavy||e.type==c.TextStrokeType.dottedHeavy||e.type==c.TextStrokeType.dashHeavy||e.type==c.TextStrokeType.dashLongHeavy||e.type==c.TextStrokeType.dotDashHeavy||e.type==c.TextStrokeType.dotDotDashHeavy||e.type==c.TextStrokeType.wavyHeavy;switch(e.type){case c.TextStrokeType.heavy:case c.TextStrokeType.single:case c.TextStrokeType.highlighter:d?o.push(l.Figure.CreateFromRect(new s.Rect(i.x,i.y-a.y,i.x+a.x,i.y+Math.ceil(a.y/2)))):o.push(l.Figure.CreateFromRect(new s.Rect(i.x,i.y,i.x+a.x,i.y+a.y)));break;case c.TextStrokeType.double:o.push.apply(o,(0,n.default)(function(e,t,r){var i=[];return i.push(l.Figure.CreateFromRect(new s.Rect(e.x,e.y-t.y,e.x+t.x,e.y-t.y/2))),i.push(l.Figure.CreateFromRect(new s.Rect(e.x,e.y+t.y/2,e.x+t.x,e.y+t.y))),i}(i,a)));break;case c.TextStrokeType.dottedHeavy:case c.TextStrokeType.dotted:o.push.apply(o,(0,n.default)(_(i,a,1,1,1,d)));break;case c.TextStrokeType.dashHeavy:case c.TextStrokeType.dash:o.push.apply(o,(0,n.default)(_(i,a,3,2,0,d)));break;case c.TextStrokeType.dashLongHeavy:case c.TextStrokeType.dashLong:o.push.apply(o,(0,n.default)(_(i,a,7,4,0,d)));break;case c.TextStrokeType.dotDash:case c.TextStrokeType.dotDashHeavy:o.push.apply(o,(0,n.default)(_(i,a,3,2,1,d)));break;case c.TextStrokeType.dotDotDash:case c.TextStrokeType.dotDotDashHeavy:o.push.apply(o,(0,n.default)(_(i,a,3,2,2,d)));break;case c.TextStrokeType.wavy:case c.TextStrokeType.wavyHeavy:var h=2*a.y,f=1;e.type==c.TextStrokeType.wavyHeavy&&(h=Math.floor(Math.max(3,2*a.y)),f=Math.max(2,Math.floor(a.y/2))),o.push(y(new s.Vector2(i.x,i.y-Math.ceil(a.y/2)),new s.Vector2(a.x,h),f));break;case c.TextStrokeType.wavyDouble:var m=Math.max(2,a.y),p=i.y-m;o.push(y(new s.Vector2(i.x,p),new s.Vector2(a.x,m),1)),o.push(y(i,new s.Vector2(a.x,m),1));break;default:u.Log.Error(591525085,"Unknown stroke type")}return o}function T(e,t,r,i){for(var n,a,o=c.TextRange.FromFirstLast(Math.max(0,t.start-e.localRange.start),Math.min(e.characters.length-1,t.last-e.localRange.start)),l=new Array(e.characters.length-o.length+r.length),u=o.start;u<=o.last;u++)n=s.Rect.UnionRect(n,e.characters[u].layoutBounds);for(var h=0;h<r.length;h++)a=s.Rect.UnionRect(a,r[h].layoutBounds);for(var f,m,p,g,v=a?a.width:0,y=(0,d.getAlignmentPoint)(i).x,_=(a?a.width:0)-(n?n.width:0),S=0==e.characters.length?0:Math.sign(e.characters[e.characters.length-1].layoutBounds.left-e.characters[0].layoutBounds.left),T=-(0,s.mix)(0,_,y),b=(0,s.mix)(0,_,1-y),C=0;C<o.start;C++)f=s.Rect.UnionRect(f,e.characters[C].layoutBounds),l[C]=e.characters[C].getTranslatedCopy(new s.Vector2(S>0?T:b,0));for(var w=o.start;w<=o.last;w++)m=s.Rect.UnionRect(m,e.characters[w].layoutBounds);for(var P=o.last+1;P<e.characters.length;P++)p=s.Rect.UnionRect(p,e.characters[P].layoutBounds),l[P-o.length+r.length]=e.characters[P].getTranslatedCopy(new s.Vector2(S>0?b:T,0));g=S>0?m?m.left:f?f.right+T:p?p.left+b-(a?a.width:0):(0,s.mix)(e.layoutBounds.left,e.layoutBounds.right-v,y):m?m.right-v:f?f.left+b-(a?a.width:0):p?p.right+T:(0,s.mix)(e.layoutBounds.left,e.layoutBounds.right-v,y);for(var I=a?new s.Vector2(g,e.layoutBounds.bottom).subtract(new s.Vector2(a.left,a.bottom)):s.Vector2.Zero,k=0;k<r.length;k++)l[k+o.start]=r[k].getTranslatedCopy(I);if(e.bender instanceof c.WarpingEnvelope){var E=new s.Rect(e.bender.sourceRect.left+T,e.bender.sourceRect.top,e.bender.sourceRect.right+b,e.bender.sourceRect.bottom);e.bender=new c.WarpingEnvelope(E,e.bender.topPath,e.bender.bottomPath,e.bender.isVerticalLayout)}else if(e.bender instanceof c.PathingLine){var x=new s.Rect(e.bender.lineRect.left+T,e.bender.lineRect.top,e.bender.lineRect.right+b,e.bender.lineRect.bottom);e.bender=new c.PathingLine(x,e.bender.path,e.bender.alignment,e.bender.scale,e.bender.pivot,e.bender.isVerticalLayout)}e.layoutBounds=new s.Rect(e.layoutBounds.left+T,e.layoutBounds.top,e.layoutBounds.right+b,e.layoutBounds.bottom),e.localRange=new c.TextRange(e.localRange.start,e.characters.length),e.characters=l}function b(e,t,r){if(e){var i=t?t.fontHeightInPoints:0,n=e.clone(),a=0==i?1:i/R;return n.glow&&(n.glow.radius=C(n.glow.radius,i,w,P,I)/2),n.shadow&&(n.shadow.radius=C(n.shadow.radius,i,k,E,x),n.shadow.distance=C(n.shadow.distance,i,k,E,x)),n.innerShadow&&(n.innerShadow.radius=C(n.innerShadow.radius,i,L,A,M),n.innerShadow.distance=C(n.innerShadow.distance,i,L,A,M)),n.reflection&&(n.reflection.radius*=a,t&&(n.reflection.distance*=0!=t.ascent&&0!=t.descent?i*t.descent/t.ascent/O:a)),n.softEdges&&(n.softEdges.radius*=a),n.direction=r,n}}function C(e,t,r,i,n){return t>0&&n<e?(e-n)*Math.pow(t,i)/Math.pow(r,i)+n:0==t?e:0}t.TextGeneratedShapesCache=v;var w=72,P=.7,I=1,k=72,E=.7,x=.4,L=108,A=1,M=.001,R=72,O=4},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInstancesForReplicate=l,t.getBoundsForReplicateInstances=u,t.getBoundsForReplicate=function(e,t,r){return u(t,l(e,r))},t.createReplicateTexture=function(e,t,r,s){if(e.getGraphicsProcessor()){var c=s?r.topSlices:r.bottomSlices,f=s?r.topFilter:r.bottomFilter;if(0!=f&&c&&0!=c.length){var m,p=e.createTextureRasterizedItem("Effect/Replicate",t,n.EffectFlags.innerShadow|n.EffectFlags.softEdges|n.EffectFlags.border,void 0,void 0,0,n.EffectFlags.none,3==f?10:1==f?11:12,1,a.TextureReleasePolicy.KeepUntilRelease);if(p){var g,v=!1,y=o(c||[]);try{for(y.s();!(g=y.n()).done;)g.value.recolor instanceof n.Brush&&(v=!0)}catch(e){y.e(e)}finally{y.f()}var _=n.Rect.FromSizeAndCenter(p.contentLocation.logicalSize,p.contentLocation.logicalCenter),S=n.Rect.FromSizeAndCenter(p.contentLocation.physicalSize,p.contentLocation.physicalCenter),T=u(S,l(_,c)),b=r.blendingMode==n.BlendingMode.darken||r.blendingMode==n.BlendingMode.multiply?n.Color.White:n.Color.Transparent;if(T&&!T.isEmpty()){var C=(0,a.scaleToFitMaxTextureResolution)(T.size);m=new a.TargetTexture("Effect/Replicate",e,C,a.TextureReleasePolicy.KeepUntilRelease);var w=C.y/T.height,P=new n.Transform(T.center.negate(),new n.Vector2(w,w),0,m.size.scale(.5));if(v){if(c){for(var I=new a.TargetTexture("Effect/ReplicateSlice",e,C,a.TextureReleasePolicy.KeepUntilRelease),k=0;k<c.length;k++){var E=s?k:c.length-1-k,x=c[E].recolor;d(e,I,p,r,_,S,P,s,E,v),h(e,m,0==k?b:void 0,I,x instanceof n.Brush?x:void 0)}I.release()}}else d(e,m,p,r,_,S,P,s,void 0,v);m&&(m.contentLocation={logicalCenter:_.center.transformPoint(P),logicalSize:_.size.transformVector(P),physicalCenter:m.size.scale(.5),physicalSize:m.size,rotation:0,flipX:!1,flipY:!1})}p.release()}return m}}else i.Log.Error(506848278,"glContext must be provided")};var i=r(13),n=r(84),a=r(38);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function l(e,t,r){var i=n.Vector2.Zero,a=1,o=0,s=void 0,l=1,u=new Array;if(t)for(var d=0;d<t.length;d++){for(var h,f=t[d],m=f.push instanceof n.Figure?f.push:new n.Figure([i.x,i.y,1,i.x+f.push.x,i.y+f.push.y,1]),p=m.measureLength(),g=void 0,v=0;v<f.count;v++){var y=(v+1)/f.count,_=m.getPointFromDist(p*y),S=(0,n.mix)(a,a*f.scale,y),T=o+f.rotate*y,b=1;(g=f.recolor instanceof Array?c(f.recolor,y):f.recolor instanceof n.Color?f.recolor:void 0)&&f.recolorInterpolate&&(s?g=n.Color.InterpolateLinear(s,g,y):b=y);var C,w=f.opacity;void 0!==w&&f.opacityInterpolate&&(w=(0,n.mix)(l,w,y)),(void 0===r||r===d)&&u.push(new n.Instance(new n.Transform(e.center.negate(),new n.Vector2(S,S),T,e.center.add(_)),{colorize:!f.recolorSolid&&g?new n.Color(g.r,g.g,g.b,g.a*b):void 0,colorMatrix:g&&f.recolorSolid?new n.Matrix3(1-b,0,0,0,1-b,0,0,0,1-b):void 0,colorOffset:g&&f.recolorSolid?new n.Vector3(g.r*b,g.g*b,g.b*b):void 0,opacity:g&&f.recolorSolid?(null!==(C=w)&&void 0!==C?C:1)*g.a:w}))}i=m.getPoint(m.getPointCount()-1),a*=f.scale,o+=f.rotate,l=null!==(h=f.opacity)&&void 0!==h?h:1,s=g}return u}function c(e,t){if(e.length<1)return n.Color.Transparent;if(e[0].position>t)return e[0].color;for(var r=0;r<e.length-1;r++)if(e[r+1].position>t){var i=e[r].color,a=e[r+1].color,o=t-e[r].position,s=e[r+1].position-e[r].position;return n.Color.InterpolateLinear(i,a,Math.max(0,Math.min(1,0==s?0:o/s)))}return e[e.length-1].color}function u(e,t){var r,i,a=o(t);try{for(a.s();!(i=a.n()).done;){var s=i.value.transform;r=n.Rect.UnionRect(r,e.transformedBounds(s))}}catch(e){a.e(e)}finally{a.f()}return r}function d(e,t,r,a,o,s,c,u,d,h){var f=e.getGraphicsProcessor();if(!f)throw i.Log.Error(506848279,"glContext must be provided");var m=l(o,(u?a.topSlices:a.bottomSlices)||[],d);u||m.reverse();var p=new n.ImageContainer;e.attachTextureToImage(p,r);var g=n.Shape.CreateRectangle(s,new n.Style(new n.ImageBrush(p)));g.instances=m,g.style.blendingMode=h?n.BlendingMode.normal:a.blendingMode,e.tryPrepareItemInWebGlScope(g,f,!0,void 0);var v=!h&&(a.blendingMode==n.BlendingMode.darken||a.blendingMode==n.BlendingMode.multiply);e.renderItemInWebGLRenderScope(g,v?n.Color.White:n.Color.Transparent,{target:t,transform:c}),g.clearCache()}function h(e,t,r,a,o){var s=e.getGraphicsProcessor();if(!s)throw i.Log.Error(506848277,"glContext must be provided");var l=new n.Style(o),c=new n.ImageContainer;e.attachTextureToImage(c,a),l.pictureBrush=new n.ImageBrush(c),l.pictureFillMode=o?n.PictureFillMode.fillMaskedByPicture:n.PictureFillMode.pictureOverFill;var u=n.Shape.CreateRectangle(n.Rect.FromSize(t.size),l);e.tryPrepareItemInWebGlScope(u,s,!0,void 0),e.renderItemInWebGLRenderScope(u,r,{target:t}),u.clearCache()}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Morph=t.MorphElement=t.MorphKeyFrame=void 0;var n=i(r(1)),a=i(r(2)),o=r(12),s=r(13),l=r(30);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=function(){function e(t,r,i,a,o,s){(0,n.default)(this,e),this.renderDataMap={},this.contents=t,this.location=r,this.zPosition=i,this.parentTransform=o,this.morphingGrid=a,this.shapeInterpolation=s}return(0,a.default)(e,[{key:"clearCache",value:function(){for(var e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}}],[{key:"CreateFromItem",value:function(t,r,i,n,a,s,l){var c=o.Matrix3.FromTransforms(t.transform,s||o.Matrix3.Identity,t.animationTransform||o.Matrix3.Identity),u=c.transformVector(new o.Vector2(1,0)),d=c.transformVector(new o.Vector2(0,1)),h=i.transformedBounds(c);return new e([{item:t,includeSubtree:n,textRange:a}],{center:h?h.center:o.Vector2.Zero,size:h?i.size.multiply(new o.Vector2(u.length(),d.length())):o.Vector2.Zero,rotation:t.transform.rotation,flipX:t.transform.scale.x<0,flipY:t.transform.scale.y<0},r,void 0,s,l)}},{key:"TryCreateFromShape",value:function(t,r,i,n,a){var o=(0,l.getBoundsOfPaths)(t,!1);return o?e.CreateFromItem(t,r,o,i,void 0,n,a):void 0}},{key:"TryCreateFromText",value:function(t,r,i,n){if(t.text){var a=t.text.getFullRange(),l=i||a;if(a&&l&&a.contains(l)){var c=t.text.getBoundsOfRange(l);if(c){var u=c.transformedBounds(o.Transform.fromScaleAndTranslation(t.transform.scale.inverse(),t.transform.preTranslation.negate()));return u?e.CreateFromItem(t,r,u,!0,l,n):void 0}}else s.Log.Error(592525387,"TryCreateFromText out of range: ".concat(i?(i.start,i.last,"]"):void 0," fullRange: ").concat(a?(a.start,a.last,"]"):"undefined"))}else s.Log.Error(592525386,"TryCreateFromText on Shape with no Text")}},{key:"TryCreateFromGroup",value:function(t,r,i,n){var a=(0,l.getBoundsForEffects)(t,!1,l.EffectFlags.none,l.EffectFlags.none,t.transform.toInverseMatrix3());return a?e.CreateFromItem(t,r,a,i,void 0,n):void 0}}])}();t.MorphKeyFrame=u;var d=(0,a.default)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,n.default)(this,e),this.renderDataMap={},this.keyFrames=t}),[{key:"clearCache",value:function(){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this.keyFrames||[]);try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&r.clearCache()}}catch(e){t.e(e)}finally{t.f()}}}]);t.MorphElement=d;var h=(0,a.default)((function e(){(0,n.default)(this,e),this.elements=[]}),[{key:"clearCache",value:function(){this.elements.forEach((function(e){return e.clearCache()}))}}]);t.Morph=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.IsShapeBuilderCompatible=function(e){return void 0===e.failureReason},t.GetShapeBuilderHardwareCompatibilityReport=function(e){var t={details:{}};try{var r=document.createElement("canvas"),i=function(e){var r="".concat(e.statusMessage||"Unknown error");t.details.webglcontextcreationerror=r},s=r.getContext("webgl2");if(null!==s)t.details.WebGLVersion="WebGL2";else if(null!==(s=r.getContext("webgl")))t.details.WebGLVersion="WebGL";else{if(r.addEventListener("webglcontextcreationerror",i),s=r.getContext("experimental-webgl"),r.removeEventListener("webglcontextcreationerror",i),null===s)return t.failureReason=n.FailedToCreateWebGLContext,t;t.details.WebGLVersion="WebGL Experimental"}var l=document.createElement("canvas").getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});t.details.MajorPerfCaveat=null===l,s instanceof WebGLRenderingContext&&!s.getExtension("EXT_blend_minmax")&&(t.failureReason=n.NoBlendMinMaxExt),s instanceof WebGLRenderingContext&&!s.getExtension("ANGLE_instanced_arrays")&&(t.failureReason=n.NoInstancedArrays);var c=s.getParameter(s.MAX_VERTEX_ATTRIBS),u=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),d=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=s.getParameter(s.MAX_VARYING_VECTORS),f=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),m=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),p=s.getParameter(s.MAX_TEXTURE_SIZE);if(t.details.VERTEX_ATTRIBS=c,t.details.VERTEX_UNIFORM_VECTORS=u,t.details.VERTEX_TEXTURE_IMAGE_UNITS=d,t.details.VARYING_VECTORS=h,t.details.FRAGMENT_UNIFORM_VECTORS=f,t.details.TEXTURE_IMAGE_UNITS=m,t.details.TEXTURE_SIZE=p,p<4096)return t.failureReason=n.InsufficientMaxTextureResolution,t;if(c<16||m<4||h<8||f<64)return t.failureReason=n.InsufficientCapabilities,t;var g=s.getExtension("WEBGL_debug_renderer_info");if(g){var v=s.getParameter(g.UNMASKED_RENDERER_WEBGL),y=s.getParameter(g.UNMASKED_VENDOR_WEBGL);if(t.details.WebGLRenderer=v,t.details.WebGLVendor=y,(e?Array.from(new Set([].concat(o,(0,a.default)(e)))):o).includes(v))return t.failureReason=n.BlockedRenderer,t}}catch(e){t.failureReason=n.Exception}return t},t.rendererBlocklist=t.CompatibilityFailureReason=t.maxFragmentUniformVectors=t.maxVaryingVectors=t.maxVertexTextureImageUnits=t.maxVertexAttribs=t.maxTextureResolution=void 0;var n,a=i(r(18));t.maxTextureResolution=4096,t.maxVertexAttribs=16,t.maxVertexTextureImageUnits=4,t.maxVaryingVectors=8,t.maxFragmentUniformVectors=64,t.CompatibilityFailureReason=n,function(e){e.FailedToCreateWebGLContext="Failed to create WebGL context",e.NoBlendMinMaxExt="Unsupported WebGL extension: EXT_blend_minmax",e.NoInstancedArrays="Unsupported WebGL extension: ANGLE_instanced_arrays",e.InsufficientMaxTextureResolution="Insufficient max texture resolution",e.InsufficientCapabilities="Insufficient hardware capabilities",e.BlockedRenderer="Unsupported WebGL renderer",e.Exception="Exception while generating compatibility report"}(n||(t.CompatibilityFailureReason=n={}));var o=[];t.rendererBlocklist=o},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.generatePipelineContext=function(e,t){return p.apply(this,arguments)};var n=i(r(6)),a=i(r(5)),o=i(r(18)),s=i(r(7)),l=r(106),c=r(87),u=r(48),d=r(60),h=r(108);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(){return(p=(0,s.default)(n.default.mark((function e(t,i){var a,s,f,p,g,v,y,_,S,T,b,C,w,P,I=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=I.length>2&&void 0!==I[2]?I[2]:c.createPipelineContext.bind(null,i),I.length>3&&void 0!==I[3]?I[3]:c._preparePipelineContext,(0,c.getStateObject)(i),g=t.platformName||"WEBGL2",v=null===(a=t.extendedProcessingOptions)||void 0===a?void 0:a.processor,y=t.shaderLanguage||u.ShaderLanguage.GLSL,v){e.next=20;break}e.t0=g,e.next="WEBGL1"===e.t0?10:(e.t0,15);break;case 10:return e.next=12,Promise.resolve().then(r.t.bind(null,134,7));case 12:return e.t1=e.sent.WebGLShaderProcessor,v=new e.t1,e.abrupt("break",20);case 15:return e.next=17,Promise.resolve().then(r.t.bind(null,135,7));case 17:return e.t2=e.sent.WebGL2ShaderProcessor,v=new e.t2,e.abrupt("break",20);case 20:return _=t.shaderNameOrContent,S=_.vertex||_.vertexSource||_,T=_.fragment||_.fragmentSource||_,b=(null===(s=(0,d._getGlobalDefines)())||void 0===s?void 0:s.split("\n"))||[],C=[].concat((0,o.default)(t.defines||[]),(0,o.default)(t.addGlobalDefines?b:[])),w=(null===(f=t.key)||void 0===f?void 0:f.replace(/\r/g,"").replace(/\n/g,"|"))||S+"+"+T+"@"+C.join("|"),P=m({defines:C,indexParameters:void 0,isFragment:!1,shouldUseHighPrecisionShader:!0,processor:v,supportsUniformBuffers:!1,shadersRepository:h.ShaderStore.GetShadersRepository(y),includesShadersStore:h.ShaderStore.GetIncludesShadersStore(y),version:"WEBGL2"===g?"200":"100",platformName:g,processingContext:null,isNDCHalfZRange:!1,useReverseDepthBuffer:!1},t.extendedProcessingOptions),e.abrupt("return",new Promise((function(e,r){try{(0,l._processShaderCode)(P,_,void 0,(function(n,a){try{var o,s=(0,l.createAndPreparePipelineContext)(m({name:w,vertex:n,fragment:a,context:i,defines:C.length?C.join("\n"):null,shaderProcessingContext:(null===(o=t.extendedProcessingOptions)||void 0===o?void 0:o.processingContext)||null,transformFeedbackVaryings:null},t.extendedCreatePipelineOptions),p,c._preparePipelineContext,c._executeWhenRenderingStateIsCompiled);e(s)}catch(e){r(e)}}),y)}catch(e){r(e)}})));case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderProgram=t.GraphicsProcessor=void 0;var n=i(r(6)),a=i(r(18)),o=i(r(7)),s=i(r(1)),l=i(r(2));r(235);var c=r(62),u=r(40),d=r(88),h=r(12),f=r(16),m=r(138),p=r(51),g=r(63),v=r(13),y=r(139);r(261);var _=r(110),S=r(41);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var b=1,C=[m.p_0,m.p_1,m.p_2,m.p_3,m.p_4,m.p_5,m.p_6,m.p_7,m.p_8,m.p_9,m.p_10,m.p_11],w={x:0,y:0,width:1,height:1},P=[{attributeName:"",index:0,attributeSize:2,offset:0,divisor:0}],I=function(){return(0,l.default)((function e(t,r,i,n){(0,s.default)(this,e),this.m_shaderPrograms=new Array(S.ProgramId.count),this.m_isInitializeReady=!0,this.m_isInScope=!1,this.m_stateRestorer=n,this.m_wipeStateBetweenScopes=r,this.m_disableParallelShaderCompile=i,this.setWebGLContextOrBabylonEngine(t)}),[{key:"getBabylonEngine",value:function(){return this.m_engine}},{key:"maxSupportedTextureSize",get:function(){return this.m_engine.getCaps().maxTextureSize}},{key:"quadMesh",get:function(){return this.m_quadMesh}},{key:"emptyTexture",get:function(){return this.m_emptyTexture}},{key:"whiteTexture",get:function(){return this.m_whiteTexture}},{key:"needPowerOf2TexturesForTilingOrMipMap",value:function(){return this.m_needPowerOf2TexturesForTilingOrMipMap}},{key:"isCurrentWebGLContext",value:function(e){return this.m_gl==e}},{key:"isValid",value:function(){return this.m_gl&&!this.m_gl.isContextLost()}},{key:"setWebGLContextOrBabylonEngine",value:function(e){var t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;if(this.m_gl!=t){this.m_engine&&(this.m_emptyTexture&&this.m_emptyTexture.dispose(),this.m_whiteTexture&&this.m_whiteTexture.dispose(),this.m_quadMesh&&this.m_quadMesh.discard()),this.m_gl=t;var r=t.canvas.width,i=t.canvas.height;this.m_canvasRenderSize=new h.Vector2(r,i),e instanceof c.ThinEngine?this.m_engine=e:(this.m_engine=new c.ThinEngine(t),this.m_engine.preventCacheWipeBetweenFrames=!0,this.m_engine.doNotHandleContextLost=!0,this.m_engine.setSize(r,i),this.m_engine.setViewport(w));var n=this.m_engine.getCaps();this.m_parallelShaderCompilationExtension=n.parallelShaderCompile,n.parallelShaderCompile=void 0,this.m_renderToFilteredFloat=n.textureFloatRender&&n.textureFloatLinearFiltering,this.m_renderToFilteredHalfFloat=n.textureHalfFloatRender&&n.textureHalfFloatLinearFiltering,this.m_needPowerOf2TexturesForTilingOrMipMap=this.m_engine.needPOTTextures,this.m_uniqueGraphicsProcessorId=b,b++;for(var a=0;a<S.ProgramId.count;a++)this.m_shaderPrograms[a]=void 0}}},{key:"updateViewportSize",value:function(){var e=this.m_gl.canvas.width,t=this.m_gl.canvas.height;this.m_canvasRenderSize=new h.Vector2(e,t),this.m_engine.setSize(e,t),this.m_engine.setViewport(w)}},{key:"onWebGLContextLost",value:function(){for(var e=0;e<S.ProgramId.count;e++)this.m_shaderPrograms[e]=void 0}},{key:"initializeProgramsAsync",value:(e=(0,o.default)(n.default.mark((function e(t){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.m_isInitializeReady=!1,r=this.preCompileShadersAsync(null!=t?t:(0,a.default)(Array(S.ProgramId.count).keys())),e.next=4,Promise.all(r);case 4:this.m_isInitializeReady=!0;case 5:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"preCompileShadersAsync",value:function(e){var t=this.m_engine.getCaps();this.m_disableParallelShaderCompile||(t.parallelShaderCompile=this.m_parallelShaderCompilationExtension);var r=[];if(!this.beginRenderScopeInternal(!1))throw v.Log.Error(592328457,"Failed to enter render scope.");var i,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return T(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(e);try{for(n.s();!(i=n.n()).done;){var a=i.value,o=this.getProgramInWebGlScope(a);r.push(o.enureDoneAsync())}}catch(e){n.e(e)}finally{n.f()}return this.endRenderScopeInternal(!1),r}},{key:"isInRenderScope",value:function(){return this.m_isInScope}},{key:"beginRenderScope",value:function(){if(!this.m_isInitializeReady)throw v.Log.Error(592525269,"Please, wait for onDone to be called in initialize.");return this.beginRenderScopeInternal(!0)}},{key:"endRenderScope",value:function(){this.endRenderScopeInternal(!0)}},{key:"beginRenderScopeInternal",value:function(e){var t=this.m_gl.isContextLost();return this.m_isInScope&&v.Log.Error(592525270,"already in glContext scope"),t&&v.Log.Error(592525271,"Invalnew glContext context is lostid"),!this.m_gl||t?this.m_isInScope=!1:(this.m_isInScope=!0,e&&(this.m_stateRestorer?(this.m_stateRestorer.init(this.m_gl),this.m_stateRestorer.setDefaults(),this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1):this.m_wipeStateBetweenScopes&&(this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1)),this.ensureVertexBufferAndMaxTapeInitialized()),this.m_isInScope}},{key:"endRenderScopeInternal",value:function(e){this.m_isInScope?this.m_gl.isContextLost()?v.Log.Error(592525273,"leaving glContext context is lost"):this.m_stateRestorer&&e&&this.m_stateRestorer.restore():v.Log.Error(592525272,"leaving glContext not in scope"),this.m_isInScope=!1}},{key:"ensureVertexBufferAndMaxTapeInitialized",value:function(){this.m_emptyTexture||(this.m_emptyTexture=this.createTextureGraphicsResource(h.Vector2.One,new Uint8Array([0,0,0,0]),p.TextureFormat.RGBA,!1,f.WrapMode.clamp,!1,!1)),this.m_whiteTexture||(this.m_whiteTexture=this.createTextureGraphicsResource(h.Vector2.One,new Uint8Array([1,1,1,1]),p.TextureFormat.RGBA,!1,f.WrapMode.clamp,!1,!1)),this.m_quadMesh||(this.m_quadMesh=g.Mesh.CreateGridXY(this,2,2,new h.Rect(-1,-1,1,1)))}},{key:"getProgramInWebGlScope",value:function(e){var t=this.m_shaderPrograms[e];return t||(t=this.m_shaderPrograms[e]=new k(this,e)),t}},{key:"createTextureGraphicsResourceFromExternalWebGLTexture",value:function(e,t,r,i,n){var a,o=r instanceof WebGLTexture?r:null;if(r instanceof u.InternalTexture&&(o=null===(a=r._hardwareTexture)||void 0===a?void 0:a.underlyingResource),!o)throw v.Log.Error(592525275,"wrong texture type");var s=E(i,n),l=new u.InternalTexture(this.m_engine,0,!0);return l._hardwareTexture=new _.WebGLHardwareTexture(o,this.m_engine._gl),l.width=e.x,l.height=e.y,l.baseWidth=e.x,l.baseHeight=e.y,l.type=0,l.format=t,this.m_engine.updateTextureSamplingMode(s,l,n),l}},{key:"updateTextureGraphicsResourceFromHTMLElement",value:function(e,t,r){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var i,n=this.m_gl,a=null===(i=e._hardwareTexture)||void 0===i?void 0:i.underlyingResource;a&&(n.bindTexture(n.TEXTURE_2D,a),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.bindTexture(n.TEXTURE_2D,null))}}},{key:"updateTextureGraphicsResourceFromByteBuffer",value:function(e,t,r,i){var n=this.m_engine;if(t instanceof Uint8Array||t instanceof Float32Array){var a=t,o=this.getTypeFromData(t,r);if(!(t instanceof Uint8Array&&0==o||t instanceof Float32Array&&1==o)){v.Log.Error(572867294,"Wrong buffer data type: needs conversion");for(var s=0==o?new Uint8Array(t.length):new Float32Array(t.length),l=0==o?255:1/255,c=0;c<t.length;c++)s[c]=t[c]*l;a=s}n._bindTextureDirectly(3553,e,!0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,i),n._uploadDataToTextureDirectly(e,a,0,0,void 0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,4),n._bindTextureDirectly(3553,null,!0,!0)}}},{key:"createTextureGraphicsRenderTargetResource",value:function(e,t,r,i,n,a,o,s){var l=this.m_engine,c=this.getTypeFromData(t,i),u=E(o,!!s),d=l.createRenderTargetTexture({width:e.x,height:e.y},{generateDepthBuffer:!1,generateStencilBuffer:n,format:r,type:c,samplingMode:u,generateMipMaps:!!s});if(!d.texture)throw v.Log.Error(592525276,"No InternalTexture in RenderTargetWrapper");return this.setWrapMode(d.texture,a),d}},{key:"createRenderTargetWrapper",value:function(e){return this.m_engine._createHardwareRenderTargetWrapper(!1,!1,{width:e.x,height:e.y})}},{key:"createTextureGraphicsResource",value:function(e,t,r,i,n,a,o,s,l){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var c,d=this.m_gl;if(c=d.createTexture()){d.bindTexture(d.TEXTURE_2D,c),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.bindTexture(d.TEXTURE_2D,null);var h=this.createTextureGraphicsResourceFromExternalWebGLTexture(e,r,c,a,!!l);return h&&this.setWrapMode(h,n),h}}var f=this.m_engine,m=this.getTypeFromData(t,i),p=E(a,!!l),g=new u.InternalTexture(f,u.InternalTextureSource.Unknown);return g.updateSize(e.x,e.y),g.type=m,g.format=r,g.invertY=o,f.updateTextureSamplingMode(p,g),(t instanceof Uint8Array||t instanceof Float32Array)&&this.updateTextureGraphicsResourceFromByteBuffer(g,t,i,s||4),this.setWrapMode(g,n),g}},{key:"getTypeFromData",value:function(e,t){var r=0;return t&&(e instanceof Float32Array&&this.m_renderToFilteredFloat?r=1:e||(this.m_renderToFilteredHalfFloat?r=2:this.m_renderToFilteredFloat&&(r=1))),r}},{key:"setRenderTarget",value:function(e){e?(this.m_engine.bindFramebuffer(e),this.m_currentRenderTarget=e):(this.m_engine.restoreDefaultFramebuffer(),this.m_currentRenderTarget=void 0)}},{key:"setWrapMode",value:function(e,t){if(!e)throw v.Log.Error(592525277,"Invalid texture resource");var r=t==f.WrapMode.clamp?0:t==f.WrapMode.tileFlipX||t==f.WrapMode.tileFlipXY?2:1,i=t==f.WrapMode.clamp?0:t==f.WrapMode.tileFlipY||t==f.WrapMode.tileFlipXY?2:1;this.m_engine.updateTextureWrappingMode(e,r,i)}},{key:"copyTexturePixelsToArray",value:function(e,t,r){if(!e.texture)throw v.Log.Error(507011862,"Invalid texture resource");var i=Math.floor(t.left),n=Math.floor(t.top),a=Math.floor(t.width),o=Math.floor(t.height);this.setRenderTarget(e);var s=this.m_engine._readTexturePixelsSync(e.texture,a,o,void 0,void 0,void 0,void 0,void 0,i,n);return this.setRenderTarget(void 0),s}},{key:"getCurrentViewportSize",value:function(){return this.m_currentRenderTarget?new h.Vector2(this.m_currentRenderTarget.width,this.m_currentRenderTarget.height):this.m_canvasRenderSize}},{key:"setScissorRect",value:function(e,t){if(t||!(0,h.equals)(e,this.m_currentScissorRect)){var r=this.m_gl,i=this.getCurrentViewportSize();e?(r.enable(r.SCISSOR_TEST),r.scissor(e.left,i.y-e.bottom,e.width,e.height)):(r.disable(r.SCISSOR_TEST),r.scissor(0,0,i.x,i.y))}this.m_currentScissorRect=e}},{key:"getUniqueGraphicsProcessorId",value:function(){return this.m_uniqueGraphicsProcessorId}},{key:"isFloatTextureSupported",value:function(){return this.m_renderToFilteredFloat||this.m_renderToFilteredHalfFloat}},{key:"activateShaderProgram",value:function(e){var t=this.getProgramInWebGlScope(e);return t.activate(),t}},{key:"getWebGLState",value:function(){return(0,y.getWebGLState)(this.m_gl)}},{key:"preCompileShaderAsync",value:function(e){this.beginRenderScopeInternal(!1)&&(this.getProgramInWebGlScope(e),this.endRenderScopeInternal(!1))}},{key:"preLinkShaderAsync",value:function(e){this.preCompileShaderAsync(e)}},{key:"tryPrepareProgramResourcesInWebGlScope",value:function(e){for(var t=0;t<S.ProgramId.countMinimalSet;t++)this.m_shaderPrograms[t]||this.getProgramInWebGlScope(t);return!0}}]);var e}();t.GraphicsProcessor=I;var k=(0,l.default)((function e(t,r){(0,s.default)(this,e),this.graphicsProcessor=t,this.m_engine=t.getBabylonEngine(),this.programId=r,this.m_effect=this.createEffect()}),[{key:"getBabylonEngine",value:function(){return this.m_engine}},{key:"getBabylonEffect",value:function(){return this.m_effect}},{key:"done",value:function(){return void 0!==this.effectErrors||this.m_effect.isReady()}},{key:"enureDoneAsync",value:function(){var e=this;return new Promise((function(t,r){e.done()?t(void 0):(e.m_effect.onCompileObservable.add((function(){return t(void 0)})),e.m_effect.onErrorObservable.add(r))}))}},{key:"createEffect",value:function(){var e=this;(0,S.getShaderCode)(this.programId)?v.Log.Message(507008355,"Using shader "+this.programId):v.Log.Message(592525280,"Compiling shader "+this.programId+" on demand");var t=new d.Effect({vertexSource:C[this.programId].v,fragmentSource:C[this.programId].f},C[this.programId].a,C[this.programId].u,C[this.programId].s,this.m_engine,void 0,void 0,void 0,(function(t,r){e.effectErrors=r}),void 0,(0,S.getEffectKey)(this.programId));return(0,S.setShaderCode)(this.programId,C[this.programId]),t}},{key:"activate",value:function(){this.handleActivationErrors(),this.m_engine.enableEffect(this.m_effect),this.m_currentMesh=void 0,this.bindMesh(void 0)}},{key:"bindMesh",value:function(e){var t=e||this.graphicsProcessor.quadMesh;t&&t.isValid(this.graphicsProcessor)?this.m_currentMesh!=t&&(t.vertexBuffer&&t.indexBuffer&&t.isValid(this.graphicsProcessor)&&(this.m_engine._bindIndexBufferWithCache(t.indexBuffer),P[0].index=this.m_effect.getAttributeLocationByName("a_v"),this.m_engine.bindInstancesBuffer(t.vertexBuffer,P,!1)),this.m_currentMesh=t):v.Log.Error(592525281,"Invalid Mesh")}},{key:"handleActivationErrors",value:function(){if(this.effectErrors||!this.m_effect.isReady()){var e="Program "+this.programId+" ";if(this.effectErrors){var t=this.m_effect.getPipelineContext();if(t.vertexCompilationError)throw v.Log.Error(592525282,e+"V compile failed: "+t.vertexCompilationError);if(t.fragmentCompilationError)throw v.Log.Error(592525283,e+"V compile failed: "+t.fragmentCompilationError);if(t.programLinkError)throw v.Log.Error(592525312,e+"link failed: "+t.programLinkError);if(t.programValidationError)throw v.Log.Error(592525313,e+"validation failed: "+t.programValidationError);throw v.Log.Error(592525314,e+"preparation failed:"+this.effectErrors)}if(!this.m_effect.isReady())throw v.Log.Error(592525315,e+"Effect not ready yet.")}}},{key:"setTexture",value:function(e,t){var r=t||this.graphicsProcessor.emptyTexture;this.m_effect._bindTexture(e,r||null)}},{key:"clearAndEnbaleDepthBuffer",value:function(){this.m_engine.depthCullingState.depthFunc=513,this.m_engine.depthCullingState.depthMask=!0,this.m_engine.depthCullingState.depthTest=!0,this.m_engine.clear(null,!1,!0,!1)}},{key:"setDistanceFieldStencilSumIncrement",value:function(e){var t=e?34055:34056,r=this.m_engine;r.stencilState.stencilOpStencilFail=t,r.stencilState.stencilOpDepthFail=t,r.stencilState.stencilOpStencilDepthPass=t}},{key:"setBlendingMode",value:function(e){var t=this.m_engine;t.alphaState.alphaBlend=!0,e==f.BlendingMode.normal?(t.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),t.alphaState.setAlphaEquationParameters(32774,32774)):e==f.BlendingMode.darken?(t.alphaState.setAlphaBlendFunctionParameters(1,1,0,1),t.alphaState.setAlphaEquationParameters(32775,32774)):e==f.BlendingMode.exclusion?(t.alphaState.setAlphaBlendFunctionParameters(775,769,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==f.BlendingMode.cutout?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32779,32779)):e==f.BlendingMode.add?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==f.BlendingMode.multiply?(t.alphaState.setAlphaBlendFunctionParameters(774,0,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):e==f.BlendingMode.simulateOverlay?v.Log.Error(507581190,"simulateOverlay should be handled as a 2 pass approach with multiply and add"):v.Log.Error(592525318,"Wrong blending mode")}},{key:"begin",value:function(e,t,r){var i=this.m_engine;this.graphicsProcessor.setRenderTarget(e),this.m_engine.setViewport(w),t&&i.clear(t,!0,!1,!1),r?this.setBlendingMode(f.BlendingMode.normal):i.alphaState.alphaBlend=!1,i.depthCullingState.depthTest=!1,i.depthCullingState.depthMask=!0,i.stencilState.stencilTest=!1,i.stencilState.stencilMask=255,i.setColorWrite(!0)}},{key:"end",value:function(){this.graphicsProcessor.setRenderTarget(void 0),this.m_engine.unbindInstanceAttributes(),this.m_engine.setViewport(w)}},{key:"drawQuads",value:function(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6*e)}},{key:"drawQuadInstances",value:function(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6,e)}},{key:"drawMesh",value:function(e){this.bindMesh(e),this.m_engine.drawElementsType(0,0,3*e.triangleCount)}},{key:"setDummyPointerAttribute",value:function(e){if(this.graphicsProcessor.quadMesh&&this.graphicsProcessor.quadMesh.vertexBuffer){var t=this.graphicsProcessor.quadMesh.vertexBuffer,r=this.m_engine,i=[{attributeName:e,attributeSize:1,offset:0,divisor:0,index:this.m_effect.getAttributeLocationByName(e)}];r.bindInstancesBuffer(t,i,!1)}else v.Log.Error(592525319,"Quad not initialized")}},{key:"disableInstanceAttribute",value:function(e){this.m_engine.disableInstanceAttributeByName(e)}}]);function E(e,t){return e?t?3:2:1}t.ShaderProgram=k},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLShaderProcessor=void 0;var n=i(r(1)),a=i(r(2)),o=r(48),s=(0,a.default)((function e(){(0,n.default)(this,e),this.shaderLanguage=o.ShaderLanguage.GLSL}),[{key:"postProcessor",value:function(e,t,r,i,n){return n.drawBuffersExtensionDisabled&&(e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")),e}}]);t.WebGLShaderProcessor=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGL2ShaderProcessor=void 0;var n=i(r(1)),a=i(r(2)),o=r(48),s=/(flat\s)?\s*varying\s*.*/,l=(0,a.default)((function e(){(0,n.default)(this,e),this.shaderLanguage=o.ShaderLanguage.GLSL}),[{key:"attributeProcessor",value:function(e){return e.replace("attribute","in")}},{key:"varyingCheck",value:function(e,t){return s.test(e)}},{key:"varyingProcessor",value:function(e,t){return e.replace("varying",t?"in":"out")}},{key:"postProcessor",value:function(e,t,r){var i=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),r){var n=-1!==e.search(/layout *\(location *= *0\) *out/g);e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(i||n?"":"layout(location = 0) out vec4 glFragColor;\n")+"void main(")}else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e}}]);t.WebGL2ShaderProcessor=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DataBuffer=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=e._Counter++}),[{key:"underlyingResource",get:function(){return null}}]);t.DataBuffer=a,a._Counter=0},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.QueueNewFrame=w,t.AbstractEngine=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(239),c=r(61),u=r(88),d=r(240),h=r(241),f=r(242),m=r(243),p=r(244),g=r(245),v=r(107),y=r(40),_=r(71),S=r(86),T=r(60);function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function w(e,t){if((0,_.IsWindowObjectExist)()){var r=(t||window).requestAnimationFrame;if("function"==typeof r)return r(e)}else if("function"==typeof requestAnimationFrame)return requestAnimationFrame(e);return setTimeout(e,16)}var P=function(){function e(t,r,i){var n,a,s,c,u,v,y,T,b,C,w,P,I=this;(0,o.default)(this,e),this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new f.DepthCullingState,this._stencilStateComposer=new m.StencilStateComposer,this._stencilState=new p.StencilState,this._alphaState=new g.AlphaState,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new S.Observable,this.onCanvasFocusObservable=new S.Observable,this.onNewSceneAddedObservable=new S.Observable,this.onResizeObservable=new S.Observable,this.onCanvasPointerOutObservable=new S.Observable,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new S.Observable,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=function(){return I._renderLoop()},this.onBeforeShaderCompilationObservable=new S.Observable,this.onAfterShaderCompilationObservable=new S.Observable,this.onBeginFrameObservable=new S.Observable,this.onEndFrameObservable=new S.Observable,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new S.Observable,this.onContextRestoredObservable=new S.Observable,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.onDisposeObservable=new S.Observable,l.EngineStore.Instances.push(this),this.startTime=h.PrecisionDate.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,d.PerformanceConfigurator.SetMatrixPrecision(!!r.useHighPrecisionMatrix),(0,_.IsNavigatorAvailable)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=null!==(n=i)&&void 0!==n&&n,r.antialias=null!=t?t:r.antialias,r.deterministicLockstep=null!==(a=r.deterministicLockstep)&&void 0!==a&&a,r.lockstepMaxSteps=null!==(s=r.lockstepMaxSteps)&&void 0!==s?s:4,r.timeStep=null!==(c=r.timeStep)&&void 0!==c?c:1/60,r.audioEngine=null===(u=r.audioEngine)||void 0===u||u,r.stencil=null===(v=r.stencil)||void 0===v||v,this._audioContext=null!==(y=null===(T=r.audioEngineOptions)||void 0===T?void 0:T.audioContext)&&void 0!==y?y:null,this._audioDestination=null!==(b=null===(C=r.audioEngineOptions)||void 0===C?void 0:C.audioDestination)&&void 0!==b?b:null,this.premultipliedAlpha=null===(w=r.premultipliedAlpha)||void 0===w||w,this._doNotHandleContextLost=!!r.doNotHandleContextLost,this._isStencilEnable=!!r.stencil,this.useExactSrgbConversions=null!==(P=r.useExactSrgbConversions)&&void 0!==P&&P;var k=(0,_.IsWindowObjectExist)()&&window.devicePixelRatio||1,E=r.limitDeviceRatio||k;i=i||r.adaptToDeviceRatio||!1,this._hardwareScalingLevel=i?1/Math.min(E,k):1,this._lastDevicePixelRatio=k,this._creationOptions=r}return(0,s.default)(e,[{key:"frameId",get:function(){return this._frameId}},{key:"isWebGPU",get:function(){return this._isWebGPU}},{key:"_getShaderProcessor",value:function(e){return this._shaderProcessor}},{key:"shaderPlatformName",get:function(){return this._shaderPlatformName}},{key:"_clearEmptyResources",value:function(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}},{key:"useReverseDepthBuffer",get:function(){return this._useReverseDepthBuffer},set:function(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?518:515)}},{key:"setColorWrite",value:function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)}},{key:"getColorWrite",value:function(){return this._colorWrite}},{key:"depthCullingState",get:function(){return this._depthCullingState}},{key:"alphaState",get:function(){return this._alphaState}},{key:"stencilState",get:function(){return this._stencilState}},{key:"stencilStateComposer",get:function(){return this._stencilStateComposer}},{key:"_getGlobalDefines",value:function(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);var t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(t&&(t+="\n"),t+="#define USE_EXACT_SRGB_CONVERSIONS"),t}},{key:"_rebuildInternalTextures",value:function(){var e,t=b(this._internalTexturesCache.slice());try{for(t.s();!(e=t.n()).done;)e.value._rebuild()}catch(e){t.e(e)}finally{t.f()}}},{key:"_rebuildRenderTargetWrappers",value:function(){var e,t=b(this._renderTargetWrapperCache.slice());try{for(t.s();!(e=t.n()).done;)e.value._rebuild()}catch(e){t.e(e)}finally{t.f()}}},{key:"_rebuildEffects",value:function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null,t._prepareEffect()}u.Effect.ResetCache()}},{key:"_rebuildGraphicsResources",value:function(){var e;this.wipeCaches(!0),this._rebuildEffects(),null===(e=this._rebuildComputeEffects)||void 0===e||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}},{key:"_flagContextRestored",value:function(){c.Logger.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}},{key:"_restoreEngineAfterContextLost",value:function(e){var t=this;setTimeout((0,a.default)(n.default.mark((function r(){var i,a,o,s;return n.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t._clearEmptyResources(),i=t._depthCullingState.depthTest,a=t._depthCullingState.depthFunc,o=t._depthCullingState.depthMask,s=t._stencilState.stencilTest,r.next=7,e();case 7:t._rebuildGraphicsResources(),t._depthCullingState.depthTest=i,t._depthCullingState.depthFunc=a,t._depthCullingState.depthMask=o,t._stencilState.stencilTest=s,t._flagContextRestored();case 13:case"end":return r.stop()}}),r)}))),0)}},{key:"isDisposed",get:function(){return this._isDisposed}},{key:"snapshotRendering",get:function(){return!1},set:function(e){}},{key:"snapshotRenderingMode",get:function(){return 0},set:function(e){}},{key:"getClassName",value:function(){return"AbstractEngine"}},{key:"emptyTexture",get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}},{key:"emptyTexture3D",get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}},{key:"emptyTexture2DArray",get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}},{key:"emptyCubeTexture",get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture}},{key:"activeRenderLoops",get:function(){return this._activeRenderLoops}},{key:"stopRenderLoop",value:function(e){if(!e)return this._activeRenderLoops.length=0,void this._cancelFrame();var t=this._activeRenderLoops.indexOf(e);t>=0&&(this._activeRenderLoops.splice(t,1),0==this._activeRenderLoops.length&&this._cancelFrame())}},{key:"_cancelFrame",value:function(){if(0!==this._frameHandler){var e=this._frameHandler;if(this._frameHandler=0,(0,_.IsWindowObjectExist)()){var t=(this.getHostWindow()||window).cancelAnimationFrame;if("function"==typeof t)return t(e)}else if("function"==typeof cancelAnimationFrame)return cancelAnimationFrame(e);return clearTimeout(e)}}},{key:"beginFrame",value:function(){this.onBeginFrameObservable.notifyObservers(this)}},{key:"endFrame",value:function(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}},{key:"_renderLoop",value:function(){if(this._frameHandler=0,!this._contextWasLost){var e=!0;(this._isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}},{key:"_renderFrame",value:function(){for(var e=0;e<this._activeRenderLoops.length;e++)(0,this._activeRenderLoops[e])()}},{key:"_renderViews",value:function(){return!1}},{key:"_queueNewFrame",value:function(e,t){return w(e,t)}},{key:"runRenderLoop",value:function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}},{key:"getDepthBuffer",value:function(){return this._depthCullingState.depthTest}},{key:"setDepthBuffer",value:function(e){this._depthCullingState.depthTest=e}},{key:"setZOffset",value:function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e}},{key:"getZOffset",value:function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e}},{key:"setZOffsetUnits",value:function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e}},{key:"getZOffsetUnits",value:function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e}},{key:"getHostWindow",value:function(){return(0,_.IsWindowObjectExist)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}},{key:"compatibilityMode",get:function(){return this._compatibilityMode},set:function(e){this._compatibilityMode=!0}},{key:"_rebuildTextures",value:function(){var e,t=b(this.scenes);try{for(t.s();!(e=t.n()).done;)e.value._rebuildTextures()}catch(e){t.e(e)}finally{t.f()}var r,i=b(this._virtualScenes);try{for(i.s();!(r=i.n()).done;)r.value._rebuildTextures()}catch(e){i.e(e)}finally{i.f()}}},{key:"_releaseRenderTargetWrapper",value:function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)}},{key:"currentViewport",get:function(){return this._cachedViewport}},{key:"setViewport",value:function(e,t,r){var i=t||this.getRenderWidth(),n=r||this.getRenderHeight(),a=e.x||0,o=e.y||0;this._cachedViewport=e,this._viewport(a*i,o*n,i*e.width,n*e.height)}},{key:"createCanvasImage",value:function(){return document.createElement("img")}},{key:"description",get:function(){var e=this.name+this.version;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e}},{key:"_createTextureBase",value:function(t,r,i,n){var a=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,m=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,p=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,g=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,v=arguments.length>13?arguments[13]:void 0,_=arguments.length>14?arguments[14]:void 0,S=arguments.length>15?arguments[15]:void 0,T="data:"===(t=t||"").substr(0,5),C="blob:"===t.substr(0,5),w=T&&-1!==t.indexOf(";base64,"),P=m||new y.InternalTexture(this,y.InternalTextureSource.Url);P!==m&&(P.label=t.substring(0,60));var I=t;!this._transformTextureUrl||w||m||f||(t=this._transformTextureUrl(t)),I!==t&&(P._originalUrl=I);var k=t.lastIndexOf("."),E=g||(k>-1?t.substring(k).toLowerCase():""),x=null,L=E.indexOf("?");L>-1&&(E=E.split("?")[0]);var A,M=b(e._TextureLoaders);try{for(M.s();!(A=M.n()).done;){var R=A.value;if(R.canLoad(E,v)){x=R;break}}}catch(e){M.e(e)}finally{M.f()}n&&n.addPendingData(P),P.url=t,P.generateMipMaps=!r,P.samplingMode=o,P.invertY=i,P._useSRGBBuffer=this._getUseSRGBBuffer(!!S,r),this._doNotHandleContextLost||(P._buffer=f);var O=null;s&&!m&&(O=P.onLoadedObservable.add(s)),m||this._internalTexturesCache.push(P);var D=function(e,i){n&&n.removePendingData(P),t===I?(O&&P.onLoadedObservable.remove(O),l.EngineStore.UseFallbackTexture&&t!==l.EngineStore.FallbackTexture&&a._createTextureBase(l.EngineStore.FallbackTexture,r,P.invertY,n,o,null,u,d,h,f,P),e=(e||"Unknown error")+(l.EngineStore.UseFallbackTexture?" - Fallback texture was used":""),P.onErrorObservable.notifyObservers({message:e,exception:i}),u&&u(e,i)):(c.Logger.Warn("Failed to load ".concat(t,", falling back to ").concat(I)),a._createTextureBase(I,r,P.invertY,n,o,s,u,d,h,f,P,p,g,v,_,S))};if(x){var F=function(e){x.loadData(e,P,(function(e,t,r,i,a,s){s?D("TextureLoader failed to load data"):d(P,E,n,{width:e,height:t},P.invertY,!r,i,(function(){return a(),!1}),o)}),_)};f?f instanceof ArrayBuffer?F(new Uint8Array(f)):ArrayBuffer.isView(f)?F(f):u&&u("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,(function(e){return F(new Uint8Array(e))}),void 0,n?n.offlineProvider:void 0,!0,(function(e,t){D("Unable to load "+(e&&e.responseURL,t))}))}else{var B=function(e){C&&!a._doNotHandleContextLost&&(P._buffer=e),d(P,E,n,e,P.invertY,r,!1,h,o)};!T||w?f&&("string"==typeof f.decoding||f.close)?B(f):e._FileToolsLoadImage(t||"",B,D,n?n.offlineProvider:null,v,P.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof f||f instanceof ArrayBuffer||ArrayBuffer.isView(f)||f instanceof Blob?e._FileToolsLoadImage(f,B,D,n?n.offlineProvider:null,v,P.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):f&&B(f)}return P}},{key:"_rebuildBuffers",value:function(){var e,t=b(this._uniformBuffers);try{for(t.s();!(e=t.n()).done;)e.value._rebuildAfterContextLost()}catch(e){t.e(e)}finally{t.f()}}},{key:"_shouldUseHighPrecisionShader",get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}},{key:"getHostDocument",value:function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,_.IsDocumentAvailable)()?document:null}},{key:"getLoadedTexturesCache",value:function(){return this._internalTexturesCache}},{key:"clearInternalTexturesCache",value:function(){this._internalTexturesCache.length=0}},{key:"getCaps",value:function(){return this._caps}},{key:"resetTextureCache",value:function(){for(var e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"getRenderingCanvas",value:function(){return this._renderingCanvas}},{key:"getAudioContext",value:function(){return this._audioContext}},{key:"getAudioDestination",value:function(){return this._audioDestination}},{key:"setHardwareScalingLevel",value:function(e){this._hardwareScalingLevel=e,this.resize()}},{key:"getHardwareScalingLevel",value:function(){return this._hardwareScalingLevel}},{key:"doNotHandleContextLost",get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e}},{key:"isStencilEnable",get:function(){return this._isStencilEnable}},{key:"getCreationOptions",value:function(){return this._creationOptions}},{key:"resize",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.adaptToDeviceRatio){var i=(0,_.IsWindowObjectExist)()&&window.devicePixelRatio||1,n=this._lastDevicePixelRatio/i;this._lastDevicePixelRatio=i,this._hardwareScalingLevel*=n}if((0,_.IsWindowObjectExist)()&&(0,_.IsDocumentAvailable)())if(this._renderingCanvas){var a=this._renderingCanvas.getBoundingClientRect?this._renderingCanvas.getBoundingClientRect():{width:this._renderingCanvas.width*this._hardwareScalingLevel,height:this._renderingCanvas.height*this._hardwareScalingLevel};e=this._renderingCanvas.clientWidth||a.width||this._renderingCanvas.width||100,t=this._renderingCanvas.clientHeight||a.height||this._renderingCanvas.height||100}else e=window.innerWidth,t=window.innerHeight;else e=this._renderingCanvas?this._renderingCanvas.width:100,t=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(e/this._hardwareScalingLevel,t/this._hardwareScalingLevel,r)}},{key:"setSize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(e|=0,t|=0,!r&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)return!1;if(this._renderingCanvas.width=e,this._renderingCanvas.height=t,this.scenes){for(var i=0;i<this.scenes.length;i++)for(var n=this.scenes[i],a=0;a<n.cameras.length;a++){var o=n.cameras[a];o._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}},{key:"createRawTexture",value:function(e,t,r,i,n,a,o,s,l,c,u){throw(0,v._WarnImport)("engine.rawTexture")}},{key:"createRawCubeTexture",value:function(e,t,r,i,n,a,o,s){throw(0,v._WarnImport)("engine.rawTexture")}},{key:"createRawTexture3D",value:function(e,t,r,i,n,a,o,s,l,c,u){throw(0,v._WarnImport)("engine.rawTexture")}},{key:"createRawTexture2DArray",value:function(e,t,r,i,n,a,o,s,l,c,u){throw(0,v._WarnImport)("engine.rawTexture")}},{key:"_sharedInit",value:function(e){this._renderingCanvas=e}},{key:"_setupMobileChecks",value:function(){var e=this;navigator&&navigator.userAgent&&(this._checkForMobile=function(){var t=navigator.userAgent;e.hostInformation.isMobile=-1!==t.indexOf("Mobile")||-1!==t.indexOf("Mac")&&(0,_.IsDocumentAvailable)()&&"ontouchend"in document},this._checkForMobile(),(0,_.IsWindowObjectExist)()&&window.addEventListener("resize",this._checkForMobile))}},{key:"createVideoElement",value:function(e){return document.createElement("video")}},{key:"_reportDrawCall",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;null===(e=this._drawCalls)||void 0===e||e.addCount(t,!1)}},{key:"getFps",value:function(){return this._fps}},{key:"getDeltaTime",value:function(){return this._deltaTime}},{key:"isDeterministicLockStep",value:function(){return this._deterministicLockstep}},{key:"getLockstepMaxSteps",value:function(){return this._lockstepMaxSteps}},{key:"getTimeStep",value:function(){return 1e3*this._timeStep}},{key:"_createImageBitmapFromSource",value:function(e,t){throw new Error("createImageBitmapFromSource is not implemented")}},{key:"createImageBitmap",value:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return createImageBitmap(e,t)}))},{key:"resizeImageBitmap",value:function(e,t,r){throw new Error("resizeImageBitmap is not implemented")}},{key:"getFontOffset",value:function(e){throw new Error("getFontOffset is not implemented")}},{key:"createCanvas",value:function(t,r){return e._CreateCanvas(t,r)}},{key:"_loadFile",value:function(e,t,r,i,n,a){var o=this,s=(0,T._loadFile)(e,t,r,i,n,a);return this._activeRequests.push(s),s.onCompleteObservable.add((function(){var e=o._activeRequests.indexOf(s);-1!==e&&o._activeRequests.splice(e,1)})),s}},{key:"dispose",value:function(){var e;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),u.Effect.ResetCache();var t,r=b(this._activeRequests);try{for(r.s();!(t=r.n()).done;)t.value.abort()}catch(e){r.e(e)}finally{r.f()}this._boundRenderFunction=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),(0,_.IsWindowObjectExist)()&&window.removeEventListener("resize",this._checkForMobile);var i=l.EngineStore.Instances.indexOf(this);i>=0&&l.EngineStore.Instances.splice(i,1),l.EngineStore.Instances.length||(l.EngineStore.OnEnginesDisposedObservable.notifyObservers(this),l.EngineStore.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}}],[{key:"NpmPackage",get:function(){return"babylonjs@7.11.2"}},{key:"Version",get:function(){return"7.11.2"}},{key:"_CreateCanvas",value:function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var r=document.createElement("canvas");return r.width=e,r.height=t,r}},{key:"_FileToolsLoadImage",value:function(e,t,r,i,n,a){throw(0,v._WarnImport)("FileTools")}},{key:"_FileToolsLoadFile",value:function(e,t,r,i,n,a){if(T.EngineFunctionContext.loadFile)return T.EngineFunctionContext.loadFile(e,t,r,i,n,a);throw(0,v._WarnImport)("FileTools")}},{key:"DefaultLoadingScreenFactory",value:function(e){throw(0,v._WarnImport)("LoadingScreen")}}])}();t.AbstractEngine=P,P._TextureLoaders=[],P._RenderPassIdCounter=0,P._RescalePostProcessFactory=null},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"p_0",{enumerable:!0,get:function(){return i.p_0}}),Object.defineProperty(t,"p_1",{enumerable:!0,get:function(){return n.p_1}}),Object.defineProperty(t,"p_2",{enumerable:!0,get:function(){return a.p_2}}),Object.defineProperty(t,"p_3",{enumerable:!0,get:function(){return o.p_3}}),Object.defineProperty(t,"p_4",{enumerable:!0,get:function(){return s.p_4}}),Object.defineProperty(t,"p_5",{enumerable:!0,get:function(){return l.p_5}}),Object.defineProperty(t,"p_6",{enumerable:!0,get:function(){return c.p_6}}),Object.defineProperty(t,"p_7",{enumerable:!0,get:function(){return u.p_7}}),Object.defineProperty(t,"p_8",{enumerable:!0,get:function(){return d.p_8}}),Object.defineProperty(t,"p_9",{enumerable:!0,get:function(){return h.p_9}}),Object.defineProperty(t,"p_10",{enumerable:!0,get:function(){return f.p_10}}),Object.defineProperty(t,"p_11",{enumerable:!0,get:function(){return m.p_11}});var i=r(249),n=r(250),a=r(251),o=r(252),s=r(253),l=r(254),c=r(255),u=r(256),d=r(257),h=r(258),f=r(259),m=r(260)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getWebGLState=s,t.StateRestorerGL=void 0;var n=i(r(1)),a=i(r(2)),o=r(13);function s(e){for(var t=[e.ACTIVE_TEXTURE,e.ARRAY_BUFFER_BINDING,e.BLEND,e.BLEND_COLOR,e.BLEND_DST_ALPHA,e.BLEND_DST_RGB,e.BLEND_EQUATION_ALPHA,e.BLEND_EQUATION_RGB,e.BLEND_SRC_ALPHA,e.BLEND_SRC_RGB,e.COLOR_CLEAR_VALUE,e.COLOR_WRITEMASK,e.CULL_FACE,e.CULL_FACE_MODE,e.CURRENT_PROGRAM,e.DEPTH_CLEAR_VALUE,e.DEPTH_FUNC,e.DEPTH_RANGE,e.DEPTH_TEST,e.DEPTH_WRITEMASK,e.DITHER,e.ELEMENT_ARRAY_BUFFER_BINDING,e.FRAMEBUFFER_BINDING,e.FRONT_FACE,e.GENERATE_MIPMAP_HINT,e.LINE_WIDTH,e.PACK_ALIGNMENT,e.POLYGON_OFFSET_FACTOR,e.POLYGON_OFFSET_FILL,e.POLYGON_OFFSET_UNITS,e.RENDERBUFFER_BINDING,e.SAMPLE_COVERAGE_INVERT,e.SAMPLE_COVERAGE_VALUE,e.SCISSOR_BOX,e.SCISSOR_TEST,e.STENCIL_BACK_FAIL,e.STENCIL_BACK_FUNC,e.STENCIL_BACK_PASS_DEPTH_FAIL,e.STENCIL_BACK_PASS_DEPTH_PASS,e.STENCIL_BACK_REF,e.STENCIL_BACK_VALUE_MASK,e.STENCIL_BACK_WRITEMASK,e.STENCIL_CLEAR_VALUE,e.STENCIL_FAIL,e.STENCIL_FUNC,e.STENCIL_PASS_DEPTH_FAIL,e.STENCIL_PASS_DEPTH_PASS,e.STENCIL_REF,e.STENCIL_TEST,e.STENCIL_VALUE_MASK,e.STENCIL_WRITEMASK,e.TEXTURE_BINDING_2D,e.TEXTURE_BINDING_CUBE_MAP,e.UNPACK_ALIGNMENT,e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.UNPACK_FLIP_Y_WEBGL,e.UNPACK_PREMULTIPLY_ALPHA_WEBGL],r=e.getParameter(e.VIEWPORT),i=new Array(57),n=0;n<57;n++)i[n]=e.getParameter(t[n]);for(var a=new Array(2),o=0;o<2;o++)a[o]=e.getVertexAttrib(o,e.VERTEX_ATTRIB_ARRAY_ENABLED);return{viewport:r,params:i,VERTEX_ATTRIB_ARRAY_ENABLED:a}}var l=(0,a.default)((function e(t){(0,n.default)(this,e),this.webGLRestoreToDefault=!1,this.old=new Array(57),this.old_VERTEX_ATTRIB_ARRAY_ENABLED=new Array(2),this.webGLRestoreToDefault=t}),[{key:"init",value:function(e){if(this.gl&&o.Log.Error(591663577,"Previous Init has not been Restored"),this.gl=e,this.webGLRestoreToDefault)this.old_VIEWPORT=e.getParameter(e.VIEWPORT);else{var t=s(e),r=t.viewport,i=t.params,n=t.VERTEX_ATTRIB_ARRAY_ENABLED;this.old_VIEWPORT=r,this.old=i,this.old_VERTEX_ATTRIB_ARRAY_ENABLED=n}}},{key:"setDefaults",value:function(){var e=this.gl;if(e){e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,null),e.disable(e.BLEND),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.disable(e.CULL_FACE),e.cullFace(e.BACK),e.useProgram(null),e.clearDepth(1),e.depthFunc(e.LESS),e.depthRange(0,1),e.disable(e.DEPTH_TEST),e.depthMask(!0),e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.polygonOffset(0,0),e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,null),e.sampleCoverage(1,!1),e.scissor(0,0,this.old_VIEWPORT[2],this.old_VIEWPORT[3]),e.disable(e.SCISSOR_TEST),e.stencilFunc(e.ALWAYS,0,1),e.stencilMask(255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(var t=0;t<2;t++)e.disableVertexAttribArray(t)}else o.Log.Error(591663578,"Trying to set default without Init")}},{key:"restore",value:function(){var e=this.gl;if(e){var t=this.old;if(this.webGLRestoreToDefault)this.setDefaults();else{e.activeTexture(t[0]),e.bindBuffer(e.ARRAY_BUFFER,t[1]),t[2]?e.enable(e.BLEND):e.disable(e.BLEND);var r=t[3];e.blendColor(r[0],r[1],r[2],r[3]),e.blendEquationSeparate(t[7],t[6]),e.blendFuncSeparate(t[9],t[5],t[8],t[4]);var i=t[10];e.clearColor(i[0],i[1],i[2],i[3]);var n=t[11];e.colorMask(n[0],n[1],n[2],n[3]),t[12]?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.cullFace(t[13]),e.useProgram(t[14]),e.clearDepth(t[15]),e.depthFunc(t[16]),e.depthRange(t[17][0],t[17][1]),t[18]?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(t[19]),t[20]?e.enable(e.DITHER):e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t[21]),e.bindFramebuffer(e.FRAMEBUFFER,t[22]),e.frontFace(t[23]),e.hint(e.GENERATE_MIPMAP_HINT,t[24]),e.lineWidth(t[25]),e.pixelStorei(e.PACK_ALIGNMENT,t[26]),e.polygonOffset(t[27],t[29]),t[28]?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,t[30]),e.sampleCoverage(t[32],t[31]);var a=t[33];e.scissor(a[0],a[1],a[2],a[3]),t[34]?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFuncSeparate(e.FRONT,t[44],t[47],t[49]),e.stencilFuncSeparate(e.BACK,t[36],t[39],t[40]),e.stencilMaskSeparate(e.FRONT,t[50]),e.stencilMaskSeparate(e.BACK,t[41]),e.stencilOpSeparate(e.FRONT,t[43],t[45],t[46]),e.stencilOpSeparate(e.BACK,t[35],t[37],t[38]),e.clearStencil(t[42]),t[48]?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,t[51]),e.bindTexture(e.TEXTURE_CUBE_MAP,t[52]),e.pixelStorei(e.UNPACK_ALIGNMENT,t[53]),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,t[54]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t[55]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t[56]),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(var s=0;s<2;s++)this.old_VERTEX_ATTRIB_ARRAY_ENABLED[s]?e.enableVertexAttribArray(s):e.disableVertexAttribArray(s)}this.gl=void 0}else o.Log.Error(591663579,"Trying to Restore without Init")}}]);t.StateRestorerGL=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MorphPlayer=t.DuckMorphElementRenderData=t.DuckMorphKeyFrameRenderData=void 0;var n=i(r(1)),a=i(r(2)),o=r(12),s=r(16),l=r(30),c=r(39),u=r(38),d=r(51),h=r(63),f=r(89),m=r(13),p=r(50),g=r(84),v=r(41);function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var S=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"releaseGeneratedResources",value:function(){this.texture&&this.texture.releasePolicy==u.TextureReleasePolicy.DisposableCache&&this.texture.release(),this.textureDeltaWhite&&this.textureDeltaWhite.releasePolicy==u.TextureReleasePolicy.DisposableCache&&this.textureDeltaWhite.release(),this.texturePicture&&this.texturePicture.releasePolicy==u.TextureReleasePolicy.DisposableCache&&this.texturePicture.release()}},{key:"onFinalization",value:function(){}}]);t.DuckMorphKeyFrameRenderData=S;var T=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"releaseGeneratedResources",value:function(){var e;null===(e=this.interpolatedShapeSprite)||void 0===e||e.release()}},{key:"onFinalization",value:function(){}}]);t.DuckMorphElementRenderData=T;var b=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"tryInitMorphKeyFrame",value:function(e,t,r){var i,n,a=e.ensureMorphKeyFrameRenderData(t);if(!(a.texture&&!a.texture.size.isZero()&&a.texture.isValid(e)&&(!a.textureDeltaWhite||a.textureDeltaWhite.isValid(e))&&(!a.texturePicture||a.texturePicture.isValid(e)))&&r&&(a.texture&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=a.texture.memoryUsage),a.textureDeltaWhite&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=a.textureDeltaWhite.memoryUsage)),r){var c=function(e,t){if(1==t.contents.length){var r=t.contents[0];if(r&&r.item instanceof l.Shape){var i=r.item.style.pictureBrush;if(i&&i.image){var n=e.getTextureFromImageBrush(i),a=(0,l.getAlignmentPoint)(i.alignment).multiply(o.Vector2.One.subtract(i.scale)),s=o.Rect.FromSize(i.scale).translate(a.add(i.offset).subtract(new o.Vector2(.5,.5)));if(n)return{texture:n,pictureRelativeBounds:s}}}}m.Log.Error(572073356,"Texture not found")}(e,t);c&&(a.texturePicture=c.texture,a.pictureRelativeBounds=c.pictureRelativeBounds)}if(a.texture&&!a.texture.size.isZero()&&a.texture.isValid(e)&&(!a.textureDeltaWhite||a.textureDeltaWhite.isValid(e)))return!0;var u,d=void 0,h=y(t.contents);try{for(h.s();!(u=h.n()).done;){var f=u.value,p=o.Matrix3.FromTransforms(t.parentTransform||o.Matrix3.Identity,f.item.animationTransform||o.Matrix3.Identity),g=(0,l.getBoundsForEffects)(f.item,f.includeSubtree||null!=f.textRange,l.EffectFlags.all,l.EffectFlags.all,p,f.includeSubtree,f.textRange);d=o.Rect.UnionRect(d,g)}}catch(e){h.e(e)}finally{h.f()}return null===(i=a.texture)||void 0===i||i.release(),null===(n=a.textureDeltaWhite)||void 0===n||n.release(),d&&(t.location?r?(a.texture=C(e,t,d,s.Color.Black),a.textureDeltaWhite=C(e,t,d,s.Color.White)):a.texture=C(e,t,d,void 0):m.Log.Error(591672911,"No KeyFrame location")),!0}},{key:"tryPrepareMorphInRenderScope",value:function(e,t,r){if(!e.getGraphicsProcessor())return m.Log.Error(575942947,"glContext must be provided"),!1;var i=performance.now();e.m_initDeadline=r?i+r:void 0;var n,a=[],o=y(t.elements);try{for(o.s();!(n=o.n()).done;){var s,u=y(n.value.keyFrames);try{for(u.s();!(s=u.n()).done;){var d=s.value;if(d){var h=e.ensureMorphKeyFrameRenderData(d);if(!h.texture||h.texture.size.isZero()||!h.texture.isValid(e)){var f,p=y(d.contents);try{var g=function(){var e=f.value;if(e.item instanceof l.Shape){var t=e.item;if(e.textRange)if(t.text){var r=t.text.getFullRange();r&&r.contains(e.textRange)?e.textRange.equals(r)||t.text.forceSplit(c.TextSplit.ByLetter):m.Log.Error(591672913,"Text KeyFrame out of range: ["+e.textRange.start+", "+e.textRange.last+"], fullRange: "+(r?"["+r.start+", "+r.last+"]":"undefined"))}else m.Log.Error(591672914,"Text KeyFrame on Shape with no Text")}e.item&&!a.find((function(t){return t==e.item}))&&a.push(e.item)};for(p.s();!(f=p.n()).done;)g()}catch(e){p.e(e)}finally{p.f()}}}}}catch(e){u.e(e)}finally{u.f()}}}catch(e){o.e(e)}finally{o.f()}for(var v=0,_=a;v<_.length;v++){var S=_[v],T=e.m_initDeadline?e.m_initDeadline-performance.now():void 0;if(null!=T&&T<=0)return!1;if(!e.tryPrepareItemInWebGlScope(S,e.getGraphicsProcessor(),!0,T))return!1}var b,C=y(t.elements);try{for(C.s();!(b=C.n()).done;){var w,I=b.value,k=P(I),E=y(I.keyFrames);try{for(E.s();!(w=E.n()).done;){var x=w.value;if(x){if(!this.tryInitMorphKeyFrame(e,x,k))return!1;if(e.initOutOfTime())return!1}}}catch(e){E.e(e)}finally{E.f()}}}catch(e){C.e(e)}finally{C.f()}return!0}},{key:"tryPrepareMorph",value:function(e,t,r){var i=e.getGraphicsProcessor();if(!i)return m.Log.Error(591672912,"glContext must be provided"),!1;var n=i.isInRenderScope(),a=!1;return(n||i.beginRenderScope())&&(a=this.tryPrepareMorphInRenderScope(e,t,r),n||i.endRenderScope()),a}},{key:"renderMorph",value:function(e,t,r,i,n,a){var s=e.getGraphicsProcessor();if(s){if(!s||s.beginRenderScope()){var c=s.getBabylonEngine();if(this.tryPrepareMorph(e,t,void 0)){var d,p=[],_=y(t.elements);try{for(_.s();!(d=_.n()).done;){var S=d.value,T=S.keyFrames.length>0&&S.keyFrames[0]?S.keyFrames[0]:void 0,b=S.keyFrames.length>1&&S.keyFrames[1]?S.keyFrames[1]:void 0,C=T?T.location:b?b.location:void 0,w=b?b.location:C,P=e.ensureMorphElementRenderData(S);if(C&&w){if(T&&b&&I(T)&&I(b)){var k=new l.Shape;(0,g.interpolateShapes)(k,null==T?void 0:T.contents[0].item,null==b?void 0:b.contents[0].item,r),k.text=void 0,e.tryPrepareItemInWebGlScope(k,s,!0,void 0);var E=e.createTextureRasterizedItem("MorphInterpolatedShape",k,l.EffectFlags.all,P.interpolatedShapeSprite,void 0,0,l.EffectFlags.none,1,1,u.TextureReleasePolicy.DisposableCache);k.clearCache(),P.interpolatedShapeSprite&&P.interpolatedShapeSprite!=E&&P.interpolatedShapeSprite.release(),P.interpolatedShapeSprite=E,P.layer=new f.MorphLayer(E,E,void 0,void 0,void 0,void 0)}else{for(var x=T?e.ensureMorphKeyFrameRenderData(T):void 0,L=b?e.ensureMorphKeyFrameRenderData(b):void 0,A=x?[x.texture,x.textureDeltaWhite,x.texturePicture]:[void 0,void 0,void 0],M=L?[L.texture,L.textureDeltaWhite,L.texturePicture]:[void 0,void 0,void 0],R=P.layer instanceof f.PictureMorphLayer?[P.layer.textureA,P.layer.textureDeltaWhiteA,P.layer.texturePictureA]:[P.layer?P.layer.textureA:void 0,void 0,void 0],O=P.layer instanceof f.PictureMorphLayer?[P.layer.textureB,P.layer.textureDeltaWhiteB,P.layer.texturePictureB]:[P.layer?P.layer.textureB:void 0,void 0,void 0],D=!1,F=0;F<3;F++)R[F]==A[F]&&O[F]==M[F]||(D=!0);if(!P.layer||D){var B=void 0,N=void 0,V=void 0;if(T&&b&&T.morphingGrid&&b.morphingGrid){var U=T.morphingGrid.size.x*T.morphingGrid.size.y*2;T.morphingGrid.size.equals(b.morphingGrid.size)&&U>0&&T.morphingGrid.data.length==U&&b.morphingGrid.data.length==U?(B=c.createVertexBuffer(T.morphingGrid.data),N=c.createVertexBuffer(b.morphingGrid.data),V=h.Mesh.CreateGridXY(s,T.morphingGrid.size.x,T.morphingGrid.size.y,new o.Rect(-1,-1,1,1))):m.Log.Error(591672917,"Wrong morphing grid size")}else(T&&T.morphingGrid||b&&b.morphingGrid)&&m.Log.Error(591672918,"Morphing grids should come by pair");P.layer=A[0]&&M[0]&&A[1]&&M[1]&&A[2]&&M[2]?new f.PictureMorphLayer(A[0],M[0],A[1],M[1],A[2],M[2],B,N,V,t.panVector):new f.MorphLayer(A[0],M[0],B,N,V,t.panVector),P.layer.clientObject=S}}if(P.layer){var W=T?T.zPosition:b?b.zPosition:0,G=b?b.zPosition:W,H=!(T&&b||t.panVector);if(P.layer.progress=H?T?(0,o.clamp)(3*r,0,1):(0,o.clamp)(3*r-2,0,1):r,S.snapFade&&(P.layer.progress=P.layer.progress<.5?0:1),P.layer.contentCenter=o.Vector2.InterpolateLinear(C.center,w.center,r),P.layer.contentSize=o.Vector2.InterpolateLinear(C.size,w.size,r),P.layer.contentFlip=o.Vector2.InterpolateLinear(o.Vector2.Flip(C.flipX,C.flipY),o.Vector2.Flip(w.flipX,w.flipY),r),P.layer.contentRotation=(0,o.interpolateAngle)(C.rotation,w.rotation,r,S.rotateClockwise),S.textureUnflip&&(P.layer.textureFlip=new o.Vector2(P.layer.contentFlip.x<0?-1:1,P.layer.contentFlip.y<0?-1:1)),P.layer.depth=(0,o.mix)(W,G,r),P.layer instanceof f.PictureMorphLayer){var j=T?e.ensureMorphKeyFrameRenderData(T).pictureRelativeBounds:void 0,z=b?e.ensureMorphKeyFrameRenderData(b).pictureRelativeBounds:void 0;if(j&&z){var q=new o.Rect((0,o.mix)(j.left,z.left,r),(0,o.mix)(j.top,z.top,r),(0,o.mix)(j.right,z.right,r),(0,o.mix)(j.bottom,z.bottom,r)),Z=P.layer.contentSize,X=q.size.multiply(Z),Y=q.center.multiply(Z);P.layer.pictureTransformUV=o.Matrix3.Translation2D(Y.negate()).multiply(o.Matrix3.Scale2D(X.inverse()))}else m.Log.Error(572073352,"PictureMorphLayer needs pictureCrop"),P.layer.pictureTransformUV=void 0}p.push(P.layer)}}}}catch(e){_.e(e)}finally{_.f()}s.updateViewportSize();var J=a?a.tryGetBabylonTextureForRenderToTexture(s):void 0,K=a?a.size:s.getCurrentViewportSize(),Q=s.activateShaderProgram(v.ProgramId.shapeRender);Q.begin(J,i,!0),f.s_enableDepthBufferInMorph&&Q.clearAndEnbaleDepthBuffer(),p.sort((function(e,t){return e.depth-t.depth}));for(var $=0;$<p.length;$++){var ee=p[$];ee.depthFar=1-$/t.elements.length,ee.depthNear=1-($+.9)/t.elements.length,(0,f.drawLayer)(s,ee,Q,K,n?n.toMatrix3():void 0,void 0)}Q.end(),s.endRenderScope()}else m.Log.Error(591672916,"failed to initialize Morph")}}else m.Log.Error(591672915,"glContext must be provided")}}]);function C(e,t,r,i){var n=e.getGraphicsProcessor();if(n){if(1==t.contents.length&&t.contents[0].item instanceof l.Shape){var a=t.contents[0].item,c=(0,l.tryGetShapeSimpleImage)(a);if(c)if(null!=i){if(p.Settings.readBooleanOrDefault("morphOptimizeFillColorOverride",!1))return u.Texture.CreateFromByteBuffer("morphOptimizeFillColorOverride",e,o.Vector2.One,new Uint8Array([255*i.r,255*i.g,255*i.g,255*i.a]),d.TextureFormat.RGBA,s.WrapMode.clamp,!0)}else if(p.Settings.readBooleanOrDefault("morphOptimizeImages",!1)){var h=e.getTextureFromImage(c),f=(0,l.getBoundsOfPaths)(a,!1,t.parentTransform?t.parentTransform.toMatrix3():o.Matrix3.Identity);if(h&&f){var g=h.tryUseBabylonTexture(n,void 0,"MorphKeyFrameImgRef");if(g){var v=new u.Texture("MorphKeyFrameImgRef",e,g,h.size,h.format,h.wrapMode,u.TextureReleasePolicy.ExternallyManaged),y=v.size.divide(f.size);return v.contentLocation={logicalCenter:t.location.center.subtract(r.leftTop).multiply(y),logicalSize:t.location.size.multiply(y),physicalCenter:v.size.scale(.5),physicalSize:v.size,rotation:t.location.rotation-a.transform.rotation,flipX:t.location.flipX,flipY:t.location.flipY},v}}}}for(var _=Math.min(u.distanceFieldQuality,u.distanceFieldMaxRes/Math.max(r.width,r.height)),S=new u.TargetTexture("MorphKeyFrame",e,new o.Vector2(Math.max(1,Math.ceil(r.size.x*_)),Math.max(1,Math.ceil(r.size.y*_))),u.TextureReleasePolicy.DisposableCache),T=new o.Transform(r.leftTop.negate(),new o.Vector2(_,_)),b=0;b<t.contents.length;b++){var C=t.contents[b],w=void 0,P=void 0;i&&C.item instanceof l.Shape?((P=C.item.clone()).style.pictureBrush=void 0,P.style.fillBrush=new s.SolidBrush(i),e.tryPrepareItemInWebGlScope(P,n,!0,void 0)||m.Log.Error(572073354,"Failed to prepare color clone"),w=P):w=C.item,e.renderItemInWebGLRenderScope(w,0==b?s.Color.Transparent:void 0,{target:S,noSubtree:!C.includeSubtree,textRange:C.textRange,transform:o.Matrix3.FromTransforms(t.parentTransform||o.Matrix3.Identity,o.Matrix3.FromTransforms(T))}),P&&P.clearCache()}return t.location?S.contentLocation={logicalCenter:t.location.center.subtract(r.leftTop).scale(_),logicalSize:t.location.size.scale(_),physicalCenter:S.size.scale(.5),physicalSize:S.size,rotation:t.location.rotation,flipX:t.location.flipX,flipY:t.location.flipY}:m.Log.Error(572073355,"No KeyFrame location"),S}m.Log.Error(572073353,"glContext must be provided")}function w(e){return e.isStretched&&(e.wrapMode==s.WrapMode.clamp||void 0===e.wrapMode)&&1==e.rotateWithShape&&1==e.opacity}function P(e){if(p.Settings.readBooleanOrDefault("morphPictureCrop",!0)&&2==e.keyFrames.length){var t=e.keyFrames[0],r=e.keyFrames[1];if(t&&r&&1==t.contents.length&&1==r.contents.length){var i=t.contents[0],n=r.contents[0];if(i&&n&&i.item instanceof l.Shape&&n.item instanceof l.Shape){var a=i.item.style.pictureBrush,o=n.item.style.pictureBrush;if(a&&o&&w(a)&&w(o)&&(e.hasDynamicContent||!a.scale.equals(o.scale)||!a.offset.equals(o.offset)||a.alignment!=o.alignment)&&i.item.transform.scale.sign().equals(n.item.transform.scale.sign()))return!0}}}return!1}function I(e){if(!e.shapeInterpolation||1!=e.contents.length)return!1;var t=e.contents[0];return t.item instanceof l.Shape&&!t.textRange&&(!t.includeSubtree||!t.item.text)}t.MorphPlayer=b},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getDebugGlyphCachePage=function(e){var t=w(e);if(t){var r=I[t];if(r)return r.page}},t.clearGlyphCache=x,t.rasterizeDistanceField=G,t.initGlyphDistanceFieldCache=function(e,r){if(p.s_enableExperimentalGlyphTable&&e.getGraphicsProcessor()){var i=performance.now();E!=s.s_glyphCacheTextureResolution&&(x(),E=s.s_glyphCacheTextureResolution);var n=P;t.s_glyphCacheTextures=P=void 0,n||(n=[]),(0,d.forEachPath)(r,(function(e){return function(e){var t=w(e.glyphCacheId);if(t&&null==I[t]){var r=new f.Path(e,o.Transform.Identity),i=(0,u.tryGetQuickBoundsOfPaths)([r]);if(i&&!(s.s_glyphCacheMaxFactor&&Math.max(i.width,i.height)>4096*s.s_glyphCacheMaxFactor)){0!=k.length&&256!=k[k.length-1].length||k.push([]);var n=k.length-1,a=k[n],l=i.size,c=M()/Math.max(4096,Math.max(l.x,l.y)),d=new o.Vector2(c,c),h=a.length,m=.5+h%16,p=.5+(h-m)/16,g=i.center.scale(-c).add(new o.Vector2(m*A(),p*A())),v=o.Transform.fromScaleAndTranslation(d,g),y={page:n,scale:c,offset:g,bounds:i.multiply(d).translate(g).inflate(R()),path:new f.Path(r,v),ready:!1};a.push(y),I[t]=y}}}(e),!0}));for(var a=0;a<k.length;a++){var l=!0,c=a<n.length?n[a]:void 0;if(c)c.texture&&c.texture.isValid(e)||(y.Log.Error(592525085,"invalid glyph table texture. recreating."),l=!1);else{for(;n.length<a+1;)n.push(new C("DistanceField/glyphPage",e,void 0,f.PathFillMode.normal,d.MergeMode.fragment,0,p.TextureReleasePolicy.DisposableCache,!1));(c=n[a]).contentBoundsOverride=new o.Rect(0,0,L(),L()),c.paddingOverride=8,c.qualityOverride=1,c.isGlyphCache=!0,l=!1}var h=!1;l&&(h=H(e,a,c,!0)),h||H(e,a,c,!1)}t.s_glyphCacheTextures=P=n,e.getCurrentFramePerformanceSummary().distanceFieldForGlyphTableCostMs+=performance.now()-i}},t.corruptGlyphCacheForTesting=function(){var e,t=P&&P.length>0?null===(e=P[0])||void 0===e?void 0:e.texture:void 0;if(t&&t.graphicsProcessor){var r=t.graphicsProcessor.activateShaderProgram(S.ProgramId.distanceField);r.begin(t.tryGetBabylonTextureForRenderToTexture(t.graphicsProcessor),h.Color.Black,!1),r.end()}},t.verifyGlyphCacheIntegrity=function(){for(var e=0,t=0,r=0,i=0,n=0,a=0,o=0;o<k.length;o++){for(var s=0,l=0,c=P&&o<P.length?P[o].texture:void 0,u=c?c.tryConvertToBufferRGBA():void 0,d=0;d<k[o].length;d++){var h=k[o][d];if(h.ready){if(!c||!u)return y.Log.Error(555782370,"Glyph ready but texture missing"),!0;for(var m=0,p=Math.ceil(h.bounds.top);p<h.bounds.bottom;p++)for(var g=c.size.y-1-p,v=Math.ceil(h.bounds.left);v<h.bounds.right;v++)m+=u[4*(v+g*c.size.x)];if(void 0===h.checksum){if(0==m&&h.path.figures.length>0){var _=(0,f.calculateBoundsOfFigures)(h.path.figures);_&&_.isValid()&&!_.isEmpty()&&e++}}else s+=m,l+=h.checksum,m>h.checksum&&t++,m<h.checksum&&(0==m?r++:(y.Log.Error(555782402,"Glyph was ready but got partially erased (-".concat(100*(h.checksum-m)/h.checksum,"%)")),i++));h.checksum=m,a++}}0==s&&l>0&&n++}return e>0&&y.Log.Error(555782371,"Glyph(s) with figures look empty: glyphCount=".concat(e,", totalGlyphCount=").concat(a)),t>0&&y.Log.Error(555782400,"Glyph(s) ready but additional pixels rendered on top: glyphCount=".concat(t,", totalGlyphCount=").concat(a)),(r>0||i>0)&&y.Log.Error(555782401,"Glyph(s) ready but erased from cache: glyphCountErased=".concat(r,", glyphCountPartiallyErased=").concat(i,", totalGlyphCount=").concat(a,", pageCountErased=").concat(n,", totalPageCount=").concat(k.length)),e>0||r>0||i>0},t.drawDebugGlyphPage=function(e,t){var r=e.activateShaderProgram(S.ProgramId.copyTexture);if(r.begin(void 0,void 0,!1),P&&P.length>0){var i=P[0].texture;i&&(0,p.drawTexture)(e,r,i,[new o.Rect(0,0,L(),L())],[new o.Rect(0,0,.25*L(),.25*L())],t,p.DrawTextureMode.noFilter)}r.end()},t.getDashBuffer=j,t.s_glyphCacheTextures=t.s_glyphCachePages=t.s_drawDebugGlyphPage=t.DistanceField=void 0;var n=i(r(1)),a=i(r(2)),o=r(12),s=r(36),l=r(105),c=r(111),u=r(104),d=r(30),h=r(16),f=r(27),m=r(39),p=r(38),g=r(51),v=r(63),y=r(13),_=r(50),S=r(41);function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return b(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var C=(0,a.default)((function e(t,r,i,a,o,s,l,c){(0,n.default)(this,e),this.m_renderer=r,this.pathIndexRange=i,this.fillMode=a,this.distRangeSize=0,this.contentQuality=0,this.enableMipMap=!1,this.mergeMode=d.MergeMode.fragment,this.distanceFieldMode=s,this.scenario=t,this.releasePolicy=l,this.isDisplacementMap=c}),[{key:"size",get:function(){return this.texture?this.texture.size:o.Vector2.Zero}},{key:"refresh",value:function(e,t,r){var i=e,n=i.getGraphicsProcessor();if(!n)throw y.Log.Error(591524387,"Graphics processor not initialized");var a=_.Settings.readBooleanOrDefault("forceRefreshDistanceField",!1);if(!r&&!a&&this.geometryUniqueId==t.geometryTracker.currentUniqueId&&this.texture&&this.texture.isValidForGraphicsProcessor(n))return!0;var s=this.getContentBounds(t);if(!s)return y.Log.Error(570959637,"Shape has no bounds"),this.texture&&this.texture.release(),!1;var l=this.getQualityToUse(t),c=this.getPixelPaddingInShapeUnits(t),u=s.size.scale(l).add(new o.Vector2(2*c*l,2*c*l)),d=this.enableMipMap?new o.Vector2((0,o.getGreaterPowerOfTwo)(u.x),(0,o.getGreaterPowerOfTwo)(u.y)):u.ceil(),h=d.scale(Math.min(1,p.distanceFieldMaxRes/d.x,p.distanceFieldMaxRes/d.y)).ceil(),f=new o.Vector2((0,o.clamp)(h.x,16,p.distanceFieldMaxRes),(0,o.clamp)(h.y,16,p.distanceFieldMaxRes)),m=this.texture;if(this.texture=p.TargetTexture.RecycleOrReplace(this.scenario,m,e,f,this.releasePolicy,{format:g.TextureFormat.RGBA,needsRenderBuffer:!0,useFloat:this.isDisplacementMap,isMipMapped:this.enableMipMap}),!this.texture||!this.texture.graphicsProcessor)return!1;if(r&&m!=this.texture)return y.Log.Error(591524416,"Cannot update incrementally: texture had to be recreated"),!1;var v=l*Math.min(f.x/u.x,f.y/u.y),S=o.Rect.FromSizeAndCenter(f.scale(1/v),s.center),T=c*v/l;return this.rasterize(t,r,S,v,T,i.getCurrentFramePerformanceSummary()),!0}},{key:"getQualityToUse",value:function(e){return this.qualityOverride?this.qualityOverride:e.hasSmallDetails()?2*p.distanceFieldQuality:p.distanceFieldQuality}},{key:"getContentBounds",value:function(e){if(this.contentBoundsOverride)return this.contentBoundsOverride;var t=e.incrementalPath?e.incrementalPath.bounds:(0,d.getBoundsOfPaths)(e,1!=this.distanceFieldMode);if(t){var r=t.size;if(r.isFinite()){var i=e.transform.scale;if(i.isFinite())return t.multiply(i.abs());y.Log.Error(562151698,"Invalid shape scale for SDF: ".concat(i.x," x ").concat(i.y,", scenario: ").concat(this.scenario))}else y.Log.Error(562151697,"Invalid shape bounds for SDF: ".concat(r.x," x ").concat(r.y,", scenario: ").concat(this.scenario))}}},{key:"getFillBrightness",value:function(){return this.fillMode==f.PathFillMode.lighten?.4:this.fillMode==f.PathFillMode.lightenLess?.2:this.fillMode==f.PathFillMode.darken?-.4:this.fillMode==f.PathFillMode.darkenLess?-.2:0}},{key:"getPixelPaddingInShapeUnits",value:function(e){if(null!=this.paddingOverride)return this.paddingOverride;var t=_.Settings.readNumberOrDefault("maxReasonableZoomOut",10);if(e.style.hasLine){var r,i=null!==(r=e.style.hitTestSlop)&&void 0!==r?r:s.s_hitTestSlop;return Math.ceil(Math.max(i/2,t))}return t}},{key:"rasterize",value:function(e,t,r,i,n,a){if(!this.texture||!this.texture.graphicsProcessor)return y.Log.Error(591524418,"No gl texture or context"),!1;var l=e.transform.scale.abs(),c=(0,d.getBoundsOfPaths)(e,!1,o.Matrix3.Scale2D(l).multiply(new o.Transform(r.center.negate(),e.transform.scale.sign(),0,r.center).toMatrix3()));if(!c)return y.Log.Error(591524420,"Nothing to render"),!1;var u=new o.Vector2(i,i),h=r.size,f=this.size.scale(.5),m=new o.Transform(r.center.negate(),u,0,f),g=r.transformedBounds(m),v=c.transformedBounds(m);if(!g||!v)return y.Log.Error(588006216,"Nothing to render"),!1;if(this.contentQuality=i,this.localBounds=r?r.multiply(l.inverse()):void 0,this.renderScale=u.divide(this.size),this.uvScale=h.multiply(this.renderScale).multiply(e.transform.scale.sign()),this.texture.contentLocation={logicalCenter:v.center,logicalSize:v.size,physicalCenter:g.center,physicalSize:g.size,rotation:0,flipX:e.transform.scale.x<0,flipY:e.transform.scale.y<0},!this.localBounds||!this.renderScale)return y.Log.Error(591524421,"no bounds or renderScale"),!1;a.pixelCountDistanceField+=Math.floor(this.size.x*this.size.y);var _=s.debugMode==s.debug_relief,S=.5*(e.style.pen?e.style.pen.adjustedLineWidth*(1+Math.min(Math.abs((0,d.getPenAlignmentValue)(e.style.pen)),1)):0);if(this.isDisplacementMap&&e.shape3D){var T=.5*Math.max(e.shape3D.topBevel?e.shape3D.topBevel.size.x:0,e.shape3D.bottomBevel?e.shape3D.bottomBevel.size.x:0,e.shape3D?.5*e.shape3D.adjustedContourWidth:0);S=Math.max(S,2*T-S)}return this.distRangeSize=_?Math.max(h.x/2,h.y/2):Math.max(S,n),G(this.texture.graphicsProcessor,this.m_renderer,this,e,this.pathIndexRange,this.localBounds,this.renderScale,this.mergeMode,this.distanceFieldMode,this.distRangeSize,t,1==this.generateDrawFadeMask,this.isDisplacementMap)&&(this.geometryUniqueId=e.geometryTracker.currentUniqueId,this.lastKnownQualitySetting=p.distanceFieldQuality,this.lastKnownLineWidth=e.style.pen.adjustedLineWidth,this.lastKnownLineWidthForArrowHead=e.style.pen.adjustedLineWidthForArrowHead,this.lastKnownHitTestSlop=s.s_hitTestSlop),!1}}]);function w(e){return e?e.fontId+":"+e.glyphId:void 0}t.DistanceField=C,t.s_drawDebugGlyphPage=!1;var P,I={},k=[];t.s_glyphCachePages=k,t.s_glyphCacheTextures=P;var E=0;function x(){var e,r=T(P||[]);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.texture&&i.texture.release()}}catch(e){r.e(e)}finally{r.f()}t.s_glyphCacheTextures=P=void 0,I={},t.s_glyphCachePages=k=[]}function L(){return E-16}function A(){return L()/16}function M(){return 7*A()/8}function R(){return A()/16}var O=[{attributeName:"a_p0",attributeSize:4,offset:0},{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32},{attributeName:"a_p3",attributeSize:4,offset:48},{attributeName:"a_p4",attributeSize:4,offset:64}],D=[{attributeName:"a_d1",attributeSize:1,offset:4},{attributeName:"a_d2",attributeSize:1,offset:8}];function F(e){if(e==d.MergeMode.union)return m.TextRange.FromFirstLast(0,3)}function B(e,t,r,i,n){return!(n&&0!=e||i!=d.MergeMode.union&&t||0!=e&&r.fillMode==f.PathFillMode.none)}function N(e,t,r,i,n,a,s,u,d,m,g,_,S){var b=(0,v.getMaxTapeFloatsOrThrow)(),C=[],k=[];if(0==r.length)return{transformedPaths:C,cachedGlyphsPages:k};d&&(d.start<0||d.last>=r.length)&&y.Log.Error(592525078,"pathIndexRange out of range");for(var E=d?Math.max(d.start,0):0,x=d?Math.min(d.last,r.length-1):r.length-1,A=i&&((0,l.getEndGapsForArrowHead)(i.headEnd,i.adjustedLineWidthForArrowHead)>0||(0,l.getEndGapsForArrowHead)(i.tailEnd,i.adjustedLineWidthForArrowHead)>0),R=m||!!i&&i.dashType!=h.PenDash.solid||A,O=p.s_enableExperimentalGlyphTable&&!i,D=function(){var d=r[F];if(g&&!d.extrusionEnabled)return 1;var m=d.transform.scale.x>=M()/4096;d.glyphCacheId?_?t.getCurrentFramePerformanceSummary().glyphCountAddedToCache++:(t.getCurrentFramePerformanceSummary().glyphCount++,m&&t.getCurrentFramePerformanceSummary().glyphCountLargeText++,null!=i&&t.getCurrentFramePerformanceSummary().glyphCountTextOutline++):t.getCurrentFramePerformanceSummary().pathCount++;var p=!1,v=w(d.glyphCacheId);if(!S&&v&&O&&P&&0==d.transform.rotation&&Math.abs(d.transform.scale.x-d.transform.scale.y)<o.epsilon&&!m&&I[v]){var E=I[v];if(E.page<0||E.page>=P.length)y.Log.Error(592525079,"Invalid glyph page");else{var x=P[E.page];if(x.texture){var A=x.localBounds?x.localBounds.center:void 0,D=x.localBounds&&A&&x.uvScale?x.localBounds.translate(A.negate()).multiply(x.uvScale.inverse()).translate(A):void 0,B=x.localBounds&&D&&x.uvScale?E.bounds.multiply(x.uvScale).translate(D.leftTop.negate()):void 0,N=E.bounds.translate(E.offset.negate()).multiply(new o.Vector2(1/E.scale,1/E.scale)).transformedBounds(d.transform);if(B)if(N)if(B.right<0||B.bottom<0||B.left>=L()||B.top>=L())y.Log.Error(592525082,"Cached glyph src rect out of bounds");else{for(var V,U={srcRect:B,dstRect:N,distanceScale:1},W=0;W<k.length&&!V;W++)k[W].page==E.page&&(V=k[W]);V||(V={page:E.page,cachedGlyphInstances:[]},k.push(V)),V.cachedGlyphInstances.push(U),p=!0,t.getCurrentFramePerformanceSummary().glyphCountReadFromCache++}else y.Log.Error(592525081,"Cached glyph dst rect undefined");else y.Log.Error(592525080,"Cached glyph src rect undefined")}else y.Log.Error(572867295,"Glyph page texure missing")}}if(!p){d.glyphCacheId&&!_&&t.getCurrentFramePerformanceSummary().glyphCountRenderedAsPath++;var G=t.ensurePathRenderData(d);G.refreshCachedHwTapeBuffers(d,e);var H,j=G.tapeBuffers,z=0;if(!j||R||n)if(R||n){var q=(0,c.getTapeBuffersForPath)(d,b,n,R,R?o.Matrix3.FromTransforms(d.transform,o.Matrix3.Scale2D(u)):void 0);j=q.buffers,H=q.distanceBuffers,z=q.endDistance}else j=G.refreshCachedTapeBuffers(d);var Z,X=e.getBabylonEngine(),Y=G.hwTapeBuffers;Y||(Y=j.map((function(e){return X.createVertexBuffer(e)}))),H&&(Z=H.map((function(e){return X.createVertexBuffer(e)})));var J=d.transform.toMatrix3(),K={tapeBuffers:j,hwTapeBuffers:Y,hwDistanceBuffers:Z,fillMode:g?f.PathFillMode.normal:s?f.PathFillMode.none:d.fillMode,lineEnabled:a&&d.lineEnabled,isArrowHead:!1,transform:J,startDistance:0,endDistance:z};if(C.push(K),s&&i&&(i.headEnd.end!=h.PenLineEnd.none||i.tailEnd.end!=h.PenLineEnd.none)){var Q,$=i.adjustedLineWidthForArrowHead,ee=J.multiply(o.Matrix3.Scale2D(u)),te=o.Matrix3.Scale2D(u.inverse()),re=T(d.figures);try{for(re.s();!(Q=re.n()).done;){var ie=Q.value,ne=ie.isClosed||ie.isLastPointDuplicated();if(i.headEnd&&i.headEnd.end!=h.PenLineEnd.none&&!ne){var ae=(0,l.getArrowHeadFigure)(i.headEnd,$);if(ae){var oe=(0,l.getArrowHeadTransform)(ie,!1,i.headEnd,$,ee),se=(0,c.getTapeBuffersForPath)(f.Path.CreateFromFigure(ae),b).buffers;C.push({tapeBuffers:se,hwTapeBuffers:se.map((function(e){return X.createVertexBuffer(e)})),hwDistanceBuffers:void 0,fillMode:i.headEnd.end==h.PenLineEnd.arrow?f.PathFillMode.none:f.PathFillMode.normal,lineEnabled:!0,isArrowHead:!0,transform:oe?oe.multiply(te):void 0,startDistance:0,endDistance:0})}}if(i.tailEnd&&i.tailEnd.end!=h.PenLineEnd.none&&!ne){var le=(0,l.getArrowHeadFigure)(i.tailEnd,$);if(le){var ce=(0,l.getArrowHeadTransform)(ie,!0,i.tailEnd,$,ee),ue=(0,c.getTapeBuffersForPath)(f.Path.CreateFromFigure(le),b).buffers;C.push({tapeBuffers:ue,hwTapeBuffers:ue.map((function(e){return X.createVertexBuffer(e)})),hwDistanceBuffers:void 0,fillMode:i.tailEnd.end==h.PenLineEnd.arrow?f.PathFillMode.none:f.PathFillMode.normal,lineEnabled:!0,isArrowHead:!0,transform:ce?ce.multiply(te):void 0,startDistance:0,endDistance:0})}}}}catch(e){re.e(e)}finally{re.f()}}}},F=E;F<=x;F++)D();return{transformedPaths:C,cachedGlyphsPages:k}}function V(e,t,r){var i=e.getBabylonEngine();0==t?(i.setColorWrite(!0),i.depthCullingState.depthMask=!0,i.stencilState.stencilTest=!1,i.stencilState.stencilMask=255,i.stencilState.stencilFunc=519,i.stencilState.stencilFuncRef=0,i.stencilState.stencilFuncMask=3,i.alphaState.alphaBlend=!0,i.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),i.alphaState.setAlphaEquationParameters(32776,32776),i.clear(null,!1,!1,!0)):1==t?(i.setColorWrite(!1),i.depthCullingState.depthMask=!1,i.stencilState.stencilTest=!0,i.stencilState.stencilMask=255,i.stencilState.stencilFunc=519,i.stencilState.stencilFuncRef=1,i.stencilState.stencilFuncMask=255):(i.setColorWrite(!0),i.depthCullingState.depthMask=!0,i.stencilState.stencilMask=0,2==t?(i.stencilState.stencilTest=!0,i.stencilState.stencilFunc=517,i.stencilState.stencilFuncRef=0,i.stencilState.stencilFuncMask=r==d.OverlapMode.winding?255:3,i.alphaState.alphaBlend=!0,i.alphaState.setAlphaBlendFunctionParameters(775,769,773,771),i.alphaState.setAlphaEquationParameters(32774,32774)):3==t&&(i.stencilState.stencilTest=!1,i.alphaState.alphaBlend=!0,i.alphaState.setAlphaBlendFunctionParameters(772,1,0,0),i.alphaState.setAlphaEquationParameters(32774,32774)))}function U(e,t,r,i){var n=r&&!(3==t);V(e,t,i.overlapMode);var a=e.getBabylonEffect();a.setInt("u_7",t),a.setInt("ufrag_0",t),a.setFloat("ufrag_8",n?1:0);var o=0,s=j(i.style.pen);if(s&&s.length>0)for(var l=0;l<s.length;l++)o+=s[l];0==o&&(o=1);var c=i.style.pen.headEnd.cap==h.PenLineCap.round?1:0;a.setFloat("ufrag_5",s&&s.length>0?.5-(s[0]-c)/(2*o):0),a.setFloat("ufrag_4",s&&s.length>0?1/(o*i.style.pen.adjustedLineWidth):0)}function W(e,t,r,i,n,a,c,u,m,p,g){if(0!=t||s.debugMode!=s.debug_fill){var v=-performance.now(),y=e.getBabylonEffect(),_=e.getBabylonEngine();y.setFloat("u_12",i.style.pen.adjustedLineWidth),y.setFloat("u_5",i.style.pen.miterLimit);var S=0,b=j(i.style.pen),C=b?b.length:0;if(i.style.pen&&b){for(var w=0;w<C;w++)S+=b[w];S=S>0?S:1,y.setFloat("ufrag_12",S/2),y.setFloat4("ufrag_13",C>=2?b[0]/2:S,C>=3?b[0]/2+b[1]:S,C>=4?b[0]/2+b[1]+b[2]:S,C>=5?b[0]/2+b[1]+b[2]+b[3]:S)}else y.setFloat("ufrag_12",.5),y.setFloat4("ufrag_13",1,1,1,1);y.setFloat("u_14",n.length>0&&n[0].isArrowHead||i.style.pen.headEnd.cap==h.PenLineCap.round?1:0);var P,I=T(n);try{for(I.s();!(P=I.n()).done;){var k=P.value;if(B(t,r,k,a,u)){var E=(k.fillMode!=f.PathFillMode.none||2==c)&&2==c==k.isArrowHead&&(a==d.MergeMode.fragment||a==d.MergeMode.union&&r),x=k.lineEnabled&&!k.isArrowHead,L=k.isArrowHead&&k.fillMode==f.PathFillMode.none,A=L?x:E,M=L?E:x;y.setMatrix3x3("u_8",k.transform?k.transform.m:o.Matrix3.Identity.m),y.setInt("ufrag_17",u?1:0),u&&y.setFloat("ufrag_12",1/k.endDistance),y.setFloat("ufrag_19",k.isArrowHead&&k.fillMode==f.PathFillMode.none&&p?i.style.pen.adjustedLineWidth/4/p:0);var R=n.length>0&&k.isArrowHead||g?h.LineJoin.miter:i.style.pen?i.style.pen.lineJoin:0;y.setInt("u_4",R),y.setInt("ufrag_1",R);for(var F=0;F<k.tapeBuffers.length;F++){var N=k.tapeBuffers[F],V=k.hwTapeBuffers[F],U=k.hwDistanceBuffers?k.hwDistanceBuffers[F]:void 0,W=N.length/4-4;if(_.bindInstancesBuffer(V,O,!1),U?(y.setInt("u_19",0),_.bindInstancesBuffer(U,D,!1)):(y.setInt("u_19",1),e.setDummyPointerAttribute("a_d1"),e.setDummyPointerAttribute("a_d2")),0==N[2]&&k.startDistance!=k.endDistance){var G=(0,l.getEndGapsForArrowHead)(i.style.pen.headEnd,i.style.pen.adjustedLineWidthForArrowHead),H=(0,l.getEndGapsForArrowHead)(i.style.pen.tailEnd,i.style.pen.adjustedLineWidthForArrowHead);y.setFloat2("ufrag_16",k.startDistance+G,k.endDistance-H)}else y.setFloat2("ufrag_16",0,0);y.setFloat("ufrag_2",A?1:0),y.setFloat("ufrag_3",M?1:0),y.setFloat("ufrag_18",L?1:0),1==t?(y.setFloat("ufrag_6",1),e.setDistanceFieldStencilSumIncrement(!0),e.drawQuadInstances(W),y.setFloat("ufrag_6",-1),e.setDistanceFieldStencilSumIncrement(!1),e.drawQuadInstances(W)):e.drawQuadInstances(W)}}}}catch(e){I.e(e)}finally{I.f()}e.disableInstanceAttribute("a_p0"),e.disableInstanceAttribute("a_p1"),e.disableInstanceAttribute("a_p2"),e.disableInstanceAttribute("a_p3"),e.disableInstanceAttribute("a_p4"),e.disableInstanceAttribute("a_d1"),e.disableInstanceAttribute("a_d2"),v+=performance.now(),m.drawTapeCostMs+=v}}function G(e,t,r,i,n,a,l,c,u,g,v,_,b){var C=performance.now(),w=r.texture;if(!w)return y.Log.Error(572842049,"DistanceFieldTexture not initialized"),!1;var I,k=v?void 0:h.Color.Transparent;if(i.paths&&!i.incrementalPath)I=N(e,t,i.paths,i.style.hasLine?i.style.pen:void 0,!1,1!=u,2==u,i.transform.scale,n,_,b,!!r.isGlyphCache,!!r.isGlyphCacheDisabled);else if(i.incrementalPath){var E=w.tag,x=E&&E.incrementalPathTrackerId==i.incrementalPath.changeTracker.trackerId;(!x||E&&(0==E.figureCount||1==E.figureCount&&0==E.lastFigurePointCount))&&(k=h.Color.Transparent);for(var L=x&&E.figureCount>0?E.figureCount-1:0,A=[],M=L;M<i.incrementalPath.figures.length;M++){var R=i.incrementalPath.figures[M],O=x&&M==L&&E.lastFigurePointCount>0?E.lastFigurePointCount-1:0,D=R.getPointCount();A.push(new f.Figure(R.data.slice(O*i.incrementalPath.pointDataSize,D*i.incrementalPath.pointDataSize),!1,i.incrementalPath.format))}w.tag={incrementalPathTrackerId:i.incrementalPath.changeTracker.trackerId,figureCount:i.incrementalPath.figures.length,lastFigurePointCount:i.incrementalPath.figures.length>0?i.incrementalPath.figures[i.incrementalPath.figures.length-1].getPointCount():0},I=N(e,t,[new f.Path({figures:A,fillMode:f.PathFillMode.none})],i.style.hasLine?i.style.pen:void 0,!1,1!=u,2==u,i.transform.scale,n,_,b,!!r.isGlyphCache,!!r.isGlyphCacheDisabled)}if(!I)return y.Log.Error(592525084,"Nothing to render"),!1;var G=e.activateShaderProgram(S.ProgramId.distanceField);G.begin(w.tryGetBabylonTextureForRenderToTexture(e),k,!1);var H=G.getBabylonEffect();H.setVector2("u_0",a.center.multiply(i.transform.scale)),H.setVector2("u_1",i.transform.scale),H.setVector2("u_2",l),H.setFloat("u_3",g),H.setFloat("ufrag_10",i.style&&i.style.pen?2*g/(i.style.pen.adjustedLineWidthForArrowHead+1):0),H.setFloat("ufrag_11",i.transform.scale.x*i.transform.scale.y),H.setInt("ufrag_7",s.debugMode),H.setInt("u_13",s.debugMode),H.setInt("u_15",i.style.pen.compoundType==h.PenCompound.simple?0:1),H.setVector2("u_17",i.style.pen.tipScale?i.style.pen.tipScale:o.Vector2.One),H.setInt("u_18",i.style.pen.tipType?i.style.pen.tipType:0);var j=(i.style.pen.adjustedLineWidth/2+1/r.contentQuality)/(2*g);H.setFloat("ufrag_15",i.style.pen.alignment==h.PenAlignment.center?j:2*j);var z,q=T(I.transformedPaths);try{for(q.s();!(z=q.n()).done;){var Z=z.value,X=F(c);if(X)for(var Y=X.start;Y<=X.last;Y++)B(Y,!0,Z,c,_)&&(U(G,Y,!0,i),2==Y?G.drawQuads(1):W(G,Y,!0,i,[Z],c,u,_,t.getCurrentFramePerformanceSummary(),g,null!=i.shape3D))}}catch(e){q.e(e)}finally{q.f()}var J=function(e){return e==d.MergeMode.union?m.TextRange.FromFirstLast(0,0):m.TextRange.FromFirstLast(0,s.debugMode==s.debug_edge||s.debugMode==s.debug_tape?0:2)}(c);if(J)for(var K=J.start;K<=J.last;K++)U(G,K,!1,i),2==K?G.drawQuads(1):W(G,K,!1,i,I.transformedPaths,c,u,_,t.getCurrentFramePerformanceSummary(),g,null!=i.shape3D);if(G.end(),p.s_enableExperimentalGlyphTable&&P&&I.cachedGlyphsPages.length>0){var Q=e.activateShaderProgram(S.ProgramId.copyTexture);if(Q.begin(w.tryGetBabylonTextureForRenderToTexture(e),void 0,!1),V(Q,0,d.OverlapMode.alternate),r.localBounds&&r.uvScale){var $,ee=T(I.cachedGlyphsPages);try{for(ee.s();!($=ee.n()).done;){var te=$.value;if(te.cachedGlyphInstances.length>0){for(var re=new Array(te.cachedGlyphInstances.length),ie=new Array(te.cachedGlyphInstances.length),ne=0;ne<te.cachedGlyphInstances.length;ne++){var ae=te.cachedGlyphInstances[ne];re[ne]=ae.srcRect,ie[ne]=ae.dstRect.translate(r.localBounds.center.negate()).multiply(w.size.multiply(r.uvScale).multiply(r.localBounds.size.inverse())).translate(w.size.scale(.5))}var oe=P[te.page].texture;oe?(0,p.drawTexture)(e,Q,oe,re,ie,w.size,p.DrawTextureMode.noFilter,P[te.page].distRangeSize/r.distRangeSize*(te.cachedGlyphInstances[0].dstRect.size.y/te.cachedGlyphInstances[0].srcRect.size.y)):y.Log.Error(572867297,"glyphPageTexture missing")}}}catch(e){ee.e(e)}finally{ee.f()}}Q.end()}return w.renderCost=performance.now()-C,!0}function H(e,t,r,i){var n,a=[],o=T(k[t]);try{for(o.s();!(n=o.n()).done;){var s=n.value;i&&s.ready||(a.push(s.path),s.ready=!0)}}catch(e){o.e(e)}finally{o.f()}if(a.length>0){var l=new d.Shape(a);return l.style.pen.lineWidth=R(),l.overlapMode=d.OverlapMode.winding,r.refresh(e,l,i)}return!0}function j(e){if(e.tipType!=h.PenTip.square)return e.dashType>=0&&e.dashType<z.length?z[e.dashType]:void y.Log.Error(591192836,"unsupported dashType")}var z=[null,new Float32Array([3,1]),new Float32Array([1,1]),new Float32Array([3,1,1,1]),new Float32Array([3,1,1,1,1,1]),new Float32Array([1,3]),new Float32Array([4,3]),new Float32Array([8,3]),new Float32Array([4,3,1,3]),new Float32Array([8,3,1,3]),new Float32Array([8,3,1,3,1,3])]},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SVGRenderer=t.SVGImageRenderData=t.SVGItemRenderData=void 0;var n=i(r(1)),a=i(r(2)),o=r(101),s=r(64),l=r(13),c=r(270),u=r(50),d=r(12),h=r(30),f=r(16);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var g=(0,a.default)((function e(){(0,n.default)(this,e),this.lastTransform=d.Matrix3.Identity,this.lastFadeProgress=1}),[{key:"detachSVG",value:function(){this.svgElement=void 0,this.svgElementContainer=void 0,this.customHtmlElementContainer=void 0,this.localRenderBounds=void 0,this.lastTransform=d.Matrix3.Identity,this.lastFadeProgress=1}},{key:"releaseGeneratedResources",value:function(){this.detachSVG(),this.imgUri=void 0}},{key:"onFinalization",value:function(){}}]);t.SVGItemRenderData=g;var v=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"releaseGeneratedResources",value:function(){}},{key:"onFinalization",value:function(){}}]);t.SVGImageRenderData=v;var y=function(){function e(t){(0,n.default)(this,e),this.m_nextId=1,this.canvas=t,this.m_rendererId="SVG"+e.s_nextSVGRendererId++}return(0,a.default)(e,[{key:"getImageUriFromShape",value:function(e){var t=(0,h.tryGetShapeSimpleImage)(e);if(t){var r=this.ensureImageRenderData(t);return r.uri||(_("simple image has no uri"),l.Log.Error(560989846,"simple image has no uri")),r.uri}}},{key:"attachCustomHTMLToShape",value:function(e,t){this.ensureRenderNode(t).customHtmlElement=e}},{key:"addOrUpdateShape",value:function(e,t,r){var i=this.ensureRenderNode(e),n=i.customHtmlElement;if(!i.svgElement&&!n){i.customHtmlElementContainer=void 0,i.imgUri&&i.versionCached==e.changeTracker.currentUniqueId||(i.imgUri=this.getImageUriFromShape(e),i.versionCached=e.changeTracker.currentUniqueId);var a=i.imgUri;if(i.imgUri){var s="SBSVG_image_"+this.m_nextId;i.svgElement=document.createElementNS("http://www.w3.org/2000/svg","image"),i.svgElement.setAttribute("id",s),i.svgElement.setAttributeNS("http://www.w3.org/1999/xlink","href",a||"");var c=(0,h.getBoundsOfPaths)(e,!1);c?(i.svgElement.setAttribute("width",c.width.toString()),i.svgElement.setAttribute("height",c.height.toString()),i.svgElement.setAttribute("x",c.left.toString()),i.svgElement.setAttribute("y",c.top.toString()),i.localRenderBounds=c):(_("simple image has no bounds"),l.Log.Error(562042566,"simple image has no bounds"))}else{i.svgElement=function(e,t){if(e.style.pictureBrush)return _("pictureBrush not SimpleImage"),void l.Log.Error(562042571,'pictureBrush only supported for "SimpleImage"');if(e.style.fillBrush&&!(e.style.fillBrush instanceof f.SolidBrush))return _("fillBrush type ".concat(e.style.fillBrush.getType())),void l.Log.Error(562042572,"unsupported fillBrush type ".concat(e.style.fillBrush.getType()));if(e.style.lineBrush&&!(e.style.lineBrush instanceof f.SolidBrush))return _("lineBrush type ".concat(e.style.lineBrush.getType())),void l.Log.Error(562042573,"unsupported lineBrush type ".concat(e.style.lineBrush.getType()));if(e.effects.hasEffects||e.shape3D||e.scene3D)return _("effects"),void l.Log.Error(562042574,"unsupported effects");if(e.text)return _("text"),void l.Log.Error(562042575,"unsupported text");if(e.style.pen.dashType!=f.PenDash.solid||e.style.pen.compoundType!=f.PenCompound.simple)return _("dash/compound line"),void l.Log.Error(562042576,"unsupported dash/compound line");if(e.style.blendingMode!=f.BlendingMode.normal)return _("blending mode"),void l.Log.Error(560989847,"unsupported blending mode ".concat(e.style.blendingMode));var r,i="",n=m(e.paths||[]);try{for(n.s();!(r=n.n()).done;){var a,s=r.value,c=m(s.figures);try{var d=function(){var e=a.value,t=!0;e.forEachSegment((function(e,r,n){return t&&(i+="M ".concat(e.x," ").concat(e.y," "),t=!1),i+=r?"Q ".concat(r.x," ").concat(r.y,", ").concat(n.x," ").concat(n.y," "):"L ".concat(n.x," ").concat(n.y," "),!0}),s.transform),e.isClosed&&(i+="Z")};for(c.s();!(a=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}}}catch(e){n.e(e)}finally{n.f()}if(""==i)return _("empty path"),void l.Log.Error(562042577,"empty path");var h=document.createElementNS("http://www.w3.org/2000/svg","path");return h.setAttribute("id",t),h.setAttribute("d",i),u.Settings.readBooleanOrDefault("redPathSVG",!1)?(h.setAttribute("stroke","red"),h.setAttribute("stroke-width","4")):(e.style.fillBrush instanceof f.SolidBrush&&(h.setAttribute("fill",(0,o.colorToString)(e.style.fillBrush.color,!0)),h.setAttribute("fill-opacity",e.style.fillBrush.color.a.toString())),e.style.lineBrush instanceof f.SolidBrush&&(h.setAttribute("stroke",(0,o.colorToString)(e.style.lineBrush.color,!0)),h.setAttribute("stroke-opacity",e.style.lineBrush.color.a.toString())),h.setAttribute("stroke-width",e.style.lineBrush?e.style.pen.lineWidth.toString():"0")),h}(e,"SBSVG_path_"+this.m_nextId);var p=(0,h.getBoundsOfPaths)(e,!0);i.localRenderBounds=p}if(!i.svgElement)return void l.Log.Error(562042567,"Unsupported SVG scenario");var g=document.createElementNS("http://www.w3.org/2000/svg","svg"),v=document.createElement("span");v.style.position="absolute",v.style.display="flex",v.appendChild(g),this.canvas.appendChild(v),i.svgElementContainer=v,i.localRenderBounds&&(g.setAttribute("width",i.localRenderBounds.width.toString()),g.setAttribute("height",i.localRenderBounds.height.toString()),i.svgElement.setAttribute("transform","translate(".concat(-i.localRenderBounds.left,",").concat(-i.localRenderBounds.top,")"))),g.appendChild(i.svgElement),this.m_nextId++}if(n&&!i.customHtmlElementContainer){var y=document.createElement("div");y.style.position="absolute",y.appendChild(n),this.canvas.appendChild(y),i.customHtmlElementContainer=y}var S=i.svgElementContainer&&i.localRenderBounds?d.Matrix3.Translation2D(i.localRenderBounds.size.scale(.5)):d.Matrix3.Identity,T=i.svgElementContainer&&i.localRenderBounds?d.Matrix3.Translation2D(i.localRenderBounds.size.scale(-.5)):d.Matrix3.Identity,b=d.Matrix3.FromTransforms(S,t,e.animationTransform||d.Matrix3.Identity,r&&r.transform?r.transform:d.Matrix3.Identity,T);if(!i.lastTransform.equals(b)){var C=i.customHtmlElementContainer||i.svgElementContainer;C?C.style.transform="matrix(".concat(b.m[0],",").concat(b.m[1],",").concat(b.m[3],",").concat(b.m[4],",").concat(b.m[6],",").concat(b.m[7],")"):i.svgElement&&i.svgElement.setAttribute("transform","matrix(".concat(b.m[0]," ").concat(b.m[1]," ").concat(b.m[3]," ").concat(b.m[4]," ").concat(b.m[6]," ").concat(b.m[7],")"))}var w=(e.fade?e.fade.progress:1)*(e.isHidden?0:1);i.lastFadeProgress!=w&&(i.customHtmlElementContainer&&(i.customHtmlElementContainer.style.opacity=w.toString()),i.svgElement&&i.svgElement.setAttribute("opacity",w.toString()))}},{key:"buildTreeSvg",value:function(e,t,r){var i=e.transform.toMatrix3().multiply(t);if(e instanceof h.Shape)this.addOrUpdateShape(e,i,r);else if(e instanceof h.Group){var n,a=m(e.items.elements);try{for(a.s();!(n=a.n()).done;){var o=n.value;this.buildTreeSvg(o,i,r)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"clearNodes",value:function(e){if(this.ensureRenderNode(e).detachSVG(),e instanceof h.Group){var t,r=m(e.items.elements);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.clearNodes(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"render",value:function(t,r,i){this.m_rootId!=t.changeTracker.currentUniqueId&&(e.clearElement(this.canvas),this.m_rootId=t.changeTracker.currentUniqueId,this.clearNodes(t)),r&&(this.canvas instanceof SVGElement?this.canvas.style.background=(0,o.colorToString)(r,!0):this.canvas.style.backgroundColor=(0,o.colorToString)(r,!0)),this.buildTreeSvg(t,d.Matrix3.Identity,i),s.DebugTool.OnRender(this,[{item:t,eraseBackground:r,options:i}])}},{key:"renderMorph",value:function(e,t,r,i,n){throw l.Log.Error(562042568,"Morph not supported in SVG mode")}},{key:"hitTestScene",value:function(e,t,r,i){throw l.Log.Error(562042569,"Hit Test not supported in SVG mode")}},{key:"tryPrepareItem",value:function(e,t,r){return!0}},{key:"tryPrepareMorph",value:function(e,t){throw l.Log.Error(562042570,"Morph not supported in SVG mode")}},{key:"getDebugString",value:function(e){return"NYI"}},{key:"tryGetImageDebugData",value:function(e){}},{key:"tryGetImageDebugDataForMorphKeyFrame",value:function(e){}},{key:"getDebugGlyphCacheInfo",value:function(e){}},{key:"attachUriToImage",value:function(e,t){this.ensureImageRenderData(e).uri=t}},{key:"ensureRenderNode",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new g,e.renderDataMap[this.m_rendererId]=t),t}},{key:"ensureImageRenderData",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new v,e.renderDataMap[this.m_rendererId]=t),t}}],[{key:"clearElement",value:function(e){for(var t;t=e.firstChild;)e.removeChild(t)}}])}();function _(e){c.Veto.Record("ShapeNotRendered",[{Renderer:"SVGRenderer"},{Scenario:e}])}t.SVGRenderer=y,y.s_nextSVGRendererId=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTextLayoutFromHTMLElement=function(e,t,r,i,n,a){return h(e,t,r,i,void 0,(0,c.getDefaultGlyphPathFuntion)(),n?function(e){2==e&&n()}:void 0,a)},t.setFontLocationOverride=function(e){t.s_fontLocationOverride=i=e},t.createTextLayoutFromHTMLElementWithGlyphPathProvider=h,t.createTextLayoutFromParagraphElementInfo=f,t.parseColor=p,t.findBestCharacterMapping=T,t.getParagraphSplit=b,t.s_fontLocationOverride=void 0;var i,n=r(13),a=r(37),o=r(12),s=r(16),l=r(39),c=r(144);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t,r,i,a,o,s,c){var d=[],h=c||[];if(!e)return n.Log.Error(536921102,"Undefined element containing paragraphs"),new l.TextLayout;for(var p=0;p<e.childNodes.length;p++){var v=e.childNodes[p];if(v instanceof HTMLElement)if(v instanceof HTMLUListElement||v instanceof HTMLOListElement)for(var y=0;y<v.childNodes.length;y++){var _=v.childNodes[y];_ instanceof HTMLElement&&(d.push(_),c||h.push(_.textContent+"\n"))}else d.push(v),c||h.push(v.textContent+"\n")}for(var S=b(h,d),T=[],C=0;C<h.length;C++){var w,P=h[C],I=[],k=0,E=u(S[C]);try{for(E.s();!(w=E.n()).done;){var x=w.value,L=g(P,k,x);I.push({element:x,range:new l.TextRange(k,L-k)}),k=L}}catch(e){E.e(e)}finally{E.f()}T.push({paragraphString:P,elementsAndRanges:I})}for(var A=0,M=[],R=0,O=T;R<O.length;R++){var D=O[R];M.push(m(A,D,t,r,a)),A+=D.paragraphString.length}return f(T,t,r,i,o,a,s)}function f(e,t,r,i,n,a,o){var s,l=0,d=[],h=u(e);try{for(h.s();!(s=h.n()).done;){var f=s.value;d.push(m(l,f,t,r,a)),l+=f.paragraphString.length}}catch(e){h.e(e)}finally{h.f()}return(0,c.createTextLayoutFromParagraphInfo)(d,i/r,n,o)}function m(e,t,r,i,a){var s,c,d=[],h=new l.RangeDataPartition(y()),f=[],m=u(t.elementsAndRanges);try{for(m.s();!(s=m.n()).done;){var p=s.value;v(t.paragraphString,p.range.start,p.element,f,d,r,i,h,a)}}catch(e){m.e(e)}finally{m.f()}for(var g=0;g<t.paragraphString.length;g++)if(null!=d[g])c=d[g];else if(c)d[g]=new o.Rect(c.right,c.top,c.right,c.bottom);else{var _=d.find((function(e){return null!=e}));if(_)d[g]=new o.Rect(_.left,_.top,_.left,_.bottom);else if(t.elementsAndRanges.length>0){var S=document.createRange();S.setStart(t.elementsAndRanges[0].element,0),S.setEnd(t.elementsAndRanges[0].element,1);var T=S.getBoundingClientRect();d[g]=new o.Rect((T.left-r.x)*i,(T.top-r.y)*i,(T.right-r.x)*i,(T.bottom-r.y)*i)}else n.Log.Message(537002705,"Unable to get any bounds for paragraph")}return{paragraphStart:e,paragraphString:t.paragraphString,characterBounds:d,runInfoPerRange:h}}function p(e){var t=0;if(e.startsWith("rgba"))t=5;else{if(!e.startsWith("rgb"))return new s.Color(0,0,0,1);t=4}var r=e.substring(t,e.length-1).split(",").map((function(e){return Number(e)}));return new s.Color(r[0]/255,r[1]/255,r[2]/255,r.length>3?r[3]:1)}function g(e,t,r){for(var i=t,a=0;a<r.childNodes.length;a++){var o=r.childNodes[a];"ql-cursor"!==r.className&&(o instanceof Text?i+=T(o.data,e,i).length:o instanceof HTMLElement?i=g(e,i,o):n.Log.Error(536921103,"Unexpected Node type"))}return i}function v(e,t,r,i,a,s,c,u,d){for(var h=t,f=i.concat([window.getComputedStyle(r)]),m=0;m<r.childNodes.length;m++){var p=r.childNodes[m];if("ql-cursor"!==r.className)if(p instanceof Text){var g=T(p.data,e,h);u.set(_(f,d,c),new l.TextRange(h,g.length));for(var y=document.createRange(),S=0;S<g.length;S++){var b=h+S,C=g[S];if(null!=C){y.setStart(p,C),y.setEnd(p,C+1);var w=y.getBoundingClientRect();a[b]=new o.Rect((w.left-s.x)*c,(w.top-s.y)*c,(w.right-s.x)*c,(w.bottom-s.y)*c)}}h+=g.length}else p instanceof HTMLElement?h=v(e,h,p,f,a,s,c,u,d):n.Log.Error(539854429,"Unexpected Node type")}return h}function y(){return{fontFamily:"",isBold:!1,isItalic:!1,casing:"none",height:0,descent:0,baselineOffset:0,style:new s.Style(new s.SolidBrush(s.Color.Black))}}function _(e,t,r){var i=document.createElement("canvas").getContext("2d");if(!i||0==e.length)return y();var o,c,d,h="",f="",m="",g="",v="",_="",S="",T="",b=u(e);try{for(b.s();!(d=b.n()).done;){var C=d.value;h=C.fontSize||h,f=C.fontFamily||f,m=C.color||m,g="rgba(0, 0, 0, 0)"!=C.backgroundColor?C.backgroundColor:g,_=C.fontWeight||_,S=C.fontStyle||S,T=C.textTransform||T,v="sub"==C.verticalAlign||"super"==C.verticalAlign?C.verticalAlign:v,"underline"==C.textDecorationLine?o=C.textDecorationColor:"line-through"==C.textDecorationLine&&(c=C.textDecorationColor)}}catch(e){b.e(e)}finally{b.f()}var w=function(e){return e.endsWith("px")?Number(e.substring(0,e.length-2)):(n.Log.Error(539854430,"unexpected units"),0)}(h)*r,P=void 0;"sub"===v?P=.25*w:"super"==v&&(P=.5);var I=f.replace('"',"").replace('"',"").split(",")[0].replace("_MsFontService",""),k="700"===_,E="italic"===S,x=T;i.font=h+" "+f;var L,A,M=i.measureText("p");if(M.fontBoundingBoxAscent&&M.fontBoundingBoxDescent?(L=M.fontBoundingBoxAscent*r,A=M.fontBoundingBoxDescent*r):(L=M.actualBoundingBoxAscent*r,A=M.actualBoundingBoxDescent*r,n.Log.Error(538190743,"fontBoundingBoxAscent/fontBoundingBoxDescent not supported")),t){var R=t(I,k,E,w);R&&(L=R.ascent,A=R.descent)}var O,D=s.Color.Black;m.startsWith("rgb")&&(D=p(m));var F=g.startsWith("rgb")&&"rgba(0, 0, 0, 0)"!=g;if(F||o||c){if(O=new a.TrackableArray,F){var B=new s.Style(new s.SolidBrush(p(g))),N=L+A,V=A-.5*N,U=new l.TextStroke(l.TextStrokeType.highlighter,V,N,B);O.push(U)}if(o){var W=.1*w,G=.1*w,H=new l.TextStroke(l.TextStrokeType.single,W,G);O.push(H)}if(c){var j=A-.5*(L+A),z=.1*w,q=new l.TextStroke(l.TextStrokeType.single,j,z);O.push(q)}}return{fontFamily:I,isBold:k,isItalic:E,casing:x,height:w,descent:A,baselineOffset:P,style:new s.Style(new s.SolidBrush(D)),strokeArray:O}}t.s_fontLocationOverride=i;var S=[" ","","\t"];function T(e,t,r){for(var i,a,o=[],s=0,l=r;l<t.length&&s<e.length;l++)if((i=e[s])==(a=t[l])||S.includes(i)&&S.includes(a))o.push(s),s++;else{var c=e.indexOf(t[l],s),u=t.indexOf(e[s],l);-1!=c&&(-1==u||c-s<u-l)?(n.Log.Error(537002706,"CharacterMapping skipping ".concat(c-s," characters")),o.push(c),s=c+1):-1!=u?("\n"!=t[l]&&n.Log.Error(537002707,"CharacterMapping missed a character but can continue"),o.push(void 0)):(n.Log.Error(537002708,"CharacterMappingmismatch treated as substitution"),o.push(s),s++)}return o}function b(e,t){if(t.length==e.length){for(var r=[],i=0;i<t.length;i++)r.push([t[i]]);return r}1!=e.length&&n.Log.Error(536921104,"Unexpected paragraph count. should be 1 or matching the HTML nodes");for(var a=[],o=0;o<t.length;o++)a.push(t[o]);var s=[];s.push(a);for(var l=1;l<e.length;l++)s.push([]);return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultGlyphPathFuntion=function(){return l.getGlyphPathFromFontHandler},t.createTextLayoutFromParagraphInfo=function(e,t,r,i){var n,a=new s.TextLayout,o=c(e);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l){var u=d(l.paragraphStart,l.paragraphString,l.characterBounds,l.runInfoPerRange,t,r,i);a.addParagraph(u)}}}catch(e){o.e(e)}finally{o.f()}return a},t.createTextParagraph=d,t.createTextLine=h;var i=r(13),n=r(12),a=r(27),o=r(16),s=r(39),l=r(273);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function d(e,t,r,n,a,l,u){var d=new s.TextParagraph(new s.TextRange(e,t.length),new o.Style(new o.SolidBrush(o.Color.Black)));if(t.length!=r.length)return i.Log.Error(536921100,"bounds and character count must match, returning empty paragraph"),d;var f,m=c(function(e,t,r,i){for(var n=[],a=0,o=1;o<i;o++){var l=e[o-1],c=e[o],u=t.getAt(o-1),d=t.getAt(o),h=l.bottom-u.descent-(u.baselineOffset||0),f=c.bottom-d.descent-(d.baselineOffset||0);Math.abs(f-h)>.25*Math.max(l.height,c.height)&&(n.push(new s.TextRange(a,o-a)),a=o)}return a<e.length&&n.push(new s.TextRange(a,e.length-a)),n}(r,n,0,t.length));try{for(m.s();!(f=m.n()).done;){var p=h(f.value,t,r,n,a,l,u);d.addLine(p)}}catch(e){m.e(e)}finally{m.f()}var g,v=c(n.dataPerRange);try{for(v.s();!(g=v.n()).done;){var y=g.value;d.stylePerLocalRange.set(y.data.style,y.range),y.data.effects&&d.effectsPerLocalRange.set(y.data.effects,y.range),y.data.strokeArray&&d.strokesPerLocalRange.set(y.data.strokeArray,y.range)}}catch(e){v.e(e)}finally{v.f()}return d}function h(e,t,r,o,l,c,u){for(var d,h=0,f=new Array(e.length),m=e.start;m<=e.last;m++){var p=o.getAt(m);f[m-e.start]=p;var g=r[m];d=n.Rect.UnionRect(d,g),h+=(g.bottom-p.descent-(p.baselineOffset||0))/e.length}d||(d=new n.Rect,i.Log.Error(536921101,"Unable to get line bounds"));for(var v=new n.Vector2(d.left,h),y=[],_=e.start;_<=e.last;_++){var S=f[_-e.start],T=r[_],b=T.bottom-S.descent,C=c(t,_,new n.Vector2(T.left-v.x,b-v.y),S.height,S.fontFamily,S.isBold,S.isItalic,S.casing,u),w=C instanceof a.Path?C:null==C?void 0:C.path,P=null==C?void 0:C.outlinePath,I=new s.TextCharacter(T.translate(v.negate()),w,!1,!1,void 0,P);y.push(I)}var k=new s.TextLine(e,d.translate(v.negate()));return k.offset=v,k.characters=y,k.textEffectMetrics=new s.TextEffectMetrics(h-d.top,d.bottom-h,d.height*l),k}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLogger=function(e){if(!e)throw new Error("The 'logger' argument is missing");l.setLogger(e)},t.ULS=t.UlsLoggerWrapper=void 0;var n=i(r(1)),a=i(r(2)),o=r(112),s=(r(146),(0,a.default)((function e(){(0,n.default)(this,e),this.externalLogger=new o.NoopLogger}),[{key:"setCorrelationId",value:function(e){this.externalLogger.setCorrelationId(e)}},{key:"setLogger",value:function(e){this.externalLogger=e}},{key:"sendTraceTag",value:function(e,t,r,i){this.externalLogger.sendTraceTag(e,t,r,i)}},{key:"debugAssertTag",value:function(e,t,r,i){this.externalLogger.debugAssertTag(e,t,r,i)}},{key:"shipAssertTag",value:function(e,t,r,i){this.externalLogger.shipAssertTag(e,t,r,i)}}]));t.UlsLoggerWrapper=s;var l=new s;t.ULS=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(73),s=r(147),l=function(){function e(){(0,n.default)(this,e),this.correlationId=""}return(0,a.default)(e,[{key:"getLogMessage",value:function(t,r,i){var n="tag_".concat(e.tagIntToString(t)," [").concat(s.LogCategory[r],"] ").concat(i);return this.correlationId&&""!==this.correlationId&&(n+="\t\t".concat(this.correlationId)),n}},{key:"sendTraceTag",value:function(e,t,r,i){var n=this.logMessage;switch(r){case o.TraceLevel.Error:n=this.logError;break;case o.TraceLevel.Warning:n=this.logWarning;break;case o.TraceLevel.Info:n=this.logInfo;break;case o.TraceLevel.Verbose:n=this.logVerbose;break;case o.TraceLevel.Spam:default:n=this.logMessage}try{n(this.getLogMessage(e,t,i))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}}},{key:"shipAssertTag",value:function(e,t,r,i){console.assert(r,this.getLogMessage(e,t,i))}},{key:"debugAssertTag",value:function(e,t,r,i){this.shipAssertTag(e,t,r,i)}},{key:"setCorrelationId",value:function(e){this.correlationId=e}},{key:"logMessage",value:function(e){"log"in console&&console.log(e)}},{key:"logError",value:function(e){"error"in console&&console.error(e)}},{key:"logWarning",value:function(e){"warn"in console&&console.warn(e)}},{key:"logInfo",value:function(e){"info"in console&&console.info(e)}},{key:"logVerbose",value:function(e){"debug"in console&&console.debug(e)}}],[{key:"tagIntToString",value:function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)}}])}();t.ConsoleLogger=l,l.maxNumericTag=65535,l.minOldSchemeHighByteValue=36,l.map="abcdefghijklmnopqrstuvwxyz0123456789"},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LogCategory=void 0,t.LogCategory=i,function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(i||(t.LogCategory=i={}))},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LogType=void 0,t.LogType=i,function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(i||(t.LogType=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadLogs=function(e,t,r){if(t){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch(e){}!function(e,t,r){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,r),i.send(e))}(e,t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatForUpload=function(e,t,r,i){var n=[],a=e.map((function(e){return function(e,t,r){var i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){var n=r.findIndex((function(t){return t===e.correlationId}));n<0&&(n=r.push(e.correlationId)-1),i.I=n}var a=1e3*e.type+e.level;return i.D=a,i}(e,i,n)})),o=function(e,t,r,i,n){var a={};return a.T=e,a.L=t,a.S=r,a.I=i,n&&n.length>0&&(a.W=n),a.V=1,a}(i,a,t,r,n);return JSON.stringify(o)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.VisTrackAnimEvaluator=t.SmoothHelperAnimEvaluator=t.BezierAnimEvaluator=t.LinearListAnimEvaluator=t.LinearAnimEvaluator=t.ConstantAnimEvaluator=t.ConstantObjectAnimEvaluator=t.TimeAnimEvaluator=void 0;var n=i(r(9)),a=i(r(8)),o=i(r(10)),s=i(r(2)),l=i(r(1)),c=i(r(5)),u=r(74),d=r(53);function h(e,t,r){return t=(0,a.default)(t),(0,n.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,a.default)(e).constructor):t.apply(e,r))}var f=(0,s.default)((function e(t){(0,l.default)(this,e),(0,c.default)(this,"TimeSmoother",null),(0,c.default)(this,"m_clickTimeProvider",void 0),this.m_clickTimeProvider=t})),m=function(e){function t(e,r,i,n,a){var o;return(0,l.default)(this,t),o=h(this,t,[a]),(0,c.default)(o,"m_timelineId",void 0),(0,c.default)(o,"m_evalTimeSpan",void 0),(0,c.default)(o,"m_numRepeats",void 0),(0,c.default)(o,"m_repeatGap",void 0),(0,c.default)(o,"m_adjustedStartTime",0),(0,c.default)(o,"m_adjustedEndTime",0),o.m_timelineId=e,o.m_evalTimeSpan=r,o.m_numRepeats=i,o.m_repeatGap=n,o}return(0,o.default)(t,e),(0,s.default)(t,[{key:"checkAndUpdateTimeBounds",value:function(e){var t,r=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum).ClickTime;if(r===d.AnimConstants.Undefined)return!1;if(e<(r+=this.m_evalTimeSpan.Start.Offs)){var i=this.m_numRepeats===d.AnimConstants.RepeatForever,n=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum+1).ClickTime!==d.AnimConstants.Undefined;if(i||!n)return!1}if(this.m_evalTimeSpan.End.Offs===d.AnimConstants.Undefined)t=d.AnimConstants.Undefined;else{if(this.m_evalTimeSpan.End.ClickNum===d.AnimConstants.Undefined?t=r+this.m_evalTimeSpan.End.Offs:(t=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.End.ClickNum).ClickTime)!==d.AnimConstants.Undefined&&(t+=this.m_evalTimeSpan.End.Offs),t!==d.AnimConstants.Undefined&&e>=t){var a=t-r+this.m_repeatGap;if(this.m_numRepeats!==d.AnimConstants.RepeatForever&&e>=t+a*this.m_numRepeats)return!1;if((e-t)%a<this.m_repeatGap)return!1}var o=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.SkipClickNum).ClickTime;if(o!==d.AnimConstants.Undefined&&e>=o)return!1}return this.m_adjustedStartTime=r,this.m_adjustedEndTime=t,!0}},{key:"getEquivalentTimeFromRepeatTime",value:function(e){if(e<this.m_adjustedEndTime)return e;if(this.m_adjustedEndTime===d.AnimConstants.Undefined)return e;var t=this.m_adjustedEndTime-this.m_adjustedStartTime+this.m_repeatGap;return 0===t?e:this.m_adjustedStartTime+(e-this.m_adjustedEndTime)%t-this.m_repeatGap}},{key:"TimelineId",get:function(){return this.m_timelineId}},{key:"TimeSpan",get:function(){return this.m_evalTimeSpan}}])}(f);t.TimeAnimEvaluator=m;var p=function(e){function t(e,r,i,n,a,o){var s;return(0,l.default)(this,t),s=h(this,t,[e,r,i,n,a]),(0,c.default)(s,"m_value",void 0),s.m_value=o,s}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){return t}},{key:"evaluateObject",value:function(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_value:t}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.ConstantObject}}])}(m);t.ConstantObjectAnimEvaluator=p;var g=function(e){function t(e,r,i,n,a,o){var s;return(0,l.default)(this,t),s=h(this,t,[e,r,i,n,a]),(0,c.default)(s,"m_modValue",void 0),s.m_modValue=o,s}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_modValue:t}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.ConstantObject}}])}(m);t.ConstantAnimEvaluator=g;var v=function(e){function t(e,r,i,n,a,o){var s;return(0,l.default)(this,t),s=h(this,t,[e,r,i,n,a]),(0,c.default)(s,"m_valRangePair",void 0),s.m_valRangePair=o,s}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){if(this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===d.AnimConstants.Undefined)return this.m_valRangePair.Val1;var r=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return this.m_valRangePair.Val1+r*(this.m_valRangePair.Val2-this.m_valRangePair.Val1)}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.Linear}}])}(m);t.LinearAnimEvaluator=v;var y=function(e){function t(e,r,i,n,a,o,s,u){var d;return(0,l.default)(this,t),d=h(this,t,[e,r,i,n,a]),(0,c.default)(d,"m_times",void 0),(0,c.default)(d,"m_values",void 0),(0,c.default)(d,"m_isReverse",void 0),d.m_times=o,d.m_values=s,d.m_isReverse=u,d}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){if(this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===d.AnimConstants.Undefined)return this.m_values[0];var r=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);this.m_isReverse&&(r=1-r);var i=0;for(i=0;i<this.m_times.length-1&&!(r<=this.m_times[i+1]);i+=1);if(i===this.m_times.length-1)return this.m_values[i];var n=this.m_values[i],a=this.m_values[i+1];return n+(r=(r-this.m_times[i])/(this.m_times[i+1]-this.m_times[i]))*(a-n)}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.Linear}}])}(m);t.LinearListAnimEvaluator=y;var _=function(e){function t(e,r,i,n,a,o){var s;return(0,l.default)(this,t),s=h(this,t,[e,r,i,n,a]),(0,c.default)(s,"m_controlValList",void 0),s.m_controlValList=o,s}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){if(null!=this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===d.AnimConstants.Undefined)return this.m_controlValList[0];var r=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return u.BezierHelper.calculateBezierCoordinate(this.m_controlValList[0],this.m_controlValList[1],this.m_controlValList[2],this.m_controlValList[3],r)}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.Bezier}}])}(m);t.BezierAnimEvaluator=_;var S=function(e){function t(e,r,i,n,a){return(0,l.default)(this,t),h(this,t,[e,r,i,n,a])}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){return t}},{key:"fInRange",value:function(e){return this.checkAndUpdateTimeBounds(e)}},{key:"getEquivalentTime",value:function(e){return this.getEquivalentTimeFromRepeatTime(e)}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.SmoothHelper}},{key:"AdjustedStartTime",get:function(){return this.m_adjustedStartTime}},{key:"AdjustedEndTime",get:function(){return this.m_adjustedEndTime}}])}(m);t.SmoothHelperAnimEvaluator=S;var T=function(e){function t(e,r,i){var n;return(0,l.default)(this,t),n=h(this,t,[i]),(0,c.default)(n,"m_visTrack",void 0),(0,c.default)(n,"m_modValue",void 0),(0,c.default)(n,"m_resolvedVisTrack",void 0),n.m_visTrack=e,n.m_modValue=r,n.m_resolvedVisTrack=void 0,n}return(0,o.default)(t,e),(0,s.default)(t,[{key:"evaluate",value:function(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkVisTrackMap(e)?t:this.m_modValue}},{key:"checkVisTrackMap",value:function(e){if(null==this.m_resolvedVisTrack){this.m_resolvedVisTrack=[];for(var t=0;t<this.m_visTrack.Length;t+=1){var r=this.m_visTrack.getMarker(t);if(r){var i=this.m_clickTimeProvider.getClickTime(r.TimelineId,r.ClickNum).ClickTime,n=0;this.m_clickTimeProvider.getClickTime(r.TimelineId,r.ClickNum+1).ClickTime===d.AnimConstants.Undefined&&(n=r.Offs);var a;a=i!==d.AnimConstants.Undefined?Math.max(0,i)+n:d.AnimConstants.Undefined,this.m_resolvedVisTrack.push(new u.AnimVisTrackResolvedMarker(a,r.FVisible,t))}}this.sortResolvedVisTrack()}for(var o=this.m_resolvedVisTrack.length-1;o>=0;o-=1){var s=this.m_resolvedVisTrack[o];if(s.ResolvedTime!==d.AnimConstants.Undefined&&s.ResolvedTime<=e)return s.FVisible}return!(this.m_resolvedVisTrack.length>0&&this.m_resolvedVisTrack[0].FVisible)}},{key:"sortResolvedVisTrack",value:function(){this.m_resolvedVisTrack&&this.m_resolvedVisTrack.sort(u.AnimVisTrackResolvedMarker.sortFunction)}},{key:"onClickListsChanged",value:function(){this.m_resolvedVisTrack=void 0}},{key:"EvalId",get:function(){return d.AnimEvaluatorId.VisTrack}},{key:"VisTrack",get:function(){return this.m_visTrack}},{key:"ModValue",get:function(){return this.m_modValue}}])}(f);t.VisTrackAnimEvaluator=T},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimSetLogger=function(e){f.ULS.setLogger(e)},t.AnimTranslate=void 0;var n,a=i(r(19)),o=i(r(1)),s=i(r(2)),l=i(r(5)),c=r(74),u=r(53),d=r(289),h=r(113),f=r(3),m=r(14),p=r(4);function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}!function(e){e[e.Timed=0]="Timed",e[e.UntilClick=1]="UntilClick",e[e.UntilSlide=2]="UntilSlide"}(n||(n={}));var y=function(){function e(){(0,o.default)(this,e),(0,l.default)(this,"m_durationType",n.Timed),(0,l.default)(this,"m_duration",2e3)}return(0,s.default)(e,[{key:"FTimed",get:function(){return this.m_durationType===n.Timed}},{key:"FUntilClick",get:function(){return this.m_durationType===n.UntilClick}},{key:"FUntilSlide",get:function(){return this.m_durationType===n.UntilSlide}},{key:"Duration",get:function(){return this.FTimed||f.ULS.sendTraceTag(508822175,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"AnimDuration: !FTimed, bad property access."),this.m_duration}}],[{key:"fromDuration",value:function(t){var r=new e;return r.m_duration=t,r}},{key:"fromString",value:function(t){var r=new e;return r.m_duration=1,"def"===t?(r.m_durationType=n.Timed,r.m_duration=2e3):"sld"===t?r.m_durationType=n.UntilSlide:"clk"===t?r.m_durationType=n.UntilClick:(r.m_durationType=n.Timed,r.m_duration=parseInt(t,10)),r}}])}(),_=function(){function e(t){(0,o.default)(this,e),(0,l.default)(this,"m_visTrackTable",new Map),(0,l.default)(this,"m_mpRestEvalHelperTable",new Map),(0,l.default)(this,"m_evalCreator",void 0),this.m_evalCreator=new d.AnimEvaluatorCreator(t,this.m_visTrackTable)}return(0,s.default)(e,[{key:"calcChildRewindDelay",value:function(e,t,r){return e*(r-t-1)}},{key:"createAnimObjectListForSlide",value:function(e,t,r){var i,n=new Map,o=[],s=g(t);try{for(s.s();!(i=s.n()).done;){var l,d=i.value,f=g(d.parts.entries());try{for(f.s();!(l=f.n()).done;){var m=(0,a.default)(l.value,2),p=m[0],v=m[1],y=1===d.parts.length?d.id:"".concat(d.id,"c").concat(p),_=new c.AnimObject(y,v),S=n.get(d.id)||[];S.push(_),n.set(d.id,S),this.m_visTrackTable[y]=new c.AnimVisTrack,this.m_mpRestEvalHelperTable[y]=[],o.push(_);var T=new h.NumberAnimAttribute(u.AnimAttributeId.Visible,1,u.AnimAggregateRule.Mult),b=this.m_evalCreator.addEvaluatorVisTrack(this.m_visTrackTable[y],0);T.registerAnimEvaluator(b),_.registerAnimAttribute(T,!1)}}catch(e){f.e(e)}finally{f.f()}}}catch(e){s.e(e)}finally{s.f()}for(var C=this.translateAnimations(e,n,r),w=0;w<o.length;w+=1)this.generateRestEvaluators(o[w]);return{animObjectList:o,needsDummyClick:C}}},{key:"getNumChildAnims",value:function(e,t){if(t.childTimeInc<0)return 0;var r=e.get(t.shapeId);return null==r||null==r.length?0:r.length}},{key:"translateAnimations",value:function(e,t,r){var i,n=!0,o=!1,s=g(e);try{for(s.s();!(i=s.n()).done;){var l=i.value;if(l.AnimationList&&l.SequenceId){var c,d=l.AnimationList,h=l.SequenceId,m=0,p=0,v=0,_=!1,S=g(d);try{for(S.s();!(c=S.n()).done;){var T=c.value;if(null!=!T){n&&(T.startTrig!==u.AnimStartTrig.OnClick&&(o=!0,T.startTrig=u.AnimStartTrig.OnClick),n=!1);var b=1;!T.autoReverse||T.effectType!==u.AnimEffectCategory.Emphasis&&T.effectType!==u.AnimEffectCategory.MotionPath||(b*=2),T.numRepeats!==u.AnimConstants.RepeatUntilClick&&T.numRepeats!==u.AnimConstants.RepeatUntilEnd&&(b*=T.numRepeats+1);var C=0,w=this.getNumChildAnims(t,T);w>0&&(C+=w*T.childTimeInc);var P=0,I=0,k=y.fromString(T.animSpeed),E=T.numRepeats===u.AnimConstants.RepeatUntilClick||T.numRepeats===u.AnimConstants.RepeatUntilEnd||!k.FTimed,x=0;switch(E||(x=b*k.Duration),T.startTrig){case u.AnimStartTrig.OnClick:P=m+=1,I=T.timeOffs,p=0,v=I+x+C;break;case u.AnimStartTrig.WithPrevious:P=m,I=p+T.timeOffs,v=Math.max(v,I+x+C);break;case u.AnimStartTrig.AfterPrevious:_?(P=m,I+=T.timeOffs,p=v):(P=m,I=v+T.timeOffs,p=v),v=I+x+C;break;default:f.ULS.sendTraceTag(508822174,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateAnimations: Unrecognized start trigger, assuming onClick."),P=m+=1,I=T.timeOffs,p=0,v=I+x+C}if(_=E,T.childTimeInc<0){var L=t.get(T.shapeId);if(!L||!L[0]){f.ULS.sendTraceTag(508822173,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateAnimations: Invalid shapeId:".concat(T.shapeId,". Anim ignored."));continue}this.translateOneAnim(T,h,L[0],P,I,k,r)}else{var A,M=t.get(T.shapeId)||[],R=T.childTimeInc,O=k,D=M.length,F=g(M.entries());try{for(F.s();!(A=F.n()).done;){var B=(0,a.default)(A.value,2),N=B[0],V=B[1];T.rewindChildDelay=this.calcChildRewindDelay(T.childTimeInc,N,D),this.translateOneAnim(T,h,V,P,I+R,O,r),R+=T.childTimeInc}}catch(e){F.e(e)}finally{F.f()}}}}}catch(e){S.e(e)}finally{S.f()}}}}catch(e){s.e(e)}finally{s.f()}return o}},{key:"translateOneAnim",value:function(t,r,i,n,a,o,s){switch(f.ULS.sendTraceTag(507327195,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateOneAnim: Animation effectType:".concat(t.effectType,", effectId:").concat(t.effectId)),t.effectType){case u.AnimEffectCategory.Entrance:this.translateEntranceExitEffect(t,r,i,n,a,o,!0,s);break;case u.AnimEffectCategory.Exit:this.translateEntranceExitEffect(t,r,i,n,a,o,!1,s);break;case u.AnimEffectCategory.MotionPath:this.addInitialVisibilityMarker(i.Id,r),this.translateMotionPathEffect(t,r,i,n,a,o.Duration);break;case u.AnimEffectCategory.Emphasis:this.translateEmphasisEffect(t,r,i,n,a,o),this.addInitialVisibilityMarker(i.Id,r);break;case u.AnimEffectCategory.Media:this.translateMediaEffect(t,r,i,n,a,o);break;default:f.ULS.sendTraceTag(508822171,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateOneAnim: Unknown anim effect category. Ignored.")}if(t.numRepeats!==u.AnimConstants.RepeatUntilEnd){var l=this.m_visTrackTable[i.Id];if(!l)return void f.ULS.sendTraceTag(508822170,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateOnAnim: Bad visibility track when trying to add After effect.");if(t.after===u.AnimAfterEffectType.HideImmediatelyAfter){var c=o.FTimed?o.Duration:0;l.becomesInvisibleAt(r,e.getRepeatsClick(n,t.numRepeats),e.getRepeatsOffs(a,c,t.numRepeats))}else t.after===u.AnimAfterEffectType.HideOnNextClick&&l.becomesInvisibleAt(r,n+1,0)}}},{key:"translateEntranceExitEffect",value:function(t,r,i,n,a,o,s,l){var c=t.effectId,d={animObject:i,timelineId:r,click:n,offs:a,dur:o,isEntrance:s,numRepeats:t.numRepeats,direction:t.direction,effectId:c};switch(c){case u.AnimEntranceExitEffectId.Appear:this.addEffect_Appear(d);break;case u.AnimEntranceExitEffectId.Fly:case u.AnimEntranceExitEffectId.Crawl:this.addEffect_Fly(d,l,t.smoothStartFactor,t.smoothEndFactor);break;case u.AnimEntranceExitEffectId.Lightspeed:d.direction=s?u.AnimDirConstants.Left:u.AnimDirConstants.Right,this.addEffect_Fly(d,l,t.smoothStartFactor,t.smoothEndFactor);break;case u.AnimEntranceExitEffectId.Dissolve:d.direction=0,this.addEffect_ComplexClip(d);break;case u.AnimEntranceExitEffectId.Blinds:case u.AnimEntranceExitEffectId.Box:case u.AnimEntranceExitEffectId.Checkerboard:case u.AnimEntranceExitEffectId.Circle:case u.AnimEntranceExitEffectId.Diamond:case u.AnimEntranceExitEffectId.RandomBars:case u.AnimEntranceExitEffectId.Plus:case u.AnimEntranceExitEffectId.Split:case u.AnimEntranceExitEffectId.Strips:case u.AnimEntranceExitEffectId.Wedge:case u.AnimEntranceExitEffectId.Wheel:this.addEffect_ComplexClip(d);break;case u.AnimEntranceExitEffectId.Fade:this.addEffect_Fade(d,0,1,0);break;case u.AnimEntranceExitEffectId.FlashOnce:this.addEffect_FlashOnce(d);break;case u.AnimEntranceExitEffectId.Peek:this.addEffect_Peek(d);break;case u.AnimEntranceExitEffectId.Stretch:this.addEffect_Stretch(d);break;case u.AnimEntranceExitEffectId.Swivel:this.addEffect_Swivel(d,!1);break;case u.AnimEntranceExitEffectId.FadedSwivel:this.addEffect_Swivel(d,!0);break;case u.AnimEntranceExitEffectId.Wipe:this.addEffect_Wipe(d);break;case u.AnimEntranceExitEffectId.Zoom:d.direction=e.translatePPTZoomFlags(d.direction,d.isEntrance),this.addEffect_Zoom(d,l);break;case u.AnimEntranceExitEffectId.Boomerang:this.addEffect_Boomerang(d);break;case u.AnimEntranceExitEffectId.Credits:this.addEffect_Credits(d,l.y);break;case u.AnimEntranceExitEffectId.EaseIn:this.addEffect_EaseIn(d);break;case u.AnimEntranceExitEffectId.Float:this.addEffect_Float(d);break;case u.AnimEntranceExitEffectId.GrowAndTurn:this.addEffect_GrowAndTurn(d);break;case u.AnimEntranceExitEffectId.Pinwheel:this.addEffect_PinWheel(d);break;case u.AnimEntranceExitEffectId.RiseUp:this.addEffect_RiseUp(d);break;case u.AnimEntranceExitEffectId.Swish:this.addEffect_Swish(d,l);break;case u.AnimEntranceExitEffectId.ThinLine:this.addEffect_Thinline(d);break;case u.AnimEntranceExitEffectId.Unfold:this.addEffect_Unfold(d);break;case u.AnimEntranceExitEffectId.Whip:this.addEffect_Whip(d);break;case u.AnimEntranceExitEffectId.Ascend:case u.AnimEntranceExitEffectId.Descend:this.addEffect_AscendDescend(d);break;case u.AnimEntranceExitEffectId.Sling:this.addEffect_Sling(d,l);break;case u.AnimEntranceExitEffectId.Spinner:this.addEffect_Spinner(d);break;case u.AnimEntranceExitEffectId.Compress:this.addEffect_ExpandCompress(d,u.AnimConstants.CompressWidthFactor);break;case u.AnimEntranceExitEffectId.Expand:this.addEffect_ExpandCompress(d,u.AnimConstants.ExpandWidthFactor);break;case u.AnimEntranceExitEffectId.Zip:this.addEffect_Zip(d,l);break;case u.AnimEntranceExitEffectId.Arcup:this.addEffect_ArcUp(d,t);break;case u.AnimEntranceExitEffectId.FadedZoom:d.direction=e.translatePPTZoomFlags(d.direction,d.isEntrance),this.addEffect_FadedZoom(d,l);break;case u.AnimEntranceExitEffectId.Glide:this.addEffect_Glide(d);break;case u.AnimEntranceExitEffectId.Flip:this.addEffect_Flip(d,l);break;case u.AnimEntranceExitEffectId.Fold:this.addEffect_Fold(d,l,t.smoothStartFactor,t.smoothEndFactor);break;case u.AnimEntranceExitEffectId.Draw:this.addEffect_Draw(d,t.animatedPropertyList);break;case u.AnimEntranceExitEffectId.Arrive3D:case u.AnimEntranceExitEffectId.FlyIn3D:if(p.Settings.readBooleanOrDefault("enableAnimations3D",!1)){this.addEffect_AnimatedPropertyList(d,t.rewind,t.autoReverse,t.smoothStartFactor,t.smoothEndFactor,t.animatedPropertyList);break}default:f.ULS.sendTraceTag(508822169,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateEntranceExitEffect: Unrecognized or unimplemented effect ID:  ".concat(t.effectId," . Using Fade instead.")),this.addEffect_Fade(d,0,1,0),m.VetoUtils.recordVeto("AnimationFallback",{EffectId:t.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}if(t.rewind&&t.numRepeats!==u.AnimConstants.RepeatUntilEnd){if(!this.m_visTrackTable[i.Id])return;var h=e.getRepeatsOffs(a,o.Duration,t.numRepeats);t.rewindChildDelay>=0&&(h+=t.rewindChildDelay),s?this.m_visTrackTable[i.Id].becomesInvisibleAt(r,e.getRepeatsClick(n,t.numRepeats),h):this.m_visTrackTable[i.Id].becomesVisibleAt(r,e.getRepeatsClick(n,t.numRepeats),h)}}},{key:"addEffect_AnimatedPropertyList",value:function(e,t,r,i,n,a){this.addEffect_Fade(e,0,1,0),this.addEmphEffect_AnimatedPropertyList(e.animObject,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,t,r,i,n,a)}},{key:"addEffect_Appear",value:function(e){var t=this.m_visTrackTable[e.animObject.Id];t?e.isEntrance?t.becomesVisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):t.becomesInvisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):f.ULS.sendTraceTag(508822168,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"AnimTranslate::addEffect_Appear: Bad visTrack for aoId ".concat(e.animObject.Id,"."))}},{key:"addEffect_Fly",value:function(e,t,r,i){var n=e.animObject.Shape.position.x,a=e.animObject.Shape.position.y,o=e.animObject.Shape.size,s=0,l=0;if((e.direction&u.AnimDirConstants.Left)>0&&(s=-(n+o.x)),(e.direction&u.AnimDirConstants.Top)>0&&(l=-(a+o.y)),(e.direction&u.AnimDirConstants.Right)>0&&(s=t.x-n),(e.direction&u.AnimDirConstants.Bottom)>0&&(l=t.y-a),0!==s){var c=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,n,u.AnimAggregateRule.Add),d=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,c,e.click,e.offs,e.dur.Duration,0,s,e.isEntrance,e.numRepeats,0);d&&this.m_evalCreator.addTimeSmoother(d,r,i,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(c,!1)}if(0!==l){var f=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,a,u.AnimAggregateRule.Add),m=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,f,e.click,e.offs,e.dur.Duration,0,l,e.isEntrance,e.numRepeats,0);m&&this.m_evalCreator.addTimeSmoother(m,r,i,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(f,!1)}}},{key:"addEffect_Fade",value:function(t,r,i,n){var a=new h.ObjectAnimAttribute(u.AnimAttributeId.FadeMaskInfo,null,u.AnimAggregateRule.First),o=e.getFadeMaskInfo(u.AnimEntranceExitEffectId.Fade,0,t.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(t.animObject.Id,t.timelineId,a,t.click,t.offs,t.dur.Duration,o,t.isEntrance,t.numRepeats,r),t.animObject.registerAnimAttribute(a,!1);var s=new h.NumberAnimAttribute(u.AnimAttributeId.FadeMaskProgress,1,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorVisLinearBidir(t.animObject.Id,t.timelineId,s,t.click,t.offs,t.dur.Duration,i,n,t.isEntrance,t.numRepeats,r),t.animObject.registerAnimAttribute(s,!1)}},{key:"addEffect_ComplexClip",value:function(t){var r=new h.ObjectAnimAttribute(u.AnimAttributeId.FadeMaskInfo,null,u.AnimAggregateRule.First),i=e.getFadeMaskInfo(t.effectId,t.direction,t.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(t.animObject.Id,t.timelineId,r,t.click,t.offs,t.dur.Duration,i,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(r,!1);var n=new h.NumberAnimAttribute(u.AnimAttributeId.FadeMaskProgress,1,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorVisLinearBidir(t.animObject.Id,t.timelineId,n,t.click,t.offs,t.dur.Duration,1,0,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(n,!1)}},{key:"addEffect_FlashOnce",value:function(t){var r=new h.NumberAnimAttribute(u.AnimAttributeId.Visible,1,u.AnimAggregateRule.Mult),i=this.m_visTrackTable[t.animObject.Id];null!==i?(t.isEntrance?i.becomesVisibleAt(t.timelineId,t.click,t.offs):this.m_evalCreator.addEvaluatorConstantDuration(t.timelineId,r,t.click,t.offs,t.dur.Duration/2,0,t.numRepeats,t.dur.Duration/2),t.numRepeats!==u.AnimConstants.RepeatUntilEnd&&i.becomesInvisibleAt(t.timelineId,e.getRepeatsClick(t.click,t.numRepeats),e.getRepeatsOffs(t.offs,t.dur.Duration,t.numRepeats)),t.animObject.registerAnimAttribute(r,!1)):f.ULS.sendTraceTag(508822167,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"AnimTranslate::addEffect_FlashOnce: Bad visTrack for aoId ".concat(t.animObject.Id," at AddEffect_FlashOnce."))}},{key:"addEffect_Peek",value:function(t){var r,i=0,n=t.animObject.Shape.size;t.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,t.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1),t.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,t.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var a=t.isEntrance?e.flipDirection(t.direction):t.direction;switch(t.direction){case u.AnimDirConstants.Top:r=u.AnimAttributeId.PosY,i=-n.y;break;case u.AnimDirConstants.Right:r=u.AnimAttributeId.PosX,i=n.x;break;case u.AnimDirConstants.Left:r=u.AnimAttributeId.PosX,i=-n.x;break;case u.AnimDirConstants.Bottom:default:r=u.AnimAttributeId.PosY,i=n.y}var o=new h.ObjectAnimAttribute(u.AnimAttributeId.FadeMaskInfo,null,u.AnimAggregateRule.First),s=e.getFadeMaskInfo(u.AnimEntranceExitEffectId.Wipe,a,t.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(t.animObject.Id,t.timelineId,o,t.click,t.offs,t.dur.Duration,s,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(o,!1);var l=new h.NumberAnimAttribute(u.AnimAttributeId.FadeMaskProgress,1,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorVisLinearBidir(t.animObject.Id,t.timelineId,l,t.click,t.offs,t.dur.Duration,1,0,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(l,!1);var c=new h.NumberAnimAttribute(r,-i,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(t.animObject.Id,t.timelineId,c,t.click,t.offs,t.dur.Duration,0,i,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(c,!1)}},{key:"addEffect_Stretch",value:function(e){var t=e.animObject.Shape.position.x,r=e.animObject.Shape.position.y,i=e.animObject.Shape.size,n=0,a=0,o=1,s=1;switch(e.direction){case u.AnimDirConstants.Stretch_FromLeft:o=0,n=-i.x/2;break;case u.AnimDirConstants.Stretch_FromRight:o=0,n=i.x/2;break;case u.AnimDirConstants.Stretch_FromTop:s=0,a=-i.y/2;break;case u.AnimDirConstants.Stretch_FromBottom:s=0,a=i.y/2;break;case u.AnimDirConstants.Stretch_Across:default:o=0}if(1!==o){var l=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1)}if(1!==s){var c=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,c,e.click,e.offs,e.dur.Duration,1,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(c,!1)}if(0!==n){var d=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,t,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,d,e.click,e.offs,e.dur.Duration,0,n,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(d,!1)}if(0!==a){var f=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,r,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,f,e.click,e.offs,e.dur.Duration,0,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(f,!1)}}},{key:"addEffect_Swivel",value:function(e,t){var r=1,i=1;switch(e.direction){case u.AnimDirConstants.Swivel_Vertical:i=0;break;case u.AnimDirConstants.Swivel_Horizontal:default:r=0}if(1!==r){var n=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,1,r,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}if(1!==i){var a=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,a,e.click,e.offs,e.dur.Duration,1,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(a,!1)}t&&this.addEffect_Fade(e,0,1,0)}},{key:"addEffect_Wipe",value:function(t){var r=new h.ObjectAnimAttribute(u.AnimAttributeId.FadeMaskInfo,null,u.AnimAggregateRule.First),i=e.getFadeMaskInfo(t.effectId,t.direction,t.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(t.animObject.Id,t.timelineId,r,t.click,t.offs,t.dur.Duration,i,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(r,!1);var n=new h.NumberAnimAttribute(u.AnimAttributeId.FadeMaskProgress,1,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorVisLinearBidir(t.animObject.Id,t.timelineId,n,t.click,t.offs,t.dur.Duration,1,0,t.isEntrance,t.numRepeats,0),t.animObject.registerAnimAttribute(n,!1)}},{key:"addEffect_Draw",value:function(e,t){t&&"drawprogressallatonce"===t[0].name.toLowerCase()?e.direction=1:e.direction=0,this.addEffect_Wipe(e)}},{key:"addEffect_Zoom",value:function(e,t){var r=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,n=e.animObject.Shape.size,a=0,o=0,s=0;switch(e.direction){case u.AnimDirConstants.Zoom_InFromCenter:o=u.AnimConstants.Zoom_InFromCenterFactor*(t.x-n.x)-r,s=u.AnimConstants.Zoom_InFromCenterFactor*(t.y-n.y)-i;break;case u.AnimDirConstants.Zoom_InSlightly:a=u.AnimConstants.Zoom_InSlightlyScaleInit;break;case u.AnimDirConstants.Zoom_Out:a=u.AnimConstants.Zoom_OutScaleInit;break;case u.AnimDirConstants.Zoom_OutFromBottom:a=u.AnimConstants.Zoom_OutFromBottomScaleFactor,s=t.y-i;break;case u.AnimDirConstants.Zoom_OutSlightly:a=u.AnimConstants.Zoom_OutSlightlyScaleInit;break;case u.AnimDirConstants.Zoom_In:}if(0!==o){var l=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,r,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,0,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1)}if(0!==s){var c=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,i,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,c,e.click,e.offs,e.dur.Duration,0,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(c,!1)}var d=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,d,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(d,!1);var f=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,f,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(f,!1)}},{key:"addEffect_Boomerang",value:function(e){var t=e.animObject.Shape.position.x,r=e.animObject.Shape.position.y,i=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,t,u.AnimAggregateRule.Add),n=[];n.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:u.AnimConstants.Boomerang_XOffs,SegOffs:e.dur.Duration/2}),n.push({Offs:e.offs,Dur:e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:0}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,i,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(i,!1);var a=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,r,u.AnimAggregateRule.Add),o=[];o.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:u.AnimConstants.Boomerang_YOffs2,OffsVal:u.AnimConstants.Boomerang_YOffs1,SegOffs:e.dur.Duration/2}),o.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:u.AnimConstants.Boomerang_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(a,!1);var s=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration/2,0,u.AnimConstants.BoomerangRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(s,!1);var l=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1),e.dur=y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}},{key:"addEffect_Spinner",value:function(e){this.addEffect_Fade(e,0,1,0);var t=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,u.AnimConstants.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);var r=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,u.AnimConstants.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1);var i=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,u.AnimConstants.Spinner_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}},{key:"addEffect_ExpandCompress",value:function(e,t){this.addEffect_Fade(e,0,1,0);var r=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}},{key:"addEffect_Zip",value:function(e,t){var r=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,n=e.animObject.Shape.size,a=.5*(t.x-n.x)-r,o=(t.y-n.y)*u.AnimConstants.Zip_YOffs_Ratio-i,s=u.AnimConstants.Zip_Midscale,l=u.AnimConstants.Zip_Midscale;e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var c=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add),d=[];d.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:a,OffsVal:a,SegOffs:.5*e.dur.Duration}),d.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,c,e.click,e.isEntrance,e.numRepeats,d),e.animObject.registerAnimAttribute(c,!1),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var f=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add),m=[];m.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:o,OffsVal:o,SegOffs:.5*e.dur.Duration}),m.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:o,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,f,e.click,e.isEntrance,e.numRepeats,m),e.animObject.registerAnimAttribute(f,!1);var p=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),g=[];g.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:s,OffsVal:1,SegOffs:.5*e.dur.Duration}),g.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:s,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,p,e.click,e.isEntrance,e.numRepeats,g),e.animObject.registerAnimAttribute(p,!1);var v=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult),_=[];_.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:l,OffsVal:1,SegOffs:.5*e.dur.Duration}),_.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:l,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,v,e.click,e.isEntrance,e.numRepeats,_),e.animObject.registerAnimAttribute(v,!1),e.dur=y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}},{key:"addEffect_ArcUp",value:function(e,t){this.addEffect_Fade(e,0,1,0),e.direction=u.AnimDirConstants.Zoom_OutSlightly,this.addEffect_Zoom(e,{x:0,y:0}),this.translateMotionPathEffect(t,e.timelineId,e.animObject,e.click,e.click,e.dur.Duration)}},{key:"addEffect_FadedZoom",value:function(e,t){this.addEffect_Fade(e,0,1,0),this.addEffect_Zoom(e,t)}},{key:"addEffect_Glide",value:function(e){this.addEffect_Fade(e,0,1,0);var t=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var r=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add),i=e.animObject.Shape.size.x;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,-i/2+u.AnimConstants.Glide_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}},{key:"addEffect_Flip",value:function(e,t){e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var r=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add),i=e.isEntrance?-t.y:t.y;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1);var n=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),a=[];a.push({Offs:e.offs,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+1/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+.5*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+3/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,a),e.animObject.registerAnimAttribute(n,!1);var o=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration,0,u.AnimConstants.Flip_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(o,!1)}},{key:"addEffect_Fold",value:function(e,t,r,i){this.addEffect_ExpandCompress(e,u.AnimConstants.CompressWidthFactor),e.direction=u.AnimDirConstants.Bottom,e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1),this.addEffect_Fly(e,t,r,i);var n=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,1,.5,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}},{key:"addEffect_Credits",value:function(t,r){var i=t.animObject.Shape.position.y,n=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,i,u.AnimAggregateRule.Add),a=this.m_visTrackTable[t.animObject.Id];null!=a?(t.isEntrance?(a.becomesVisibleAt(t.timelineId,t.click,t.offs),this.m_evalCreator.addEvaluatorLinear(t.timelineId,n,t.click,t.offs,t.dur.Duration,r,-r,t.numRepeats,0)):(a.becomesVisibleAt(t.timelineId,t.click,t.offs),this.m_evalCreator.addEvaluatorLinear(t.timelineId,n,t.click,t.offs,t.dur.Duration,-r,r,t.numRepeats,0)),t.numRepeats!==u.AnimConstants.RepeatUntilEnd&&a.becomesInvisibleAt(t.timelineId,e.getRepeatsClick(t.click,t.numRepeats),e.getRepeatsOffs(t.offs,t.dur.Duration,t.numRepeats)),t.animObject.registerAnimAttribute(n,!1)):f.ULS.sendTraceTag(508822166,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"AnimTranslate::addEffect_Credits: o visibility track for AO.")}},{key:"addEffect_EaseIn",value:function(e){var t=e.animObject.Shape.size.x;if(e.isEntrance)return e.direction=u.AnimDirConstants.Left,void this.addEffect_Peek(e);e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1),this.addEffect_Fade(e,0,1,0);var r=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,-t/2,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}},{key:"addEffect_AscendDescend",value:function(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var t=e.effectId===u.AnimEntranceExitEffectId.Ascend?u.AnimConstants.Ascend_Offs:u.AnimConstants.Descend_Offs,r=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}},{key:"addEffect_Float",value:function(e){var t=e.animObject.Shape.position.x,r=e.animObject.Shape.position.y,i=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,t,u.AnimAggregateRule.Add),n=[];n.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:u.AnimConstants.Float_XOffs2,OffsVal:u.AnimConstants.Float_XOffs1,SegOffs:e.dur.Duration/2}),n.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:u.AnimConstants.Float_XOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,i,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(i,!1);var a=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,r,u.AnimAggregateRule.Add),o=[];o.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:u.AnimConstants.Float_YOffs2,OffsVal:u.AnimConstants.Float_YOffs1,SegOffs:e.dur.Duration/2}),o.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:u.AnimConstants.Float_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(a,!1);var s=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration/2,0,u.AnimConstants.FloatRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(s,!1),e.dur=y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}},{key:"addEffect_GrowAndTurn",value:function(e){this.addEffect_Fade(e,0,1,0);var t=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,u.AnimConstants.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);var r=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,u.AnimConstants.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1);var i=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,u.AnimConstants.GrowAndTurn_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}},{key:"addEffect_PinWheel",value:function(e){this.addEffect_Fade(e,0,1,0),e.direction=u.AnimDirConstants.Zoom_In,this.addEffect_Zoom(e,{x:0,y:0});var t=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,u.AnimConstants.PinWheel_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}},{key:"addEffect_RiseUp",value:function(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var t=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add),r=[];r.push({Offs:e.offs,Dur:u.AnimConstants.RiseUp_Seg1Fraction*e.dur.Duration,BaseVal:u.AnimConstants.RiseUp_YOffs2,OffsVal:u.AnimConstants.RiseUp_YOffs1,SegOffs:(1-u.AnimConstants.RiseUp_Seg1Fraction)*e.dur.Duration}),r.push({Offs:e.offs+u.AnimConstants.RiseUp_Seg1Fraction*e.dur.Duration,Dur:e.dur.Duration*(1-u.AnimConstants.RiseUp_Seg1Fraction),BaseVal:0,OffsVal:u.AnimConstants.RiseUp_YOffs2,SegOffs:u.AnimConstants.RiseUp_Seg1Fraction*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(t,!1)}},{key:"addEffect_Swish",value:function(e,t){if(e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1),e.isEntrance){var r=u.AnimConstants.Swish_DropFraction,i=(1-u.AnimConstants.Swish_DropFraction)/2,n=i,a=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add),o=[];o.push({Offs:e.offs,Dur:r*e.dur.Duration,BaseVal:0,OffsVal:-t.y,SegOffs:(1-r)*e.dur.Duration}),o.push({Offs:e.offs+r*e.dur.Duration,Dur:e.dur.Duration*i,BaseVal:u.AnimConstants.Swish_BounceOffs,OffsVal:0,SegOffs:(1-i)*e.dur.Duration}),o.push({Offs:e.offs+(r+i)*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:0,OffsVal:u.AnimConstants.Swish_BounceOffs,SegOffs:(1-n)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(a,!1);var s=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add),l=[];l.push({Offs:e.offs,Dur:r*e.dur.Duration,BaseVal:u.AnimConstants.Swish_Theta,OffsVal:u.AnimConstants.Swish_Theta,SegOffs:(1-r)*e.dur.Duration}),l.push({Offs:e.offs+r*e.dur.Duration,Dur:e.dur.Duration*i,BaseVal:-u.AnimConstants.Swish_Theta,OffsVal:u.AnimConstants.Swish_Theta,SegOffs:(1-i)*e.dur.Duration}),l.push({Offs:e.offs+(r+i)*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:0,OffsVal:-u.AnimConstants.Swish_Theta,SegOffs:(1-n)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,s,e.click,e.isEntrance,e.numRepeats,l),e.animObject.registerAnimAttribute(s,!1)}else{var c=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,c,e.click,e.offs,e.dur.Duration,0,-u.AnimConstants.Swish_Theta,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(c,!1);var d=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,d,e.click,e.offs,e.dur.Duration,0,t.y,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(d,!1)}}},{key:"addEffect_Thinline",value:function(e){e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var t=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add),r=[];r.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:u.AnimConstants.ThinLine_XOffs,SegOffs:.5*e.dur.Duration}),r.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(t,!1);var i=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),n=[];n.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:u.AnimConstants.ThinLine_WInit,OffsVal:u.AnimConstants.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),n.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:u.AnimConstants.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,i,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(i,!1);var a=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult),o=[];o.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:u.AnimConstants.ThinLine_HInit,OffsVal:u.AnimConstants.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),o.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:u.AnimConstants.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(a,!1)}},{key:"addEffect_Unfold",value:function(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var t=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,u.AnimConstants.Unfold_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}},{key:"addEffect_Whip",value:function(e){e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var t=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add),r=[];r.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:u.AnimConstants.Whip_XOffs,OffsVal:u.AnimConstants.Whip_XOffs,SegOffs:.5*e.dur.Duration}),r.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:u.AnimConstants.Whip_XOffs,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,r),e.animObject.registerAnimAttribute(t,!1);var i=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),n=[];n.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:u.AnimConstants.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),n.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:u.AnimConstants.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,i,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(i,!1);var a=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult),o=[];o.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:u.AnimConstants.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),o.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:u.AnimConstants.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(a,!1),e.dur=y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}},{key:"addEffect_Sling",value:function(e,t){var r=e.animObject.Shape.position.x,i=-t.x-r,n=-r+t.x-u.AnimConstants.Sling_XMid_Offs,a=n/2;e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,e.animObject.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1);var o=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,0,u.AnimAggregateRule.Add),s=[];s.push({Offs:e.offs,Dur:1/3*e.dur.Duration,BaseVal:n,OffsVal:i,SegOffs:2/3*e.dur.Duration}),s.push({Offs:e.offs+1/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:a,OffsVal:n,SegOffs:2/3*e.dur.Duration}),s.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,o,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(o,!1);var l=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add),c=[];c.push({Offs:e.offs,Dur:2/3*e.dur.Duration,BaseVal:u.AnimConstants.Sling_Rot,OffsVal:u.AnimConstants.Sling_Rot,SegOffs:1/3*e.dur.Duration}),c.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:u.AnimConstants.Sling_Rot,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,l,e.click,e.isEntrance,e.numRepeats,c),e.animObject.registerAnimAttribute(l,!1),this.addEffect_Fade(e,0,1,0)}},{key:"translateEmphasisEffect",value:function(e,t,r,i,n,a){var o={animObject:r,timelineId:t,click:i,offs:n,dur:a,numRepeats:e.numRepeats,rewind:e.rewind,autoReverse:e.autoReverse,effectId:e.effectId};switch(e.effectId){case u.AnimEmphasisEffectId.GrowShrink:this.addEmphEffect_GrowShrink(o,e.rewindChildDelay,e.scaleByXPercent,e.scaleByYPercent,e.direction);break;case u.AnimEmphasisEffectId.Spin:this.addEffect_Spin(o,e.rewindChildDelay,e.rotAngDegrees);break;case u.AnimEmphasisEffectId.Transparency:this.addEmphEffect_Transparency(o,e.transparencyAmountPercent);break;case u.AnimEmphasisEffectId.Shimmer:this.addEmphEffect_Shimmer(o);break;case u.AnimEmphasisEffectId.Blink:this.addEmphEffect_Blink(o);break;case u.AnimEmphasisEffectId.FlashBulb:this.addEmphEffect_FlashBulb(o);break;case u.AnimEmphasisEffectId.Wave:this.addEmphEffect_Wave(o);break;case u.AnimEmphasisEffectId.Turntable3D:if(p.Settings.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_Turntable3D(r,t,i,n,a,e.numRepeats,e.rewind,e.rewindChildDelay,e.autoReverse,e.smoothStartFactor,e.smoothEndFactor,e.rotAngDegrees,e.direction);break}case u.AnimEmphasisEffectId.Swing3D:case u.AnimEmphasisEffectId.JumpAndTurn3D:if(p.Settings.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_AnimatedPropertyList(r,t,i,n,a.Duration,e.numRepeats,e.rewind,e.autoReverse,e.smoothStartFactor,e.smoothEndFactor,e.animatedPropertyList);break}case u.AnimEmphasisEffectId.Embedded1:case u.AnimEmphasisEffectId.Embedded2:case u.AnimEmphasisEffectId.Embedded3:case u.AnimEmphasisEffectId.Embedded4:case u.AnimEmphasisEffectId.Embedded5:case u.AnimEmphasisEffectId.Embedded6:case u.AnimEmphasisEffectId.Embedded7:case u.AnimEmphasisEffectId.Embedded8:case u.AnimEmphasisEffectId.Embedded9:case u.AnimEmphasisEffectId.Embedded10:case u.AnimEmphasisEffectId.Embedded11:case u.AnimEmphasisEffectId.Embedded12:case u.AnimEmphasisEffectId.Embedded13:case u.AnimEmphasisEffectId.Embedded14:case u.AnimEmphasisEffectId.Embedded15:case u.AnimEmphasisEffectId.Embedded16:case u.AnimEmphasisEffectId.Embedded17:case u.AnimEmphasisEffectId.Embedded18:if(p.Settings.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_EmbeddedAnimation(o);break}default:f.ULS.sendTraceTag(508822165,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::translateEmphasisEffect: Unknown or NYI emphasis effect ID:".concat(e.effectId,". ignored.")),m.VetoUtils.recordVeto("AnimationFallback",{EffectId:e.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}}},{key:"addEmphEffect_AnimatedPropertyList",value:function(e,t,r,i,n,a,o,s,l,c,d){var f=s?n:0;if(d){var m,p=g(d);try{for(p.s();!(m=p.n()).done;){var v=m.value,y=this.getAnimAttributeIdFromPropertyName(v.name),_=this.getAdditiveTypeForProperty(y),S=new h.NumberAnimAttribute(y,_===u.AnimAggregateRule.Mult?1:0,_),T=this.m_evalCreator.addEvaluatorLinearList(t,S,r,i,n,v.times,v.values,!1,a,f);this.m_evalCreator.addTimeSmoother(T,l,c,t,r,i,n,a,f),s?(T=this.m_evalCreator.addEvaluatorLinearList(t,S,r,i+n,n,v.times,v.values,!0,a,f),this.m_evalCreator.addTimeSmoother(T,c,l,t,r,i+n,n,a,f)):o||this.m_evalCreator.addEvaluatorConstantAfter(t,S,r,i+n,v.values[v.values.length-1]),e.registerAnimAttribute(S,!1)}}catch(e){p.e(e)}finally{p.f()}}var b=new h.NumberAnimAttribute(u.AnimAttributeId.Is3DRunning,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(t,b,r,i,n+f,1,1,a,0),e.registerAnimAttribute(b,!1)}},{key:"getAnimAttributeIdFromPropertyName",value:function(e){switch(e){case"3d.object.rotation.x":return u.AnimAttributeId.ObjectRotationX;case"3d.object.rotation.y":return u.AnimAttributeId.ObjectRotationY;case"3d.object.rotation.z":return u.AnimAttributeId.ObjectRotationZ;case"3d.object.scale.x":return u.AnimAttributeId.ObjectScaleX;case"3d.object.scale.y":return u.AnimAttributeId.ObjectScaleY;case"3d.object.scale.z":return u.AnimAttributeId.ObjectScaleZ;case"3d.object.translation.x":return u.AnimAttributeId.ObjectTranslateX;case"3d.object.translation.y":return u.AnimAttributeId.ObjectTranslateY;case"3d.object.translation.z":return u.AnimAttributeId.ObjectTranslateZ;case"3d.view.rotation.x":return u.AnimAttributeId.ViewRotationX;case"3d.view.rotation.y":return u.AnimAttributeId.ViewRotationY;case"3d.view.rotation.z":return u.AnimAttributeId.ViewRotationZ;case"3d.view.scale.x":return u.AnimAttributeId.ViewScaleX;case"3d.view.scale.y":return u.AnimAttributeId.ViewScaleY;case"3d.view.scale.z":return u.AnimAttributeId.ViewScaleZ;case"3d.view.translation.x":return u.AnimAttributeId.ViewTranslateX;case"3d.view.translation.y":return u.AnimAttributeId.ViewTranslateY;case"3d.view.translation.z":return u.AnimAttributeId.ViewTranslateZ;default:return f.ULS.sendTraceTag(508822164,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"AnimTranslate::getAnimAttributeIdFromPropertyName: Ignoring unknown property name '".concat(e,"' passed to GetAnimAttributeIdFromPropertyName..")),u.AnimAttributeId.None}}},{key:"getAdditiveTypeForProperty",value:function(e){switch(e){case u.AnimAttributeId.ObjectScaleX:case u.AnimAttributeId.ObjectScaleY:case u.AnimAttributeId.ObjectScaleZ:case u.AnimAttributeId.ViewScaleX:case u.AnimAttributeId.ViewScaleY:case u.AnimAttributeId.ViewScaleZ:return u.AnimAggregateRule.Mult;default:return u.AnimAggregateRule.Add}}},{key:"addEmphEffect_Turntable3D",value:function(e,t,r,i,n,a,o,s,l,c,d,f,m){var p=l?n.Duration:0,g=new h.NumberAnimAttribute(this.getAnimAttributeIdFromDirection(m),0,u.AnimAggregateRule.Add),v=f,y=this.m_evalCreator.addEvaluatorLinear(t,g,r,i,n.Duration,0,v,a,p);this.m_evalCreator.addTimeSmoother(y,c,d,t,r,i,n.Duration,a,p),l?(y=this.m_evalCreator.addEvaluatorLinear(t,g,r,i+n.Duration,n.Duration,v,0,a,p),this.m_evalCreator.addTimeSmoother(y,d,c,t,r,i+n.Duration,n.Duration,a,p)):o?s>0&&this.m_evalCreator.addEvaluatorConstantDuration(t,g,r,i+n.Duration,s,v,a,0):this.m_evalCreator.addEvaluatorConstantAfter(t,g,r,i+n.Duration,v),e.registerAnimAttribute(g,!1);var _=new h.NumberAnimAttribute(u.AnimAttributeId.Is3DRunning,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(t,_,r,i,n.Duration+p,1,1,a,0),e.registerAnimAttribute(_,!1)}},{key:"getAnimAttributeIdFromDirection",value:function(e){switch(e){case u.AnimDirConstants.ObjRotLeft:case u.AnimDirConstants.ObjRotRight:return u.AnimAttributeId.ObjectRotationY;case u.AnimDirConstants.ObjRotBack:case u.AnimDirConstants.ObjRotFront:return u.AnimAttributeId.ObjectRotationX;case u.AnimDirConstants.ObjRotCounterclockwise:case u.AnimDirConstants.ObjRotClockwise:return u.AnimAttributeId.ObjectRotationZ;case u.AnimDirConstants.ViewRotRight:case u.AnimDirConstants.ViewRotLeft:return u.AnimAttributeId.ViewRotationY;case u.AnimDirConstants.ViewRotUp:case u.AnimDirConstants.ViewRotDown:return u.AnimAttributeId.ViewRotationX;case u.AnimDirConstants.ViewRotClockwise:case u.AnimDirConstants.ViewRotCounterclockwise:return u.AnimAttributeId.ViewRotationZ;default:return u.AnimAttributeId.None}}},{key:"addEmphEffect_EmbeddedAnimation",value:function(e){var t=e.autoReverse?e.dur.Duration:0,r=e.dur.Duration,i=e.effectId-u.AnimEmphasisEffectId.Embedded1,n=new h.NumberAnimAttribute(u.AnimAttributeId.EmbeddedAnimId,i,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,n,e.click,e.offs,r,i,e.numRepeats,t),e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,n,e.click,e.offs+r,i),e.animObject.registerAnimAttribute(n,!1);var a=new h.NumberAnimAttribute(u.AnimAttributeId.EmbeddedAnimProgress,0,u.AnimAggregateRule.First);this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs,r,0,1,e.numRepeats,t),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs+r,r,1,0,e.numRepeats,t):e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,a,e.click,e.offs+r,1),e.animObject.registerAnimAttribute(a,!1);var o=new h.NumberAnimAttribute(u.AnimAttributeId.Is3DRunning,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,r+t,1,1,e.numRepeats,0),e.animObject.registerAnimAttribute(o,!1)}},{key:"addEmphEffect_GrowShrink",value:function(e,t,r,i,n){var a,o=r/100,s=i/100,l=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),c=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);if(a=e.dur.FUntilSlide||e.dur.FUntilClick?u.AnimConstants.GrowShrink_DefaultDuration:e.dur.Duration,1===n&&(a=1),e.dur.FUntilSlide)this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,a,1,o,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,c,e.click,e.offs,a,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+a,o),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,c,e.click,e.offs+a,s);else if(e.dur.FUntilClick)this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,a,1,o,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,c,e.click,e.offs,a,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,l,e.click,e.offs+a,e.click+1,0,o,0,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,c,e.click,e.offs+a,e.click+1,0,s,0,0);else{var d=e.autoReverse?a:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,a,1,o,e.numRepeats,d),this.m_evalCreator.addEvaluatorLinear(e.timelineId,c,e.click,e.offs,a,1,s,e.numRepeats,d),e.autoReverse?(this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs+a,a,o,1,e.numRepeats,d),this.m_evalCreator.addEvaluatorLinear(e.timelineId,c,e.click,e.offs+a,a,s,1,e.numRepeats,d)):e.rewind?t>0&&(this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,l,e.click,e.offs+a,t,o,e.numRepeats,d),this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,c,e.click,e.offs+a,t,s,e.numRepeats,d)):(this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+a,o),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,c,e.click,e.offs+a,s))}e.animObject.registerAnimAttribute(l,!1),e.animObject.registerAnimAttribute(c,!1)}},{key:"addEffect_Spin",value:function(e,t,r){var i=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add),n=r*Math.PI/180,a=e.autoReverse?e.dur.Duration:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,e.dur.Duration,0,n,e.numRepeats,a),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+e.dur.Duration,e.dur.Duration,n,0,e.numRepeats,a):e.rewind?t>0&&this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,i,e.click,e.offs+e.dur.Duration,t,n,e.numRepeats,0):this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,i,e.click,e.offs+e.dur.Duration,n),e.animObject.registerAnimAttribute(i,!1)}},{key:"addEmphEffect_Transparency",value:function(t,r){var i=new h.ObjectAnimAttribute(u.AnimAttributeId.FadeMaskInfo,null,u.AnimAggregateRule.First),n=e.getFadeMaskInfo(u.AnimEntranceExitEffectId.Fade,0,!0),a=new h.NumberAnimAttribute(u.AnimAttributeId.FadeMaskProgress,1,u.AnimAggregateRule.First),o=(100-r)/100;t.dur.FUntilSlide?(this.m_evalCreator.addEvaluatorConstantObjectAfter(t.timelineId,i,t.click,t.offs,n),this.m_evalCreator.addEvaluatorConstantAfter(t.timelineId,a,t.click,t.offs,o)):t.dur.FUntilClick?(this.m_evalCreator.addEvaluatorConstantObjectSpan(t.timelineId,i,t.click,t.offs,t.click+1,0,n,t.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(t.timelineId,a,t.click,t.offs,t.click+1,0,o,t.numRepeats,0)):(this.m_evalCreator.addEvaluatorConstantObjectSpan(t.timelineId,i,t.click,t.offs,t.click,t.offs+t.dur.Duration,n,t.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(t.timelineId,a,t.click,t.offs,t.click,t.offs+t.dur.Duration,o,t.numRepeats,0)),t.animObject.registerAnimAttribute(i,!1),t.animObject.registerAnimAttribute(a,!1)}},{key:"addEmphEffect_Shimmer",value:function(e){var t=e.dur.Duration/2,r=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,t,0,u.AnimConstants.Shimmer_Theta,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+t,t,u.AnimConstants.Shimmer_Theta,0,e.numRepeats,t),e.animObject.registerAnimAttribute(r,!1)}},{key:"addEmphEffect_Blink",value:function(e){var t={animObject:e.animObject,timelineId:e.timelineId,click:e.click,offs:e.offs,dur:y.fromDuration(e.dur.Duration/2),isEntrance:!0,numRepeats:e.numRepeats,direction:u.AnimDirConstants.Top,effectId:e.effectId};this.addEffect_Fade(t,e.dur.Duration/2,u.AnimConstants.Blink_Alpha,u.AnimConstants.Blink_Alpha)}},{key:"addEmphEffect_FlashBulb",value:function(e){var t=e.dur.Duration/2,r=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleW,1,u.AnimAggregateRule.Mult),i=new h.NumberAnimAttribute(u.AnimAttributeId.ScaleH,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,t,1,u.AnimConstants.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,1,u.AnimConstants.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+t,t,u.AnimConstants.FlashBulb_ScaleOffs,1,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,u.AnimConstants.FlashBulb_ScaleOffs,1,e.numRepeats,t),e.animObject.registerAnimAttribute(r,!1),e.animObject.registerAnimAttribute(i,!1);var n=new h.NumberAnimAttribute(u.AnimAttributeId.Alpha,1,u.AnimAggregateRule.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,e.dur.Duration,u.AnimConstants.FlashBulb_Alpha,u.AnimConstants.FlashBulb_Alpha,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}},{key:"addEmphEffect_Wave",value:function(e){var t=e.dur.Duration/3,r=new h.NumberAnimAttribute(u.AnimAttributeId.Rotate,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,t,0,u.AnimConstants.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+t,t,u.AnimConstants.Wave_Theta,-u.AnimConstants.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+2*t,t,-u.AnimConstants.Wave_Theta,0,e.numRepeats,e.dur.Duration-t),e.animObject.registerAnimAttribute(r,!1);var i=e.dur.Duration/2;e.animObject.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,e.animObject.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var n=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,0,u.AnimAggregateRule.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,i,0,u.AnimConstants.Wave_YOffs,e.numRepeats,e.dur.Duration-i),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs+i,i,u.AnimConstants.Wave_YOffs,0,e.numRepeats,e.dur.Duration-i),e.animObject.registerAnimAttribute(n,!1)}},{key:"addInitialVisibilityMarker",value:function(e,t){var r=this.m_visTrackTable[e];null!=r?0===r.Length&&r.becomesVisibleAt(t,0,0):f.ULS.sendTraceTag(508822163,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"AnimTranslate::addInitialVisibilityMarker: Bad visTrack for aoId ".concat(e," at AddInitialVisibilityMarker."))}},{key:"translateMotionPathEffect",value:function(t,r,i,n,a,o){if(t.motionPath){i.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosX,i.Shape.position.x,u.AnimAggregateRule.BaselineOnly),!1),i.registerAnimAttribute(new h.NumberAnimAttribute(u.AnimAttributeId.PosY,i.Shape.position.y,u.AnimAggregateRule.BaselineOnly),!1);var s=t.motionPath.commandList;t.motionPath.fReversed&&(s=e.generateReversedMotionPath(s));for(var l=new Array(s.length),c=0,d=0;d<s.length;d+=1){var m=e.calcMPSegmentLength(s,d);l[d]=m,c+=m}if(0!==c){var p=this.m_mpRestEvalHelperTable[i.Id];if(null!==p)if(p.push(e.createRestEvalHelperStartEntry(r,n,a)),this.translateMPList(t,i,r,s,l,c,!1,0,n,a,o,t.autoReverse,t.numRepeats,a),t.autoReverse){var g=e.generateReversedMotionPath(s);this.translateMPList(t,i,r,g,l,c,!0,o,n,a,o,t.autoReverse,t.numRepeats,a+o);var v=e.getRepeatsOffs(a,2*o,t.numRepeats),y=e.createRestEvalHelperEndEntry(g,r,e.getRepeatsClick(n,t.numRepeats),v);p.push(y)}else{var _=e.getRepeatsOffs(a,o,t.numRepeats);if(t.rewind){if(t.rewindChildDelay>0){var S=e.createRestEvalHelperEndEntry(s,r,e.getRepeatsClick(n,t.numRepeats),_);p.push(S);var T=e.createRestEvalHelperStartEntry(r,e.getRepeatsClick(n,t.numRepeats),_+t.rewindChildDelay);p.push(T)}}else{var b=e.createRestEvalHelperEndEntry(s,r,e.getRepeatsClick(n,t.numRepeats),_);p.push(b)}}else f.ULS.sendTraceTag(508822161,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Error,"No rest eval list exists for this anim object.")}else f.ULS.sendTraceTag(508822162,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"Motion path had zero length, ignored.")}}},{key:"generateRestEvaluators",value:function(e){var t=this.m_mpRestEvalHelperTable[e.Id];if(null!=t&&0!==t.length){for(var r=e.Shape.position.x,i=e.Shape.position.y,n=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,r,u.AnimAggregateRule.Add),a=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,i,u.AnimAggregateRule.Add),o=0;o<t.length;o+=1){var s=t[o];if(!s.FStartPath)if(o===t.length-1)this.m_evalCreator.addEvaluatorConstantAfter(s.TimeLineId,n,s.Click,s.Offs-1,s.XTarget),this.m_evalCreator.addEvaluatorConstantAfter(s.TimeLineId,a,s.Click,s.Offs-1,s.YTarget);else{var l=t[o+1];this.m_evalCreator.addEvaluatorConstantSpan(s.TimeLineId,n,s.Click,s.Offs-1,l.Click,l.Offs,s.XTarget,0,0),this.m_evalCreator.addEvaluatorConstantSpan(s.TimeLineId,a,s.Click,s.Offs-1,l.Click,l.Offs,s.YTarget,0,0)}}e.registerAnimAttribute(n,!1),e.registerAnimAttribute(a,!1)}}},{key:"translateMPList",value:function(e,t,r,i,n,a,o,s,l,c,u,d,h,f){for(var m=e.autoReverse?u:0,p=s,g=1;g<i.length;g+=1){var v=u*n[o?i.length-g:g]/a,y=u-v+(d?u:0);v>0&&this.addMPSegment(e,t,r,i,g,l,c+p,v,h,y,f,m,u),p+=v}}},{key:"addMPSegment",value:function(e,t,r,i,n,a,o,s,l,c,d,m,p){if(0!==n){var g,v,y=t.Shape.position.x,_=t.Shape.position.y,S=i[n-1],T=i[n];switch(T.type){case u.MotionPathCommandType.MoveTo:break;case u.MotionPathCommandType.LineTo:g=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,y,u.AnimAggregateRule.Add);var b=this.m_evalCreator.addEvaluatorLinear(r,g,a,o,s,S.end.x,T.end.x,l,c);this.m_evalCreator.addTimeSmoother(b,e.smoothStartFactor,e.smoothEndFactor,r,a,d,p,l,m),t.registerAnimAttribute(g,!1),v=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,_,u.AnimAggregateRule.Add);var C=this.m_evalCreator.addEvaluatorLinear(r,v,a,o,s,S.end.y,T.end.y,l,c);this.m_evalCreator.addTimeSmoother(C,e.smoothStartFactor,e.smoothEndFactor,r,a,d,p,l,m),t.registerAnimAttribute(v,!1);break;case u.MotionPathCommandType.CurveTo:var w=T,P=[S.end.x,w.control1.x,w.control2.x,w.end.x];g=new h.NumberAnimAttribute(u.AnimAttributeId.PosX,y,u.AnimAggregateRule.Add);var I=this.m_evalCreator.addEvaluatorBezier(r,g,a,o,s,P,l,c);this.m_evalCreator.addTimeSmoother(I,e.smoothStartFactor,e.smoothEndFactor,r,a,d,p,l,m),t.registerAnimAttribute(g,!1);var k=[S.end.y,w.control1.y,w.control2.y,w.end.y];v=new h.NumberAnimAttribute(u.AnimAttributeId.PosY,_,u.AnimAggregateRule.Add);var E=this.m_evalCreator.addEvaluatorBezier(r,v,a,o,s,k,l,c);this.m_evalCreator.addTimeSmoother(E,e.smoothStartFactor,e.smoothEndFactor,r,a,d,p,l,m),t.registerAnimAttribute(v,!1);break;default:f.ULS.sendTraceTag(508822158,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"Unknown motion path command type, ignoring.")}}}},{key:"addMediaEffect_Play",value:function(e){var t=new h.ObjectAnimAttribute(u.AnimAttributeId.MediaPlaybackCmd,null,u.AnimAggregateRule.Last),r=e.dur.Duration>0?100:e.dur.Duration;this.m_evalCreator.addEvaluatorConstantObject(e.timelineId,t,e.click,e.offs,r,e,0,0),e.animObject.registerAnimAttribute(t,!1)}},{key:"translateMediaEffect",value:function(e,t,r,i,n,a){var o={animObject:r,timelineId:t,click:i,offs:n,dur:a,effectId:e.effectId,mediaCmd:e.mediaCmd};this.addMediaEffect_Play(o)}}],[{key:"flipDirection",value:function(e){switch(e){case u.AnimDirConstants.Bottom:return u.AnimDirConstants.Top;case u.AnimDirConstants.Left:return u.AnimDirConstants.Right;case u.AnimDirConstants.Right:return u.AnimDirConstants.Left;case u.AnimDirConstants.Top:default:return u.AnimDirConstants.Bottom}}},{key:"translatePPTZoomFlags",value:function(e,t){return t?0!=(e&u.AnimDirConstants.Ppt_ZoomIn)?0!=(e&u.AnimDirConstants.Ppt_ZoomCenter)?u.AnimDirConstants.Zoom_InFromCenter:0!=(e&u.AnimDirConstants.Ppt_ZoomSlightly)?u.AnimDirConstants.Zoom_InSlightly:u.AnimDirConstants.Zoom_In:0!=(e&u.AnimDirConstants.Bottom)?u.AnimDirConstants.Zoom_OutFromBottom:0!=(e&u.AnimDirConstants.Ppt_ZoomSlightly)?u.AnimDirConstants.Zoom_OutSlightly:u.AnimDirConstants.Zoom_Out:0!=(e&u.AnimDirConstants.Ppt_ZoomOut)?0!=(e&u.AnimDirConstants.Ppt_ZoomCenter)?u.AnimDirConstants.Zoom_InFromCenter:0!=(e&u.AnimDirConstants.Ppt_ZoomSlightly)?u.AnimDirConstants.Zoom_InSlightly:u.AnimDirConstants.Zoom_In:0!=(e&u.AnimDirConstants.Bottom)?u.AnimDirConstants.Zoom_OutFromBottom:0!=(e&u.AnimDirConstants.Ppt_ZoomSlightly)?u.AnimDirConstants.Zoom_OutSlightly:u.AnimDirConstants.Zoom_Out}},{key:"getFadeMaskInfo",value:function(e,t,r){var i,n=g(u.Fade.EffectMap);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.FxId===e&&a.Dir===t)return{preset:a.Preset,param:a.Param,flags:r?a.EntFlags:a.ExitFlags}}}catch(e){n.e(e)}finally{n.f()}return{preset:u.FadePreset.dissolve}}},{key:"getRepeatsClick",value:function(e,t){return t===u.AnimConstants.RepeatUntilEnd?u.AnimConstants.Undefined:t===u.AnimConstants.RepeatUntilClick?e+1:e}},{key:"getRepeatsOffs",value:function(e,t,r){return r===u.AnimConstants.RepeatUntilEnd?u.AnimConstants.RepeatForever:r===u.AnimConstants.RepeatUntilClick?0:e+(r+1)*t}},{key:"generateReversedMotionPath",value:function(e){var t=[];if(null==e||0===e.length)return t;var r=e[e.length-1].end,i={type:u.MotionPathCommandType.MoveTo,end:r};t.push(i);for(var n=e.length-1;n>0;n-=1){switch(r=e[n-1].end,e[n].type){case u.MotionPathCommandType.MoveTo:i={type:u.MotionPathCommandType.MoveTo,end:r};break;case u.MotionPathCommandType.LineTo:i={type:u.MotionPathCommandType.LineTo,end:r};break;case u.MotionPathCommandType.CurveTo:var a=e[n];i={type:u.MotionPathCommandType.CurveTo,control1:a.control2,control2:a.control1,end:r};break;default:f.ULS.sendTraceTag(508822160,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"Unknown motion path command while reversing.")}t.push(i)}return t}},{key:"calcMPSegmentLength",value:function(t,r){if(0===r)return 0;var i=t[r-1],n=t[r];switch(n.type){case u.MotionPathCommandType.MoveTo:return 0;case u.MotionPathCommandType.LineTo:return e.calcLineSegmentLength(i.end.x,i.end.y,n.end.x,n.end.y);case u.MotionPathCommandType.CurveTo:var a=n;return e.calcBezierSegmentLength(i.end.x,i.end.y,a.control1.x,a.control1.y,a.control2.x,a.control2.y,a.end.x,a.end.y);default:return f.ULS.sendTraceTag(508822159,f.LogCategory.msoulscat_Wac_PptAnimation,f.TraceLevel.Info,"Unknown motion path command type, ignoring."),0}}},{key:"calcLineSegmentLength",value:function(e,t,r,i){var n=r-e,a=i-t;return Math.sqrt(n*n+a*a)}},{key:"calcBezierSegmentLength",value:function(t,r,i,n,a,o,s,l){for(var d,h,f=0,m=t,p=r,g=1/u.AnimConstants.BezierLengthEstimateDivisions,v=0;v<=1;v+=g)d=c.BezierHelper.calculateBezierCoordinate(t,i,a,s,v),h=c.BezierHelper.calculateBezierCoordinate(r,n,o,l,v),f+=e.calcLineSegmentLength(m,p,d,h),m=d,p=h;return f}},{key:"createRestEvalHelperStartEntry",value:function(e,t,r){return new c.RestEvalHelperEntry(!0,e,t,r,0,0)}},{key:"createRestEvalHelperEndEntry",value:function(e,t,r,i){var n=e[e.length-1];return new c.RestEvalHelperEntry(!1,t,r,i,n.end.x,n.end.y)}}])}();t.AnimTranslate=_},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.VetoUtils=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(3),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"setVetoUtil",value:function(t,r){e.m_sessionMetadata=t,s.ULS.setLogger(r)}},{key:"recordVeto",value:function(t,r){if(null!=r){var i=e.m_vetos.has(t);if(!i){var n={AppMetadata:e.m_sessionMetadata,VetoSource:t,VetoDetail:r};s.ULS.sendTraceTag(508842071,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,JSON.stringify(n)),e.m_vetos.set(t,r)}this.m_listeners.forEach((function(e){e(t,r,i)}))}}},{key:"getSessionVetos",value:function(){return e.m_vetos}},{key:"clearState",value:function(){e.m_vetos=new Map,e.m_sessionMetadata={}}},{key:"registerVetoRecordedListener",value:function(e){this.m_listeners.push(e)}},{key:"unregisterVetoRecordedListener",value:function(e){this.m_listeners=this.m_listeners.filter((function(t){return t!==e}))}}])}();t.VetoUtils=l,(0,o.default)(l,"m_vetos",new Map),(0,o.default)(l,"m_sessionMetadata",{}),(0,o.default)(l,"m_listeners",[])},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.UserActionUtils=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(3),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"recordUserAction",value:function(e){null!=e&&null!=e.actionName&&(s.ULS.sendTraceTag(508842064,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"User Action name:".concat(e.actionName,", durationMs:").concat(e.durationMs,", succeeded:").concat(e.succeeded)),this.m_actions.push(e),this.m_listeners.forEach((function(t){t(e)})))}},{key:"getUserActions",value:function(){return e.m_actions}},{key:"registerUserActionListener",value:function(e){this.m_listeners.push(e)}},{key:"unregisterUserActionListener",value:function(e){this.m_listeners=this.m_listeners.filter((function(t){return t!==e}))}},{key:"clearState",value:function(){e.m_actions=[],e.m_listeners=[]}}])}();t.UserActionUtils=l,(0,o.default)(l,"m_actions",[]),(0,o.default)(l,"m_listeners",[])},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CameoTextureManager=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=r(4),l=r(14),c=r(20),u=r(25),d=r(26),h=r(11),f=(0,a.default)((function e(t){(0,n.default)(this,e),this.events=new d.EventEmitter,this.m_subscriberCount=0,this.m_fGLContextLostErrorLogged=!0,this.m_fSVGFallbackMode=!1,this.m_fSVGFallbackModeErrorLogged=!1,this.m_supportedFormats=["RGBA","BGRA","NV12"],this.m_lastGoodTextureUpdateTime=void 0,this.m_environment=t}),[{key:"cameoSharedTexture",get:function(){if(!this.m_cameoSharedTexture)try{if(this.m_environment.rendererEnvironment.glContext&&this.m_environment.rendererEnvironment.isGLContextValid){var e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);this.m_cameoSharedTexture=c.Texture.CreateFromByteBuffer("Cameo",this.m_environment.rendererEnvironment.renderer,new u.Vector2(2,2),new Uint8Array(e),c.TextureFormat.BGRA,c.WrapMode.clamp,!0,!0),this.m_environment.viewDataManager.memoryStats.cameoTextures+=16,o.ULS.sendTraceTag(525124629,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::get_cameoSharedTexture Blank Texture initialized")}else l.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),o.ULS.sendTraceTag(526770847,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Warning,"CameoTextureManager::get_cameoSharedTexture glContext unavailable. Morph (if any) may not work as expected.")}catch(e){l.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),o.ULS.sendTraceTag(526942348,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Warning,"CameoTextureManager::get_cameoSharedTexture: Morph may not work as expected due to exception creating blank texture=".concat(e,"."))}return this.m_cameoSharedTexture}},{key:"subscribeToSharedTexture",value:function(){this.m_subscriberCount+=1,o.ULS.sendTraceTag(526951687,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::subscribeToSharedTexture: subscribersCount=".concat(this.m_subscriberCount,"."))}},{key:"unsubscribeFromSharedTexture",value:function(){this.m_subscriberCount>0&&(this.m_subscriberCount-=1,o.ULS.sendTraceTag(526951688,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::unsubscribeFromSharedTexture: subscribersCount=".concat(this.m_subscriberCount,".")),0===this.m_subscriberCount&&this.releaseTexture())}},{key:"processFrameForCameo",value:function(e,t){if(s.Settings.readBooleanOrDefault("forceSvg",!1))this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,o.ULS.sendTraceTag(526987925,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::processFrameForCameo: Modern SS has fallen back to SVG mode"),l.VetoUtils.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0}));else{if(this.m_fSVGFallbackMode&&!this.m_fSVGFallbackModeErrorLogged&&(o.ULS.sendTraceTag(525123978,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Warning,"CameoTextureManager::processFrameForCameo: Modern SS seems to have unexpectedly recovered from SVG mode."),this.m_fSVGFallbackModeErrorLogged=!0),!t||!e)return o.ULS.sendTraceTag(526987920,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::processFrameForCameo: invalid input buffer or buffer metadata not provided."),this.logVetoIfCameoNotRendering(Date.now(),"EmptyBufferOrMetadata"),void this.releaseTexture();if(this.m_subscriberCount>0){var r=this.parseArrayBufferMetadata(e);r&&this.updateTextureFromArrayBuffer(t,r)}}}},{key:"releaseTexture",value:function(){if(this.m_cameoSharedTexture){var e=this.m_cameoSharedTexture.size;this.m_cameoSharedTexture.release(),this.m_environment.viewDataManager.memoryStats.cameoTextures-=e.x*e.y*4,this.m_cameoSharedTexture=void 0,this.events.emit("cameoSharedTextureReleased"),o.ULS.sendTraceTag(526951689,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::releaseTexture: subscribersCount=".concat(this.m_subscriberCount,"."))}}},{key:"setVideoElement",value:function(e){this.m_videoElement=e}},{key:"updateTextureFromVideoElement",value:function(){try{if(!this.m_videoElement||this.m_subscriberCount<=0)return;if(s.Settings.readBooleanOrDefault("forceSvg",!1))return void(this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,o.ULS.sendTraceTag(508339653,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::updateTextureFromVideoElement: In SVG mode thus unable to render"),l.VetoUtils.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0})));var e=this.m_environment.rendererEnvironment.glContext;if(!e||e.isContextLost())return this.m_fGLContextLostErrorLogged||(o.ULS.sendTraceTag(509745359,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::updateTextureFromVideoElement: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();if(!this.isVideoReadyForTextureExtraction(this.m_videoElement))return this.logVetoIfCameoNotRendering(Date.now(),"VideoElementError"),void this.releaseTexture();h.ChangeGate.isChangeGateEnabled("SVM.enableResizeSupportForMediaStreamCameo")&&this.updateVideoElementDimensions();var t=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new u.Vector2(this.m_videoElement.width,this.m_videoElement.height),this.m_cameoSharedTexture=c.Texture.CreateOrUpdateFromHTMLElement("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_videoElement),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);var r=this.m_frameSize.x*this.m_frameSize.y*4;r!==t&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=r-t)}catch(e){o.ULS.sendTraceTag(509745358,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::updateTextureFromVideoElement: exception ".concat(e,".")),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}},{key:"isVideoReadyForTextureExtraction",value:function(e){return!(!e||e.paused||e.ended||e.error||!e.srcObject||!e.srcObject.active||!this.isVideoLoaded(e))}},{key:"isVideoLoaded",value:function(e){return!!e&&e.readyState>=3}},{key:"updateVideoElementDimensions",value:function(){if(this.m_videoElement&&(this.m_videoTrack||(this.m_videoTrack=this.getVideoTrackFromElement(this.m_videoElement)),this.m_videoTrack)){var e=this.m_videoTrack.getSettings();e.width&&e.height&&(e.width!==this.m_videoElement.width||e.height!==this.m_videoElement.height)&&(this.m_videoElement.width=e.width,this.m_videoElement.height=e.height,o.ULS.sendTraceTag(508408082,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::updateVideoElementDimensions: detected resolution change to width=".concat(e.width,", height=").concat(e.height)))}}},{key:"getVideoTrackFromElement",value:function(e){if(e&&e.srcObject){var t=e.srcObject;if(t){var r=t.getVideoTracks();return r&&r.length>0?r[0]:void 0}}}},{key:"parseArrayBufferMetadata",value:function(e){try{var t=JSON.parse(e),r=t.width,i=t.height;return r&&i?"number"==typeof r&&r>0&&"number"==typeof i&&i>0?{width:r,height:i,format:this.getTextureFormatFromString(t.format)}:(o.ULS.sendTraceTag(526987923,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::parseArrayBufferMetadata: invalid frame size, x:".concat(r,", y:").concat(i)),this.logVetoIfCameoNotRendering(Date.now(),"InvalidFrameSize"),void this.releaseTexture()):(0===r&&0===i?this.m_cameoSharedTexture&&o.ULS.sendTraceTag(526987921,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"CameoTextureManager::parseArrayBufferMetadata: Received 0x0 frame from MSTeams. Cleared texture."):(o.ULS.sendTraceTag(526987922,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::parseArrayBufferMetadata: unable to parse valid frame metadata."),this.logVetoIfCameoNotRendering(Date.now(),"FrameDimensionsMissing")),void this.releaseTexture())}catch(e){return o.ULS.sendTraceTag(526987924,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::parseArrayBufferMetadata: exception ".concat(e,".")),this.logVetoIfCameoNotRendering(Date.now(),"FrameMetadataParseFailure"),void this.releaseTexture()}}},{key:"updateTextureFromArrayBuffer",value:function(e,t){try{var r=this.m_environment.rendererEnvironment.glContext;if(!r||r.isContextLost())return this.m_fGLContextLostErrorLogged||(o.ULS.sendTraceTag(526987926,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::updateTextureFromArrayBuffer: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();var i=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new u.Vector2(t.width,t.height),this.m_cameoSharedTexture=c.Texture.CreateOrUpdateFromByteBuffer("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_frameSize,new Uint8Array(e),t.format,c.WrapMode.clamp,!0,!0,void 0,!0),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);var n=this.m_frameSize.x*this.m_frameSize.y*4;n!==i&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=n-i)}catch(e){o.ULS.sendTraceTag(526987927,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::updateTextureFromArrayBuffer: exception ".concat(e,".")),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}},{key:"getTextureFormatFromString",value:function(e){if(e){var t=e.toUpperCase();if(this.m_supportedFormats.includes(t)){if("BGRA"===t)return c.TextureFormat.BGRA;if("NV12"===t)return c.TextureFormat.NV12}}return c.TextureFormat.RGBA}},{key:"logVetoIfCameoNotRendering",value:function(e,t){if(this.m_lastGoodTextureUpdateTime){var r=e-this.m_lastGoodTextureUpdateTime;r>=s.Settings.readNumberOrDefault("cameoNotRenderingThresholdMs",5e3)&&(o.ULS.sendTraceTag(525124630,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"CameoTextureManager::logVetoIfCameoNotRendering: No successful texture update in ".concat(r/1e3," seconds, latest error: ").concat(t)),l.VetoUtils.recordVeto("CameoNotRendering",{qosVeto:"CameoNotRendering",errorName:t,textureUpdateDelay:r}),this.m_lastGoodTextureUpdateTime=void 0)}}}],[{key:"getInstance",value:function(e){return this.m_instance||(this.m_instance=new this(e)),this.m_instance}}]);t.CameoTextureManager=f},function(e,t,r){"use strict";var i=r(0),n=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.cloneTracksShallow=function(e){var t,r=[],i=f(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.push({language:n.language,label:n.label,id:n.id,cues:[]})}}catch(e){i.e(e)}finally{i.f()}return r},t.CaptionsRenderer=t.CaptionsTrack=void 0;var a=i(r(2)),o=i(r(1)),s=r(157),l=r(17),c=r(75),u=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(r(43)),d=r(44),h=r(158);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=(0,a.default)((function e(){(0,o.default)(this,e),this.cues=[],this.label="",this.language="",this.id=""}));t.CaptionsTrack=p;var g=(0,a.default)((function e(t,r){var i,n=this;(0,o.default)(this,e),this.visibleOpacity=".8",this.reducedOpacity=".1",this.updateDelay=.1,this.minCueMargin=.5,this.textTimeout=5,this.boxHeight=94,this.maxCharacterWidth=400,this.fontSize=24,this.lastUpdate=0,this.activeTextTrackIndex=0,this.activeCueIndex=0,this.currentOpacity=this.visibleOpacity,this.defaultLang="",this.activeCues=[],this.onResize=function(){var e;setTimeout((function(){n.setHorizontalPosition(void 0),n.setVerticalPosition(!0)}),0),1===(null===(e=n.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&n.resetHorizontalPosition()},this.onPlay=function(){},this.onPause=function(){n.renderCuePreview&&n.clearCuePreview()},this.onSeeked=function(){n.setInitialCue()},this.onTimeUpdate=function(){var e;if(0===n.activeCues.length&&n.cloneCues(),void 0!==n.activeControls&&n.updateContainer(n.activeControls.getZIndex()-1),void 0===n.activeVideoEl||n.activeVideoEl.paused||n.visible()||n.show(),n.renderCuePreview&&(n.isCuePreviewActive()?(n.container.style.opacity=n.currentOpacity,(0,h.filterBIU)(null!==(e=n.cuePreview)&&void 0!==e?e:"",n.container)):n.clearCuePreview()),-2!==n.activeCueIndex&&n.visible()&&0!==n.activeCues.length&&void 0!==n.activeVideoEl&&!n.activeVideoEl.paused&&!(n.activeVideoEl.currentTime-n.lastUpdate<n.updateDelay)){n.lastUpdate=n.activeVideoEl.currentTime;var t=n.activeCueIndex+1>=n.activeCues.length;n.activeCueIndex>=0&&(n.activeCues[n.activeCueIndex].endTime<=n.activeVideoEl.currentTime||n.textCueTimeoutEnabled&&n.activeVideoEl.currentTime-n.activeCues[n.activeCueIndex].startTime>=n.textTimeout)&&(n.clearText(),t&&(n.activeCueIndex=-2)),t||n.activeCues[n.activeCueIndex+1].startTime<=n.activeVideoEl.currentTime&&(n.activeCueIndex+=1,n.setTextById(n.activeCueIndex))}},this.renderCuePreview=d.Settings.getBoolean("renderCuePreview"),this.updateCaptionsMenuEnabled=d.Settings.getBoolean("updateCaptionsMenuEnabled"),this.improvedCaptionsPositioning=d.Settings.getBoolean("improvedCaptionsPositioning"),this.textCueTimeoutEnabled=d.Settings.getBoolean("textCueTimeoutEnabled"),this.container=(0,s.createElementWithClass)("div","captions-render-container"),this.container.id=u.VIDEO_CAPTIONS_RENDER_WINDOW_ID,this.hide(),(0,c.setStyles)(this.container,{alignSelf:"center",background:"solid",backgroundColor:"#292827",borderRadius:"2px",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:"".concat(this.fontSize,"px"),color:"#F3F2F1",padding:"6px",pointerEvents:"none",position:"absolute",opacity:"0",overflow:"hidden",overflowWrap:"break-word",textAlign:"center",webkitLineClamp:"3",fontSizeAdjust:"100%"}),this.screenCoords=r,this.screenCoordsProvided=null!=r,this.parentName=t,""===this.parentName&&l.Log.warn(509726802,"CaptionsRenderer constructor: parentName is empty"),this.improvedCaptionsPositioning&&(this.resizeObserver=new ResizeObserver((function(e,t){n.onResize()})),this.screenCoordsProvided&&(null===(i=this.resizeObserver)||void 0===i||i.observe(this.screenCoords)))}),[{key:"getDefaultLang",get:function(){return this.defaultLang}},{key:"setDefaultLang",set:function(e){this.defaultLang=e}},{key:"show",value:function(){this.container.style.display="block"}},{key:"hide",value:function(){this.container.style.display="none"}},{key:"visible",value:function(){return"block"===this.container.style.display}},{key:"onNavigatingFrom",value:function(){this.stopCaptionTrack()}},{key:"setScreenCoords",value:function(e){var t,r;this.improvedCaptionsPositioning&&(null===(t=this.resizeObserver)||void 0===t||t.disconnect()),this.screenCoords=e,this.screenCoordsProvided=null!=e,this.improvedCaptionsPositioning&&this.screenCoordsProvided&&(null===(r=this.resizeObserver)||void 0===r||r.observe(this.screenCoords),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0))}},{key:"selectCaptionsTrack",value:function(e){this.activeTextTrackIndex=e,this.activeCues=[],this.cloneCues()}},{key:"renderCaptionTrack",value:function(e,t,r){(0,c.setStyles)(this.container,{fontSize:"".concat(this.fontSize*t.getCaptionsScalingFactor(),"px")}),void 0!==this.activeVideoEl&&void 0!==this.activeControls&&this.activeVideoEl.id!==e.id&&(this.activeControls.disableCaptionsInPlayer(),this.stopRendering(),this.screenCoordsProvided||(this.screenCoords=e)),this.activeVideoEl=e,this.activeControls=t,this.activeTextTrackIndex=r,this.activeCues=[],this.cloneCues(),this.activeVideoEl.addEventListener("timeupdate",this.onTimeUpdate),this.activeVideoEl.addEventListener("seeked",this.onSeeked),this.activeVideoEl.addEventListener("play",this.onPlay),this.activeVideoEl.addEventListener("pause",this.onPause),l.Log.info(508155723,JSON.stringify({Description:"CaptionsRenderer.renderCaptionTrack: Info",Font:this.container.style.font,FontOpticalSizing:this.container.style.fontOpticalSizing,FontSize:this.container.style.fontSize,FontSizeAdjust:this.container.style.fontSizeAdjust,FontStretch:this.container.style.fontStretch,Height:this.container.style.height,Scale:this.container.style.scale})),this.startRendering()}},{key:"stopCaptionTrack",value:function(){var e;0!==(null===(e=this.activeControls)||void 0===e?void 0:e.getCaptionSelection)&&(void 0!==this.activeVideoEl&&(this.activeVideoEl.removeEventListener("timeupdate",this.onTimeUpdate),this.activeVideoEl.removeEventListener("seeked",this.onSeeked),this.activeVideoEl.removeEventListener("play",this.onPlay),this.activeVideoEl.removeEventListener("pause",this.onPause)),this.stopRendering())}},{key:"updateContainer",value:function(e){null===this.container.parentElement&&this.setParent(),this.setZIndex(e)}},{key:"reduceOpacity",value:function(){this.currentOpacity=this.reducedOpacity,this.container.style.opacity=this.currentOpacity}},{key:"resetOpacity",value:function(){this.currentOpacity=this.visibleOpacity,this.container.style.opacity=this.currentOpacity}},{key:"setHorizontalPosition",value:function(e){var t;if(null!==this.container.parentElement)if(null!==(null===(t=this.screenCoords)||void 0===t?void 0:t.parentElement)){var r=this.screenCoords.getBoundingClientRect().width,i=Math.min(r*u.CAPTIONS_WIDTH_PORTION,this.maxCharacterWidth),n=.5*(this.container.parentElement.getBoundingClientRect().width-i);if(this.container.style.left="".concat(n,"px"),this.container.style.right="".concat(n,"px"),this.improvedCaptionsPositioning&&(this.container.style.left="0",this.container.style.right="0",this.container.style.marginLeft="auto",this.container.style.marginRight="auto"),void 0!==e&&void 0!==this.activeControls&&this.activeControls.isVisible()&&void 0!==e&&this.boxIntersects(e)){var a=r/2<(e.left+e.right)/2;this.container.style.transform=a?"translateX(-".concat(this.maxCharacterWidth,"px)"):"translateX(".concat(this.maxCharacterWidth,"px)"),l.Log.info(508954691,"CaptionsRenderer.setHorizontalPosition: Box overlaps controls, adjusting position: ".concat(a?"left":"right"))}}else l.Log.warn(508954692,"CaptionsRenderer.setHorizontalPosition: screenCoords parent element is null");else l.Log.warn(508954693,"CaptionsRenderer.setHorizontalPosition: Parent element is null")}},{key:"resetHorizontalPosition",value:function(){var e;1===(null===(e=this.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&(this.container.style.transform="")}},{key:"setVerticalPosition",value:function(e){var t;if(null!==this.container.parentElement)if(null!==(null===(t=this.screenCoords)||void 0===t?void 0:t.parentElement)){if(void 0!==this.activeControls&&(e||1!==this.activeControls.getPositioningStrategy||this.activeControls.isVisible())){var r=(0,s.getNumberFromPixels)(this.screenCoords.style.width)*u.CAPTIONS_WIDTH_PORTION;this.container.style.maxWidth="".concat(Math.min(r,this.maxCharacterWidth),"px"),this.container.style.maxHeight="".concat(this.boxHeight,"px");var i=this.screenCoords.getBoundingClientRect(),n=i.height,a=n*u.CAPTIONS_BOTTOM_POSITION_PORTION,o=this.container.parentElement.getBoundingClientRect().bottom,c=o-i.bottom+a,d=o-this.activeControls.getBounds.top+a;l.Log.info(510252309,"CaptionsRenderer.setVerticalPosition: Current bottom: ".concat(this.container.style.bottom,", new bottom: ").concat(c,", pageHeight: ").concat(n,", boxHeight: ").concat(this.boxHeight,", bottomOffset: ").concat(a,", maxBoxWidth: ").concat(r,", maxCharacterWidth: ").concat(this.maxCharacterWidth)),this.container.style.bottom="".concat(c,"px"),2!==this.activeControls.getPositioningStrategy&&3!==this.activeControls.getPositioningStrategy&&!this.improvedCaptionsPositioning&&this.boxIntersects(this.activeControls.getBounds)&&(this.container.style.bottom="".concat(d,"px"),l.Log.info(509691529,"CaptionsRenderer.setVerticalPosition: Box overlaps main controls, adjusting position upwards - old bottom: ".concat(c,"px, new bottom: ").concat(this.container.style.bottom," controls top: ").concat(this.activeControls.getBounds.top)))}}else l.Log.warn(509691528,"CaptionsRenderer.setVerticalPosition: screenCoords parent element is null");else l.Log.warn(510252311,"CaptionsRenderer.setVerticalPosition: Parent element is null")}},{key:"boxIntersects",value:function(e){if(void 0===this.activeControls)return!1;var t=this.container.getBoundingClientRect(),r=t.right-t.left,i=(0,s.getNumberFromPixels)(this.container.style.maxWidth)/2-r/2,n=t.left-i,a=t.right+i,o=t.bottom,l=o-this.boxHeight;return!(e.right<n||e.left>a||e.bottom<l||e.top>o)}},{key:"setCuePreview",value:function(e,t,r){var i,n;if(t>=r||t>=(null!==(n=null===(i=this.activeVideoEl)||void 0===i?void 0:i.duration)&&void 0!==n?n:Number.NEGATIVE_INFINITY))return this.clearCuePreview(),void this.hide();this.cuePreview=e,this.cuePreviewStartTime=t,this.cuePreviewEndTime=r,this.show()}},{key:"clearCuePreview",value:function(){this.cuePreview=void 0,this.cuePreviewStartTime=void 0,this.cuePreviewEndTime=void 0}},{key:"hasCuePreview",value:function(){return void 0!==this.cuePreview&&void 0!==this.cuePreviewStartTime&&void 0!==this.cuePreviewEndTime}},{key:"isCuePreviewActive",value:function(){return void 0!==this.cuePreview&&void 0!==this.cuePreviewStartTime&&void 0!==this.cuePreviewEndTime&&void 0!==this.activeVideoEl&&!this.activeVideoEl.paused&&this.activeVideoEl.currentTime>=this.cuePreviewStartTime-u.CUE_PREVIEW_START_TIME_TOLERANCE&&this.activeVideoEl.currentTime<=this.cuePreviewEndTime+u.CUE_PREVIEW_END_TIME_TOLERANCE}},{key:"cloneCues",value:function(){var e,t,r,i=!this.renderCuePreview||void 0!==(null===(e=this.activeVideoEl)||void 0===e?void 0:e.textTracks)&&this.activeTextTrackIndex>=0&&this.activeTextTrackIndex<(null===(t=this.activeVideoEl)||void 0===t?void 0:t.textTracks.length)?null===(r=this.activeVideoEl)||void 0===r?void 0:r.textTracks[this.activeTextTrackIndex].cues:void 0;if(null!=i){var n,a=[],o=f(i);try{for(o.s();!(n=o.n()).done;){var s=n.value;a.push(new VTTCue(s.startTime,s.endTime,s.text))}}catch(e){o.e(e)}finally{o.f()}this.activeCues=a,this.setInitialCue()}else this.updateCaptionsMenuEnabled&&this.clearText()}},{key:"setParent",value:function(){var e=document.getElementById(this.parentName);null!==e?(this.container.addEventListener("resize",this.onResize),e.appendChild(this.container),this.improvedCaptionsPositioning&&(this.setHorizontalPosition(void 0),this.setVerticalPosition(!0))):l.Log.warn(510252312,"CaptionsRenderer.setParent: Parent was null, parentName: ".concat(this.parentName))}},{key:"setZIndex",value:function(e){this.container.style.zIndex="".concat(e)}},{key:"setInitialCue",value:function(){if(0!==this.activeCues.length){this.lastUpdate=0,this.clearText();for(var e=0;e<this.activeCues.length;e+=1){var t=this.activeCues[e];if(void 0===this.activeVideoEl)return;if(t.startTime>this.activeVideoEl.currentTime)return void(e>0?this.setTextById(e-1):this.activeCueIndex=-1);if(this.activeCueIndex=e,this.activeVideoEl.currentTime-t.startTime<=this.minCueMargin)return void this.setText(t.text)}}else this.activeCueIndex=0}},{key:"startRendering",value:function(){this.visible()||void 0===this.activeVideoEl||this.activeVideoEl.paused||this.show(),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0),0!==this.activeCues.length||this.renderCuePreview&&void 0!==this.cuePreview?this.setInitialCue():l.Log.warn(509670627,"CaptionsRenderer.startRendering: activeCues is empty")}},{key:"stopRendering",value:function(){this.visible()&&this.hide(),this.clearText(),this.clearCuePreview()}},{key:"clearText",value:function(){this.renderCuePreview&&void 0!==this.cuePreview||(this.container.style.opacity="0",this.container.textContent="")}},{key:"setText",value:function(e){var t;this.container.style.opacity=this.currentOpacity,this.renderCuePreview&&this.isCuePreviewActive()?(0,h.filterBIU)(null!==(t=this.cuePreview)&&void 0!==t?t:"",this.container):(0,h.filterBIU)(e,this.container)}},{key:"setTextById",value:function(e){var t;if(this.renderCuePreview&&this.isCuePreviewActive())(0,h.filterBIU)(null!==(t=this.cuePreview)&&void 0!==t?t:"",this.container);else if(0!==this.activeCues.length){var r=this.activeCues[e];void 0!==r?(this.container.style.opacity=this.currentOpacity,(0,h.filterBIU)(r.text,this.container)):this.container.textContent=""}else this.container.textContent=""}}]);t.CaptionsRenderer=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getNumberFromPixels=function(e){return Number(e.replace(/px$/,""))},t.createElementWithClass=w,t.PlaybackControls=t.Tooltip=void 0;var n=i(r(6)),a=i(r(19)),o=i(r(2)),s=i(r(1)),l=r(24),c=r(43),u=r(300),d=r(17),h=r(301),f=r(158),m=r(156),p=r(75),g=r(302),v=r(44),y=r(303);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var T=(0,o.default)((function e(t,r,i){(0,s.default)(this,e),this.presenter=t,this.attendee=r,this.noRole=i}));function b(e,t,r){e.style.background=(0,f.isInHighContrastMode)()?"linear-gradient(to right, ".concat(c.PROGRESS_BAR_LEFT_COLOR_HIGHCONTRAST," ").concat(t,"%, ").concat(c.PROGRESS_BAR_LOAD_COLOR_HIGHCONTRAST," ").concat(t,"% ").concat(r,"%, ").concat(c.PROGRESS_BAR_RIGHT_COLOR_HIGHCONTRAST," ").concat(r,"% 100%"):"linear-gradient(to right, ".concat(c.PROGRESS_BAR_LEFT_COLOR," ").concat(t,"%, ").concat(c.PROGRESS_BAR_LOAD_COLOR," ").concat(t,"% ").concat(r,"%, ").concat(c.PROGRESS_BAR_RIGHT_COLOR," ").concat(r,"% 100%")}function C(e,t){e.style.background=(0,f.isInHighContrastMode)()?"linear-gradient(to right, ".concat(c.PROGRESS_BAR_LEFT_COLOR_HIGHCONTRAST," ").concat(t,"%, ").concat(c.PROGRESS_BAR_RIGHT_COLOR_HIGHCONTRAST," ").concat(t,"% 100%"):"linear-gradient(to right, ".concat(c.PROGRESS_BAR_LEFT_COLOR," ").concat(t,"%, ").concat(c.PROGRESS_BAR_RIGHT_COLOR," ").concat(t,"% 100%")}function w(e,t){var r=document.createElement(e);return r.classList.add(t),r}t.Tooltip=T;var P=(0,o.default)((function e(t,r,i){var n=this;(0,s.default)(this,e),this.captionsMinUIDelay=250,this.captionsButtonVisible=!1,this.captionsButtonEnabled=!1,this.captionsPlaybackInPlayer=!1,this.captionsMenuShown=!1,this.captionsScaleFactor=1,this.positioningStrategy=0,this.volumeSliderEnabled=!0,this.speedButtonEnabled=!1,this.fullscreenButtonEnabled=!1,this.nestedTabbingEnabled=!1,this.textTracks=[],this.captionSelection=0,this.captionFocus=0,this.speedSelection=0,this.speedFocus=0,this.lastToggleTime=0,this.defaultCaptionsTrackSet=!1,this.defaultSpeedSet=!1,this.isFullscreenMode=!1,this.lastScrollTime=Date.now(),this.setDefaultCaptionsTrackOnlyOnce=!1,this.renderCuePreview=!1,this.updateCaptionsMenuEnabled=!1,this.autoMenuWidthHeight=!1,this.keyboardNavigateToPlaybackSpeedCheckmark=!1,this.ensureMenuPositionRequiresProgressBar=!1,this.refreshControls=function(){n.mediaInfo=n.getMediaInfo(),n.progressBar.max="".concat(n.mediaInfo.max),n.setProgressForScreenReader();var e=(0,g.toSeconds)(n.mediaInfo.trimStartMs);b(n.progressBar,(n.progressBar.valueAsNumber-e)/(n.mediaInfo.max-e)*100,(n.getBufferedSec()-e)/(n.mediaInfo.max-e)*100),n.updateTimeControl()},this.refreshControlsEx=function(e,t,r,i){n.mediaControlInfo.position=e,n.mediaControlInfo.cssPositionOverride=t,n.mediaControlInfo.size=r,n.mediaControlInfo.trimInfo=i,n.setContainerStyle(),void 0!==n.captionsMenu&&n.ensureMenuPosition(0),void 0!==n.speedMenuDiv&&n.ensureMenuPosition(1),n.refreshControls()},this.dispose=function(){void 0!==n.videoElement&&null!==n.videoElement&&(n.videoElement.removeEventListener("fullscreenchange",n.onFullScreenChange),n.videoElement.removeEventListener("play",n.onPlay),n.videoElement.removeEventListener("timeupdate",n.onTimeUpdate),n.videoElement.removeEventListener("loadedmetadata",n.refreshControls),n.videoElement.removeEventListener("canplay",n.refreshControls),null!==n.videoElement.textTracks&&void 0!==n.videoElement.textTracks&&n.videoElement.textTracks.removeEventListener("change",n.hideCaptionsInPlayer),n.videoElement.removeEventListener("play",n.togglePlayPauseIcon),n.videoElement.removeEventListener("pause",n.togglePlayPauseIcon),n.videoElement.removeEventListener("keydown",n.onVideoKeyDown),n.videoElement.removeEventListener("volumechange",n.onVideoVolumeChange)),void 0!==n.container&&null!==n.container&&n.container.remove(),void 0!==n.resizeObserver&&n.resizeObserver.disconnect()},this.togglePlayPauseIcon=function(){n.setPlayPauseIcon(!n.videoElement.paused)},this.onVideoKeyDown=function(e){n.handleCaptionsKeyboardEvent(e)},this.onVideoVolumeChange=function(){var e=n.videoElement.muted?0:n.videoElement.volume;n.setVolumeIcon(e,n.videoElement.muted||0===n.videoElement.volume),n.volumeSliderEnabled&&(n.volumeSlider.value="".concat(100*e),C(n.volumeSlider,n.volumeSlider.valueAsNumber))},this.onTimeUpdate=function(){n.videoElement.currentTime<=n.mediaInfo.max?n.mediaInfo.trimStartMs>0?n.currentTime.innerText=(0,g.formatTime)(Math.max(0,n.videoElement.currentTime-(0,g.toSeconds)(n.mediaInfo.trimStartMs))):n.currentTime.innerText=(0,g.formatTime)(n.videoElement.currentTime):(n.mediaInfo.max>0&&n.currentTime.innerText!==n.formattedEndTime&&(n.currentTime.innerText=n.formattedEndTime),n.setPlayPauseIcon(!1));var e=(0,g.toSeconds)(n.mediaInfo.trimStartMs);n.progressBar.value="".concat(n.videoElement.currentTime),b(n.progressBar,(n.progressBar.valueAsNumber-e)/(n.mediaInfo.max-e)*100,(n.getBufferedSec()-e)/(n.mediaInfo.max-e)*100)},this.onPlay=function(){n.setDefaultCaptionTrack()},this.hideCaptionsInPlayer=function(){if(!n.captionsPlaybackInPlayer){var e,t=_(n.videoElement.textTracks);try{for(t.s();!(e=t.n()).done;){var r=e.value;"showing"===r.mode&&(r.mode="hidden")}}catch(e){t.e(e)}finally{t.f()}}},this.onFullScreenChange=function(){if(n.captionsButtonEnabled&&(void 0===n.mediaControlInfo.transferCaptionsFullScreen||n.mediaControlInfo.transferCaptionsFullScreen)){var e=document.fullscreenElement===n.videoElement;n.videoElement.controls=e,e?n.transferCaptionsToPlayer():(n.transferCaptionsToRenderer(),n.setPlaybackSpeedFromElement())}},this.setDefaultCaptionsTrackOnlyOnce=v.Settings.getBoolean("setDefaultCaptionsTrackOnlyOnce"),this.renderCuePreview=v.Settings.getBoolean("renderCuePreview"),this.updateCaptionsMenuEnabled=v.Settings.getBoolean("updateCaptionsMenuEnabled"),this.autoMenuWidthHeight=v.Settings.getBoolean("autoMenuWidthHeight"),this.keyboardNavigateToPlaybackSpeedCheckmark=v.Settings.getBoolean("keyboardNavigateToPlaybackSpeedCheckmark"),this.ensureMenuPositionRequiresProgressBar=v.Settings.getBoolean("ensureMenuPositionRequiresProgressBar"),this.videoElement=t,this.mediaControlInfo=r,this.mediaCallbacks=i,this.zIndex=r.zIndex,this.mediaInfo=this.getMediaInfo(),void 0!==r.playPauseOnly&&r.playPauseOnly?(d.Log.info(509109908,"PlaybackControls: Creating only play and pause controls"),this.createControlsPlayPause()):this.createControls(),this.focusableElements=[this.progressBar,this.playButton,this.volumeButton,this.volumeSlider,this.captionsButton,this.speedButton,this.fullscreenButton],isNaN(this.videoElement.duration)&&(d.Log.warn(541882010,"PlaybackControls: Video duration not set."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectProgressAndTiming"))}),[{key:"getCaptionSelection",get:function(){return this.captionSelection}},{key:"getPositioningStrategy",get:function(){return this.positioningStrategy}},{key:"getBounds",get:function(){return this.container.getBoundingClientRect()}},{key:"isFullScreen",value:function(){return this.isFullscreenMode}},{key:"isVisible",value:function(){return"flex"===this.container.style.display}},{key:"getCaptionsScalingFactor",value:function(){return this.captionsScaleFactor}},{key:"show",value:function(){this.container.style.display="flex",this.fixCaptionsOverlap(this.getBounds)}},{key:"hide",value:function(){this.updatePopOuts(),this.container.style.display="none",this.resetCaptionsOverlap()}},{key:"onKeyDown",value:function(e){if(this.nestedTabbingEnabled&&void 0!==e){if("ArrowRight"===e.key&&("none"===this.progressBar.style.display?this.playButton.focus():this.progressBar.focus()),"ArrowLeft"===e.key)for(var t=this.focusableElements.length-1;t>=0;t--){var r=this.focusableElements[t];if((r!==this.captionsButton||this.captionsButtonEnabled)&&(r!==this.volumeButton||"none"!==this.volumeContainer.style.display)&&void 0!==r&&"none"!==r.style.display&&this.container.contains(r)){r.focus();break}}e.stopPropagation()}}},{key:"setParent",value:function(e){var t=this;try{null===e.shadowRoot?this.root=e.attachShadow({mode:"open"}):this.root=e.shadowRoot,this.root.appendChild(this.container),this.addCssRef(this.root),this.setPlayPauseIcon(!this.videoElement.paused),void 0!==this.captionsRenderer&&(this.captionsRenderer.updateContainer(this.zIndex-1),this.setDefaultCaptionsTrackOnlyOnce&&(this.defaultCaptionsTrackSet=!1),this.setDefaultCaptionTrack()),void 0!==this.currentTimeContainer&&(this.controlsOrganizer=new y.PlaybackControlsOrganizer(this.leftControls,this.rightControls,this.progressBar,this.currentTimeContainer,this.volumeContainer,this.volumeSliderContainer,this.speedButton,this.captionsButton,this.fullscreenButton),void 0!==this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver((function(e){var r,i,n,a=_(e);try{for(a.s();!(n=a.n()).done;){var o=n.value.contentRect;null===(r=t.controlsOrganizer)||void 0===r||r.onWidthChanged(o.width),null===(i=t.controlsOrganizer)||void 0===i||i.onHeightChanged(o.height)}}catch(e){a.e(e)}finally{a.f()}})),v.Settings.getBoolean("setControlsContainerPointerEventsStyle")||(this.container.style.pointerEvents="auto"),this.container.style.justifyContent="flex-end",this.resizeObserver.observe(e))}catch(e){d.Log.error(526485603,"Exception in setParent: ".concat(e.message))}}},{key:"enableCaptionTrack",value:function(e,t){void 0!==this.captionsRenderer&&(e<0||void 0===this.captionsMenu||e>=this.captionsMenu.children.length-1||e>this.videoElement.textTracks.length||(this.captionSelection=e,this.captionsMenu.children[e].setAttribute(c.ARIA_CHECKED,"true"),0===e?(this.hideCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?t&&this.disableCaptionsInPlayer():this.renderCuePreview?this.captionsRenderer.renderCaptionTrack(this.videoElement,this,-1):this.captionsRenderer.stopCaptionTrack()):("hidden"!==this.videoElement.textTracks[e-1].mode&&(this.videoElement.textTracks[e-1].mode="hidden"),this.showCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?(this.videoElement.textTracks[e-1].mode="showing",this.captionsPlaybackInPlayer=!1):(this.captionsRenderer.renderCaptionTrack(this.videoElement,this,e-1),2!==this.positioningStrategy&&3!==this.positioningStrategy||!this.isVisible()||this.fixCaptionsOverlap(this.getBounds)))))}},{key:"disableCaptionsInPlayer",value:function(){this.captionsPlaybackInPlayer=!1;for(var e=0;e<this.videoElement.textTracks.length;e+=1)if("showing"===this.videoElement.textTracks[e].mode)return this.videoElement.textTracks[e].mode="hidden",e}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"focusPlayButton",value:function(){this.isVisible()||this.show(),this.playButton.focus()}},{key:"toggleCaptionsMenu",value:function(e){this.isVisible()||this.show(),this.captionsButtonEnabled?this.toggleCaptionsMenuInternal(e):this.focusPlayButton()}},{key:"selectCaptionsTrackById",value:function(e){if(void 0!==this.textTracks&&null!==this.textTracks)for(var t=0;t<this.textTracks.length;t++)if(this.textTracks[t].id.endsWith(e))return this.updateCaptionTrack(t+1),void(this.isCaptionsMenuVisible()&&this.setCaptionsCheckmarkPosition())}},{key:"updateCaptionsMenu",value:function(){var e,t,r,i,n,a,o,s,l,c,u,d=!1,h=0,f=-1,p=this.captionsButton,g=null!=p&&p===this.root.activeElement;this.container.contains(null!==(e=this.captionsMenu)&&void 0!==e?e:null)&&(d=this.isCaptionsMenuVisible(),h=null!==(r=null===(t=this.captionsMenu)||void 0===t?void 0:t.scrollTop)&&void 0!==r?r:0,u=this.captionSelection>0&&this.captionSelection<=(null===(i=this.textTracks)||void 0===i?void 0:i.length)?null===(n=this.textTracks)||void 0===n?void 0:n[this.captionSelection-1].id:void 0,!g&&null!==this.root.activeElement&&null!==(null===(a=this.captionsMenu)||void 0===a?void 0:a.children)&&(null===(o=this.captionsMenu)||void 0===o?void 0:o.contains(this.root.activeElement))&&(f=Array.from(null===(s=this.captionsMenu)||void 0===s?void 0:s.children).indexOf(this.root.activeElement))),this.captionsButtonEnabled=this.captionsButtonVisible&&this.videoElement.textTracks.length>0,this.createCaptionsMenu(),this.createCaptionsButton(),p.replaceWith(this.captionsButton),this.nestedTabbingEnabled?this.initTabIndex():this.setTabOrder(),this.captionSelection=0,this.captionFocus=0,g&&(this.captionsButtonEnabled?this.captionsButton.focus():this.playButton.focus()),void 0!==this.videoElement&&null!==this.videoElement&&(this.textTracks=(0,m.cloneTracksShallow)(this.videoElement.textTracks)),this.container.contains(null!==(l=this.captionsMenu)&&void 0!==l?l:null)&&(void 0!==u&&this.selectCaptionsTrackById(u),null===(c=this.captionsRenderer)||void 0===c||c.selectCaptionsTrack(this.captionSelection-1),d&&this.captionsButtonEnabled?(this.showCaptionsMenu("Programmatic"),this.captionsMenu.scrollTop=h,!g&&f>=0&&(f=Math.max(Math.min(f,this.captionsMenu.children.length-2),0),this.showOptionFocus(this.captionsMenu.children[f],0))):this.hideCaptionsMenu("Programmatic"))}},{key:"onProgressSliderInput",value:function(){if(this.videoElement.currentTime!==this.progressBar.valueAsNumber){void 0!==this.mediaCallbacks?this.mediaCallbacks.seekMediaCallback(this.progressBar.valueAsNumber):this.videoElement.currentTime=this.progressBar.valueAsNumber,this.progressBar.value="".concat(this.videoElement.currentTime),this.setProgressForScreenReader();var e=(0,g.toSeconds)(this.mediaInfo.trimStartMs);b(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100)}}},{key:"onVolumeSliderInput",value:function(){this.videoElement.volume=this.volumeSlider.valueAsNumber/100,this.videoElement.volume>0&&this.videoElement.muted&&(this.videoElement.muted=!1),C(this.volumeSlider,this.volumeSlider.valueAsNumber),void 0!==this.mediaCallbacks&&this.mediaCallbacks.volumeChangedCallback()}},{key:"onVolumeClick",value:function(){this.videoElement.muted=!this.videoElement.muted;var e=this.videoElement.muted,t=e?0:this.videoElement.volume;this.setVolumeIcon(t,e),this.volumeSliderEnabled&&(this.volumeSlider.value="".concat(100*t),C(this.volumeSlider,this.volumeSlider.valueAsNumber)),void 0!==this.mediaCallbacks&&this.mediaCallbacks.muteUnmuteCallback()}},{key:"onPlayPauseClick",value:function(){return(0,l.__awaiter)(this,void 0,void 0,n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.updatePopOuts(),!this.videoElement.paused){e.next=10;break}if(void 0===this.mediaCallbacks){e.next=6;break}this.mediaCallbacks.playMediaCallback(),e.next=8;break;case 6:return e.next=8,this.videoElement.play();case 8:e.next=11;break;case 10:void 0!==this.mediaCallbacks?this.mediaCallbacks.pauseMediaCallback():this.videoElement.pause();case 11:case"end":return e.stop()}}),e,this)})))}},{key:"onPlaybackSpeedClick",value:function(){this.setDefaultPlaybackSpeed(),(0,g.hasInvisibleClass)(this.speedMenuDiv)?(this.hideCaptionsMenu("Programmatic"),this.ensureMenuPosition(1),this.speedButton.setAttribute(c.ARIA_EXPANDED,"true")):this.speedButton.setAttribute(c.ARIA_EXPANDED,"false"),(0,g.toggleInvisibleClass)(this.speedMenuDiv),(0,g.toggleInvisibleClass)(this.speedCheckmark),(0,g.hasInvisibleClass)(this.speedMenuDiv)?2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap():this.fixCaptionsOverlap(this.speedMenuDiv.getBoundingClientRect())}},{key:"hidePlaybackSpeedMenu",value:function(e){this.speedButtonEnabled&&((0,g.hasInvisibleClass)(this.speedMenuDiv)||((0,g.setInvisibleClass)(this.speedMenuDiv),(0,g.setInvisibleClass)(this.speedCheckmark),this.speedButton.setAttribute(c.ARIA_EXPANDED,"false"),"Programmatic"!==e&&this.speedButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap()))}},{key:"setDefaultPlaybackSpeed",value:function(){this.defaultSpeedSet||(this.defaultSpeedSet=!0,this.speedSelection=c.PLAYBACK_SPEEDS.indexOf(this.mediaInfo.playbackSpeed),-1===this.speedSelection?d.Log.warn(509670626,"PlaybackControls.setDefaultPlaybackSpeed: default video speed not in list of playback speed options"):this.setPlaybackSpeed(this.speedSelection))}},{key:"setPlaybackSpeedFromElement",value:function(){var e=c.PLAYBACK_SPEEDS.indexOf(this.videoElement.playbackRate);e!==this.speedSelection&&this.setPlaybackSpeed(e)}},{key:"setPlaybackSpeed",value:function(e){this.speedMenu.children[this.speedSelection].setAttribute(c.ARIA_CHECKED,"false"),this.speedSelection=e,this.mediaInfo.playbackSpeed=c.PLAYBACK_SPEEDS[e],this.videoElement.playbackRate=this.mediaInfo.playbackSpeed,this.speedButton.innerText=this.mediaInfo.playbackSpeed.toString()+c.PLAYBACK_SPEED_LABEL,this.speedMenu.children[this.speedSelection].setAttribute(c.ARIA_CHECKED,"true"),this.speedCheckmark.style.top="".concat(this.speedMenu.children[e].offsetTop+14,"px"),(0,g.setInvisibleClass)(this.speedMenuDiv),(0,g.setInvisibleClass)(this.speedCheckmark),this.speedButton.setAttribute(c.ARIA_EXPANDED,"false")}},{key:"onFullscreenClick",value:function(){var e=this;this.isFullscreenMode?this.isFullscreenMode=!1:(this.isFullscreenMode=!0,this.videoElement.requestFullscreen().catch((function(t){d.Log.warn(509346562,"PlayerControls.onFullscreenClick: unable to fullscreen video - ".concat(t.message)),e.isFullscreenMode=!1})))}},{key:"getMediaInfo",value:function(){var e=isNaN(this.mediaControlInfo.trimInfo.trimEndMs)?0:this.mediaControlInfo.trimInfo.trimEndMs,t=isNaN(this.videoElement.duration)?0:1e3*this.videoElement.duration-e;return{trimStartMs:isNaN(this.mediaControlInfo.trimInfo.trimStartMs)?0:this.mediaControlInfo.trimInfo.trimStartMs,trimEndMs:e,max:(0,g.toSeconds)(t),autoplay:this.videoElement.autoplay,playbackSpeed:this.videoElement.playbackRate,screenReaderInfo:this.mediaControlInfo.screenReaderInfo}}},{key:"addCssRef",value:function(e){if(!(null==e||e.styleSheets.length>0)){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",this.mediaControlInfo.cssUrl),t.addEventListener("error",(function(){d.Log.error(508864334,"PlaybackControls.css failed to load")})),e.appendChild(t)}}},{key:"getBufferedSec",value:function(){var e=(0,g.toSeconds)(this.mediaInfo.trimStartMs);if(this.videoElement.buffered.length>0)try{e=this.videoElement.buffered.end(0)}catch(e){}return e}},{key:"createControls",value:function(){this.setControlFlags(),this.createContainer(!0),this.createTopControls(this.container),this.createBottomControls(this.container),this.speedButtonEnabled&&this.createPlaybackSpeedMenu(this.container),this.videoElement.addEventListener("fullscreenchange",this.onFullScreenChange),this.videoElement.addEventListener("play",this.onPlay),this.videoElement.addEventListener("timeupdate",this.onTimeUpdate),this.videoElement.addEventListener("loadedmetadata",this.refreshControls),this.videoElement.addEventListener("canplay",this.refreshControls),null!==this.videoElement.textTracks&&void 0!==this.videoElement.textTracks&&(this.hideCaptionsInPlayer(),this.videoElement.textTracks.addEventListener("change",this.hideCaptionsInPlayer)),this.nestedTabbingEnabled?this.initTabIndex():this.setTabOrder(),this.setVolumeIcon(this.videoElement.volume,this.videoElement.muted),this.fullscreenButtonEnabled&&this.setFullscreenIcon(this.isFullscreenMode),this.textTracks=(0,m.cloneTracksShallow)(this.videoElement.textTracks),this.setDefaultCaptionTrack()}},{key:"setControlFlags",value:function(){if(this.captionsButtonVisible=void 0!==this.mediaControlInfo.captionsEnabled&&this.mediaControlInfo.captionsEnabled,this.captionsButtonVisible&&this.videoElement.textTracks.length>0&&(this.captionsButtonEnabled=!0),void 0!==this.mediaControlInfo.captionsPositioningStrategy&&(this.positioningStrategy=this.mediaControlInfo.captionsPositioningStrategy),d.Log.info(509163655,JSON.stringify({Description:"PlaybackControls - Captions settings",captionsButtonVisible:this.captionsButtonVisible,captionsButtonEnabled:this.captionsButtonEnabled,textTracks:this.videoElement.textTracks.length,children:this.videoElement.children.length})),this.captionsRenderer=this.mediaControlInfo.captionsRenderer,this.volumeSliderEnabled=void 0===this.mediaControlInfo.volumeSliderEnabled||this.mediaControlInfo.volumeSliderEnabled,this.speedButtonEnabled=void 0!==this.mediaControlInfo.speedEnabled&&this.mediaControlInfo.speedEnabled,this.fullscreenButtonEnabled=void 0!==this.mediaControlInfo.fullscreenEnabled&&this.mediaControlInfo.fullscreenEnabled,this.nestedTabbingEnabled=void 0!==this.mediaControlInfo.nestedTabbingEnabled&&this.mediaControlInfo.nestedTabbingEnabled,!this.volumeSliderEnabled){var e=v.Settings.getNumber("captionsScaleFactor");this.captionsScaleFactor=void 0===e||0===e?.6:e}}},{key:"setNextArrowFocus",value:function(e,t){var r=e;switch(e){case this.progressBar:r=this.playButton;break;case this.playButton:r=this.volumeButton;break;case this.volumeButton:this.volumeSliderEnabled?((0,g.setVisibleClass)(this.volumeSliderContainer),r=this.volumeSlider):this.captionsButtonEnabled?r=this.captionsButton:this.speedButtonEnabled?r=this.speedButton:this.fullscreenButtonEnabled&&(r=this.fullscreenButton);break;case this.volumeSlider:this.captionsButtonEnabled?r=this.captionsButton:this.speedButtonEnabled?r=this.speedButton:this.fullscreenButtonEnabled&&(r=this.fullscreenButton);break;case this.captionsButton:this.speedButtonEnabled?r=this.speedButton:this.fullscreenButtonEnabled&&(r=this.fullscreenButton);break;case this.speedButton:this.fullscreenButtonEnabled&&(r=this.fullscreenButton)}r!==e?"none"!==r.style.display&&this.container.contains(r)?(t.stopImmediatePropagation(),r.focus()):this.setNextArrowFocus(r,t):t.stopImmediatePropagation()}},{key:"setPreviousArrowFocus",value:function(e,t){var r=e;switch(e){case this.playButton:r=this.progressBar;break;case this.volumeButton:r=this.playButton;break;case this.volumeSlider:r=this.volumeButton;break;case this.captionsButton:this.volumeSliderEnabled?((0,g.setVisibleClass)(this.volumeSliderContainer),r=this.volumeSlider):r=this.volumeButton;break;case this.speedButton:this.captionsButtonEnabled?r=this.captionsButton:this.volumeSliderEnabled?((0,g.setVisibleClass)(this.volumeSliderContainer),r=this.volumeSlider):r=this.volumeButton;break;case this.fullscreenButton:this.speedButtonEnabled?r=this.speedButton:this.captionsButtonEnabled?r=this.captionsButton:this.volumeSliderEnabled?((0,g.setVisibleClass)(this.volumeSliderContainer),r=this.volumeSlider):r=this.volumeButton}r!==e?"none"!==r.style.display&&this.container.contains(r)?(t.stopImmediatePropagation(),r.focus()):this.setPreviousArrowFocus(r,t):t.stopImmediatePropagation()}},{key:"createControlsPlayPause",value:function(){this.createContainer(!1),this.setContainerStyle(),this.container.style.display="none";var e=w("div","controls-left");(0,p.setStyles)(e,{left:this.container.style.left}),this.createPlayButton(e),this.container.appendChild(e)}},{key:"setContainerStyle",value:function(){var e=this.mediaControlInfo;(0,p.setStyles)(this.container,{bottom:"0px",width:"100%",height:"".concat(e.size.y,"px"),zIndex:"".concat(e.zIndex),direction:"ltr"})}},{key:"createContainer",value:function(e){var t=this,r=w("div",e?"control-container":"control-container-no-background");r.id="video-controls-container",this.container=r,this.setContainerStyle(),this.container.style.display="none",void 0!==this.mediaControlInfo.cssPositionOverride&&(r.style.position=this.mediaControlInfo.cssPositionOverride),r.addEventListener("mousedown",(function(){r.classList.add("no-outline")})),r.addEventListener("click",(function(e){e.stopPropagation(),1===e.button&&t.updatePopOuts()})),r.addEventListener("keydown",(function(e){t.updatePopOuts(e),r.classList.remove("no-outline")}))}},{key:"createTopControls",value:function(e){var t=w("div","controls-top");this.createProgressBar(t),e.appendChild(t)}},{key:"createBottomControls",value:function(e){var t=w("div","controls-bottom");this.createLeftControls(t),this.createRightControls(t),e.appendChild(t)}},{key:"createLeftControls",value:function(e){this.leftControls=w("div","controls-left"),this.createPlayButton(this.leftControls),this.createVolumeControls(this.leftControls),this.createTimeControl(this.leftControls),e.appendChild(this.leftControls)}},{key:"createRightControls",value:function(e){this.rightControls=w("div","controls-right"),this.createCaptionsControls(this.rightControls),this.speedButtonEnabled&&this.createPlaybackSpeedControl(this.rightControls),this.fullscreenButtonEnabled&&this.createFullscreenControl(this.rightControls),e.appendChild(this.rightControls)}},{key:"initTabIndex",value:function(){if(this.progressBar.tabIndex=-1,this.playButton.tabIndex=-1,this.volumeButton.tabIndex=-1,this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=-1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=-1,this.captionsButtonEnabled)){var e,t=_(this.captionsMenu.children);try{for(t.s();!(e=t.n()).done;)e.value.tabIndex=-1}catch(e){t.e(e)}finally{t.f()}}if(this.speedButtonEnabled){this.speedButton.tabIndex=-1;var r,i=_(this.speedMenu.children);try{for(i.s();!(r=i.n()).done;)r.value.tabIndex=-1}catch(e){i.e(e)}finally{i.f()}}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=-1)}},{key:"setTabOrder",value:function(){this.progressBar.tabIndex=1,this.playButton.tabIndex=2,this.volumeButton.tabIndex=3;var e=this.volumeButton.tabIndex+1;if(this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=e,e+=1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=e,e+=1),this.captionsButtonEnabled){var t,r=_(this.captionsMenu.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;i instanceof SVGSVGElement||(i.tabIndex=e,e+=1)}}catch(e){r.e(e)}finally{r.f()}}if(this.speedButtonEnabled){this.speedButton.tabIndex=e,e+=1;var n,a=_(this.speedMenu.children);try{for(a.s();!(n=a.n()).done;)n.value.tabIndex=e,e+=1}catch(e){a.e(e)}finally{a.f()}}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=e,e+=1)}},{key:"updatePopOuts",value:function(e){(this.nestedTabbingEnabled||void 0===e||"Tab"!==e.key&&"Shift"!==e.key)&&(void 0!==e&&e.getModifierState(e.key)||this.handleCaptionsKeyboardEvent(e)||(this.captionsButtonEnabled&&this.isCaptionsMenuVisible()&&this.hideCaptionsMenu(void 0===e?"Programmatic":"Keyboard"),this.handleSpeedKeyboardEvent(e)||this.speedButtonEnabled&&void 0!==this.speedMenuDiv&&!(0,g.hasInvisibleClass)(this.speedMenuDiv)&&this.hidePlaybackSpeedMenu(void 0===e?"Programmatic":"Keyboard")))}},{key:"handleCaptionsKeyboardEvent",value:function(e){if(!this.captionsButtonEnabled||void 0===e)return!1;if(("j"===e.key||""===e.key)&&e.altKey)return this.toggleCaptionsMenuInternal("Shortcut"),e.stopPropagation(),!0;if(this.isCaptionsMenuVisible())switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.captionFocus>0&&(this.captionFocus-=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.captionFocus>=0&&this.captionFocus<this.captionsMenu.children.length-2&&(this.captionFocus+=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hideCaptionsMenu("Keyboard");break;default:return!1}else switch(e.key){case"c":"none"===this.container.style.display&&this.show(),this.toggleCaptionsMenuInternal("Shortcut"),this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0);break;default:return!1}return e.stopPropagation(),!0}},{key:"handleSpeedKeyboardEvent",value:function(e){if(!this.speedButtonEnabled||void 0===e)return!1;if(!(0,g.hasInvisibleClass)(this.speedMenuDiv)){switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.speedFocus>0&&(this.speedFocus-=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.speedFocus>=0&&this.speedFocus<this.speedMenu.children.length-(this.keyboardNavigateToPlaybackSpeedCheckmark?1:2)&&(this.speedFocus+=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hidePlaybackSpeedMenu("Keyboard");break;default:return!1}return e.stopPropagation(),!0}return!1}},{key:"getProgressStep",value:function(){var e=this.mediaInfo.max-(0,g.toSeconds)(this.mediaInfo.trimStartMs);return Math.max(e/100,.01)}},{key:"createProgressBar",value:function(e){var t=this,r=document.createElement("input");this.progressBar=r,r.type="range",r.classList.add("progress-slider"),r.min="".concat((0,g.toSeconds)(this.mediaInfo.trimStartMs)),r.max="".concat(this.mediaInfo.max),r.value=r.min,r.step="".concat(this.getProgressStep()),r.addEventListener("input",(function(){return t.onProgressSliderInput()})),void 0!==this.mediaInfo.screenReaderInfo&&r.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo.progressBarStr),r.addEventListener("focus",(function(){return t.setProgressForScreenReader()})),r.addEventListener("click",(function(){return t.updatePopOuts()})),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&r.addEventListener("mousedown",(function(e){e.stopPropagation()})),r.addEventListener("keydown",(function(e){t.updatePopOuts(e),t.nestedTabbingEnabled?"ArrowRight"===e.key?(e.preventDefault(),t.setNextArrowFocus(r,e)):"ArrowLeft"===e.key?(e.preventDefault(),e.stopImmediatePropagation()):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()})),void 0!==this.mediaControlInfo.tooltipMap&&r.addEventListener("mouseenter",(function(){r.title=t.getTooltip("Seek")}));var i=(0,g.toSeconds)(this.mediaInfo.trimStartMs);b(this.progressBar,(this.progressBar.valueAsNumber-i)/(this.mediaInfo.max-i)*100,(this.getBufferedSec()-i)/(this.mediaInfo.max-i)*100),e.appendChild(r)}},{key:"createPlayButton",value:function(e){var t=this,r=w("button","playpause");this.playButton=r,r.type="button";var i=(0,u.getIconSvg)("play-pause-gfxicon");r.appendChild(i),void 0!==this.mediaInfo.screenReaderInfo&&r.setAttribute(c.ARIA_LABEL,this.videoElement.paused?this.mediaInfo.screenReaderInfo.playButtonStr:this.mediaInfo.screenReaderInfo.pauseButtonStr),this.videoElement.addEventListener("play",this.togglePlayPauseIcon),this.videoElement.addEventListener("pause",this.togglePlayPauseIcon),this.videoElement.addEventListener("keydown",this.onVideoKeyDown),r.addEventListener("click",(function(){t.onPlayPauseClick().catch((function(e){return d.Log.warn(508413404,"PlayerControls.onPlayPauseClick: unable to play/pause video - ".concat(e.message))}))})),r.addEventListener("keydown",(function(e){if(t.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),t.onPlayPauseClick().catch((function(e){return d.Log.warn(526952129,"PlayerControls.onPlayPauseClick: unable to play/pause video - ".concat(e.message))}));break;case"ArrowRight":t.nestedTabbingEnabled&&t.setNextArrowFocus(r,e);break;case"ArrowLeft":t.nestedTabbingEnabled&&t.setPreviousArrowFocus(r,e);break;case"ArrowUp":case"ArrowDown":t.nestedTabbingEnabled&&e.stopImmediatePropagation()}})),e.appendChild(r)}},{key:"setPlayPauseIcon",value:function(e){var t=this.playButton.querySelector("#play-gfxicon"),r=this.playButton.querySelector("#pause-gfxicon");null!==t&&null!==r?e?((0,g.removeInvisibleClass)(r),(0,g.setInvisibleClass)(t),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo.pauseButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Pause"))):((0,g.removeInvisibleClass)(t),(0,g.setInvisibleClass)(r),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo.playButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Play"))):(d.Log.warn(541882011,"PlayerControls.setPlayPauseIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectPlayPauseIcon"))}},{key:"createVolumeControls",value:function(e){var t=this;this.volumeContainer=w("div","volume-container"),this.createVolumeButton(this.volumeContainer),this.volumeSliderEnabled&&(this.createVolumeSlider(this.volumeContainer),this.volumeContainer.addEventListener("focusin",(function(){(0,g.setVisibleClass)(t.volumeSliderContainer)})),this.volumeContainer.addEventListener("mouseleave",(function(){(0,g.removeVisibleClass)(t.volumeSliderContainer)}))),this.volumeContainer.addEventListener("click",(function(){return t.updatePopOuts()})),this.volumeContainer.addEventListener("keydown",(function(e){return t.updatePopOuts(e)})),e.appendChild(this.volumeContainer)}},{key:"createVolumeButton",value:function(e){var t=this,r=w("button","volume");this.volumeButton=r,r.type="button";var i=(0,u.getIconSvg)("volume-gfxicon");r.appendChild(i),this.videoElement.addEventListener("volumechange",this.onVideoVolumeChange),void 0!==this.mediaInfo.screenReaderInfo&&(r.setAttribute(c.ARIA_LABEL,this.videoElement.muted?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr),r.addEventListener("keydown",(function(e){if(t.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),t.onVolumeClick()}}))),r.addEventListener("click",(function(){t.updatePopOuts(),t.onVolumeClick()})),r.addEventListener("keydown",(function(e){t.updatePopOuts(e),t.nestedTabbingEnabled&&("ArrowLeft"===e.key?t.setPreviousArrowFocus(r,e):"ArrowRight"===e.key?t.setNextArrowFocus(r,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())})),this.volumeSliderEnabled&&r.addEventListener("mouseenter",(function(){(0,g.setVisibleClass)(t.volumeSliderContainer)})),e.appendChild(r)}},{key:"createVolumeSlider",value:function(e){var t=this;this.volumeSlider=w("input","volume-slider"),this.volumeSlider.type="range",this.volumeSlider.min="0",this.volumeSlider.max="100",this.volumeSlider.value=this.videoElement.muted?"0":"".concat(100*this.videoElement.volume),void 0!==this.mediaInfo.screenReaderInfo&&this.volumeSlider.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo.volumeSliderStr),C(this.volumeSlider,this.volumeSlider.valueAsNumber),this.volumeSlider.addEventListener("input",(function(){return t.onVolumeSliderInput()})),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&this.volumeSlider.addEventListener("mousedown",(function(e){e.stopPropagation()})),this.volumeSlider.addEventListener("click",(function(){return t.updatePopOuts()})),this.volumeSlider.addEventListener("keydown",(function(e){t.updatePopOuts(e),t.nestedTabbingEnabled?"ArrowLeft"===e.key?(e.preventDefault(),t.setPreviousArrowFocus(t.volumeSlider,e)):"ArrowRight"===e.key?(e.preventDefault(),t.setNextArrowFocus(t.volumeSlider,e)):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()})),this.volumeSlider.addEventListener("focusout",(function(e){(0,g.removeVisibleClass)(t.volumeSlider),e.stopPropagation()})),this.volumeSlider.style.display="block",this.volumeSlider.style.margin="auto",this.volumeSlider.style.width="75%",this.volumeSliderContainer=w("div","volume-slider-container"),this.volumeSliderContainer.appendChild(this.volumeSlider),e.style.position="relative",e.appendChild(this.volumeSliderContainer),C(this.volumeSlider,this.volumeSlider.valueAsNumber)}},{key:"setVolumeIcon",value:function(e,t){var r=this.volumeButton.querySelector("#volume-low-gfxicon"),i=this.volumeButton.querySelector("#volume-medium-gfxicon"),n=this.volumeButton.querySelector("#volume-high-gfxicon"),a=this.volumeButton.querySelector("#volume-muted-gfxicon");if(null===r||null===i||null===n||null===a)return d.Log.warn(541882012,"PlayerControls.setVolumeIcon: querySelector returned null, unable to set volume button icon"),void(void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectVolumeIndicator"));(0,g.setInvisibleClass)(a),(0,g.setInvisibleClass)(r),(0,g.setInvisibleClass)(i),(0,g.setInvisibleClass)(n),void 0!==this.mediaControlInfo.tooltipMap&&(this.volumeButton.title=t?this.getTooltip("Unmute"):this.getTooltip("Mute")),t?(0,g.removeInvisibleClass)(a):e<.33?(0,g.removeInvisibleClass)(r):e<.67?(0,g.removeInvisibleClass)(i):(0,g.removeInvisibleClass)(n),void 0!==this.mediaInfo.screenReaderInfo&&this.volumeButton.setAttribute(c.ARIA_LABEL,t?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr)}},{key:"getTextTracks",value:function(){return this.textTracks}},{key:"findMatchingCaptionTrack",value:function(e,t){if(null===e&&null===t)return-1;if(0===(null==e?void 0:e.length)&&0===(null==t?void 0:t.length))return 0;for(var r=this.getTextTracks(),i=-1,n=-1,a=0;a<r.length;a+=1){var o=r[a].language.toLowerCase();"unknown"===o&&(o="");var s=0!==(null==e?void 0:e.length)&&o===(null==e?void 0:e.toLowerCase()),l=0!==(null==t?void 0:t.length)&&r[a].label.toLowerCase()===(null==t?void 0:t.toLowerCase());if(n<0&&l&&(n=a+1),s){if(l)return a+1;i=a+1}i<0&&((0,h.checkPartialLangMatch)(r[a].language,e)||(0,h.checkPartialLangMatch)(e,r[a].language))&&(i=a+1)}return i>0?i:n>0?n:-1}},{key:"getLastSelectedCaptionTrack",value:function(){return[(0,f.localStorgateGetItemWithExpiration)(c.CAPTIONS_LAST_SELECTED_LANG),(0,f.localStorgateGetItemWithExpiration)(c.CAPTIONS_LAST_SELECTED_LABEL)]}},{key:"setLastSelectedCaptionTrack",value:function(e){var t=this.getTextTracks().length;if(!(e<0||e>t)){var r="",i="";if(e>0){var n=this.getTextTracks()[e-1];r="unknown"===n.language.toLowerCase()?"":n.language,i=n.label}var a=new Date((new Date).setFullYear((new Date).getFullYear()+1));(0,f.localStorgateSetItemWithExpiration)(c.CAPTIONS_LAST_SELECTED_LANG,r,a),(0,f.localStorgateSetItemWithExpiration)(c.CAPTIONS_LAST_SELECTED_LABEL,i,a)}}},{key:"setDefaultCaptionTrack",value:function(){if(this.captionsButtonEnabled&&!(this.getTextTracks().length<=0)){if(this.captionSelection>0)return this.enableCaptionTrack(this.captionSelection,!1),void(this.setDefaultCaptionsTrackOnlyOnce&&(this.defaultCaptionsTrackSet=!0));if(this.setDefaultCaptionsTrackOnlyOnce){if(this.defaultCaptionsTrackSet)return;this.defaultCaptionsTrackSet=!0}var e,t,r=this.getLastSelectedCaptionTrack(),i=(0,a.default)(r,2);e=i[0],t=i[1];var n=this.findMatchingCaptionTrack(e,t);if(n>=0)this.enableCaptionTrack(n,!1);else{if(void 0!==this.captionsRenderer&&""!==this.captionsRenderer.getDefaultLang)for(var o=0;o<this.getTextTracks().length;o+=1)if(this.getTextTracks()[o].language.toLowerCase()===this.captionsRenderer.getDefaultLang)return void this.enableCaptionTrack(o+1,!1);null===e&&null===t?this.captionsMenu.children[0].setAttribute(c.ARIA_CHECKED,"true"):this.enableCaptionTrack(1,!1)}}}},{key:"disableCaptionTrack",value:function(e){var t;e<0||(this.captionsMenu.children[e].setAttribute(c.ARIA_CHECKED,"false"),0!==e&&(void 0!==this.captionsRenderer?null===(t=this.captionsRenderer)||void 0===t||t.stopCaptionTrack():(this.videoElement.textTracks[e-1].mode="hidden",this.captionsPlaybackInPlayer=!1)))}},{key:"updateCaptionTrack",value:function(e){d.Log.info(512550666,"PlaybackControls - Captions: Updating selected caption track new selection: ".concat(e,", previous selection: ").concat(this.captionSelection)),this.setLastSelectedCaptionTrack(e),e!==this.captionSelection&&(this.disableCaptionTrack(this.captionSelection),this.enableCaptionTrack(e,!1))}},{key:"showCaptionsUnderlineIcon",value:function(){(0,g.removeInvisibleClass)(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="",(0,g.setInvisibleClass)(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="absolute"}},{key:"hideCaptionsUnderlineIcon",value:function(){(0,g.removeInvisibleClass)(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="",(0,g.setInvisibleClass)(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="absolute"}},{key:"isCaptionsMenuVisible",value:function(){return!(0,g.hasInvisibleClass)(this.captionsMenu)}},{key:"setCaptionsCheckmarkPosition",value:function(){var e=14*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2);this.captionsCheckmark.style.top="".concat(this.captionsMenu.children[this.captionSelection].offsetTop+e,"px"),this.captionsCheckmark.style.display="block"}},{key:"showCaptionsMenu",value:function(e){try{if(!this.captionsButtonEnabled)return;this.setDefaultCaptionTrack(),d.Log.info(512521174,JSON.stringify({Description:"PlaybackControls - Showing captions menu",Source:e})),this.hidePlaybackSpeedMenu("Programmatic"),this.ensureMenuPosition(0),(0,g.removeInvisibleClass)(this.captionsMenu),this.setCaptionsCheckmarkPosition(),this.captionsButton.setAttribute(c.ARIA_EXPANDED,"true"),this.volumeSliderEnabled||0!==this.captionsMenu.offsetWidth||(d.Log.info(508867395,JSON.stringify({Description:"PlaybackControls - Captions menu has no dimensions, setting minimums",PreviousWidth:this.captionsMenu.style.width,PreviousHeight:this.captionsMenu.style.height,NewWidth:"75px",NewHeight:"50px"})),this.captionsMenu.style.width="75px",this.captionsMenu.style.height="50px"),this.captionsMenuShown||(this.captionsMenuShown=!0,this.logCaptionsMenuInfo()),"Keyboard"===e||"Shortcut"===e?this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0):"Click"===e&&this.captionsMenu.children[this.captionSelection].focus(),this.fixCaptionsOverlap(this.captionsMenu.getBoundingClientRect())}catch(e){throw d.Log.error(509130720,"PlaybackControls.showCaptionsMenu - Exception caught: ".concat(e.message)),e}}},{key:"logCaptionsMenuInfo",value:function(){var e=this.captionsMenu.getBoundingClientRect(),t=this.container.getBoundingClientRect();d.Log.info(508942554,JSON.stringify({MenuClassList:this.captionsMenu.classList,MenuDisplay:this.captionsMenu.style.display,MenuHidden:this.captionsMenu.hidden,MenuOpacity:this.captionsMenu.style.opacity,MenuVisibility:this.captionsMenu.style.visibility,MenuTop:e.top,MenuBottom:e.bottom,MenuLeft:e.left,MenuRight:e.right,MenuWidth:this.captionsMenu.style.width,MenuHeight:this.captionsMenu.style.height,MenuOffsetHeight:this.captionsMenu.offsetHeight,MenuOffsetTop:this.captionsMenu.offsetTop,MenuOffsetLeft:this.captionsMenu.offsetLeft,MenuOffsetWidth:this.captionsMenu.offsetWidth,ContainerTop:t.top,ContainerBottom:t.bottom,ContainerLeft:t.left,ContainerRight:t.right}));var r,i=_(this.captionsMenu.children);try{for(i.s();!(r=i.n()).done;){var n=r.value;this.logOptionInfo("Showing menu - option info",n)}}catch(e){i.e(e)}finally{i.f()}}},{key:"fixCaptionsOverlap",value:function(e){0!==this.captionSelection&&void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&this.captionsRenderer.boxIntersects(e)&&(1===this.positioningStrategy&&(this.captionsRenderer.setHorizontalPosition(this.getMenuBoxRect()),this.captionsRenderer.setVerticalPosition(!1)),2===this.positioningStrategy&&this.transferCaptionsToPlayer(),3===this.positioningStrategy&&this.captionsRenderer.reduceOpacity())}},{key:"getMenuBoxRect",value:function(){return void 0!==this.captionsMenu&&this.isCaptionsMenuVisible()?this.captionsMenu.getBoundingClientRect():void 0===this.speedMenuDiv||(0,g.hasInvisibleClass)(this.speedMenuDiv)?void 0:this.speedMenuDiv.getBoundingClientRect()}},{key:"resetCaptionsOverlap",value:function(){void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&(2===this.positioningStrategy&&this.transferCaptionsToRenderer(),0!==this.captionSelection&&(1===this.positioningStrategy&&(this.captionsRenderer.resetHorizontalPosition(),this.captionsRenderer.setVerticalPosition(!0)),3===this.positioningStrategy&&this.captionsRenderer.resetOpacity()))}},{key:"hideCaptionsMenu",value:function(e){(this.updateCaptionsMenuEnabled||this.captionsButtonEnabled)&&(0,g.setInvisibleClass)(this.captionsMenu),this.captionsButtonEnabled&&(d.Log.info(512521173,JSON.stringify({Description:"PlaybackControls - Hiding captions menu",Source:e})),this.captionsCheckmark.style.display="none",this.captionsButton.setAttribute(c.ARIA_EXPANDED,"false"),"Programmatic"!==e&&this.captionsButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap())}},{key:"toggleCaptionsMenuInternal",value:function(e){if(this.captionsButtonEnabled){this.isVisible()||this.show();var t=Date.now()-this.lastToggleTime;t<=this.captionsMinUIDelay?d.Log.info(509162690,JSON.stringify({Description:"PlaybackControls - Suppressing duplicate captions menu toggle",Source:e,LastClickDelay:t,MinDelay:this.captionsMinUIDelay})):(d.Log.info(512521172,JSON.stringify({Description:"PlaybackControls - Toggling captions menu",Source:e})),this.lastToggleTime=Date.now(),this.isCaptionsMenuVisible()?this.hideCaptionsMenu(e):this.showCaptionsMenu(e))}else d.Log.info(509162691,JSON.stringify({Description:"PlaybackControls - Captions button is not enabled, skipping menu toggle",Source:e}))}},{key:"showOptionFocus",value:function(e,t){switch(e.style.backgroundColor="#000000",e.style.background="solid",e.focus(),e.scrollIntoView({behavior:"smooth",block:"nearest"}),t){case 0:this.captionFocus=parseInt(e.id,10);break;case 1:this.speedFocus=parseInt(e.id,10)}}},{key:"hideOptionFocus",value:function(e){e.style.background="none"}},{key:"createCaptionsControls",value:function(e){this.captionsButtonVisible&&void 0===this.captionsButton&&((this.captionsButtonEnabled||this.updateCaptionsMenuEnabled)&&(d.Log.info(512550661,"PlaybackControls - Captions: Creating captions menu"),this.createCaptionsMenu()),this.createCaptionsButton(),e.appendChild(this.captionsButton),(this.updateCaptionsMenuEnabled||this.captionsButtonEnabled)&&this.hideCaptionsMenu("Programmatic"))}},{key:"createCaptionsMenu",value:function(){var e,t=this,r=w("div","closed-captions-menu");if(this.updateCaptionsMenuEnabled&&this.container.contains(null!==(e=this.captionsMenu)&&void 0!==e?e:null)?this.captionsMenu.replaceWith(r):this.container.appendChild(r),this.captionsMenu=r,this.updateCaptionsMenuEnabled&&this.videoElement.textTracks.length<=0)r.setAttribute(c.ARIA_HIDDEN,"true");else{this.captionsMenu.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuStr:"Closed captions menu"),this.captionsMenu.setAttribute("role","menu"),(0,p.setStyles)(this.captionsMenu,{display:"block",opacity:".8",position:"absolute",right:"0px",borderRadius:"2px"});var i=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuOffOptionStr:"Off";if(this.captionsMenu.appendChild(this.createOptionElement(0,"",i)),this.captionsButtonEnabled)for(var n=0;n<this.videoElement.textTracks.length;n+=1){var a=this.videoElement.textTracks[n];d.Log.info(512550665,"PlaybackControls - Captions: Adding track index: ".concat(n,", language: ").concat(a.language));var o,s=(0,h.translateTagtoLanguage)(a.language);s===a.language&&d.Log.info(512550664,"PlaybackControls - Captions: Unknown language code: ".concat(a.language)),o="Unknown"!==s?""!==a.label&&a.label.toLowerCase()!==s.toLowerCase()?"".concat(a.label," - ").concat(s):s:""!==a.label?a.label:"Track ".concat(n+1),this.captionsMenu.addEventListener("focusout",(function(e){e.stopImmediatePropagation()})),this.captionsMenu.addEventListener("wheel",(function(e){e.preventDefault();var r=Date.now();t.lastScrollTime+c.MENU_SCROLL_WAIT<r&&(t.captionsMenu.scrollTop+=e.deltaY>0?Math.min(e.deltaY,c.MENU_SCROLL_INCREMENT):Math.max(e.deltaY,-c.MENU_SCROLL_INCREMENT),t.lastScrollTime=r)}));var l=this.createOptionElement(n+1,a.language,o);this.captionsMenu.appendChild(l),this.logOptionInfo("Finished adding option to menu",l)}this.createMenuCheckmark(0),this.captionsMenu.appendChild(this.captionsCheckmark)}}},{key:"logOptionInfo",value:function(e,t){d.Log.info(508905682,JSON.stringify({Description:"PlaybackControls - Captions: ".concat(e),Index:t.id,Font:t.style.font,FontFamily:t.style.fontFamily,FontSize:t.style.fontSize,FillOpacity:t.style.fillOpacity,Opacity:t.style.opacity,OptionOffsetHeight:t.offsetHeight,OptionOffsetTop:t.offsetTop,OptionOffsetLeft:t.offsetLeft,OptionOffsetWidth:t.offsetWidth}))}},{key:"createOptionElement",value:function(e,t,r){var i=this;d.Log.info(512550663,"PlaybackControls - Captions: Creating option index: ".concat(e));var n=w("div","closed-captions-menu-item");return t.length>0&&(n.lang=t),n.innerText=r,n.textContent=r,n.id="".concat(e),n.setAttribute(c.ARIA_LABEL,r),n.setAttribute("role","menuitemradio"),n.setAttribute(c.ARIA_CHECKED,"false"),this.setOptionStyle(n),n.addEventListener("click",(function(t){0===t.button&&(i.logOptionActivation(n,"Click"),i.updateCaptionTrack(e),i.hideCaptionsMenu("Click"),t.stopImmediatePropagation())})),n.addEventListener("touchend",(function(){i.logOptionActivation(n,"Touch")})),n.addEventListener("keydown",(function(t){"Spacebar"!==t.key&&" "!==t.key&&"Enter"!==t.key||(i.logOptionActivation(n,"Keyboard"),i.updateCaptionTrack(e),i.hideCaptionsMenu("Keyboard"),i.captionsButton.focus(),t.preventDefault(),t.stopImmediatePropagation())})),n.addEventListener("mouseenter",(function(){i.showOptionFocus(n,0)})),n.addEventListener("focusin",(function(){i.showOptionFocus(n,0)})),n.addEventListener("mouseleave",(function(){i.hideOptionFocus(n)})),n.addEventListener("focusout",(function(){i.hideOptionFocus(n)})),n}},{key:"logOptionActivation",value:function(e,t){d.Log.info(509162655,JSON.stringify({Description:"PlaybackControls - Captions option activation",Source:t,Index:e.id,InnerText:e.innerText,TextContent:e.textContent}))}},{key:"setOptionStyle",value:function(e){var t="".concat(8*this.captionsScaleFactor,"px");(0,p.setStyles)(e,{paddingTop:t,paddingBottom:t,paddingLeft:"".concat(32*this.captionsScaleFactor,"px"),paddingRight:"".concat(40*this.captionsScaleFactor,"px"),color:"#F3F2F1",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:"".concat(14*this.captionsScaleFactor,"px"),textAlign:"left",fillOpacity:".8",background:"none"})}},{key:"createCaptionsButton",value:function(){var e=this;d.Log.info(512550662,"PlaybackControls - Captions: Creating captions button");var t=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsButtonStr:"Closed captions",r=w("button","closed-captions-button");this.captionsButton=r,r.type="button",r.name=t,r.setAttribute(c.ARIA_LABEL,t),r.setAttribute(c.ARIA_HASPOPUP,"menu"),r.disabled=!v.Settings.getBoolean("dontSetDisabledOnCaptionsButton")&&!this.captionsButtonEnabled,this.addCaptionbuttonIcons(),this.captionsButtonEnabled?(r.addEventListener("click",(function(t){e.logCaptionsButtonEvent("Click"),e.toggleCaptionsMenuInternal("Click"),t.stopImmediatePropagation()})),r.addEventListener("touchend",(function(){e.logCaptionsButtonEvent("Touch")})),r.addEventListener("keydown",(function(t){"Spacebar"===t.key||" "===t.key||"Enter"===t.key?(e.logCaptionsButtonEvent("Keyboard"),e.toggleCaptionsMenuInternal("Keyboard"),t.preventDefault(),t.stopImmediatePropagation()):e.nestedTabbingEnabled&&("ArrowLeft"===t.key?e.setPreviousArrowFocus(e.captionsButton,t):"ArrowRight"===t.key?e.setNextArrowFocus(e.captionsButton,t):"ArrowUp"!==t.key&&"ArrowDown"!==t.key||t.stopImmediatePropagation())})),void 0!==this.mediaControlInfo.tooltipMap&&r.addEventListener("mouseenter",(function(){r.title=e.getTooltip("Captions")}))):void 0!==this.mediaControlInfo.tooltipMap&&(r.title=this.getTooltip("Captions disabled"))}},{key:"logCaptionsButtonEvent",value:function(e){d.Log.info(509163653,JSON.stringify({Description:"PlaybackControls - Captions button event received",Source:e}))}},{key:"addCaptionbuttonIcons",value:function(){var e=(0,u.getIconSvg)("captions-gfxicon");this.captionsButtonEnabled||(e.style.opacity=".40"),this.captionsButton.appendChild(e);var t=(0,u.getIconSvg)("captions-active-gfxicon");(0,g.setInvisibleClass)(t),this.captionsButton.appendChild(t)}},{key:"ensureMenuPosition",value:function(e){if(!this.ensureMenuPositionRequiresProgressBar||null!==this.progressBar.offsetParent){var t=this.ensureMenuPositionRequiresProgressBar?this.progressBar.offsetParent:this.playButton.offsetParent;if(!this.ensureMenuPositionRequiresProgressBar||null!==t)switch(e){case 0:this.ensureMenuDivPosition(t,this.captionsMenu.offsetHeight,this.captionsMenu.offsetWidth,this.captionsMenu);break;case 1:this.ensureMenuDivPosition(t,this.speedMenu.offsetHeight,this.speedMenu.offsetWidth,this.speedMenuDiv)}}}},{key:"ensureMenuDivPosition",value:function(e,t,r,i){var n,a,o,s,l,c=this.ensureMenuPositionRequiresProgressBar?e.offsetHeight:null!==(n=null==e?void 0:e.offsetHeight)&&void 0!==n?n:0,u=(null===(o=null===(a=this.root)||void 0===a?void 0:a.host)||void 0===o?void 0:o.offsetWidth)>0?this.root.host.offsetWidth:this.videoElement.offsetWidth,d=(null===(l=null===(s=this.root)||void 0===s?void 0:s.host)||void 0===l?void 0:l.offsetHeight)>0?this.root.host.offsetHeight:this.videoElement.offsetHeight,h=Math.min(t,d-c-2);this.autoMenuWidthHeight?(0,p.setStyles)(i,{bottom:"".concat(c-2,"px"),width:"auto",height:"auto",maxWidth:"".concat(u-4,"px"),maxHeight:"".concat(d-c-2,"px"),overflowWrap:"break-word"}):(0,p.setStyles)(i,{bottom:"".concat(c-2,"px"),width:"".concat(r,"px"),height:"".concat(h,"px")})}},{key:"createMenuCheckmark",value:function(e){var t=(0,u.getIconSvg)("checkmark-gfxicon");switch(e){case 0:this.captionsCheckmark=t,this.captionsCheckmark.style.scale="".concat(this.captionsScaleFactor);break;case 1:this.speedCheckmark=t,this.speedCheckmark.style.display="block"}var r=10*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2.5);(0,p.setStyles)(t,{position:"absolute",left:"".concat(r,"px"),zIndex:"5"})}},{key:"createTimeControl",value:function(e){this.currentTime=document.createElement("span"),this.currentTime.classList.add("text-formatting"),this.currentTime.style.marginLeft="4px",this.currentTime.innerText="0:00";var t=document.createElement("span");t.classList.add("text-formatting"),t.textContent=" / ",this.endTime=document.createElement("span"),this.endTime.classList.add("text-formatting"),this.endTime.id="video-end-time",this.updateTimeControl(),this.currentTime.style.alignSelf="center",t.style.alignSelf="center",this.endTime.style.alignSelf="center",this.shouldHideTimeControls()&&(this.currentTime.style.display="none",t.style.display="none",this.endTime.style.display="none"),this.currentTimeContainer=w("div","current-time-container"),this.currentTime.style.marginLeft="",this.shouldHideTimeControls()&&(this.currentTimeContainer.style.display="none"),this.currentTimeContainer.appendChild(this.currentTime),this.currentTimeContainer.appendChild(t),this.currentTimeContainer.appendChild(this.endTime),e.appendChild(this.currentTimeContainer)}},{key:"updateTimeControl",value:function(){var e=new Date(1e3*this.mediaInfo.max).toISOString();this.mediaInfo.max>0&&(e=new Date(1e3*this.mediaInfo.max-this.mediaInfo.trimStartMs).toISOString());var t="00"===e.substring(11,13)?e.substring(14,19):e.substring(11,19);this.endTime.innerText=t,this.formattedEndTime=t}},{key:"transferCaptionsToPlayer",value:function(){this.captionsPlaybackInPlayer||(this.captionsPlaybackInPlayer=!0,this.captionSelection<1||void 0===this.videoElement.textTracks[this.captionSelection-1]||(this.videoElement.textTracks[this.captionSelection-1].mode="showing",this.disableCaptionTrack(this.captionSelection)))}},{key:"transferCaptionsToRenderer",value:function(){if(this.captionsPlaybackInPlayer){var e=this.disableCaptionsInPlayer();void 0!==e&&this.enableCaptionTrack(e+1,!1)}}},{key:"createPlaybackSpeedControl",value:function(e){var t=this,r=w("button","speed");this.speedButton=r,r.type="button",r.classList.add("text-formatting"),r.innerText=this.mediaInfo.playbackSpeed.toString()+c.PLAYBACK_SPEED_LABEL,r.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.speedButtonStr:"Playback speed"),r.setAttribute(c.ARIA_HASPOPUP,"menu"),r.setAttribute(c.ARIA_EXPANDED,"false"),r.addEventListener("click",(function(e){t.onPlaybackSpeedClick(),e.stopImmediatePropagation(),(0,g.hasInvisibleClass)(t.speedMenuDiv)||t.speedMenu.children[t.speedSelection].focus()})),r.addEventListener("keydown",(function(e){"Spacebar"===e.key||" "===e.key||"Enter"===e.key?(t.onPlaybackSpeedClick(),e.preventDefault(),e.stopImmediatePropagation(),(0,g.hasInvisibleClass)(t.speedMenuDiv)||t.showOptionFocus(t.speedMenu.children[t.speedSelection],1)):t.nestedTabbingEnabled&&("ArrowLeft"===e.key?t.setPreviousArrowFocus(t.speedButton,e):"ArrowRight"===e.key?t.setNextArrowFocus(t.speedButton,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())})),e.appendChild(this.speedButton)}},{key:"createPlaybackSpeedMenu",value:function(e){var t=this;this.speedMenuDiv=w("div","speed-menu-div"),this.speedMenuDiv.classList.add("text-formatting","invisible"),this.speedMenuDiv.style.display="block",this.autoMenuWidthHeight?this.speedMenu=this.speedMenuDiv:(this.speedMenu=w("div","speed-menu"),this.speedMenu.style.display="block"),this.speedMenu.setAttribute("role","menu");for(var r=function(e){var r=w("div","speed-menu-option");r.classList.add("text-formatting");var i="";i=t.mediaInfo.screenReaderInfo?t.mediaInfo.screenReaderInfo.speedMenuOptionStr.replace("{0}",c.PLAYBACK_SPEEDS[e].toString()):c.PLAYBACK_SPEEDS[e].toString()+c.PLAYBACK_SPEED_LABEL,r.innerText=i,r.id="".concat(e),r.setAttribute(c.ARIA_LABEL,i),r.setAttribute("role","menuitemradio"),r.setAttribute(c.ARIA_CHECKED,"false"),r.addEventListener("click",(function(r){t.setPlaybackSpeed(e),r.stopImmediatePropagation(),2!==t.positioningStrategy&&3!==t.positioningStrategy&&t.resetCaptionsOverlap(),t.speedButton.focus()})),r.addEventListener("keydown",(function(r){"Spacebar"!==r.key&&" "!==r.key&&"Enter"!==r.key||(t.setPlaybackSpeed(e),t.speedButton.focus(),r.preventDefault(),r.stopImmediatePropagation())})),r.addEventListener("mouseenter",(function(){t.showOptionFocus(r,1)})),r.addEventListener("focusin",(function(){t.showOptionFocus(r,1)})),r.addEventListener("mouseleave",(function(){t.hideOptionFocus(r)})),r.addEventListener("focusout",(function(e){t.hideOptionFocus(r),e.stopImmediatePropagation()})),t.speedMenu.appendChild(r)},i=0;i<c.PLAYBACK_SPEEDS.length;i+=1)r(i);this.speedMenu.addEventListener("focusout",(function(e){e.stopImmediatePropagation()})),this.speedMenuDiv.addEventListener("wheel",(function(e){e.preventDefault();var r=Date.now();t.lastScrollTime+c.MENU_SCROLL_WAIT<r&&(t.speedMenuDiv.scrollTop+=e.deltaY>0?Math.min(e.deltaY,c.MENU_SCROLL_INCREMENT):Math.max(e.deltaY,-c.MENU_SCROLL_INCREMENT),t.lastScrollTime=r)})),e.appendChild(this.speedMenuDiv),this.autoMenuWidthHeight||this.speedMenuDiv.appendChild(this.speedMenu),this.createMenuCheckmark(1),(0,g.setInvisibleClass)(this.speedCheckmark),this.speedMenu.appendChild(this.speedCheckmark)}},{key:"createFullscreenControl",value:function(e){var t=this;this.fullscreenButton=w("button","fullscreen"),this.fullscreenButton.type="button",this.fullscreenButton.setAttribute(c.ARIA_LABEL,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.fullScreenButtonStr:"Full screen");var r=(0,u.getIconSvg)("fullscreen-gfxicon");this.fullscreenButton.appendChild(r),this.fullscreenButton.addEventListener("click",(function(){return t.onFullscreenClick()})),this.fullscreenButton.addEventListener("keydown",(function(e){"Spacebar"===e.key||" "===e.key||"Enter"===e.key?t.onFullscreenClick():t.nestedTabbingEnabled&&("ArrowLeft"===e.key?t.setPreviousArrowFocus(t.fullscreenButton,e):"ArrowRight"!==e.key&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())})),e.appendChild(this.fullscreenButton)}},{key:"setFullscreenIcon",value:function(e){var t=this.fullscreenButton.querySelector("#fullscreen-enter-gfxicon"),r=this.fullscreenButton.querySelector("#fullscreen-exit-gfxicon");null!==t&&null!==r?e?((0,g.removeInvisibleClass)(r),(0,g.setInvisibleClass)(t)):((0,g.removeInvisibleClass)(t),(0,g.setInvisibleClass)(r)):(d.Log.warn(509346561,"PlayerControls.setFullscreenIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectFullscreenIcon"))}},{key:"getTooltip",value:function(e){if(void 0===this.mediaControlInfo.tooltipMap)return e.toString();var t=this.mediaControlInfo.tooltipMap.get(e);if(void 0===t||void 0===this.mediaCallbacks)return e.toString();var r=this.mediaCallbacks.isPresenterCallback();return void 0===r?t.noRole:r?t.presenter:t.attendee}},{key:"setProgressForScreenReader",value:function(){if(void 0!==this.mediaInfo.screenReaderInfo){var e=(0,g.formatTimeForScreenReader)(this.videoElement.currentTime,this.mediaInfo.screenReaderInfo),t=(0,g.formatTimeForScreenReader)(this.videoElement.duration,this.mediaInfo.screenReaderInfo),r=this.mediaInfo.screenReaderInfo.progressStr.replace("{0}",e).replace("{1}",t);this.progressBar.setAttribute(c.ARIA_VALUETEXT,r)}}},{key:"shouldHideTimeControls",value:function(){if(void 0===this.mediaControlInfo.controlHidingEnabled||!this.mediaControlInfo.controlHidingEnabled||void 0===this.mediaControlInfo.widthThresholdForHidingControls)return!1;var e=!1;return this.volumeSliderEnabled&&(e=this.mediaControlInfo.size.x<this.mediaControlInfo.widthThresholdForHidingControls-(this.speedButtonEnabled?0:c.BUTTON_SIZE)-(this.captionsButtonVisible?0:c.BUTTON_SIZE)),e}}]);t.PlaybackControls=P},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.isInHighContrastMode=function(){return window.matchMedia("screen and (forced-colors: active)").matches},t.localStorgateSetItemWithExpiration=function(e,t,r){var i;try{i=JSON.stringify({value:t,expiration:r.toISOString()})}catch(e){return}window.localStorage.setItem(e,i)},t.localStorgateGetItemWithExpiration=function(e){var t,r=localStorage.getItem(e);if(null===r)return null;try{t=JSON.parse(r)}catch(t){return localStorage.removeItem(e),null}return!Number.isInteger(t.expiration)&&Number.isNaN(Date.parse(t.expiration))||new Date(t.expiration)<=new Date?(localStorage.removeItem(e),null):t.value},t.filterBIUInternal=s,t.filterBIU=function(e,t){var r=new DOMParser;t.replaceChildren(r.parseFromString(e,"text/html").body),s(t)};var n=i(r(18));function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var o=["B","I","U"];function s(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}(e.childNodes);try{var i=function(){var e=t.value;if(e.nodeType===Node.ELEMENT_NODE){s(e);var r=e;o.indexOf(e.nodeName.toUpperCase())>=0?(0,n.default)(r.attributes).forEach((function(e){return r.removeAttribute(e.name)})):r.replaceWith.apply(r,(0,n.default)(r.childNodes))}};for(r.s();!(t=r.n()).done;)i()}catch(e){r.e(e)}finally{r.f()}}},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MediaType=void 0,t.MediaType=i,function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.GIF=2]="GIF",e[e.StreamClassic=3]="StreamClassic",e[e.YouTube=4]="YouTube",e[e.Vimeo=5]="Vimeo",e[e.Flip=6]="Flip",e[e.Ted=7]="Ted",e[e.Stream2=8]="Stream2",e[e.SlideShare=9]="SlideShare",e[e.Other=10]="Other"}(i||(t.MediaType=i={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BaseMediaPlaybackTracker=void 0;var n=i(r(1)),a=i(r(2)),o=r(114),s=r(17),l=r(315),c=(0,a.default)((function e(t,r,i,a,s){(0,n.default)(this,e),this.isPlaying=!1;var c=(0,o.v4)();this.baseData={requestGuid:c,providerName:r,loggableMediaId:i,mediaType:a},this.vetoHandler=new l.MediaPlaybackVetoes(t,c,r,i,s)}),[{key:"setLoggableId",value:function(e){this.baseData.loggableMediaId=e,this.vetoHandler.setLoggableId(e)}},{key:"setProviderName",value:function(e){this.baseData.providerName=e,this.vetoHandler.setProviderName(e)}},{key:"setMediaType",value:function(e){this.baseData.mediaType=e}},{key:"setTimeOfCreation",value:function(){this.baseData.timeOfCreation=Date.now()}},{key:"setUiHostType",value:function(e){this.baseData.uiHostType=e}},{key:"setFlights",value:function(e){this.baseData.flights=e}},{key:"onLoadStart",value:function(){this.logEvent("loadstart"),void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now(),this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}},{key:"onCanPlay",value:function(){this.logEvent("canplay"),void 0===this.baseData.timeOfCanPlay&&(this.baseData.timeOfCanPlay=Date.now(),this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}},{key:"onSourceSet",value:function(){this.logEvent("sourceset"),void 0===this.baseData.timeOfSourceSet&&(this.baseData.timeOfSourceSet=Date.now())}},{key:"onPlayRequested",value:function(){this.logEvent("playrequested"),void 0===this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=Date.now())}},{key:"onPlay",value:function(){this.logEvent("play"),void 0===this.baseData.timeOfPlay&&(this.baseData.timeOfPlay=Date.now(),this.baseData.timeOfPlaying=void 0),this.lastPlayingTime=void 0}},{key:"onPlaying",value:function(){this.logEvent("playing"),void 0===this.baseData.timeOfPlaying&&(this.baseData.timeOfPlaying=Date.now(),void 0!==this.baseData.timeOfPlayRequest&&this.vetoHandler.logIfSlowPlaybackStart(this.baseData.timeOfPlaying-this.baseData.timeOfPlayRequest)),this.isPlaying=!0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}},{key:"onPlayCommand",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.logEvent("playcommand"),void 0===this.baseData.timeOfPlaying&&void 0===this.baseData.timeOfPlayRequest){if(this.baseData.timeOfPlayRequest=Date.now(),this.vetoHandler.hasCriticalError())return void this.vetoHandler.logPlaybackFailure();if(t){var r=function(){return e.baseData.timeOfPlaying};this.vetoHandler.setVideoNotPlayedTimeout(r)}}}},{key:"onStopCommand",value:function(){this.logEvent("stopcommand"),void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}},{key:"onPause",value:function(){this.logEvent("pause"),this.isPlaying=!1,this.calculatePlayingTime()}},{key:"onEnded",value:function(){this.logEvent("ended"),this.isPlaying=!1,this.baseData.wasPlayedUntilEnd=!0,this.calculatePlayingTime()}},{key:"onVolumeChanged",value:function(e){this.logEvent("volumeChanged"),this.baseData.lastVolume=e}},{key:"onMuteChanged",value:function(e){this.logEvent("muteChanged"),this.baseData.lastMuteState=e}},{key:"onBuffering",value:function(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}},{key:"onError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.logEvent("error"),this.vetoHandler.onError(e,t,this.isPlaying,this.baseData.timeOfPlaying,this.baseData.timeOfPlayRequest,this.baseData.timeOfCanPlay)}},{key:"cleanup",value:function(){this.baseData.timeOfSourceSet=void 0,this.baseData.timeOfLoadStart=void 0,this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlayRequest=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0,this.baseData.timeOfError=void 0,this.baseData.totalPlayingTime=0,this.baseData.totalBufferingTime=0,this.baseData.lastVolume=void 0,this.baseData.lastMuteState=void 0,this.baseData.wasPlayedUntilEnd=void 0,this.baseData.errorName=void 0,this.baseData.errorMessage=void 0,this.baseData.wasVetoLogged=void 0,this.isPlaying=!1,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.vetoHandler.cleanup(),this.baseData.requestGuid=(0,o.v4)(),this.vetoHandler.setCorrelationId(this.baseData.requestGuid)}},{key:"getPlaybackData",value:function(){var e=this.vetoHandler.getError();return this.baseData.errorName=null==e?void 0:e.name,this.baseData.errorMessage=null==e?void 0:e.message,this.baseData.timeOfError=null==e?void 0:e.timestamp,this.baseData.wasVetoLogged=this.vetoHandler.wasVetoLogged,this.calculatePlayingTime(),this.calculateBufferingTime(),this.baseData}},{key:"getCorrelationId",value:function(){var e;return null!==(e=this.baseData.requestGuid)&&void 0!==e?e:""}},{key:"setViewDimensions",value:function(e,t){this.baseData.viewWidth=e,this.baseData.viewHeight=t}},{key:"setMediaId",value:function(e){this.baseData.loggableMediaId=e}},{key:"setDuration",value:function(e){this.baseData.duration=e}},{key:"setVolume",value:function(e){this.baseData.lastVolume=e}},{key:"setIsMuted",value:function(e){this.baseData.lastMuteState=e}},{key:"logEvent",value:function(e){s.Log.info(508704415,"Media emitted event: ".concat(JSON.stringify({event:e,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid})))}},{key:"calculateBufferingTime",value:function(){if(void 0!==this.lastBufferTime){var e=Date.now()-this.lastBufferTime;void 0===this.baseData.totalBufferingTime&&(this.baseData.totalBufferingTime=0),this.baseData.totalBufferingTime+=e,this.lastBufferTime=void 0}}},{key:"calculatePlayingTime",value:function(){if(void 0!==this.lastPlayingTime){var e=Date.now()-this.lastPlayingTime;void 0===this.baseData.totalPlayingTime&&(this.baseData.totalPlayingTime=0),this.baseData.totalPlayingTime+=e,this.lastPlayingTime=void 0}}}]);t.BaseMediaPlaybackTracker=c},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)};var n=new Uint8Array(16)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){function i(e,i,o,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof i&&(i=(0,a.default)(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var l=new Uint8Array(16+e.length);if(l.set(i),l.set(e,i.length),(l=r(l))[6]=15&l[6]|t,l[8]=63&l[8]|128,o){s=s||0;for(var c=0;c<16;++c)o[s+c]=l[c];return o}return(0,n.default)(l)}try{i.name=e}catch(e){}return i.DNS=o,i.URL=s,i},t.URL=t.DNS=void 0;var n=i(r(91)),a=i(r(163)),o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=o;var s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(92));t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setAttributes=function(e,t){for(var r=0,i=Object.entries(t);r<i.length;r++){var a=(0,n.default)(i[r],2),o=a[0],s=a[1];e.setAttribute(o,s)}};var n=i(r(19))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Stream2=void 0;var n=i(r(6)),a=i(r(5)),o=i(r(1)),s=i(r(2)),l=r(24),c=r(114),u=r(65),d=r(115),h=r(17),f=r(166),m=r(329),p=r(43),g=r(44),v=function(){function e(t,r,i,n,a,s,l){var c=this;(0,o.default)(this,e),this.paused=!0,this.currentTime=0,this.oEmbedRequestRetried=!1,this.navigatedToEmbedUrl=!1,this.initPostMessageCommunication=function(e){var t,r,i,n=(null===(t=c.embedURL)||void 0===t?void 0:t.origin)===e.origin,a=c.channelId===e.data.channelId;if(n&&a&&"initialize"===e.data.type)try{e.data.replyTo.onmessage=function(e){return c.onMessage(e)},e.data.replyTo.postMessage({type:"activate"}),c.messagePort=e.data.replyTo,null===(i=c.playbackTracker)||void 0===i||i.onPostMessagingInitialized()}catch(e){void 0!==c.playbackTracker&&c.playbackTracker.onError("Post Messaging Error - Error initializing communication channel (".concat(e.message,")"),!0)}else h.Log.warn(508371414,"Message failed source verification: ".concat(JSON.stringify({isOriginMatching:n,isChannelMatching:a,messageType:e.data.type,correlationId:null===(r=c.playbackTracker)||void 0===r?void 0:r.getCorrelationId()})))},this.videoUrl=t,this.appSettings=i,this.parentElement=r,this.playbackTracker=n,this.onReadyCallback=a,this.onMediaEventCallback=s,e.tokenRequestor.updateSettings(i,l);try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream 2.0 video client: ".concat(e.message),!0)}}return(0,s.default)(e,[{key:"play",value:function(){this.postMessage({command:"one-player-play"})}},{key:"pause",value:function(){this.postMessage({command:"one-player-pause"})}},{key:"stop",value:function(){this.postMessage({command:"one-player-stop"})}},{key:"seekTo",value:function(e){this.postMessage({command:"one-player-seek",position:e})}},{key:"togglePause",value:function(){this.paused?this.play():this.pause()}},{key:"setMute",value:function(){!0!==this.muted&&this.postMessage({command:"one-player-mute"})}},{key:"setUnMute",value:function(){!1!==this.muted&&this.postMessage({command:"one-player-unmute"})}},{key:"setVolume",value:function(e){var t=Math.min(Math.max(e,0),1);this.postMessage({command:"one-player-set-volume",volumeLevel:t})}},{key:"getVolume",value:function(){return this.volume}},{key:"ensureMediaClient",value:function(){this.cleanUpMediaClient(),this.init()}},{key:"cleanUpMediaClient",value:function(){e.tokenRequestor.cancelAllIfPending(this),void 0!==this.oEmbedRequestRetryTimeout&&window.clearTimeout(this.oEmbedRequestRetryTimeout),void 0!==this.stream2iFrame&&this.stream2iFrame.remove(),void 0!==this.errorMessageDiv&&this.errorMessageDiv.remove(),this.paused=!0,this.currentTime=0,this.muted=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.messagePort=void 0,this.stream2iFrame=void 0,this.oEmbedResponseTimeStamp=void 0,this.oEmbedRequestRetried=!1,this.oEmbedRequestRetryTimeout=void 0,this.channelId=void 0,this.navigatedToEmbedUrl=!1,this.embedURL=void 0,this.errorMessageDiv=void 0,window.removeEventListener("message",this.initPostMessageCommunication),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}},{key:"isPaused",value:function(){return this.paused}},{key:"isMuted",value:function(){return this.muted}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.duration}},{key:"setVisible",value:function(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="visible"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="visible")}},{key:"setHidden",value:function(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="hidden"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="hidden")}},{key:"getPlayer",value:function(){return this.stream2iFrame}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"onTokenSet",value:function(e,t){switch(e){case f.AppId.hubble:this.onHubbleTokenSet(t);break;default:h.Log.error(509194507,"Unknown appId: ".concat(e.name))}}},{key:"showErrorMessage",value:function(e){this.errorMessageDiv=document.createElement("div"),this.errorMessageDiv.style.backgroundColor="black",this.errorMessageDiv.style.justifyContent="center",this.errorMessageDiv.style.alignItems="center",this.errorMessageDiv.style.color="white",this.errorMessageDiv.style.fontSize="10",this.errorMessageDiv.style.borderRadius="5",this.errorMessageDiv.style.display="flex",this.errorMessageDiv.style.textAlign="center",this.errorMessageDiv.textContent=e,(0,u.setDefaultStyles)(this.errorMessageDiv),this.parentElement.append(this.errorMessageDiv)}},{key:"onHubbleTokenSet",value:function(e){var t;null===(t=this.playbackTracker)||void 0===t||t.onHubbleTokenSet(),this.initOnePlayer(e)}},{key:"postMessage",value:function(e){var t;null===(t=this.messagePort)||void 0===t||t.postMessage({type:"command",id:0,data:e})}},{key:"onMessage",value:function(e){var t=e.data.type;"notification"===t?this.handleNotificationMessage(e.data):"result"===t?this.handleResultMessage(e.data):"command"===t?this.handleCommandMessage(e.data):"acknowledge"===t||h.Log.warn(509219079,"Received unrecognized postmessage (type: ".concat(t,")"))}},{key:"handleCommandMessage",value:function(e){if("getToken"===e.data.command){h.Log.warn(508924038,"Received unexpected getToken request from OnePlayer (type: ".concat(e.data.tokenType,")"));var t={type:"result",id:e.id,data:{result:"error",isExpected:!0,error:{code:"",message:"Token request not supported"}}};void 0!==this.messagePort&&this.messagePort.postMessage(t)}}},{key:"handleResultMessage",value:function(e){if("error"!==e.data.result)void 0!==e.data.durationInSeconds?(this.duration=e.data.durationInSeconds,void 0!==this.playbackTracker&&this.playbackTracker.setDuration(this.duration)):void 0!==e.data.volume?(this.volume=e.data.volume,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playbackTracker&&this.playbackTracker.setVolume(this.volume)):void 0!==e.data.isMute?(this.muted=e.data.isMute,void 0!==this.playbackTracker&&this.playbackTracker.setIsMuted(this.muted)):h.Log.warn(509215635,"Unrecognized result type received (type: ".concat(e.data.result,")"));else{var t=e.data;h.Log.error(509437569,"OnePlayer Error - Result: ".concat(t.error.code," (").concat(t.error.message,")"))}}},{key:"handleNotificationMessage",value:function(e){var t;switch(e.data.notification){case"one-player-player-ready":e.data.isReady&&this.onReady(e.data.ttlMs);break;case"one-player-play-state":var r=e.data.playState;this.onPlayStateChanged(r);break;case"one-player-current-time":var i=this.currentTime;this.currentTime=e.data.currentTime,Math.abs(this.currentTime-i)>2&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"one-player-muted":if(this.muted=e.data.isMuted,!this.muted){var n=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(n,.022))}void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playbackTracker&&this.playbackTracker.onMuteChanged(this.muted);break;case"one-player-volume":this.volume=e.data.volume,0===this.volume?this.setMute():this.lastNonZeroVolume=this.volume,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume);break;case"error":case"one-player-fatal-playback-error":null===(t=this.playbackTracker)||void 0===t||t.onError("OnePlayer Error - Notification: ".concat(JSON.stringify(e.data)),!0);break;default:h.Log.warn(509437568,"Unrecognized notification type received (type: ".concat(e.data.notification,")"))}}},{key:"onReady",value:function(e){this.postMessage({command:"one-player-get-duration"}),this.postMessage({command:"one-player-get-volume"}),this.postMessage({command:"one-player-get-mute"}),void 0!==this.playbackTracker&&void 0!==e&&this.playbackTracker.onODSPVideoLoad(e),void 0!==this.playbackTracker&&this.playbackTracker.onCanPlay(),void 0!==this.onReadyCallback&&this.onReadyCallback()}},{key:"onPlayStateChanged",value:function(e){this.paused="Playing"!==e,"Playing"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()):"Paused"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0),void 0!==this.playbackTracker&&this.playbackTracker.onPause()):"Ended"===e&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6),void 0!==this.playbackTracker&&this.playbackTracker.onEnded())}},{key:"init",value:function(){var t;this.stream2iFrame=document.createElement("iframe"),this.setProperties(this.stream2iFrame),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),e.tokenRequestor.request(f.AppId.hubble,this)}},{key:"initOnePlayer",value:function(e){var t=this;this.initOEmbedIFrame(e).then((function(){void 0!==t.messagePort&&h.Log.info(508432459,"Cross-window communication channel is already initialized")})).catch((function(e){void 0!==t.playbackTracker&&t.playbackTracker.onError("Init iFrame Error - Error creating iFrame from OEmbed response (".concat(e.message,")"))}))}},{key:"initOEmbedIFrame",value:function(e){var t,r;return(0,l.__awaiter)(this,void 0,void 0,n.default.mark((function i(){var a,o,s,l,c,u,h=this;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,d.requestHubbleMediaOEmbed)(this.videoUrl,{aadToken:e,apiBaseUrl:this.appSettings.HubbleVideoEndpoint,app:this.appSettings.App,appPlatform:this.appSettings.AppPlatform,correlationId:void 0!==this.playbackTracker?this.playbackTracker.getCorrelationId():this.appSettings.AppCorrelation,acceptLanguage:this.appSettings.AcceptLanguage});case 3:a=i.sent,i.next=26;break;case 6:if(i.prev=6,i.t0=i.catch(0),!g.Settings.getBoolean("retryOEmbedRequestIf429")||this.oEmbedRequestRetried){i.next=20;break}if(!((o=i.t0.message).indexOf("status: 429")>-1)){i.next=20;break}if(s=o.match(/Retry-After:\s*(\d+)/),l=null!==s&&2===s.length?parseFloat(s[1]):void 0,c=11.5,void 0!==g.Settings.getNumber("retryOEmbedRequestIf429Threshold")&&(c=g.Settings.getNumber("retryOEmbedRequestIf429Threshold")),!(void 0!==l&&l<=c)){i.next=20;break}return this.oEmbedRequestRetried=!0,this.oEmbedRequestRetryTimeout=window.setTimeout((function(){return h.initOnePlayer(e)}),1e3*l),null===(t=this.playbackTracker)||void 0===t||t.onError("OEmbed Request Error - status: 429 (will retry request in ".concat(l,"s)")),i.abrupt("return");case 20:return u=p.HUBBLE_404_ERROR_MESSAGE,void 0!==this.appSettings.LocalizedHubble404ErrorMessage&&(u=this.appSettings.LocalizedHubble404ErrorMessage),i.t0 instanceof d.HubbleError&&(u=this.getErrorMessage(i.t0.statusCode)),this.showErrorMessage(u),null===(r=this.playbackTracker)||void 0===r||r.onError("OEmbed Request Error - ".concat(i.t0.message),!0),i.abrupt("return");case 26:void 0!==this.playbackTracker&&this.playbackTracker.onOEmbedResponse(),this.setOEmbedURL(a);case 28:case"end":return i.stop()}}),i,this,[[0,6]])})))}},{key:"setOEmbedURL",value:function(e){var t=this;if(void 0===e.embed_url)return void 0!==this.playbackTracker&&this.playbackTracker.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void this.showErrorMessage(p.HUBBLE_404_ERROR_MESSAGE);this.oEmbedResponseTimeStamp=Date.now(),this.embedURL=new URL(e.embed_url);var r=this.embedURL.searchParams.get("access_token");if(void 0!==this.stream2iFrame&&null!==r){this.embedURL.searchParams.delete("access_token"),this.embedURL.searchParams.set("auth","readwrite");var i="PowerPointLive"===this.appSettings.hostView;i&&this.embedURL.searchParams.set("forceMeta","1"),this.channelId=(0,c.v4)(),this.embedURL.searchParams.set("origin",new URL(location.href).origin),this.embedURL.searchParams.set("channelId",this.channelId),this.embedURL.searchParams.set("embed",JSON.stringify((0,a.default)((0,a.default)((0,a.default)((0,a.default)((0,a.default)((0,a.default)((0,a.default)((0,a.default)({},"hp","Web"),"hv",this.appSettings.hostView),"hc",this.appSettings.hostComponent),"ha",this.appSettings.App),"hsi",void 0!==this.playbackTracker?this.playbackTracker.getCorrelationId():this.appSettings.AppCorrelation),"af",!1),"disableHybrid",i),"ol",this.appSettings.AcceptLanguage)));var n=new URL(this.videoUrl).searchParams.get("nav");null!==n&&this.embedURL.searchParams.set("nav",n),this.stream2iFrame.setAttribute("allow","autoplay ".concat(this.embedURL.origin)),this.stream2iFrame.addEventListener("load",(function(){return t.onStream2iFrameLoad(r)})),this.parentElement.append(this.stream2iFrame)}}},{key:"onStream2iFrameLoad",value:function(e){var t,r;if(g.Settings.getBoolean("navigateToEmbedIfIFrameIsBlank")){if(!this.stream2iFrame||"about:blank"!==(null===(t=this.stream2iFrame.contentDocument)||void 0===t?void 0:t.location.href))return}else if(this.navigatedToEmbedUrl)return;void 0===this.oEmbedResponseTimeStamp||Date.now()-this.oEmbedResponseTimeStamp>=24e4?this.ensureMediaClient():void 0!==this.embedURL&&void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&(window.addEventListener("message",this.initPostMessageCommunication),this.navigateToEmbedUrl(this.stream2iFrame.contentWindow,this.embedURL,e),this.navigatedToEmbedUrl=!0,null===(r=this.playbackTracker)||void 0===r||r.onNavigatedToEmbedPage())}},{key:"getErrorMessage",value:function(e){return 400===e?void 0!==this.appSettings.LocalizedHubble400ErrorMessage?this.appSettings.LocalizedHubble400ErrorMessage:p.HUBBLE_400_ERROR_MESSAGE:404===e?void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:p.HUBBLE_404_ERROR_MESSAGE:403===e?void 0!==this.appSettings.LocalizedHubble403ErrorMessage?this.appSettings.LocalizedHubble403ErrorMessage:p.HUBBLE_403_ERROR_MESSAGE:500===e||503===e||429===e?void 0!==this.appSettings.LocalizedHubble500ErrorMessage?this.appSettings.LocalizedHubble500ErrorMessage:p.HUBBLE_500_ERROR_MESSAGE:void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:p.HUBBLE_404_ERROR_MESSAGE}},{key:"navigateToEmbedUrl",value:function(e,t,r){var i=e.document.createElement("form");i.setAttribute("action",t.toString()),i.setAttribute("method","POST");var n=e.document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","access_token"),n.setAttribute("value",r),i.appendChild(n),e.document.body.appendChild(i),i.submit()}},{key:"setProperties",value:function(e){e.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms allow-top-navigation-by-user-activation allow-downloads"),(0,u.setDefaultStyles)(e),e.style.border="0px",this.setVisible()}}],[{key:"setAADTokenForWaitingClients",value:function(t){e.tokenRequestor.setAADToken(t)}}])}();t.Stream2=v,v.tokenRequestor=new m.TokenRequestor},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AppId=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t,r){(0,n.default)(this,e),this._name=t,this._guid=r}),[{key:"name",get:function(){return this._name}},{key:"guid",get:function(){return this._guid}}]);t.AppId=a,a.graph=new a("Graph","00000003-0000-0000-c000-000000000000"),a.hubble=new a("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d"),a.all=[a.graph,a.hubble]},function(e,t,r){"use strict";var i=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.createSvgPlayButton=function(e){var t=s("svg");t.setAttribute("viewBox","-1 -1 2 2"),t.setAttribute("role","button"),t.setAttribute(n.ARIA_LABEL,null!=e?e:"Play"),(0,a.setStyles)(t,{height:"".concat(n.PLAYBUTTON_LENGTH,"px"),width:"".concat(n.PLAYBUTTON_LENGTH,"px"),position:"absolute",zIndex:"".concat(n.VIDEO_Z_INDEX),top:"calc(50% - ".concat(n.PLAYBUTTON_LENGTH/2,"px)"),left:"calc(50% - ".concat(n.PLAYBUTTON_LENGTH/2,"px)"),cursor:"pointer",pointerEvents:"all"});var r=s("circle");r.setAttribute("cx","0"),r.setAttribute("cy","0"),r.setAttribute("r","1"),r.setAttribute("fill","#404040");var i=s("path");return i.setAttribute("d","M.5 0 L-.25 -.5 L-.25 .5 Z"),i.setAttribute("fill","none"),i.setAttribute("stroke","white"),i.setAttribute("stroke-width",".05"),i.setAttribute("opacity",".5"),t.appendChild(r),t.appendChild(i),t},t.createEditorSvgPlayButton=function(e,t){var r=s("svg");!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?r.setAttribute("viewBox","-48 -48 96 96"):r.setAttribute("viewBox","-30 -30 60 60"),r.setAttribute("role","button"),r.setAttribute(n.ARIA_LABEL,null!=t?t:"Play"),!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?(0,a.setStyles)(r,{height:"".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH,"px"),width:"".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH,"px"),position:"absolute",zIndex:"".concat(n.VIDEO_Z_INDEX),top:"calc(50% - ".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH/2,"px)"),left:"calc(50% - ".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH/2,"px)"),cursor:"pointer",pointerEvents:"all"}):(0,a.setStyles)(r,{height:"".concat(n.EDITOR_PLAYBUTTON_LENGTH,"px"),width:"".concat(n.EDITOR_PLAYBUTTON_LENGTH,"px"),position:"absolute",zIndex:"".concat(n.VIDEO_Z_INDEX),top:"calc(50% - ".concat(n.EDITOR_PLAYBUTTON_LENGTH/2,"px)"),left:"calc(50% - ".concat(n.EDITOR_PLAYBUTTON_LENGTH/2,"px)"),cursor:"pointer",pointerEvents:"all"}),r.setAttribute("fill","none");var i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("filter","url(#filter0_b_4190_2652)");var l=s("circle");l.setAttribute("id","circle1"),l.setAttribute("cx","0"),l.setAttribute("cy","0"),!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?l.setAttribute("r","40"):l.setAttribute("r","28.3"),l.setAttribute("fill","black"),l.setAttribute("fill-opacity","0.42");var c=s("circle");c.setAttribute("id","circle2"),c.setAttribute("cx","0"),c.setAttribute("cy","0"),!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?c.setAttribute("r","39.5"):c.setAttribute("r","27.5"),c.setAttribute("stroke","white"),c.setAttribute("stroke-opacity","0.42");var u=s("path");!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?u.setAttribute("d","M8 11.2761C8 8.0368 11.4656 5.97709 14.3109 7.52531L37.7709 20.2903C40.743 21.9075 40.743 26.1745 37.7709 27.7918L14.3109 40.5568C11.4656 42.1049 8 40.0452 8 36.806V11.2761Z"):u.setAttribute("d","M5.6 7.85427C5.6 5.62576 8.02512 4.21299 9.99663 5.26774L26.43963 14.20121C28.1361 15.29325 28.1361 17.64875 26.43963 18.74079L9.99663 27.67426C8.02512 28.72901 5.6 27.31624 5.6 25.08773V7.85427Z"),u.setAttribute("fill","white"),!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?u.setAttribute("transform","translate(-20, -24)"):u.setAttribute("transform","translate(-15, -16.5)"),i.appendChild(l),i.appendChild(c),i.appendChild(u);var d=document.createElementNS("http://www.w3.org/2000/svg","defs"),h=document.createElementNS("http://www.w3.org/2000/svg","filter");h.setAttribute("id","filter0_b_4190_2652"),!0===e.playButtonIconUpdateEnabled||o.Settings.getBoolean("PlayButtonIconUpdateEnabled")?(h.setAttribute("x","".concat(-n.EDITOR_UPDATED_PLAYBUTTON_LENGTH/2)),h.setAttribute("y","".concat(-n.EDITOR_UPDATED_PLAYBUTTON_LENGTH/2)),h.setAttribute("width","".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH)),h.setAttribute("height","".concat(n.EDITOR_UPDATED_PLAYBUTTON_LENGTH))):(h.setAttribute("x","".concat(-n.EDITOR_PLAYBUTTON_LENGTH/2)),h.setAttribute("y","".concat(-n.EDITOR_PLAYBUTTON_LENGTH/2)),h.setAttribute("width","".concat(n.EDITOR_PLAYBUTTON_LENGTH)),h.setAttribute("height","".concat(n.EDITOR_PLAYBUTTON_LENGTH))),h.setAttribute("filterUnits","userSpaceOnUse"),h.setAttribute("color-interpolation-filters","sRGB");var f=s("feFlood");f.setAttribute("flood-opacity","0"),f.setAttribute("result","BackgroundImageFix");var m=s("feGaussianBlur");m.setAttribute("in","BackgroundImageFix"),m.setAttribute("stdDeviation","2");var p=s("feComposite");p.setAttribute("in2","SourceAlpha"),p.setAttribute("operator","in"),p.setAttribute("result","effect1_backgroundBlur_4204_2652");var g=s("feBlend");return g.setAttribute("mode","normal"),g.setAttribute("in","SourceGraphic"),g.setAttribute("in2","effect1_backgroundBlur_4204_2652"),g.setAttribute("result","shape"),h.appendChild(f),h.appendChild(m),h.appendChild(p),h.appendChild(g),d.appendChild(h),r.appendChild(i),r.appendChild(d),r};var n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=i(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(r(43)),a=r(75),o=r(44);function s(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlaybackPerf=void 0;var n=i(r(2)),a=i(r(1)),o=r(49),s=r(25),l=r(4),c=r(11),u=r(169),d=r(3),h=(0,n.default)((function e(){(0,a.default)(this,e),this.totalBufferingTime=0,this.totalPlayingTime=0})),f=function(){function e(t,r,i,n,c,u,d,f,m,p,g,v,y){(0,a.default)(this,e),this.isOnSlide=!1,this.isPlaying=!1,this.isStalled=!1,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.wasNavigatingFrom=!1,this.player=t,this.creationTime=Date.now(),this.minTimeAfterAction=l.Settings.readNumberOrDefault("minTimeAfterActionForVideoVeto",5e3),this.summary=new h,this.summary.uiHostType=o.UIHostType[n];var _={hlsJsFirst:l.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1),useLoadedMetadata:l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0),iOSPreload:l.Settings.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:l.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:l.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};this.summary.flights=JSON.stringify(_),c&&(this.summary.mediaType=u===s.MediaType.Video?"Video":"Audio",c.autoPlay&&(this.summary.isAutoPlay=!0),c.fullscreen&&(this.summary.fullscreen=!0),c.hideWhenStopped&&(this.summary.hideWhenStopped=!0),c.narration&&(this.summary.isNarration=!0),c.playAcrossSlides>0&&(this.summary.playAcrossSlides=c.playAcrossSlides),c.trimStartMs>0&&(this.summary.trimStartMs=c.trimStartMs),c.trimEndMs>0&&(this.summary.trimEndMs=c.trimEndMs),c.volume>0&&(this.summary.volume=c.volume),void 0!==c.repeat&&0!==c.repeat&&(this.summary.repeat=c.repeat),c.contentType&&(this.summary.contentType=c.contentType)),p&&(this.summary.mediaType="GIF",this.summary.isGif=!0,this.summary.isAutoPlay=!0,this.summary.repeat=-1),this.summary.slideNumber=d,this.summary.startFromTime=f,this.summary.initTime=m,this.summary.initialRetryCount=g,v&&(this.summary.isPrefetch=!0),this.pixelScale=r,this.addPlayerEventListeners(n),this.addSlideEventListeners(i),y&&(this.summary.teamsCallId=y)}return(0,n.default)(e,[{key:"addPlayerEventListeners",value:function(t){var r=this;this.player.addEventListener("loadstart",(function(){e.logEvent("loadstart",r.summary.mediaName),r.isFirstLoadStart&&(r.isFirstLoadStart=!1,r.summary.timeToLoadStartMs=Date.now()-r.creationTime,r.summary.timeToLoadedMetadataMs=void 0,r.summary.timeToInteractivityMs=void 0,r.summary.timeToCanPlayThroughMs=void 0,r.summary.timeToPlayMs=void 0,r.summary.timeToPlayingMs=void 0)})),this.player.addEventListener("loadedmetadata",(function(){e.logEvent("loadedmetadata",r.summary.mediaName),r.isFirstLoadedMetadata&&(r.isFirstLoadedMetadata=!1,r.summary.timeToLoadedMetadataMs=Date.now()-r.creationTime,e.useLoadedMetadataAsInteractivityEvent(t)?r.summary.timeToInteractivityMs=r.summary.timeToLoadedMetadataMs:r.summary.timeToInteractivityMs=void 0,r.summary.timeToPlayMs=void 0,r.summary.timeToPlayingMs=void 0,r.summary.durationMs=Math.round(1e3*r.player.duration),"Video"!==r.summary.mediaType&&"Audio"===r.summary.mediaType||(r.summary.sourceVideoWidth=r.player.videoWidth,r.summary.sourceVideoHeight=r.player.videoHeight,r.summary.width=Math.round(r.player.width*r.pixelScale.x),r.summary.height=Math.round(r.player.height*r.pixelScale.y)))})),this.player.addEventListener("canplay",(function(){e.logEvent("canplay",r.summary.mediaName),r.isFirstCanPlay&&r.isFirstCanPlayThrough&&(e.useLoadedMetadataAsInteractivityEvent(t)||(r.summary.timeToInteractivityMs=Date.now()-r.creationTime,r.summary.timeToPlayMs=void 0,r.summary.timeToPlayingMs=void 0)),r.isFirstCanPlay&&(r.isFirstCanPlay=!1,r.isFirstCanPlayThrough||d.ULS.sendTraceTag(540137693,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: ".concat(r.summary.mediaName)))})),this.player.addEventListener("canplaythrough",(function(){e.logEvent("canplaythrough",r.summary.mediaName),r.isFirstCanPlay&&r.isFirstCanPlayThrough&&(e.useLoadedMetadataAsInteractivityEvent(t)||(r.summary.timeToInteractivityMs=Date.now()-r.creationTime,r.summary.timeToPlayMs=void 0,r.summary.timeToPlayingMs=void 0)),r.isFirstCanPlayThrough&&(r.isFirstCanPlayThrough=!1,r.summary.timeToCanPlayThroughMs=Date.now()-r.creationTime,r.isFirstCanPlay&&d.ULS.sendTraceTag(540137694,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: ".concat(r.summary.mediaName)))})),this.player.addEventListener("play",(function(){r.checkPlayerNotReady("play"),e.logEvent("play",r.summary.mediaName),r.lastPlayTime=Date.now(),r.isFirstPlay&&(r.isFirstPlay=!1,r.summary.timeToPlayMs=r.lastPlayTime-r.creationTime,r.summary.timeToPlayingMs=void 0,r.isFirstCanPlay&&d.ULS.sendTraceTag(537773265,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"No 'canplay' event was triggered before triggering the 'play' event on media: ".concat(r.summary.mediaName)))})),this.player.addEventListener("playing",(function(){e.logEvent("playing",r.summary.mediaName),r.isPlaying=!0,r.setTimeSincePlay(),r.isFirstPlaying&&void 0!==r.lastPlayTime&&(r.isFirstPlaying=!1,r.summary.timeToPlayingMs=Date.now()-r.lastPlayTime,r.isFirstPlay&&d.ULS.sendTraceTag(537773266,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"No 'play' event was triggered before triggering the 'playing' event on media: ".concat(r.summary.mediaName))),r.lastPlayTime=void 0,r.calculateBufferingTime(),void 0===r.lastPlayingTime&&(r.lastPlayingTime=Date.now())})),this.player.addEventListener("pause",(function(){r.checkPlayerNotReady("pause"),e.logEvent("pause",r.summary.mediaName),r.isPlaying=!1,r.isStalled=!1,r.setTimeSincePlay(),r.lastPlayTime=void 0,r.calculatePlayingTime()})),this.player.addEventListener("ended",(function(){r.checkPlayerNotReady("ended"),e.logEvent("ended",r.summary.mediaName),r.summary.wasPlayedUntilEnd=!0})),this.player.addEventListener("seeking",(function(){e.logEvent("seeking",r.summary.mediaName),r.setTimeSinceSeek(),r.lastSeekTime=Date.now()})),this.player.addEventListener("seeked",(function(){r.checkPlayerNotReady("seeked"),e.logEvent("seeked",r.summary.mediaName),r.setTimeSinceSeek(),r.lastSeekTime=void 0})),this.player.addEventListener("volumechange",(function(){r.checkPlayerNotReady("volumechange"),e.logEvent("volumechange",r.summary.mediaName)})),this.player.addEventListener("progress",(function(){e.logEvent("progress",r.summary.mediaName),r.isStalled=!1})),this.player.addEventListener("stalled",(function(){e.logEvent("stalled",r.summary.mediaName),r.isPlaying&&(r.isStalled=!0,void 0===r.summary.numberOfStalls?r.summary.numberOfStalls=1:r.summary.numberOfStalls+=1),r.calculatePlayingTime(),void 0===r.lastBufferTime&&(r.lastBufferTime=Date.now())})),this.player.addEventListener("error",(function(){e.logEvent("error",r.summary.mediaName);var t=null!==r.player.error?r.player.error.code:-1;void 0===r.summary.errorCode&&(r.summary.errorCode=t),r.isPlaying&&(r.playError=t)})),this.player.addEventListener("abort",(function(){e.logEvent("abort",r.summary.mediaName),r.calculatePlayingTime(),r.calculateBufferingTime()})),this.player.addEventListener("emptied",(function(){e.logEvent("emptied",r.summary.mediaName)})),this.player.addEventListener("loadeddata",(function(){e.logEvent("loadeddata",r.summary.mediaName)})),this.player.addEventListener("waiting",(function(){e.logEvent("waiting",r.summary.mediaName),r.calculatePlayingTime(),void 0===r.lastBufferTime&&(r.lastBufferTime=Date.now())})),this.player.addEventListener("suspend",(function(){e.logEvent("suspend",r.summary.mediaName)}))}},{key:"isAutoPlay",value:function(){return!!this.summary.isAutoPlay}},{key:"onSourceSet",value:function(e){this.cleanup(),this.summary.timeToSourceSet=Date.now()-this.creationTime;var t=new URL(e);e.includes("MediaDownloadHandler")&&(this.summary.isMediaSnap=!0);var r=t.searchParams.get("mediaName");null!==r&&(this.summary.mediaName=r);var i=t.searchParams.get("ext");if(null!==i)this.summary.mediaExtension=i;else{var n=t.searchParams.get("mediaId");if(null!==n){var a=/^.+\.([^\.]+)\.media$/.exec(n);null!==a&&2===a.length&&(this.summary.mediaExtension=a[1])}}var o=t.searchParams.get("mediaLength");null!==o&&(this.summary.mediaLength=parseInt(o,10));var s=t.searchParams.get("retries");null!==s&&(this.summary.retriesLeft=parseInt(s,10));var l=t.searchParams.get("requestGuid");null!==l&&(this.summary.requestGuid=l),this.summary.isEnabledTranscodingFlight=null===t.searchParams.get("disableTranscode");var h=t.searchParams.get("docId");null!==h&&c.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=(0,u.simpleHash)(h).toString()),d.ULS.sendTraceTag(508364564,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"SourceSet ".concat(JSON.stringify(this.summary)))}},{key:"setInClickSequence",value:function(){this.summary.isInClickSequence=!0,d.ULS.sendTraceTag(508364563,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"Video playback started through animation.")}},{key:"setMediaQuality",value:function(e){void 0===this.summary.initialQuality&&(this.summary.initialQuality=e),this.summary.finalQuality=e,this.summary.initialQuality!==o.TranscodedMediaQuality.Raw&&e===o.TranscodedMediaQuality.Raw&&void 0===this.summary.fallbackTime&&(this.summary.fallbackTime=Date.now(),this.summary.fallbackRetryCount=this.summary.retriesLeft)}},{key:"setHls",value:function(e){e?this.summary.isHls=!0:this.summary.isHls&&void 0===this.summary.hlsFallbackTime&&(this.summary.hlsFallbackTime=Date.now(),this.summary.hlsFallbackRetryCount=this.summary.retriesLeft)}},{key:"setHlsAndTranscoding",value:function(e,t){e&&t&&void 0===this.summary.hlsTranscodingTime?this.summary.hlsTranscodingTime=Date.now():e&&!t&&void 0===this.summary.hlsRawTime?this.summary.hlsRawTime=Date.now():e||t||void 0!==this.summary.progressiveRawTime||(this.summary.progressiveRawTime=Date.now())}},{key:"setPlayRequestTime",value:function(){void 0===this.summary.playRequestTime&&(this.summary.playRequestTime=Date.now())}},{key:"setPlaybackControlsFlag",value:function(){this.summary.isUsingPlaybackControls=!0}},{key:"onNavigatingTo",value:function(){this.wasNavigatingFrom&&(this.wasNavigatingFrom=!1)}},{key:"setWhenClickedOn",value:function(){this.summary.isWhenClickedOn=!0,d.ULS.sendTraceTag(508364562,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"Video playback started by clicking on custom play button.")}},{key:"addSlideEventListeners",value:function(t){var r=this;t.on("navigatedTo",(function(){r.isOnSlide?d.ULS.sendTraceTag(556048642,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"Already on this slide"):(r.isOnSlide=!0,r.summary.timeToNavigatedTo=Date.now()-r.creationTime,r.summary.timeToNavigatingFrom=void 0,r.summary.isInClickSequence=void 0,r.summary.isWhenClickedOn=void 0,e.sendNavigatedTo&&(e.sendNavigatedTo=!1,d.ULS.sendTraceTag(559453667,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"Navigated to a slide with a local ".concat(r.summary.mediaType))))})),t.on("navigatingFrom",(function(){r.isOnSlide?(r.isOnSlide=!1,r.summary.timeToNavigatingFrom=Date.now()-r.creationTime,void 0===r.summary.numberOfStalls&&void 0===r.summary.errorCode&&!r.isStalled&&void 0===r.playError&&void 0===r.lastPlayTime&&void 0===r.timeSincePlay&&void 0===r.lastSeekTime&&void 0===r.timeSinceSeek&&r.isFirstLoadStart&&r.isFirstLoadedMetadata&&r.isFirstCanPlay&&r.isFirstPlay&&r.isFirstPlaying||(void 0!==r.summary.timeToPlayingMs&&(r.summary.lastVolume=Math.round(100*r.player.volume),r.summary.lastIsMuted=r.player.muted),l.Settings.readBooleanOrDefault("forceSvg",!1)&&(r.summary.isSVG=!0),r.calculatePlayingTime(),r.calculateBufferingTime(),void 0===r.summary.navigationCount&&(r.summary.navigationCount=0),d.ULS.sendTraceTag(570750435,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(r.summary))),r.summary.hlsBandwidthEstimate=void 0,r.summary.hlsTranscodingTime=void 0,r.summary.hlsRawTime=void 0,r.summary.progressiveRawTime=void 0,r.summary.playRequestTime=void 0,r.summary.wasVetoLogged=void 0,r.summary.navigationCount+=1,r.cleanup(),r.playError=void 0,r.wasNavigatingFrom=!0)):d.ULS.sendTraceTag(556048643,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Error,"Not on this slide yet")}))}},{key:"cleanup",value:function(){this.summary.wasPlayedUntilEnd=void 0,this.summary.numberOfStalls=void 0,this.summary.errorCode=void 0,this.isPlaying=!1,this.isStalled=!1,this.lastPlayTime=void 0,this.timeSincePlay=void 0,this.lastSeekTime=void 0,this.timeSinceSeek=void 0,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.summary.totalBufferingTime=0,this.summary.totalPlayingTime=0}},{key:"setTimeSincePlay",value:function(){if(void 0===this.lastPlayTime)return 0;var e=Date.now()-this.lastPlayTime;return e<this.minTimeAfterAction?0:(this.timeSincePlay=void 0!==this.timeSincePlay?Math.max(this.timeSincePlay,e):e,e)}},{key:"setTimeSinceSeek",value:function(){if(void 0===this.lastSeekTime)return 0;var e=Date.now()-this.lastSeekTime;return e<this.minTimeAfterAction?0:(this.timeSinceSeek=void 0!==this.timeSinceSeek?Math.max(this.timeSinceSeek,e):e,e)}},{key:"checkPlayerNotReady",value:function(e){void 0===this.summary.timeToInteractivityMs&&d.ULS.sendTraceTag(529332098,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"".concat(this.summary.mediaType," ").concat(this.summary.mediaName," emitted ").concat(e," event before being interactive."))}},{key:"calculateBufferingTime",value:function(){if(void 0!==this.lastBufferTime){var e=Date.now()-this.lastBufferTime;this.summary.totalBufferingTime+=e,this.lastBufferTime=void 0}}},{key:"calculatePlayingTime",value:function(){if(void 0!==this.lastPlayingTime){var e=Date.now()-this.lastPlayingTime;this.summary.totalPlayingTime+=e,this.lastPlayingTime=void 0}}},{key:"setHlsBandwidthEstimate",value:function(e){this.summary.hlsBandwidthEstimate=e}},{key:"vetoLogged",value:function(){this.summary.wasVetoLogged=!0}}],[{key:"useLoadedMetadataAsInteractivityEvent",value:function(e){return(0,o.isHostTypeIOS)(e)&&l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0)}},{key:"logEvent",value:function(e,t){d.ULS.sendTraceTag(542770816,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"LocalMediaPlaybackPerf event tracking: Received ".concat(e," event on media: ").concat(t))}}])}();t.LocalMediaPlaybackPerf=f,f.sendNavigatedTo=!0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleHash=function(e){if(!e)return 0;for(var t=0,r=0;r<e.length;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return t}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);e.exports=function(){return r(i),i}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},function(e,t){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,n=r;return[n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]]].join("")}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesManager=t.BabylonImportedModules=void 0;var n=i(r(1)),a=i(r(2)),o=r(40);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var c={InternalTexture:void 0,VertexBuffer:void 0};t.BabylonImportedModules=c;var u=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.engine=t,this.memoryReport=r,this.indexBuffers=[],this.vertexBuffers=[],this.textures=[],this.vaos=[]}),[{key:"createIndexBuffer",value:function(e){var t=this.engine.createIndexBuffer(e);return this.indexBuffers.push(t),this.memoryReport.buffers.count+=1,t}},{key:"createVertexBuffers",value:function(e){var t={};if(!c.VertexBuffer)throw new Error("VertexBuffer is not defined");var r,i=s(e);try{for(i.s();!(r=i.n()).done;){var n=r.value,a=new c.VertexBuffer(this.engine,n.data,n.name,!0,!1,n.itemSize);t[n.name]=a,this.vertexBuffers.push(a),this.memoryReport.buffers.count+=1}}catch(e){i.e(e)}finally{i.f()}return t}},{key:"recordVertexArrayObject",value:function(e,t,r){var i=this.engine.recordVertexArrayObject(e,t,r);return this.vaos.push(i),this.memoryReport.vaos.count+=1,i}},{key:"createMonochromeTexture",value:function(e,t,r,i){var n=new Uint8Array([e,t,r,i]);return this.createTexture(n,1,1)}},{key:"createTexture",value:function(e,t,r){if(!c.InternalTexture)throw new Error("InternalTexture is not defined");var i=new c.InternalTexture(this.engine,o.InternalTextureSource.Unknown);return i.baseWidth=t,i.baseHeight=r,i.width=t,i.height=r,i.format=5,i.generateMipMaps=!1,i.samplingMode=2,i.invertY=!0,i.type=0,this.engine._bindTextureDirectly(3553,i,!0),this.engine._uploadDataToTextureDirectly(i,e,0,0,void 0,!0),this.engine.updateTextureSamplingMode(i.samplingMode,i,!1),this.engine.updateTextureWrappingMode(i,33071,33071),i.isReady=!0,this.textures.push(i),this.memoryReport.textures.count+=1,i}},{key:"dispose",value:function(){var e,t=s(this.indexBuffers);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.engine._releaseBuffer(r),this.memoryReport.buffers.count-=1}}catch(e){t.e(e)}finally{t.f()}var i,n=s(this.vertexBuffers);try{for(n.s();!(i=n.n()).done;)i.value.dispose(),this.memoryReport.buffers.count-=1}catch(e){n.e(e)}finally{n.f()}var a,o=s(this.vaos);try{for(o.s();!(a=o.n()).done;){var l=a.value;this.engine.releaseVertexArrayObject(l),this.memoryReport.vaos.count-=1}}catch(e){o.e(e)}finally{o.f()}var c,u=s(this.textures);try{for(u.s();!(c=u.n()).done;)c.value.dispose(),this.memoryReport.textures.count-=1}catch(e){u.e(e)}finally{u.f()}this.indexBuffers.length=0,this.vertexBuffers.length=0,this.vaos.length=0}}]);t.ResourcesManager=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTransitionFactory=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(14),c=r(45),u=r(174),d=r(21),h=r(3),f=r(117),m=r(175),p=function(){return(0,s.default)((function e(t){(0,o.default)(this,e),this.transPropertyFactory=new u.TransitionPropertyFactory(t.customTransitionDataLoader),this.transitionDisabledList=t.transitionDisabledList||""}),[{key:"isTransitionDisabled",value:function(e,t){return(0,d.isTransitionDisabled)(this.transitionDisabledList,e,t)}},{key:"getTransition",value:(t=(0,a.default)(n.default.mark((function e(t,r,i){var a,o,s,u,p,g,v,y=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=y.length>3&&void 0!==y[3]?y[3]:new f.MemoryReport,e.prev=1,!(0,d.isTransitionDisabled)(this.transitionDisabledList,t,r)){e.next=8;break}return l.VetoUtils.recordVeto("TransitionFallback",{EffectId:t,qosVeto:"TransitionFallback",isIntentional:!0}),e.next=6,this.getTransition(c.kTransitionIds.PPT_TRANSITION_FADE,r,i,a);case 6:return o=e.sent.transition,e.abrupt("return",{transition:o,isSupported:!1});case 8:u=!0,e.t0=t,e.next=e.t0===c.kTransitionIds.PPT_TRANSITION_WIPE||e.t0===c.kTransitionIds.PPT_TRANSITION_STRIPS||e.t0===c.kTransitionIds.PPT_TRANSITION_SPLIT||e.t0===c.kTransitionIds.PPT_TRANSITION_ZOOM||e.t0===c.kTransitionIds.PPT_TRANSITION_DIAMOND||e.t0===c.kTransitionIds.PPT_TRANSITION_PLUS||e.t0===c.kTransitionIds.PPT_TRANSITION_CIRCLE||e.t0===c.kTransitionIds.PPT_TRANSITION_RANDOMBAR||e.t0===c.kTransitionIds.PPT_TRANSITION_FADE||e.t0===c.kTransitionIds.PPT_TRANSITION_DISSOLVE||e.t0===c.kTransitionIds.PPT_TRANSITION_WHEEL||e.t0===c.kTransitionIds.PPT_TRANSITION_WHEELREVERSE||e.t0===c.kTransitionIds.PPT_TRANSITION_WEDGE?12:e.t0===c.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK?14:e.t0===c.kTransitionIds.PPT_TRANSITION_PUSH||e.t0===c.kTransitionIds.PPT_TRANSITION_PAN?16:e.t0===c.kTransitionIds.PPT_TRANSITION_COMB?18:e.t0===c.kTransitionIds.PPT_TRANSITION_CUT?20:e.t0===c.kTransitionIds.PPT_TRANSITION_RANDOM?23:e.t0===c.kTransitionIds.PPT_TRANSITION_COVER?26:e.t0===c.kTransitionIds.PPT_TRANSITION_UNCOVER?28:e.t0===c.kTransitionIds.PPT_TRANSITION_BLINDS||e.t0===c.kTransitionIds.PPT_TRANSITION_PRISM?30:e.t0===c.kTransitionIds.PPT_TRANSITION_RIPPLE?32:e.t0===c.kTransitionIds.PPT_TRANSITION_VORTEX||e.t0===c.kTransitionIds.PPT_TRANSITION_CHECKER||e.t0===c.kTransitionIds.PPT_TRANSITION_GLITTER?34:e.t0===c.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN?36:e.t0===c.kTransitionIds.PPT_TRANSITION_FLIP||e.t0===c.kTransitionIds.PPT_TRANSITION_SWITCH||e.t0===c.kTransitionIds.PPT_TRANSITION_FALLOVER||e.t0===c.kTransitionIds.PPT_TRANSITION_DRAPE||e.t0===c.kTransitionIds.PPT_TRANSITION_CURTAINS||e.t0===c.kTransitionIds.PPT_TRANSITION_WIND||e.t0===c.kTransitionIds.PPT_TRANSITION_PRESTIGE||e.t0===c.kTransitionIds.PPT_TRANSITION_FRACTURE||e.t0===c.kTransitionIds.PPT_TRANSITION_CRUSH||e.t0===c.kTransitionIds.PPT_TRANSITION_PEELOFF||e.t0===c.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE||e.t0===c.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE||e.t0===c.kTransitionIds.PPT_TRANSITION_AIRPLANE||e.t0===c.kTransitionIds.PPT_TRANSITION_ORIGAMI?38:e.t0===c.kTransitionIds.PPT_TRANSITION_GALLERY||e.t0===c.kTransitionIds.PPT_TRANSITION_CONVEYOR?40:e.t0===c.kTransitionIds.PPT_TRANSITION_CROSSZOOM?42:e.t0===c.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT||e.t0===c.kTransitionIds.PPT_TRANSITION_FLYTHROUGH?44:e.t0===c.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT||e.t0===c.kTransitionIds.PPT_TRANSITION_DOORS?46:48;break;case 12:return s=this.transactionConstructors.AlphaTransition(),e.abrupt("break",51);case 14:return s=this.transactionConstructors.FadeThroughBlackTransition(),e.abrupt("break",51);case 16:return s=this.transactionConstructors.PushTransition(),e.abrupt("break",51);case 18:return s=this.transactionConstructors.WeaveTransition(),e.abrupt("break",51);case 20:return s=this.transactionConstructors.CutTransition(),r!==c.kTransitionEffectOptions.Top&&(l.VetoUtils.recordVeto("TransitionFallback",{EffectId:t,qosVeto:"TransitionFallback",isIntentional:!0}),u=!1),e.abrupt("break",51);case 23:return e.next=25,this.createRandomTransition(i);case 25:return e.abrupt("return",e.sent);case 26:case 28:return s=this.transactionConstructors.CoverTransition(),e.abrupt("break",51);case 30:return s=this.transactionConstructors.PrismTransition(),e.abrupt("break",51);case 32:return s=this.transactionConstructors.RippleTransition(),e.abrupt("break",51);case 34:return s=this.transactionConstructors.BlindsTransition(),e.abrupt("break",51);case 36:return s=this.transactionConstructors.ZoomWithSpinTransition(),e.abrupt("break",51);case 38:return s=this.transactionConstructors.CustomTransition(),e.abrupt("break",51);case 40:return s=this.transactionConstructors.GalleryTransition(),e.abrupt("break",51);case 42:return s=this.transactionConstructors.CrossZoomTransition(),e.abrupt("break",51);case 44:return s=this.transactionConstructors.FlyThroughTransition(),e.abrupt("break",51);case 46:return s=this.transactionConstructors.DoorsTransition(),e.abrupt("break",51);case 48:u=!1,s=this.transactionConstructors.AlphaTransition(),l.VetoUtils.recordVeto("TransitionFallback",{EffectId:t,qosVeto:"TransitionFallback",isIntentional:!0});case 51:return e.next=53,this.transPropertyFactory.getTransitionProperty(t,r,i);case 53:if(null!=(p=e.sent)){e.next=60;break}return l.VetoUtils.recordVeto("TransitionFallback",{EffectId:t,qosVeto:"TransitionFallback",isIntentional:!0}),e.next=58,this.getTransition(c.kTransitionIds.PPT_TRANSITION_FADE,r,i);case 58:return g=e.sent.transition,e.abrupt("return",{transition:g,isSupported:!1});case 60:return s.init(p,a),h.ULS.sendTraceTag(507331295,h.LogCategory.msoulscat_Wac_PptSession,h.TraceLevel.Info,"TransitionFactory::getTransition: Transition effectId:".concat(t,", isSupported:").concat(u)),v=new m.TransitionWrapper(s),e.abrupt("return",{transition:v,isSupported:u});case 66:e.prev=66,e.t1=e.catch(1),(0,d.logError)("Exception at getTransition : ".concat(e.t1)),l.VetoUtils.recordVeto("TransitionFallback",{EffectId:t,qosVeto:"TransitionFallback",isIntentional:!1});case 70:return e.abrupt("return",{transition:void 0,isSupported:!1});case 71:case"end":return e.stop()}}),e,this,[[1,66]])}))),function(e,r,i){return t.apply(this,arguments)})},{key:"createRandomTransition",value:(e=(0,a.default)(n.default.mark((function e(t,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.getRandomEffectData(),e.next=3,this.getTransition(i.effectId,i.direction,t,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"getRandomEffectData",value:function(){for(var e=[{effectId:c.kTransitionIds.PPT_TRANSITION_ZOOM,direction:2},{effectId:c.kTransitionIds.PPT_TRANSITION_WIPE,direction:4},{effectId:c.kTransitionIds.PPT_TRANSITION_STRIPS,direction:4},{effectId:c.kTransitionIds.PPT_TRANSITION_RANDOMBAR,direction:2},{effectId:c.kTransitionIds.PPT_TRANSITION_SPLIT,direction:4},{effectId:c.kTransitionIds.PPT_TRANSITION_FADE,direction:1},{effectId:c.kTransitionIds.PPT_TRANSITION_CUT,direction:3},{effectId:c.kTransitionIds.PPT_TRANSITION_DISSOLVE,direction:1},{effectId:c.kTransitionIds.PPT_TRANSITION_COVER,direction:8},{effectId:c.kTransitionIds.PPT_TRANSITION_WHEEL,direction:4},{effectId:c.kTransitionIds.PPT_TRANSITION_CHECKER,direction:2}],t=0,r=0,i=e;r<i.length;r++)t+=i[r].direction;var n,a=Math.floor(Math.random()*t);for(n=0;a>=e[n].direction;n+=1)a-=e[n].direction;return{effectId:e[n].effectId,direction:a}}}]);var e,t}();t.BaseTransitionFactory=p},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTransitionPropertyWithBackBuffer=t.CustomTransitionProperty=t.CrossZoomTransitionProperty=t.PrismTransitionProperty=t.VortexTransitionProperty=t.GlitterTransitionProperty=t.CheckersTransitionProperty=t.ConveyorTransitionProperty=t.GalleryTransitionProperty=t.RippleTransitionProperty=t.ZoomWithSpinTransitionProperty=t.BlindsTransitionProperty=t.WheelTransitionProperty=t.DissolveTransitionProperty=t.CombTransitionProperty=t.PushTransitionProperty=t.CoverTransitionProperty=t.CutTransitionProperty=t.DoorsTransitionProperty=t.ZoomFlyThroughTransitionProperty=t.FlyThroughTransitionProperty=t.BaseTransitionProperty=t.SlideTransitionInfo=t.TransitionPropertyFactory=void 0;var n=i(r(6)),a=i(r(9)),o=i(r(8)),s=i(r(10)),l=i(r(7)),c=i(r(1)),u=i(r(2)),d=r(32),h=r(45),f=r(76);function m(e,t,r){return t=(0,o.default)(t),(0,a.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,o.default)(e).constructor):t.apply(e,r))}var p=function(){return(0,u.default)((function e(t){(0,c.default)(this,e),this.m_customTransitionDataLoader=t}),[{key:"getTransitionProperty",value:(e=(0,l.default)(n.default.mark((function e(t,r,i){var a,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=null,e.t0=t,e.next=e.t0===h.kTransitionIds.PPT_TRANSITION_COMB?4:e.t0===h.kTransitionIds.PPT_TRANSITION_PUSH?6:e.t0===h.kTransitionIds.PPT_TRANSITION_PAN?8:e.t0===h.kTransitionIds.PPT_TRANSITION_STRIPS||e.t0===h.kTransitionIds.PPT_TRANSITION_WIPE?10:e.t0===h.kTransitionIds.PPT_TRANSITION_SPLIT?12:e.t0===h.kTransitionIds.PPT_TRANSITION_ZOOM?14:e.t0===h.kTransitionIds.PPT_TRANSITION_DIAMOND||e.t0===h.kTransitionIds.PPT_TRANSITION_PLUS||e.t0===h.kTransitionIds.PPT_TRANSITION_CIRCLE?16:e.t0===h.kTransitionIds.PPT_TRANSITION_RANDOMBAR?18:e.t0===h.kTransitionIds.PPT_TRANSITION_FADE||e.t0===h.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK?20:e.t0===h.kTransitionIds.PPT_TRANSITION_CUT?22:e.t0===h.kTransitionIds.PPT_TRANSITION_DISSOLVE?24:e.t0===h.kTransitionIds.PPT_TRANSITION_COVER?26:e.t0===h.kTransitionIds.PPT_TRANSITION_UNCOVER?28:e.t0===h.kTransitionIds.PPT_TRANSITION_WHEEL||e.t0===h.kTransitionIds.PPT_TRANSITION_WHEELREVERSE?30:e.t0===h.kTransitionIds.PPT_TRANSITION_WEDGE?32:e.t0===h.kTransitionIds.PPT_TRANSITION_PRISM?34:e.t0===h.kTransitionIds.PPT_TRANSITION_BLINDS?36:e.t0===h.kTransitionIds.PPT_TRANSITION_RIPPLE?38:e.t0===h.kTransitionIds.PPT_TRANSITION_VORTEX?40:e.t0===h.kTransitionIds.PPT_TRANSITION_CHECKER?42:e.t0===h.kTransitionIds.PPT_TRANSITION_FLIP||e.t0===h.kTransitionIds.PPT_TRANSITION_SWITCH||e.t0===h.kTransitionIds.PPT_TRANSITION_FALLOVER||e.t0===h.kTransitionIds.PPT_TRANSITION_DRAPE||e.t0===h.kTransitionIds.PPT_TRANSITION_CURTAINS||e.t0===h.kTransitionIds.PPT_TRANSITION_WIND||e.t0===h.kTransitionIds.PPT_TRANSITION_PRESTIGE||e.t0===h.kTransitionIds.PPT_TRANSITION_FRACTURE||e.t0===h.kTransitionIds.PPT_TRANSITION_CRUSH||e.t0===h.kTransitionIds.PPT_TRANSITION_PEELOFF||e.t0===h.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE||e.t0===h.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE||e.t0===h.kTransitionIds.PPT_TRANSITION_AIRPLANE||e.t0===h.kTransitionIds.PPT_TRANSITION_ORIGAMI?44:e.t0===h.kTransitionIds.PPT_TRANSITION_GLITTER?49:e.t0===h.kTransitionIds.PPT_TRANSITION_GALLERY?51:e.t0===h.kTransitionIds.PPT_TRANSITION_CONVEYOR?53:e.t0===h.kTransitionIds.PPT_TRANSITION_CROSSZOOM?55:e.t0===h.kTransitionIds.PPT_TRANSITION_FLYTHROUGH?57:e.t0===h.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT?59:e.t0===h.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN?61:e.t0===h.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT?63:e.t0===h.kTransitionIds.PPT_TRANSITION_DOORS?65:67;break;case 4:return a=this.createCombProperty(i),e.abrupt("break",68);case 6:return a=this.createPushProperty(i),e.abrupt("break",68);case 8:return a=this.createPanProperty(i),e.abrupt("break",68);case 10:return a=this.createWipeProperty(i),e.abrupt("break",68);case 12:return a=this.createSplitProperty(i),e.abrupt("break",68);case 14:return a=this.createZoomProperty(i),e.abrupt("break",68);case 16:return a=this.createShapeProperty(i,t),e.abrupt("break",68);case 18:return a=this.createRandombarProperty(i),e.abrupt("break",68);case 20:return a=this.createFadeSmoothlyProperty(i),e.abrupt("break",68);case 22:return r===h.kTransitionEffectOptions.Top&&(a=this.createCutThroughBlackProperty(i)),e.abrupt("break",68);case 24:return a=new P(i),e.abrupt("break",68);case 26:return a=this.createCoverProperty(i),e.abrupt("break",68);case 28:return a=this.createUncoverProperty(i),e.abrupt("break",68);case 30:return a=this.createWheelTransitionProperty(i,t===h.kTransitionIds.PPT_TRANSITION_WHEEL),e.abrupt("break",68);case 32:return a=this.createWedgeTransitionProperty(i),e.abrupt("break",68);case 34:return a=this.createPrismProperty(i),e.abrupt("break",68);case 36:return a=new k(i),e.abrupt("break",68);case 38:return a=new x(i),e.abrupt("break",68);case 40:return a=new O(i),e.abrupt("break",68);case 42:return a=new M(i),e.abrupt("break",68);case 44:return e.next=46,this.m_customTransitionDataLoader.load(t);case 46:return o=e.sent,a=this.createCustomProperty(t,i,o),e.abrupt("break",68);case 49:return a=new R(i),e.abrupt("break",68);case 51:return a=new L(i),e.abrupt("break",68);case 53:return a=new A(i),e.abrupt("break",68);case 55:return a=new F(i),e.abrupt("break",68);case 57:return a=new _(i),e.abrupt("break",68);case 59:return a=new y(i),e.abrupt("break",68);case 61:return a=new E(i),e.abrupt("break",68);case 63:return a=new S(i,!0),e.abrupt("break",68);case 65:return a=new S(i,!1),e.abrupt("break",68);case 67:a=this.createFadeSmoothlyProperty(i);case 68:return e.abrupt("return",a);case 69:case"end":return e.stop()}}),e,this)}))),function(t,r,i){return e.apply(this,arguments)})},{key:"isInvalidCustomProperty",value:function(e,t){if(!(t&&t.IndexBuffer&&t.PositionBufferList&&t.TextureCoordBuffer))return!0;switch(e){case h.kTransitionIds.PPT_TRANSITION_FLIP:case h.kTransitionIds.PPT_TRANSITION_SWITCH:case h.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:if(!t.IndexBufferBack||!t.PositionBufferListBack||!t.TextureCoordBufferBack)return!0}return!1}},{key:"createCustomProperty",value:function(e,t,r){var i=null;if(this.isInvalidCustomProperty(e,r))return null;switch(e){case h.kTransitionIds.PPT_TRANSITION_FALLOVER:(i=new B(t,r,e)).ambient=.5;break;case h.kTransitionIds.PPT_TRANSITION_DRAPE:(i=new B(t,r,e)).ambient=.4;break;case h.kTransitionIds.PPT_TRANSITION_CURTAINS:(i=new B(t,r,e)).ambient=.8;break;case h.kTransitionIds.PPT_TRANSITION_WIND:(i=new B(t,r,e)).ambient=.9;break;case h.kTransitionIds.PPT_TRANSITION_PRESTIGE:(i=new B(t,r,e)).ambient=.8;break;case h.kTransitionIds.PPT_TRANSITION_FRACTURE:(i=new B(t,r,e)).ambient=.7;break;case h.kTransitionIds.PPT_TRANSITION_CRUSH:(i=new B(t,r,e)).ambient=.9;break;case h.kTransitionIds.PPT_TRANSITION_PEELOFF:(i=new B(t,r,e)).ambient=.65;break;case h.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:(i=new B(t,r,e)).ambient=.8;break;case h.kTransitionIds.PPT_TRANSITION_AIRPLANE:(i=new B(t,r,e)).ambient=.6;break;case h.kTransitionIds.PPT_TRANSITION_ORIGAMI:(i=new B(t,r,e)).ambient=.8;break;case h.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:(i=new N(t,r,e)).ambient=.9;break;case h.kTransitionIds.PPT_TRANSITION_FLIP:case h.kTransitionIds.PPT_TRANSITION_SWITCH:(i=new N(t,r,e)).ambient=.8}return i}},{key:"createPushProperty",value:function(e){var t=new C(e);return!t.forward&&t.direction>=h.kTransitionEffectOptions.Left&&t.direction<=h.kTransitionEffectOptions.Bottom&&(t.direction=(t.direction+2)%4),t.hres=1,t.vres=1,t}},{key:"createPanProperty",value:function(e){var t=this.createPushProperty(e);return t.useContent=!0,t}},{key:"createCombProperty",value:function(e){var t=new w(e);switch(t.factor=1,t.invertDelay=!0,t.meshType=d.MeshType.Square,e.direction){case h.kTransitionEffectOptions.Horizontal:t.hres=1,t.vres=7,t.directionFormula=d.Direction2D.CombHorizontal;break;case h.kTransitionEffectOptions.Vertical:t.hres=7,t.vres=1,t.directionFormula=d.Direction2D.CombVertical}return t}},{key:"createWipeProperty",value:function(e){var t=new v(e);switch(t.hres=50,t.vres=50,e.direction){case h.kTransitionEffectOptions.Top:case h.kTransitionEffectOptions.Bottom:t.delayFormula=d.DelayFormula.Top,t.hres=1,t.invertDelay=e.direction===h.kTransitionEffectOptions.Top;break;case h.kTransitionEffectOptions.Left:case h.kTransitionEffectOptions.Right:t.delayFormula=d.DelayFormula.Left,t.vres=1,t.invertDelay=e.direction===h.kTransitionEffectOptions.Left;break;case h.kTransitionEffectOptions.TopLeft:case h.kTransitionEffectOptions.BottomRight:t.delayFormula=d.DelayFormula.TopLeft,t.invertDelay=e.direction===h.kTransitionEffectOptions.TopLeft;break;case h.kTransitionEffectOptions.TopRight:case h.kTransitionEffectOptions.BottomLeft:t.delayFormula=d.DelayFormula.TopRight,t.invertDelay=e.direction===h.kTransitionEffectOptions.TopRight}return t}},{key:"createSplitProperty",value:function(e){var t=new v(e);switch(t.hres=50,t.vres=50,e.direction){case h.kTransitionEffectOptions.HorizontalOut:case h.kTransitionEffectOptions.HorizontalIn:t.delayFormula=d.DelayFormula.SplitVertical,t.hres=1,t.invertDelay=e.direction===h.kTransitionEffectOptions.HorizontalIn;break;case h.kTransitionEffectOptions.VerticalOut:case h.kTransitionEffectOptions.VerticalIn:t.delayFormula=d.DelayFormula.SplitHorizontal,t.vres=1,t.invertDelay=e.direction===h.kTransitionEffectOptions.VerticalIn}return t}},{key:"createZoomProperty",value:function(e){var t=new v(e);return t.hres=100,t.vres=100,t.factor=30,t.delayFormula=d.DelayFormula.Box,t.invertDelay=e.direction===h.kTransitionEffectOptions.ZoomIn,t}},{key:"createShapeProperty",value:function(e,t){var r=new v(e);switch(r.hres=100,r.vres=100,r.factor=3,r.invertDelay=e.direction!==h.kTransitionEffectOptions.Anywhere,t){case h.kTransitionIds.PPT_TRANSITION_DIAMOND:r.delayFormula=d.DelayFormula.Diamond;break;case h.kTransitionIds.PPT_TRANSITION_PLUS:r.delayFormula=d.DelayFormula.Plus;break;case h.kTransitionIds.PPT_TRANSITION_CIRCLE:r.delayFormula=d.DelayFormula.Circle}return r}},{key:"createRandombarProperty",value:function(e){var t=new v(e);return e.direction===h.kTransitionEffectOptions.Vertical?(t.hres=100,t.vres=1):(t.hres=1,t.vres=100),t.delayFormula=d.DelayFormula.Random,t}},{key:"createFadeSmoothlyProperty",value:function(e){var t=new v(e);return t.hres=1,t.vres=1,t.factor=1,t.jitter=0,t.delayFormula=d.DelayFormula.None,t}},{key:"createCutThroughBlackProperty",value:function(e){var t=new T(e);return t.hres=1,t.vres=1,t.m_fThroughBlack=!0,t}},{key:"createCoverProperty",value:function(e){var t=new b(e);return t.hres=1,t.vres=1,t.isCover=!0,t}},{key:"createUncoverProperty",value:function(e){var t=this.createCoverProperty(e);return t.isCover=!1,t}},{key:"createWheelTransitionProperty",value:function(e,t){var r=new I(e);if(t)switch(e.direction){case 0:case 1:r.delayFormula=d.DelayFormula.Clock1;break;case 2:r.delayFormula=d.DelayFormula.Clock2;break;case 3:r.delayFormula=d.DelayFormula.Clock3;break;case 4:case 5:case 6:case 7:r.delayFormula=d.DelayFormula.Clock4;break;case 8:default:r.delayFormula=d.DelayFormula.Clock8}else switch(e.direction){case 4:r.delayFormula=d.DelayFormula.CounterClock4;break;default:r.delayFormula=d.DelayFormula.CounterClock1}return r}},{key:"createWedgeTransitionProperty",value:function(e){var t=new I(e);return t.factor=3,t.delayFormula=d.DelayFormula.Wedge,t}},{key:"createPrismProperty",value:function(e){return new D(e)}}]);var e}();t.TransitionPropertyFactory=p;var g=(0,u.default)((function e(t){(0,c.default)(this,e),this.gl=t.gl,this.engine=t.engine,this.forward=t.forward,this.direction=t.direction,this.aspectRatio=t.aspectRatio,this.incomingSlideBackground=t.incomingSlideBackground,this.outgoingSlideBackground=t.outgoingSlideBackground,this.incomingSlideForeground=t.incomingSlideForeground,this.outgoingSlideForeground=t.outgoingSlideForeground}));t.SlideTransitionInfo=g;var v=(0,u.default)((function e(t){(0,c.default)(this,e),this.invertDelay=!1,this.delayFormula=d.DelayFormula.None,this.meshType=d.MeshType.Smooth,this.hres=50,this.vres=50,this.factor=2,this.jitter=10,this.gl=t.gl,this.engine=t.engine,this.forward=t.forward,this.direction=t.direction,this.aspectRatio=t.aspectRatio,this.incomingSlideBackground=t.incomingSlideBackground,this.outgoingSlideBackground=t.outgoingSlideBackground}));t.BaseTransitionProperty=v;var y=function(e){function t(e){var r;switch((0,c.default)(this,t),(r=m(this,t,[e])).incomingSlideForeground=e.incomingSlideForeground,r.outgoingSlideForeground=e.outgoingSlideForeground,r.jitter=0,r.m_length=18,r.m_endType=f.MotionType.MotionQuadratic,r.m_doorType=h.FlyDoorTypes.DoorNone,r.m_fFade=!0,r.m_reflectionType=h.FlyReflectionTypes.ReflectionNone,r.m_motionBlurFrames=2,r.m_motionBlurWidth=18,r.m_fOut=e.direction===h.kTransitionEffectOptions.GoOut||e.direction===h.kTransitionEffectOptions.OutBounce,r.hres=4,r.vres=4,r.meshType=d.MeshType.Square,r.factor=1,r.delayFormula=d.DelayFormula.Random,r.m_fUseContent=!0,r.m_bounceTime=15,r.m_bounceDampening=13,e.direction){case h.kTransitionEffectOptions.GoIn:case h.kTransitionEffectOptions.GoOut:r.m_endType=f.MotionType.MotionQuadratic;break;case h.kTransitionEffectOptions.InBounce:case h.kTransitionEffectOptions.OutBounce:r.m_endType=f.MotionType.MotionQuadraticBounce}return r.m_slidingDoorSpeed=20,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.FlyThroughTransitionProperty=y;var _=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).isCenterBufferReq=!0,r.jitter=0,r.m_length=15,r.m_endType=f.MotionType.MotionQuadratic,r.m_doorType=h.FlyDoorTypes.DoorNone,r.m_fFade=!0,r.m_reflectionType=h.FlyReflectionTypes.ReflectionNone,r.m_motionBlurFrames=2,r.m_motionBlurWidth=18,r.m_fOut=e.direction===h.kTransitionEffectOptions.GoOut,r.m_fUseContent=!1,r.m_bounceTime=7,r.m_bounceDampening=13,r.m_slidingDoorSpeed=20,r.hres=4,r.vres=4,r.meshType=d.MeshType.Square,r.factor=1,r.delayFormula=d.DelayFormula.Random,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.ZoomFlyThroughTransitionProperty=_;var S=function(e){function t(e,r){var i;switch((0,c.default)(this,t),(i=m(this,t,[e])).incomingSlideForeground=e.incomingSlideForeground,i.outgoingSlideForeground=e.outgoingSlideForeground,i.isCenterBufferReq=!0,i.jitter=0,i.m_length=18,i.m_endType=f.MotionType.MotionQuadraticHard,e.direction){case h.kTransitionEffectOptions.Horizontal:i.m_doorType=h.FlyDoorTypes.DoorHorizontal,i.m_isX=!0;break;case h.kTransitionEffectOptions.Vertical:i.m_doorType=h.FlyDoorTypes.DoorVertical,i.m_isX=!1;break;default:throw new Error("direction should not be greater than 1")}return i.m_fFade=!1,i.m_motionBlurFrames=2,i.m_motionBlurWidth=18,i.m_fUseContent=r,i.m_slidingDoorSpeed=20,r||(i.m_length=15,i.m_reflectionType=h.FlyReflectionTypes.ReflectionSimple,i.m_slidingDoorSpeed=12),i.m_fOut=!0,i.m_bounceTime=7,i.m_bounceDampening=13,i.m_reflectionType=h.FlyReflectionTypes.ReflectionNone,i.hres=2,i.vres=2,i.meshType=d.MeshType.Square,i.factor=1,i.delayFormula=d.DelayFormula.Random,i}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.DoorsTransitionProperty=S;var T=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).m_fThroughBlack=!1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.CutTransitionProperty=T;var b=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).isCover=!1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.CoverTransitionProperty=b;var C=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).jitter=0,r.incomingSlideForeground=e.incomingSlideForeground,r.outgoingSlideForeground=e.outgoingSlideForeground,r.useContent=!1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.PushTransitionProperty=C;var w=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).direction=e.direction,r.directionFormula=d.Direction2D.CombHorizontal,r.delayFormula=d.DelayFormula.Top,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.CombTransitionProperty=w;var P=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).jitter=0,r.hres=54,r.vres=42,r.factor=7,r.meshType=d.MeshType.Square,r.delayFormula=d.DelayFormula.Random,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.DissolveTransitionProperty=P;var I=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).jitter=0,r.hres=127,r.vres=8,r.factor=9,r.invertDelay=!1,r.meshType=d.MeshType.Radial,r.delayFormula=d.DelayFormula.Clock1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.WheelTransitionProperty=I;var k=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).randomCenters=!1,r.zMovement=10,r.extraDistance=0,r.factor=2,r.jitter=0,r.delayFormula=d.DelayFormula.FromCenter,r.sides=3,r.inverse=!1,r.useContent=!1,r.invertDirection=!1,r.meshType=d.MeshType.Square,r.invertDelay=!r.forward,e.direction!==h.kTransitionEffectOptions.Vertical?(r.hres=18,r.vres=1,r.xAxis=!1):(r.hres=1,r.vres=14,r.xAxis=!0),r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.BlindsTransitionProperty=k;var E=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).factor=2,r.jitter=0,r.delayFormula=d.DelayFormula.FromCenter,r.meshType=d.MeshType.Square,r.hres=1,r.vres=1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.ZoomWithSpinTransitionProperty=E;var x=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).m_rippleType=e.direction,r.invertDelay=!1,r.jitter=0,r.hres=80,r.vres=80,r.factor=1,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.RippleTransitionProperty=x;var L=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).bounceTime=0,r.bounceDampen=0,r.invertDelay=!1,r.jitter=0,r.hres=1,r.vres=1,r.factor=1,r.m_isInvX=!e.direction,r.motionType=f.MotionType.MotionQuadratic,r.m_fUseContent=!1,r.m_fSwivel=!0,r.m_swivelTime=22,r.m_waitTime=0,r.m_swivelZoom=100,r.m_distance=0,r.m_fReflection=!0,r.m_fFadeReflection=!1,r.m_reflectionDistance=1,r.m_swivelAngle=-10,r.meshType=d.MeshType.Square,r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.GalleryTransitionProperty=L;var A=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).incomingSlideForeground=e.incomingSlideForeground,r.outgoingSlideForeground=e.outgoingSlideForeground,r.m_fReflection=!1,r.m_fUseContent=!0,r}return(0,s.default)(t,e),(0,u.default)(t)}(L);t.ConveyorTransitionProperty=A;var M=function(e){function t(e){var r;return(0,c.default)(this,t),(r=m(this,t,[e])).hres=7,r.vres=5,r.factor=4,r.jitter=52,r.zMovement=0,r.xAxis=!1,r.invertDelay=!1,e.direction===h.kTransitionEffectOptions.Horizontal?(r.delayFormula=d.DelayFormula.Left,r.xAxis=!1):(r.delayFormula=d.DelayFormula.Top,r.xAxis=!0),r}return(0,s.default)(t,e),(0,u.default)(t)}(k);t.CheckersTransitionProperty=M;var R=function(e){function t(e){var r;(0,c.default)(this,t),(r=m(this,t,[e])).factor=4,r.jitter=45,r.zMovement=0,r.xAxis=!1,r.invertDelay=!1;var i=Math.floor(e.direction/4);switch(e.direction%4){case h.kTransitionEffectOptions.Right:r.delayFormula=d.DelayFormula.Left,r.invertDelay=!0;break;case h.kTransitionEffectOptions.Bottom:r.delayFormula=d.DelayFormula.Top,r.invertDelay=!0;break;case h.kTransitionEffectOptions.Left:r.delayFormula=d.DelayFormula.Left;break;case h.kTransitionEffectOptions.Top:r.delayFormula=d.DelayFormula.Top}switch(i){case h.kTransitionPattern.PatternDiamond:r.meshType=d.MeshType.Diamond,r.hres=30,r.vres=15;break;case h.kTransitionPattern.PatternHexagon:r.meshType=d.MeshType.Hexagon,r.hres=35,r.vres=16}return r}return(0,s.default)(t,e),(0,u.default)(t)}(k);t.GlitterTransitionProperty=R;var O=function(e){function t(e){var r;switch((0,c.default)(this,t),(r=m(this,t,[e])).hres=128,r.vres=100,r.factor=1,r.jitter=25,r.zMovement=5,r.xAxis=!1,r.invertDelay=!1,e.direction){case h.kTransitionEffectOptions.Right:r.delayFormula=d.DelayFormula.Left;break;case h.kTransitionEffectOptions.Bottom:r.delayFormula=d.DelayFormula.Top,r.xAxis=!0;break;case h.kTransitionEffectOptions.Left:r.delayFormula=d.DelayFormula.Left,r.invertDelay=!0;break;case h.kTransitionEffectOptions.Top:r.delayFormula=d.DelayFormula.Top,r.invertDelay=!0,r.xAxis=!0}return r.randomCenters=!0,r}return(0,s.default)(t,e),(0,u.default)(t)}(k);t.VortexTransitionProperty=O;var D=function(e){function t(e){var r;(0,c.default)(this,t);var i=e.direction%4,n=4==(4&e.direction),a=8==(8&e.direction);!e.forward&&e.direction<8&&(i=(i+2)%4),(r=m(this,t,[e])).hres=1,r.vres=1,r.factor=1,r.sides=10,r.zMovement=10,r.invertDelay=!1,r.inverse=a,r.useContent=n,r.delayFormula=d.DelayFormula.None,r.xAxis=i===h.kTransitionEffectOptions.Top||i===h.kTransitionEffectOptions.Bottom;var o=i===h.kTransitionEffectOptions.Bottom||i===h.kTransitionEffectOptions.Right;return r.invertDirection=a||!a&&!r.forward?!o:o,a&&(r.zMovement=i===h.kTransitionEffectOptions.Left||i===h.kTransitionEffectOptions.Right?-30:-22,r.extraDistance=7),r.incomingSlideForeground=e.incomingSlideForeground,r.outgoingSlideForeground=e.outgoingSlideForeground,r}return(0,s.default)(t,e),(0,u.default)(t)}(k);t.PrismTransitionProperty=D;var F=function(e){function t(e){var r;switch((0,c.default)(this,t),(r=m(this,t,[e])).jitter=0,r.hres=101,r.vres=101,r.factor=1,r.m_dx=3,r.m_dy=0,r.m_dz=6,r.m_deadTime=9,r.m_fInvertXZoomOut=!0,r.m_fTransitionWhite=!0,r.invertDelay=!1,r.useContent=!0,r.meshType=d.MeshType.Smooth,r.delayFormula=d.DelayFormula.Left,r.incomingSlideForeground=e.incomingSlideForeground,r.outgoingSlideForeground=e.outgoingSlideForeground,e.direction){case h.kTransitionEffectOptions.Left:r.m_fTransitionWhite=!0;break;case h.kTransitionEffectOptions.BlackFromLeft:r.invertDelay=!0,r.m_fTransitionWhite=!1;break;case h.kTransitionEffectOptions.Right:r.m_fTransitionWhite=!0;break;case h.kTransitionEffectOptions.BlackFromRight:r.invertDelay=!1,r.m_fTransitionWhite=!1}return r}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.CrossZoomTransitionProperty=F;var B=function(e){function t(e,r,i){var n;return(0,c.default)(this,t),(n=m(this,t,[e])).isInvX=!e.direction,n.indexBuffer=r.IndexBuffer,n.positionBufferList=r.PositionBufferList,n.textureCoordBuffer=r.TextureCoordBuffer,n.effectID=i,n.ambient=0,n}return(0,s.default)(t,e),(0,u.default)(t)}(v);t.CustomTransitionProperty=B;var N=function(e){function t(e,r,i){var n;return(0,c.default)(this,t),(n=m(this,t,[e,r,i])).indexBufferBack=r.IndexBufferBack,n.positionBufferListBack=r.PositionBufferListBack,n.textureCoordBufferBack=r.TextureCoordBufferBack,n}return(0,s.default)(t,e),(0,u.default)(t)}(B);t.CustomTransitionPropertyWithBackBuffer=N},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionWrapper=void 0;var n=i(r(1)),a=i(r(2)),o=r(117),s=r(21),l=(0,a.default)((function e(t){(0,n.default)(this,e),this.transition=t}),[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.MemoryReport;try{this.transition.init(e,t)}catch(e){(0,s.logError)("Exception at Transition init : ".concat(e))}}},{key:"draw",value:function(e){try{return this.transition.draw(e)}catch(e){(0,s.logError)("Exception at Transition draw : ".concat(e))}return!1}},{key:"dispose",value:function(){try{this.transition.dispose()}catch(e){(0,s.logError)("Exception at Transition dispose : ".concat(e))}}}]);t.TransitionWrapper=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReflectionData=function(e,t){for(var r=new Uint8Array(4*e),i=0;i<e;i+=1){var n=i/e;r[4*i+0]=0,r[4*i+1]=0,r[4*i+2]=0,r[4*i+3]=230*Math.pow(n,t)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTransitionResourceId=function(e){var t;switch(e){case i.kTransitionIds.PPT_TRANSITION_AIRPLANE:t="airplanedata.json";break;case i.kTransitionIds.PPT_TRANSITION_FLIP:t="flipdata.json";break;case i.kTransitionIds.PPT_TRANSITION_SWITCH:t="switchdata.json";break;case i.kTransitionIds.PPT_TRANSITION_FALLOVER:t="falloverdata.json";break;case i.kTransitionIds.PPT_TRANSITION_DRAPE:t="drapedata.json";break;case i.kTransitionIds.PPT_TRANSITION_CURTAINS:t="curtainsdata.json";break;case i.kTransitionIds.PPT_TRANSITION_WIND:t="winddata.json";break;case i.kTransitionIds.PPT_TRANSITION_PRESTIGE:t="prestigedata.json";break;case i.kTransitionIds.PPT_TRANSITION_FRACTURE:t="fracturedata.json";break;case i.kTransitionIds.PPT_TRANSITION_CRUSH:t="crushdata.json";break;case i.kTransitionIds.PPT_TRANSITION_PEELOFF:t="peeloffdata.json";break;case i.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:t="pagecurlsingledata.json";break;case i.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:t="pagecurldoubledata.json";break;case i.kTransitionIds.PPT_TRANSITION_ORIGAMI:t="origamidata.json";break;default:return null}return t};var i=r(45)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCostFunction=function(e){return 1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupGlobals_ResourceProvider=function(e){e.logger&&i.ULS.setLogger(e.logger),e.stringifyError&&(t.stringifyError=n=e.stringifyError)},t.stringifyError=void 0;var i=r(3),n=void 0;t.stringifyError=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CriticalAsyncFunctionThrottler=void 0;var i=r(24),n=function(){function e(e,t){this.m_loopRunning=!1,this.m_requests=[],this.m_functionToThrottle=e,this.m_queueHandler=t}return e.prototype.callAsync=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new Promise((function(r,i){e.m_requests.push({resolve:r,reject:i,args:t}),e.m_loopRunning||e.loopAsync()}))},e.prototype.loopAsync=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r,n,a,o,s,l,c,u;return i.__generator(this,(function(i){switch(i.label){case 0:this.m_loopRunning=!0,i.label=1;case 1:if(!(this.m_requests.length>0))return[3,6];e=this.m_queueHandler(Array.from(this.m_requests)),t=e.nextArg,r=e.handledRequests,n=e.remainingRequests,this.m_requests=n,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.m_functionToThrottle.apply(this,t)];case 3:for(a=i.sent(),o=0,s=r;o<s.length;o++)s[o].resolve(a);return[3,5];case 4:for(l=i.sent(),c=0,u=r;c<u.length;c++)u[c].reject(l);return[3,5];case 5:return[3,1];case 6:return this.m_loopRunning=!1,[2]}}))}))},e}();t.CriticalAsyncFunctionThrottler=n},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationLogger=t.BootSegmentType=t.ActionType=void 0;var n,a,o=i(r(5)),s=i(r(1)),l=i(r(2)),c=r(3),u=r(47),d=r(34),h=r(14),f=r(11),m=r(4);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.ActionType=n,function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(n||(t.ActionType=n={})),t.BootSegmentType=a,function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(a||(t.BootSegmentType=a={}));var y=function(){function e(){(0,s.default)(this,e)}return(0,l.default)(e,null,[{key:"init",value:function(e){this.m_settings=e}},{key:"recordInitData",value:function(t){if(t.hasOwnProperty(n.Init)){var r={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:t,initDurFromEndUser:t[n.Init].end-this.m_settings.appSettings.initTime,initDur:t[n.Init].end-t[n.Init].start,Config:u.SessionUtils.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=r.InitInfo);var i={initDur:r.initDur,initDurFromEndUser:r.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(r[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),u.SessionUtils.recordSessionStats(i),c.ULS.sendTraceTag(592483858,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,this.getLogString("SSCoreInit",r))}}},{key:"recordNavData",value:function(t,r,i,a){var o=this;if(i&&0!==Object.keys(i).length&&i.hasOwnProperty("sid")){var s=!1,l=!1,p=!1,g=i.sid.toString();if(a&&a.bootMetrics){if(0===this.m_startFromTime&&(s=!0,this.m_navigationData.hasOwnProperty(g))){var y=this.m_navigationData[g];y.hasOwnProperty(n.Prerender)&&(l=!0),y.hasOwnProperty(n.Prefetch)&&(p=!0)}this.m_startFromTime=a.startFromTime?a.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},a.startFromTime||c.ULS.sendTraceTag(588804161,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(g)||(this.m_navigationData[g]={}),f.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.hasOwnProperty(e.TextureMetadata)&&(i[e.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(e.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[e.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(e.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[e.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(e.RenderToTexture)&&(i.createTransition.rendererEnvironment[e.RenderToTexture]=void 0))),f.ChangeGate.isChangeGateEnabled("FixNavLogTrimming")&&i.hasOwnProperty("missingTextureIds")){var _={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};c.ULS.sendTraceTag(507598877,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnTrimmedData",_)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}var S=this.m_navigationData[g];if(i.hasOwnProperty(this.Metadata)){S.hasOwnProperty(this.Metadata)||(S[this.Metadata]=[]),S[this.Metadata]=S[this.Metadata].concat(i[this.Metadata].filter((function(e){return!S[o.Metadata].includes(e)})));var T=!1;for(var b in i[this.Metadata])if(i[this.Metadata][b].hasOwnProperty(this.MediaInfo)){T=!0;break}T&&!u.SessionUtils.getSessionStats("hasMedia")&&u.SessionUtils.recordSessionStats({hasMedia:!0}),f.ChangeGate.isChangeGateEnabled("ssc.HasMediaPartCDimension")&&T&&h.HealthAdapter.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(f.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMetadata")&&i.hasOwnProperty(this.Metadata)){var C={id:i&&i.id,sr:i&&i.sr,metadata:i[this.Metadata]};c.ULS.sendTraceTag(507597592,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnTrimmedDataMetadata",C)),i[this.Metadata]=void 0,i.hasMetadata=!0}var w=0;if(a&&a.navMetrics&&a.navMetrics.checkHiddenSlideResult&&(w=this.getDuration(a.navMetrics.checkHiddenSlideResult)),!(r===n.Goto&&S.hasOwnProperty(n.Goto)&&i.hasOwnProperty(n.Goto)&&this.getDuration(S[n.Goto])+this.getDuration(S[n.CheckHidden])>=this.getDuration(i[n.Goto])+w||r===n.Prefetch&&S.hasOwnProperty(n.Prefetch))){for(var P in i)if(P===n.Goto)if(S[n.CheckHidden]=w,a&&a.bootMetrics){var I={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:a?a.startFromTime:void 0,bootMetrics:a?a.bootMetrics:void 0,Config:u.SessionUtils.getSessionConfig(),EUPL:a.startFromTime&&0!==a.startFromTime?i[P].end-a.startFromTime:void 0,firstStartMetrics:{firstStart:s}};if(f.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&a&&a.id&&(I.id=a.id),i.hasOwnProperty("pptSpinnerStartTime")&&I.bootMetrics&&(I.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(I.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(I[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(e.Metadata)){var k=this.getMetadataSummary(i[e.Metadata]);k.length>0&&(I[e.Metadata]=k),I.NavigationInfo=Object.keys(i).reduce((function(t,r){return r!==e.Metadata&&(t[r]=i[r]),t}),{})}else I.NavigationInfo=i;I.slideIndex=t.getVisibleSlideIndex({sid:i.sid,cid:0}),f.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=I.slideIndex),s&&(I.firstStartMetrics.prefetched=p,I.firstStartMetrics.prerendered=l),0!==Object.keys(this.m_initInfo).length&&(I.initMetrics=this.m_initInfo),I.EUPL>m.Settings.readNumberOrDefault("vetoBootDurationMs",2e3)&&h.VetoUtils.recordVeto("VetoedSlideShowBootTimeMs",v({qosVeto:"PerceivedOpenSlow"},I)),i.hasOwnProperty(e.GetItemsResult)&&void 0!==i[e.GetItemsResult]&&(I[e.GetItemsResult]=i[e.GetItemsResult]),f.ChangeGate.isChangeGateEnabled("AddSlideDuration")&&(this.m_bootLaunchId=a&&a.id),c.ULS.sendTraceTag(594650330,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,this.getLogString("boot",I))}else a&&!a.bootMetrics&&(i.hasOwnProperty("errorName")||(S[P]=i[P],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(S[this.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(this.NavigationStep)&&0!==i[this.NavigationStep]&&1!==i[this.NavigationStep]&&(S[this.NavigationStep]=i[this.NavigationStep]),a&&a.navigationType&&a.navigationType!==d.NavigationType.Init&&a.navigationType!==d.NavigationType.Next&&a.navigationType!==d.NavigationType.Prev&&(S.navigation=a.navigationType),i.hasOwnProperty(e.CachedInServer)&&(S[e.CachedInServer]=i[e.CachedInServer]),i.hasOwnProperty(e.RequestInfo)&&(S[e.RequestInfo]=i[e.RequestInfo]),i.hasOwnProperty(e.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,this.getDuration(S[P])),this.getDuration(i[P])+w>m.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&h.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",v({qosVeto:"SlideShowNavSlow"},this.m_navigationData[g.toString()])))));else P===n.Prefetch&&(i.hasOwnProperty("errorName")?S.hasOwnProperty("errorCount")?S.errorCount+=1:S.errorCount=1:S[P]=i[P],i.hasOwnProperty(n.Prerender)&&(S[n.Prerender]=i[n.Prerender]),i.hasOwnProperty(e.CachedInServer)&&(S[e.CachedInServer]=i[e.CachedInServer]),i.hasOwnProperty(e.RequestInfo)&&(S[e.RequestInfo]=i[e.RequestInfo]));var E;if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=r,i.startFromTime=this.m_startFromTime,c.ULS.sendTraceTag(594650332,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,e.getLogString("navigation",i)),f.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(E=t.getVisibleSlideIndex({sid:i.sid,cid:0})),f.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&r===n.Goto){var x={id:i&&i.id,navType:a&&a.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(f.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(x.sr=i.sr,x.playTransitionMs=i.playTransitionMs,x.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==E?E-this.m_slideIndexFromBoot:void 0,x.loadSlide=i.LoadSlide,x.fPrepared=i.fPrepared),f.ChangeGate.isChangeGateEnabled("AddSlideDuration"))if(x.bootLaunchId=this.m_bootLaunchId,a&&a.navigationType===d.NavigationType.Init)this.m_userActionTimestamp=u.SessionUtils.performanceNowTrimmed();else if(a&&(a.navigationType===d.NavigationType.Next||a.navigationType===d.NavigationType.Prev||a.navigationType===d.NavigationType.GoTo)){var L=u.SessionUtils.performanceNowTrimmed();x.timeSpentOnPrevSlide=L-this.m_userActionTimestamp,this.m_userActionTimestamp=L,x.navType=a.navigationType}c.ULS.sendTraceTag(507787460,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnnavigation",x))}}}}},{key:"logPerfData",value:function(){var e=this;if(0!==Object.keys(this.m_navigationData).length){var t=[],r=Object.keys(this.m_navigationData).map((function(r){var i=e.m_navigationData[r],a={};return a.id=r,Object.keys(i).forEach((function(r){if(r===n.Goto||r===n.Prefetch||r===n.Prerender)a[r]=e.getDuration(i[r]);else if(r===e.Metadata){var o,s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(i[e.Metadata]);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.hasOwnProperty(e.MediaInfo)&&t.push(l[e.MediaInfo])}}catch(e){s.e(e)}finally{s.f()}var c=e.getMetadataSummary(i[e.Metadata]);c.length>0&&(a[e.Metadata]=c)}else a[r]=i[r]})),a})),i={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:r,Config:u.SessionUtils.getSessionConfig()};u.SessionUtils.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),c.ULS.sendTraceTag(594650331,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,this.getLogString("navSummary",i));var a={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:t,Config:u.SessionUtils.getSessionConfig()};Object.keys(t).length>0&&c.ULS.sendTraceTag(591165197,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,this.getLogString("mediaSummary",a))}}},{key:"getMetadataSummary",value:function(e){var t=[];for(var r in e)if(e[r].hasOwnProperty(this.MediaInfo)){var i=e[r][this.MediaInfo];t.includes(i.type)||t.push(i.type)}else t.includes(e[r])||t.push(e[r]);return t}},{key:"getDuration",value:function(e){return e.end-e.start}},{key:"getLogString",value:function(e,t){if(!t)return"";var r=JSON.stringify(t),i=r.length;return i>3e3&&c.ULS.sendTraceTag(572289234,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"log size is too long! size:".concat(i,", source:").concat(e)),r}}])}();t.NavigationLogger=y,y.m_navigationData={},y.m_maxGotoSlideMs=0,y.m_startFromTime=0,y.m_userActionTimestamp=0,y.m_initInfo={},y.RenderCost="render",y.Metadata="metadata",y.NavigationStep="step",y.CachedInServer="cached",y.PlayTransitionMs="playTransitionMs",y.GetItemsResult="getItemsResult",y.UseSnapDownloadUrlString="useSnap",y.MediaInfo="mediaInfo",y.RequestInfo="requestInfo",y.TextureMetadata="textureMetadata",y.RenderTransitionTextures="renderTransitionTextures",y.GenerateMorphResource="generateMorphResource",y.RenderToTexture="renderToTexture"},function(e,t,r){"use strict";function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function a(e,t){var r,n=i(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.id.toString()===e)return a}}catch(e){n.e(e)}finally{n.f()}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSlideIdFromSection=function(e,t){var r=a(e,t);return r&&r.sldIds.length>0?(r.sldIds[0].cid=0,r.sldIds[0]):null},t.getLastSlideIdFromSection=function(e,t){var r=a(e,t);return r&&r.sldIds.length>0?r.sldIds[r.sldIds.length-1]:null}},function(e,t,r){"use strict";var i,n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCodeManager=t.EditMode=void 0,t.EditMode=a,function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.ConvertAndEdit=2]="ConvertAndEdit",e[e.CopyAndEdit=3]="CopyAndEdit",e[e.ContinueEditing=4]="ContinueEditing"}(a||(t.EditMode=a={}));var o=((i={}).errorCodes=((n={}).ooeSuccess=0,n.ooeCoercionTypeNotSupported=1e3,n.ooeInternalError=5001,n.ooeDocumentReadOnly=5002,n.ooeInvalidApiCallInContext=5004,n.ooeUnsupportedEnumeration=5007,n.ooeCannotNavTo=7001,n.ooeSpecifiedIdNotExist=7002,n.ooeNavOutOfBound=7004,n),i);t.ErrorCodeManager=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppForOffice=t.AppForOfficeShape=t.AppForOfficeReference=void 0;var i=function(){function e(e,t,r,i){this.m_id=e,this.m_version=t,this.m_store=r,this.m_storeType=i}return Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Version",{get:function(){return this.m_version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Store",{get:function(){return this.m_store},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StoreType",{get:function(){return this.m_storeType},enumerable:!1,configurable:!0}),e}();t.AppForOfficeReference=i;var n=function(){function e(e,t,r,i,n,a){this.m_osfControlType=e,this.m_id=t,this.m_top=r,this.m_left=i,this.m_width=n,this.m_height=a}return Object.defineProperty(e.prototype,"OsfControlType",{get:function(){return this.m_osfControlType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Top",{get:function(){return this.m_top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Left",{get:function(){return this.m_left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Width",{get:function(){return this.m_width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Height",{get:function(){return this.m_height},enumerable:!1,configurable:!0}),e}();t.AppForOfficeShape=n;var a=function(){function e(e,t,r,i){this.m_appForOfficeRef=e,this.m_instanceId=t,this.m_shape=r,this.m_settings=i}return Object.defineProperty(e.prototype,"AppForOfficeRef",{get:function(){return this.m_appForOfficeRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"InstanceId",{get:function(){return this.m_instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Shape",{get:function(){return this.m_shape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this.m_settings},enumerable:!1,configurable:!0}),e}();t.AppForOffice=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TimeoutClock=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t,r,i){(0,n.default)(this,e),this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=t,this.m_timeoutMs=r,this.m_startTimeMs=Date.now(),this.updateTimeout()}),[{key:"pause",value:function(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}},{key:"resume",value:function(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}},{key:"setTime",value:function(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}},{key:"addTime",value:function(e){this.m_timeoutMs+=e,this.updateTimeout()}},{key:"abort",value:function(){window.clearTimeout(this.m_timeoutId),this.m_callback=function(){}}},{key:"isPaused",get:function(){return this.m_pausedTimeMs>this.m_resumedTimeMs}},{key:"updateTimeout",value:function(){window.clearTimeout(this.m_timeoutId);var e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}}]);t.TimeoutClock=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowDataParser=void 0;var n=i(r(6)),a=i(r(18)),o=i(r(7)),s=i(r(19)),l=i(r(1)),c=i(r(2)),u=r(3),d=r(46),h=r(52),f=r(14),m=r(11),p=r(4),g=r(97),v=r(47),y=r(81);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var T=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,null,[{key:"getDataFromSlideInfoAndImages",value:function(t,r,i){if(t.SlideShowInfo){var n,a=t.SlideShowInfo,o=a.sld[0];if(o.bg.Item.hasOwnProperty("imgID")){var l=o.bg.Item;n={imageFill:{imgID:l.imgID,rect:{left:l.x,top:l.y,right:l.x+l.w,bottom:l.y+l.h}},solidFill:void 0}}else{var c=o.bg.Item;n={imageFill:void 0,solidFill:{r:c.clr[0],g:c.clr[1],b:c.clr[2],t:c.transp}}}var h=[],S=void 0,T=void 0;p.Settings.readBooleanOrDefault("enableAddinViewElement",!1)&&o.appLst&&o.appLst.length>0&&(o.appLst.forEach((function(e){var t=g.AppForOfficeLoader.createAppForOfficeByOsfExtensibleDataObject(e);t&&h.push(t)})),o.appThm&&(S=g.AppForOfficeLoader.readAppForOfficeTheme(o.appThm)),T=h.length>0);var b=[],C=function(e,t){return e.slideId.sid===t.slideId.sid&&e.shapeId===t.shapeId};if(p.Settings.readBooleanOrDefault("backfillMissingSpId",!1)){var w,P=_(o.spLst);try{var I=function(){for(var e=w.value,r=651231861351;o.spLst.some((function(e){return e.spId&&e.spId.spId===r}));)r+=1;e.spId||(u.ULS.sendTraceTag(509117653,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Warning,"Backfilling missing spId for shape"),e.spId={sldId:t.ID.sid,spId:r})};for(P.s();!(w=P.n()).done;)I()}catch(e){P.e(e)}finally{P.f()}}var k,E=[],x=_(o.spLst);try{var L=function(){var e=k.value,t={slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId};E.some((function(e){return C(t,e)}))||E.push(t)};for(x.s();!(k=x.n()).done;)L()}catch(e){x.e(e)}finally{x.f()}var A=E.map((function(e){return{id:e}}));e.adjustMediaAnimations(o);for(var M=!1,R=function(){var r=D[O],i=null;if(o.sbLst){var n=o.sbLst.filter((function(e){return e.spId.sldId===r.slideId.sid&&e.spId.spId===r.shapeId}));n.length>0&&(i=n[0].sb)}i||M||(f.VetoUtils.recordVeto("ContentFallback",{slideId:o.id,ShapeId:r.shapeId,errorName:"ShapeBuilderNotSupportedForShape",qosVeto:"ContentFallback",isIntentional:!0}),m.ChangeGate.isChangeGateEnabled("SSC.ReduceVetoVolumeForSB")&&(M=!0));var a,l,c,g,v,y=o.spLst?o.spLst.filter((function(e){return C(r,{slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId})})):[],T=[],w=[],P=!1,I=_(y);try{var k=function(){var n=v.value;n.bgSp&&(P=!0);var h=[],f=function(e,t){return{region:{imgID:e.imgID,rect:{left:e.x,top:e.y,right:e.x+e.w,bottom:e.y+e.h}},pos:new d.Vector2(t.x,t.y)}},m=n.bapis||[];if(i&&n.smlprts){var g,y=n.smlprts,S=2===y.by?d.SplitBy.letter:1===y.by?d.SplitBy.word:d.SplitBy.whole,b=f(n.reg,n.pos);n.children&&(g=n.children.map((function(e){return f(e.reg,e.pos)})));var C={begin:y.trBegin,length:y.trLength,type:1===y.trType?d.TextRangeType.paragraph:d.TextRangeType.character};h.push({fShape:!!y.fSp,fText:!!y.fTx,bigParts:m,regionPos:b,childrenRegionPos:g,splitBy:S,textRange:C,shapeId:r})}else if(i)h.push({fShape:!0,fText:!0,bigParts:m,regionPos:f(n.reg,n.pos),splitBy:d.SplitBy.whole,shapeId:r});else if(n.children){var I,k=_(n.children.entries());try{for(k.s();!(I=k.n()).done;){var E=(0,s.default)(I.value,2),x=E[0],L=E[1];h.push({fShape:!0,fText:!0,bigParts:["".concat(n.id,"c").concat(x)],regionPos:f(L.reg,L.pos),splitBy:d.SplitBy.whole,shapeId:r})}}catch(e){k.e(e)}finally{k.f()}}else h.push({fShape:!0,fText:!0,bigParts:[n.id.toString()],regionPos:f(n.reg,n.pos),splitBy:d.SplitBy.whole,shapeId:r});var A=n.id.toString();if(T.push({id:A,parts:h}),n.clckTgts){var M,R=new Map,O=_(n.clckTgts);try{for(O.s();!(M=O.n()).done;){var D=M.value;if("CT_Hyperlink:#p"===D.__type){var F=JSON.stringify({tip:D.tip,url:D.url});R.has(F)?R.get(F).push(D):R.set(F,[D])}else if("CT_Action:#p"===D.__type)w.push({action:{region:{left:D.rct.l,right:D.rct.l+D.rct.w,top:D.rct.t,bottom:D.rct.t+D.rct.h},slideId:{sid:D.sldId,cid:0},animatableContentId:A}});else if("CT_InteractiveAnimUse:#p"===D.__type)w.push({animation:{region:{left:D.rct.l,right:D.rct.l+D.rct.w,top:D.rct.t,bottom:D.rct.t+D.rct.h},sequenceId:D.seqId,animatableContentId:A}});else if("CT_MediaCtrl:#p"===D.__type)w.push({mediaCtrl:{region:{left:D.rct.l,right:D.rct.l+D.rct.w,top:D.rct.t,bottom:D.rct.t+D.rct.h},elemId:D.elemId,animatableContentId:A}});else if(p.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&"CT_SlideSectionSummaryZoom:#p"===D.__type)if(u.ULS.sendTraceTag(522311768,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Info,"Summary Zoom detected in Parser"),0===D.zmType){var B,N=_(D.zmObj);try{for(N.s();!(B=N.n()).done;){var V=B.value;w.push({zoom:{type:d.ZoomType.Section,region:{left:V.rct.l,right:V.rct.l+V.rct.w,top:V.rct.t,bottom:V.rct.t+V.rct.h},sectionId:V.sctnId,transitionTime:V.transDur,returnToParent:V.rtn,animatableContentId:A}})}}catch(e){N.e(e)}finally{N.f()}}else 2===D.zmType?w.push({zoom:{type:d.ZoomType.Slide,region:{left:D.zmObj[0].rct.l,right:D.zmObj[0].rct.l+D.zmObj[0].rct.w,top:D.zmObj[0].rct.t,bottom:D.zmObj[0].rct.t+D.zmObj[0].rct.h},slideId:{sid:D.zmObj[0].sldId,cid:0},transitionTime:D.zmObj[0].transDur,returnToParent:D.zmObj[0].rtn,animatableContentId:A}}):1===D.zmType&&w.push({zoom:{type:d.ZoomType.Section,region:{left:D.zmObj[0].rct.l,right:D.zmObj[0].rct.l+D.zmObj[0].rct.w,top:D.zmObj[0].rct.t,bottom:D.zmObj[0].rct.t+D.zmObj[0].rct.h},sectionId:D.zmObj[0].sctnId,transitionTime:D.zmObj[0].transDur,returnToParent:D.zmObj[0].rtn,animatableContentId:A}})}}catch(e){O.e(e)}finally{O.f()}var U,W=_(R.values());try{for(W.s();!(U=W.n()).done;){var G=U.value;if(0!==G.length){var H,j={left:G[0].rct.l,right:G[0].rct.l+G[0].rct.w,top:G[0].rct.t,bottom:G[0].rct.t+G[0].rct.h},z=[],q=_(G);try{for(q.s();!(H=q.n()).done;){var Z=H.value,X={left:Z.rct.l,right:Z.rct.l+Z.rct.w,top:Z.rct.t,bottom:Z.rct.t+Z.rct.h};z.push(X),j.left=Math.min(X.left,j.left),j.top=Math.min(X.top,j.top),j.right=Math.max(X.right,j.right),j.bottom=Math.max(X.bottom,j.bottom)}}catch(e){q.e(e)}finally{q.f()}w.push({hyperlink:{region:j,subRegions:z,url:G[0].url,tip:G[0].tip,desc:G[0].desc,animatableContentId:A}})}}}catch(e){W.e(e)}finally{W.f()}}a||(a=e.readMedia(n.media,r,t.AccessibilityModel)),!l&&n.reg.isGif&&(l=e.readGif(t.MediaUrls,o.resCat,n.reg.imgID)),c||(c=e.readCameo(n.lf))};for(I.s();!(v=I.n()).done;)k()}catch(e){I.e(e)}finally{I.f()}g||(g=h.find((function(e){return e.Shape.Id===r.shapeId})));var E={shapeId:r,isBackground:P,animatableContents:T,shapeBuilderData:i,clickTargets:w,media:a,gif:l,cameo:c,appForOffice:g,appForOfficeTheme:S};b.push(E)},O=0,D=E;O<D.length;O++)R();var F=e.parseResCat(o);F=F.map((function(e){var t=i.get(e.id);return!e.url&&t?t:e}));try{var B=v.SessionUtils.performanceNowTrimmed(),N=F.filter((function(t){return!e.isShapebuilderImage(t)})),V=F.filter((function(t){return e.isShapebuilderImage(t)})),U=p.Settings.readBooleanOrDefault("logPayloadBreakdownExpensiveChecks",!1),W={ExpensiveChecks:U,SlideInfoSize:U?JSON.stringify(a).length:0,SBDataSize:o.sbLst?JSON.stringify(o.sbLst).length:0,GlyphDataSize:o.glyps?JSON.stringify(o.glyps).length:0,FallbackImagesSize:N.reduce((function(e,t){return e+t.byteCount}),0),SBImageDataSize:V.reduce((function(e,t){return e+t.byteCount}),0)};u.ULS.sendTraceTag(528773919,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Info,"".concat(JSON.stringify(W),", TimeTaken: ").concat(v.SessionUtils.performanceNowTrimmed()-B,"ms"))}catch(e){u.ULS.sendTraceTag(509130515,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Warning,"logPayload ex: ".concat((0,y.stringifyException)(e)))}var G={x:a.viewSize.w,y:a.viewSize.h},H=void 0;if(o.trans){var j=void 0;if(o.trans.morph){var z,q=o.trans.morph,Z=function(e){return e/65536},X=function(e){return e?e*Math.PI/180:0},Y=function(e){if(e&&e.data&&!(e.data.length<1)){for(var t=new Float32Array(e.w*e.h*2),r=0;r<e.h;r+=1)for(var i=r*e.w,n=0;n<e.w;n+=1){var a=2*(n+r*e.w);t[a]=Z(e.data[n+i].x),t[a+1]=Z(e.data[n+i].y)}return{size:new d.Vector2(e.w,e.h),data:t}}},J=function(e){var t,r=[],i=_(e.spIdLst||[]);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=void 0;n.txtRng&&(a={begin:n.txtRng.cp,length:n.txtRng.len,type:d.TextRangeType.character});var o={shapeId:n.id?{slideId:{sid:n.id.sldId,cid:0},shapeId:n.id.spId}:void 0,bigPart:n.bapi?n.bapi.v:void 0,isSubtreeIncluded:n.incSub&&n.incSub.v,textRange:a,animatableContentId:n.spId,animatablePartIndicies:n.chdSpLst?n.chdSpLst.split(" ").map((function(e){return parseInt(e,10)})):[]};r.push(o)}}catch(e){i.e(e)}finally{i.f()}var s=e.imageID?{imgID:e.imageID,rect:{bottom:e.tb,left:e.tl,right:e.tr,top:e.tt}}:void 0;if(0!==r.length||s||e.isBg)return{parts:r,fallbackImage:s,angleRadians:X(Z(-e.a2)),center:new d.Vector2(e.cx,e.cy),flipX:e.flipX,flipY:e.flipY,isBg:e.isBg,size:new d.Vector2(e.w,e.h),zIndex:Z(e.z),grid:Y(e.grid)}},K=[],Q=_(q);try{var $=function(){var e=z.value,t=J(e.keyFrameA),r=J(e.keyFrameB);if(t&&r){var i=function(e){return function(e,t){return(e%t+t)%t}(e,2*Math.PI)},n=i(t.angleRadians),a=i(X(Z(-e.keyFrameA.am))),o=new d.Vector2(Math.cos(n),Math.sin(n)),s=new d.Vector2(Math.cos(a),Math.sin(a)),l=s.x*o.y-s.y*o.x>0;K.push({keyFrameA:t,keyFrameB:r,rotateClockwise:l})}else K.push({keyFrameA:t,keyFrameB:r})};for(Q.s();!(z=Q.n()).done;)$()}catch(e){Q.e(e)}finally{Q.f()}j={elements:K,slideSizePixels:G}}H={morph:j,type:o.trans.type,dir:o.trans.dir,dur:o.trans.dur,stopSound:o.trans.stopSound}}var ee,te=this.parseAccessibilityJSON(r,t.ID,t.Title,t.AccessibilityModel),re={slideId:t.ID,slideSizePixels:G,slideBackground:n,shapeGlyph:o.glyps,resCat:F,fHasAddinShape:T,transData:H,accessibilityModelPromise:te},ie=[],ne={AnimationList:[],SequenceId:"0_anim"},ae=_(o.animLst.anim||[]);try{for(ae.s();!(ee=ae.n()).done;){var oe=ee.value;ne.AnimationList.push(this.createAnimation(oe))}}catch(e){ae.e(e)}finally{ae.f()}ie.push(ne);var se,le=_(o.animSeqs||[]);try{for(le.s();!(se=le.n()).done;){var ce,ue=se.value,de={AnimationList:[],SequenceId:ue.id.toString()},he=_(ue.anim);try{for(he.s();!(ce=he.n()).done;){var fe=ce.value;de.AnimationList.push(this.createAnimation(fe))}}catch(e){he.e(e)}finally{he.f()}ie.push(de)}}catch(e){le.e(e)}finally{le.f()}o.fontSubs&&e.logFontMissing(o.fontSubs);var me={id:re.slideId,spLst:A,hidden:o.hidden,animSeqs:ie,ssTimes:this.readSlideAdvanceSettings(o.ssTimes),title:t.Title};this.adjustAutoAdvanceTiming(me);try{0===me.spLst.length&&!me.title&&0===b.length&&re.slideBackground.solidFill&&255===re.slideBackground.solidFill.r&&255===re.slideBackground.solidFill.g&&255===re.slideBackground.solidFill.b&&0===re.slideBackground.solidFill.t&&0===re.resCat.length&&void 0===re.transData&&u.ULS.sendTraceTag(506823050,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Warning,"SSC received blank white slide (not even any placeholders)")}catch(e){u.ULS.sendTraceTag(506823049,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Error,"Exception while checking for blank white slide ".concat((0,y.stringifyException)(e)))}return{slide:me,slideViewData:re,shapeViewDatas:b}}}},{key:"isShapebuilderImage",value:function(e){return e.name.endsWith(".sb")||e.id.includes("_SB_")||/^[0-9]+_[0-9]+/.test(e.id)}},{key:"logFontMissing",value:function(t){var r,i=!1,n=!1,a=!1,o=_(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(!s.e)switch(s.c){case 1:i=!0;break;case 2:n=!0;break;case 3:a=!0}}}catch(e){o.e(e)}finally{o.f()}!e.s_fLoggedFirstPartyFontMissing&&i&&(f.VetoUtils.recordVeto("SSFontMissingFirstParty",{qosVeto:"MissingFont"}),e.s_fLoggedFirstPartyFontMissing=!0),!e.s_fLoggedThirdPartyFontMissing&&n&&(f.VetoUtils.recordVeto("SSFontMissingThirdParty",{qosVeto:"MissingFont"}),e.s_fLoggedThirdPartyFontMissing=!0),!e.s_fLoggedCustomFontMissing&&a&&(f.VetoUtils.recordVeto("SSFontMissingCustom",{qosVeto:"MissingFont"}),e.s_fLoggedCustomFontMissing=!0)}},{key:"parseResCat",value:function(e){var t=[];if(e.resCat){var r,i=_(e.resCat);try{var n=function(){var e=r.value,i=t.findIndex((function(t){return t.id===e.id}));if(-1!==i){if(""!==t[i].url)return 0;var n=e.base64;return t[i].url=n,t[i].mimeType=n.substr(5).split(",")[0],t[i].byteCount=n.length,t[i].urlType=d.UrlType.Base64,0}t.push({id:e.id,name:e.name,url:e.base64,byteCount:e.base64.length,urlType:d.UrlType.Base64,mimeType:e.base64.substr(5).split(",")[0],size:{width:e.size?e.size.w:0,height:e.size?e.size.h:0}})};for(i.s();!(r=i.n()).done;)n()}catch(e){i.e(e)}finally{i.f()}}return t}},{key:"adjustMediaAnimations",value:function(e){if(e&&e.animLst&&e.animLst.anim){var t,r=!0,i=_(e.animLst.anim);try{var n=function(){var i=t.value;if(i.cmd&&""!==i.cmd&&0!==i.timing.st){if(e.spLst){var n=e.spLst.filter((function(e){return e.id-1===i.sp}))[0];if(n)if(n.media){var a=n.media.Item;a?(a.autoPlay&&(r?(delete e.animLst.anim[e.animLst.anim.indexOf(i)],u.ULS.sendTraceTag(554009217,u.LogCategory.msoulscat_Wac_PptAnimation,u.TraceLevel.Info,"Deleted AutoPlay media animation, sld.id: ".concat(e.id,", shape.id: ").concat(n.id,", media.name: ").concat(n.media.name,", animation.cmd: ").concat(i.cmd,", animation.timing.st: ").concat(i.timing.st))):a.autoPlay=!1),i&&(i.timing.st=0)):u.ULS.sendTraceTag(554009218,u.LogCategory.msoulscat_Wac_PptAnimation,u.TraceLevel.Info,"Unable to get mediaItem from shape.media.Item, sld.id: ".concat(e.id,", shape.id: ").concat(n.id,", media.name: ").concat(n.media.name))}else u.ULS.sendTraceTag(554008658,u.LogCategory.msoulscat_Wac_PptAnimation,u.TraceLevel.Info,"Shape.media was null, did we use the wrong shape id? sld.id: ".concat(e.id,", shape.id: ").concat(n.id))}}else r=!1};for(i.s();!(t=i.n()).done;)n()}catch(e){i.e(e)}finally{i.f()}for(var a=e.animLst.anim.length-1;a>=0;a-=1)e.animLst.anim[a]||e.animLst.anim.splice(a,1)}}},{key:"adjustAutoAdvanceTiming",value:function(e){if(e.ssTimes&&e.ssTimes.autoAdv){for(var t=e.animSeqs.filter((function(e){return"0_anim"===e.SequenceId}))[0].AnimationList,r=0,i=0,n=0;n<t.length;n+=1){var a=0;a="def"===t[n].animSpeed?1e3:"sld"===t[n].animSpeed||"clk"===t[n].animSpeed?0:Number.parseInt(t[n].animSpeed,10),t[n].autoReverse&&(a*=2),t[n].numRepeats>0&&(a*=t[n].numRepeats+1),a+=t[n].timeOffs,t[n].startTrig!==h.AnimStartTrig.WithPrevious?(i+=r,r=a,t[n].startTrig!==h.AnimStartTrig.OnClick||e.ssTimes.clickTimes||(t[n].startTrig=h.AnimStartTrig.AfterPrevious)):r=Math.max(r,a)}i+=r,e.ssTimes.autoAdvTime=Math.ceil(Math.max(i,1e3*e.ssTimes.autoAdvTime)/1e3)}}},{key:"readSlideAdvanceSettings",value:function(e){return{manualAdv:!e||e.manualAdv,autoAdv:!!e&&e.autoAdv,autoAdvTime:e?e.autoAdvTime/1e3:0,clickTimes:e&&e.clickTimes?e.clickTimes.split(";").map((function(e){return parseFloat(e)})):void 0}}},{key:"getTableText",value:(S=(0,o.default)(n.default.mark((function e(t,r,i){var a,o,s,l,c,u,d,h,f,m,p,g,v,y,S,T,b,C,w,P,I,k,E,x;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasOwnProperty("val")){e.next=2;break}return e.abrupt("return",this.getImgElement(t.val,r));case 2:for(a=document.createElement("table"),o=t.r,s=t.c,l=t.frhead,c=t.lrhead,u=t.fchead,d=t.lchead,h=[],f=0;f<o;f+=1)for(h[f]=[],m=0;m<s;m+=1)h[f][m]=!0;p=-1,g=-1,v=document.createElement("tr"),y=_(t.txt),e.prev=15,y.s();case 17:if((S=y.n()).done){e.next=43;break}if(T=S.value,h[T.r][T.c]){e.next=21;break}return e.abrupt("continue",41);case 21:if(T.r!==p&&(p=T.r,T.r>0&&a.appendChild(v),v=document.createElement("tr")),g=T.c,C=0===g&&u||g===s-1&&d,w=(b=0===p&&l||p===o-1&&c)||C?document.createElement("th"):document.createElement("td"),!T.txthtml){e.next=34;break}return e.next=30,this.getDivForRichHtmlText(T.txthtml);case 30:P=e.sent,w.appendChild(P),e.next=37;break;case 34:(I=document.createElement("p")).textContent=i,w.appendChild(I);case 37:if(T.rs)for(w.setAttribute("rowspan","".concat(T.rs)),k=p+1;k<p+T.rs;k+=1)h[k][g]=!1;if(T.cs)for(w.setAttribute("colspan","".concat(T.cs)),E=g+1;E<g+T.cs;E+=1)if(h[p][E]=!1,T.rs)for(x=p+1;x<p+T.rs;x+=1)h[x][E]=!1;b?w.setAttribute("scope","col"):C&&w.setAttribute("scope","row"),v.appendChild(w);case 41:e.next=17;break;case 43:e.next=48;break;case 45:e.prev=45,e.t0=e.catch(15),y.e(e.t0);case 48:return e.prev=48,y.f(),e.finish(48);case 51:return a.appendChild(v),e.abrupt("return",a);case 53:case"end":return e.stop()}}),e,this,[[15,45,48,51]])}))),function(e,t,r){return S.apply(this,arguments)})},{key:"getSpanForText",value:function(e,t){var r=document.createElement("span");return r.innerText=e,t&&(r.lang=t),r}},{key:"getDivForRichHtmlText",value:(i=(0,o.default)(n.default.mark((function e(t){var i,a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=document.createElement("div"),e.next=3,r.e(12).then(r.t.bind(null,465,7));case 3:return a=e.sent,o=m.ChangeGate.isChangeGateEnabled("SSC.UseDOMPurifyDefaultExport")&&a.default||a,s=o.sanitize(t),i.innerHTML=s,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"getImgElement",value:function(e,t){var r=document.createElement("img");return t&&r.setAttribute("aria-roledescription",t),e.replace(/(\r\n|\n|\r)/gm,". "),r.setAttribute("src","data:,"),r.setAttribute("alt",e),r}},{key:"parseAccessibilityJSON",value:(t=(0,o.default)(n.default.mark((function e(t,r,i,a){var o,s,l,c,u,d,h,f,m,p,g,v,y,S,T;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=document.createElement("div")).id="InnerAccessibilityElement",o.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),s=[],l="",a){e.next=7;break}return e.abrupt("return",{accessibilityInnerDiv:o,slideTitleString:l,shapeAccessibilityDataList:s});case 7:if(c=JSON.parse(a),u=c.shp,!i){e.next=13;break}l=i,e.next=31;break;case 13:d=_(u),e.prev=14,d.s();case 16:if((h=d.n()).done){e.next=23;break}if("Title"!==(f=h.value).tp){e.next=21;break}return l=f.val,e.abrupt("break",23);case 21:e.next=16;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(14),d.e(e.t0);case 28:return e.prev=28,d.f(),e.finish(28);case 31:m=t.findIndex((function(e){return e.sid===r.sid})),p=this.getLocalizedString(),o.appendChild(this.getSpanForText(p.slideContentStr.replace("{0}","".concat(m+1)))),g=_(u),e.prev=35,g.s();case 37:if((v=g.n()).done){e.next=86;break}if(y=v.value,S={tp:y.tp,lang:y.lang,id:y.id,txthtml:y.txthtml,slideId:r,shapeId:y.id,val:this.getSpanForText("".concat(y.val))},"Title"!==y.tp){e.next=43;break}e.next=83;break;case 43:if("Subtitle"!==y.tp){e.next=48;break}o.appendChild(this.getImgElement(y.val,p.subtitleStr)),S.val=this.getImgElement(y.val,p.subtitleStr),e.next=83;break;case 48:if("Text"!==y.tp){e.next=61;break}if(!y.txthtml){e.next=55;break}return e.next=52,this.getDivForRichHtmlText(y.txthtml);case 52:e.t1=e.sent,e.next=56;break;case 55:e.t1=this.getImgElement(y.val,p.shapeStr);case 56:T=e.t1,o.appendChild(T),S.val=T,e.next=83;break;case 61:if("SmartArt"!==y.tp){e.next=66;break}o.appendChild(this.getImgElement(y.val,p.smartartStr)),S.val=this.getImgElement(y.val,p.smartartStr),e.next=83;break;case 66:if("Chart"!==y.tp){e.next=71;break}o.appendChild(this.getImgElement(y.val,p.chartStr)),S.val=this.getImgElement(y.val,p.chartStr),e.next=83;break;case 71:if("Table"!==y.tp){e.next=82;break}return e.t2=o,e.next=75,this.getTableText(y,p.tableStr,p.blankTableCellStr);case 75:return e.t3=e.sent,e.t2.appendChild.call(e.t2,e.t3),e.next=79,this.getTableText(y,p.tableStr,p.blankTableCellStr);case 79:S.val=e.sent,e.next=83;break;case 82:"Group"===y.tp?(o.appendChild(this.getImgElement(y.val,p.groupStr)),S.val=this.getImgElement(y.val,p.groupStr)):"Picture"===y.tp&&(o.appendChild(this.getImgElement(y.val)),S.val=this.getImgElement(y.val));case 83:s.push(S);case 84:e.next=37;break;case 86:e.next=91;break;case 88:e.prev=88,e.t4=e.catch(35),g.e(e.t4);case 91:return e.prev=91,g.f(),e.finish(91);case 94:return e.abrupt("return",{accessibilityInnerDiv:o,slideTitleString:l,shapeAccessibilityDataList:s});case 95:case"end":return e.stop()}}),e,this,[[14,25,28,31],[35,88,91,94]])}))),function(e,r,i,n){return t.apply(this,arguments)})},{key:"getLocalizedString",value:function(){return"undefined"!=typeof PowerpointSlideshowStrings?{slideContentStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideContentStr,subtitleStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSubtitle,smartartStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSmartArt,chartStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelChart,tableStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelTable,groupStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelGroup,shapeStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelShape,blankTableCellStr:PowerpointSlideshowStrings.BlankTableCellLabel}:{slideContentStr:"Slide {0} Content:",subtitleStr:"Subtitle",smartartStr:"Smart Art",chartStr:"Chart",tableStr:"Table",groupStr:"Group",shapeStr:"Shape",blankTableCellStr:"Blank Cell"}}},{key:"createAnimation",value:function(t){var r=e.readAnimationScale(t);return{after:e.readAnimAfterEffectType(t),animSpeed:t.timing.spd||"def",autoReverse:t.autoRev,childTimeInc:t.iter?t.iter.interval:-1,direction:t.dir,effectId:t.effectId,effectType:e.readAnimEffectCategory(t.effectType),motionPath:e.readMotionPath(t.mp),numRepeats:e.readRepeatSetting(t.repeat),animatedPropertyList:e.readAnimatedPropertyList(t.propLst),rewind:t.rewind,rotAngDegrees:t.rotAng/1e3,scaleByXPercent:r.x,scaleByYPercent:r.y,shapeId:t.sp.toString(),smoothEndFactor:t.smEnd/100,smoothStartFactor:t.smSt/100,startTrig:e.readAnimStartTrigType(t.timing.st),timeOffs:t.timing.off,transparencyAmountPercent:t.transp,rewindChildDelay:0,mediaCmd:t.cmd}}},{key:"readMotionPath",value:function(t){if(t){for(var r=[],i=0;i<t.Items.length;i+=1){var n=e.readMotionPathCommand(t.Items[i]);n&&r.push(n)}return{commandList:r,fReversed:t.rev}}}},{key:"readMotionPathCommand",value:function(e){if("CT_MotionPathMoveCmd:#p"===e.__type){var t=e;return{type:h.MotionPathCommandType.MoveTo,end:{x:t.x,y:t.y}}}if("CT_MotionPathLineCmd:#p"===e.__type){var r=e;return{type:h.MotionPathCommandType.LineTo,end:{x:r.x,y:r.y}}}if("CT_MotionPathCurveCmd:#p"===e.__type){var i=e,n={x:i.x1,y:i.y1},a={x:i.x2,y:i.y2},o={x:i.x3,y:i.y3};return{type:h.MotionPathCommandType.CurveTo,control1:n,control2:a,end:o}}u.ULS.sendTraceTag(595638296,u.LogCategory.msoulscat_Wac_PptAnimation,u.TraceLevel.Info,"readMotionPathCommand: : unrecognized command type, ignoring.")}},{key:"readAnimationScale",value:function(e){return e.scaleBy?new d.Vector2(e.scaleBy.x/1e3,e.scaleBy.y/1e3):new d.Vector2(100,100)}},{key:"readAnimAfterEffectType",value:function(e){return 1===e.hideAfter?h.AnimAfterEffectType.HideImmediatelyAfter:2===e.hideAfter?h.AnimAfterEffectType.HideOnNextClick:h.AnimAfterEffectType.None}},{key:"readAnimEffectCategory",value:function(e){var t;switch(e){case 1:t=h.AnimEffectCategory.Exit;break;case 2:t=h.AnimEffectCategory.Emphasis;break;case 3:t=h.AnimEffectCategory.MotionPath;break;case 5:t=h.AnimEffectCategory.Media;break;default:t=h.AnimEffectCategory.Entrance}return t}},{key:"readRepeatSetting",value:function(e){if(e)switch(e.type){case 2:return-1;case 1:return-2;case 0:return e.count;default:return 0}return 0}},{key:"readAnimatedPropertyList",value:function(e){if(e&&0!==e.length){var t,r=[],i=_(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.push({name:n.name,times:n.times.split(";").map((function(e){return parseFloat(e)})),values:n.values.split(";").map((function(e){return parseFloat(e)}))})}}catch(e){i.e(e)}finally{i.f()}return r}}},{key:"readAnimStartTrigType",value:function(e){switch(e){case 1:return h.AnimStartTrig.WithPrevious;case 2:return h.AnimStartTrig.AfterPrevious;default:return h.AnimStartTrig.OnClick}}},{key:"readMedia",value:function(t,r,i){if(t){var n=t.Item,o="";if(i){var s,l=JSON.parse(i),c=_(l&&l.shp);try{for(c.s();!(s=c.n()).done;){var d=s.value;if(d.id===r.shapeId){o=d.val;break}}}catch(e){c.e(e)}finally{c.f()}}if("CT_MediaLink:#p"===n.__type){var h=t.Item;return{isLocal:!1,src:h.src,contentType:h.ct,name:t.name,autoPlay:h.autoPlay,repeat:e.translateMediaRepeat(h.repeat),fullscreen:h.fullscreen,playAcrossSlides:h.playAcrossSlides,hideWhenStopped:h.hideWhenStopped,trimStartMs:h.trimStart,trimEndMs:h.trimEnd,volume:h.volume,ariaLabel:o,narration:h.narration}}if("CT_MediaLocal:#p"===n.__type){var m=t.Item;return{isLocal:!0,src:m.src,contentType:m.ct,name:t.name,autoPlay:m.autoPlay,repeat:e.translateMediaRepeat(m.repeat),fullscreen:m.fullscreen,playAcrossSlides:m.playAcrossSlides,hideWhenStopped:m.hideWhenStopped,trimStartMs:m.trimStart,trimEndMs:m.trimEnd,volume:m.volume,bmkLst:m.bmkLst?(0,a.default)(m.bmkLst):[],ariaLabel:o,tracksInfo:m.tracksInfo,cropInfo:{left:m.cl,top:m.ctop,right:m.cr,bottom:m.cb},narration:m.narration}}if("CT_Error:#p"===n.__type){var p=t.Item;u.ULS.sendTraceTag(595637656,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Info,"readMedia: Found error with code ".concat(p.id,"."));var g=r.slideId?r.slideId.sid:-1,v={errorCode:p.id,mediaName:"".concat(g,"s").concat(r.shapeId)};u.ULS.sendTraceTag(570750435,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(v))),f.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:g,shapeId:r.shapeId,errorName:e.getMediaErrorName(v.errorCode),errorCode:v.errorCode,mediaName:v.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}}}},{key:"getMediaErrorName",value:function(e){switch(e){case 48:return"UnsupportedMediaFormat";case 50:return"UnsupportedMediaLinkTarget";case 52:return"EmbeddedMediaExceedsMaxSize";case 54:return"MediaUnavailable";default:return"OtherMediaError"}}},{key:"translateMediaRepeat",value:function(e){return 4294967295===e?-1:e}},{key:"readGif",value:function(e,t,r){if(m.ChangeGate.isChangeGateEnabled("SSC.getItemsMediaResourceMapping")&&e&&e.length>0&&t){var i=t.filter((function(e){return e.id===r})),n=e.filter((function(e){return e.Key===r}));if(n.length>0){var a,o,s=i[0],l=n[0];return l.Value.split(";").map((function(e){var t=decodeURIComponent(e);if(m.ChangeGate.isChangeGateEnabled("SSC.setMediaDownloadHandlerUrl")&&t.search("MediaDownloadHandler")>=0)a=t,o=t.concat("&transcode=videogif");else{var r=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),i=r&&4===r.length?r[3].toLowerCase():void 0;i&&("gif"===i?a=t:o=t)}})),{name:l.Key,src:s.base64,imageUrl:a,videoUrl:o}}}else if(t&&t.length>0){var c=t.filter((function(e){return e.id===r}));if(c.length>0){var u,d,h=c[0];return h.name.split(";").map((function(e){var t=decodeURIComponent(e);if(m.ChangeGate.isChangeGateEnabled("SSC.setMediaDownloadHandlerUrl")&&t.search("MediaDownloadHandler")>=0)u=t,d=t.concat("&transcode=videogif");else{var r=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),i=r&&4===r.length?r[3].toLowerCase():void 0;i&&("gif"===i?u=t:d=t)}})),{name:h.id,src:h.base64,imageUrl:u,videoUrl:d}}}}},{key:"readCameo",value:function(e){if(e){var t=d.CameoBackgroundType.Normal;if(e.bgPr&&e.bgPr.Item)switch(e.bgPr.Item.__type){case"CT_BackgroundRemovedProperties:#p":t=d.CameoBackgroundType.Removed;break;case"CT_BackgroundBlurProperties:#p":t=d.CameoBackgroundType.Blur;break;case"CT_BackgroundCustomProperties:#p":t=d.CameoBackgroundType.Custom;break;default:t=d.CameoBackgroundType.Normal}return{backgroundProps:{backgroundType:t}}}}}]);var t,i,S}();t.SlideShowDataParser=T,T.s_fLoggedFirstPartyFontMissing=!1,T.s_fLoggedThirdPartyFontMissing=!1,T.s_fLoggedCustomFontMissing=!1},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PodsProxyConstants=t.PodsProxyRequestStageType=t.PodsProxyRequestType=void 0;var n,a,o,s=i(r(2)),l=i(r(1));t.PodsProxyRequestType=a,function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(a||(t.PodsProxyRequestType=a={})),t.PodsProxyRequestStageType=o,function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(o||(t.PodsProxyRequestStageType=o={}));var c=(0,s.default)((function e(){(0,l.default)(this,e)}));t.PodsProxyConstants=c,(n=c).unknown="unknown",n.ErrorCode="ErrorCode",n.ErrorCategory="ErrorCategory",n.errorCategory="errorCategory",n.errorCode="errorCode",n.IsIntentional="IsIntentional",n.isIntentional="isIntentional",n.XCorrelationId="X-CorrelationId",n.ContentType="Content-Type",n.ContentLength="Content-Length",n.ContenEncoding="Content-Encoding",n.TransferEncoding="Transfer-Encoding",n.XusedOutputCache="X-usedOutputCache",n.Xnewsnapurl="x-newsnapurl",n.ContentDisposition="Content-Disposition",n.CallerCorrelationId="CallerCorrelationId",n.action="action",n.parser="parser",n.server="server",n.callId="callId",n.dateHeader="x-ms-date",n.clientTimeoutHeader="x-ms-client-timeout",n.clientRequestIdHeader="x-ms-client-request-id",n.newSnapUrlHeader="x-newsnapurl",n.correlationId="correlationId",n.firstResponseCheck="firstResponseCheck",n.fetchBoundary="fetchBoundary",n.downloadResponse="downloadResponse",n.parserCallback="parserCallback",n.createResponse="createResponse",n.contentLength="contentLength",n.usedOutputCache="usedOutputCache",n.itemUsedOutputCacheMap="itemUsedOutputCacheMap",n.podsProxyCallSuceeded="podsProxyCallSuceeded",n.PriorityHint="PriorityHint",n.RequestInfo="RequestInfo",n.ResponseHeaders="ResponseHeaders",n.IsBootRequest="IsBootRequest",n.XErrorCode="X-ErrorCode"},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ItemType=t.ErrorCategory=t.ErrorCode=t.GetRequestItemIds=t.SlideImageAppendOption=t.ClientColorSettings=void 0;var n,a,o,s,l=i(r(2)),c=i(r(1));t.ClientColorSettings=o,function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(o||(t.ClientColorSettings=o={})),t.SlideImageAppendOption=s,function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(s||(t.SlideImageAppendOption=s={}));var u,d,h=(0,l.default)((function e(){(0,c.default)(this,e)}));t.GetRequestItemIds=h,(n=h).PresInfoMetaData="presinfo/metadata",n.PresinfoslimSlideOrder="presinfo/slimSlideOrder",n.slideInfoIndex="pres/sldIdx",n.slideInfoSid="pres/sldSid",n.slideNotesIndex="pres/NotesSldIdx",n.slideNotesSid="pres/NotesSldSid",n.slideCommentsIndex="pres/CommentsSldIdx",n.slideCommentsSid="pres/CommentsSldSid",n.slideMetadataIndex="pres/SlideMetadatasldIdx",n.slideMetadataSid="pres/SlideMetadataSldSid",n.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",n.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",t.ErrorCode=u,function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(u||(t.ErrorCode=u={})),t.ErrorCategory=d,function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(d||(t.ErrorCategory=d={}));var f=(0,l.default)((function e(){(0,c.default)(this,e)}));t.ItemType=f,(a=f).JsonType="application/json",a.ImagePng="image/png",a.ImageJpg="image/jpg",a.PlainTextType="text/plain"},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowInkAddonCore=t.InkLogger=t.InkMetricHelper=t.InkBootSource=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(427),l=r(34),c=r(3);t.InkBootSource=n,function(e){e.Pen="pen",e.Menu="menu",e.Reset="reset",e.Annotation="Annotation",e.None="none"}(n||(t.InkBootSource=n={}));var u=(0,o.default)((function e(){(0,a.default)(this,e),this.m_bootStartTimestamp=-1,this.m_bootSource=n.None,this.m_lostStrokeCount=0}),[{key:"boot",value:function(e){this.m_bootSource=e,this.m_bootStartTimestamp=Date.now()}},{key:"timeDiff",value:function(){return Date.now()-this.m_bootStartTimestamp}},{key:"getSource",value:function(){return this.m_bootSource}},{key:"countLostStroke",value:function(){this.m_lostStrokeCount+=1}},{key:"getLostStrokeCount",value:function(){return this.m_lostStrokeCount}}]);t.InkMetricHelper=u;var d=(0,o.default)((function e(){(0,a.default)(this,e)}),[{key:"info",value:function(e){c.ULS.sendTraceTag(545629707,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,e)}},{key:"error",value:function(e){c.ULS.sendTraceTag(545629708,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Error,e)}}]);t.InkLogger=d;var h=(0,o.default)((function e(t,r,i,n,o,l,d){(0,a.default)(this,e),this.m_slideIndex=-1,this.f_isInkJsDownloading=!1,this.f_isShowingBlankSlide=!1,this.f_isTransitioning=!1,this.m_metricHelper=new u,this.c_endOfShowLocation={slideIndex:-2,slideId:{sid:-2,cid:-2}},c.ULS.setLogger(r),this.m_slideshowCore=t,this.m_loadInkJsCallback=n,this.m_parent=i,this.m_inkContainer=(0,s.createInkCanvasContainerDiv)(),this.updateDimensions(),this.m_parent.appendChild(this.m_inkContainer),this.onDownloadCompleted=this.onDownloadCompleted.bind(this),this.onDownloadFailed=this.onDownloadFailed.bind(this),this.onPositionChanged=this.onPositionChanged.bind(this),this.onBlankSlideStateChanged=this.onBlankSlideStateChanged.bind(this),this.onSlideLocationChanging=this.onSlideLocationChanging.bind(this),this.updateDimensions=this.updateDimensions.bind(this),this.m_initInk=o,this.m_slideChanged=l,this.m_allowInkStart=d,this.onPointerDown=this.onPointerDown.bind(this),window.addEventListener("pointerdown",this.onPointerDown)}),[{key:"slideshowCore",get:function(){return this.m_slideshowCore}},{key:"loadInkJsCallback",get:function(){return this.m_loadInkJsCallback}},{key:"parent",get:function(){return this.m_parent}},{key:"inkContainer",get:function(){return this.m_inkContainer}},{key:"isInkJsDownloading",get:function(){return this.f_isInkJsDownloading},set:function(e){this.f_isInkJsDownloading=e}},{key:"isShowingBlankSlide",get:function(){return this.f_isShowingBlankSlide}},{key:"metricHelper",get:function(){return this.m_metricHelper}},{key:"onPointerDown",value:function(e){"pen"===e.pointerType&&this.m_metricHelper.countLostStroke()}},{key:"selectEraser",value:function(){this.m_inkCanvas&&(this.m_inkCanvas.enableTouchMouse(),this.m_inkCanvas.selectEraser(),c.ULS.sendTraceTag(545629709,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,"SlideShowInkAddon: selectEraser called"))}},{key:"selectNone",value:function(){this.m_inkCanvas&&this.m_inkCanvas.disableTouchMouse()}},{key:"eraseAll",value:function(){this.m_inkCanvas&&(this.m_inkCanvas.eraseAll(),c.ULS.sendTraceTag(545629710,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,"SlideShowInkAddon: eraseAll called"))}},{key:"onDownloadCompleted",value:function(){this.f_isInkJsDownloading=!1,c.ULS.sendTraceTag(545629711,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,"SlideShowInkAddon: slideshowink.js downloaded"),this.updateDimensions(),this.m_initInk()}},{key:"onDownloadFailed",value:function(e){this.f_isInkJsDownloading=!1,c.ULS.sendTraceTag(545629712,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Error,"SlideShowInkAddon: slideshowink.js download error: ".concat(e.message))}},{key:"updateDimensions",value:function(){var e=this.m_slideshowCore.getCurrentSlideDimensions();e&&(this.m_inkContainer.style.width="".concat(e.x,"px"),this.m_inkContainer.style.height="".concat(e.y,"px"),this.updateInkCanvasDimensions())}},{key:"updateInkCanvasDimensions",value:function(){if(this.m_inkCanvas){var e=this.slideshowCore.getCurrentSlideDimensions();e&&"function"==typeof this.m_inkCanvas.updateCanvasDimensions&&this.m_inkCanvas.updateCanvasDimensions(e.x,e.y)}}},{key:"resetInkCanvas",value:function(){if(this.m_inkCanvas){for(this.m_metricHelper.boot(n.Reset),this.m_inkCanvas.stop(),this.unregisterAppEventListeners(),this.m_inkCanvas=void 0;this.m_inkContainer.firstChild;)this.m_inkContainer.removeChild(this.m_inkContainer.firstChild);this.m_initInk(),c.ULS.sendTraceTag(545629713,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,"SlideShowInkAddon: Ink initialization triggered by reset.")}}},{key:"registerAppEventListeners",value:function(){this.m_slideshowCore.events.on("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.on("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.on("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.on("slideDimensionsChanged",this.updateDimensions)}},{key:"unregisterAppEventListeners",value:function(){this.m_slideshowCore.events.off("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.off("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.off("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.off("slideDimensionsChanged",this.updateDimensions)}},{key:"onPositionChanged",value:function(){var e=this.m_slideshowCore.getSlideLocation();if(e){var t=e.slideIndex;this.m_slideIndex!==t&&(this.m_slideIndex=t,this.m_slideChanged(e))}else c.ULS.sendTraceTag(545629714,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Error,"SlideShowInkAddon: undefined slide location in onPositionChanged.")}},{key:"onBlankSlideStateChanged",value:function(e){if(e===l.BlankSlideState.Hidden){this.f_isShowingBlankSlide=!1;var t=this.m_slideshowCore.getSlideLocation();t&&this.m_slideChanged(t),this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start()}else this.f_isShowingBlankSlide=!0,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden",this.m_slideChanged(this.c_endOfShowLocation)}},{key:"onSlideLocationChanging",value:function(e){!this.f_isTransitioning&&e.isTransitioning?(this.f_isTransitioning=e.isTransitioning,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden"):this.f_isTransitioning&&!e.isTransitioning&&(this.f_isTransitioning=e.isTransitioning,this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start())}}]);t.SlideShowInkAddonCore=h},function(e,t,r){var i=r(68),n=r(69),a=r(56).Buffer,o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function l(){this.init(),this._w=s,n.call(this,64,56)}function c(e,t,r){return r^e&(t^r)}function u(e,t,r){return e&t|r&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}i(l,n),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,a=0|this._c,s=0|this._d,l=0|this._e,m=0|this._f,p=0|this._g,g=0|this._h,v=0;v<16;++v)r[v]=e.readInt32BE(4*v);for(;v<64;++v)r[v]=0|(((t=r[v-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+r[v-7]+f(r[v-15])+r[v-16];for(var y=0;y<64;++y){var _=g+h(l)+c(l,m,p)+o[y]+r[y]|0,S=d(i)+u(i,n,a)|0;g=p,p=m,m=l,l=s+_|0,s=a,a=n,n=i,i=_+S|0}this._a=i+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0,this._f=m+this._f|0,this._g=p+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},function(e,t,r){var i=r(68),n=r(69),a=r(56).Buffer,o=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function l(){this.init(),this._w=s,n.call(this,128,112)}function c(e,t,r){return r^e&(t^r)}function u(e,t,r){return e&t|r&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function p(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function v(e,t){return e>>>0<t>>>0?1:0}i(l,n),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,r=0|this._ah,i=0|this._bh,n=0|this._ch,a=0|this._dh,s=0|this._eh,l=0|this._fh,y=0|this._gh,_=0|this._hh,S=0|this._al,T=0|this._bl,b=0|this._cl,C=0|this._dl,w=0|this._el,P=0|this._fl,I=0|this._gl,k=0|this._hl,E=0;E<32;E+=2)t[E]=e.readInt32BE(4*E),t[E+1]=e.readInt32BE(4*E+4);for(;E<160;E+=2){var x=t[E-30],L=t[E-30+1],A=f(x,L),M=m(L,x),R=p(x=t[E-4],L=t[E-4+1]),O=g(L,x),D=t[E-14],F=t[E-14+1],B=t[E-32],N=t[E-32+1],V=M+F|0,U=A+D+v(V,M)|0;U=(U=U+R+v(V=V+O|0,O)|0)+B+v(V=V+N|0,N)|0,t[E]=U,t[E+1]=V}for(var W=0;W<160;W+=2){U=t[W],V=t[W+1];var G=u(r,i,n),H=u(S,T,b),j=d(r,S),z=d(S,r),q=h(s,w),Z=h(w,s),X=o[W],Y=o[W+1],J=c(s,l,y),K=c(w,P,I),Q=k+Z|0,$=_+q+v(Q,k)|0;$=($=($=$+J+v(Q=Q+K|0,K)|0)+X+v(Q=Q+Y|0,Y)|0)+U+v(Q=Q+V|0,V)|0;var ee=z+H|0,te=j+G+v(ee,z)|0;_=y,k=I,y=l,I=P,l=s,P=w,s=a+$+v(w=C+Q|0,C)|0,a=n,C=b,n=i,b=T,i=r,T=S,r=$+te+v(S=Q+ee|0,Q)|0}this._al=this._al+S|0,this._bl=this._bl+T|0,this._cl=this._cl+b|0,this._dl=this._dl+C|0,this._el=this._el+w|0,this._fl=this._fl+P|0,this._gl=this._gl+I|0,this._hl=this._hl+k|0,this._ah=this._ah+r+v(this._al,S)|0,this._bh=this._bh+i+v(this._bl,T)|0,this._ch=this._ch+n+v(this._cl,b)|0,this._dh=this._dh+a+v(this._dl,C)|0,this._eh=this._eh+s+v(this._el,w)|0,this._fh=this._fh+l+v(this._fl,P)|0,this._gh=this._gh+y+v(this._gl,I)|0,this._hh=this._hh+_+v(this._hl,k)|0},l.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,r,i){e.writeInt32BE(t,i),e.writeInt32BE(r,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AppSessionTeamsLoggingHelper=t.StateServiceComparisonTelemetryHelper=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(14),c=r(4),u=r(79),d=r(121),h=r(46);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"isIC3Message",value:function(e){return Object.keys(e).some((function(e){return e.includes(d.AppSessionLoggingConstants.ic3Local)}))}},{key:"isStateMessage",value:function(e){return Object.keys(e).some((function(e){return e.includes(d.AppSessionLoggingConstants.stateLocal)}))}},{key:"isDuplicateEmitTime",value:function(e){var t=void 0;if(this.isStateMessage(e))t=this.m_previousStateComparisonReceivedMessageEmitTime;else{if(!this.isIC3Message(e))return s.ULS.sendTraceTag(507102405,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"StateServiceComparison:IsDuplicateEmitTime unknown source: ".concat(JSON.stringify(e))),!1;t=this.m_previousTeamsComparisonReceivedMessageEmitTime}for(var r in e)if(r.includes("SS_Emit"))return e[r]===t;return!1}},{key:"logStateServiceComparisonTelemetry",value:function(t,r,i,n){try{var a=m({},t);if(a){a.attendee_ring=n||"";var o=a.skew_emitter||0,l=r,c=0,u=d.SyncEventSource.Unknown;for(var h in a)(h.includes(d.AppSessionLoggingConstants.teamsNotified)||h.includes(d.AppSessionLoggingConstants.stateNotified)||h.includes(d.AppSessionLoggingConstants.bootstrapperNotified))&&0!==o?a[h]+=o:(h.includes(d.AppSessionLoggingConstants.teamsLocal)||h.includes(d.AppSessionLoggingConstants.stateLocal)||h.includes(d.AppSessionLoggingConstants.bootstrapperLocal))&&0!==i?(a[h]+=i,u=h.includes(d.AppSessionLoggingConstants.stateLocal)?d.SyncEventSource.State:d.SyncEventSource.Teams,a.source=u):h.includes("SS_Emit")&&(c=a[h]);if(a[d.AppSessionLoggingConstants.skewReceiver]=i,a.PPT_ModernSS_Complete_Nav=l,c>0){var f=l-c;a.totalElapsedMS=f;var p=a.slideIndex||-1,g="".concat(p,"_").concat(c),v=Number.MIN_SAFE_INTEGER;u===d.SyncEventSource.State&&(this.m_stateReceivedNavs[g]=f,v=this.m_previousStateComparisonReceivedMessageEmitTime,this.m_previousStateComparisonReceivedMessageEmitTime=c),u===d.SyncEventSource.Teams&&(this.m_teamsReceivedNavs[g]=f,v=this.m_previousTeamsComparisonReceivedMessageEmitTime,this.m_previousTeamsComparisonReceivedMessageEmitTime=c);var y=c===v,_=c<v;!y&&f>2500&&(a.endToEndNavSlow=!0,f>3e4&&(a.endToEndNavSlow30=!0)),_?(s.ULS.sendTraceTag(507102404,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"StateServiceComparison:Out Of Order nav messages received: source: ".concat(u,"; current: ").concat(c,"; previous: ").concat(v,";")),a.EarlierOrder="true"):y&&(a.SameOrder="true",s.ULS.sendTraceTag(507102403,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"StateServiceComparison:Duplicate emit time nav messages received: source: ".concat(u,"; current: ").concat(c,"; previous: ").concat(v,";"))),e.logStateServiceCorrespondingComparisonTelemetry(u,g),s.ULS.sendTraceTag(556675080,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"StateServiceComparison: ".concat(JSON.stringify(a)))}}}catch(e){s.ULS.sendTraceTag(507102402,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"StateServiceComparison error: ".concat(e))}}},{key:"logStateServiceCorrespondingComparisonTelemetry",value:function(e,t){var r=e===d.SyncEventSource.State?this.m_teamsReceivedNavs[t]:this.m_stateReceivedNavs[t],i=Object.keys(this.m_stateReceivedNavs).length,n=Object.keys(this.m_teamsReceivedNavs).length,a=i-n,o=c.Settings.readNumberOrDefault("syncPipelineDiscrepancyCount",10),l="";if(a>o?l=d.SyncEventSource.Teams:a<-1*o&&(l=d.SyncEventSource.State),""!==l){var u={stateKeysCount:i,teamsKeysCount:n,keyCountDifferenceToLogVeto:o};s.ULS.sendTraceTag(507102401,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"SyncPipelineDiscrepancy_".concat(l,": ").concat(JSON.stringify(u)))}if(void 0!==r){var h=this.m_stateReceivedNavs[t],f=this.m_teamsReceivedNavs[t],m={key:t,stateElapsed:h,teamsElapsed:f,stateFaster:h<f,difference:h-f,stateKeysCount:i,teamsKeysCount:n};s.ULS.sendTraceTag(507102400,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"logStateServiceComparison ".concat(JSON.stringify(m)))}}}])}();t.StateServiceComparisonTelemetryHelper=p,p.m_stateReceivedNavs={},p.m_teamsReceivedNavs={},p.m_previousStateComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER,p.m_previousTeamsComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER;var g=(0,o.default)((function e(){(0,a.default)(this,e)}),null,[{key:"trackLastUserInputNavigation",value:function(e,t){this.m_lastUserInputTime=t,s.ULS.sendTraceTag(507102371,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"trackTeamsPVMetrics::trackLastUserInputNavigation: navType: ".concat(e.navType,"; action: ").concat(e.source,", time: ").concat(t))}},{key:"initialize",value:function(e){e.teamsSharingEndToEndNavSlowMS&&(this.m_teamsSharingEndToEndNavSlowMS=e.teamsSharingEndToEndNavSlowMS),this.m_maxSlowPipelineMessagesCount=c.Settings.readNumberOrDefault("maxSlowPipelineMessagesCount",0),this.m_stateServicePipelineMessageSlowMS=c.Settings.readNumberOrDefault("stateServicePipelineMessageSlowMS",Number.MAX_SAFE_INTEGER)}},{key:"setSlowMediaSyncThreshold",value:function(e){this.m_slowMediaSyncQoSThresholdMs=e}},{key:"hadPreviousUserInput",value:function(e){return this.m_timeFromLastUserInputNav=-1,this.m_lastUserInputTime?(this.m_timeFromLastUserInputNav=e-this.m_lastUserInputTime,!0):(s.ULS.sendTraceTag(507102370,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"trackTeamsPVMetrics: Entering private viewing without prior user input."),!1)}},{key:"trackTeamsPVMetrics",value:function(e,t){try{s.ULS.sendTraceTag(507102369,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"trackTeamsPVMetrics: action: ".concat(JSON.stringify(e),"; time: ").concat(t,", inPV: ").concat(null!=this.m_currentTeamsPrivateViewingData));var r=e.action;switch(r){case"enterPrivateViewing":var i=e.source||"";this.m_currentTeamsPrivateViewingData?s.ULS.sendTraceTag(507102368,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"trackTeamsPVMetrics: EnterPrivateViewing on existing PV session. source: ".concat(i,"; data: ").concat(JSON.stringify(e),"; existingPV:").concat(JSON.stringify(this.m_currentTeamsPrivateViewingData))):(this.m_currentTeamsPrivateViewingData={enterPrivateViewing:t,returnToPresenter:0,sessionSlideUpdate:0,privateSlideUpdatePrev:0,privateSlideUpdateNext:0,leavePrivateViewing:-1,enterPrivateViewingSource:i,timeFromLastUserNav:this.m_timeFromLastUserInputNav,completed:!1},this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions+=1,i&&i!==d.PrivateViewingEnterSource.SyncStateManager||this.hadPreviousUserInput(t)||l.VetoUtils.recordVeto("Slide_VetoedTeamsPrivateViewingUnintentional",m({qosVeto:"SharingWrongSlideStateDisplayed"},this.m_currentTeamsPrivateViewingData)));break;case"leavePrivateViewing":this.m_currentTeamsPrivateViewingData&&(this.m_currentTeamsPrivateViewingData.leavePrivateViewing=t,this.m_currentTeamsPrivateViewingData.privateViewingDuration=t-this.m_currentTeamsPrivateViewingData.enterPrivateViewing,this.m_currentTeamsPrivateViewingData.completed=!0,this.logCurrentPrivateViewingTelemetry(),this.m_currentTeamsPrivateViewingData=void 0,this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions-=1,this.m_sessionTeamsPrivateViewingData.completePrivateViewingSessions+=1);break;case"returnToPresenter":case"sessionSlideUpdate":case"privateSlideUpdatePrev":case"privateSlideUpdateNext":this.m_currentTeamsPrivateViewingData?this.m_currentTeamsPrivateViewingData[r]+=1:"privateSlideUpdateNext"===r?this.trackLastUserInputNavigation({navType:u.NavigationType.Next,source:u.SlideshowActionSource.API},t):"privateSlideUpdatePrev"===r&&this.trackLastUserInputNavigation({navType:u.NavigationType.Prev,source:u.SlideshowActionSource.API},t);break;default:s.ULS.sendTraceTag(507102367,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"trackTeamsPVMetrics: unexpected action ".concat(JSON.stringify(e),";"))}}catch(e){s.ULS.sendTraceTag(507102366,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"trackTeamsPVMetrics: caught error: ".concat(e,";"))}}},{key:"areSkewValuesValid",value:function(e,t){return 0!==e&&0!==t&&Math.abs(e)<1e8&&Math.abs(t)<1e8}},{key:"logCurrentPrivateViewingTelemetry",value:function(){this.m_currentTeamsPrivateViewingData&&s.ULS.sendTraceTag(579111065,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"trackTeamsPVMetrics: privateViewingSession. Data:".concat(JSON.stringify(this.m_currentTeamsPrivateViewingData)))}},{key:"logSessionEndPrivateViewingTelemetry",value:function(){var e=this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions>0;e&&this.logCurrentPrivateViewingTelemetry(),s.ULS.sendTraceTag(579111066,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"trackTeamsPVMetrics: sessionTeamsPrivateViewingData: ".concat(JSON.stringify(this.m_sessionTeamsPrivateViewingData),", hasIncompletePV: ").concat(e))}},{key:"logNavigationPromiseCompletedMetadata",value:function(e,t,r,i){try{if(e){e.attendee_ring=i||"";var n=e.skew_emitter||0,a=e.isForceRetry||!1,o=t,l=0,c=d.SyncEventSource.Unknown;for(var h in e)(h.includes(d.AppSessionLoggingConstants.teamsNotified)||h.includes(d.AppSessionLoggingConstants.stateNotified)||h.includes(d.AppSessionLoggingConstants.bootstrapperNotified))&&0!==n?e[h]+=n:(h.includes(d.AppSessionLoggingConstants.teamsLocal)||h.includes(d.AppSessionLoggingConstants.stateLocal)||h.includes(d.AppSessionLoggingConstants.bootstrapperLocal))&&0!==r?(e[h]+=r,h.includes(d.AppSessionLoggingConstants.stateLocal)?c=d.SyncEventSource.State:h.includes(d.AppSessionLoggingConstants.teamsLocal)&&(c=d.SyncEventSource.Teams),e.source=c):h.includes("SS_Emit")&&(l=e[h]);if(e[d.AppSessionLoggingConstants.skewReceiver]=r,e.PPT_ModernSS_Complete_Nav=o,l>0){var f=o-l;e.totalElapsedMS=f;var m=l===this.m_previousTeamsReceivedNavMessageEmitTime,p=l<this.m_previousTeamsReceivedNavMessageEmitTime,g=e.navResultStatus;p?this.m_previousTeamsReceivedEmitterSkew!==n||a||(s.ULS.sendTraceTag(507102365,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogTeamsNavigation:Out Of Order nav messages received: current: ".concat(l,"; previous: ").concat(this.m_previousTeamsReceivedNavMessageEmitTime,"; source: ").concat(c)),e.EarlierOrder="true"):m?(e.SameOrder="true",s.ULS.sendTraceTag(507102364,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsNavigation:Duplicate emit time nav messages received: current: ".concat(l,"; previous: ").concat(this.m_previousTeamsReceivedNavMessageEmitTime,";"))):"Success"===g?(this.m_previousTeamsReceivedNavMessageEmitTime=l,this.m_previousTeamsReceivedEmitterSkew=n,this.m_consecutiveSkippedRequests>0&&(s.ULS.sendTraceTag(507102363,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsNavigation:ConsecutiveSkippedRequests: ".concat(this.m_consecutiveSkippedRequests,"; endToEndElapsedTime: ").concat(f,"; source: ").concat(c)),this.m_consecutiveSkippedRequests=0),f>0&&!a&&this.logEndToEndSyncNavigationVetoIfSlow(e,c)):g===u.RequestStatus.SkippedBusy||g===u.RequestStatus.SkippedNewTarget?this.m_consecutiveSkippedRequests+=1:g===u.RequestStatus.Failed&&s.ULS.sendTraceTag(507102362,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsNavigation:Navigation Failed; endToEndElapsedTime: ".concat(f))}s.ULS.sendTraceTag(588084945,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"NavigationComplete: ".concat(JSON.stringify(e)))}}catch(e){s.ULS.sendTraceTag(507102361,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"logNavigationPromiseCompleted error: ".concat(e))}}},{key:"logStateServicePipelineLatency",value:function(e,t,r,i){if(r){var n=r[d.AppSessionLoggingConstants.stateNotified]||0,a=r[d.AppSessionLoggingConstants.stateLocal]||0,o=r.skew_emitter||r[d.AppSessionLoggingConstants.skewEmitter],u=r[d.AppSessionLoggingConstants.senderId]||"",h="logStateServicePipelineLatency type:".concat(e,"; subtype:").concat(t,"; senderId:").concat(u);if(u&&u!==d.AppSessionLoggingConstants.senderIdSystem)if(0!==n&&0!==a&&this.areSkewValuesValid(o,i)){var f=(a+=i)-(n+=o);f>this.m_stateServicePipelineMessageSlowMS&&(this.m_currentSlowPipelineMessagesCount+=1,this.m_currentSlowPipelineMessagesCount>=this.m_maxSlowPipelineMessagesCount?this.m_currentSlowPipelineMessagesCount%5==0&&(s.ULS.sendTraceTag(507102358,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"".concat(h," slow ").concat(f,"; currentSlowPipelineMessagesCount: ").concat(this.m_currentSlowPipelineMessagesCount," > maxSlowPipelineMessagesCount: ").concat(this.m_maxSlowPipelineMessagesCount)),c.Settings.readBooleanOrDefault("logCorrectVetoForStateServiceLatency",!0)?l.VetoUtils.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SyncPipelineSlow_StateService",errorName:"".concat(e,"_SharingEndToEndSlow"),vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:f}):l.VetoUtils.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SharingEndToEndNavSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:f})):s.ULS.sendTraceTag(507102357,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"".concat(h," slow ").concat(f,"; currentSlowPipelineMessagesCount: ").concat(this.m_currentSlowPipelineMessagesCount)))}else s.ULS.sendTraceTag(507102359,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Verbose,"".concat(h," not measuring message with invalid numbers"));else s.ULS.sendTraceTag(507102360,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Verbose,"".concat(h," not measuring message from excluded sender"))}}},{key:"logEndToEndSyncNavigationVetoIfSlow",value:function(e,t){try{var r=e[d.AppSessionLoggingConstants.stateNotified]||0,i=e[d.AppSessionLoggingConstants.bootstrapperNotified]||0,n=e[d.AppSessionLoggingConstants.stateLocal]||0,a=e[d.AppSessionLoggingConstants.bootstrapperLocal]||0,o=Math.max(r,i),l=Math.max(n,a),c=e.skew_emitter,u=e[d.AppSessionLoggingConstants.skewReceiver];if(o>0&&l>0&&l-o>this.m_teamsSharingEndToEndNavSlowMS&&this.areSkewValuesValid(c,u)){var h={vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:l-o,source:t,skew_emitter:c,skew_receiver:u};s.ULS.sendTraceTag(507102356,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"TeamsSharingEndToEndNavSlowMS_".concat(t,": ").concat(JSON.stringify(h)))}}catch(e){s.ULS.sendTraceTag(507102355,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"logEndToEndSyncNavigationVetoIfSlow error: ".concat(e))}}},{key:"logAnnotationCompletedMetadata",value:function(e,t,r,i){try{var n=e[d.AppSessionLoggingConstants.skewEmitter]||0,a=t,o=0;for(var l in e)l.includes(d.AppSessionLoggingConstants.stateNotified)&&0!==n?e[l]+=n:l.includes(d.AppSessionLoggingConstants.stateLocal)&&0!==r?e[l]+=r:l.includes(d.AppSessionLoggingConstants.annotationEventEmitted)&&(o=e[l]);if(e[d.AppSessionLoggingConstants.skewReceiver]=r,e[d.AppSessionLoggingConstants.annotationEventCompleted]=a,e.attendee_ring=i||"",o>0){var c=a-o;e.totalElapsedMS=c}s.ULS.sendTraceTag(557670919,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"AnnotationComplete: ".concat(JSON.stringify(e)))}catch(e){s.ULS.sendTraceTag(507102354,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"logAnnotationCompletedMetadata error: ".concat(e))}}},{key:"logStateServicePipelineMetrics",value:function(e,t,r,i){if(void 0!==r[d.AppSessionLoggingConstants.stateNotified]&&void 0!==r[d.AppSessionLoggingConstants.stateLocal]&&void 0!==r[d.AppSessionLoggingConstants.skewEmitter]&&this.areSkewValuesValid(r[d.AppSessionLoggingConstants.skewEmitter],i))if(this.logStateServicePipelineLatency(e,t,r,i),void 0!==r[d.AppSessionLoggingConstants.syncEventEmitTime]){var n=r[d.AppSessionLoggingConstants.syncEventEmitTime];n===this.m_previousStateServiceMessageEmitTime?s.ULS.sendTraceTag(507102351,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogStateServicePipelineMetrics: Duplicate message received: current: ".concat(n,"; previous: ").concat(this.m_previousStateServiceMessageEmitTime,"; ")):n<=this.m_previousStateServiceMessageEmitTime?s.ULS.sendTraceTag(507102350,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogStateServicePipelineMetrics: Out of Order message received: current: ".concat(n,"; previous: ").concat(this.m_previousStateServiceMessageEmitTime)):this.m_previousStateServiceMessageEmitTime=n}else s.ULS.sendTraceTag(507102352,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogStateServicePipelineMetrics: Invalid syncMetricsDictionary: ".concat(JSON.stringify(r)));else s.ULS.sendTraceTag(507102353,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogStateServicePipelineMetrics: invalid syncMetricsDictionary: ".concat(JSON.stringify(r)))}},{key:"logMediaSyncCompletedMetadata",value:function(e,t,r){try{if(e){var i=e[d.AppSessionLoggingConstants.skewEmitter]||0,n=t,a=0,o=d.SyncEventSource.Unknown;for(var c in e)c.includes(d.AppSessionLoggingConstants.teamsNotified)&&0!==i?e[c]+=i:c.includes(d.AppSessionLoggingConstants.teamsLocal)&&0!==r?e[c]+=r:c.includes(d.AppSessionLoggingConstants.mediaEventEmitted)?a=e[c]:(c.includes(d.AppSessionLoggingConstants.teamsLocal)||c.includes(d.AppSessionLoggingConstants.stateLocal))&&(o=c.includes(d.AppSessionLoggingConstants.stateLocal)?d.SyncEventSource.State:d.SyncEventSource.Teams,e.source=o);if(e[d.AppSessionLoggingConstants.skewReceiver]=r,e[d.AppSessionLoggingConstants.mediaEventCompleted]=n,a>0){var u=n-a;e[d.AppSessionLoggingConstants.elapsedTime]=u;var h=a===this.m_previousTeamsReceivedMediaMessageEmitTime,f=a<this.m_previousTeamsReceivedMediaMessageEmitTime;u>this.m_slowMediaSyncQoSThresholdMs&&!e.isFromStateServiceCache&&this.areSkewValuesValid(i,r)&&(s.ULS.sendTraceTag(507102349,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"LogTeamsMediaSync: End-to-end media sync time larger than slow sync threshold: ".concat(JSON.stringify(e))),this.logSlowEndToEndMediaSyncVeto(e,o)),f&&this.shouldLogOutOfOrderEvent(e,o)?(s.ULS.sendTraceTag(507102348,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsMediaSync: Out of order play/pause sync messages received: current: ".concat(a,"; previous: ").concat(this.m_previousTeamsReceivedMediaMessageEmitTime,";")),l.VetoUtils.recordVeto("MediaSyncOutOfOrderEvents",{qosVeto:"MediaSyncOutOfOrderEvents"}),e[d.AppSessionLoggingConstants.mediaEventOutOfOrder]="true"):h?(s.ULS.sendTraceTag(507102347,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsMediaSync: Duplicate emit time media sync messages received: current: ".concat(a,";")),e[d.AppSessionLoggingConstants.mediaEventDuplicate]="true"):this.m_previousTeamsReceivedMediaMessageEmitTime=a}s.ULS.sendTraceTag(507102346,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LogTeamsMediaSync: ".concat(JSON.stringify(e)))}}catch(e){s.ULS.sendTraceTag(507102345,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"LogTeamsMediaSync: error: ".concat(e))}}},{key:"isDuplicateMediaSyncMessage",value:function(e,t){return e?(t?this.m_upstreamMediaSyncEvents.has(e):this.m_downstreamMediaSyncEvents.has(e))?(s.ULS.sendTraceTag(507102343,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"isDuplicateMediaSyncMessage: Media Sync message (correlationId: ".concat(e,") has already been ").concat(t?"sent":"received")),!0):(t?this.m_upstreamMediaSyncEvents.add(e):this.m_downstreamMediaSyncEvents.add(e),this.m_upstreamMediaSyncEvents.size>3e3&&this.m_upstreamMediaSyncEvents.clear(),this.m_downstreamMediaSyncEvents.size>3e3&&this.m_downstreamMediaSyncEvents.clear(),!1):(s.ULS.sendTraceTag(507102344,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"isDuplicateMediaSyncMessage: Undefined correlationId"),!1)}},{key:"shouldLogOutOfOrderEvent",value:function(e,t){if(t!==d.SyncEventSource.State)return!1;var r=!1,i=h.MediaEventType.MediaEnded,n="",a=e[d.AppSessionLoggingConstants.mediaSyncTimeLine];if(a&&a.length>0){i=e[d.AppSessionLoggingConstants.mediaEventType];var o=a[0].MediaHostName;n=a[0].MediaPlayerName||"",r=o===h.MediaType.Video&&""!==n&&n===this.m_previousPlayerName&&(i===h.MediaEventType.MediaPlayed&&this.m_previousEventType===h.MediaEventType.MediaPaused||i===h.MediaEventType.MediaPaused&&this.m_previousEventType===h.MediaEventType.MediaPlayed)}return this.m_previousPlayerName=n,this.m_previousEventType=i,r}},{key:"logSlowEndToEndMediaSyncVeto",value:function(e,t){var r=e[d.AppSessionLoggingConstants.skewEmitter]||0,i=e[d.AppSessionLoggingConstants.skewReceiver]||0,n=e[d.AppSessionLoggingConstants.elapsedTime];l.VetoUtils.recordVeto("MediaSyncEndToEndSlow_".concat(t),{qosVeto:"MediaSyncEndToEndSlow",vetoLimit:this.m_slowMediaSyncQoSThresholdMs,totalElapsedMS:n,source:t,emitterSkew:r,receiverSkew:i})}}]);t.AppSessionTeamsLoggingHelper=g,g.m_sessionTeamsPrivateViewingData={incompletePrivateViewingSessions:0,completePrivateViewingSessions:0},g.m_teamsSharingEndToEndNavSlowMS=Number.MAX_SAFE_INTEGER,g.m_previousTeamsReceivedNavMessageEmitTime=Number.MIN_SAFE_INTEGER,g.m_previousStateServiceMessageEmitTime=Number.MIN_SAFE_INTEGER,g.m_previousTeamsReceivedEmitterSkew=Number.MIN_SAFE_INTEGER,g.m_consecutiveSkippedRequests=0,g.m_maxSlowPipelineMessagesCount=0,g.m_stateServicePipelineMessageSlowMS=Number.MAX_SAFE_INTEGER,g.m_currentSlowPipelineMessagesCount=0,g.m_previousTeamsReceivedMediaMessageEmitTime=Number.MIN_SAFE_INTEGER,g.m_slowMediaSyncQoSThresholdMs=Number.MAX_SAFE_INTEGER,g.m_previousEventType=h.MediaEventType.MediaEnded,g.m_previousPlayerName="",g.m_upstreamMediaSyncEvents=new Set,g.m_downstreamMediaSyncEvents=new Set},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SyncUtil=void 0;var n=i(r(1)),a=i(r(2)),o=r(11),s=i(r(98)),l=r(3),c=r(81),u=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"areSyncStatesEqual",value:function(t,r,i){if(void 0===t&&void 0===r)return!0;if(void 0===t||void 0===r)return!1;if(i){var n=e.syncStateToSlideLocation(t),a=e.syncStateToSlideLocation(r);return(0,s.default)(n.slideId,a.slideId)||n.slideIndex===a.slideIndex}var o=e.syncStateToSlideLocation(t),l=e.syncStateToSlideLocation(r),c=e.syncStateToAnimationState(t),u=e.syncStateToAnimationState(r);return!(!(0,s.default)(o.slideId,l.slideId)&&o.slideIndex!==l.slideIndex)&&(0,s.default)(c,u)}},{key:"syncStateToSlideLocation",value:function(e){return{slideId:null!=e.slideId?e.slideId:void 0,slideIndex:null!=e.slideIndex?e.slideIndex:void 0}}},{key:"syncStateToAnimationState",value:function(e){return{timelineStates:e.timelineStates}}},{key:"toSyncState",value:function(e,t){var r={},i=[];return l.ULS.sendTraceTag(507102658,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"SyncUtil:: toSyncState slideLocation: ".concat(JSON.stringify(e)," and animationState: ").concat(JSON.stringify(t))),t&&(o.ChangeGate.isChangeGateEnabled("SSA.nullCheckTimelineStates")&&!t.timelineStates?l.ULS.sendTraceTag(507102657,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"SyncUtil:: Error ".concat((0,c.stringifyError)(new Error("Invalid timelineStates")))):(t.timelineStates.forEach((function(e){i.push({timelineId:e.timelineId,step:e.step})})),r.timelineStates=t?i:void 0)),r.slideId=null!=e.slideId?e.slideId:void 0,r.slideIndex=null!=e.slideIndex?e.slideIndex:void 0,r}}])}();t.SyncUtil=u},function(e,t){var r,i,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new m(e,t)),1!==c.length||u||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(47),s=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"stopInkActivityTimer",value:function(){if(""!==e.m_currentInkActivity&&0!==e.m_currentInkActivityStart){var t=e.m_sessionTelemetry[e.m_currentInkActivity];e.m_sessionTelemetry[e.m_currentInkActivity]=void 0===t?Date.now()-e.m_currentInkActivityStart:t+Date.now()-e.m_currentInkActivityStart,o.SessionUtils.recordSessionStats({AnnotationStats:e.m_sessionTelemetry})}}},{key:"logInkActivity",value:function(t){switch(t){case"InitInk":if(""===e.m_currentInkActivity){var r=Date.now();e.m_sessionTelemetry.InkStart=r,e.m_currentInkActivity="None",e.m_currentInkActivityStart=r,o.SessionUtils.recordSessionStats({AnnotationStats:e.m_sessionTelemetry})}break;case"SessionEnd":""!==this.m_currentInkActivity&&(e.stopInkActivityTimer(),e.m_sessionTelemetry.InkEnd=Date.now(),o.SessionUtils.recordSessionStats({AnnotationStats:e.m_sessionTelemetry}),e.m_currentInkActivityStart=0,e.m_currentInkActivity="",e.m_sessionTelemetry={});break;case"ToAttendee":e.stopInkActivityTimer(),e.m_currentInkActivityStart=0;break;case"ToPresenter":""!==e.m_currentInkActivity&&(e.m_currentInkActivityStart=Date.now());break;case"Pen":case"Highlighter":case"Eraser":case"Laser":case"Select":case"None":var i=Date.now();""===e.m_currentInkActivity?(e.m_sessionTelemetry.InkStart=i,e.m_currentInkActivity=t,e.m_currentInkActivityStart=i,o.SessionUtils.recordSessionStats({AnnotationStats:e.m_sessionTelemetry})):e.m_currentInkActivity!==t&&(e.stopInkActivityTimer(),e.m_currentInkActivity=t,e.m_currentInkActivityStart=Date.now())}}}])}();t.AnnotationLogger=s,s.m_currentInkActivity="",s.m_currentInkActivityStart=0,s.m_sessionTelemetry={}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.InkActivityLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=r(14),l=(0,a.default)((function e(t){(0,n.default)(this,e),t&&t.telemetryLogger&&(this.telemetryLogger=t.telemetryLogger)}),[{key:"logActivity",value:function(e,t,r,i){this.sendPenOrInkMinutesEvent(e,r,i)}},{key:"sendPenOrInkMinutesEvent",value:function(e,t,r){for(var i=[],n=0;n<t.length;n+=1)t[n]&&r[n]&&i.push({name:t[n],string:r[n]});var a={name:"Office.PowerPoint.Online.Data.Activity.".concat(e),dataFields:i};this.sendTelemetryEvent(a)}},{key:"sendTelemetryEvent",value:function(e){try{this.telemetryLogger?this.telemetryLogger.sendTelemetryEvent(e):s.OtelJSWrapper.sendOtelEvent(e)}catch(e){o.ULS.sendTraceTag(527230946,o.LogCategory.msoulscat_Wac_PptSlideshow,o.TraceLevel.Error,"Failed to send PenOrInkMinutes TelemetryEvent. Ex: ".concat(e))}}}]);t.InkActivityLogger=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaStreamClient=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(2)),s=i(r(1)),l=r(95),c=r(46),u=r(3),d=(0,o.default)((function e(){(0,s.default)(this,e)}));d.defaultVideoHeight=480,d.defaultVideoWidth=640,d.defaultFrameRate=30;var h=function(){return(0,o.default)((function e(t){(0,s.default)(this,e),this.mediaStreamSource=t.source,this.videoConstraints=t.videoConstraints?t.videoConstraints:{},this.originalVideoConstraints=this.videoConstraints;var r=document.createElement("video");r.id=t.id,this.videoElement=r}),[{key:"startMediaCaptureAsync",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i,a,o=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],t&&this.updateConstraints(t,r),this.mediaStreamSource.stream&&this.mediaStreamSource.stopMediaCapture(),e.next=5,this.mediaStreamSource.startMediaCaptureAsync(this.videoConstraints);case 5:if((i=e.sent)===l.MediaStreamError.ErrorNone){e.next=8;break}return e.abrupt("return",i);case 8:if(this.mediaStreamSource.stream){e.next=10;break}return e.abrupt("return",l.MediaStreamError.ErrorUnknown);case 10:return a=this.getMediaStreamResolution(this.mediaStreamSource.stream),this.videoElement.width=a.x,this.videoElement.height=a.y,this.videoElement.srcObject=this.mediaStreamSource.stream,e.prev=14,e.next=17,this.videoElement.play();case 17:e.next=22;break;case 19:return e.prev=19,e.t0=e.catch(14),e.abrupt("return",l.MediaStreamError.ErrorVideoPlaybackFailed);case 22:return e.abrupt("return",l.MediaStreamError.ErrorNone);case 23:case"end":return e.stop()}}),e,this,[[14,19]])}))),function(t){return e.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.videoElement.pause(),this.videoElement.srcObject=null,this.mediaStreamSource.stopMediaCapture()}},{key:"VideoElement",get:function(){return this.videoElement}},{key:"DeviceId",get:function(){if(this.videoConstraints.deviceId)return"string"==typeof this.videoConstraints.deviceId?this.videoConstraints.deviceId:JSON.stringify(this.videoConstraints.deviceId)}},{key:"isActive",get:function(){return!(!this.mediaStreamSource||!this.mediaStreamSource.stream)&&this.mediaStreamSource.stream.active}},{key:"resetToOriginalConstraints",value:function(){this.videoConstraints=this.originalVideoConstraints}},{key:"updateConstraints",value:function(e,t){var r=t?{deviceId:void 0,width:void 0,height:void 0,frameRate:void 0,facingMode:void 0}:this.videoConstraints,i=r;e.deviceId&&e.deviceId!==r.deviceId&&(i.deviceId=e.deviceId),e.width&&e.width!==r.width&&(i.width=e.width),e.height&&e.height!==r.height&&(i.height=e.height),e.frameRate&&e.frameRate!==r.frameRate&&(i.frameRate=e.frameRate),e.facingMode&&e.facingMode!==r.facingMode&&(i.facingMode=e.facingMode),this.videoConstraints=i}},{key:"getMediaStreamResolution",value:function(e){if(e){var t=e.getVideoTracks();if(t&&t.length>0){var r=t[0].getSettings();if(r.width&&r.height)return u.ULS.sendTraceTag(508700307,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"MediaStreamClient::getMediaStreamResolution : extracted resolution from MediaStream video track. width=".concat(r.width,", height=").concat(r.height)),new c.Vector2(r.width,r.height)}}return u.ULS.sendTraceTag(509745350,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"MediaStreamClient::getMediaStreamResolution : Unable to get resolution from MediaStream track. Falling back to default dimensions."),new c.Vector2(d.defaultVideoWidth,d.defaultVideoHeight)}}]);var e}();t.MediaStreamClient=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(429);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(430);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}));var a=r(431);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}));var o=r(432);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PPTLiveGlobalStateManager=t.PPTLiveAppComponent=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(3),l=r(206),c=r(441);t.PPTLiveAppComponent=n,function(e){e.PrivateViewingAddon="PrivateViewingAddon",e.GridView="GridView",e.SlideShowToolbar="SlideShowToolbar",e.SlideShowInkingToolbar="SlideShowInkingToolbar"}(n||(t.PPTLiveAppComponent=n={}));var u=(0,o.default)((function e(t,r,i){(0,a.default)(this,e),this.m_logger=i,this.sanitizeAndHashUrl(r),this.m_sessionKey="sharing_".concat(t),this.m_localStorageHelper=c.LocalStorageHelper.getCurrentInstance(this.m_logger)}),[{key:"updateGlobalState",value:function(e,t){var r=this.fetchGlobalState();switch(s.ULS.sendTraceTag(507102481,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Error,"PPTLiveGlobalStateManager: update GlobalState for ".concat(e)),r&&r.SessionKey!==this.m_sessionKey&&(this.m_localStorageHelper.clearEntryFromLocalStorage(c.PPTLiveLocalStorageCaller.PPTLiveGlobalAppState),s.ULS.sendTraceTag(507102480,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Error,"PPTLiveGlobalStateManager: Current SessionKey is different from SessionKey in localStorage, clearing entry."),r=void 0),r||(r={SessionKey:this.m_sessionKey,LocalAppState:{}}),e){case n.PrivateViewingAddon:r.LocalAppState.role=t.role,r.LocalAppState.currentSlideLocation=t.currentSyncState,r.LocalAppState.currentAnimationState=t.currentAnimationState,r.LocalAppState.globalSyncState=t.globalSyncState,r.LocalAppState.globalAnimationState=t.globalAnimationState;break;default:s.ULS.sendTraceTag(507102479,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Error,"PPTLiveGlobalStateManager: ".concat(e," not in in PPTLiveAppComponent list.")),r.LocalAppState.CallerNotDefined=t}this.m_localStorageHelper.writeToLocalStorage(c.PPTLiveLocalStorageCaller.PPTLiveGlobalAppState,r)}},{key:"fetchGlobalState",value:function(){try{var e=JSON.parse(this.m_localStorageHelper.readFromLocalStorage(c.PPTLiveLocalStorageCaller.PPTLiveGlobalAppState));if(e&&e.LocalAppState)return e}catch(e){this.m_logger.sendTraceTag(507102478,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"PPTLiveGlobalStateManager: Error when reading from local storage: ".concat(e))}}},{key:"fetchGlobalStateForCurrentSharingSession",value:function(){var e=this.fetchGlobalState();if(e&&e.LocalAppState&&e.SessionKey===this.m_sessionKey)return e}},{key:"sanitizeAndHashUrl",value:function(e){if(e){var t=e.split("tempauth=");if(t&&t.length>=1){var r=t[0];if(r)return this.calculateHash(r)}}return s.ULS.sendTraceTag(507102477,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Error,"PPTLiveGlobalStateManager: Failed to get document Url."),""}},{key:"calculateHash",value:function(e){return e?"".concat((new l.sha256).update(e).digest("hex")):""}}]);t.PPTLiveGlobalStateManager=u},,function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,i){return e[0]===t&&(r=i,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(t,r){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,i=e(r,t);~i&&r.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,i=this.__entries__;r<i.length;r++){var n=i[r];e.call(t,n[1],n[0])}},t}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},o=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,l=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,i=!1,n=0;function o(){r&&(r=!1,e()),i&&l()}function s(){a(o)}function l(){var e=Date.now();if(r){if(e-n<2)return;i=!0}else r=!0,i=!1,setTimeout(s,20);n=e}return l}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;o.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),c=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},u=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},d=g(0,0,0,0);function h(e){return parseFloat(e)||0}function f(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+h(e["border-"+r+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof u(e).SVGGraphicsElement}:function(e){return e instanceof u(e).SVGElement&&"function"==typeof e.getBBox};function p(e){return i?m(e)?function(e){var t=e.getBBox();return g(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return d;var i=u(e).getComputedStyle(e),n=function(e){for(var t={},r=0,i=["top","right","bottom","left"];r<i.length;r++){var n=i[r],a=e["padding-"+n];t[n]=h(a)}return t}(i),a=n.left+n.right,o=n.top+n.bottom,s=h(i.width),l=h(i.height);if("border-box"===i.boxSizing&&(Math.round(s+a)!==t&&(s-=f(i,"left","right")+a),Math.round(l+o)!==r&&(l-=f(i,"top","bottom")+o)),!function(e){return e===u(e).document.documentElement}(e)){var c=Math.round(s+a)-t,m=Math.round(l+o)-r;1!==Math.abs(c)&&(s-=c),1!==Math.abs(m)&&(l-=m)}return g(n.left,n.top,s,l)}(e):d}function g(e,t,r,i){return{x:e,y:t,width:r,height:i}}var v=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=p(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var r,i,n,a,o,s,l,u=(i=(r=t).x,n=r.y,a=r.width,o=r.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(s.prototype),c(l,{x:i,y:n,width:a,height:o,top:n,right:i+a,bottom:o+n,left:i}),l);c(this,{target:e,contentRect:u})},_=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new v(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),S="undefined"!=typeof WeakMap?new WeakMap:new r,T=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=l.getInstance(),i=new _(t,r,this);S.set(this,i)};["observe","unobserve","disconnect"].forEach((function(e){T.prototype[e]=function(){var t;return(t=S.get(this))[e].apply(t,arguments)}}));var b=void 0!==n.ResizeObserver?n.ResizeObserver:T;t.default=b}).call(this,r(57))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.InputsAddon=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(34),c=r(11),u=r(26),d=r(3),h=r(46),f=r(4),m=r(421),p=function(){return(0,s.default)((function e(t,r,i,n,a){(0,o.default)(this,e),this.events=new u.EventEmitter,this.m_preventClickEvent=!1,this.m_lastScaling=0,this.m_lastPosition=h.Vector2.Zero,this.m_touchInputEnabled=!1,this.m_mouseInputEnabled=!1,this.m_opticalZoomTouchInputsEnabled=!1,this.m_opticalZoomMouseInputsEnabled=!1,this.m_opticalZoomKeyboardInputsEnabled=!1,this.m_slideshowCore=t,this.m_isRtl=i,this.m_container=r,this.m_hammerManager=new m.Manager(r),f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)?(this.m_hammerManager.add(new m.Pan),this.m_hammerManager.add((new m.Swipe).recognizeWith(this.m_hammerManager.get("pan"))),this.m_hammerManager.add((new m.Pinch).recognizeWith(this.m_hammerManager.get("pan")))):this.m_hammerManager.add(new m.Swipe),this.m_boundOnClick=this.onClickAsync.bind(this),this.m_boundOnWheel=this.onWheel.bind(this),this.m_boundOnKeyDown=this.onKeyDownAsync.bind(this),this.m_boundOnKeyDownForOpticalZoom=this.onKeyDownForOpticalZoom.bind(this),this.m_boundOnSwipeEvent=this.onSwipeEventAsync.bind(this),this.m_boundOnMousePanEvent=this.onMousePan.bind(this),this.m_boundOnTouchPanEvent=this.onTouchPan.bind(this),this.m_boundOnPinchEvent=this.onPinch.bind(this),this.enableMouseInput(),this.enableKeyboardInput(),this.enableTouchInput(),this.m_inputLoggingCallback=n,this.m_onBeforeNavigateAsync=c.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")?a&&a.onBeforeNavigateAsync:void 0}),[{key:"enableMouseInput",value:function(){f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_mouseInputEnabled||(this.m_container.addEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!0,d.ULS.sendTraceTag(540153436,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableMouseInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"disableMouseInput",value:function(){f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_mouseInputEnabled||(this.m_container.removeEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!1,d.ULS.sendTraceTag(540153437,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableMouseInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"enableKeyboardInput",value:function(){this.m_container.addEventListener("keydown",this.m_boundOnKeyDown),d.ULS.sendTraceTag(540153438,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableKeyboardInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," "))}},{key:"disableKeyboardInput",value:function(){this.m_container.removeEventListener("keydown",this.m_boundOnKeyDown),d.ULS.sendTraceTag(540153439,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableKeyboardInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," "))}},{key:"enableTouchInput",value:function(){if(f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)){if(this.m_touchInputEnabled)return}else c.ChangeGate.isChangeGateEnabled("SlideShowCore.offSwipeBeforeOnSwipe")&&(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),d.ULS.sendTraceTag(540153440,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: offSwipeBeforeOnSwipe"));this.m_hammerManager.on("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!0,d.ULS.sendTraceTag(540153441,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableTouchInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," "))}},{key:"disableTouchInput",value:function(){f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_touchInputEnabled||(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!1,d.ULS.sendTraceTag(540153442,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableTouchInput, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"enableOpticalZoomTouchInputs",value:function(){this.m_opticalZoomTouchInputsEnabled||(this.m_hammerManager.on("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.on("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!0,d.ULS.sendTraceTag(521491776,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableOpticalZoomTouchInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"disableOpticalZoomTouchInputs",value:function(){this.m_opticalZoomTouchInputsEnabled&&(this.m_hammerManager.off("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.off("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!1,d.ULS.sendTraceTag(521491777,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableOpticalZoomTouchInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"enableOpticalZoomMouseInputs",value:function(){this.m_opticalZoomMouseInputsEnabled||(this.m_container.addEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.on("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!0,d.ULS.sendTraceTag(521491778,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableOpticalZoomMouseInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"disableOpticalZoomMouseInputs",value:function(){this.m_opticalZoomMouseInputsEnabled&&(this.m_container.removeEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.off("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!1,d.ULS.sendTraceTag(521491779,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableOpticalZoomMouseInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"enableOpticalZoomKeyboardInputs",value:function(){this.m_opticalZoomKeyboardInputsEnabled||(this.m_container.addEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!0,d.ULS.sendTraceTag(512550726,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: enableOpticalZoomKeyboardInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"disableOpticalZoomKeyboardInputs",value:function(){this.m_opticalZoomKeyboardInputsEnabled&&(this.m_container.removeEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!1,d.ULS.sendTraceTag(512550725,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon: disableOpticalZoomKeyboardInputs, containerClassList: ".concat(this.m_container?this.m_container.classList:"",", containerId: ").concat(this.m_container?this.m_container.id:""," ")))}},{key:"onSwipeEventAsync",value:(r=(0,a.default)(n.default.mark((function e(t){var r=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(f.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>f.Settings.readNumberOrDefault("minimumZoom",1))){e.next=2;break}return e.abrupt("return");case 2:if(!c.ChangeGate.isChangeGateEnabled("SlideShowCore.skipSwipeFromNonSlideContainer")||t.target===this.m_container){e.next=4;break}return e.abrupt("return");case 4:if(this.m_inputLoggingCallback&&this.m_inputLoggingCallback(""),!c.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")||!this.m_onBeforeNavigateAsync){e.next=14;break}if(e.t0=this.m_onBeforeNavigateAsync,!e.t0){e.next=11;break}return e.next=10,this.m_onBeforeNavigateAsync("");case 10:e.t0=e.sent;case 11:if(e.t0){e.next=14;break}return e.abrupt("return");case 14:"swipeleft"===t.type?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.Touch)):"swiperight"===t.type&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",l.SlideshowActionSource.Touch)),this.m_preventClickEvent=!0,window.setTimeout((function(){r.m_preventClickEvent=!1}),0);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onMousePan",value:function(e){var t=this;if("mouse"===e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>f.Settings.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type&&(this.m_lastPosition=h.Vector2.Zero,f.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grabbing",this.m_container.style.cursor="-webkit-grabbing",this.m_container.style.cursor="grabbing"),f.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){d.ULS.sendTraceTag(509658721,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon::onMousePan - Could not capture pointer: ".concat(e))}"panend"===e.type&&f.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"),this.m_slideshowCore.panByAmount(new h.Vector2(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:l.OpticalZoomSource.Mouse}),this.m_lastPosition=new h.Vector2(e.deltaX,e.deltaY),this.m_preventClickEvent=!0,window.setTimeout((function(){return t.m_preventClickEvent=!1}))}}},{key:"onTouchPan",value:function(e){if("mouse"!==e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>f.Settings.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type){if(this.m_lastPosition=new h.Vector2(e.deltaX,e.deltaY),f.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){d.ULS.sendTraceTag(509658720,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon::onTouchPan - Could not capture pointer: ".concat(e))}return}this.m_slideshowCore.panByAmount(new h.Vector2(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:l.OpticalZoomSource.Touch}),this.m_lastPosition=new h.Vector2(e.deltaX,e.deltaY)}}},{key:"onPinch",value:function(e){if("pinchstart"!==e.type){if(f.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent&&!this.m_container.hasPointerCapture(e.srcEvent.pointerId))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){d.ULS.sendTraceTag(509658718,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon::onPinch - Could not capture pointer: ".concat(e))}this.m_slideshowCore.zoomToAsync(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*e.scale/this.m_lastScaling,new h.Vector2(e.center.x,e.center.y),{source:l.OpticalZoomSource.Pinch}),this.m_slideshowCore.panByAmount(new h.Vector2(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:l.OpticalZoomSource.Pinch}),this.m_lastPosition=new h.Vector2(e.deltaX,e.deltaY),this.m_lastScaling=e.scale}else if(this.m_lastScaling=e.scale,this.m_lastPosition=new h.Vector2(e.deltaX,e.deltaY),f.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){d.ULS.sendTraceTag(509658719,d.LogCategory.msoulscat_Wac_PptLive,d.TraceLevel.Info,"InputsAddon::onPinch - Could not capture pointer: ".concat(e))}}},{key:"onClickAsync",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target===this.m_container&&!this.m_preventClickEvent){e.next=2;break}return e.abrupt("return");case 2:if(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),!c.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")||!this.m_onBeforeNavigateAsync){e.next=12;break}if(e.t0=this.m_onBeforeNavigateAsync,!e.t0){e.next=9;break}return e.next=8,this.m_onBeforeNavigateAsync("");case 8:e.t0=e.sent;case 9:if(e.t0){e.next=12;break}return e.abrupt("return");case 12:this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.Mouse);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onWheel",value:function(e){if(e.preventDefault(),e.ctrlKey||e.metaKey){var t=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*(e.deltaY<0?1-.001*e.deltaY:1/(1+.001*e.deltaY));this.m_slideshowCore.zoomToAsync(t,new h.Vector2(e.clientX,e.clientY),{source:l.OpticalZoomSource.CtrlWheel})}else this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>f.Settings.readNumberOrDefault("minimumZoom",1)&&this.m_slideshowCore.panByAmount(new h.Vector2(-e.deltaX,-e.deltaY),{source:l.OpticalZoomSource.Scroll})}},{key:"onKeyDownForOpticalZoom",value:function(e){switch(e.key){case"Escape":this.m_slideshowCore.zoomToAsync(f.Settings.readNumberOrDefault("minimumZoom",1),void 0,{fAnimate:!0,source:l.OpticalZoomSource.KeyboardEscape});break;case"=":case"+":this.m_slideshowCore.zoomToAsync(1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:l.OpticalZoomSource.KeyboardPlus});break;case"_":case"-":this.m_slideshowCore.zoomToAsync(1/1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:l.OpticalZoomSource.KeyboardMinus})}switch(e.key){case"ArrowUp":return void this.m_slideshowCore.panByAmount(new h.Vector2(0,10),{source:l.OpticalZoomSource.KeyboardArrowUp});case"ArrowDown":return void this.m_slideshowCore.panByAmount(new h.Vector2(0,-10),{source:l.OpticalZoomSource.KeyboardArrowDown});case"ArrowLeft":return void this.m_slideshowCore.panByAmount(new h.Vector2(10,0),{source:l.OpticalZoomSource.KeyboardArrowLeft});case"ArrowRight":return void this.m_slideshowCore.panByAmount(new h.Vector2(-10,0),{source:l.OpticalZoomSource.KeyboardArrowRight})}}},{key:"onKeyDownAsync",value:(e=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isComposing&&229!==t.keyCode){e.next=3;break}return this.events.emit("keydown",t),e.abrupt("return");case 3:if(!c.ChangeGate.isChangeGateEnabled("awaitCallBackenabled")||!this.m_onBeforeNavigateAsync){e.next=12;break}if(e.t0=this.m_onBeforeNavigateAsync,!e.t0){e.next=9;break}return e.next=8,this.m_onBeforeNavigateAsync("");case 8:e.t0=e.sent;case 9:if(e.t0){e.next=12;break}return e.abrupt("return");case 12:if("n"===t.key.toLowerCase()?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.Keyboard)):"p"===t.key.toLowerCase()&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",l.SlideshowActionSource.Keyboard)),this.m_container===document.querySelector("#slideshow-app-thumbnail-strip")){e.next=28;break}if(!(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>f.Settings.readNumberOrDefault("minimumZoom",1))){e.next=16;break}return e.abrupt("return");case 16:e.t1=t.key,e.next="PageDown"===e.t1||" "===e.t1||"Enter"===e.t1||"ArrowDown"===e.t1?19:"PageUp"===e.t1||"Backspace"===e.t1||"ArrowUp"===e.t1?22:"ArrowLeft"===e.t1||"ArrowRight"===e.t1?25:27;break;case 19:return this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.Keyboard),e.abrupt("break",28);case 22:return this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",l.SlideshowActionSource.Keyboard),e.abrupt("break",28);case 25:return"ArrowRight"===t.key&&!this.m_isRtl||"ArrowLeft"===t.key&&this.m_isRtl?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.Keyboard)):(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",l.SlideshowActionSource.Keyboard)),e.abrupt("break",28);case 27:this.events.emit("keydown",t);case 28:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e,t,r}();t.InputsAddon=p},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationLoggerAddon=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(80),l=r(3);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=(0,o.default)((function e(t,r,i,n){var o=this;(0,a.default)(this,e),this.m_sharingLayoutMode=void 0,l.ULS.setLogger(i),this.m_animatedContentLogger=new s.AnimatedContentLogger({type:"Animation"}),t.events.on("animationStateChanging",this.logFrameData.bind(this)),n&&(n.appEvents&&n.appEvents.on("sharingLayoutModeChanged",(function(e){o.m_sharingLayoutMode=e})),n.sharingLayoutMode&&(this.m_sharingLayoutMode=n.sharingLayoutMode))}),[{key:"logFrameData",value:function(e){var t=u(u({},e.metadata),{},{sharingLayoutMode:this.m_sharingLayoutMode||"undefined"});this.m_animatedContentLogger.logFrameData(e.isAnimating,{metadata:t})}}]);t.AnimationLoggerAddon=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionLoggerAddon=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(80),l=r(3);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=(0,o.default)((function e(t,r,i,n){var o=this;(0,a.default)(this,e),this.m_sharingLayoutMode=void 0,l.ULS.setLogger(i),this.m_transitionContentLogger=new s.AnimatedContentLogger({type:"Transition"}),t.events.on("slideLocationChanging",this.logFrameData.bind(this)),n&&(n.appEvents&&n.appEvents.on("sharingLayoutModeChanged",(function(e){o.m_sharingLayoutMode=e})),n.sharingLayoutMode&&(this.m_sharingLayoutMode=n.sharingLayoutMode))}),[{key:"logFrameData",value:function(e){var t=u(u({},e.metadata),{},{sharingLayoutMode:this.m_sharingLayoutMode||"undefined"});this.m_transitionContentLogger.logFrameData(e.isTransitioning,{metadata:t})}}]);t.TransitionLoggerAddon=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultResourceProviders=void 0;var n=i(r(6)),a=i(r(5)),o=i(r(18)),s=i(r(7)),l=i(r(1)),c=i(r(2)),u=r(78),d=r(83),h=r(46),f=r(186),m=r(14),p=r(3),g=r(58),v=r(11),y=r(96),_=r(4),S=r(67),T=r(81);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return P(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var I="ErrorFailedToLoadPresInfo",k="ErrorMissingClientWidthOrHeight",E="ErrorFailedToParseSlideInfo",x="ErrorFailedToLoadSlideInfo",L="ErrorMissingSlideId",A=function(){return(0,c.default)((function e(t,r,i){var a,c,h,b,P,A,M,R,O=this;(0,l.default)(this,e),this.m_isNetworkHealthSpotty=!1,this.m_isNetworkHealthy=!0,this.presInfoLoader={load:(a=(0,s.default)(n.default.mark((function e(t,r){var i,a,s,l,c;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={resourceId:t,metadata:{errorName:I}},null!=r.meta_clientWidth&&null!=r.meta_clientHeight){e.next=5;break}return O.m_logger.sendTraceTag(595178197,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"missing clientWidth or clientHeight"),i.metadata.errorName=k,e.abrupt("return",i);case 5:a={ClientWidth:r.meta_clientWidth,ClientHeight:r.meta_clientHeight,CorrelationId:r.meta_correlationId||"",FilterHiddenSlideInfo:r.meta_filterHiddenSlideInfo,RequestInfo:r.meta_requestInfo,PriorityHint:r.meta_priorityHint,IsBootRequest:r.meta_isInit,IncludeSections:r.meta_includeSections},s={presInfo:void 0,responseErrorCode:u.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:u.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},l=0;case 8:if(!(l<O.m_settings.retryCount)){e.next=26;break}return e.next=11,O.m_podProxy.getItemsPresInfoAsync(a);case 11:if(s=e.sent,l+=1,!s.presInfo){e.next=15;break}return e.abrupt("break",26);case 15:if(!O.shouldRetry(s)){e.next=23;break}return c=r.meta_correlationId,r.meta_correlationId=(0,g.v4)(),a.CorrelationId=r.meta_correlationId,O.m_logger.sendTraceTag(577250645,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"presInfoLoader: Generating new correlationId for retrying request - resourceId:".concat(t,", old correlation:").concat(c,", new correlation:").concat(r.meta_correlationId,", attempts:").concat(l,",\n            responseErrorCode:").concat(s.responseErrorCode.toString(),", errorCodeMap:").concat(s.itemErrorCodeMap?JSON.stringify((0,o.default)(s.itemErrorCodeMap)):"")),e.abrupt("continue",8);case 23:return e.abrupt("break",26);case 24:e.next=8;break;case 26:if(s.presInfo){e.next=29;break}return i.metadata.errorName=O.getErrorFromResponse(s,{responseType:"presInfo",resourceId:t,cid:r.meta_correlationId,attempts:l},u.GetRequestItemIds.PresInfoMetaData),e.abrupt("return",i);case 29:return O.m_logger.sendTraceTag(579470407,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"presInfoLoader: Got presInfo - resourceId:".concat(t,", correlation:").concat(r.meta_correlationId,", attempts:").concat(l)),i.resource=s.presInfo,i.metadata={created:new Date,lastAccessed:new Date,cached:s.usedOutputCache&&"true"===s.usedOutputCache.toString().toLowerCase().trim(),requestInfo:r.meta_requestInfo},s.metadata&&(i.metadata.getItemsResult=s.metadata),e.abrupt("return",i);case 34:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},this.slideLoader={load:(c=(0,s.default)(n.default.mark((function e(t,r){var i,a,o,s,l,c,u,d,h,g;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={resourceId:t,metadata:{errorName:"ErrorFailedToLoadSlide"}},e.prev=1,a=JSON.parse(t).sid){e.next=7;break}return O.m_logger.sendTraceTag(594587729,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideLoader: invalid resourceId ".concat(t)),i.metadata.errorName=L,e.abrupt("return",i);case 7:return r.meta_correlationId||O.m_logger.sendTraceTag(591734944,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"missing correlation in slideLoader. resourceId:".concat(t)),e.prev=8,e.next=11,O.slideInfo.load(JSON.stringify({sid:a,cid:0}),r);case 11:if((o=e.sent).resource){e.next=18;break}return O.m_logger.sendTraceTag(593498711,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideLoader: failed to load slideInfo."),i.metadata.errorName=x,o.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=o.metadata.errorName),o.metadata.hasOwnProperty("getItemsResult")&&o.metadata.getItemsResult&&(i.metadata.getItemsResult=o.metadata.getItemsResult),e.abrupt("return",i);case 18:e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(8),O.m_logger.sendTraceTag(593498712,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideLoader: failed to load slideInfo. Exception:".concat((0,T.stringifyException)(e.t0))),i.metadata.errorName=x,e.abrupt("return",i);case 25:return e.next=27,O.presInfo.load("",r);case 27:if((s=e.sent)&&s.resource){e.next=32;break}return i.metadata.errorName=I,s&&!s.resource&&s.metadata&&s.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=s.metadata.errorName),e.abrupt("return",i);case 32:if(l=new Map(O.imageData.getAllLoadResultsInCache().map((function(e){return[e.resourceId,e.resource]}))),e.prev=33,c=f.SlideShowDataParser.getDataFromSlideInfoAndImages(o.resource,s.resource.SlideOrder,l)){e.next=38;break}return i.metadata.errorName=E,e.abrupt("return",i);case 38:e.next=45;break;case 40:return e.prev=40,e.t1=e.catch(33),O.m_logger.sendTraceTag(509161995,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideLoader: failed to parse data from slideInfo. Exception:".concat((0,T.stringifyException)(e.t1))),i.metadata.errorName=E,e.abrupt("return",i);case 45:for(i.resource=c.slide,i.metadata={created:new Date,lastAccessed:new Date,cached:o.metadata.hasOwnProperty("cached")&&o.metadata.cached&&"true"===o.metadata.cached.toString().toLowerCase().trim()},o.metadata.hasOwnProperty("requestInfo")&&o.metadata.requestInfo&&(i.metadata.requestInfo=o.metadata.requestInfo),o.metadata.hasOwnProperty("getItemsResult")&&o.metadata.getItemsResult&&(i.metadata.getItemsResult=o.metadata.getItemsResult),o.metadata.hasOwnProperty("axErrorName")&&(i.metadata.axErrorName=o.metadata.axErrorName),u=0;u<c.shapeViewDatas.length;u+=1)d="".concat(JSON.stringify(c.slideViewData.slideId),"_").concat(JSON.stringify(c.shapeViewDatas[u].shapeId)),h={resourceId:d,resource:c.shapeViewDatas[u],metadata:i.metadata,options:r},O.shapeViewData.add(h);return g={resourceId:t,resource:c.slideViewData,metadata:i.metadata,options:r},O.slideViewData.add(g),O.m_logger.sendTraceTag(593498713,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"slideLoader: slide loaded. sid:".concat(a)),e.abrupt("return",i);case 57:return e.prev=57,e.t2=e.catch(1),O.m_logger.sendTraceTag(509161994,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideLoader: failed to load slide. Exception:".concat((0,T.stringifyException)(e.t2))),e.abrupt("return",i);case 61:case"end":return e.stop()}}),e,null,[[1,57],[8,20],[33,40]])}))),function(e,t){return c.apply(this,arguments)})},this.slideViewDataLoader={load:(h=(0,s.default)(n.default.mark((function e(t,r){var i,a,o,s,l,c,u,d,h,g;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={resourceId:t,metadata:{errorName:"ErrorFailedToLoadSlideViewData"}},a=JSON.parse(t).sid){e.next=6;break}return O.m_logger.sendTraceTag(594587730,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideViewDataLoader: invalid resourceId ".concat(t)),i.metadata.errorName=L,e.abrupt("return",i);case 6:return e.next=8,O.slideInfo.load(JSON.stringify({sid:a,cid:0}),r);case 8:if((o=e.sent).resource){e.next=14;break}return i.metadata.errorName=x,o.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=o.metadata.errorName),O.m_logger.sendTraceTag(591734945,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideViewDataLoader: failed to load slideInfo. errorName:".concat(i.metadata.errorName,", resourceId:").concat(t,", correlation:").concat(r.meta_correlationId)),e.abrupt("return",i);case 14:return e.next=16,O.presInfo.load("",r);case 16:if((s=e.sent)&&s.resource){e.next=21;break}return i.metadata.errorName=I,s&&!s.resource&&s.metadata&&s.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=s.metadata.errorName),e.abrupt("return",i);case 21:if(l=new Map(O.imageData.getAllLoadResultsInCache().map((function(e){return[e.resourceId,e.resource]}))),c=f.SlideShowDataParser.getDataFromSlideInfoAndImages(o.resource,s.resource.SlideOrder,l)){e.next=26;break}return i.metadata.errorName=E,e.abrupt("return",i);case 26:for(i.resource=c.slideViewData,i.metadata={created:new Date,lastAccessed:new Date,cached:o.metadata.hasOwnProperty("cached")&&o.metadata.cached&&"true"===o.metadata.cached.toString().toLowerCase().trim()},o.metadata.hasOwnProperty("requestInfo")&&o.metadata.requestInfo&&(i.metadata.requestInfo=o.metadata.requestInfo),o.metadata.hasOwnProperty("getItemsResult")&&o.metadata.getItemsResult&&(i.metadata.getItemsResult=o.metadata.getItemsResult),u=0;u<c.shapeViewDatas.length;u+=1)d="".concat(JSON.stringify(c.slideViewData.slideId),"_").concat(JSON.stringify(c.shapeViewDatas[u].shapeId)),h={resourceId:d,resource:c.shapeViewDatas[u],metadata:i.metadata,options:r},O.shapeViewData.add(h);return g={resourceId:t,resource:c.slide,metadata:i.metadata,options:r},O.slide.add(g),e.abrupt("return",i);case 34:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},this.shapeViewDataLoader={load:(b=(0,s.default)(n.default.mark((function e(t,r){var i,a,o,s,l,c,u,d,h;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={resourceId:t,metadata:{errorName:"ErrorFailedToLoadShapeViewData"}},a=t.split("_")[0],o=JSON.parse(a).sid){e.next=7;break}return O.m_logger.sendTraceTag(594587731,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"shapeViewDataLoader: invalid slideIdString ".concat(a)),i.metadata.errorName=L,e.abrupt("return",i);case 7:return e.next=9,O.slideInfo.load(JSON.stringify({sid:o,cid:0}),r);case 9:if((s=e.sent)&&s.resource){e.next=14;break}return i.metadata.errorName=x,s&&!s.resource&&s.metadata&&s.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=s.metadata.errorName),e.abrupt("return",i);case 14:return e.next=16,O.presInfo.load("",r);case 16:if((l=e.sent)&&l.resource){e.next=21;break}return i.metadata.errorName=I,l&&!l.resource&&l.metadata&&l.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=l.metadata.errorName),e.abrupt("return",i);case 21:if(c=new Map(O.imageData.getAllLoadResultsInCache().map((function(e){return[e.resourceId,e.resource]}))),u=f.SlideShowDataParser.getDataFromSlideInfoAndImages(s.resource,l.resource.SlideOrder,c)){e.next=26;break}return i.metadata.errorName=E,e.abrupt("return",i);case 26:return i.resource=u.shapeViewDatas.filter((function(e){return JSON.stringify(e.shapeId)===t.split("_")[1]}))[0],i.metadata={created:new Date,lastAccessed:new Date,cached:s.metadata.hasOwnProperty("cached")&&s.metadata.cached&&"true"===s.metadata.cached.toString().toLowerCase().trim()},s.metadata.hasOwnProperty("requestInfo")&&s.metadata.requestInfo&&(i.metadata.requestInfo=s.metadata.requestInfo),s.metadata.hasOwnProperty("getItemsResult")&&s.metadata.getItemsResult&&(i.metadata.getItemsResult=s.metadata.getItemsResult),d={resourceId:JSON.stringify(u.slide.id),resource:u.slide,metadata:i.metadata,options:r},O.slide.add(d),h={resourceId:JSON.stringify(u.slideViewData.slideId),resource:u.slideViewData,metadata:i.metadata,options:r},O.slideViewData.add(h),e.abrupt("return",i);case 35:case"end":return e.stop()}}),e)}))),function(e,t){return b.apply(this,arguments)})},this.resourceIdToImageLoadPromise={},this.imageLoader={load:(P=(0,s.default)(n.default.mark((function t(r,i){var a,l,c,d,h,f,v,y,_,S,T,b;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a={resourceId:r,metadata:{errorName:"ErrorFailedToLoadResourceEntry"}},i&&null!=i.meta_clientWidth&&null!=i.meta_clientHeight&&i.meta_resourceEntries){t.next=5;break}return O.m_logger.sendTraceTag(595178198,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"missing clientWidth or clientHeight or resourceEntries"),a.metadata.errorName=k,t.abrupt("return",a);case 5:if(!(r in O.resourceIdToImageLoadPromise)){t.next=11;break}return t.next=8,O.resourceIdToImageLoadPromise[r];case 8:if(!(l=O.imageData.getLoadResultInCache(r,i))){t.next=11;break}return t.abrupt("return",l);case 11:if(c=i.meta_resourceEntries){t.next=15;break}return a.metadata.errorName="ErrorMissingEntriesInOptions",t.abrupt("return",a);case 15:d=[],d=c.map((function(e){return{Id:e.id,Name:e.name}})),h=new Promise(function(){var t=(0,s.default)(n.default.mark((function t(s){var l,h,f,v,y,_;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l={ClientWidth:i.meta_clientWidth,ClientHeight:i.meta_clientHeight,ResourceParams:d,EnableClustering:!0===i.meta_enableClustering,IsHighContrast:i.meta_isHighContrast,ColorMode:i.meta_colorMode,ClientColorSettings:i.meta_clientColorSettings,CorrelationId:i.meta_correlationId||"",RequestInfo:i.meta_requestInfo,PriorityHint:i.meta_priorityHint,IsBootRequest:i.meta_isInit,LocaleName:i.meta_localeName},h={slideInfo:[],responseErrorCode:u.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:u.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},f=0;case 3:if(!(f<O.m_settings.retryCount)){t.next=22;break}return f>=1&&e.shouldReduceResolution(h)&&O.adjustRequestParamsForRetry(l,i),t.next=7,O.m_podProxy.getItemsResourceAsync(l);case 7:if(h=t.sent,f+=1,!(h.slideInfo&&h.slideInfo.length>0)){t.next=11;break}return t.abrupt("break",22);case 11:if(!O.shouldRetry(h)){t.next=19;break}return v=i.meta_correlationId,i.meta_correlationId=(0,g.v4)(),l.CorrelationId=i.meta_correlationId,O.m_logger.sendTraceTag(577250646,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"imageLoader: Generating new correlationId for retrying request - resourceId:".concat(r,", old correlation:").concat(v,", new correlation:").concat(i.meta_correlationId,", attempts:").concat(f,", responseErrorCode:").concat(h.responseErrorCode.toString(),", errorCodeMap:").concat(h.itemErrorCodeMap?JSON.stringify((0,o.default)(h.itemErrorCodeMap)):"")),t.abrupt("continue",3);case 19:return t.abrupt("break",22);case 20:t.next=3;break;case 22:if(0!==h.slideInfo.length&&h.slideInfo[0].ResourceData){t.next=26;break}return a.metadata.errorName=O.getErrorFromResponse(h,{responseType:"slideInfo_image",resourceId:r,cid:i.meta_correlationId,hasSlideInfo:!!h.slideInfo,slideInfoLen:h.slideInfo?h.slideInfo.length:0,hasRes:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].ResourceData,attempts:f},""),s(),t.abrupt("return",a);case 26:return O.m_logger.sendTraceTag(579470408,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"imageLoader: Got slideInfoResponse - resourceId:".concat(r,", correlation:").concat(i.meta_correlationId,", attempts:").concat(f)),y=h.slideInfo[0].ResourceData,_=!(!h.usedOutputCache||"true"!==h.usedOutputCache.toString().toLowerCase().trim()),O.addImages(c,y,i,_),a.metadata={created:new Date,lastAccessed:new Date,cached:h.usedOutputCache&&"true"===h.usedOutputCache.toString().toLowerCase().trim(),requestInfo:i.meta_requestInfo},s(),t.abrupt("return",a);case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),f=w(d);try{for(f.s();!(v=f.n()).done;)y=v.value,O.resourceIdToImageLoadPromise[y.Id]=h}catch(e){f.e(e)}finally{f.f()}return t.next=22,h;case 22:_=w(d);try{for(_.s();!(S=_.n()).done;)T=S.value,delete O.resourceIdToImageLoadPromise[T.Id]}catch(e){_.e(e)}finally{_.f()}return b=O.imageData.getLoadResultInCache(r,i),t.abrupt("return",b||a);case 26:case"end":return t.stop()}}),t)}))),function(e,t){return P.apply(this,arguments)})},this.slideInfoLoader={load:(A=(0,s.default)(n.default.mark((function t(r,i){var a,o,s,l,c,d,h,y,S,T,b;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a={resourceId:r,metadata:{errorName:x}},null!=i.meta_clientWidth&&null!=i.meta_clientHeight){t.next=5;break}return O.m_logger.sendTraceTag(595178199,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"missing clientWidth or clientHeight"),a.metadata.errorName=k,t.abrupt("return",a);case 5:if(o=JSON.parse(r).sid){t.next=10;break}return O.m_logger.sendTraceTag(594587732,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"slideInfoLoader: invalid resourceId ".concat(r)),a.metadata.errorName=L,t.abrupt("return",a);case 10:i.meta_correlationId||O.m_logger.sendTraceTag(591734947,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"missing correlationId in slideInfoLoader. resourceId:".concat(r)),s={SlideLocations:[{slideId:{sid:o,cid:0}}],GetSlideImage:!1,ClientWidth:i.meta_clientWidth,ClientHeight:i.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:i.meta_isHighContrast,ColorMode:i.meta_colorMode,ClientColorSettings:i.meta_clientColorSettings,TranslateLanguage:i.meta_translateLanguage,CorrelationId:i.meta_correlationId||"",RequestInfo:i.meta_requestInfo,PriorityHint:i.meta_priorityHint,IsBootRequest:i.meta_isInit,LocaleName:i.meta_localeName},(l={ExportAsImages:_.Settings.readBooleanOrDefault("forceSvg",!1)}).Settings=O.m_getItemsSettings,l.ImageAppendOption=e.getImageAppendOption(i.meta_imageAppendOption),l.EnableClustering=!0===i.meta_enableClustering,l.UseAnimatableParts=!0,l.ExportShapeBuilderSVG=i.meta_enableSVGAsWebGLTexture,l.ConvertGifToVideo=i.meta_convertGifToVideo,i.meta_knownGlyphs&&(l.KnownGlyphs=i.meta_knownGlyphs),s.Filters=l,c={slideInfo:[],responseErrorCode:u.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:u.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},d=0;case 23:if(!(d<O.m_settings.retryCount)){t.next=40;break}return d>=1&&e.shouldReduceResolution(c)&&O.adjustRequestParamsForRetry(s,i),t.next=27,O.m_podProxy.getItemsSlideInfosAsync(s);case 27:if(c=t.sent,d+=1,!O.isValidSlideInfo(c)||v.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.RetryOnAXError")&&!O.isValidSlideAXInfo(c,s)){t.next=31;break}return t.abrupt("break",40);case 31:if(!O.shouldRetry(c)){t.next=37;break}return i.meta_correlationId=(0,g.v4)(),s.CorrelationId=i.meta_correlationId,t.abrupt("continue",23);case 37:return t.abrupt("break",40);case 38:t.next=23;break;case 40:if(h="",O.isValidSlideInfo(c)&&O.isValidSlideAXInfo(c,s)||(h=O.getErrorFromResponse(c,{responseType:"slideInfo",resourceId:r,cid:i.meta_correlationId,hasSlideInfo:!!c.slideInfo,slideInfoLen:c.slideInfo?c.slideInfo.length:0,hasSlideshowInfo:!!(c.slideInfo&&c.slideInfo.length>0)&&!!c.slideInfo[0].SlideShowInfo,getAX:s.GetSlideAccessibilityModelData,hasAX:!!(c.slideInfo&&c.slideInfo.length>0)&&!!c.slideInfo[0].AccessibilityModel,attempts:d},"")),O.isValidSlideInfo(c)){t.next=45;break}return a.metadata.errorName=h,t.abrupt("return",a);case 45:return O.m_logger.sendTraceTag(579470409,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"slideInfoLoader: Got slideInfo - resourceId:".concat(r,", correlation:").concat(i.meta_correlationId,", attempts:").concat(d,", responseError:").concat(h,", SlideShowInfo is not empty:").concat(!!c.slideInfo&&c.slideInfo.length>0&&!!c.slideInfo[0].SlideShowInfo)),y=c.slideInfo,O.m_logger.sendTraceTag(557973763,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"slideInfoLoader: Got slideInfo - resourceId:".concat(r,", correlation:").concat(i.meta_correlationId,", attempts:").concat(d,", enableKnownGlyphsOptimization:").concat(!!i.meta_knownGlyphs,", SlideShowInfo length:").concat(JSON.stringify(y).length)),a.resource=y[0],a.metadata={created:new Date,lastAccessed:new Date,cached:c.usedOutputCache&&"true"===c.usedOutputCache.toString().toLowerCase().trim(),requestInfo:i.meta_requestInfo},!O.isValidSlideAXInfo(c,s)&&h&&(a.metadata.axErrorName=h),c.metadata&&(a.metadata.getItemsResult=c.metadata),S=c.slideInfo[0].ResourceData,_.Settings.readBooleanOrDefault("hackTestMissingImages",!1)&&(S=[]),c.slideInfo[0].SlideShowInfo&&(T=f.SlideShowDataParser.parseResCat(c.slideInfo[0].SlideShowInfo.sld[0]).filter((function(e){return""===e.url}))),b=!(!c.usedOutputCache||"true"!==c.usedOutputCache.toString().toLowerCase().trim()),O.addImages(T,S,i,b),t.abrupt("return",a);case 58:case"end":return t.stop()}}),t)}))),function(e,t){return A.apply(this,arguments)})},this.localizedStringLoader={load:(M=(0,s.default)(n.default.mark((function e(t,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={resourceId:t,metadata:{errorName:"ErrorLocalizedStringNotFound"}},O.m_settings&&O.m_settings.localizedStrings&&O.m_settings.localizedStrings[t]){e.next=3;break}return e.abrupt("return",i);case 3:return i.resource=O.m_settings.localizedStrings[t],i.metadata={created:new Date,lastAccessed:new Date},e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return M.apply(this,arguments)})},this.presInfoAndSlideInfoLoader={load:(R=(0,s.default)(n.default.mark((function t(r,i){var a,s,l,c,d,h,y,T,b,w,P,E,x,A,M,R,D,F,B;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a={resourceId:r,metadata:{errorName:I}},t.prev=1,null!=i.meta_clientWidth&&null!=i.meta_clientHeight){t.next=6;break}return O.m_logger.sendTraceTag(577250648,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"missing clientWidth or clientHeight"),a.metadata.errorName=k,t.abrupt("return",a);case 6:if((s=JSON.parse(r)).slideId&&s.slideId.sid||void 0!==s.slideIndex){t.next=11;break}return O.m_logger.sendTraceTag(577250649,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"presInfoAndSlideInfoLoader: invalid resourceId ".concat(r)),a.metadata.errorName=L,t.abrupt("return",a);case 11:l={ClientWidth:i.meta_clientWidth,ClientHeight:i.meta_clientHeight,CorrelationId:i.meta_correlationId||"",FilterHiddenSlideInfo:i.meta_filterHiddenSlideInfo,RequestInfo:i.meta_requestInfo,PriorityHint:i.meta_priorityHint,IsBootRequest:i.meta_isInit,IncludeSections:i.meta_includeSections},i.meta_correlationId||O.m_logger.sendTraceTag(577250650,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"missing correlationId in presInfoAndSlideInfoLoader. resourceId:".concat(r)),c={SlideLocations:[s],GetSlideImage:!1,ClientWidth:i.meta_clientWidth,ClientHeight:i.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:i.meta_isHighContrast,ColorMode:i.meta_colorMode,ClientColorSettings:i.meta_clientColorSettings,TranslateLanguage:i.meta_translateLanguage,CorrelationId:i.meta_correlationId||"",RequestInfo:i.meta_requestInfo,PriorityHint:i.meta_priorityHint,IsBootRequest:i.meta_isInit,LocaleName:i.meta_localeName},(d={ExportAsImages:_.Settings.readBooleanOrDefault("forceSvg",!1)}).Settings=O.m_getItemsSettings,d.ImageAppendOption=e.getImageAppendOption(i.meta_imageAppendOption),d.EnableClustering=!0===i.meta_enableClustering,d.UseAnimatableParts=!0,d.ExportShapeBuilderSVG=i.meta_enableSVGAsWebGLTexture,d.ConvertGifToVideo=i.meta_convertGifToVideo,c.Filters=d,h={presInfo:void 0,slideInfo:[],responseErrorCode:u.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:u.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,itemErrorCodeMap:void 0},y=0,T=!1,b=O.m_settings.retryCount;case 26:if(!(y<b)){t.next=67;break}if(t.prev=27,T&&(c.GetSlideAccessibilityModelData=!1),w=O.shouldTimeoutResponseStreamDownload(y),!(y>=1)){t.next=35;break}if(e.shouldReduceResolution(h)&&O.adjustRequestParamsForRetry(c,i),!_.Settings.readBooleanOrDefault("retryWhenGoodNetworkForBoot",!1)){t.next=35;break}return t.next=35,(0,S.waitUntilTrueAsync)((function(){return O.m_isNetworkHealthy}));case 35:return P=i.meta_overrideDownloadTimeoutIfBadNetworkMs&&O.m_isNetworkHealthSpotty?i.meta_overrideDownloadTimeoutIfBadNetworkMs:void 0,E=void 0,(_.Settings.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)||_.Settings.readBooleanOrDefault("overrideAllTimeoutsForBootIfBadNetwork",!1)&&O.m_isNetworkHealthSpotty)&&(P=_.Settings.readNumberOrDefault("overrideDownloadTimeoutForBootMs",0)||P,E=_.Settings.readNumberOrDefault("overrideGetItemsTimeoutForBootAttempt".concat(y+1,"Ms"),0)||E),t.next=40,O.m_podProxy.getItemsPresInfoAndSlideInfosAsync(l,c,{shouldTimeoutResponseStreamDownload:w,overrideDownloadTimeoutMs:P,overrideGetItemsTimeoutMs:E});case 40:if(h=t.sent,y+=1,!h.presInfo||!O.isValidSlideInfo(h)||v.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.RetryOnAXError")&&!O.isValidSlideAXInfo(h,c)){t.next=44;break}return t.abrupt("break",67);case 44:if(h.responseErrorCode!==u.ErrorCode.ErrorDownloadResponseStreamTimeout||T){t.next=50;break}O.m_logger.sendTraceTag(560317845,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"presInfoAndSlideInfoLoader - switch to use fallback request as ErrorDownloadResponseStreamTimeout error received."),T=!0,y-=1,t.next=59;break;case 50:if(!O.shouldRetry(h)){t.next=58;break}return x=i.meta_correlationId,i.meta_correlationId=(0,g.v4)(),l.CorrelationId=i.meta_correlationId,O.m_logger.sendTraceTag(577250651,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"presInfoAndSlideInfoResponse: Generating new correlationId for retrying request - resourceId:".concat(r,", old correlation:").concat(x,", new correlation:").concat(i.meta_correlationId,",\n                attempts:").concat(y,", responseErrorCode:").concat(h.responseErrorCode.toString(),", errorCodeMap:").concat(h.itemErrorCodeMap?JSON.stringify((0,o.default)(h.itemErrorCodeMap)):"")),t.abrupt("continue",26);case 58:return t.abrupt("break",67);case 59:t.next=64;break;case 61:t.prev=61,t.t0=t.catch(27),O.m_logger.sendTraceTag(571524049,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"presInfoAndSlideInfoLoader - exception during call m_podProxy.getItemsPresInfoAndSlideInfosAsync, attempts:".concat(y,", info: ").concat(t.t0,". "));case 64:O.m_isNetworkHealthSpotty&&_.Settings.readBooleanOrDefault("overrideRetryCountForBootIfBadNetwork",!1)&&(b=_.Settings.readNumberOrDefault("overrideRetryCount",b)),t.next=26;break;case 67:if(A="",h.presInfo&&O.isValidSlideInfo(h)&&O.isValidSlideAXInfo(h,c)||(A=O.getErrorFromResponse(h,{responseType:"presInfoAndSlideInfo",resourceId:r,cid:i.meta_correlationId,hasSlideInfo:!!h.slideInfo,slideInfoLen:h.slideInfo?h.slideInfo.length:0,hasSlideshowInfo:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].SlideShowInfo,getAX:c.GetSlideAccessibilityModelData,hasAX:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].AccessibilityModel,attempts:y},"")),h.presInfo){t.next=73;break}return a.metadata.errorName=A,a.metadata.isIntentional=h.responseIsIntentional,t.abrupt("return",a);case 73:if(O.m_logger.sendTraceTag(577250653,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"presInfoAndSlideInfoResponse: Got presInfoAndSlideInfo - resourceId:".concat(r,", correlation:").concat(i.meta_correlationId,", attempts:").concat(y)),a.metadata={created:new Date,lastAccessed:new Date,cached:h.usedOutputCache&&"true"===h.usedOutputCache.toString().toLowerCase().trim(),requestInfo:i.meta_requestInfo},h.metadata&&(a.metadata.getItemsResult=h.metadata),M={resourceId:"",resource:h.presInfo,metadata:a.metadata,options:i},O.presInfo.add(M),!O.isValidSlideInfo(h)){t.next=89;break}a.resource=C(C({},h.presInfo),h.slideInfo[0]),O.isValidSlideAXInfo(h,c)||(a.metadata.axErrorName=A),R={resourceId:JSON.stringify({sid:h.slideInfo[0].ID.sid,cid:0}),resource:h.slideInfo[0],metadata:a.metadata,options:i},O.slideInfo.add(R),D=h.slideInfo[0].ResourceData,h.slideInfo[0].SlideShowInfo&&(F=f.SlideShowDataParser.parseResCat(h.slideInfo[0].SlideShowInfo.sld[0]).filter((function(e){return""===e.url}))),B=!(!h.usedOutputCache||"true"!==h.usedOutputCache.toString().toLowerCase().trim()),O.addImages(F,D,i,B),t.next=92;break;case 89:return a.resource=h.presInfo,O.m_logger.sendTraceTag(577065922,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"presInfoAndSlideInfoResponse: failed to get slideInfo in presInfoAndSlideInfo. errorName:".concat(A,", resourceId:").concat(r,", correlation:").concat(i.meta_correlationId,", attempts:").concat(y)),t.abrupt("return",M);case 92:return t.abrupt("return",a);case 95:return t.prev=95,t.t1=t.catch(1),O.m_logger.sendTraceTag(571524050,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Error,"presInfoAndSlideInfoLoader - exception during call load: ".concat(t.t1,". ")),t.abrupt("return",a);case 99:case"end":return t.stop()}}),t,null,[[1,95],[27,61]])}))),function(e,t){return R.apply(this,arguments)})},this.m_podProxy=t,this.m_logger=r,this.m_settings=i||{retryCount:3};var D={};if(i&&i.settings)for(var F in _.Settings.addOrUpdateSetting(i.settings,"getitemsmanaged","supportsSlideInfoResult",_.Settings.readStringOrDefault("enableSlideInfoResult","false")),i.settings)if(-1!==F.toLowerCase().indexOf("getitems")){var B=i.settings[F],N={};for(var V in B)N[V]=B[V].toString();D[F]=N}this.m_getItemsSettings=D,(0,y.setupGlobals_SlideShowCore)({logger:this.m_logger,settings:i?i.settings:void 0,disabledChangeGates:this.m_settings.disabledChangeGates}),this.presInfoAndSlideInfo=new d.PowerPointResourceProvider(this.presInfoAndSlideInfoLoader),this.presInfo=new d.PowerPointResourceProvider(this.presInfoLoader),this.slide=new d.PowerPointResourceProvider(this.slideLoader),this.slideViewData=new d.PowerPointResourceProvider(this.slideViewDataLoader),this.imageData=new d.PowerPointResourceProvider(this.imageLoader),this.imageData.events.on("removed",(function(e){return O.disposeImage(e)})),this.shapeViewData=new d.PowerPointResourceProvider(this.shapeViewDataLoader),this.slideInfo=new d.PowerPointResourceProvider(this.slideInfoLoader),this.localizedString=new d.PowerPointResourceProvider(this.localizedStringLoader)}),[{key:"disposeImage",value:function(e){e.resource&&e.resource.urlType===h.UrlType.ObjectUrl&&URL.revokeObjectURL(e.resource.url)}},{key:"dispose",value:function(){var e,t=w(this.imageData.getAllLoadResultsInCache());try{for(t.s();!(e=t.n()).done;){var r=e.value;this.imageData.remove(r.resourceId,r.options)}}catch(e){t.e(e)}finally{t.f()}}},{key:"updatePodsProxy",value:function(e){this.m_podProxy=e}},{key:"isSlideCached",value:function(e){return!!this.slideInfo.getLoadResultInCache(e)}},{key:"invalidateSlideAsync",value:(e=(0,s.default)(n.default.mark((function e(t,r){var i,a,o,s,l,c,u,d,h,m,p,g,v;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.sid,a=t.cid,this.slideInfo.getLoadResultsInCache(JSON.stringify({sid:i,cid:0}))){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.slideInfo.load(JSON.stringify({sid:i,cid:0}),r);case 6:return o=e.sent,e.next=9,this.presInfo.load("",r);case 9:if(s=e.sent,o.resource&&s.resource){e.next=12;break}return e.abrupt("return");case 12:if(l=new Map(this.imageData.getAllLoadResultsInCache().map((function(e){return[e.resourceId,e.resource]}))),c=f.SlideShowDataParser.getDataFromSlideInfoAndImages(o.resource,s.resource.SlideOrder,l)){e.next=16;break}return e.abrupt("return");case 16:for(u=0;u<c.shapeViewDatas.length;u+=1)d="".concat(JSON.stringify(c.slideViewData.slideId),"_").concat(JSON.stringify(c.shapeViewDatas[u].shapeId)),this.shapeViewData.remove(d);if(h=c.slideViewData,(m=h.resCat)&&0!==m.length){e.next=21;break}return e.abrupt("return");case 21:p=w(m);try{for(p.s();!(g=p.n()).done;)v=g.value,this.imageData.remove(v.id)}catch(e){p.e(e)}finally{p.f()}this.slideViewData.remove(JSON.stringify({sid:i,cid:0})),this.slide.remove(JSON.stringify({sid:i,cid:0})),this.slideInfo.remove(JSON.stringify({sid:i,cid:0})),this.slideViewData.remove(JSON.stringify(c.slideViewData.slideId)),this.slide.remove(JSON.stringify(c.slide.id)),this.slideInfo.remove(JSON.stringify({sid:i,cid:a})),this.presInfo.remove(""),this.presInfoAndSlideInfo.remove(JSON.stringify({slideIndex:0}));case 31:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"resetProviders",value:function(){var e=this;this.dispose(),this.presInfoAndSlideInfo=new d.PowerPointResourceProvider(this.presInfoAndSlideInfoLoader),this.presInfo=new d.PowerPointResourceProvider(this.presInfoLoader),this.slide=new d.PowerPointResourceProvider(this.slideLoader),this.slideViewData=new d.PowerPointResourceProvider(this.slideViewDataLoader),this.imageData=new d.PowerPointResourceProvider(this.imageLoader),this.imageData.events.on("removed",(function(t){return e.disposeImage(t)})),this.shapeViewData=new d.PowerPointResourceProvider(this.shapeViewDataLoader),this.slideInfo=new d.PowerPointResourceProvider(this.slideInfoLoader),this.localizedString=new d.PowerPointResourceProvider(this.localizedStringLoader)}},{key:"shouldTimeoutResponseStreamDownload",value:function(e){if(e>=this.m_settings.retryCount-1)return this.m_logger.sendTraceTag(560317846,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"shouldTimeoutResponseStream - last retry attemp, so should not timeout. "),!1;var t=!1;try{var r=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(r){var i=null!=r.downlink?r.downlink:void 0,n=null!=r.rtt?r.rtt:void 0;i>=_.Settings.readNumberOrDefault("fallbackRequestMinNetworkSpeed",1)&&n<=_.Settings.readNumberOrDefault("fallbackRequestMaxRTT",1e3)&&(t=!0),this.m_logger.sendTraceTag(560317847,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"DefaultResourceProviders::Client network info - downlinkSpeed: ".concat(i,"Mbps, rtt: ").concat(n,"ms, shouldTimeoutResponseStream:").concat(t))}else this.m_logger.sendTraceTag(560317848,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"DefaultResourceProviders::network information API not supported by the browser")}catch(e){this.m_logger.sendTraceTag(560317849,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"DefaultResourceProviders::shouldTimeoutResponseStreamDownload exception: ".concat(e))}return t}},{key:"shouldRetry",value:function(e){var t=this;return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some((function(e){return t.m_settings.retryOnCategories&&t.m_settings.retryOnCategories.indexOf(e.trim())>=0}))||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some((function(e){return t.m_settings.retryOnCategories&&t.m_settings.retryOnCategories.indexOf(e.trim())>=0}))||this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.includes(e.responseErrorCategory.toString())||!this.m_settings.retryOnCategories}},{key:"getErrorFromResponse",value:function(e,t,r){var i="";if("ErrorRESERVEDSuccess"!==e.responseErrorCode.toString())i=e.responseErrorCode.toString();else if(e.itemErrorCodeMap){if(""!==r)i=e.itemErrorCodeMap.get(r)||"";else{var n=Array.from(e.itemErrorCodeMap.values()).filter((function(e){return"ErrorRESERVEDSuccess"!==e.trim()}));n.length>0&&(i=n[0])}JSON.stringify((0,o.default)(e.itemErrorCodeMap))}return i&&!i.startsWith("Server")&&(this.m_logger.sendTraceTag(509732750,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Info,"Prefixing Server to errorName:".concat(i)),i="Server".concat(i)),i}},{key:"isValidSlideInfo",value:function(e){return!!e.slideInfo&&e.slideInfo.length>0&&(!v.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.checkSlideShowInfo")||!!e.slideInfo[0].SlideShowInfo)}},{key:"isValidSlideAXInfo",value:function(e,t){return!!e.slideInfo&&e.slideInfo.length>0&&(!t.GetSlideAccessibilityModelData||!!e.slideInfo[0].AccessibilityModel)}},{key:"addImages",value:function(e,t,r,i){var n=this;if(t){var a,o=w(t);try{var s=function(){var t=a.value,o=e?e.find((function(e){return e.id===t.Id})):void 0;if(o&&!n.imageData.getLoadResultInCache(o.id,r)){o.byteCount=t.ByteCount,o.mimeType=t.MimeType,t.Binary?(o.url=URL.createObjectURL(new Blob([t.Binary],{type:o.mimeType})),o.urlType=h.UrlType.ObjectUrl):(o.url=t.Base64,o.urlType=h.UrlType.Base64),o.url||n.m_logger.sendTraceTag(540849759,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"imageLoader: Got empty url - ".concat(JSON.stringify({resourceId:t.Id,correlation:r.meta_correlationId,res:o})));var s={resourceId:o.id,resource:o,metadata:{created:Date.now(),lastAccessed:Date.now(),cached:i,requestInfo:r.meta_requestInfo},options:r};n.imageData.add(s)}t.Binary&&(t.Binary=void 0)};for(o.s();!(a=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}}}},{key:"adjustRequestParamsForRetry",value:function(e,t){var r=t.meta_clientHeightReduced,i=t.meta_clientWidthReduced;(_.Settings.readBooleanOrDefault("loadMinResolutionOnRetry",!1)||_.Settings.readBooleanOrDefault("loadMinResolutionIfBadNetwork",!0)&&this.m_isNetworkHealthSpotty)&&t.meta_clientHeightMin&&t.meta_clientWidthMin&&(r=t.meta_clientHeightMin,i=t.meta_clientWidthMin),r&&i&&(v.ChangeGate.isChangeGateEnabled("SSC.logAdjustRequestParamClientResolution")&&this.m_logger.sendTraceTag(527242946,p.LogCategory.msoulscat_Wac_PptSlideshow,m.TraceLevel.Warning,"DefaultResourceProvider: adjusted request param client resolution - ".concat(JSON.stringify({oldClientHeight:e.ClientHeight,oldClientWidth:e.ClientWidth,newClientHeight:r,newClientWidth:i}))),e.ClientWidth=i,e.ClientHeight=r)}},{key:"setNetworkHealth",value:function(e){e||(this.m_isNetworkHealthSpotty=!0),this.m_isNetworkHealthy=e}}],[{key:"getImageAppendOption",value:function(e){switch(e){case"none":return u.SlideImageAppendOption.None;case"all":return u.SlideImageAppendOption.All;case"partial":return u.SlideImageAppendOption.Partial;case"embed":default:return u.SlideImageAppendOption.Embed}}},{key:"shouldReduceResolution",value:function(e){var t=_.Settings.readStringOrDefault("errorsToReduceResolutionOnRetry","");return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some((function(e){return t.indexOf(e.trim())>=0}))||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some((function(e){return t.indexOf(e.trim())>=0}))||t.includes(e.responseErrorCategory.toString())}}]);var e}();t.DefaultResourceProviders=A},function(e,t,r){(t=e.exports=function(e){e=e.toLowerCase();var r=t[e];if(!r)throw new Error(e+" is not supported (we accept pull requests)");return new r}).sha=r(433),t.sha1=r(438),t.sha224=r(439),t.sha256=r(190),t.sha384=r(440),t.sha512=r(191)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CameoWebcamAddon=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(197),u=r(95),d=r(442),h=function(){return(0,s.default)((function e(t,r){(0,o.default)(this,e),this.m_toggledOn=!1,this.m_cameoDetectedNearby=!1,this.m_defaultCameraLabel="",this.m_slideshowCore=t,this.m_mediaStreamClientConfig={id:"cameo-webcam",source:new d.BrowserMediaStreamAccessor,videoConstraints:{}},this.m_mediaStreamClient=new c.MediaStreamClient(this.m_mediaStreamClientConfig),this.m_notificationCallback=r&&r.notificationCallback,this.registerCoreEventListeners()}),[{key:"isActive",get:function(){return this.m_toggledOn&&this.m_cameoDetectedNearby}},{key:"setCameraState",value:function(e){this.m_toggledOn=e,this.updateCameoState()}},{key:"updateWebcamDevice",value:function(e,t){if(e){var r={exact:e},i={deviceId:r};t&&t.facingMode&&("user"===t.facingMode||"environment"===t.facingMode)&&(i={deviceId:r,facingMode:{exact:t.facingMode}}),this.m_mediaStreamClient.isActive?this.startMediaCaptureAsync(i,!0):this.m_mediaStreamClient.updateConstraints(i,!0)}else l.ULS.sendTraceTag(509641865,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"CameoWebcamAddon::updateWebcamDevice: Invalid deviceId")}},{key:"getDefaultCameraLabel",value:function(){return this.m_defaultCameraLabel}},{key:"getActiveCameraLabel",value:function(){if(this.m_mediaStreamClient&&this.m_mediaStreamClient.isActive){var e=this.m_mediaStreamClient.VideoElement.srcObject.getVideoTracks()[0];if(e)return e.label}return""}},{key:"registerCoreEventListeners",value:function(){this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("logSessionEnd",this.onSlideShowSessionEnd.bind(this))}},{key:"onSlideLocationChanged",value:function(){var e=this,t=this.isActive;this.isCameoDetectedNearbyAsync().then((function(r){e.m_cameoDetectedNearby=r,t!==e.isActive&&e.updateCameoState()}))}},{key:"onSlideShowSessionEnd",value:function(){this.m_cameoDetectedNearby=!1}},{key:"updateCameoState",value:function(){this.m_slideshowCore.isCameoActive=this.isActive,l.ULS.sendTraceTag(509641864,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"CameoWebcamAddon::updateCameoState: isActive=".concat(this.isActive,", toggledOn=").concat(this.m_toggledOn,", isCameoDetectedNearby=").concat(this.m_cameoDetectedNearby)),this.isActive?(l.ULS.sendTraceTag(508842192,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"CameoWebcamAddon::updateCameoState: starting webcam capture"),this.startMediaCaptureAsync()):(this.clearCameo(),this.stopMediaCapture())}},{key:"isCameoDetectedNearbyAsync",value:(t=(0,a.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.m_slideshowCore){e.next=2;break}return e.abrupt("return",this.m_slideshowCore.isCameoDetectedNearbyAsync());case 2:return e.abrupt("return",!1);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"clearCameo",value:function(){this.m_slideshowCore&&this.m_slideshowCore.clearCameo()}},{key:"startMediaCaptureAsync",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i,a,o=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],e.prev=1,e.next=4,this.m_mediaStreamClient.startMediaCaptureAsync(t,r);case 4:(i=e.sent)===u.MediaStreamError.ErrorNone?(this.setCameoVideoElement(this.m_mediaStreamClient.VideoElement),""===this.m_defaultCameraLabel&&(this.m_defaultCameraLabel=this.getActiveCameraLabel()),this.m_notificationCallback&&this.m_notificationCallback("CameraStarted","Streaming"),l.ULS.sendTraceTag(508180175,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"CameoWebcamAddon::startMediaCaptureAsync: success")):(l.ULS.sendTraceTag(508684509,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture failed with error=".concat(i)),this.m_notificationCallback&&this.m_notificationCallback(i,"Error")),e.next=15;break;case 8:e.prev=8,e.t0=e.catch(1),l.ULS.sendTraceTag(509641863,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture threw error=".concat(e.t0)),this.m_toggledOn=!1,this.updateCameoState(),this.m_mediaStreamClient.resetToOriginalConstraints(),this.m_notificationCallback&&((a=e.t0.toString())&&"string"==typeof a?this.m_notificationCallback(a,"Error"):this.m_notificationCallback("unknown","Error"));case 15:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(t){return e.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.m_mediaStreamClient.stopMediaCapture()}},{key:"setCameoVideoElement",value:function(e){e?this.m_slideshowCore&&this.m_slideshowCore.setCameoVideoElement(e):l.ULS.sendTraceTag(509641862,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"CameoWebcamAddon::setCameoVideoElement : MediaStreamClient VideoElement is missing")}}]);var e,t}();t.CameoWebcamAddon=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(423);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(424);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}))},,,function(e,t){e.exports=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}},function(e,t,r){"use strict";(function(e){var t=r(0)(r(15)),i=function(e){var r=Object.prototype,i=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var n=t&&t.prototype instanceof h?t:h,a=Object.create(n.prototype),o=new w(i||[]);return a._invoke=function(e,t,r){var i="suspendedStart";return function(n,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw a;return{value:void 0,done:!0}}for(r.method=n,r.arg=a;;){var o=r.delegate;if(o){var s=T(o,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=u(e,t,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}(e,r,o),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function f(){}function m(){}var p={};p[a]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(P([])));v&&v!==r&&i.call(v,a)&&(p=v);var y=m.prototype=h.prototype=Object.create(p);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,r){var n;this._invoke=function(a,o){function s(){return new r((function(n,s){!function n(a,o,s,l){var c=u(e[a],e,o);if("throw"!==c.type){var d=c.arg,h=d.value;return h&&"object"===(0,t.default)(h)&&i.call(h,"__await")?r.resolve(h.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):r.resolve(h).then((function(e){d.value=e,s(d)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}(a,o,n,s)}))}return n=n?n.then(s,s):s()}}function T(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=u(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:I}}function I(){return{value:void 0,done:!0}}return f.prototype=y.constructor=m,m.constructor=f,f.displayName=l(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},_(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(t,r,i,n,a){void 0===a&&(a=Promise);var o=new S(c(t,r,i,n),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(y),l(y,s,"Generator"),y[a]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=P,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return o.type="throw",o.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;C(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}("object"===(0,t.default)(e)?e.exports:{});try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}}).call(this,r(99)(e))},function(e,t,r){var i=r(126);e.exports=function(e){if(Array.isArray(e))return i(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw a}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,r){var i=r(8);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Shape3D=t.Material=t.MaterialType=t.Bevel=t.Scene3D=t.Light=void 0;var n=i(r(2)),a=i(r(1)),o=r(36),s=(0,n.default)((function e(t,r,i,n,o,s){(0,a.default)(this,e),this.color=t,this.direction=r,this.wrapScale=i,this.wrapOffset=n,this.diffuse=o,this.specular=s}));t.Light=s;var l=(0,n.default)((function e(t,r){(0,a.default)(this,e),this.ambientColor=t,this.lights=r}));t.Scene3D=l;var c,u=(0,n.default)((function e(t,r){(0,a.default)(this,e),this.profile=t,this.size=r}));t.Bevel=u,t.MaterialType=c,function(e){e[e.Default=0]="Default",e[e.Wireframe=1]="Wireframe",e[e.Metal=2]="Metal"}(c||(t.MaterialType=c={}));var d=(0,n.default)((function e(t,r,i,n,o,s,l,c,u){(0,a.default)(this,e),this.materialType=t,this.diffuseColor=r,this.specularColor=i,this.ambientColor=n,this.emissiveColor=o,this.specularPower=s,this.useBlinnHighlight=l,this.diffuseFresnel=c,this.alphaFresnel=u}));t.Material=d;var h=(0,n.default)((function e(t,r,i,n,o,s,l,c){(0,a.default)(this,e),this.topBevel=t,this.bottomBevel=r,this.material=i,this.extrusionColor=n,this.extrusionHeight=o,this.contourColor=s,this.contourWidth=l,this.zPosition=c}),[{key:"adjustedContourWidth",get:function(){return Math.max(o.s_minLineWidth,this.contourWidth)}}]);t.Shape3D=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PictureEffects=t.Mask=t.MaskMode=t.HighlightsShadows=t.LookupTable=t.Sharpness=t.Recolor=t.ColorTemperature=t.BrightnessContrast=t.HueSaturationLuminance=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(223),l=r(59),c=r(37),u=r(16),d=r(12),h=r(36),f=r(13),m=function(){function e(t,r,i){(0,a.default)(this,e),this.hueRotation=t,this.saturationFactor=r,this.luminanceFactor=i}return(0,o.default)(e,[{key:"equals",value:function(e){return this.hueRotation==e.hueRotation&&this.saturationFactor==e.saturationFactor&&this.luminanceFactor==e.luminanceFactor}},{key:"clone",value:function(){return new e(this.hueRotation,this.saturationFactor,this.luminanceFactor)}},{key:"hasImpact",get:function(){return 0!=this.hueRotation||1!=this.saturationFactor||1!=this.luminanceFactor}}])}();t.HueSaturationLuminance=m;var p=function(){function e(t,r){(0,a.default)(this,e),this.brightness=t,this.contrast=r}return(0,o.default)(e,[{key:"equals",value:function(e){return this.brightness==e.brightness&&this.contrast==e.contrast}},{key:"clone",value:function(){return new e(this.brightness,this.contrast)}},{key:"hasImpact",get:function(){return h.s_useLegacyContrast?0!=this.brightness||1!=this.contrast:0!=this.brightness||0!=this.contrast}}])}();t.BrightnessContrast=p;var g=function(){function e(t,r){(0,a.default)(this,e),this.temperature=t,this.tint=r;var i=(0,s.mapOfficeTemperatureAndTintToRBGains)(t,r),o=(0,n.default)(i,3);this.redGain=o[0],this.greenGain=o[1],this.blueGain=o[2]}return(0,o.default)(e,[{key:"equals",value:function(e){return this.redGain==e.redGain&&this.greenGain==e.greenGain&&this.blueGain==e.blueGain}},{key:"clone",value:function(){return new e(this.temperature,this.tint)}},{key:"hasImpact",get:function(){return 1!=this.redGain||1!=this.greenGain||1!=this.blueGain}}])}();t.ColorTemperature=g;var v=function(){function e(t,r,i){(0,a.default)(this,e),this.darkColor=t,this.brightColor=r,this.threshold=i}return(0,o.default)(e,[{key:"equals",value:function(e){return this.darkColor.equals(e.darkColor)&&this.brightColor.equals(e.brightColor)&&this.threshold===e.threshold}},{key:"clone",value:function(){return new e(this.darkColor,this.brightColor,this.threshold)}}])}();t.Recolor=v;var y=function(){function e(t,r,i){(0,a.default)(this,e),this.sharpness=t,this.depthFocus=null!=r?r:0,this.enableForegroundBlur=null!=i&&i}return(0,o.default)(e,[{key:"equals",value:function(e){return this.sharpness===e.sharpness&&this.depthFocus===e.depthFocus&&this.enableForegroundBlur===e.enableForegroundBlur}},{key:"clone",value:function(){return new e(this.sharpness,this.depthFocus,this.enableForegroundBlur)}},{key:"hasImpact",get:function(){return 0!=this.sharpness}}])}();t.Sharpness=y;var _=function(){function e(t,r,i,n,o){(0,a.default)(this,e),this.table=t,this.dimensionR=r,this.dimensionG=i,this.dimensionB=n,this.blocksPerRow=o;var s=this.resolution;t.length!=s.x*s.y*3&&f.Log.Error(509728261,"Unexpected LookupTable resolution R:".concat(this.dimensionR," G:").concat(this.dimensionG," B:").concat(this.dimensionB," BPR:").concat(this.blocksPerRow," bytes:").concat(t.length))}return(0,o.default)(e,[{key:"resolution",get:function(){return e.CalculateResolution(this.dimensionR,this.dimensionG,this.dimensionB,this.blocksPerRow)}},{key:"equals",value:function(e){if(this.dimensionR!=e.dimensionR||this.dimensionG!=e.dimensionG||this.dimensionB!=e.dimensionB||this.blocksPerRow!=e.blocksPerRow||this.table.length!=e.table.length)return!1;for(var t=0;t<this.table.length;t++)if(this.table[t]!=e.table[t])return!1;return!0}},{key:"clone",value:function(){return new e(this.table,this.dimensionR,this.dimensionG,this.dimensionB,this.blocksPerRow)}},{key:"hasImpact",get:function(){return!0}}],[{key:"CalculateResolution",value:function(e,t,r,i){return new d.Vector2(e*i,t*Math.ceil(r/i))}},{key:"CreateNeutralTable",value:function(t,r,i,n){var a=e.CalculateResolution(t,r,i,n);if(a.x>0&&a.y>0&&t>1&&r>1&&i>1){var o=new Uint8Array(a.x*a.y*3);o.fill(0);for(var s=0;s<i;s++)for(var l=0;l<r;l++)for(var c=0;c<t;c++){var u=3*(s%n*t+Math.floor(s/n)*a.x*r)+3*(c+l*a.x);o[u]=Math.floor(255*c/(t-1)),o[u+1]=Math.floor(255*l/(r-1)),o[u+2]=Math.floor(255*s/(i-1))}return o}}}])}();t.LookupTable=_;var S,T=function(){function e(t,r,i){(0,a.default)(this,e),this.exposure=t,this.highlights=r,this.shadows=i;var n=r<0?.65*r:r,o=w(.3,0,0,t),s=w(.3,0,0,n).multiply(o),l=w(.3,0,0,0).multiply(o),c=w(.3,0,0,i).multiply(o);this.neutral=l,this.positive=s.subtract(l),this.negative=l.subtract(c)}return(0,o.default)(e,[{key:"equals",value:function(e){return this.neutral===e.neutral&&this.positive===e.positive&&this.negative===e.negative}},{key:"clone",value:function(){return new e(this.exposure,this.highlights,this.shadows)}},{key:"hasImpact",get:function(){return 0!=this.exposure||0!=this.highlights||0!=this.shadows}}])}();t.HighlightsShadows=T,t.MaskMode=S,function(e){e[e.alpha=0]="alpha",e[e.invAlpha=1]="invAlpha",e[e.effect=2]="effect",e[e.invEffect=3]="invEffect"}(S||(t.MaskMode=S={}));var b=function(){function e(t,r){(0,a.default)(this,e),this.mask=t,this.mode=r}return(0,o.default)(e,[{key:"equals",value:function(e){return this.mask===e.mask&&this.mode===e.mode}},{key:"clone",value:function(){return new e(this.mask,this.mode)}},{key:"hasImpact",get:function(){return!0}}])}();t.Mask=b;var C=function(){function e(){(0,a.default)(this,e),this.m_changeTracker=new c.ChangeTracker}return(0,o.default)(e,[{key:"changeTracker",get:function(){return this.m_changeTracker}},{key:"notifyChange",value:function(){this.m_changeTracker.notifyChange()}},{key:"hueSaturationLuminance",get:function(){return this.m_hueSaturationLuminance},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_hueSaturationLuminance,e),this.m_hueSaturationLuminance=e}},{key:"brightnessContrast",get:function(){return this.m_brightnessContrast},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_brightnessContrast,e),this.m_brightnessContrast=e}},{key:"recolor",get:function(){return this.m_recolor},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_recolor,e),this.m_recolor=e}},{key:"colorTemperature",get:function(){return this.m_colorTemperature},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_colorTemperature,e),this.m_colorTemperature=e}},{key:"sharpness",get:function(){return this.m_sharpness},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_sharpness,e),this.m_sharpness=e}},{key:"lookupTable",get:function(){return this.m_lookupTable},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_lookupTable,e),this.m_lookupTable=e}},{key:"highlightsShadows",get:function(){return this.m_highlightsShadows},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_highlightsShadows,e),this.m_highlightsShadows=e}},{key:"mask",get:function(){return this.m_mask},set:function(e){(0,l.notifyIfNotEquals)(this.changeTracker,this.m_mask,e),this.m_mask=e}},{key:"maskChannel",get:function(){var e;return null!==(e=this.m_maskChannel)&&void 0!==e?e:0},set:function(e){this.m_maskChannel=e}},{key:"hasImpact",get:function(){var e,t,r,i,n,a,o;return!!(null!==(e=this.hueSaturationLuminance)&&void 0!==e&&e.hasImpact||null!==(t=this.m_brightnessContrast)&&void 0!==t&&t.hasImpact||this.m_recolor||null!==(r=this.m_colorTemperature)&&void 0!==r&&r.hasImpact||null!==(i=this.m_sharpness)&&void 0!==i&&i.hasImpact||null!==(n=this.m_lookupTable)&&void 0!==n&&n.hasImpact||null!==(a=this.m_highlightsShadows)&&void 0!==a&&a.hasImpact||null!==(o=this.m_mask)&&void 0!==o&&o.hasImpact)}},{key:"equals",value:function(e){return(0,d.equals)(this.m_hueSaturationLuminance,e.hueSaturationLuminance)&&(0,d.equals)(this.m_brightnessContrast,e.brightnessContrast)&&(0,d.equals)(this.m_recolor,e.recolor)&&(0,d.equals)(this.m_colorTemperature,e.colorTemperature)&&(0,d.equals)(this.m_sharpness,e.sharpness)&&(0,d.equals)(this.m_lookupTable,e.lookupTable)&&(0,d.equals)(this.m_highlightsShadows,e.highlightsShadows)&&(0,d.equals)(this.m_mask,e.mask)}},{key:"clone",value:function(){var t=new e;return t.hueSaturationLuminance=this.hueSaturationLuminance,t.brightnessContrast=this.brightnessContrast,t.recolor=this.recolor,t.colorTemperature=this.colorTemperature,t.sharpness=this.sharpness,t.lookupTable=this.lookupTable,t.highlightsShadows=this.highlightsShadows,t.mask=this.mask,t}}])}();function w(e,t,r,i){var n=function(e){return Math.sign(e)*e*e},a=(0,d.clamp)(e,0,1),o=.5*n((0,d.clamp)(t,-1,1));o<0&&(o*=-1,a=(a+.5)%1);var s=.5+.25*n((0,d.clamp)(i,-1,1)),l=u.Color.FromHSL(a,o,s,1).scale(2);return new u.Color(l.r,l.g,l.b,1+(0,d.clamp)(r,-1,1))}t.PictureEffects=C},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.mapSliderValueToTint=d,t.mapSliderValueToKelvinTemperature=h,t.mapTemperatureAndTintToRBGains=f,t.mapOfficeTemperatureAndTintToRBGains=function(e,t){var r=h((e-1500)/1e4),i=(0,n.default)(r,2),a=i[0],o=i[1],s=d(t),l=(0,n.default)(s,2),c=f(a,o,l[0],l[1]),u=(0,n.default)(c,2),m=u[0],p=u[1];m<1&&(m+=.2*(1-m));var g=1;return p>1&&(g+=.15*(p-1),p+=.8*(p-1)),[m,g,p]};var n=i(r(19)),a=i(r(18)),o=r(12),s=[3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252];function l(e,t,r){return{r:s[0]*e+s[1]*t+s[2]*r,g:s[3]*e+s[4]*t+s[5]*r,b:s[6]*e+s[7]*t+s[8]*r}}var c=[{u:.18006,v:.26352,slope:-.24341,recipTemp:0},{u:.18066,v:.26589,slope:-.25479,recipTemp:1e-5},{u:.18133,v:.26846,slope:-.26876,recipTemp:2e-5},{u:.18208,v:.27119,slope:-.28539,recipTemp:1/33333},{u:.18293,v:.27407,slope:-.3047,recipTemp:4e-5},{u:.18388,v:.27709,slope:-.32675,recipTemp:5e-5},{u:.18494,v:.28021,slope:-.35156,recipTemp:1/16667},{u:.18611,v:.28342,slope:-.37915,recipTemp:1/14286},{u:.1874,v:.28668,slope:-.40955,recipTemp:8e-5},{u:.1888,v:.28997,slope:-.44278,recipTemp:1/11111},{u:.19032,v:.29326,slope:-.47888,recipTemp:1e-4},{u:.19462,v:.30141,slope:-.58204,recipTemp:1/8e3},{u:.19962,v:.30921,slope:-.70471,recipTemp:1/6667},{u:.20525,v:.31647,slope:-.84901,recipTemp:1/5714},{u:.21142,v:.32312,slope:-1.0182,recipTemp:2e-4},{u:.21807,v:.32909,slope:-1.2168,recipTemp:1/4444},{u:.22511,v:.33439,slope:-1.4512,recipTemp:1/4e3},{u:.23247,v:.33904,slope:-1.7298,recipTemp:1/3636},{u:.2401,v:.34308,slope:-2.0637,recipTemp:1/3333},{u:.24792,v:.34655,slope:-2.4681,recipTemp:1/3077},{u:.25591,v:.34951,slope:-2.9641,recipTemp:1/2857},{u:.264,v:.352,slope:-3.5814,recipTemp:1/2677},{u:.27218,v:.35407,slope:-4.3633,recipTemp:4e-4},{u:.28039,v:.35577,slope:-5.3762,recipTemp:1/2353},{u:.28863,v:.35714,slope:-6.7262,recipTemp:1/2222},{u:.29685,v:.35823,slope:-8.5955,recipTemp:1/2105},{u:.30505,v:.35907,slope:-11.324,recipTemp:5e-4},{u:.3132,v:.35968,slope:-15.628,recipTemp:1/1905},{u:.32129,v:.36011,slope:-23.325,recipTemp:1/1818},{u:.32931,v:.36038,slope:-40.77,recipTemp:1/1739},{u:.33724,v:.36051,slope:-116.45,recipTemp:1/1667}];function u(e,t){var r,i,n,a,s,l=function(e,t){for(var r=1/e,i=1;i<c.length&&!(r<c[i].recipTemp);i++);i===c.length&&i--;var n=c[i-1],a=c[i],s=(0,o.inverseLerp)(n.recipTemp,a.recipTemp,r),l=n.slope/Math.sqrt(1+n.slope*n.slope),u=a.slope/Math.sqrt(1+a.slope*a.slope),d=(0,o.mix)(l,u,s),h=(0,o.mix)(n.u,a.u,s),f=(0,o.mix)(n.v,a.v,s),m=t/Math.sqrt(1+d*d),p=h+m,g=f+d*m;if(g>-.1*p+.4){var v=(-.1*p+.4-g)/(-.1*(p-h)+f-g);p=(0,o.mix)(p,h,v),g=(0,o.mix)(g,f,v)}return{y:1,u:p,v:g}}(e,t);return r=l.y,i=l.u,n=l.v,a=0,s=0,r>=1e-7&&(a=6*i*r/(4*n),s=r*(6*(4-i)-60*n)/(12*n)),[a,r,s]}function d(e){return[.003256,1.25*(e=(0,o.mix)(-1,1,e))/100+.003256]}function h(e){var t=6502.078125;return(e=(0,o.mix)(-1,1,e))>0?t=(0,o.mix)(6502.078125,9e3,e):e<0&&(t=(0,o.mix)(6502.078125,3e3,-e)),[t,6502.078125]}function f(e,t,r,i){var n=u((0,o.clamp)(e,1667,Number.MAX_VALUE),r),s=u(t,i),c=l.apply(void 0,(0,a.default)(n)),d=l.apply(void 0,(0,a.default)(s));return[d.r/d.g/(c.r/c.g),d.b/d.g/(c.b/c.g)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interpolateShapes=function(e,t,r,n){n>0&&n<1?(e.paths=g(t.paths||[],r.paths||[],n),(t.incrementalPath||r.incrementalPath)&&i.Log.Error(507910023,"Incremental path interpolation not yet implemented"),e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=b(t.style,r.style,n),e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=c(t.effects,r.effects,n),e.transform=p(t.transform,r.transform,n),e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances):l(e,n<1?t:r)},t.assignShapeData=l,t.interpolateEffects=c,t.interpolateGlow=u,t.interpolateShadow=d,t.interpolateInnerShadow=h,t.interpolateReflection=f,t.interpolateSoftEdges=m,t.interpolateTransform=p,t.interpolatePaths=g,t.getSegmentPoint=y,t.createFigureInterpolationData=_,t.interpolateFigure=S,t.interpolateStyle=b,t.interpolatePen=C;var i=r(13),n=r(70),a=r(12),o=r(27),s=r(16);function l(e,t){e.paths=t.paths,e.incrementalPath=t.incrementalPath,e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=t.style,e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=t.effects,e.transform=t.transform,e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances}function c(e,t,r){if(r>0&&r<1){var i=e.clone();return i.glow=u(e.glow,t.glow,r),i.shadow=d(e.shadow,t.shadow,r),i.innerShadow=h(e.innerShadow,t.innerShadow,r),i.reflection=f(e.reflection,t.reflection,r),i.softEdges=m(e.softEdges,t.softEdges,r),i.direction=r<1?e.direction:t.direction,i}return r<1?e:t}function u(e,t,r){if(e&&t)return new n.Glow(s.Color.InterpolateLinear(e.color,t.color,r),(0,a.mix)(e.radius,t.radius,r));var i=e||t;if(i){var o=i.clone();return o.color=i.color.modulateOpacity(e?1-r:r),o}}function d(e,t,r){if(e&&t)return new n.Shadow(s.Color.InterpolateLinear(e.color,t.color,r),(0,a.mix)(e.radius,t.radius,r),(0,a.interpolateAngle)(e.angle,t.angle,r,void 0),(0,a.mix)(e.distance,t.distance,r),a.Vector2.InterpolateLinear(e.scale,t.scale,r),a.Vector2.InterpolateLinear(e.skew,t.skew,r),r<1?e.alignment:t.alignment,r<1?e.rotateWithShape:t.rotateWithShape,r<1?e.shadowType:t.shadowType);var i=e||t;if(i){var o=i.clone();return o.color=i.color.modulateOpacity(e?1-r:r),o}}function h(e,t,r){if(e&&t)return new n.InnerShadow(s.Color.InterpolateLinear(e.color,t.color,r),(0,a.mix)(e.radius,t.radius,r),(0,a.interpolateAngle)(e.angle,t.angle,r,void 0),(0,a.mix)(e.distance,t.distance,r));var i=e||t;if(i){var o=i.clone();return o.color=i.color.modulateOpacity(e?1-r:r),o}}function f(e,t,r){if(e&&t)return new n.Reflection((0,a.mix)(e.radius,t.radius,r),(0,a.mix)(e.startAlpha,t.startAlpha,r),(0,a.mix)(e.startPosition,t.startPosition,r),(0,a.mix)(e.endAlpha,t.endAlpha,r),(0,a.mix)(e.endPosition,t.endPosition,r),(0,a.mix)(e.distance,t.distance,r));var i=e||t;if(i){var o=i.clone();return o.startAlpha=i.startAlpha*(e?1-r:r),o.endAlpha=i.endAlpha*(e?1-r:r),o}}function m(e,t,r){if(e&&t)return new n.SoftEdges((0,a.mix)(e.radius,t.radius,r));var i=e||t;i&&(i.clone().radius=i.radius*(e?1-r:r))}function p(e,t,r){return new a.Transform(a.Vector2.InterpolateLinear(e.preTranslation,t.preTranslation,r),a.Vector2.InterpolateLinear(e.scale,t.scale,r),(0,a.interpolateAngle)(e.rotation,t.rotation,r,void 0),a.Vector2.InterpolateLinear(e.translation,t.translation,r))}function g(e,t,r){for(var n=new Array(Math.max(e.length,t.length)),s=function(){var s,c=l<e.length?e[l]:void 0,u=l<t.length?t[l]:void 0,d=c||u;if(d){if(c&&u){s=new Array(Math.max(c.figures.length,u.figures.length));for(var h=0;h<s.length;h++){var f=h<c.figures.length?c.figures[h]:void 0,m=h<u.figures.length?u.figures[h]:void 0;f&&m?s[h]=S(f,m,c.transform,u.transform,r):f?s[h]=v(f,c.transform,1-r):m&&(s[h]=v(m,u.transform,r))}}else s=d.figures.map((function(e){return v(e,d.transform,c?1-r:r)}));n[l]=new o.Path({figures:s,fillMode:d.fillMode,lineEnabled:d.lineEnabled,extrusionEnabled:d.extrusionEnabled,transform:a.Transform.Identity})}else i.Log.Error(507910022,"no path")},l=0;l<n.length;l++)s();return n}function v(e,t,r){var i=(0,o.calculateBoundsOfFigures)([e]);if(i){for(var n=i.center,s=e.points.slice(0),l=0;l<e.getPointCount();l++){var c,u=l*e.pointDataSize,d=new a.Vector2((s[u]-n.x)*r+n.x,(s[u+1]-n.y)*r+n.y);d=null!==(c=null==t?void 0:t.transformPoint(d))&&void 0!==c?c:d,s[u]=d.x,s[u+1]=d.y}return new o.Figure(s,e.isClosed,e.format)}return e}function y(e,t){var r=Math.max(0,Math.min(e.length-1,Math.floor(e.length*t))),i=Math.max(0,Math.min(1,e.length*t-r)),n=e[r];return n.quadraticControl?a.Vector2.InterpolateQuadratic(n.a,n.quadraticControl,n.b,i):a.Vector2.InterpolateLinear(n.a,n.b,i)}function _(e,t){var r=new Array;if(0==e.length)return r;for(var i=new Array,n=0;n<e.length;n++)i.push(n/e.length);for(var a=0;a<t;a++)i.push(a/t);i.sort((function(e,t){return e-t})),r.push.apply(r,[e[0].a.x,e[0].a.y,1]);for(var o=0;o<i.length;o++){var s=i[o],l=o+1<i.length?i[o+1]:1;if(s!=l){var c=y(e,s),u=y(e,(s+l)/2),d=y(e,l);r.push.apply(r,[u.x+u.x-.5*(c.x+d.x),u.y+u.y-.5*(c.y+d.y),2]),r.push.apply(r,[d.x,d.y,1])}}return r}function S(e,t,r,n,s){var l=new Array,c=new Array;e.forEachSegment((function(e,t,r){return l.push({a:e,quadraticControl:t,b:r}),!0}),r),t.forEachSegment((function(e,t,r){return c.push({a:e,quadraticControl:t,b:r}),!0}),n);var u=_(l,c.length),d=_(c,l.length);if(u.length!=d.length)return i.Log.Error(507312322,"interpolateFigure data size mismatch"),e;for(var h=new Array(u.length),f=0;f<h.length;f++)h[f]=(0,a.mix)(u[f],d[f],s);return new o.Figure(h,e.isClosed&&t.isClosed,o.TapeDataFlags.position|o.TapeDataFlags.type)}function T(e,t){return e instanceof s.ImageBrush&&t instanceof s.ImageBrush&&e.image&&t.image&&e.image.id==t.image.id}function b(e,t,r){var n=new s.Style,o=e.fillBrush&&!(e.fillBrush instanceof s.SolidBrush&&e.fillBrush.color.equals(s.Color.Transparent)),l=t.fillBrush&&!(t.fillBrush instanceof s.SolidBrush&&t.fillBrush.color.equals(s.Color.Transparent)),c=e.fillBrush instanceof s.ImageBrush&&!e.pictureBrush?e.fillBrush:o?void 0:e.pictureBrush,u=t.fillBrush instanceof s.ImageBrush&&!t.pictureBrush?t.fillBrush:l?void 0:t.pictureBrush;if(!c&&!u||T(e.fillBrush,t.fillBrush)||T(e.pictureBrush,t.pictureBrush))if(n.fillBrush=w(e.fillBrush,t.fillBrush,r),e.pictureBrush instanceof s.ImageBrush&&t.pictureBrush instanceof s.ImageBrush){var d=w(e.pictureBrush,t.pictureBrush,r);d instanceof s.ImageBrush||!d?n.pictureBrush=d:i.Log.Error(507910021,"Interpolated ImageBrush returned wrong type")}else n.pictureBrush=e.pictureBrush;else if(u){if(n.fillBrush=I(c||e.fillBrush,1-r),n.pictureBrush=I(u,r),c&&u&&e.pictureBrush&&t.pictureBrush&&n.fillBrush instanceof s.ImageBrush&&n.pictureBrush instanceof s.ImageBrush){var h=a.Vector2.InterpolateLinear(e.pictureBrush.scale,t.pictureBrush.scale,r),f=a.Vector2.InterpolateLinear(e.pictureBrush.offset,t.pictureBrush.offset,r);n.fillBrush.scale=h,n.pictureBrush.scale=h,n.fillBrush.offset=f,n.pictureBrush.offset=f}}else n.fillBrush=I(t.fillBrush,r),n.pictureBrush=I(c,1-r);return n.lineBrush=w(e.lineBrush,t.lineBrush,r),n.pen=C(e.pen,t.pen,r),n.blendingMode=e.blendingMode,n}function C(e,t,r){if(r>0&&r<1){var i=e.clone();return i.lineWidth=(0,a.mix)(e.lineWidth,t.lineWidth,r),i.lineHeight=(0,a.mix)(e.lineHeight,t.lineHeight,r),i.miterLimit=(0,a.mix)(e.miterLimit,t.miterLimit,r),i.dashOffset=(0,a.mix)(e.dashOffset,t.dashOffset,r),i}return r<1?e:t}function w(e,t,r){if(r>0&&r<1){if(!e&&!t)return;if(!e)return I(t,r);if(!t)return I(e,1-r);if(e instanceof s.SolidBrush&&t instanceof s.SolidBrush)return new s.SolidBrush(s.Color.InterpolateLinear(e.color,t.color,r));if(e instanceof s.SolidBrush&&t instanceof s.GradientBrush||e instanceof s.GradientBrush&&t instanceof s.SolidBrush){var i=e instanceof s.GradientBrush?e:t,n=e instanceof s.SolidBrush?e.color:t.color,o=i.clone();return o.gradientStops=i.gradientStops.map((function(t){return new s.GradientStop(t.position,s.Color.InterpolateLinear(t.color,n,e instanceof s.GradientBrush?r:1-r))})),o}if(e instanceof s.SolidBrush&&t instanceof s.PatternBrush||e instanceof s.PatternBrush&&t instanceof s.SolidBrush){var l=e instanceof s.PatternBrush?e:t,c=e instanceof s.SolidBrush?e.color:t.color,u=e instanceof s.PatternBrush?r:1-r;return new s.PatternBrush(l.pattern,s.Color.InterpolateLinear(l.foregroundColor,c,u),s.Color.InterpolateLinear(l.backgroundColor,c,u))}if(e instanceof s.GradientBrush&&t instanceof s.GradientBrush){for(var d=new Array(Math.max(e.gradientStops.length,t.gradientStops.length)),h=0;h<d.length;h++){var f=P(e.gradientStops,h/(d.length-1)),m=P(t.gradientStops,h/(d.length-1));d[h]=new s.GradientStop((0,a.mix)(f.position,m.position,r),s.Color.InterpolateLinear(f.color,m.color,r))}var p=new s.GradientBrush(e.getType(),d);return p.angle=(0,a.interpolateAngle)(e.angle,t.angle,r,void 0),p.fillFromRect=a.Rect.InterpolateLinear(e.fillFromRect,t.fillFromRect,r),p.fillToRect=a.Rect.InterpolateLinear(e.fillToRect,t.fillToRect,r),p.rotateWithShape=e.rotateWithShape,p.isStretched=e.isStretched,p.shadeFromTitle=e.shadeFromTitle,p.isGammaCorrected=e.isGammaCorrected,p.blendBellShape=e.blendBellShape,p}if(e instanceof s.ImageBrush&&t instanceof s.ImageBrush&&T(e,t)){var g=e.clone();return g.scale=a.Vector2.InterpolateLinear(e.scale,t.scale,r),g.offset=a.Vector2.InterpolateLinear(e.offset,t.offset,r),g.opacity=(0,a.mix)(e.opacity,t.opacity,r),g}}return r<1?e:t}function P(e,t){var r=t*(e.length-1),i=Math.floor(r),n=r-i,o=e[Math.min(i,e.length-1)],l=e[Math.min(i+1,e.length-1)];return new s.GradientStop((0,a.mix)(o.position,l.position,n),s.Color.InterpolateLinear(o.color,l.color,n))}function I(e,t){if(e instanceof s.SolidBrush)return new s.SolidBrush(e.color.modulateOpacity(t));if(e instanceof s.GradientBrush){var r=e.clone();return r.gradientStops=e.gradientStops.map((function(e){return new s.GradientStop(e.position,e.color.modulateOpacity(t))})),r}if(e instanceof s.ImageBrush){var n=e.clone();return n.opacity*=t,n}return e instanceof s.PatternBrush?new s.PatternBrush(e.pattern,e.foregroundColor.modulateOpacity(t),e.backgroundColor.modulateOpacity(t)):(i.Log.Error(507910020,"Unexpected brush type not interpolated"),e)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TextureSampler=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}),[{key:"wrapU",get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e}},{key:"wrapV",get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e}},{key:"wrapR",get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e}},{key:"anisotropicFilteringLevel",get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e}},{key:"comparisonFunction",get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e}},{key:"useMipMaps",get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e}},{key:"setParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=r,this._cachedAnisotropicFilteringLevel=i,this.samplingMode=n,this._comparisonFunction=a,this}},{key:"compareSampler",value:function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}]);t.TextureSampler=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLPipelineContext=void 0;var n=i(r(1));function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var s=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}),[{key:"isAsync",get:function(){return this.isParallelCompiled}},{key:"isReady",get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}},{key:"_handlesSpectorRebuildCallback",value:function(e){e&&this.program&&e(this.program)}},{key:"setEngine",value:function(e){this.engine=e}},{key:"_fillEffectInformation",value:function(e,t,r,i,n,o,s,l){var c,u=this.engine;if(u.supportsUniformBuffers)for(var d in t)e.bindUniformBlock(d,t[d]);for(this.engine.getUniforms(this,r).forEach((function(e,t){i[r[t]]=e})),this._uniforms=i,c=0;c<n.length;c++)null==e.getUniform(n[c])&&(n.splice(c,1),c--);n.forEach((function(e,t){o[e]=t}));var h,f=a(u.getAttributes(this,s));try{for(f.s();!(h=f.n()).done;){var m=h.value;l.push(m)}}catch(e){f.e(e)}finally{f.f()}}},{key:"dispose",value:function(){this._uniforms={},this._isDisposed=!0}},{key:"_cacheMatrix",value:function(e,t){var r=this._valueCache[e],i=t.updateFlag;return(void 0===r||r!==i)&&(this._valueCache[e]=i,!0)}},{key:"_cacheFloat2",value:function(e,t,r){var i=this._valueCache[e];if(!i||2!==i.length)return i=[t,r],this._valueCache[e]=i,!0;var n=!1;return i[0]!==t&&(i[0]=t,n=!0),i[1]!==r&&(i[1]=r,n=!0),n}},{key:"_cacheFloat3",value:function(e,t,r,i){var n=this._valueCache[e];if(!n||3!==n.length)return n=[t,r,i],this._valueCache[e]=n,!0;var a=!1;return n[0]!==t&&(n[0]=t,a=!0),n[1]!==r&&(n[1]=r,a=!0),n[2]!==i&&(n[2]=i,a=!0),a}},{key:"_cacheFloat4",value:function(e,t,r,i,n){var a=this._valueCache[e];if(!a||4!==a.length)return a=[t,r,i,n],this._valueCache[e]=a,!0;var o=!1;return a[0]!==t&&(a[0]=t,o=!0),a[1]!==r&&(a[1]=r,o=!0),a[2]!==i&&(a[2]=i,o=!0),a[3]!==n&&(a[3]=n,o=!0),o}},{key:"setInt",value:function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}},{key:"setInt2",value:function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setInt2(this._uniforms[e],t,r)||(this._valueCache[e]=null))}},{key:"setInt3",value:function(e,t,r,i){this._cacheFloat3(e,t,r,i)&&(this.engine.setInt3(this._uniforms[e],t,r,i)||(this._valueCache[e]=null))}},{key:"setInt4",value:function(e,t,r,i,n){this._cacheFloat4(e,t,r,i,n)&&(this.engine.setInt4(this._uniforms[e],t,r,i,n)||(this._valueCache[e]=null))}},{key:"setIntArray",value:function(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)}},{key:"setIntArray2",value:function(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)}},{key:"setIntArray3",value:function(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)}},{key:"setIntArray4",value:function(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)}},{key:"setUInt",value:function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setUInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}},{key:"setUInt2",value:function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setUInt2(this._uniforms[e],t,r)||(this._valueCache[e]=null))}},{key:"setUInt3",value:function(e,t,r,i){this._cacheFloat3(e,t,r,i)&&(this.engine.setUInt3(this._uniforms[e],t,r,i)||(this._valueCache[e]=null))}},{key:"setUInt4",value:function(e,t,r,i,n){this._cacheFloat4(e,t,r,i,n)&&(this.engine.setUInt4(this._uniforms[e],t,r,i,n)||(this._valueCache[e]=null))}},{key:"setUIntArray",value:function(e,t){this._valueCache[e]=null,this.engine.setUIntArray(this._uniforms[e],t)}},{key:"setUIntArray2",value:function(e,t){this._valueCache[e]=null,this.engine.setUIntArray2(this._uniforms[e],t)}},{key:"setUIntArray3",value:function(e,t){this._valueCache[e]=null,this.engine.setUIntArray3(this._uniforms[e],t)}},{key:"setUIntArray4",value:function(e,t){this._valueCache[e]=null,this.engine.setUIntArray4(this._uniforms[e],t)}},{key:"setArray",value:function(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)}},{key:"setArray2",value:function(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)}},{key:"setArray3",value:function(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)}},{key:"setArray4",value:function(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)}},{key:"setMatrices",value:function(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))}},{key:"setMatrix",value:function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.asArray())||(this._valueCache[e]=null))}},{key:"setMatrix3x3",value:function(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)}},{key:"setMatrix2x2",value:function(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)}},{key:"setFloat",value:function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)}},{key:"setVector2",value:function(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))}},{key:"setFloat2",value:function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setFloat2(this._uniforms[e],t,r)||(this._valueCache[e]=null))}},{key:"setVector3",value:function(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))}},{key:"setFloat3",value:function(e,t,r,i){this._cacheFloat3(e,t,r,i)&&(this.engine.setFloat3(this._uniforms[e],t,r,i)||(this._valueCache[e]=null))}},{key:"setVector4",value:function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}},{key:"setQuaternion",value:function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))}},{key:"setFloat4",value:function(e,t,r,i,n){this._cacheFloat4(e,t,r,i,n)&&(this.engine.setFloat4(this._uniforms[e],t,r,i,n)||(this._valueCache[e]=null))}},{key:"setColor3",value:function(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))}},{key:"setColor4",value:function(e,t,r){this._cacheFloat4(e,t.r,t.g,t.b,r)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,r)||(this._valueCache[e]=null))}},{key:"setDirectColor4",value:function(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))}},{key:"_getVertexShaderCode",value:function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}},{key:"_getFragmentShaderCode",value:function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}]);t.WebGLPipelineContext=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Initialize=function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)},t.Process=function(e,t,r,i){var n;null!==(n=t.processor)&&void 0!==n&&n.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),A(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var n=function(e,t,r){var i=function(e,t){var r;if(null!==(r=t.processor)&&void 0!==r&&r.noPrecision)return e;var i=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=i?"precision highp float;\n"+e:"precision mediump float;\n"+e:i||(e=e.replace("precision highp float","precision mediump float")),e}(e,t);if(!t.processor)return i;if(t.processor.shaderLanguage===f.ShaderLanguage.GLSL&&-1!==i.indexOf("#version 3")&&(i=i.replace("#version 300 es",""),!t.processor.parseGLES3))return i;var n=t.defines,a=L(t,r);return t.processor.preProcessor&&(i=t.processor.preProcessor(i,n,a,t.isFragment,t.processingContext)),i=x(i,a,t),t.processor.postProcessor&&(i=t.processor.postProcessor(i,n,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{})),null!=r&&r._features.needShaderCodeInlining&&(i=r.inlineShaderCode(i)),i}(e,t,i);r(n,e)}))},t.PreProcess=function(e,t,r,i){var n;null!==(n=t.processor)&&void 0!==n&&n.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),A(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var n=function(e,t,r){var i,n,a=e,o=t.defines,s=L(t,r);return null!==(i=t.processor)&&void 0!==i&&i.preProcessor&&(a=t.processor.preProcessor(a,o,s,t.isFragment,t.processingContext)),a=x(a,s,t),null!==(n=t.processor)&&void 0!==n&&n.postProcessor&&(a=t.processor.postProcessor(a,o,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{})),r._features.needShaderCodeInlining&&(a=r.inlineShaderCode(a)),a}(e,t,i);r(n,e)}))},t.Finalize=function(e,t,r){return r.processor&&r.processor.finalizeShaders?r.processor.finalizeShaders(e,t,r.processingContext):{vertexCode:e,fragmentCode:t}},t._ProcessIncludes=A,t._functionContainer=void 0;var i=r(109),n=r(228),a=r(229),o=r(230),s=r(231),l=r(232),c=r(233),u=r(72),d=r(234),h=r(107),f=r(48),m=r(60);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var v=/defined\s*?\((.+?)\)/g,y=/defined\s*?\[(.+?)\]/g,_=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,S=/__decl__/,T=/light\{X\}.(\w*)/g,b=/\{X\}/g,C=[],w=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function P(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new s.ShaderDefineIsDefinedOperator(t[1].trim(),"!"===e[0]);for(var r="",i=0,n=0,a=["==","!=",">=","<=","<",">"];n<a.length&&(r=a[n],!((i=e.indexOf(r))>-1));n++);if(-1===i)return new s.ShaderDefineIsDefinedOperator(e);var o=e.substring(0,i).trim(),l=e.substring(i+r.length).trim();return new d.ShaderDefineArithmeticOperator(o,r,l)}function I(e,t){var r=new o.ShaderCodeTestNode,i=e.substring(0,t),n=e.substring(t);return n=n.substring(0,(n.indexOf("//")+1||n.length+1)-1).trim(),r.testExpression="#ifdef"===i?new s.ShaderDefineIsDefinedOperator(n):"#ifndef"===i?new s.ShaderDefineIsDefinedOperator(n,!0):function(e){e=e.replace(v,"defined[$1]");var t,r=[],i=p(u.ShaderDefineExpression.infixToPostfix(e));try{for(i.s();!(t=i.n()).done;){var n=t.value;if("||"!==n&&"&&"!==n)r.push(n);else if(r.length>=2){var a=r[r.length-1],o=r[r.length-2];r.length-=2;var s="&&"==n?new c.ShaderDefineAndOperator:new l.ShaderDefineOrOperator;"string"==typeof a&&(a=a.replace(y,"defined($1)")),"string"==typeof o&&(o=o.replace(y,"defined($1)")),s.leftOperand="string"==typeof o?P(o):o,s.rightOperand="string"==typeof a?P(a):a,r.push(s)}}}catch(e){i.e(e)}finally{i.f()}var d=r[r.length-1];return"string"==typeof d&&(d=d.replace(y,"defined($1)")),"string"==typeof d?P(d):d}(n),r}function k(e,t,r){for(var n=e.currentLine;E(e,r);){var a=(n=e.currentLine).substring(0,5).toLowerCase();if("#else"===a){var o=new i.ShaderCodeNode;return t.children.push(o),void E(e,o)}if("#elif"===a){var s=I(n,5);t.children.push(s),r=s}}}function E(e,t){for(;e.canRead;){e.lineIndex++;var r=e.currentLine;if(r.indexOf("#")>=0){var n=w.exec(r);if(n&&n.length){switch(n[0]){case"#ifdef":var o=new a.ShaderCodeConditionNode;t.children.push(o);var s=I(r,6);o.children.push(s),k(e,o,s);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":var l=new a.ShaderCodeConditionNode;t.children.push(l);var c=I(r,7);l.children.push(c),k(e,l,c);break;case"#if":var u=new a.ShaderCodeConditionNode,d=I(r,3);t.children.push(u),u.children.push(d),k(e,u,d)}continue}}var h=new i.ShaderCodeNode;if(h.line=r,t.children.push(h),"#"===r[0]&&"d"===r[1]){var f=r.replace(";","").split(" ");h.additionalDefineKey=f[1],3===f.length&&(h.additionalDefineValue=f[2])}}return!1}function x(e,t,r){var a=new i.ShaderCodeNode,o=new n.ShaderCodeCursor;return o.lineIndex=-1,o.lines=e.split("\n"),E(o,a),a.process(t,r)}function L(e,t){var r,i,n={},a=p(e.defines);try{for(a.s();!(i=a.n()).done;){var o=i.value.replace("#define","").replace(";","").trim().split(" ");n[o[0]]=o.length>1?o[1]:""}}catch(e){a.e(e)}finally{a.f()}return(null===(r=e.processor)||void 0===r?void 0:r.shaderLanguage)===f.ShaderLanguage.GLSL&&(n.GL_ES="true"),n.__VERSION__=e.version,n[e.platformName]="true",(0,m._getGlobalDefines)(n,null==t?void 0:t.isNDCHalfZRange,null==t?void 0:t.useReverseDepthBuffer,null==t?void 0:t.useExactSrgbConversions),n}function A(e,t,r){var i;for(C.length=0;null!==(i=_.exec(e));)C.push(i);var n,a=String(e),o=[e],s=!1,l=p(C);try{var c,u=function(){var e=n.value,i=e[1];if(-1!==i.indexOf("__decl__")&&(i=i.replace(S,""),t.supportsUniformBuffers&&(i=i.replace("Vertex","Ubo").replace("Fragment","Ubo")),i+="Declaration"),!t.includesShadersStore[i]){var a=t.shadersRepository+"ShadersInclude/"+i+".fx";return M.loadFile(a,(function(e){t.includesShadersStore[i]=e,A(o.join(""),t,r)})),{v:void 0}}var l=t.includesShadersStore[i];if(e[2])for(var c=e[3].split(","),u=0;u<c.length;u+=2){var d=new RegExp(c[u],"g"),h=c[u+1];l=l.replace(d,h)}if(e[4]){var f=e[5];if(-1!==f.indexOf("..")){var m=f.split(".."),p=parseInt(m[0]),g=parseInt(m[1]),v=l.slice(0);l="",isNaN(g)&&(g=t.indexParameters[m[1]]);for(var y=p;y<g;y++)t.supportsUniformBuffers||(v=v.replace(T,(function(e,t){return t+"{X}"}))),l+=v.replace(b,y.toString())+"\n"}else t.supportsUniformBuffers||(l=l.replace(T,(function(e,t){return t+"{X}"}))),l=l.replace(b,f)}for(var _=[],C=0,w=o;C<w.length;C++){for(var P=w[C].split(e[0]),I=0;I<P.length-1;I++)_.push(P[I]),_.push(l);_.push(P[P.length-1])}o=_,s=s||l.indexOf("#include<")>=0||l.indexOf("#include <")>=0};for(l.s();!(n=l.n()).done;)if(c=u())return c.v}catch(e){l.e(e)}finally{l.f()}C.length=0,a=o.join(""),s?A(a.toString(),t,r):r(a)}var M={loadFile:function(e,t,r,i,n,a){throw(0,h._WarnImport)("FileTools")}};t._functionContainer=M},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderCodeCursor=void 0;var n=i(r(1));function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var s=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this._lines=[]}),[{key:"currentLine",get:function(){return this._lines[this.lineIndex]}},{key:"canRead",get:function(){return this.lineIndex<this._lines.length-1}},{key:"lines",set:function(e){this._lines.length=0;var t,r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i&&"\r"!==i)if("#"!==i[0]){var n=i.trim();if(n)if(n.startsWith("//"))this._lines.push(i);else{var o=n.indexOf(";");if(-1===o)this._lines.push(n);else if(o===n.length-1)n.length>1&&this._lines.push(n);else for(var s=i.split(";"),l=0;l<s.length;l++){var c=s[l];c&&(c=c.trim())&&this._lines.push(c+(l!==s.length-1?";":""))}}}else this._lines.push(i)}}catch(e){r.e(e)}finally{r.f()}}}]);t.ShaderCodeCursor=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderCodeConditionNode=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(){return(0,n.default)(this,t),c(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"process",value:function(e,t){for(var r=0;r<this.children.length;r++){var i=this.children[r];if(i.isValid(e))return i.process(e,t)}return""}}])}(r(109).ShaderCodeNode);t.ShaderCodeConditionNode=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderCodeTestNode=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(){return(0,n.default)(this,t),c(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isValid",value:function(e){return this.testExpression.isTrue(e)}}])}(r(109).ShaderCodeNode);t.ShaderCodeTestNode=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderDefineIsDefinedOperator=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,n.default)(this,t),(r=c(this,t)).define=e,r.not=i,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isTrue",value:function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t}}])}(r(72).ShaderDefineExpression);t.ShaderDefineIsDefinedOperator=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderDefineOrOperator=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(){return(0,n.default)(this,t),c(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isTrue",value:function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}])}(r(72).ShaderDefineExpression);t.ShaderDefineOrOperator=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderDefineAndOperator=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(){return(0,n.default)(this,t),c(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isTrue",value:function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}])}(r(72).ShaderDefineExpression);t.ShaderDefineAndOperator=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderDefineArithmeticOperator=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));var c=function(e){function t(e,r,i){var a;return(0,n.default)(this,t),(a=function(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}(this,t)).define=e,a.operand=r,a.testValue=i,a}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isTrue",value:function(e){var t=e[this.define];void 0===t&&(t=this.define);var r=!1,i=parseInt(t),n=parseInt(this.testValue);switch(this.operand){case">":r=i>n;break;case"<":r=i<n;break;case"<=":r=i<=n;break;case">=":r=i>=n;break;case"==":r=i===n;break;case"!=":r=i!==n}return r}}])}(r(72).ShaderDefineExpression);t.ShaderDefineArithmeticOperator=c},function(e,t,r){"use strict";var i=r(0),n=i(r(5)),a=i(r(15)),o=r(40),s=r(61),l=r(62),c=r(246);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}r(248),l.ThinEngine.prototype._createHardwareRenderTargetWrapper=function(e,t,r){var i=new c.WebGLRenderTargetWrapper(e,t,r,this,this._gl);return this._renderTargetWrapperCache.push(i),i},l.ThinEngine.prototype.createRenderTargetTexture=function(e,t){var r,i,n,s=this._createHardwareRenderTargetWrapper(!1,!1,e),l=!0,c=!1,u=!1,d=void 0,h=1,f=void 0;void 0!==t&&"object"===(0,a.default)(t)&&(l=null===(i=t.generateDepthBuffer)||void 0===i||i,c=!!t.generateStencilBuffer,u=!!t.noColorAttachment,d=t.colorAttachment,h=null!==(n=t.samples)&&void 0!==n?n:1,f=t.label);var m=d||(u?null:this._createInternalTexture(e,t,!0,o.InternalTextureSource.RenderTarget)),p=e.width||e,g=e.height||e,v=this._currentFramebuffer,y=this._gl,_=y.createFramebuffer();return this._bindUnboundFramebuffer(_),s._depthStencilBuffer=this._setupFramebufferDepthAttachments(c,l,p,g),!m||m.is2DArray||m.is3D||y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,m._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(v),s.label=null!==(r=f)&&void 0!==r?r:"RenderTargetWrapper",s._framebuffer=_,s._generateDepthBuffer=l,s._generateStencilBuffer=c,s.setTextures(m),this.updateRenderTargetTextureSampleCount(s,h),s},l.ThinEngine.prototype._createDepthStencilTexture=function(e,t){var r=this._gl,i=e.layers||0,a=e.depth||0,l=r.TEXTURE_2D;0!==i?l=r.TEXTURE_2D_ARRAY:0!==a&&(l=r.TEXTURE_3D);var c=new o.InternalTexture(this,o.InternalTextureSource.DepthStencil);if(c.label=t.label,!this._caps.depthTextureExtension)return s.Logger.Error("Depth texture is not supported by your browser or hardware."),c;var d=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1},t);if(this._bindTextureDirectly(l,c,!0),this._setupDepthStencilTexture(c,e,d.generateStencil,0!==d.comparisonFunction&&d.bilinearFiltering,d.comparisonFunction,d.samples),void 0!==d.depthTextureFormat){if(15!==d.depthTextureFormat&&16!==d.depthTextureFormat&&17!==d.depthTextureFormat&&13!==d.depthTextureFormat&&14!==d.depthTextureFormat&&18!==d.depthTextureFormat)return s.Logger.Error("Depth texture format is not supported."),c;c.format=d.depthTextureFormat}else c.format=d.generateStencil?13:16;var h=17===c.format||13===c.format||18===c.format,f=r.UNSIGNED_INT;15===c.format?f=r.UNSIGNED_SHORT:17===c.format||13===c.format?f=r.UNSIGNED_INT_24_8:14===c.format?f=r.FLOAT:18===c.format&&(f=r.FLOAT_32_UNSIGNED_INT_24_8_REV);var m=h?r.DEPTH_STENCIL:r.DEPTH_COMPONENT,p=m;return this.webGLVersion>1&&(15===c.format?p=r.DEPTH_COMPONENT16:16===c.format?p=r.DEPTH_COMPONENT24:17===c.format||13===c.format?p=r.DEPTH24_STENCIL8:14===c.format?p=r.DEPTH_COMPONENT32F:18===c.format&&(p=r.DEPTH32F_STENCIL8)),c.is2DArray?r.texImage3D(l,0,p,c.width,c.height,i,0,m,f,null):c.is3D?r.texImage3D(l,0,p,c.width,c.height,a,0,m,f,null):r.texImage2D(l,0,p,c.width,c.height,0,m,f,null),this._bindTextureDirectly(l,null),this._internalTexturesCache.push(c),c},l.ThinEngine.prototype.updateRenderTargetTextureSampleCount=function(e,t){if(this.webGLVersion<2||!e||!e.texture)return 1;if(e.samples===t)return t;var r=this._gl;t=Math.min(t,this.getCaps().maxMSAASamples),e._depthStencilBuffer&&(r.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=null),e._MSAAFramebuffer&&(r.deleteFramebuffer(e._MSAAFramebuffer),e._MSAAFramebuffer=null);var i=e.texture._hardwareTexture;if(i.releaseMSAARenderBuffers(),t>1&&"function"==typeof r.renderbufferStorageMultisample){var n=r.createFramebuffer();if(!n)throw new Error("Unable to create multi sampled framebuffer");e._MSAAFramebuffer=n,this._bindUnboundFramebuffer(e._MSAAFramebuffer);var a=this._createRenderBuffer(e.texture.width,e.texture.height,t,-1,this._getRGBABufferInternalSizedFormat(e.texture.type,e.texture.format,e.texture._useSRGBBuffer),r.COLOR_ATTACHMENT0,!1);if(!a)throw new Error("Unable to create multi sampled framebuffer");i.addMSAARenderBuffer(a)}else this._bindUnboundFramebuffer(e._framebuffer);return e.texture.samples=t,e._samples=t,e._depthStencilBuffer=this._setupFramebufferDepthAttachments(e._generateStencilBuffer,e._generateDepthBuffer,e.texture.width,e.texture.height,t),this._bindUnboundFramebuffer(null),t},l.ThinEngine.prototype._setupDepthStencilTexture=function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=t.width||t,s=t.height||t,l=t.layers||0,c=t.depth||0;e.baseWidth=o,e.baseHeight=s,e.width=o,e.height=s,e.is2DArray=l>0,e.depth=l||c,e.isReady=!0,e.samples=a,e.generateMipMaps=!1,e.samplingMode=i?2:1,e.type=0,e._comparisonFunction=n;var u=this._gl,d=this._getTextureTarget(e),h=this._getSamplingParameters(e.samplingMode,!1);u.texParameteri(d,u.TEXTURE_MAG_FILTER,h.mag),u.texParameteri(d,u.TEXTURE_MIN_FILTER,h.min),u.texParameteri(d,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(d,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),this.webGLVersion>1&&(0===n?(u.texParameteri(d,u.TEXTURE_COMPARE_FUNC,515),u.texParameteri(d,u.TEXTURE_COMPARE_MODE,u.NONE)):(u.texParameteri(d,u.TEXTURE_COMPARE_FUNC,n),u.texParameteri(d,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsWrapper=function(e){return void 0===e.getPipelineContext}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLDataBuffer=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10));var c=function(e){function t(e){var r;return(0,n.default)(this,t),(r=function(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}(this,t))._buffer=e,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"underlyingResource",get:function(){return this._buffer}}])}(r(136).DataBuffer);t.WebGLDataBuffer=c},function(e,t,r){"use strict";function i(e){var t=n(e),r=a(e);return t-e>e-r?r:t}function n(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function a(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}Object.defineProperty(t,"__esModule",{value:!0}),t.IsExponentOfTwo=function(e){var t=1;do{t*=2}while(t<e);return t===e},t.Mix=function(e,t,r){return e*(1-r)+t*r},t.NearestPOT=i,t.CeilingPOT=n,t.FloorPOT=a,t.GetExponentOfTwo=function(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;switch(o){case 1:r=a(e);break;case 2:r=i(e);break;case 3:default:r=n(e)}return Math.min(r,t)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.EngineStore=void 0;var n=i(r(1)),a=i(r(2)),o=r(86),s=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"LastCreatedEngine",get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}},{key:"LastCreatedScene",get:function(){return this._LastCreatedScene}}]);t.EngineStore=s,s.Instances=[],s.OnEnginesDisposedObservable=new o.Observable,s._LastCreatedScene=null,s.UseFallbackTexture=!0,s.FallbackTexture=""},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceConfigurator=void 0;var n=i(r(1)),a=i(r(2)),o=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"SetMatrixPrecision",value:function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var r=0;r<e.MatrixTrackedMatrices.length;++r){var i=e.MatrixTrackedMatrices[r],n=i._m;i._m=new Array(16);for(var a=0;a<16;++a)i._m[a]=n[a]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null}}])}();t.PerformanceConfigurator=o,o.MatrixUse64Bits=!1,o.MatrixTrackPrecisionChange=!0,o.MatrixCurrentType=Float32Array,o.MatrixTrackedMatrices=[]},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrecisionDate=void 0;var n=i(r(1)),a=i(r(2)),o=r(71),s=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"Now",get:function(){return(0,o.IsWindowObjectExist)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}]);t.PrecisionDate=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DepthCullingState=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,n.default)(this,e),this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,t&&this.reset()}),[{key:"isDirty",get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}},{key:"zOffset",get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}},{key:"zOffsetUnits",get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}},{key:"cullFace",get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}},{key:"cull",get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}},{key:"depthFunc",get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}},{key:"depthMask",get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}},{key:"depthTest",get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}},{key:"frontFace",get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}},{key:"reset",value:function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}},{key:"apply",value:function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}]);t.DepthCullingState=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.StencilStateComposer=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,n.default)(this,e),this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,t&&this.reset()}),[{key:"isDirty",get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}},{key:"func",get:function(){return this._func},set:function(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}},{key:"funcRef",get:function(){return this._funcRef},set:function(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}},{key:"funcMask",get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}},{key:"opStencilFail",get:function(){return this._opStencilFail},set:function(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}},{key:"opDepthFail",get:function(){return this._opDepthFail},set:function(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}},{key:"opStencilDepthPass",get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}},{key:"mask",get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}},{key:"reset",value:function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}},{key:"apply",value:function(e){var t;if(e){var r=!this.useStencilGlobalOnly&&!(null===(t=this.stencilMaterial)||void 0===t||!t.enabled);this.enabled=r?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=r?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=r?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=r?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=r?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=r?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=r?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=r?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}}]);t.StencilStateComposer=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.StencilState=void 0;var n=i(r(1)),a=i(r(2)),o=function(){function e(){(0,n.default)(this,e),this.reset()}return(0,a.default)(e,[{key:"reset",value:function(){this.enabled=!1,this.mask=255,this.func=e.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=e.KEEP,this.opDepthFail=e.KEEP,this.opStencilDepthPass=e.REPLACE}},{key:"stencilFunc",get:function(){return this.func},set:function(e){this.func=e}},{key:"stencilFuncRef",get:function(){return this.funcRef},set:function(e){this.funcRef=e}},{key:"stencilFuncMask",get:function(){return this.funcMask},set:function(e){this.funcMask=e}},{key:"stencilOpStencilFail",get:function(){return this.opStencilFail},set:function(e){this.opStencilFail=e}},{key:"stencilOpDepthFail",get:function(){return this.opDepthFail},set:function(e){this.opDepthFail=e}},{key:"stencilOpStencilDepthPass",get:function(){return this.opStencilDepthPass},set:function(e){this.opStencilDepthPass=e}},{key:"stencilMask",get:function(){return this.mask},set:function(e){this.mask=e}},{key:"stencilTest",get:function(){return this.enabled},set:function(e){this.enabled=e}}])}();t.StencilState=o,o.ALWAYS=519,o.KEEP=7680,o.REPLACE=7681},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaState=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(){(0,n.default)(this,e),this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}),[{key:"isDirty",get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}},{key:"alphaBlend",get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}},{key:"setAlphaBlendConstants",value:function(e,t,r,i){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===r&&this._blendConstants[3]===i||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=r,this._blendConstants[3]=i,this._isBlendConstantsDirty=!0)}},{key:"setAlphaBlendFunctionParameters",value:function(e,t,r,i){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===r&&this._blendFunctionParameters[3]===i||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=r,this._blendFunctionParameters[3]=i,this._isBlendFunctionParametersDirty=!0)}},{key:"setAlphaEquationParameters",value:function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}},{key:"reset",value:function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}},{key:"apply",value:function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}]);t.AlphaState=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLRenderTargetWrapper=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10));function u(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var d=function(e){function t(e,r,i,a,o){var s;return(0,n.default)(this,t),(s=u(this,t,[e,r,i,a]))._framebuffer=null,s._depthStencilBuffer=null,s._MSAAFramebuffer=null,s._colorTextureArray=null,s._depthStencilTextureArray=null,s._disposeOnlyFramebuffers=!1,s._currentLOD=0,s._context=o,s}return(0,c.default)(t,e),(0,a.default)(t,[{key:"_cloneRenderTargetWrapper",value:function(){var e=null;return this._colorTextureArray&&this._depthStencilTextureArray?(e=this._engine.createMultiviewRenderTargetTexture(this.width,this.height)).texture.isReady=!0:e=(0,s.default)((0,l.default)(t.prototype),"_cloneRenderTargetWrapper",this).call(this),e}},{key:"_swapRenderTargetWrapper",value:function(e){(0,s.default)((0,l.default)(t.prototype),"_swapRenderTargetWrapper",this).call(this,e),e._framebuffer=this._framebuffer,e._depthStencilBuffer=this._depthStencilBuffer,e._MSAAFramebuffer=this._MSAAFramebuffer,e._colorTextureArray=this._colorTextureArray,e._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}},{key:"createDepthStencilTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:14,o=arguments.length>5?arguments[5]:void 0;if(this._depthStencilBuffer){var c=this._engine,u=c._currentFramebuffer,d=this._context;c._bindUnboundFramebuffer(this._framebuffer),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,null),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,null),c._bindUnboundFramebuffer(u),d.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null}return(0,s.default)((0,l.default)(t.prototype),"createDepthStencilTexture",this).call(this,e,r,i,n,a,o)}},{key:"shareDepth",value:function(e){(0,s.default)((0,l.default)(t.prototype),"shareDepth",this).call(this,e);var r=this._context,i=this._depthStencilBuffer,n=e._MSAAFramebuffer||e._framebuffer,a=this._engine;e._depthStencilBuffer&&e._depthStencilBuffer!==i&&r.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=i;var o=e._generateStencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;a._bindUnboundFramebuffer(n),r.framebufferRenderbuffer(r.FRAMEBUFFER,o,r.RENDERBUFFER,i),a._bindUnboundFramebuffer(null)}},{key:"_bindTextureRenderTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e._hardwareTexture){var n=this._framebuffer,a=this._engine,o=a._currentFramebuffer;if(a._bindUnboundFramebuffer(n),a.webGLVersion>1){var s,l,c,u=this._context,d=u["COLOR_ATTACHMENT"+t];if(e.is2DArray||e.is3D)r=null!==(s=null!==(l=r)&&void 0!==l?l:null===(c=this.layerIndices)||void 0===c?void 0:c[t])&&void 0!==s?s:0,u.framebufferTextureLayer(u.FRAMEBUFFER,d,e._hardwareTexture.underlyingResource,i,r);else if(e.isCube){var h,f,m;r=null!==(h=null!==(f=r)&&void 0!==f?f:null===(m=this.faceIndices)||void 0===m?void 0:m[t])&&void 0!==h?h:0,u.framebufferTexture2D(u.FRAMEBUFFER,d,u.TEXTURE_CUBE_MAP_POSITIVE_X+r,e._hardwareTexture.underlyingResource,i)}else u.framebufferTexture2D(u.FRAMEBUFFER,d,u.TEXTURE_2D,e._hardwareTexture.underlyingResource,i)}else{var p=this._context,g=p["COLOR_ATTACHMENT"+t+"_WEBGL"],v=void 0!==r?p.TEXTURE_CUBE_MAP_POSITIVE_X+r:p.TEXTURE_2D;p.framebufferTexture2D(p.FRAMEBUFFER,g,v,e._hardwareTexture.underlyingResource,i)}a._bindUnboundFramebuffer(o)}}},{key:"setTexture",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,s.default)((0,l.default)(t.prototype),"setTexture",this).call(this,e,r,i),this._bindTextureRenderTarget(e,r)}},{key:"setLayerAndFaceIndices",value:function(e,r){var i,n;if((0,s.default)((0,l.default)(t.prototype),"setLayerAndFaceIndices",this).call(this,e,r),this.textures&&this.layerIndices&&this.faceIndices)for(var a=null!==(i=null===(n=this._attachments)||void 0===n?void 0:n.length)&&void 0!==i?i:this.textures.length,o=0;o<a;o++){var c=this.textures[o];c&&(c.is2DArray||c.is3D?this._bindTextureRenderTarget(c,o,this.layerIndices[o]):c.isCube?this._bindTextureRenderTarget(c,o,this.faceIndices[o]):this._bindTextureRenderTarget(c,o))}}},{key:"setLayerAndFaceIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if((0,s.default)((0,l.default)(t.prototype),"setLayerAndFaceIndex",this).call(this,e,r,i),this.textures&&this.layerIndices&&this.faceIndices){var n=this.textures[e];n.is2DArray||n.is3D?this._bindTextureRenderTarget(this.textures[e],e,this.layerIndices[e]):n.isCube&&this._bindTextureRenderTarget(this.textures[e],e,this.faceIndices[e])}}},{key:"dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._disposeOnlyFramebuffers,r=this._context;e||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(r.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(r.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(r.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),(0,s.default)((0,l.default)(t.prototype),"dispose",this).call(this,e)}}])}(r(247).RenderTargetWrapper);t.WebGLRenderTargetWrapper=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.RenderTargetWrapper=void 0;var n=i(r(1)),a=i(r(2)),o=r(40),s=(0,a.default)((function e(t,r,i,a,o){(0,n.default)(this,e),this._textures=null,this._faceIndices=null,this._layerIndices=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=t,this._isCube=r,this._size=i,this._engine=a,this._depthStencilTexture=null,this.label=o}),[{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"depthStencilTextureWithStencil",get:function(){return this._depthStencilTextureWithStencil}},{key:"isCube",get:function(){return this._isCube}},{key:"isMulti",get:function(){return this._isMulti}},{key:"is2DArray",get:function(){return this.layers>0}},{key:"is3D",get:function(){return this.depth>0}},{key:"size",get:function(){return this.width}},{key:"width",get:function(){return this._size.width||this._size}},{key:"height",get:function(){return this._size.height||this._size}},{key:"layers",get:function(){return this._size.layers||0}},{key:"depth",get:function(){return this._size.depth||0}},{key:"texture",get:function(){var e,t;return null!==(e=null===(t=this._textures)||void 0===t?void 0:t[0])&&void 0!==e?e:null}},{key:"textures",get:function(){return this._textures}},{key:"faceIndices",get:function(){return this._faceIndices}},{key:"layerIndices",get:function(){return this._layerIndices}},{key:"samples",get:function(){return this._samples}},{key:"setSamples",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.samples===e&&!r)return e;var i=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,e,t):this._engine.updateRenderTargetTextureSampleCount(this,e);return this._samples=e,i}},{key:"setTextures",value:function(e){Array.isArray(e)?this._textures=e:this._textures=e?[e]:null}},{key:"setTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._textures||(this._textures=[]),this._textures[t]!==e&&(this._textures[t]&&r&&this._textures[t].dispose(),this._textures[t]=e)}},{key:"setLayerAndFaceIndices",value:function(e,t){this._layerIndices=e,this._faceIndices=t}},{key:"setLayerAndFaceIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;this._layerIndices||(this._layerIndices=[]),this._faceIndices||(this._faceIndices=[]),void 0!==t&&t>=0&&(this._layerIndices[e]=t),void 0!==r&&r>=0&&(this._faceIndices[e]=r)}},{key:"createDepthStencilTexture",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:14,o=arguments.length>5?arguments[5]:void 0;return null===(e=this._depthStencilTexture)||void 0===e||e.dispose(),this._depthStencilTextureWithStencil=i,this._depthStencilTextureLabel=o,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:r,comparisonFunction:t,generateStencil:i,isCube:this._isCube,samples:n,depthTextureFormat:a,label:o},this),this._depthStencilTexture}},{key:"_shareDepth",value:function(e){this.shareDepth(e)}},{key:"shareDepth",value:function(e){this._depthStencilTexture&&(e._depthStencilTexture&&e._depthStencilTexture.dispose(),e._depthStencilTexture=this._depthStencilTexture,e._depthStencilTextureWithStencil=this._depthStencilTextureWithStencil,this._depthStencilTexture.incrementReferences())}},{key:"_swapAndDie",value:function(e){this.texture&&this.texture._swapAndDie(e),this._textures=null,this.dispose(!0)}},{key:"_cloneRenderTargetWrapper",value:function(){var e=null;if(this._isMulti){var t=this.textures;if(t&&t.length>0){var r=!1,i=t.length,n=-1,a=t[t.length-1]._source;a!==o.InternalTextureSource.Depth&&a!==o.InternalTextureSource.DepthStencil||(r=!0,n=t[t.length-1].format,i--);for(var s=[],l=[],c=[],u=[],d=[],h=[],f=[],m={},p=0;p<i;++p){var g,v,y=t[p];s.push(y.samplingMode),l.push(y.type),c.push(y.format),void 0!==m[y.uniqueId]?(u.push(-1),f.push(0)):(m[y.uniqueId]=p,y.is2DArray?(u.push(35866),f.push(y.depth)):y.isCube?(u.push(34067),f.push(0)):y.is3D?(u.push(32879),f.push(y.depth)):(u.push(3553),f.push(0))),this._faceIndices&&d.push(null!==(g=this._faceIndices[p])&&void 0!==g?g:0),this._layerIndices&&h.push(null!==(v=this._layerIndices[p])&&void 0!==v?v:0)}var _={samplingModes:s,generateMipMaps:t[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:r,depthTextureFormat:n,types:l,formats:c,textureCount:i,targetTypes:u,faceIndex:d,layerIndex:h,layerCounts:f,label:this.label},S={width:this.width,height:this.height,depth:this.depth};e=this._engine.createMultipleRenderTarget(S,_);for(var T=0;T<i;++T)if(-1===u[T]){var b=m[t[T].uniqueId];e.setTexture(e.textures[b],T)}}}else{var C,w,P,I,k,E={};if(E.generateDepthBuffer=this._generateDepthBuffer,E.generateMipMaps=null!==(C=null===(w=this.texture)||void 0===w?void 0:w.generateMipMaps)&&void 0!==C&&C,E.generateStencilBuffer=this._generateStencilBuffer,E.samplingMode=null===(P=this.texture)||void 0===P?void 0:P.samplingMode,E.type=null===(I=this.texture)||void 0===I?void 0:I.type,E.format=null===(k=this.texture)||void 0===k?void 0:k.format,E.noColorAttachment=!this._textures,E.label=this.label,this.isCube)e=this._engine.createRenderTargetCubeTexture(this.width,E);else{var x,L={width:this.width,height:this.height,layers:this.is2DArray||this.is3D?null===(x=this.texture)||void 0===x?void 0:x.depth:void 0};e=this._engine.createRenderTargetTexture(L,E)}e.texture&&(e.texture.isReady=!0)}return e}},{key:"_swapRenderTargetWrapper",value:function(e){if(this._textures&&e._textures)for(var t=0;t<this._textures.length;++t)this._textures[t]._swapAndDie(e._textures[t],!1),e._textures[t].isReady=!0;this._depthStencilTexture&&e._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(e._depthStencilTexture),e._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null}},{key:"_rebuild",value:function(){var e=this._cloneRenderTargetWrapper();if(e){if(this._depthStencilTexture){var t=this._depthStencilTexture.samplingMode,r=this._depthStencilTexture.format,i=2===t||3===t||11===t;e.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,i,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples,r,this._depthStencilTextureLabel)}this.samples>1&&e.setSamples(this.samples),e._swapRenderTargetWrapper(this),e.dispose()}}},{key:"releaseTextures",value:function(){if(this._textures)for(var e=0;null!==(t=e<(null===(r=this._textures)||void 0===r?void 0:r.length))&&void 0!==t&&t;++e){var t,r;this._textures[e].dispose()}this._textures=null}},{key:"dispose",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||(null===(e=this._depthStencilTexture)||void 0===e||e.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)}}]);t.RenderTargetWrapper=s},function(e,t,r){"use strict";r(137).AbstractEngine.prototype.createDepthStencilTexture=function(e,t,r){if(t.isCube){var i=e.width||e;return this._createDepthStencilCubeTexture(i,t)}return this._createDepthStencilTexture(e,t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_0=void 0,t.p_0={v:"precision highp float;const int pc=0,qc=1,rc=2,sc=3,tc=-1;const int k=0,l=1,m=2,n=3;const int uc=0,vc=1,wc=2;uniform vec2 u_0;uniform vec2 u_1;uniform vec2 u_2;uniform float u_3;uniform int u_4;uniform float u_5;uniform int u_6;uniform int u_7;uniform mat3 u_8;uniform float u_12;uniform int u_13;uniform float u_14;uniform int u_15;uniform vec2 u_17;uniform int u_18;uniform int u_19;attribute vec2 a_v;attribute vec4 a_p0;attribute vec4 a_p1;attribute vec4 a_p2;attribute vec4 a_p3;attribute vec4 a_p4;attribute float a_d1;attribute float a_d2;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;const float xc=0.001;const float yc=0.001;varying float frag_type;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;const int zc=2,Ac=5;const int Bc=0,Cc=1,Dc=2,Ec=3;vec2 Fc(vec4 Gc){mat3 Hc=u_8;vec2 Ic=u_0;vec2 Jc=u_1;vec2 Kc=u_17;return((Hc*vec3(Gc.xy,1.0)).xy*Jc-Ic)/Kc;}vec2 Lc(vec2 wb){return vec2(-wb.y,wb.x);}void main(){vec2 Mc=a_v;int Y=u_7;vec2 Nc=u_2;float Oc=u_3;int Z=u_4;float Pc=u_5;float Qc=u_12;int fb=u_13;float Rc=u_14;int Sc=u_15;vec2 Kc=u_17;bool Tc=u_18 !=0;bool Uc=u_19 !=0;frag_type=0.0;frag_geoRange=frag_specialParam5=vec2(0.0,0.0);frag_geoUVS=frag_specialParam4=vec3(0.0,0.0,0.0);frag_specialParam1=frag_specialParam2=frag_specialParam3=vec4(0.0,0.0,0.0,0.0);if(Y==rc || Y==sc){gl_Position=vec4(Mc,0.0,1.0);frag_type=p;}else{vec2 Vc=Fc(a_p0),Wc=Fc(a_p1),Xc=Fc(a_p2),Yc=Fc(a_p3),Zc=Fc(a_p4);int ad=int(a_p0.z),bd=int(a_p1.z),cd=int(a_p2.z),dd=int(a_p3.z),ed=int(a_p4.z);float fd=Uc ? 0.0 : a_d1,gd=Uc ? 0.0 : a_d2;float hd=a_p1.w,id=a_p2.w,jd=a_p3.w;bool kd=bd==wc;bool ld=cd==wc;vec2 md,nd,od;int pd,qd;if(ld){md=Wc;nd=Xc;od=Yc;pd=bd;qd=dd;}else if(kd){md=Vc;nd=Wc;od=Xc;pd=ad;qd=cd;}else{md=Wc;nd=(Wc+Xc)*0.5;od=Xc;pd=bd;qd=cd;}vec2 rd=od-md,sd=nd-md,td=od-nd;float ud=length(rd),vd=length(sd),wd=length(td);vec2 xd=rd/ud,yd=sd/vd,zd=td/wd;vec2 Ad=Lc(xd),Bd=Lc(yd),Cd=Lc(zd);float Dd=dot(Bd,zd);mat2 Ed;vec2 Fd,Gd;float Hd;bool Id=false;vec2 Jd;if(ld || kd){vec2 Kd=td-sd;float Ld=(dot(-sd,td)+dot(-sd,-sd))/dot(Kd,Kd);vec2 Md=mix(md,nd,Ld),Nd=mix(nd,od,Ld),Od=normalize(Nd-Md);float Pd=sign(Dd);mat2 Qd=mat2(Od,vec2(-Od.y,Od.x)*Pd);vec2 Rd=mix(Md,Nd,Ld);vec2 Sd=(md-Rd)*Qd,Td=(od-Rd)*Qd;float Ud=abs(Sd.x)> abs(Td.x)?(Sd.x*Sd.x)/Sd.y :(Td.x*Td.x)/Td.y;Ed=Qd/Ud;Fd=Rd;Gd=vec2(Sd.x,Td.x)/Ud;Hd=Ud*Pd;Id=Tc || abs(Dd)< xc || min(abs(ud),min(abs(vd/ud),abs(wd/ud)))< Oc*yc;if(Id){nd=(md+od)*0.5;sd=nd-md;td=od-nd;vd=wd=ud*0.5;yd=zd=xd;Bd=Cd=Ad;Dd=1.0;}}bool Vd=ld || kd;vec2 Wd=Vc;int Xd=ad;vec2 Yd=Vd ? Zc : Yc;int Zd=Vd ? ed : dd;bool ae=(Xd==0),be=(Zd==0),ce=(qd==0);if(Xd==0)Wd=md-(nd-md);if(Zd==0)Yd=od-(od-nd);vec2 de=md-Wd,ee=-de,fe=Yd-od,ge=-fe;float he=length(de),ie=length(fe);vec2 je=de/he,ke=fe/ie;vec2 le=Lc(je),me=Lc(ke);if(! Vd || Id){if(vd < yc){yd=je;Bd=le;}if(wd < yc){zd=ke;Cd=me;}if(ud < yc){xd=normalize(Yd-Wd);Ad=Lc(xd);}if(ud < yc){xd=vec2(1.0,0.0);Ad=vec2(0.0,-1.0);ud=yc;}if(vd < yc){yd=xd;Bd=Ad;}if(wd < yc){zd=xd;Cd=Ad;}if(he < yc){je=yd;le=Bd;}if(ie < yc){ke=zd;me=Cd;}Ed=mat2(xd/ud,Ad/ud);Fd=md;Gd=vec2(0.0,1.0);Hd=ud;}vec2 ne=vec2(0.0,0.0);if(Y==pc &&(! Vd || ld)){if(Tc){bool ce=(qd==0);if(ce || abs(ud)< Oc*yc)frag_type=o;else{float oe=clamp(hd,0.0,1.0);float pe=clamp((Vd ? jd : id),0.0,1.0);float qe=Vd ? fd+(gd-fd)*2.0 : gd;float re=Qc*0.5;vec4 se=vec4(min(md.x,od.x)-Oc*Kc.x,min(md.y,od.y)-Oc*Kc.y,max(md.x,od.x)+Oc*Kc.x,max(md.y,od.y)+Oc*Kc.y);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 te=vec2(xd.x==0.0 ? 1.0 : sign(xd.x),xd.y==0.0 ? 1.0 : sign(xd.y));float ue=re*(1.0-oe),ve=re*(1.0-pe);float we=re*oe,xe=re*pe;vec2 ye=md-te*we,ze=od+te*xe;vec2 Ae=ye+vec2(te.x*2.0*we,0.0),Be=ze-vec2(te.x*2.0*xe,0.0);vec2 Ce=ye+vec2(0.0,te.y*2.0*we),De=ze-vec2(0.0,te.y*2.0*xe);bool Ee=dot(Ad,Ae-md)>=0.0,Fe=dot(Ad,Be-md)>=0.0;vec2 Ge=Ee ? Ae : Ce,He=Fe ? Be : De;vec2 Ie=Ee ? Ce : Ae,Je=Fe ? De : Be;float Ke=max(abs(xd.x),abs(xd.y));float Le=dot(ne-Ge,Lc(normalize(He-Ge)))*Ke+re;float Me=dot(ne-Ie,-Lc(normalize(Je-Ie)))*Ke+re;float Ne=dot(ne-md,Ad);float Oe=dot(ne-md,(oe > xc)? Lc(Ie-Ge): xd);float Pe=dot(ne-od,(pe > xc)? Lc(He-Je):-xd);frag_specialParam1=vec4(ne-md,ne-od)*0.5/Oc;frag_specialParam2=vec4(Le,Me,ue,ve)*0.5/Oc;frag_specialParam3=vec4(gd-fd,fd,0.0,0.0);frag_specialParam4=vec3(Ne,Oe,Pe);frag_type=v;}}else{float Qe=dot(le,yd),Re=dot(Cd,ke),Se=dot(le,xd),Te=dot(Ad,ke);bool Ue=abs(Qe)< xc,Ve=abs(Re)< xc;bool We=Ue && dot(je,yd)< 0.0,Xe=Ve && dot(zd,ke)< 0.0;float Ye=(! Ue)? sign(Qe):(Se !=0.0)? sign(Se): sign(Te);float Ze=(! Ve)? sign(Re):(Te !=0.0)? sign(Te): sign(Se);vec2 af=normalize(le+Bd)*-Ye;float bf=abs(dot(af,Bd));float cf=(Z==k)? bf :(Z==l)? 1.0/max(bf,xc): 1.0;vec2 df=We ? yd*Ye : af*cf;vec2 ef=normalize(Cd+me)*-Ze;float ff=abs(dot(ef,Cd));float gf=(Z==k)? ff :(Z==l)? 1.0/max(ff,xc): 1.0;vec2 hf=Xe ?-zd*Ze : ef*gf;vec4 se=vec4(min(min(min(min(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)-Oc,min(min(min(min(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)-Oc,max(max(max(max(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)+Oc,max(max(max(max(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)+Oc);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 jf=normalize(Bd+df*Ye);vec2 kf=-normalize(le+df*Ye);bool lf=ce || We || Ue || cf > vd*10.0 || cf > he*10.0;vec2 mf=ne-md;vec2 nf=normalize(df);float Cb=-dot(mf,(vd < xc || We)? xd : yd);float Db=lf ? Cb :-dot(mf,Lc(nf))*Ye;float Eb=lf ?-dot(mf,Bd)*Ye : dot(mf,Lc(jf))/(2.0*Oc*length(df+jf*dot(-df,jf)));float Fb=lf ? 0.5 :(dot(mf,nf)/Oc-Pc)/abs(dot(nf,Bd));float Gb=lf ? 1.0 : dot(mf,Lc(kf))/(2.0*Oc*length(df+kf*dot(-df,kf)));vec2 of=-normalize(Cd+hf*Ze);vec2 pf=normalize(me+hf*Ze);bool qf=ce || Xe || Ve || gf > wd*10.0 || gf > ie*10.0;vec2 rf=ne-od;vec2 sf=normalize(hf);float Hb=dot(rf,(wd < xc || Xe)? xd : zd);float Ib=qf ? Hb : dot(rf,Lc(sf))*Ze;float Jb=qf ?-dot(rf,Cd)*Ze : dot(rf,Lc(of))/(2.0*Oc*length(hf+of*dot(-hf,of)));float Kb=qf ? 0.5 :(dot(rf,sf)/Oc-Pc)/abs(dot(sf,Cd));float Lb=qf ? 1.0 : dot(rf,Lc(pf))/(2.0*Oc*length(hf+pf*dot(-hf,pf)));float tf=(1.0-Rc)*Qc/(4.0*Oc);if(ae)Gb=-dot(mf,yd)/(2.0*Oc)+tf;if(be)Lb=dot(rf,zd)/(2.0*Oc)+tf;float uf,vf;if(Vd && ! Id){float wf=fd,qe=fd+(gd-fd)*2.0;float xf=sqrt(1.0+4.0*Gd [ 0 ]*Gd [ 0 ]),yf=sqrt(1.0+4.0*Gd [ 1 ]*Gd [ 1 ]);float zf=sign(Gd [ 0 ])*0.5*(abs(Gd [ 0 ])*xf+0.5*log(2.0*abs(Gd [ 0 ])+xf));float Af=sign(Gd [ 1 ])*0.5*(abs(Gd [ 1 ])*yf+0.5*log(2.0*abs(Gd [ 1 ])+yf));uf=(qe-wf)/abs(Af-zf);vf=wf-zf*uf;}else{float wf=fd;float qe=gd;uf=qe-wf;vf=wf;}float oe=hd;float pe=Vd ? jd : id;vec2 Bf=(vec2(1.0,1.0)-clamp(vec2(oe,pe),0.0,1.0))*Qc/(4.0*Oc);frag_specialParam1=vec4(vec2(Cb,Db)/Qc,Eb,Fb);frag_specialParam2=vec4(vec2(Hb,Ib)/Qc,Jb,Kb);frag_specialParam3=vec4(uf,vf,Bf.x,Bf.y);if(Sc==0 || Rc > 0.0)frag_specialParam4=vec3(ae ? 0.0 : 1.0,be ? 0.0 : 1.0,ce ? 0.0 : 1.0);else frag_specialParam4=vec3(1.0,1.0,ce ? 0.0 : 1.0);frag_specialParam5=vec2(Gb,Lb);frag_type=(Vd && ! Id)? s : q;}}else if(Y==qc &&(! Id || ld)){float Cf=(Mc.y)/(Kc.x*Nc.x);if(! Vd || Id){vec2 Df=(Mc.x < 0.0)? md : od;ne=Df+vec2(Cf,0.0);frag_type=t;}else{float Ef=clamp((md.y-nd.y)/(md.y+od.y-2.0*nd.y),0.0,1.0);vec2 Ff=mix(mix(md,nd,Ef),mix(nd,od,Ef),Ef);vec2 Gf=ld ? md : Ff;vec2 Hf=ld ? Ff : od;vec2 Df=(Mc.x < 0.0)? Gf : Hf;vec2 If=(Ff-Fd)*Ed;vec2 Jf=(Df+vec2(Cf,0.0)-Fd)*Ed;vec2 Kf=((ld ? md : od)-Fd)*Ed;float Lf=Jf.x-If.x;float Mf=sign(Kf.x-If.x);float fc=Lf*Mf;float gc=sign(dot(Bd,zd));ne=Df+vec2(Cf,0.0);frag_specialParam1.x=dot(ne-md,Bd*sign(dot(Bd,xd)));frag_specialParam1.y=dot(ne-nd,Cd*sign(dot(Cd,-yd)));frag_specialParam1.z=dot(ne-od,Ad*sign(dot(Ad,-zd)));frag_specialParam1.w=dot(ne-Gf,vec2(Gf.y-Hf.y,Hf.x-Gf.x));frag_specialParam2.x=fc;frag_specialParam2.y=gc;frag_type=u;}}else{gl_Position=vec4(0.0,0.0,0.0,0.0);frag_type=o;}gl_Position=vec4(ne.x*Nc.x*2.0*Kc.x,-ne.y*Nc.y*2.0*Kc.y,0.0,1.0);frag_geoRange=Gd;frag_geoUVS.xy=(ne-Fd)*Ed;frag_geoUVS.z=Hd*0.5/Oc;if(fb==2)frag_specialParam3=vec4(Mc.x*0.5+0.5,Mc.y*0.5+0.5,rd.x+rd.y,0.0);}}",f:"precision highp float;const int c=0,d=1,e=2,f=3,h=4,i=5,j=6;const int k=0,l=1,m=2,n=3;uniform int ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform float ufrag_4;uniform float ufrag_5;uniform float ufrag_6;uniform int ufrag_7;uniform float ufrag_8;uniform float ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec4 ufrag_13;uniform float ufrag_15;uniform vec2 ufrag_16;uniform int ufrag_17;uniform float ufrag_18;uniform float ufrag_19;varying float frag_type;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;float A(vec2 B,vec2 C){float a=0.5-B.y;float b=-0.5*B.x;float D=b*0.5;float E=(b*b)*0.25;float F=(a*a*a)/27.0;if(E+F > 0.0){float G=sqrt(E+F);float H=G-D;float I=sign(H)*pow(abs(H),1.0/3.0);float J=G+D;float K=-sign(J)*pow(abs(J),1.0/3.0);float x=I+K;return clamp(x,C [ 0 ],C [ 1 ]);}else{const float L=0.333333333;const vec3 M=vec3(0.0,2.094395102,4.188790205);float N=1.0/a;vec3 O=2.0*sqrt(-a*L)*cos(L*acos(sqrt(-6.75*N)*b*N)-M);vec3 x=clamp(O,C [ 0 ],C [ 1 ]);vec3 P=B.x-x,Q=B.y-x*x,R=P*P+Q*Q;return(R [ 0 ] < R [ 1 ] && R [ 0 ] < R [ 2 ])? x [ 0 ] :(R [ 1 ] < R [ 2 ])? x [ 1 ] : x [ 2 ];}}bool S(float T){return T-0.4 < frag_type && frag_type < T+0.4;}float U(float V,float a,float b,float W,float X){return clamp((abs(V*2.0-a-b)+a-b)*W*0.5+X,0.0,1.0);}void main(){int Y=ufrag_0;int Z=ufrag_1;float ab=ufrag_2;float bb=ufrag_3;float cb=ufrag_4;float db=ufrag_5;float eb=ufrag_6;int fb=ufrag_7;float gb=ufrag_8;float hb=ufrag_10;float ib=ufrag_11;float jb=ufrag_12;vec4 kb=ufrag_13;float lb=ufrag_15;vec2 mb=ufrag_16;bool nb=(ufrag_17==1);float ob=ufrag_18;float pb=ufrag_19;const float qb=1.0;float F=qb;float rb;float sb=0.0;float tb=0.0;if(Y==0 && ! S(v)){float V=0.0;float ub=0.0;vec2 vb;if(S(s)){float x=A(frag_geoUVS.xy,frag_geoRange);vb=frag_geoUVS.xy-vec2(x,x*x);vec2 wb=normalize(vec2(1.0,2.0*x));sb=dot(vb,vec2(-wb.y,wb.x))*frag_geoUVS.z;float xb=2.0*abs(x),yb=sqrt(1.0+xb*xb);float zb=sign(x)*(xb*yb+log(xb+yb))*0.25;float Ab=1.0-abs(sign((x-frag_geoRange [ 0 ])*(x-frag_geoRange [ 1 ])));V=zb+Ab*dot(vb,wb);ub=(x-frag_geoRange [ 0 ])/(frag_geoRange [ 1 ]-frag_geoRange [ 0 ]);}else{vb=frag_geoUVS.xy-vec2(clamp(frag_geoUVS.x,0.0,1.0),0.0);V=ub=frag_geoUVS.x;sb=frag_geoUVS.y;}F=length(vb)*abs(frag_geoUVS.z);ub=clamp(ub,0.0,1.0);const float Bb=0.01;float Cb=frag_specialParam1 [ 0 ],Db=frag_specialParam1 [ 1 ],Eb=frag_specialParam1 [ 2 ],Fb=frag_specialParam1 [ 3 ],Gb=frag_specialParam5 [ 0 ];float Hb=frag_specialParam2 [ 0 ],Ib=frag_specialParam2 [ 1 ],Jb=frag_specialParam2 [ 2 ],Kb=frag_specialParam2 [ 3 ],Lb=frag_specialParam5 [ 1 ];float Mb=frag_specialParam4.x,Nb=frag_specialParam4.y,Ob=frag_specialParam4.z;bool Pb=ub < 0.5 ?(Mb !=0.0 &&(Db > Bb || Fb > 1.0)):(Nb !=0.0 &&(Ib > Bb || Kb > 1.0));if(Z !=m){if(Pb)F=qb;else{const float Qb=0.001;if(ub < 0.5 && Cb > Bb && Mb !=0.0)F=(Db <=Qb)? Eb :(Fb >=0.0)? Gb : qb;if(ub > 0.5 && Hb > Bb && Nb !=0.0)F=(Ib <=Qb)? Jb :(Kb >=0.0)? Lb : qb;}}float Rb=F;if(Mb==0.0)Rb=max(Rb,Gb);if(Nb==0.0)Rb=max(Rb,Lb);tb=V*frag_specialParam3.x+frag_specialParam3.y;bool Sb=(mb==vec2(0.0,0.0))||(mb [ 0 ] <=tb && tb <=mb [ 1 ]);bb=Sb ? bb*Ob : 0.0;float Tb=(F <=lb && Sb)? bb : 0.0;float Ub=Pb ? 0.0 : Tb;const float Vb=0.2;const float Wb=(1.0-2.0*Vb)*2.0;float Xb=abs(fract(db+tb*cb)*2.0-1.0)*jb;float Yb=U(Xb,kb [ 0 ],kb [ 1 ],Wb,Vb)*U(Xb,kb [ 2 ],kb [ 3 ],Wb,Vb)*Tb;float Zb=clamp(0.5-F*sign(sb)*ib,0.0,1.0)*Ub;rb=sign(Rb)*max(0.0,abs(Rb)+mix(frag_specialParam3.z,frag_specialParam3.w,ub));float ac=(0.5-rb+pb)*bb;float bc=(0.5-F)*ab;vec4 cc=vec4(bc,ac,Zb,Yb);vec4 dc=vec4(ac,bc,0.0,0.0);vec4 ec=mix(cc,dc,ob);gl_FragColor=clamp(ec,0.0,1.0);}else if(S(t)){gl_FragColor=vec4(0.0,0.0,0.0,1.0);if(eb==sign(frag_geoUVS.y))discard;}else if(S(u)){gl_FragColor=vec4(0.0,0.0,0.0,0.0);if(frag_specialParam1.x > 0.0 && frag_specialParam1.y > 0.0 && frag_specialParam1.z > 0.0){float fc=frag_specialParam2.x,gc=frag_specialParam2.y;float hc=((fc >=0.0)? sign((frag_geoUVS.y-frag_geoUVS.x*frag_geoUVS.x)): 1.0)*gc;if(eb==hc)discard;}else if(eb==sign(frag_specialParam1.w))discard;}else if(S(v)){tb=frag_geoUVS.x*frag_specialParam3.x+frag_specialParam3.y;float ic=max(abs(frag_specialParam1.x),abs(frag_specialParam1.y))+frag_specialParam2.z;float jc=max(abs(frag_specialParam1.z),abs(frag_specialParam1.w))+frag_specialParam2.w;rb=min(ic,jc);if(frag_specialParam4.y >=0.0 && frag_specialParam4.z >=0.0)rb=min(rb,frag_specialParam4.x >=0.0 ? frag_specialParam2.x : frag_specialParam2.y);float kc=0.5-clamp(rb,0.0,0.5);gl_FragColor=vec4(kc*ab,kc*bb,0.0,1.0);}else gl_FragColor=vec4(frag_type*(1.0-gb),0.0,0.0,frag_type*gb);if(Y==0 && nb){float lc=smoothstep(lb,lb*1.5,rb);float mc=(tb+32.0*rb/lb)*jb;float nc=1.0-(mc+lc);gl_FragColor=vec4(nc,nc,nc,1.0);}if(fb==e){gl_FragColor.rgb=clamp(vec3(1.0-F*2.0,1.0-F*4.0,1.0-F*8.0),0.0,1.0);float oc=0.25+clamp((abs(frag_specialParam3.x+frag_specialParam3.y-1.0)+abs(frag_specialParam3.x-frag_specialParam3.y))*4.0-2.75,0.0,1.0);gl_FragColor+=vec4(oc*(1.0+sin(frag_specialParam3.z))/2.0,oc*(1.0+cos(frag_specialParam3.z))/2.0,oc*frag_specialParam3.z/18.0,1.0);}}",a:["a_v","a_p0","a_p1","a_p2","a_p3","a_p4","a_d1","a_d2"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_12","u_13","u_14","u_15","u_17","u_18","u_19"],s:[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_1=void 0,t.p_1={v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform vec2 u_2;uniform mat3 u_3;uniform mat3 u_4;uniform mat3 u_5;uniform mat3 u_6;uniform mat3 u_7;uniform mat3 u_8;uniform mat3 u_10;uniform mat3 u_11;uniform int u_13;uniform int u_14;uniform vec2 u_15;uniform int u_16;uniform float u_17;uniform float u_18;uniform float u_19;uniform vec2 u_20;uniform vec2 u_21;attribute vec2 a_v;attribute vec2 a_0;attribute vec2 a_1;varying vec2 q,s,t,u,v,A,B,C;varying float D;mat2 pd(float qd){return mat2(cos(qd),-sin(qd),sin(qd),cos(qd));}vec2 rd(vec2 sd){return vec2(sd.x/2.0,sd.y/-2.0)+vec2(0.5,0.5);}vec2 td(vec2 sd,mat3 ud){return(ud*vec3(vec2(sd.x/2.0,sd.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}mat4 vd(float wd,float xd,float yd,float zd){float a=1.0/tan(wd*0.5),b=1.0/(yd-zd);return mat4(a/xd,0.0,0.0,0.0,0.0,-a,0.0,0.0,0.0,0.0,(yd+zd)*b,-1.0,0.0,0.0,2.0*yd*zd*b,0.0);}mat4 Ad(float qd){float Bd=cos(qd),Cd=sin(qd);return mat4(1.0,0.0,0.0,0.0,0.0,Bd,-Cd,0.0,0.0,Cd,Bd,0.0,0.0,0.0,0.0,1.0);}mat4 Dd(float qd){float Bd=cos(qd),Cd=sin(qd);return mat4(Bd,0.0,Cd,0.0,0.0,1.0,0.0,0.0,-Cd,0.0,Bd,0.0,0.0,0.0,0.0,1.0);}void main(){vec2 Ed=a_v;mat3 Fd=u_0;vec2 Gd=u_15;mat3 Hd=u_1;vec2 Id=u_2;mat3 Jd=u_3;mat3 Kd=u_4;mat3 Ld=u_5;mat3 Md=u_6;mat3 Nd=u_7;mat3 Od=u_8;mat3 Pd=u_10;mat3 Qd=u_11;vec2 Rd=u_20;vec2 Sd=u_21;int Td=u_13;int Ud=u_14;float Vd=u_18;float Wd=u_19;vec2 Xd=Ed;vec2 Yd=Ed;if(u_16 !=0){Xd=Ed+a_0*2.0;Yd=Ed+a_1*2.0;Ed=mix(Xd,Yd,u_17);}vec2 Zd=(Fd*vec3(Ed.xy/2.0,1.0)).xy;vec2 ae;if(Gd !=vec2(1.0,1.0)){const float be=1.57079632679;mat4 ce=Dd((1.0-Gd.x)*be),de=Ad((1.0-Gd.y)*be);mat4 ee=mat4(mat2(Hd));ee [ 3 ] [ 0 ]=Hd [ 2 ] [ 0 ];ee [ 3 ] [ 1 ]=Hd [ 2 ] [ 1 ];vec4 fe=ee*de*ce*vec4(Zd,0.0,1.0)-vec4(Id*0.5,0.0,0.0);gl_Position=vec4((fe.xy/Id)*vec2(2.0,-2.0),0.0,1.0);const float ge=0.78539816339;float he=Id.y/(2.0*tan(ge*0.5));fe.z-=he;vec4 ie=vd(ge,Id.x/Id.y,he/2.0,he*2.0)*fe;gl_Position=ie/ie.w;}else{vec2 ae=(Hd*vec3(Zd,1.0)).xy;gl_Position=vec4((ae/Id-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}gl_Position.z=mix(Vd,Wd,Ed.y*0.5+0.5);q=td(Xd.xy,Jd);C=td(Xd.xy,Qd);s=td((Td !=0)? gl_Position.xy : Yd.xy,Kd);u=td((Ud !=0)? gl_Position.xy : Ed.xy,Md);t=td(Ed.xy,Ld);A=td(Ed.xy,Nd);B=td(Ed.xy,Od);v=td(Ed.xy,Pd);if(Rd==Sd){D=1.0;}else{vec2 je=Sd-Rd;D=dot(Zd-Rd,je)/dot(je,je);}}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform sampler2D t_4;uniform sampler2D t_5;uniform sampler2D t_6;uniform sampler2D t_7;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform vec4 ufrag_3;uniform vec4 ufrag_4;uniform float ufrag_6;uniform vec3 ufrag_8;uniform vec3 ufrag_9;uniform int ufrag_10;uniform int ufrag_11;uniform vec2 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform int ufrag_15;uniform int ufrag_16;uniform vec2 ufrag_17;uniform int ufrag_18;uniform int ufrag_19;uniform float ufrag_20;uniform float ufrag_21;uniform vec4 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform float ufrag_27;uniform float ufrag_28;uniform float ufrag_29;uniform int ufrag_30;uniform int ufrag_31;uniform float ufrag_32;uniform int ufrag_34;uniform int ufrag_35;uniform float ufrag_36;uniform int ufrag_37;uniform int ufrag_38;uniform int ufrag_39;uniform float ufrag_40;uniform float ufrag_41;uniform mat3 ufrag_42;uniform vec3 ufrag_43;uniform vec4 ufrag_44;uniform int ufrag_45;const int c=0,d=1,e=2,f=3,h=4,i=10,j=11,k=14,l=16;const int m=0,n=1,o=2,p=3;varying vec2 q,s,t,u,v,A,B,C;varying float D;float E(float F){return clamp(F,0.0,1.0);}const vec2 G=vec2(.5,.5);const float H=1.0/255.0;vec4 I(vec4 J,vec4 K){float L=K.a+J.a*(1.0-K.a);return clamp(vec4((K.rgb*K.a+J.rgb*J.a*(1.0-K.a))/max(L,H),L),0.0,1.0);}float M(float N,vec3 O,vec3 P){float Q=clamp(N,O [ 0 ],O [ 2 ]);vec3 R=abs((Q-O)*P);return min(R [ 0 ],min(R [ 1 ],R [ 2 ]));}float S(vec2 T){vec2 U=sign(G-abs(T-G));return max(0.0,U.x+U.y)*.5;}float V(float W,float X,float Y){const float Z=-0.5;const float ab=0.16;const float bb=0.5;float cb=mix(ab,Z,E(Y*bb));float db=min(Y,X);float eb=1.0-E((W-cb)/db);return eb*eb;}vec2 fb(vec4 gb,float hb,float ib,float jb,vec3 kb,vec3 lb,float Y,float mb){bool nb=ufrag_38 !=0;float ob=max(ib,Y)*0.5;float pb=gb.r-0.5;float qb=V(-pb/hb,0.5/hb,Y);float rb=clamp(0.5-mix(gb.g,min(1.0-gb.r,gb.g),ufrag_29),0.0,0.5);float sb=(nb && mb==0.0)? rb : 0.5-gb.b;float N=rb*sign(sb)/hb;bool tb=lb [ 0 ]==lb [ 2 ];if(! tb && abs(N)< ib*0.5-Y*2.0)N=sb/hb;N+=mb;const float ub=0.2;const float vb=1.0/(1.0-ub*2.0);const float wb=0.5-0.5*vb;float xb=gb.a;float yb=xb*vb+wb;float zb=(1.0-yb)*ob;float Ab=abs(N);if(xb <(1.0-ub)&& ! nb)Ab=mix(max(zb,Ab),length(vec2(zb,Ab)),jb);const float Bb=0.49;float Cb=min(ob,Bb/hb);float Db=V(Ab-Cb,0.5/hb-Cb,Y);if(xb < ub && ! nb){Db=0.0;}if(yb >=jb && ! nb){float Eb=M(N,kb*ob,lb);float Fb=min(min(lb [ 0 ],lb [ 1 ]),lb [ 2 ]);float Gb=Y*Fb;float Hb=V(Eb-Cb,0.5/hb-Cb,Gb);Db=min(Db,Hb);}if(ufrag_37==0)return vec2(clamp(qb,0.0,1.0),clamp(Db,0.0,1.0));else return vec2(0.0,clamp(max(qb,Db),0.0,1.0));}const int Ib=0,Jb=1,Kb=2,Lb=3,Mb=4,Nb=5,Ob=6,Pb=7,Qb=8,Rb=9;vec2 Sb(int Tb,vec4 Ub,vec2 T,float hb){if(Tb==Mb)return vec2(1.0-min(min(Ub [ 0 ]*T.x,Ub [ 3 ]*T.y),min(Ub [ 2 ]*(1.0-T.x),Ub [ 1 ]*(1.0-T.y))),0.0);if(Tb==Kb){float Vb=T.x,Wb=floor(Vb),Q=Vb-Wb;Vb=(fract(Wb*0.5)==0.0)? Q : 1.0-Q;return vec2(Vb,0.0);}else return T;}vec4 Xb(int Tb,vec4 Ub,vec4 Yb,vec2 T,sampler2D Zb,int ac,vec4 gb,float hb){if(Tb==Ib)return vec4(0.0,0.0,0.0,0.0);else if(Tb==Jb)return Ub;vec4 eb=texture2D(Zb,Sb(Tb,Ub,T,hb));if(ac !=0 && Tb !=0 && Tb > 1 &&(T.x < 0.0 || T.x > 1.0 || T.y < 0.0 || T.y > 1.0))eb.a=0.0;if(Tb==Pb)return mix(Ub,Yb,eb.r);else{if(Tb==Ob && eb.a > 0.0)eb.rgb/=eb.a;return eb;}}void main(){float hb=ufrag_0;float ib=ufrag_1;float bc=ufrag_2;vec4 cc=ufrag_3;vec4 dc=ufrag_4;float jb=ufrag_6;vec3 kb=ufrag_8;vec3 lb=ufrag_9;int ec=ufrag_10;int fc=ufrag_11;vec2 gc=ufrag_12;vec4 hc=ufrag_13;int ic=ufrag_15;int jc=ufrag_16;vec2 kc=ufrag_17;int lc=ufrag_18;int mc=ufrag_19;float nc=ufrag_20;float oc=ufrag_21;vec4 pc=ufrag_22;vec4 qc=ufrag_23;int rc=ufrag_24;int sc=ufrag_25;vec4 tc=ufrag_26;float mb=ufrag_27;float uc=ufrag_28;int vc=ufrag_30;int wc=ufrag_31;float xc=ufrag_32;bool yc=ufrag_34 !=0;float zc=ufrag_36;int Ac=ufrag_39;float Bc=ufrag_40;float Cc=ufrag_41;mat3 Dc=ufrag_42;vec3 Ec=ufrag_43;vec4 Fc=ufrag_44;int Gc=ufrag_45;vec4 Hc=yc ? vec4(0.0,0.0,0.0,0.0): texture2D(t_0,q);if(ic==e || ic==h || ic==f){float Ic=S(q);float Jc=S(s);Hc*=Ic;if(ic==h){vec4 Kc=texture2D(t_1,s)*Jc;Hc*=Kc.a;}else if(zc > 0.0){vec4 Kc=texture2D(t_1,s)*Jc;Hc=mix(Hc,Kc,E(zc));}if(ic==f){vec4 Lc=texture2D(t_2,q)*Ic;vec4 Mc=texture2D(t_4,s)*Jc;vec4 Nc=mix(Lc,Mc,E(zc));vec4 Oc=vec4(0.0,0.0,0.0,0.0);if(t.x >=0.0 && t.x <=1.0 && t.y >=0.0 && t.y <=1.0){Oc=mix(texture2D(t_5,t),texture2D(t_6,t),zc);}float Pc=Nc.a > 0.0 ? Nc.r/Nc.a : 0.0;float Qc=Hc.a > 0.0 ? Hc.r/Hc.a : 0.0;float Rc=abs(Pc-Qc);Hc=mix(Hc*0.5+Nc*0.5,Oc,Rc);}gl_FragColor=Hc;if(gl_FragColor.a > 0.0){gl_FragColor.rgb/=gl_FragColor.a;}}else if(ic <=d){vec2 Sc=yc ? vec2(1.0,0.0): fb(Hc,hb,ib,jb,kb,lb,bc,mb);if(Ac !=0 && ufrag_37==0){vec4 Tc=texture2D(t_7,C)*S(C);vec2 Uc=fb(Tc,hb,ib,jb,kb,lb,bc,mb);Sc=(Ac==2)? vec2(E(Sc.x-Uc.x),E(Sc.y*(1.0-Uc.x)+Sc.x*Uc.y)):(Ac==1)? vec2(Uc.x*Sc.x,E(Uc.y*Sc.x+Sc.y*Uc.x)): Uc;}vec4 Vc=Xb(ec,cc,pc,s,t_1,lc,Hc,hb);Vc.a*=nc;vec4 Wc=vec4(Vc.rgb,0.0);if(vc !=0){vec4 Xc=Xb(Ob,vec4(0.0,0.0,0.0,0.0),vec4(0.0,0.0,0.0,0.0),t,t_6,wc,Hc,hb);Xc.a*=xc;if(Gc==1 && ec !=Ib){Vc=I(Xc,Vc);Vc.a=Xc.a;}if(Gc==2 && ec !=Ib){Vc.a*=Xc.a;}else{Vc=I(Vc,Xc);}Wc=vec4(Xc.rgb,Xc.a*Bc*S(t));}Vc.rgb=clamp(mix(Vc.rgb,vec3(0.5)*sign(uc)+0.5,abs(uc)),0.0,1.0);if(sc !=0){float Yc=texture2D(t_5,B).a;Vc.rgb=mix(Vc.rgb,tc.rgb,(1.0-Yc)*tc.a);}vec4 Zc=mix(Wc,Vc,Sc [ 0 ]);vec4 ad=Xb(fc,dc,qc,u,t_2,mc,Hc,hb);vec4 bd=vec4(ad.rgb,ad.a*Sc [ 1 ]*oc);gl_FragColor=I(Zc,bd);}else if(ic==i){float cd=(Hc.r-0.5);float dd=E(1.0-2.0*abs(sin(cd*64.0)))*0.5;if(cd < 0.0)gl_FragColor=vec4(0.0,dd*(1.0+cd),1.0+cd,1.0+cd);else gl_FragColor=vec4(1.0-cd,dd*(1.0-cd),0.0,1.0);}else{if(ic==j)gl_FragColor=vec4(Hc.r,Hc.g*2.0,0.0,1.0);else if(ic==k)gl_FragColor=vec4(Hc.r,0.0,0.0,1.0);else if(ic==l)gl_FragColor=vec4(Hc.b,Hc.b > 0.95 ?(Hc.b-0.95)*20.0 : 0.0,Hc.a,1.0);else gl_FragColor=vec4(Hc.r,Hc.g,Hc.b,1.0);}float ed=gc [ 0 ]+(gc [ 1 ]-gc [ 0 ])*E(D);if(rc !=0)ed-=1.0-texture2D(t_4,A).a;if(jc !=0 &&(ic==0 || ic==2)){if(jc==1){ed-=1.0-kc [ 1 ];}else{vec4 fd=texture2D(t_3,v);if(jc==2){float gd=1.0-fd.r;ed-=1.0-E(gd*kc [ 0 ]+kc [ 1 ]);}else if(jc==3){float hd=1.0-kc [ 0 ];float id=kc [ 1 ]/hd;if(fd.r > 0.0){ed-=1.0-E(6.0*id);vec3 jd=clamp(vec3((1.0-fd.a)*kc [ 0 ]+kc [ 1 ]*3.0)-vec3(0.0,1.0-fd.b,2.0-fd.b)*(1.0-kc [ 0 ]),0.0,1.0);gl_FragColor.rgb=mix(mix(vec3(fd.r),vec3(fd.g),jd [ 1 ]),mix(vec3(fd.g),gl_FragColor.rgb,id),jd [ 2 ]);}else{ed-=1.0-E(2.0*id-1.0);}}}}if(Fc.a > 0.0){float kd=max(gl_FragColor.r,max(gl_FragColor.g,gl_FragColor.b));float ld=min(gl_FragColor.r,min(gl_FragColor.g,gl_FragColor.b));float md=(kd+ld)*0.5;vec3 nd=md < 0.5 ? Fc.rgb*md*2.0 : mix(Fc.rgb,vec3(1.0,1.0,1.0),md*2.0-1.0);gl_FragColor.rgb=mix(gl_FragColor.rgb,nd,Fc.a);}gl_FragColor.rgb=Dc*gl_FragColor.rgb+Ec;gl_FragColor.a=E(gl_FragColor.a)*E(ed)*Cc;if(ufrag_35==2){gl_FragColor.rgb=clamp(gl_FragColor.rgb+0.5,0.0,1.0);}else if(ufrag_35==3){gl_FragColor.rgb=clamp(gl_FragColor.rgb-0.5,0.0,1.0);}if(ic !=d && hc.a > 0.0)gl_FragColor.rgb=hc.rgb;gl_FragColor.rgb*=gl_FragColor.a;gl_FragColor.rgb=clamp(gl_FragColor.rgb,0.0,1.0);if(ic==d){if(gl_FragColor.a > 0.0)gl_FragColor=hc;else gl_FragColor=vec4(0.0,0.0,0.0,0.0);}if(ufrag_35==1 || ufrag_35==2){float od=1.0-gl_FragColor.a;gl_FragColor=vec4(od+gl_FragColor.rgb,gl_FragColor.a);}else if(gl_FragColor.a==0.0){gl_FragColor=vec4(0.0,0.0,0.0,0.0);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_6","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_20","ufrag_21","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28","ufrag_29","ufrag_30","ufrag_31","ufrag_32","ufrag_34","ufrag_35","ufrag_36","ufrag_37","ufrag_38","ufrag_39","ufrag_40","ufrag_41","ufrag_42","ufrag_43","ufrag_44","ufrag_45","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_10","u_11","u_13","u_14","u_15","u_16","u_17","u_18","u_19","u_20","u_21"],s:["t_0","t_1","t_2","t_3","t_4","t_5","t_6","t_7"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_2=void 0,t.p_2={v:"precision highp float;uniform int u_0;uniform vec2 u_1;uniform vec2 u_2;uniform mat3 u_3;attribute vec2 a_v;attribute vec4 a_p1;attribute vec4 a_p2;varying vec2 c;void main(){if(u_0==0){gl_Position=vec4(a_v,0.0,1.0);}else{vec2 s;if(a_v.x > 0.0){vec2 N=(a_v.y < 0.0)? a_p1.xy : a_p2.xy;gl_Position=vec4((((u_3*vec3(N,1.0)).xy-u_1)*u_2)*vec2(2.0,-2.0),0.0,1.0);}else gl_Position=vec4(0.0,0.0,0.0,1.0);}c=a_v*vec2(0.5,-0.5)+vec2(0.5,0.5);}",f:"precision highp float;uniform float bfrag_0 [ 11 ];uniform vec4 bfrag_1 [ 11 ];uniform int ufrag_0;uniform vec2 ufrag_2;uniform int ufrag_4;uniform vec2 ufrag_5;uniform float ufrag_6;uniform float ufrag_7;varying vec2 c;vec4 d(vec4 e,float f,float h){return vec4(pow(e.r,f),pow(e.g,f),pow(e.b,f),pow(e.a,h));}vec4 i(float j){float k=ufrag_6;float h=ufrag_7;float l=1.0/k;float m=1.0/h;for(int n=0;n < 10;n++){if(j <=bfrag_0 [ n+1 ]){vec4 o=d(bfrag_1 [ n ],k,h);vec4 p=d(bfrag_1 [ n+1 ],k,h);return d(mix(o,p,(j-bfrag_0 [ n ])/(bfrag_0 [ n+1 ]-bfrag_0 [ n ])),l,m);}}return bfrag_1 [ 10 ];}float q(vec2 s,vec2 t){vec2 u=s-t;float v=dot(u,u);float A=t.x*s.y-s.x*t.y;vec2 B=u*A;float C=sqrt(v-A*A);vec2 D=u*C;vec2 E=vec2((B.y+sign(D.y)*D.x),(-B.x+abs(D.y)))/v;vec2 F=vec2((B.y-sign(D.y)*D.x),(-B.x-abs(D.y)))/v;vec2 G=sign(length(E-t)-length(F-t))==sign(dot(t-s,t))? E : F;float j=length(s-t)/length(G-t);return clamp(j,0.0,1.0);}float H(float x){return x < 0.5 ? 2.0*x*x : 2.0*x*(2.0-x)-1.0;}float I(float x,float J){return x < J ? H(x/J): H((1.0-x)/(1.0-J));}float K(float x,float J){return x < J ? x/J :(1.0-x)/(1.0-J);}void main(){float j=c.x;if(ufrag_0==1){vec2 t=ufrag_2;j=q(c*2.0-1.0,t*2.0-1.0);}if(ufrag_4 !=0){float L=I(j,ufrag_5.x)*ufrag_5.y;float M=K(j,ufrag_5.x)*ufrag_5.y;gl_FragColor=vec4(i(L).rgb,i(M).a);}else{gl_FragColor=i(j);}}",a:["a_v","a_p1","a_p2"],u:["bfrag_0","bfrag_1","ufrag_0","ufrag_2","ufrag_4","ufrag_5","ufrag_6","ufrag_7","u_0","u_1","u_2","u_3"],s:[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_3=void 0,t.p_3={v:"precision highp float;uniform float u_0;uniform vec2 u_1;uniform vec2 u_2;uniform vec2 u_3;uniform int u_4;attribute vec2 a_v;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec2 G=a_v;float H=u_0;vec2 I=u_1;vec2 J=u_2;vec2 K=u_3;int p=u_4;gl_Position=vec4(G.x,-G.y,0.0,1.0);vec2 L=(vec2(G.x,-G.y)*I/2.0)+vec2(0.5,0.5);if(p==1){vec2 M=J*vec2(2.0*H/(K.x*8.0),2.0*H/(K.y*8.0));vec2 N=L-J*vec2(H/K.x,H/K.y);c=N;d=N+M;e=N+M*2.0;f=N+M*3.0;h=N+M*4.0;i=N+M*5.0;j=N+M*6.0;k=N+M*7.0;l=N+M*8.0;}else{vec2 r=vec2(H/K.x,H/K.y);c=L+r*vec2(-0.7,-0.7);d=L+r*vec2(0.0,-1.0);e=L+r*vec2(0.7,-0.7);f=L+r*vec2(-1.0,0.0);h=L;i=L+r*vec2(1.0,0.0);j=L+r*vec2(-0.7,0.7);k=L+r*vec2(0.0,1.0);l=L+r*vec2(0.7,0.7);}}",f:"precision highp float;uniform sampler2D tex_0;uniform vec4 ufrag_0;uniform float ufrag_2;uniform int ufrag_3;uniform int ufrag_4;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec4 m=ufrag_0;int n=ufrag_3;float o=ufrag_2;int p=ufrag_4;vec4 q=p==1 ? vec4(1.20,1.15,1.10,1.05)*o : vec4(1.20,1.20,1.20,1.20)*o;vec4 s=texture2D(tex_0,c,q [ 0 ]);vec4 t=texture2D(tex_0,d,q [ 1 ]);vec4 u=texture2D(tex_0,e,q [ 2 ]);vec4 v=texture2D(tex_0,f,q [ 3 ]);vec4 A=texture2D(tex_0,h,o);vec4 B=texture2D(tex_0,i,q [ 3 ]);vec4 C=texture2D(tex_0,j,q [ 2 ]);vec4 D=texture2D(tex_0,k,q [ 1 ]);vec4 E=texture2D(tex_0,l,q [ 0 ]);if(n==0){vec4 F=s*0.000229+t*0.005977+u*0.060598+v*0.241732+A*0.382928+B*0.241732+C*0.060598+D*0.005977+E*0.000229;gl_FragColor=clamp(F,0.0,1.0);}else if(n==1){float F=s.a*0.000229+t.a*0.005977+u.a*0.060598+v.a*0.241732+A.a*0.382928+B.a*0.241732+C.a*0.060598+D.a*0.005977+E.a*0.000229;gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==2){float F=min(min(min(min(s.a,t.a),min(u.a,v.a)),min(min(A.a,B.a),min(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==3){float F=max(max(max(max(s.a,t.a),max(u.a,v.a)),max(max(A.a,B.a),max(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}}",a:["a_v"],u:["ufrag_0","ufrag_2","ufrag_3","ufrag_4","u_0","u_1","u_2","u_3","u_4"],s:["tex_0"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_4=void 0,t.p_4={v:"precision highp float;attribute vec2 a_v;varying vec2 c;void main(){vec2 v=a_v;gl_Position=vec4(v.x,-v.y,0.0,1.0);c=(vec2(v.x,v.y)/2.0)+vec2(0.5,0.5);}",f:"precision highp float;varying vec2 c;const int d=1,e=2,f=3,h=4,i=5,j=6,k=7,l=8,m=9,n=10,o=11,p=12;uniform int ufrag_0;uniform float ufrag_1;void main(){const float PI=3.141592653;const float q=0.707106781;int s=ufrag_0;float t=ufrag_1;float u=0.0,x=c.x,y=c.y;if(s==d)u=1.0-x*t;else if(s==e)u=max(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==f)u=1.0-(x*t+floor(y*t)/2.0);else if(s==h)u=length(c*2.0-vec2(1.0,1.0))*q;else if(s==i)u=(abs(x*2.0-1.0)+abs(y*2.0-1.0))*0.5;else if(s==j)u=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);else if(s==k)u=min(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==l)u=fract(sin(x*12.9898)*43758.5453);else if(s==m)u=abs(x*2.0-1.0);else if(s==n)u=1.0-(ceil(x*t)+ceil(y*t))/(2.0*t);else if(s==o)u=1.0-atan(abs(x-0.5),0.5-y)/PI;else if(s==p)u=1.0-atan(x-0.5,0.5-y)*t/(2.0*PI);gl_FragColor=vec4(mod(u,1.0),0.0,0.0,1.0);}",a:["a_v"],u:["ufrag_0","ufrag_1"],s:[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_5=void 0,t.p_5={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;const int i=0,j=1,k=2,l=3;void main(){vec2 m=a_v;vec4 n=a_0,o=a_1;vec2 p=m*0.5+0.5;c=vec2(n [ i ]+(n [ k ]-n [ i ])*p.x,1.0-(n [ j ]+(n [ l ]-n [ j ])*p.y));gl_Position=vec4((o [ i ]+(o [ k ]-o [ i ])*p.x)*2.0-1.0,1.0-((o [ j ]+(o [ l ]-o [ j ])*p.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;varying vec2 c;float d(float e){return clamp(e,0.0,1.0);}void main(){float f=ufrag_0;vec4 h=texture2D(t_0,c);h.rgb=(h.rgb-0.5)*f+0.5;gl_FragColor=h;}",a:["a_v","a_0","a_1"],u:["ufrag_0"],s:["t_0"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_6=void 0,t.p_6={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;const int Wb=0,Xb=1,Yb=2,Zb=3;void main(){vec2 ac=a_v;vec4 bc=a_0,cc=a_1;vec2 dc=ac*0.5+0.5;c=vec2(bc [ Wb ]+(bc [ Yb ]-bc [ Wb ])*dc.x,1.0-(bc [ Xb ]+(bc [ Zb ]-bc [ Xb ])*dc.y));gl_Position=vec4((cc [ Wb ]+(cc [ Yb ]-cc [ Wb ])*dc.x)*2.0-1.0,1.0-((cc [ Xb ]+(cc [ Zb ]-cc [ Xb ])*dc.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform sampler2D t_4;uniform float ufrag_0;uniform int ufrag_1;varying vec2 c;uniform int ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform int ufrag_6;uniform float ufrag_7;uniform float ufrag_8;uniform float ufrag_9;uniform int ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec3 ufrag_13;uniform vec3 ufrag_14;uniform int ufrag_15;uniform float ufrag_16;uniform float ufrag_17;uniform float ufrag_18;uniform vec4 ufrag_19;uniform vec2 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform vec4 ufrag_27;uniform vec4 ufrag_28;uniform int ufrag_29;uniform vec4 ufrag_30;const int d=0;const int e=1;const int f=2;const int h=3;const int i=1;const int j=2;const int k=3;const int l=4;float m(float n){return clamp(n,0.0,1.0);}vec3 o(vec3 rgb){float p=max(rgb.r,max(rgb.g,rgb.b));float q=min(rgb.r,min(rgb.g,rgb.b));float s=(p+q)*0.5;if(p==q)return vec3(0.0,0.0,s);float t=(p-q)*2.0;float u=p+q;float v=0.5*t/((s <=0.5)? u : 2.0-u);float A=(rgb.r==p)?((rgb.g-rgb.b)/t)/3.0 :(rgb.g==p)?(1.0+(rgb.b-rgb.r)/t)/3.0 :(2.0+(rgb.r-rgb.g)/t)/3.0;return vec3(fract(A),v,s);}float B(float C,float D,float E){float F=fract(E);return(F*6.0 < 1.0)? C+(D-C)*F*6.0 :(F*2.0 < 1.0)? D :(F*3.0 < 2.0)? C+(D-C)*(4.0-F*6.0): C;}vec3 G(vec3 H){float D=(H.z <=0.5)? H.z+H.z*H.y : H.z+H.y-H.z*H.y;float C=2.0*H.z-D;return vec3(B(C,D,H.x+1.0/3.0),B(C,D,H.x),B(C,D,H.x-1.0/3.0));}const vec3 I=vec3(2.2,2.2,2.2);const vec3 J=vec3(1.0/2.2,1.0/2.2,1.0/2.2);const vec2 K=vec2(.5,.5);vec4 L(vec4 M,vec3 N){return vec4(pow(M.rgb,N),M.a);}vec3 O(vec3 rgb,vec4 u){return clamp(u [ 0 ]*rgb*rgb*rgb+u [ 1 ]*rgb*rgb+u [ 2 ]*rgb+u [ 3 ],0.0,1.0);}vec2 P(float Q,vec3 R,float S,vec2 T){float U=floor(Q/S);float V=Q-U*S;return vec2(V,U)*R.rg+T;}vec3 W(vec3 M,vec3 R,float S){vec2 X=R.rg*vec2(S,ceil(R.b/S));vec3 Y=clamp(M,0.0,1.0)*(R-vec3(1.0));vec2 T=Y.rg+vec2(0.5);float Z=floor(Y.b);float ab=min(Z+1.0,R.b-1.0);vec3 a=texture2D(t_2,P(Z,R,S,T)/X).rgb;vec3 b=texture2D(t_2,P(ab,R,S,T)/X).rgb;return mix(a,b,Y.b-Z);}const int bb=8;const int cb=16;const float db=float(cb)*sqrt(3.0);vec3 eb(int fb){return texture2D(t_3,vec2(float(fb)/255.0,0.0)).rgb;}vec4 gb(vec3 hb,int ib [ bb ]){float jb=db;int kb=0;vec3 lb=vec3(0.0);for(int fb=0;fb < bb;fb++){int mb=ib [ fb ];vec3 M=eb(mb);float nb=length(M-hb);if(nb < jb){kb=mb;lb=M;jb=nb;}}return vec4(lb,float(kb));}int ob(vec3 pb,int ib [ bb ]){vec3 hb=pb;int kb=0;float qb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);int rb=int(qb*float(cb-1));for(int sb=0;sb < cb;sb++){vec4 tb=gb(hb,ib);vec3 lb=tb.rgb;kb=int(tb.a);if(sb==rb){return kb;}hb=((hb+(hb-lb))+pb)*0.5;}return kb;}int ub(vec3 pb){int ib [ bb ];float vb [ bb ];for(int mb=0;mb < bb;mb++){ib [ mb ]=mb;vb [ mb ]=length(eb(mb)-pb);}for(int mb=bb;mb < 256;mb++){int wb=0;float xb=0.0;for(int yb=0;yb < bb;yb++){float zb=vb [ yb ];if(zb > xb){wb=yb;xb=zb;}}vec3 M=eb(mb);float nb=length(M-pb);if(nb < xb){for(int yb=0;yb < bb;yb++){if(yb==wb){ib [ yb ]=mb;vb [ yb ]=nb;}}}}return ob(pb,ib);}vec3 Ab(vec3 pb){vec4 Bb=ufrag_26;vec4 Cb=ufrag_27;vec4 Db=ufrag_28;float Eb=m(dot(pb,vec3(0.2126,0.7152,0.0722)));vec4 Fb=Bb+Cb*m(Eb*3.0-1.5)-Db*m(Eb*-3.0+1.5);return mix(vec3(Eb),pb*Fb.rgb,Fb.a);}vec4 Gb(vec4 pb){if(ufrag_3+ufrag_6+ufrag_10+ufrag_15+ufrag_25==0 &&(ufrag_23.x <=1.0)){return pb;}vec4 Hb=vec4(pb);Hb.rgb=Hb.a==0.0 ? vec3(0.0,0.0,0.0): Hb.rgb/Hb.a;if(ufrag_15==1){Hb.r*=ufrag_16;Hb.b*=ufrag_17;Hb.g*=ufrag_18;}if(ufrag_6==1){vec3 H=o(Hb.rgb);H=vec3(fract(H.x+ufrag_7),H.yz*vec2(ufrag_8,ufrag_9));Hb.rgb=clamp(G(H),0.0,1.0);}if(ufrag_3==1){Hb.rgb=ufrag_4 [ 0 ]*Hb.rgb+ufrag_4 [ 1 ];if(ufrag_5 [ 0 ] < 0.0){Hb.rgb=clamp(Hb.rgb,0.0,1.0);}Hb.rgb=O(Hb.rgb,ufrag_5);}if(ufrag_25==1){Hb.rgb=Ab(Hb.rgb);}if(ufrag_10==1){const vec3 Ib=vec3(0.2125,0.7154,0.0721);float Jb=clamp(dot(Hb.rgb,Ib)*ufrag_11+ufrag_12,0.0,1.0);Hb.rgb=mix(ufrag_13,ufrag_14,Jb);}if(ufrag_23.x > 1.0){Hb.rgb=W(Hb.rgb,ufrag_23.xyz,ufrag_23.w);}Hb.rgb*=Hb.a;return Hb;}void main(){float Kb=ufrag_0;int Lb=ufrag_1;vec4 Mb=ufrag_19;int Nb=ufrag_29;vec4 Ob=ufrag_30;vec4 Pb=texture2D(t_0,c);vec4 Qb=Pb;Qb.rgb=(Qb.rgb-0.5)*Kb+0.5;Qb.rgb=(Lb==f)? vec3(Qb.b,Qb.g,Qb.r): Qb.rgb;if(Lb==h){vec4 Rb=texture2D(t_1,c);vec3 Sb=vec3(Qb.r,Rb.r,Rb.a)*255.0-vec3(16.0,128.0,128.0);vec3 rgb=Sb*mat3(1.164383,0.0,1.596027,1.164383,-0.391762,-0.812968,1.164383,2.017232,0.0);Qb.rgb=clamp(rgb/255.0,0.0,1.0);}else if(Lb==e){Qb=Gb(Qb);}if(Nb !=0){float Tb=dot(texture2D(t_4,c),Ob);if(Nb==i){Qb*=Tb;}else if(Nb==j){Qb*=1.0-Tb;}else if(Nb==k){Qb=mix(Pb,Qb,Tb);}else if(Nb==l){Qb=mix(Qb,Pb,Tb);}}if(Mb.a !=0.0){float Ub=Mb.a*Qb.a;Qb=vec4(Mb.rgb*Ub,Ub);}if(ufrag_24==1){int Vb=ub(Qb.rgb);Qb=vec4(eb(Vb),1.0);}gl_FragColor=Qb;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28","ufrag_29","ufrag_30"],s:["t_0","t_1","t_2","t_3","t_4"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_7=void 0,t.p_7={v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform mat3 u_2;uniform mat3 u_3;uniform vec2 u_4;attribute vec2 a_v;varying vec2 c;varying vec2 d;vec2 Kb(vec2 Lb,mat3 Mb){return(Mb*vec3(vec2(Lb.x/2.0,Lb.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}void main(){vec2 Nb=a_v;mat3 Ob=u_0;mat3 Pb=u_1;mat3 Qb=u_2;mat3 Rb=u_3;vec2 Sb=u_4;c=Kb(Nb.xy,Qb);d=Kb(Nb.xy,Rb);vec2 Tb=(Ob*vec3(Nb.xy/2.0,1.0)).xy;vec2 Ub=(Pb*vec3(Tb,1.0)).xy;gl_Position=vec4((Ub/Sb-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;varying vec2 c;varying vec2 d;uniform int ufrag_0;uniform vec2 ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform vec4 ufrag_6 [ 4 ];uniform vec3 ufrag_7 [ 4 ];uniform vec4 ufrag_8 [ 4 ];uniform vec4 ufrag_9;uniform vec4 ufrag_10;uniform vec4 ufrag_11;uniform vec4 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform float ufrag_15;uniform vec4 ufrag_16;uniform float ufrag_17;const int e=0;const int f=1;const int h=2;float i(vec2 j,float k,float l){vec2 m=ufrag_1;float n=ufrag_2;float o=ufrag_3;vec2 p=ufrag_4;float q=texture2D(t_1,j+m*vec2(k,l)).r;float s=clamp((q*n+o)/p.x,0.0,1.0);return texture2D(t_2,vec2(s,1.0)).r*p.y;}vec3 t(vec2 j){float u=i(j,-1.0,-1.0);float v=i(j,0.0,-1.0);float A=i(j,1.0,-1.0);float B=i(j,-1.0,0.0);float C=i(j,0.0,0.0);float D=i(j,1.0,0.0);float E=i(j,-1.0,1.0);float F=i(j,0.0,1.0);float G=i(j,1.0,1.0);vec3 H=normalize(vec3(1.0,0.0,v-u));vec3 I=normalize(vec3(1.0,0.0,A-v));vec3 J=normalize(vec3(1.0,0.0,C-B));vec3 K=normalize(vec3(1.0,0.0,D-C));vec3 L=normalize(vec3(1.0,0.0,F-E));vec3 M=normalize(vec3(1.0,0.0,G-F));vec3 N=normalize(vec3(0.0,1.0,B-u));vec3 O=normalize(vec3(0.0,1.0,C-v));vec3 P=normalize(vec3(0.0,1.0,D-A));vec3 Q=normalize(vec3(0.0,1.0,E-B));vec3 R=normalize(vec3(0.0,1.0,F-C));vec3 S=normalize(vec3(0.0,1.0,G-D));return normalize(cross(H,N)+cross(H,O)+cross(I,O)+cross(I,P)+cross(J,N)+cross(J,O)+cross(K,O)+cross(K,P)+cross(J,Q)+cross(J,R)+cross(K,R)+cross(K,S)+cross(L,Q)+cross(L,R)+cross(M,R)+cross(M,S));}vec4 T(vec4 U,vec4 V){float W=V.a+U.a*(1.0-V.a);return vec4((V.rgb*V.a+U.rgb*U.a*(1.0-V.a))/W,W);}void main(){int X=ufrag_0;vec4 Y=texture2D(t_0,c);if(X !=0){vec4 Z=vec4(Y.rgb/Y.a,Y.a);int ab=ufrag_14;if(ab==f){Z=vec4(0.0,0.0,0.0,0.0);}else{vec3 bb=t(d);vec4 cb=ufrag_5;vec4 db=ufrag_9;vec4 eb=ufrag_10;vec4 fb=ufrag_11;vec4 gb=ufrag_12;vec4 hb=ufrag_13;vec3 ib=gb.rgb+cb.rgb*fb.rgb;vec3 jb=vec3(0.0,0.0,-1.0);float kb=hb.x;bool lb=hb.y !=0.0;;vec3 mb=vec3(0.0,0.0,0.0);vec3 nb=vec3(0.0,0.0,0.0);for(int ob=0;ob < 4;ob++){vec3 pb=ufrag_6 [ ob ].rgb;vec3 qb=ufrag_7 [ ob ];float rb=ufrag_8 [ ob ].x;float sb=ufrag_8 [ ob ].y;float tb=ufrag_8 [ ob ].z;float ub=ufrag_8 [ ob ].w;float vb=-dot(bb,qb);vb=vb*rb+sb;mb+=clamp(vb,0.0,1.0)*tb*pb;float wb=0.0;if(lb){vec3 xb=-normalize(jb+qb);wb=dot(xb,bb);}else{vec3 yb=jb-2.0*bb*dot(bb,jb);wb=-dot(yb,qb);}wb=pow(max(0.0,wb),kb);nb+=clamp(wb,0.0,1.0)*ub*pb;}mb*=db.rgb;nb*=eb.rgb;float zb=Z.a*db.a;float Ab=hb.z;float Bb=hb.w;float Cb=1.0-abs(dot(jb,bb));if(Bb > 0.0){zb+=(1.0-zb)*pow(Cb,Bb);}else if(Bb < 0.0){zb-=zb*pow(Cb,-Bb);}if(Ab > 0.0){mb+=(vec3(1.0,1.0,1.0)-mb)*pow(Cb,Ab);}else if(Ab < 0.0){mb-=mb*pow(Cb,-Ab);}if(ab==h){const float Db=0.5;mb+=nb*Db;nb*=(1.0-Db);}Z.rgb=clamp(Z.rgb*(ib+mb)+nb,0.0,1.0);Z.a=clamp(zb,0.0,1.0);}float Eb=ufrag_15;if(Eb > 0.0){float n=ufrag_2;float o=ufrag_3;vec4 Fb=ufrag_16;float Gb=ufrag_17;float Hb=max(Eb,Gb)*0.5;float Ib=abs(texture2D(t_1,d).r*n+o);float Jb=clamp(Hb-Ib,0.0,1.0);Z=T(Z,Fb*vec4(1.0,1.0,1.0,Jb));}Y=vec4(Z.rgb*Z.a,Z.a);}gl_FragColor=Y;}",a:["a_v"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","u_0","u_1","u_2","u_3","u_4"],s:["t_0","t_1","t_2"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_8=void 0,t.p_8={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;uniform mat3 u_1;const int rb=0,sb=1,tb=2,ub=3;void main(){vec2 vb=a_v;vec4 wb=a_0,xb=a_1;vec2 yb=vb*0.5+0.5;c=vec2(wb [ rb ]+(wb [ tb ]-wb [ rb ])*yb.x,1.0-(wb [ sb ]+(wb [ ub ]-wb [ sb ])*yb.y));c=(u_1*vec3(c.x,c.y,1.0)).xy;gl_Position=vec4((xb [ rb ]+(xb [ tb ]-xb [ rb ])*yb.x)*2.0-1.0,1.0-((xb [ sb ]+(xb [ ub ]-xb [ sb ])*yb.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform vec2 ufrag_3;uniform int ufrag_4;uniform int ufrag_5;uniform vec2 ufrag_22;varying vec2 c;const float PI=3.141592653;float d(float e){return clamp(e,0.0,1.0);}vec3 f(vec3 rgb){float h=max(rgb.r,max(rgb.g,rgb.b));float i=min(rgb.r,min(rgb.g,rgb.b));float j=(h+i)*0.5;if(h==i)return vec3(0.0,0.0,j);float k=(h-i)*2.0;float l=h+i;float m=0.5*k/((j <=0.5)? l : 2.0-l);float n=(rgb.r==h)?((rgb.g-rgb.b)/k)/3.0 :(rgb.g==h)?(1.0+(rgb.b-rgb.r)/k)/3.0 :(2.0+(rgb.r-rgb.g)/k)/3.0;return vec3(fract(n),m,j);}float o(float x){return fract(sin(x*12.9898)*43758.5453);}float p(vec2 q){float s=ufrag_2;const float t=1.0;const float u=0.7;vec2 v=vec2(q.x,(1.0-q.y-(1.0-cos(q.x*PI/4.0))*t)*(1.0+t*0.5));float A=(v.x+v.y)*0.5;float B=d(((v.x-v.y)*0.5)/(1.0-abs(A-0.5)*2.0)*u+0.5);float C=floor(A*s);return d(1.0-1.0*(fract(C/2.0)==0.0 ?(C+B)/s :(C+1.0-B)/s));}float D(vec2 q,bool E){float s=ufrag_2;float F=p(q);float G=1.0-floor(q.x*s)/s;return mix(E ? o(G): G,F,E ? 0.3 : 0.1);}float H(vec2 q,vec2 I){float J=ufrag_2;float K=1.0-atan(q.x-I.x,q.y-I.y);float L=1.0+J*(sin(K*3.0)*0.1+sin(K*7.0)*0.05+sin(K*11.0)*0.03);return max(0.0,1.0-length(q-I)*L);}float M(vec2 q,vec2 I){bool N=ufrag_5 !=0;float O=N ? ufrag_22.y/ufrag_22.x : ufrag_22.x/ufrag_22.y;float s=ufrag_2;vec2 e=q-I;e*=O > 1.0 ? vec2(O,1.0): vec2(1.0,1.0/O);float P=length(e)*sqrt(2.0);if(P < 0.01/s){return 1.0;}float K=0.5+atan(e.y,e.x)/(2.0*PI);return(floor((1.0-P)*s-K)+K)/s;}void main(){const int Q=2;const float R=float((Q*2+1)*(Q*2+1));const float S=1.0;const float T=3.0;const float U=1.0;const float V=1.0;const vec3 W=vec3(0.0,0.0,-1.0);const float s=15.0;const vec2 X=vec2(1.0,1.0);bool N=ufrag_5 !=0;bool Y=c.x < 0.0 || c.y < 0.0 || c.x > 1.0 || c.y > 1.0;vec4 Z=texture2D(t_0,c);float ab=0.0;float bb=0.0;float cb=0.0;for(int db=-Q;db <=Q;db++){for(int eb=-Q;eb <=Q;eb++){vec2 fb=c+vec2(float(eb),float(db))*S/ufrag_22;vec4 gb=texture2D(t_0,fb);ab+=abs(Z.r-gb.r)+abs(Z.g-gb.g)+abs(Z.b-gb.b);vec2 hb=ufrag_3.xy;vec2 ib=N ? vec2(1.0-fb.y,1.0-fb.x): fb;ib=vec2(hb.x > 0.0 ? ib.x : 1.0-ib.x,hb.y > 0.0 ? ib.y : 1.0-ib.y);float jb=0.5;if(ufrag_1==1){jb=p(ib);}else if(ufrag_1==2){jb=H(ib,vec2(0.0,0.0));}else if(ufrag_1==3){jb=H(ib,vec2(0.5,0.5));}else if(ufrag_1==4){jb=D(ib,false);}else if(ufrag_1==5){jb=D(ib,true);}else if(ufrag_1==6){jb=M(ib,vec2(0.5,0.5));}bb+=jb;if(ufrag_4==0){cb+=0.5;}else{vec3 kb=f(Z.rgb);if(ufrag_4==1){cb+=1.0-smoothstep(0.4,0.6,kb [ 2 ]);}if(ufrag_4==2){cb+=smoothstep(0.4,0.6,kb [ 2 ]);}}}}ab=U*T*ab/R;bb=V*bb/R;cb=cb/R;vec3 lb=f(Z.rgb);vec3 mb=vec3(W.x < 0.0 ? 1.0 : 0.0,W.y < 0.0 ? 1.0 : 0.0,W.z < 0.0 ? 1.0 : 0.0)+f(Z.rgb)*W;float L=d((ab+bb+mb.x+mb.y+mb.z)/(U+V+abs(W.x)+abs(W.y)+abs(W.z)));float nb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);float ob=1.0-nb*0.2;float pb=d(min(d((ab-0.5)*1.5+0.5)*nb,0.5));float qb=d(min((ab-0.75)*4.0+0.5,0.5));if(Y){gl_FragColor=vec4(0.0,ob,0.0,bb);}else{gl_FragColor=vec4(ob,ob-pb-qb,cb,bb);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_22","u_1"],s:["t_0"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_9=void 0,t.p_9={v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 d;const int S=0,T=1,U=2,V=3;void main(){vec2 W=a_v;vec4 X=a_0,Y=a_1;vec2 Z=W*0.5+0.5;d=vec2(X [ S ]+(X [ U ]-X [ S ])*Z.x,1.0-(X [ T ]+(X [ V ]-X [ T ])*Z.y));gl_Position=vec4((Y [ S ]+(Y [ U ]-Y [ S ])*Z.x)*2.0-1.0,1.0-((Y [ T ]+(Y [ V ]-Y [ T ])*Z.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform int ufrag_3;uniform bool ufrag_4;uniform int ufrag_5;uniform vec4 ufrag_6;uniform float ufrag_7;uniform bool ufrag_8;const int c=22;varying vec2 d;const int e=1;const int f=2;const int h=3;const int i=4;const float j=0.0001;float k(float l){return clamp(l,0.0,1.0);}float m(vec2 n){int o=ufrag_5;vec4 p=ufrag_6;float q=1.0;if(o > 2){float s=dot(texture2D(t_2,n),p);if(o==i){s=1.0-s;}float t=ufrag_7;if(ufrag_8){q=abs(s-t);}else{q=max(0.0,s-t);}}return q*q;}void main(){int o=ufrag_5;vec2 u=ufrag_3==0 ? vec2(1.0/512.0,0.0): vec2(0.0,1.0/512.0);u*=ufrag_1;if(ufrag_2 > 1.0 && ufrag_3==0){u/=ufrag_2;}else if(ufrag_2 < 1.0 && ufrag_3==1){u*=ufrag_2;}float v=1.0/ufrag_0;float A=v*v;float B=-0.5*A;float C=0.39894*v;float D=m(d);float E=C*max(D,j);vec4 F=texture2D(t_0,d);vec4 G=F;if(E > 0.0){vec4 H=E*F;float I=0.0;I+=E;for(int J=1;J < c;J++){float K=float(J);float L=C*exp(K*K*B);vec2 M=K*u*D;vec2 N=d-M;vec2 O=d+M;float P=L*m(N);float Q=L*m(O);H+=P*texture2D(t_0,N)+Q*texture2D(t_0,O);I+=P+Q;}G=H/I;}if(ufrag_4){vec4 R=texture2D(t_1,d);vec4 s=R-G;G=R+s*ufrag_0*9.0;G=clamp(G,0.0,1.0);}gl_FragColor=G;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8"],s:["t_0","t_1","t_2"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_10=void 0,t.p_10={v:"precision highp float;attribute vec2 a_v;uniform float u_0;uniform vec2 u_1;varying vec2 c;varying vec2 d;varying vec2 e;varying vec2 f;const float u_uvScale=0.2400;const float u_offsetSpeedRatio=0.3000;const float u_jellyfishDispScaleR=0.3600;const float u_jellyfishDispacement=3.4000;const float Pc=0.4235;const float Qc=0.3176;const vec2 Rc=vec2(Pc,Qc);const float Sc=0.15;const float Tc=0.02;vec2 k(vec2 l,vec2 m){float n=m.x/m.y;vec2 o=(m.x > m.y)? vec2(m.x/m.y,1.0): vec2(1.0,m.y/m.x);return(l-vec2(0.5,0.5))*o+vec2(0.5,0.5);}void main(){c=a_v*0.5+0.5;gl_Position=vec4(a_v*vec2(1.0,-1.0),0.0,1.0);vec2 H=k(c,u_1);vec2 Uc=Rc+H*u_uvScale;float K=u_0*u_offsetSpeedRatio;vec2 Vc=vec2(sin(K),cos(K))*Sc;d=Uc+Vc;e=Uc-Vc;vec2 Wc=Rc+H*u_jellyfishDispScaleR;float Xc=u_0*u_jellyfishDispacement;vec2 Yc=vec2(sin(Xc),cos(Xc))*Tc;f=Wc+Yc;}",f:"precision highp float;varying vec2 c;varying vec2 d;varying vec2 e;varying vec2 f;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform vec2 ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform vec2 ufrag_4;uniform float ufrag_5;uniform float ufrag_6;uniform float ufrag_7;uniform vec2 ufrag_8;uniform float ufrag_9;uniform vec4 ufrag_10;uniform vec4 ufrag_11;uniform vec4 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform float ufrag_15;uniform float ufrag_16;uniform int ufrag_17;uniform int ufrag_18;const float h=2.718281828459;const float PI=3.14;const float i=2.2;const float j=1.0/i;const float u_motionRange=1.3;const float u_colorSize=0.45;const float u_speedRatio=1.35;const vec3 u_Color=vec3(0.6800,0.1166,1);const vec3 u_Color1=vec3(0.0220,0.4647,1);const vec3 u_Color3=vec3(0,0.1905,0.6661);const vec3 u_Color2=vec3(0.9914,0.3993,0.1768);const float u_roseOffset=3.2;const float u_pinkOffset=4.7;const float u_greenOffset=1.6;const float u_iridescenceRepeat=1.2000;const float u_iridescenceOpacity=0.2300;const float u_jellyfishScale=2.;const float u_jellyfishOpacity=0.7800;const float u_jellyfishDisplacementSize=2.8000;vec2 k(vec2 l,vec2 m){float n=m.x/m.y;vec2 o=(m.x > m.y)? vec2(m.x/m.y,1.0): vec2(1.0,m.y/m.x);return(l-vec2(0.5,0.5))*o+vec2(0.5,0.5);}float p(float q){return-(cos(q*3.1415)-1.0)/2.0;}float s(vec2 t,float u){vec2 xy=t+vec2(sin(u),cos(u))*u_motionRange;float v=p(clamp(length(xy*u_colorSize),0.0,1.0));return v;}vec3 A(vec3 B){return pow(B,vec3(i));}vec3 C(vec3 B){return pow(B,vec3(j));}float D(vec2 E,vec2 b,float r){vec2 F=abs(E)-b;return length(max(F,0.0))+min(max(F.x,F.y),0.0)-r;}vec4 G(){vec2 m=ufrag_0;vec2 H=k(c,m);H.y=1.0-H.y;float I=ufrag_2;vec2 J=ufrag_8;float K=I*u_speedRatio;vec2 t=H*2.0-1.0;float L=s(t,K);float M=(1.-L)*0.5+0.5;vec3 N=u_Color1*M;float O=K+u_roseOffset;float P=s(t,O);vec3 Q=mix(u_Color,N,P);float R=K+u_pinkOffset;float S=s(t,R);float T=(1.-S)*0.5+0.5;vec3 U=u_Color3*T;float V=K+u_greenOffset;float W=s(t,V);vec3 X=mix(u_Color2,U,W);vec3 Y=mix(Q,X,L*P);vec4 Z=texture2D(t_0,d);float ab=Z.g;vec4 bb=texture2D(t_0,e);float cb=bb.r;float db=bb.b;float eb=bb.a;float fb=ab*(1.-(1.-db)*0.6);float gb=fb*(1.-((1.-eb)*0.5));float hb=-0.03+gb*1.73;float ib=clamp(hb,0.0,1.0);vec2 jb=vec2(ib*u_iridescenceRepeat,0.5);vec3 kb=texture2D(t_1,jb).rgb;kb=A(kb);vec4 lb=texture2D(t_1,f);float mb=(cb*lb.r)*u_jellyfishDisplacementSize;vec2 nb=(J-m*0.5)/min(m.x,m.y);vec2 ob=H+vec2(-1.0,1.0)*nb;vec2 pb=-u_jellyfishScale+ob*2.*u_jellyfishScale;float qb=length(pb)*2.0-1.0;float rb=clamp(mb+(1.-qb),0.0,1.0);float sb=(1.-ib)*u_iridescenceOpacity;float tb=ufrag_9*rb*u_jellyfishOpacity;float ub=mix(sb,tb,tb);vec3 vb=C(mix(Y,kb,ub));return vec4(vb,1.0);}float wb(float q){return clamp(q,0.0,1.0);}vec4 xb(vec4 B,vec3 yb){return vec4(pow(B.rgb,yb),B.a);}float zb(float Ab,float Bb){return sin(Ab*3.0+Bb)+0.9*sin(Ab*5.0-Bb*7.0)+0.5*sin(Ab*7.0+Bb*3.0)+0.2*sin(Ab*9.0+Bb*5.0);}vec4 Cb(vec2 Db,vec2 m){vec4 Eb=ufrag_10;vec4 N=ufrag_11;vec4 Q=ufrag_12;vec4 U=ufrag_13;vec2 Fb=Db/m;return mix(mix(Eb,N,Fb.x),mix(Q,U,Fb.x),Fb.y);}float Gb(vec2 Db,vec2 Hb,float Ib,float Jb){vec2 Kb=(Db-Hb)/Ib;return smoothstep(1.0,0.0,length(Kb));}float Lb(vec2 Db,vec2 m,float Mb,float Nb){float Ob=sqrt(Nb);vec2 Hb=mix(-m,2.0*m,Ob);const float Pb=3.0/8.0;float Jb=1.0-wb((Ob-Pb)/(1.0-Pb));return Gb(Db,Hb,Mb,Jb);}float Qb(vec2 Db,vec2 Hb,float Rb,float Sb,float Tb,float Ub,bool Vb){vec2 Kb=Db-Hb;float Ab=atan(Kb.x,Kb.y);float Wb=zb(Ab,Ub)*Rb*Tb;float Xb=(length(Kb)-Rb+Wb)/Sb;float Yb=Vb ? wb(Xb): abs(Xb);return smoothstep(1.0,0.0,Yb);}float Zb(vec2 Db,vec2 m,float Mb,float Nb,float Tb,float Ub){float Ob=sqrt(Nb);vec2 Hb=mix(-m*0.5,m*0.5,Ob);float Rb=mix(Mb*0.25,Mb,Ob);return Qb(Db,Hb,Rb,Mb*0.1,Tb,Ub,false)*(1.0-Ob)*0.5;}vec2 ac(vec2 Db,vec2 Hb,float bc){float cc=cos(bc);float dc=sin(bc);return(Db-Hb)*mat2(cc,-dc,dc,cc)+Hb;}vec4 ec(vec4 a,vec4 b){vec4 fc=vec4(1.0)-a;vec4 gc=vec4(1.0)-b;return vec4(a.r < 0.5 ? 2.0*a.r*b.r : 1.0-2.0*fc.r*gc.r,a.g < 0.5 ? 2.0*a.g*b.g : 1.0-2.0*fc.g*gc.g,a.b < 0.5 ? 2.0*a.b*b.b : 1.0-2.0*fc.b*gc.b,1.0);}vec4 hc(vec2 Db,vec2 m,vec4 ic,float jc,float kc,float lc,vec2 mc){float Mb=length(m);vec4 nc=Cb(Db,m);float oc=Lb(Db,m,Mb,jc);float pc=Zb(Db,m,Mb,jc,0.02,jc*3.0);vec4 qc=nc*oc*0.7+pc*0.5;float rc=sqrt(lc);float sc=Mb*0.25;float tc=lc > 0.0 ? Qb(Db,mc,rc*sc,Mb*0.06,0.05,lc,false)*(1.0-lc): 0.0;vec4 uc=vec4(0.25)*tc;vec4 vc=ic*kc;vc=qc+vc*(1.0-qc.a);vc=uc+vc*(1.0-uc.a);return clamp(vc,0.0,1.0);}vec4 wc(vec2 Db,vec2 m,vec4 ic,float jc,float I,float xc,float yc,vec2 zc){float Mb=length(m);vec4 nc=Cb(ac(Db,m*0.5,-I),m);float oc=Lb(Db,m,Mb,jc);float Ac=Mb*0.2;float Bc=Mb*0.5+Ac*2.0;float Cc=Qb(Db,m*0.5,yc*Bc-Ac,Ac,yc*0.05,I,true);vec4 vc=ic*wb(xc-Cc);if(ufrag_14==1){vec4 Dc=texture2D(t_2,Db/m);vc=mix(vc,Dc,oc);}else{vc=mix(vc,ic,oc);}float Ec=ufrag_15;if(ufrag_17==1){vec2 Fc=Db/m;if(ufrag_18==1){Fc.y=1.0-Fc.y;}vec4 Gc=texture2D(t_3,Fc);float Hc=Qb(Db,m*0.5,Ec*Bc-Ac,Ac,Ec*0.05,I,true);vc=mix(vc,Gc,1.0-Hc);}float Ic=ufrag_16;if(Ec > 0.0){float Jc=Ac*0.2+Ac*0.4*Ec;float Kc=Qb(Db,m*0.5,Ec*Bc-Jc,Jc,Ec*0.05,I,false);vec4 Dc=texture2D(t_2,Db/m);vc=mix(vc,Dc,Kc*sqrt(Ec)*Ic);}return vc;}vec4 Lc(vec2 Db,vec2 m,float Jb){float Mb=length(m);vec4 nc=Cb(Db,m);return nc*Jb;}void main(){vec2 m=ufrag_0;int Mc=ufrag_1;float I=ufrag_2;float Nc=ufrag_3;vec2 mc=ufrag_4;float Oc=ufrag_5;float xc=ufrag_6;float yc=ufrag_7;vec2 J=ufrag_8;vec2 Db=c*m;if(Mc==2){gl_FragColor=Lc(Db,m,xc);}else{vec4 ic=G();if(Mc==0){gl_FragColor=hc(Db,m,ic,Nc,xc,Oc,mc);}else if(Mc==1){gl_FragColor=wc(Db,m,ic,Nc,I,xc,yc,J);}}}",a:["a_v"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","u_motionRange","u_colorSize","u_speedRatio","u_Color","u_Color1","u_Color3","u_Color2","u_roseOffset","u_pinkOffset","u_greenOffset","u_iridescenceRepeat","u_iridescenceOpacity","u_jellyfishScale","u_jellyfishOpacity","u_jellyfishDisplacementSize","u_0","u_1","u_uvScale","u_offsetSpeedRatio","u_jellyfishDispScaleR","u_jellyfishDispacement"],s:["t_0","t_1","t_2","t_3"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p_11=void 0,t.p_11={v:"precision highp float;attribute vec2 a_v;varying vec2 c;void main(){vec2 u=a_v;gl_Position=vec4(u.x,-u.y,0.0,1.0);c=(vec2(u.x,-u.y)*0.5)+vec2(0.5,0.5);}",f:"precision highp float;uniform sampler2D t_0;varying vec2 c;uniform vec2 ufrag_0;uniform vec4 ufrag_1;const int d=3;const int e=d*2+1;const int f=e*e;void main(){vec2 h=ufrag_0;vec4 i=ufrag_1;vec4 j [ f ];vec2 k=h/float(d);for(int y=0;y < e;y++){for(int x=0;x < e;x++){vec2 l=vec2(float(x-d),float(y-d));j [ x+y*e ]=texture2D(t_0,clamp(c+k*l,0.0,1.0));}}float m=float(f);vec4 n=j [ 0 ];for(int o=0;o < f;o++){float p=0.0;float q=dot(j [ o ],i);for(int s=0;s < f;s++){float t=dot(j [ s ],i);p+=sign(t-q);}p=abs(p);if(p < m){m=p;n=j [ o ];}}gl_FragColor=n;}",a:["a_v"],u:["ufrag_0","ufrag_1"],s:["t_0"]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allocateAndCopyTypedBuffer=n;var i=r(62);function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;switch(e){case 3:var n=(ArrayBuffer,new Int8Array(t));return i&&n.set(new Int8Array(i)),n;case 0:var a=(ArrayBuffer,new Uint8Array(t));return i&&a.set(new Uint8Array(i)),a;case 4:var o=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return i&&o.set(new Int16Array(i)),o;case 5:case 8:case 9:case 10:case 2:var s=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return i&&s.set(new Uint16Array(i)),s;case 6:var l=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return i&&l.set(new Int32Array(i)),l;case 7:case 11:case 12:case 13:case 14:case 15:var c=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return i&&c.set(new Uint32Array(i)),c;case 1:var u=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return i&&u.set(new Float32Array(i)),u}var d=(ArrayBuffer,new Uint8Array(t));return i&&d.set(new Uint8Array(i)),d}i.ThinEngine.prototype._readTexturePixelsSync=function(e,t,r){var i,a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=this._gl;if(!f)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){var m=f.createFramebuffer();if(!m)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=m}f.bindFramebuffer(f.FRAMEBUFFER,this._dummyFramebuffer),o>-1?f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+o,null===(i=e._hardwareTexture)||void 0===i?void 0:i.underlyingResource,s):f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,null===(a=e._hardwareTexture)||void 0===a?void 0:a.underlyingResource,s);var p=void 0!==e.type?this._getWebGLTextureType(e.type):f.UNSIGNED_BYTE;if(u)l||(l=n(e.type,4*t*r));else switch(p){case f.UNSIGNED_BYTE:l||(l=new Uint8Array(4*t*r)),p=f.UNSIGNED_BYTE;break;default:l||(l=new Float32Array(4*t*r)),p=f.FLOAT}return c&&this.flushFramebuffer(),f.readPixels(d,h,t,r,f.RGBA,p,l),f.bindFramebuffer(f.FRAMEBUFFER,this._currentFramebuffer),l},i.ThinEngine.prototype._readTexturePixels=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return Promise.resolve(this._readTexturePixelsSync(e,t,r,i,n,a,o,s,l,c))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDebugStringProvider=function(){return new i.DebugStringProvider};var i=r(101)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMorphPlayer=function(){return new i.MorphPlayer};var i=r(140)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(e)},t.createWebGLRenderer=a,t.createSVGRenderer=function(e){return new n.SVGRenderer(e.canvas)};var i=r(265),n=r(142);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new i.DuckRenderer(e)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getLogicalSourceBounds=H,t.DuckRenderer=t.DuckItemRenderData=void 0;var n=i(r(6)),a=i(r(18)),o=i(r(7)),s=i(r(1)),l=i(r(2)),c=r(36),u=r(12),d=r(130),h=r(39),f=r(16),m=r(27),p=r(104),g=r(85),v=r(30),y=r(51),_=r(38),S=r(63),T=r(89),b=r(141),C=r(266),w=r(267),P=r(140),I=r(64),k=r(269),E=r(133),x=r(13),L=r(50),A=r(129),M=r(41);function R(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var D={itemHit:void 0,itemStack:void 0,textHit:void 0},F=0,B=(0,l.default)((function e(t){(0,s.default)(this,e),this.cache=new w.ItemCacheGL,this.isGroup=t}),[{key:"releaseGeneratedResources",value:function(){this.cache.releaseGeneratedResources()}},{key:"onFinalization",value:function(){if(c.s_finalizerWarningsEnabled&&!this.cache.isBlankSlate){var e,t=0,r=0,i=R(this.cache.getFulltextureList());try{for(i.s();!(e=i.n()).done;){var n=e.value;n&&n.releasePolicy!=_.TextureReleasePolicy.ExternallyManaged&&(t++,r+=n.memoryUsage)}}catch(e){i.e(e)}finally{i.f()}var a=c.s_finalizerWarningsInfoPath?G(this.cache.clientData,c.s_finalizerWarningsInfoPath):"";x.Log.Error(529096734,"Generated resources not released on ".concat(this.isGroup?"Group":"Shape"," ").concat(a,", leaking ").concat(Math.ceil(r/1e4)/100,"MB on ").concat(t," textures"))}c.s_finalizerCleanupEnabled&&this.releaseGeneratedResources()}}]);t.DuckItemRenderData=B;var N=(0,l.default)((function e(){(0,s.default)(this,e),this.index=0}),[{key:"color",get:function(){var e=this.index%256,t=(this.index-e)/256%256,r=(this.index-e-256*t)/65536%256;return new f.Color(e/255,t/255,r/255,1)}},{key:"next",value:function(){this.index++}}]),V=(0,l.default)((function e(t,r,i,n){var a,o;(0,s.default)(this,e),this.scene3D=null!==(a=null==t?void 0:t.scene3D)&&void 0!==a?a:r.scene3D;var l=null!==(o=null==t?void 0:t.fade)&&void 0!==o?o:r.fade;if(l){if(this.fade=l.clone(),l.isDistributedByLength&&null!=t&&t.drawDistribution&&n+1<t.drawDistribution.length){var c=t.drawDistribution[n],d=t.drawDistribution[n+1];this.fade.progress=(l.progress-c)/(d-c)}else l.isDistributedByLength&&t&&x.Log.Error(592525086,"Unable to distribute by length"),this.fade.progress=l.progress;if(r.getType()==v.ItemType.group&&l.isDistributedByLength){if(!i.cache.drawDistribution){var h=0,f=function(e){var t,r=R(e.paths||[]);try{for(r.s();!(t=r.n()).done;){var i=t.value;h+=i.measureLength(u.Matrix3.FromTransforms(i.transform,e.transform))}}catch(e){r.e(e)}finally{r.f()}return!0};(0,v.forEachShape)(r,f);var m=h,p=0,g=r;i.cache.drawDistribution=[];for(var y=0;y<g.items.length;y++)i.cache.drawDistribution.push(p/m),h=0,(0,v.forEachShape)(g.items.getAt(y),f),p+=h;i.cache.drawDistribution.push(1)}this.drawDistribution=i.cache.drawDistribution}}})),U=1,W=function(){return(0,l.default)((function e(t){(0,s.default)(this,e),this.m_babylonWipeStateBetweenScopes=!0,this.m_babylonDisableParallelShaderCompile=!1,this.m_currentFramePerformanceSummary=new y.FramePerformanceSummary,this.m_textureManager=new _.TextureManager,this.m_glyphCachePreviouslyFailed=!1,this.m_verboseRenderLogging=!1,this.fixedMemoryLeakAmounts=new y.FixedMemoryLeakAmounts,this.m_babylonWipeStateBetweenScopes=!t.stateRestorer,this.m_babylonDisableParallelShaderCompile=1==t.babylonDisableParallelShaderCompile,this.m_stateRestorer=t.stateRestorer,this.m_morphPlayer=t.morphPlayer,this.m_debugStringProvider=t.debugStringProvider,this.m_perfSummary=new y.ScenePerformanceSummary,this.m_rendererId=""+U++}),[{key:"getMaxSupportedTextureSize",value:function(){var e=this.m_graphicsProcessor;return e?e.maxSupportedTextureSize:(x.Log.Error(507012247,"glContext must be provided"),0)}},{key:"getTextureManager",value:function(){return this.m_textureManager}},{key:"hasMorphPlayer",value:function(){return!!this.m_morphPlayer}},{key:"setMorphPlayer",value:function(e){this.m_morphPlayer=e}},{key:"hasDebugStringProvider",value:function(){return!!this.m_debugStringProvider}},{key:"setDebugStringProvider",value:function(e){this.m_debugStringProvider=e}},{key:"initializeAsync",value:(e=(0,o.default)(n.default.mark((function e(t,r){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setWebGLContextOrBabylonEngine(t),this.m_graphicsProcessor){e.next=3;break}throw x.Log.Error(592328459,"Failed to initialize graphics processor.");case 3:return e.next=5,this.m_graphicsProcessor.initializeProgramsAsync(r?r.programIds:void 0);case 5:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"setBabylonEngine",value:function(e){this.setWebGLContextOrBabylonEngine(e)}},{key:"setWebGLContext",value:function(e){this.setWebGLContextOrBabylonEngine(e)}},{key:"setWebGLContextOrBabylonEngine",value:function(e){var t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;this.m_graphicsProcessor&&!this.m_graphicsProcessor.isCurrentWebGLContext(t)&&this.onWebGLContextLost(),this.m_graphicsProcessor?this.m_graphicsProcessor.setWebGLContextOrBabylonEngine(e):this.m_graphicsProcessor=new E.GraphicsProcessor(e,this.m_babylonWipeStateBetweenScopes,this.m_babylonDisableParallelShaderCompile,this.m_stateRestorer)}},{key:"onWebGLContextLost",value:function(){if(this.m_scratchBuffers){var e,t=R(this.m_scratchBuffers);try{for(t.s();!(e=t.n()).done;)e.value.release()}catch(e){t.e(e)}finally{t.f()}this.m_scratchBuffers=void 0}(0,b.clearGlyphCache)(),this.m_graphicsProcessor&&(this.m_graphicsProcessor.onWebGLContextLost(),this.m_graphicsProcessor=void 0)}},{key:"verifyGlyphCacheIntegrityAndTryRecover",value:function(){return!(0,b.verifyGlyphCacheIntegrity)()||(this.m_glyphCachePreviouslyFailed?(x.Log.Error(555782369,"GlyphCache failed for the second time: disable glyph cache"),(0,_.enableExperimentalGlyphTable)(!1)):this.m_glyphCachePreviouslyFailed=!0,(0,b.clearGlyphCache)(),!1)}},{key:"isValid",value:function(){return!!this.m_graphicsProcessor&&this.m_graphicsProcessor.isValid()}},{key:"getGraphicsProcessor",value:function(){return this.m_graphicsProcessor}},{key:"getBabylonEngine",value:function(){return this.m_graphicsProcessor?this.m_graphicsProcessor.getBabylonEngine():void 0}},{key:"getPerformanceSummary",value:function(){var e=function(e){if(e){var t=e;for(var r in t)r.endsWith("Ms")&&(t[r]=Y(t[r]))}};return this.m_perfSummary.averageFrameCost&&(this.m_perfSummary.averageFrameCost=Y(this.m_perfSummary.averageFrameCost)),e(this.m_perfSummary.perfInfoCurrentFrame),e(this.m_perfSummary.perfInfoFirstFrame),e(this.m_perfSummary.perfInfoSumOfAllFrames),this.m_perfSummary}},{key:"resetPerformanceSummary",value:function(){this.m_perfSummary=new y.ScenePerformanceSummary}},{key:"getCurrentFramePerformanceSummary",value:function(){return this.m_currentFramePerformanceSummary}},{key:"getDebugStringProvider",value:function(){return this.m_debugStringProvider}},{key:"ensureScratchBuffers",value:function(){if(!this.m_scratchBuffers){this.m_scratchBuffers=[];for(var e=0;e<_.scratchBufferCount;e++)this.m_scratchBuffers.push(new _.TargetTexture("ScratchBuffer",this,new u.Vector2(_.scratchBufferSize,_.scratchBufferSize),_.TextureReleasePolicy.KeepUntilRelease,{isMipMapped:!0}))}return this.m_scratchBuffers}},{key:"ensureRenderNode",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new B(e.getType()==v.ItemType.group),e.renderDataMap[this.m_rendererId]=t),t}},{key:"ensurePathRenderData",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new C.DuckPathRenderData,e.renderDataMap[this.m_rendererId]=t),t}},{key:"ensureImageRenderData",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new C.DuckImageRenderData,e.renderDataMap[this.m_rendererId]=t),t}},{key:"ensureMorphKeyFrameRenderData",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new P.DuckMorphKeyFrameRenderData,e.renderDataMap[this.m_rendererId]=t),t}},{key:"ensureMorphElementRenderData",value:function(e){var t=e.renderDataMap[this.m_rendererId];return t||(t=new P.DuckMorphElementRenderData,e.renderDataMap[this.m_rendererId]=t),t}},{key:"attachTextureToImage",value:function(e,t){var r=this.ensureImageRenderData(e);e.changeTracker.replaceListener(r.texture,t),r.texture=t}},{key:"attachLoaderToImage",value:function(e,t){var r=this.ensureImageRenderData(e);e.changeTracker.replaceListener(r.texture,t),r.loader=t}},{key:"getTextureFromImage",value:function(e){if(e){var t=this.ensureImageRenderData(e);return t.loader?(x.Log.Error(520663959,"getTextureFromImage may return the wrong wrap mode for ImageTextureLoader"),t.loader.getTexture(f.WrapMode.clamp)):t.texture}}},{key:"getTextureFromImageBrush",value:function(e){if(e.image){var t,r=this.ensureImageRenderData(e.image);return r.loader?r.loader.getTexture(null!==(t=e.wrapMode)&&void 0!==t?t:f.WrapMode.clamp):r.texture}}},{key:"deleteAllTextures",value:function(e){e.releaseGeneratedResources()}},{key:"tryGetImageDebugData",value:function(e){var t=this.ensureImageRenderData(e);return new C.ImageDebugData(t.state,t.texture)}},{key:"getDebugGlyphCacheInfo",value:function(e){return(0,b.getDebugGlyphCachePage)(e)}},{key:"generateTextureMemoryReport",value:function(e,t){var r,i={externalImages:0,managedImages:0,scratchBuffers:this.hasHitTestTexture()?4:0,glyphPages:0,shapeDistanceFields:0,textDistanceFields:0,otherBrushes:0,effects:0,rasterizedItems:0,fadeMasks:0,morphTextures:0,totalTarget:0,totalTargetExpected:this.getTextureManager().textureMemoryAllocated},n=R(this.m_scratchBuffers||[]);try{for(n.s();!(r=n.n()).done;){var a=r.value;i.scratchBuffers+=a.memoryUsage}}catch(e){n.e(e)}finally{n.f()}var o,s=R(b.s_glyphCacheTextures||[]);try{for(s.s();!(o=s.n()).done;){var l=o.value;i.glyphPages+=l.texture?l.texture.memoryUsage:0}}catch(e){s.e(e)}finally{s.f()}var c,u=R(e);try{for(u.s();!(c=u.n()).done;)q(this,c.value,i)}catch(e){u.e(e)}finally{u.f()}var d,h=R(t||[]);try{for(h.s();!(d=h.n()).done;)Z(this,d.value,i)}catch(e){h.e(e)}finally{h.f()}return i.totalTarget=i.scratchBuffers+i.glyphPages+i.shapeDistanceFields+i.textDistanceFields+i.otherBrushes+i.effects+i.rasterizedItems+i.fadeMasks+i.morphTextures,i}},{key:"initOutOfTime",value:function(){return this.m_initDeadline&&this.m_initDeadline<performance.now()}},{key:"updateSettingsBeforeRender",value:function(){var e=L.Settings.readNumberOrDefault("debugMode",-1);-1!=e&&(0,c.setDebugMode)(e);var t=L.Settings.readBooleanOrDefault("debugTextLines",!1);t&&(0,c.enableTextLinesDebugMode)(t);var r=L.Settings.readNumberOrDefault("quality",0);0!=r&&(0,_.setQuality)(r),L.Settings.readBooleanOrDefault("disableGlyphTable",!1)&&(0,_.enableExperimentalGlyphTable)(!1);var i=L.Settings.readNumberOrDefault("hitTestSlop",0);0!=i&&(0,c.setHitTestSlop)(i);var n=L.Settings.readNumberOrDefault("minLineWidth",0),a=L.Settings.readNumberOrDefault("minLineWidthForArrowHead",0);0==n&&0==a||(0,c.setMinLineWidth)(n||c.s_minLineWidth,a||c.s_minLineWidthForArrowHead);var o=L.Settings.readNumberOrDefault("hitTestCache",0);0!=o&&(0,c.setHitTestCache)(o);var s=L.Settings.readBooleanOrDefault("useLegacyBrightness",c.s_useLegacyBrightness);(0,c.setUseLegacyBrightness)(s);var l=L.Settings.readBooleanOrDefault("useLegacyContrast",c.s_useLegacyContrast);(0,c.setUseLegacyContrast)(l);var u=L.Settings.readNumberOrDefault("glyphCacheTextureResolution",0);0!=u&&(0,c.setGlyphCacheTextureResolution)(u);var d=L.Settings.readNumberOrDefault("glyphCacheMaxFactor",0);0!=d&&(0,c.setGlyphCacheMaxFactor)(d)}},{key:"fillRenderRectMap",value:function(e,t,r,i,n,a,o,s,l){for(var c=t.changeTracker.currentUniqueId+","+t.animationChangeTracker.currentUniqueId+","+a.index+(o?"+"+o:"")+(l?"*":""),d=t.instances?t.instances.length:1,h=0;h<d;h++){var f=t.instances?t.instances[h].transform.toMatrix3().multiply(i):i,m=t.instances?c+","+h:c;if(t instanceof v.Shape||t.effects.hasEffects){var p=t.getBounds(!s,!0,!0,f);if(t instanceof v.Shape&&t.style.pictureOverflow&&t.style.pictureBrush){var g=t.fillBoundsOverride?t.fillBoundsOverride:(0,v.getBoundsOfPaths)(t,!1,t.transform.toMatrix3()),y=this.getTextureFromImageBrush(t.style.pictureBrush);if(g&&y){var _=new u.Transform(g.center.negate(),u.Vector2.Flip(t.transform.scale.x<0,t.transform.scale.y<0),0,g.center),S=u.Matrix3.FromTransforms(_,f),b=t.animationTransform?u.Matrix3.FromTransforms(S,t.animationTransform):S,C=(0,T.getPictureOverflowBounds)(g,t.style.pictureBrush,y,b);C&&(p=u.Rect.UnionRect(p,C))}}s&&(p=p?p.transformedBounds(s):p),p=p?p.transformedBounds(n):p,(p=r?u.Rect.IntersectRect(r,p):p)&&(e[m]=p)}if(t instanceof v.Group){var w,P=(t.animationTransform||t.fade?t.animationChangeTracker.currentUniqueId:"")+":"+t.opacity+"/"+o,I=s||t.animationTransform,k=R(t.items.elements);try{for(k.s();!(w=k.n()).done;){var E=w.value;a.next(),this.fillRenderRectMap(e,E,r,t.transform.toMatrix3().multiply(f),n,a,P,I,l||t.isHidden)}}catch(e){k.e(e)}finally{k.f()}}}}},{key:"calculateDirtyRect",value:function(e,t){var r,i=function(i){var n=e[i],a=t[i];(0,u.equals)(n,a)||(r=u.Rect.UnionRect(r,n),r=u.Rect.UnionRect(r,a))};for(var n in e)i(n);for(var a in t)i(a);return r?r.inflate(2):void 0}},{key:"getLastRenderRectMap",value:function(){return this.m_lastRenderRectMap}},{key:"render",value:function(e,t,r,i){this.renderBatch([{item:e,eraseBackground:t,options:r}],i)}},{key:"renderBatch",value:function(e,t){var r;if(this.isValid()){this.m_lastRenderRectMap=void 0,this.m_verboseRenderLogging&&x.Log.Message(538208403,"RenderBatch begin");var i,n,a=null==t?void 0:t.enableDirtyRect,o=null==t?void 0:t.previousRenderRectMap,s=this.m_graphicsProcessor;if(s){this.updateSettingsBeforeRender();var l=performance.now();if(a){i={};var c,d=R(e);try{for(d.s();!(c=d.n()).done;){var h,m,p=c.value,g=new N;this.fillRenderRectMap(i,p.item,null===(h=p.options)||void 0===h?void 0:h.scissor,u.Matrix3.Identity,(null===(m=p.options)||void 0===m||null===(m=m.transform)||void 0===m?void 0:m.toMatrix3())||u.Matrix3.Identity,g,void 0,void 0,!1)}}catch(e){d.e(e)}finally{d.f()}o&&(n=this.calculateDirtyRect(o,i))}if(this.m_verboseRenderLogging&&x.Log.Message(525960788,"RenderBatch computed RenderRectMap"),s.beginRenderScope()){this.m_verboseRenderLogging&&x.Log.Message(538208404,"RenderBatch entered render scope");var S=new y.FramePerformanceSummary;S.glResetCostMs+=performance.now()-l,S.beginTime=(new Date).getTime(),this.m_currentFramePerformanceSummary=S,S.totalCostMs=-performance.now();var T,C=R(e);try{for(C.s();!(T=C.n()).done;){var w=T.value;this.tryPrepareItemInWebGlScope(w.item,s,!0,void 0)||x.Log.Error(592525120,"could not fully prepare scene")}}catch(e){C.e(e)}finally{C.f()}if(S.shapeRenderCostMs=-performance.now(),this.m_verboseRenderLogging&&x.Log.Message(538208405,"RenderBatch Items prepared"),n||!a||!o){var P,k=R(e);try{for(k.s();!(P=k.n()).done;){var E=P.value;this.renderItemInWebGLRenderScope(E.item,E.eraseBackground,E.options,n)}}catch(e){k.e(e)}finally{k.f()}}this.m_verboseRenderLogging&&x.Log.Message(538208406,"RenderBatch Items rendered");var A=e.length>0&&(null===(r=e[0].options)||void 0===r?void 0:r.target)instanceof _.TargetTexture?e[0].options.target.size:s.getCurrentViewportSize();if(b.s_drawDebugGlyphPage&&(0,b.drawDebugGlyphPage)(s,A),S.shapeRenderCostMs+=performance.now(),S.glRestoreCostMs=-performance.now(),n&&L.Settings.readBooleanOrDefault("debugDirtyRects",!1)){var M=v.Shape.CreateRectangle(n,new f.Style(new f.SolidBrush(new f.Color(Math.random(),Math.random(),Math.random(),.25))));this.renderItemInWebGLRenderScope(M,void 0)}if(s.endRenderScope(),S.glRestoreCostMs+=performance.now(),S.totalCostMs+=performance.now(),S.endTime=(new Date).getTime(),this.m_perfSummary.perfInfoCurrentFrame=S,this.m_perfSummary.perfInfoFirstFrame||(this.m_perfSummary.perfInfoFirstFrame=S),this.m_perfSummary.perfInfoSumOfAllFrames||(this.m_perfSummary.perfInfoSumOfAllFrames=new y.FramePerformanceSummary),this.m_perfSummary.perfInfoSumOfAllFrames.add(S),this.m_perfSummary.frameCount++,this.m_perfSummary.averageFrameCost=this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs/this.m_perfSummary.frameCount,this.m_perfSummary.viewWidth=A.x,this.m_perfSummary.viewHeight=A.y,this.m_perfSummary.frameCount>1){var O=(this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs-this.m_perfSummary.perfInfoFirstFrame.totalCostMs)/(this.m_perfSummary.frameCount-1);this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/O,60))}else this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/this.m_perfSummary.perfInfoCurrentFrame.shapeRenderCostMs,60));this.m_currentFramePerformanceSummary=new y.FramePerformanceSummary,I.DebugTool.OnRender(this,e),this.m_verboseRenderLogging&&x.Log.Message(538208407,"RenderBatch finished"),this.m_lastRenderRectMap=i}}else x.Log.Error(592525091,"glContext must be provided")}else x.Log.Message(512297154,"renderer context not valid in renderBatch")}},{key:"renderItemInWebGLRenderScope",value:function(e,t,r,i){var n=this.m_graphicsProcessor;if(n){n.updateViewportSize();var a=r?r.target:void 0,o=a?a.size:n.getCurrentViewportSize(),s=r?r.transform:void 0,l=null!=r&&r.scissor&&i?u.Rect.IntersectRect(null==r?void 0:r.scissor,i):(null==r?void 0:r.scissor)||i;if(!(null!=r&&r.scissor||i)||l){n.setScissorRect(null==l?void 0:l.inflateToInteger(),!0);var c=performance.now(),d=n.activateShaderProgram(M.ProgramId.shapeRender);if(this.isVerboseRenderLoggingEnabled()){var h=Y(performance.now()-c);x.Log.Message(529077967,"RenderBatch shapeRender shader activation cost ".concat(h,"ms"))}d.begin(a?a.tryGetBabylonTextureForRenderToTexture(n):void 0,t,!0),this.drawItem(v.EffectFlags.all,d,e,o,u.Matrix3.Identity,void 0,s?s.toMatrix3():u.Matrix3.Identity,0,void 0,!1,r,l,void 0),d.end(),n.setScissorRect(void 0)}}else x.Log.Error(592525121,"glContext must be provided")}},{key:"renderMorph",value:function(e,t,r,i,n){if(!this.m_morphPlayer)throw x.Log.Error(591667344,"Morph not available for this renderer");this.m_morphPlayer.renderMorph(this,e,t,r,i,n)}},{key:"tryPrepareMorph",value:function(e,t){if(!this.m_morphPlayer)throw x.Log.Error(591667345,"Morph not available for this renderer");return this.m_morphPlayer.tryPrepareMorph(this,e,t)}},{key:"tryGetImageDebugDataForMorphKeyFrame",value:function(e){var t=this.ensureMorphKeyFrameRenderData(e);return t.texture?new C.ImageDebugData(I.ImageContainerState.assigned,t.texture):void 0}},{key:"renderLayers",value:function(e,t,r){var i=this.m_graphicsProcessor;if(i){if(!i||i.beginRenderScope()){var n=this.m_targetTexture?this.m_targetTexture.size:i.getCurrentViewportSize(),a=i.activateShaderProgram(M.ProgramId.shapeRender);a.begin(this.m_targetTexture?this.m_targetTexture.tryGetBabylonTextureForRenderToTexture(i):void 0,t,!0),T.s_enableDepthBufferInMorph&&a.clearAndEnbaleDepthBuffer();for(var o=0;o<e.length;o++){var s=e[o];(0,T.drawLayer)(i,s,a,n,r?r.toMatrix3():void 0,void 0)}a.end(),i.endRenderScope()}}else x.Log.Error(592525125,"glContext must be provided")}},{key:"retrieveHitTestResult",value:function(e,t,r,i){if(t==r.index){var n={itemHit:e,itemStack:[e],textHit:void 0};if(e instanceof v.Shape){var a=e.text;if(a){var o=i.transformPoint(u.Matrix3.FromTransforms(new u.Transform(e.transform.translation.negate()),a.frameToShape.toInverseMatrix3(),a.layoutToFrame.toInverseMatrix3()));n.textHit=a.hitTest(o)?a.getSelectionFromLayoutPosition(o):void 0}}return n}if(e instanceof v.Group){var s,l=R(e.items.elements);try{for(l.s();!(s=l.n()).done;){var c=s.value;r.next();var d=this.retrieveHitTestResult(c,t,r,i.transformPoint(e.transform.toInverseMatrix3()));if(null!=d&&d.itemStack)return d.itemStack.splice(0,0,e),d}}catch(e){l.e(e)}finally{l.f()}}}},{key:"renderHitTestBuffer",value:function(e,t,r,i,n){var a=performance.now();this.m_hitTestCache=void 0;var o=this.m_graphicsProcessor;if(o){if(o.beginRenderScope()){this.tryPrepareItemInWebGlScope(e,o,!0,void 0)||x.Log.Error(592525131,"could not fully prepare"),this.m_hitTestTexture&&this.m_hitTestTexture.isValid(this)&&this.m_hitTestTexture.size.equals(r)||(this.m_hitTestTexture&&this.m_hitTestTexture.release(),this.m_hitTestTexture=new _.TargetTexture("HitTestPixel",this,r,_.TextureReleasePolicy.KeepUntilRelease));var s=new N,l=o.activateShaderProgram(M.ProgramId.shapeRender);l.begin(this.m_hitTestTexture.tryGetBabylonTextureForRenderToTexture(o),f.Color.Transparent,!0);var c=t.negate(),d=i?i.toMatrix3().multiply(u.Matrix3.Translation2D(c)):u.Matrix3.Translation2D(c);this.drawItem(v.EffectFlags.none,l,e,this.m_hitTestTexture.size,u.Matrix3.Identity,void 0,d,7,s,!1,{filter:n},void 0,void 0),l.end(),this.m_hitTestTexture.renderCost=performance.now()-a;var h=this.m_hitTestTexture.tryUseBabylonTargetTexture(o,void 0,"hitTest"),m=h?o.copyTexturePixelsToArray(h,new u.Rect(0,0,this.m_hitTestTexture.size.x,this.m_hitTestTexture.size.y),!0):void 0;o.endRenderScope(),m&&(this.m_hitTestCache={buffer:m,uniqueId:e.changeTracker.currentUniqueId,origin:t,renderTransform:i})}}else x.Log.Error(592525129,"glContext must be provided")}},{key:"isHitTestBufferValid",value:function(e,t,r,i,n){if(n||0==c.s_hitTestCache||!this.m_hitTestCache||this.m_hitTestCache.uniqueId!=e.changeTracker.currentUniqueId)return!1;if(!this.m_hitTestCache.renderTransform&&!i||this.m_hitTestCache.renderTransform&&i&&!this.m_hitTestCache.renderTransform.toMatrix3().equals(i.toMatrix3()))return!1;var a=this.m_hitTestCache.origin?new u.Rect(this.m_hitTestCache.origin.x,this.m_hitTestCache.origin.y,this.m_hitTestCache.origin.x+r.x-1,this.m_hitTestCache.origin.y+r.y-1):void 0;return!(!a||!a.isPointInRect(t))}},{key:"hitTestScene",value:function(e,t,r,i){if(!this.isValid())return x.Log.Message(512297153,"renderer context not valid in hitTestScene"),D;var n=c.s_hitTestCache&&!i?new u.Vector2(c.s_hitTestCache,c.s_hitTestCache):u.Vector2.One;if(!this.isHitTestBufferValid(e,t,n,r,i)){var a=t.floor().subtract(new u.Vector2(Math.floor(n.x/2),Math.floor(n.y/2)));this.renderHitTestBuffer(e,a,n,r,i)}if(!this.m_hitTestCache)return D;var o=t.subtract(this.m_hitTestCache.origin).floor(),s=4*(o.x+(n.y-1-o.y)*n.x);if(s<0||s+3>=this.m_hitTestCache.buffer.length||0==this.m_hitTestCache.buffer[s+3])return D;var l=this.m_hitTestCache.buffer[s+0]+256*this.m_hitTestCache.buffer[s+1]+65536*this.m_hitTestCache.buffer[s+2],d=new N,h=r instanceof u.Matrix3?r.tryGetTransform(u.Vector2.Zero):r,f=h?h.toInverseMatrix3():void 0;return this.retrieveHitTestResult(e,l,d,f?t.transformPoint(f):t)||(++F<=100&&x.Log.Error(592525132,"Unable to retrieve hit shape ".concat(l)),100==F&&x.Log.Error(520119570,"Hit test failed too many times, not reporting anymore"),D)}},{key:"hasHitTestTexture",value:function(){return null!=this.m_hitTestTexture}},{key:"tryInitTextures",value:function(e,t,r,i,n){if(t.isHidden)return!0;var a=this.ensureRenderNode(t);a.cache.beforeInitTextures(t,e);var o=new V(i,t,a,n),s=t instanceof v.Shape&&void 0!==t.shape3D;if(t instanceof v.Shape){var l=t;if(l.incrementalPath&&(a.cache.initTextureStage=w.InitTextureStage.fromBegining),a.cache.initTextureStage<w.InitTextureStage.distanceFieldsReady){if(l.incrementalPath)a.cache.distanceFields&&1==a.cache.distanceFields.length||(a.cache.distanceFields=[new b.DistanceField("DistanceField/incremental",this,void 0,m.PathFillMode.none,v.MergeMode.fragment,0,_.TextureReleasePolicy.DisposableCache,!1)]);else if(l.paths&&!a.cache.distanceFields&&!l.isSolidRect()){var c,d=-performance.now();if(a.cache.distanceFields=[],(null===(c=l.paths)||void 0===c?void 0:c.length)>0){for(var p=0,S=0,T=l.paths[0].fillMode,C=0;C<l.paths.length;C++){var P=C==l.paths.length-1,I=P?m.PathFillMode.none:l.paths[C+1].fillMode;(P||I!=T)&&(!l.style.hasLine||l.style.pen.headEnd.end==f.PenLineEnd.none&&l.style.pen.tailEnd.end==f.PenLineEnd.none?a.cache.distanceFields.push(new b.DistanceField("DistanceField/fillAndLine",this,h.TextRange.FromFirstLast(p,S),T,l.mergeMode,0,_.TextureReleasePolicy.DisposableCache,!1)):(T!=m.PathFillMode.none&&null!=l.style.fillBrush&&a.cache.distanceFields.push(new b.DistanceField("DistanceField/fillOnly",this,h.TextRange.FromFirstLast(p,S),T,l.mergeMode,1,_.TextureReleasePolicy.DisposableCache,!1)),a.cache.distanceFields.push(new b.DistanceField("DistanceField/arrowAndLine",this,h.TextRange.FromFirstLast(p,S),T,l.mergeMode,2,_.TextureReleasePolicy.DisposableCache,!1))),T=I,p=C+1),S=C+1}s&&a.cache.distanceFields.push(new b.DistanceField("DistanceField/displacement",this,void 0,T,l.mergeMode,0,_.TextureReleasePolicy.DisposableCache,!0))}if(d+=performance.now(),l.role==v.ShapeRole.text?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=d:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=d,this.initOutOfTime())return!1}var k,E=R(a.cache.distanceFields||[]);try{for(E.s();!(k=E.n()).done;){var L=k.value,O=-performance.now(),D=null!=l.incrementalPath,F=L.refresh(this,l,D);if(!F&&D&&(F=L.refresh(this,l,!1)),F||x.Log.Error(592525133,"error in distanceField refresh"),O+=performance.now(),l.role==v.ShapeRole.text?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=O:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=O,this.initOutOfTime())return!1}}catch(e){E.e(e)}finally{E.f()}a.cache.initTextureStage=w.InitTextureStage.distanceFieldsReady}if(a.cache.initTextureStage<w.InitTextureStage.brushTexturesReady||l.instances){if(a.cache.initBrushTexture(this,t,v.BrushSource.fill),this.initOutOfTime())return!1;if(a.cache.initBrushTexture(this,t,v.BrushSource.line),this.initOutOfTime())return!1;if(a.cache.initBrushTexture(this,t,v.BrushSource.picture),this.initOutOfTime())return!1;if(a.cache.initEchoBrushTextures(this,t),this.initOutOfTime())return!1;a.cache.initTextureStage=w.InitTextureStage.brushTexturesReady}if(l.text&&l.text.cache)if(l.text.renderMode==h.TextRenderMode.TextInFrontOfShape){var B,N=0,U=R(l.text.cache.textShapes||[]);try{for(U.s();!(B=U.n()).done;){var W=B.value;if(l.text.animationProps)if(W.textRange){var G=l.text.animationProps.getAt(W.textRange.start);W.fade=G.fade,W.animationTransform=G.animationTransform,W.isHidden=G.isHidden}else x.Log.Error(592525134,"no range");else W.fade=void 0,W.animationTransform=u.Matrix3.Identity,W.isHidden=!1;if(!this.tryInitTextures(e,W,r,o,N))return!1;N++}}catch(e){U.e(e)}finally{U.f()}var j,z=R(l.text.cache.selectionShapes||[]);try{for(z.s();!(j=z.n()).done;){var q=j.value;if(!this.tryInitTextures(e,q,r,o,0))return!1}}catch(e){z.e(e)}finally{z.f()}var Z,Y=R(l.text.cache.hitTestLineShapes||[]);try{for(Y.s();!(Z=Y.n()).done;){var J=Z.value;if(!this.tryInitTextures(e,J,r,o,0))return!1}}catch(e){Y.e(e)}finally{Y.f()}}else a.cache.initTextCutoutLayer(this,l.text.cache.cutoutLayerPaths,l)}else{if(!(t instanceof v.Group))throw x.Log.Error(592525135,"Unknown Item type");a.cache.initTextureStage<w.InitTextureStage.brushTexturesReady&&(a.cache.initBrushTexture(this,t,v.BrushSource.fill),a.cache.initTextureStage=w.InitTextureStage.brushTexturesReady);for(var K=t,Q=0;Q<K.items.length;Q++){var $=K.items.getAt(Q);if($&&!this.tryInitTextures(e,$,r,o,Q))return!1;if(this.initOutOfTime())return!1}}var ee=-performance.now();if(a.cache.fade=o.fade,a.cache.initFadeTexture(this,t,o.fade),ee+=performance.now(),t.fade&&(this.m_currentFramePerformanceSummary.fadeTextureCostMs+=ee),this.initOutOfTime())return!1;if(r&&a.cache.initTextureStage<w.InitTextureStage.effectsReady){if(t.effects){if(t.effects.innerShadow&&t.effects.innerShadow.color.a>0&&!a.cache.innerShadowTexture&&(a.cache.innerShadowTexture=this.createTextureRasterizedItem("Effect/InnerShadow",t,v.EffectFlags.none,a.cache.innerShadowTexture,f.Color.Black,t.effects.innerShadow.radius,v.EffectFlags.innerShadow,2,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.softEdges&&t.effects.softEdges.radius>0&&!a.cache.softEdgesTexture&&(a.cache.softEdgesTexture=this.createTextureRasterizedItem("Effect/SoftEdges",t,v.EffectFlags.none,a.cache.softEdgesTexture,f.Color.Black,t.effects.softEdges.radius,v.EffectFlags.softEdges,5,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.border&&t.effects.border.radius>0&&t.effects.border.color.a>0&&!a.cache.glowTexture&&(a.cache.borderTexture=this.createTextureRasterizedItem("Effect/Border",t,v.EffectFlags.softEdges,a.cache.borderTexture,t.effects.border.color,t.effects.border.radius,v.EffectFlags.border,4,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.replicate){if(!a.cache.replicateBottomTexture&&(a.cache.replicateBottomTexture=(0,A.createReplicateTexture)(this,t,t.effects.replicate,!1),this.initOutOfTime()))return!1;if(!a.cache.replicateTopTexture&&(a.cache.replicateTopTexture=(0,A.createReplicateTexture)(this,t,t.effects.replicate,!0),this.initOutOfTime()))return!1}if(t.effects.glow&&t.effects.glow.radius>0&&t.effects.glow.color.a>0&&!a.cache.glowTexture&&(a.cache.glowTexture=this.createTextureRasterizedItem("Effect/Glow",t,v.EffectFlags.softEdges|v.EffectFlags.border|v.EffectFlags.echo|v.EffectFlags.replicate,a.cache.glowTexture,t.effects.glow.color,2*t.effects.glow.radius,v.EffectFlags.glow,3,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.shadow&&t.effects.shadow.color.a>0&&!a.cache.shadowTexture&&(a.cache.shadowTexture=this.createTextureRasterizedItem("Effect/Shadow",t,v.EffectFlags.softEdges|v.EffectFlags.border|v.EffectFlags.echo|v.EffectFlags.replicate|v.EffectFlags.glow,a.cache.shadowTexture,t.effects.shadow.color,t.effects.shadow.radius,v.EffectFlags.shadow,6,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1;if(t.effects.reflection&&!a.cache.reflectionTexture&&(a.cache.reflectionTexture=this.createTextureRasterizedItem("Effect/Reflection",t,v.EffectFlags.innerShadow|v.EffectFlags.softEdges|v.EffectFlags.border|v.EffectFlags.echo|v.EffectFlags.replicate|v.EffectFlags.glow|v.EffectFlags.shadow,a.cache.reflectionTexture,void 0,t.effects.reflection.radius,v.EffectFlags.reflection,6,_.blurQuality,_.TextureReleasePolicy.DisposableCache),this.initOutOfTime()))return!1}a.cache.initTextureStage=w.InitTextureStage.effectsReady}if(r)if(s||t.fade&&t.fade.preset!=g.FadePreset.draw||t instanceof v.Group&&t.opacity<1){a.cache.spriteHitTest=s||void 0!==t.fade&&t.fade.preset!=g.FadePreset.draw;var te,re=t.animationTransform?t.animationTransform.transformVector(u.Vector2.One.scale(Math.sqrt(2)/2)).length():1,ie=Math.max(.1,_.distanceFieldQuality*re);if((!a.cache.spriteTexture||a.cache.spriteTexture.tag!=t.changeTracker.currentUniqueId||a.cache.spriteQuality<ie)&&(a.cache.spriteTexture&&(this.fixedMemoryLeakAmounts.recreatingSprites+=a.cache.spriteTexture.memoryUsage),null===(te=a.cache.spriteTexture)||void 0===te||te.release(),a.cache.spriteTexture=s?function(e,t,r,i){var n=e.getGraphicsProcessor();if(n){var a,o=e.ensureRenderNode(t),s=(0,v.getBoundsForEffects)(t,!0,v.EffectFlags.all,v.EffectFlags.all,t.transform.toInverseMatrix3().multiply(u.Matrix3.Scale2D(t.transform.scale))),l=H(t),c=e.createTextureRasterizedItem("RasterizeFor3D/Item",t,v.EffectFlags.innerShadow|v.EffectFlags.softEdges,o.cache.spriteTexture,void 0,0,v.EffectFlags.none,1,i,_.TextureReleasePolicy.DisposableCache),d=o.cache.glowTexture||o.cache.borderTexture||o.cache.shadowTexture||o.cache.reflectionTexture||o.cache.replicateBottomTexture?e.createTextureRasterizedItem("RasterizeFor3D/Effects",t,v.EffectFlags.all,o.cache.spriteTexture,void 0,0,v.EffectFlags.none,8,i,_.TextureReleasePolicy.DisposableCache):void 0,h=o.cache.getBevelDistanceField();if(s&&l&&c&&null!=h&&h.texture){var m=Math.min(i,_.distanceFieldMaxRes/s.size.x,_.distanceFieldMaxRes/s.size.y),p=new u.Vector2(Math.min(_.distanceFieldMaxRes,Math.ceil(s.size.x*m)),Math.min(_.distanceFieldMaxRes,Math.ceil(s.size.y*m)));(a=new _.TargetTexture("rasterized3D",e,p,_.TextureReleasePolicy.DisposableCache)).tag=t.changeTracker.currentUniqueId,a.contentLocation={logicalCenter:l.center.subtract(s.leftTop).scale(m),logicalSize:l.size.scale(m),physicalCenter:a.size.scale(.5),physicalSize:a.size,rotation:0,flipX:!1,flipY:!1};var g=a.tryGetBabylonTextureForRenderToTexture(n);if(g){var S,T=u.Vector2.Zero;t instanceof v.Shape&&t.shape3D&&t.shape3D.topBevel&&(S=function(e,t,r,i){function n(e,t,r){for(var i=Math.floor(t.x);i<=Math.floor(r.x);i++)i>=0&&i<e.length&&(e[i]=Math.max(e[i],t.y+(i-t.x)*(r.y-t.y)/(r.x-t.x)))}var a=new Array(t);a.fill(0),r.forEachSegment((function(e,t,r){if(t)for(var i=Math.max(8,r.x-e.x),o=0;o<i;o++)n(a,u.Vector2.InterpolateQuadratic(e,t,r,o/i),u.Vector2.InterpolateQuadratic(e,t,r,(o+1)/i));else n(a,e,r);return!0}),u.Matrix3.Scale2D(i));for(var o=new Float32Array(768),s=0;s<t;s++)o[3*s]=o[3*s+1]=o[3*s+2]=a[s];return _.Texture.CreateFromByteBuffer("PathProfile",e,new u.Vector2(t,1),o,y.TextureFormat.RGB,f.WrapMode.clamp,!0)}(e,256,t.shape3D.topBevel.profile,new u.Vector2(255,1)),T=t.shape3D.topBevel.size);var b=n.activateShaderProgram(M.ProgramId.draw3D);b.begin(g,f.Color.Transparent,!0),d&&X(n,b,d,void 0,void 0,a.size,a.contentLocation.logicalSize,a.contentLocation.logicalCenter,u.Vector2.Zero,0,void 0,void 0,f.Color.Transparent,0),X(n,b,c,h,S,a.size,a.contentLocation.logicalSize,a.contentLocation.logicalCenter,T,t instanceof v.Shape?t.style.pen.lineWidth:0,r,t instanceof v.Shape&&t.shape3D?t.shape3D.material:void 0,t instanceof v.Shape&&t.shape3D&&t.shape3D.contourColor?t.shape3D.contourColor:f.Color.Transparent,t instanceof v.Shape&&t.shape3D?t.shape3D.adjustedContourWidth:0),b.end(),S&&S.release()}else x.Log.Error(572867291,"failed to get textureTarget")}else x.Log.Error(572867292,"failed to get textures for 3D rendering");return c&&c.release(),d&&d.release(),a}x.Log.Error(572867290,"failed to get graphicsProcessor")}(this,t,o.scene3D,ie):this.createTextureRasterizedItem("SpriteCache",t,v.EffectFlags.all,a.cache.spriteTexture,void 0,0,v.EffectFlags.none,1,ie,_.TextureReleasePolicy.DisposableCache),a.cache.spriteTexture&&(a.cache.spriteTexture.tag=t.changeTracker.currentUniqueId,a.cache.spriteQuality=ie),this.initOutOfTime()))return!1}else{var ne;null===(ne=a.cache.spriteTexture)||void 0===ne||ne.release(),a.cache.spriteTexture=void 0,a.cache.spriteQuality=0,a.cache.spriteHitTest=!1}return!0}},{key:"tryPreparePaths",value:function(e){var t,r=R(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.ensurePathRenderData(i).refreshCachedTapeBuffers(i),this.initOutOfTime())return!1}}catch(e){r.e(e)}finally{r.f()}return!0}},{key:"tryPrepareGeneratedShapes",value:function(e){var t=this;return(0,v.forEachShape)(e,(function(e){return(0,v.ensureTextShapesGenerated)(e),!t.initOutOfTime()}))}},{key:"tryPrepareTapes",value:function(e){var t=this;return(0,v.forEachShape)(e,(function(e){if(e.paths){if(!t.tryPreparePaths(e.paths))return!1;if(e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version}),e.shapeBoundsCache.pathsBounds||e.style.hasLine||(e.shapeBoundsCache.pathsBounds=(0,p.tryGetQuickBoundsOfPaths)(e.paths)),t.initOutOfTime())return!1}return!0}))}},{key:"tryPrepareItemInWebGlScope",value:function(e,t,r,i){var n=performance.now();if(this.m_initDeadline=i?n+i:void 0,t){if(!t.tryPrepareProgramResourcesInWebGlScope(this.m_initDeadline))return!1}else(0,S.getMaxTapeFloatsOrThrow)();if(!this.tryPrepareGeneratedShapes(e))return!1;if(!this.tryPrepareTapes(e))return!1;if(t){var a=!1;return(0,b.initGlyphDistanceFieldCache)(this,e),this.initOutOfTime()||(a=this.tryInitTextures(t,e,r,void 0,0)),a}return!0}},{key:"tryPrepareItem",value:function(e,t,r){if(!this.isValid())return x.Log.Message(512297152,"renderer context not valid in tryPrepareItem"),!1;var i=this.m_graphicsProcessor;if(!i)return x.Log.Error(592525136,"glContext must be provided"),!1;if(this.updateSettingsBeforeRender(),!i.beginRenderScope())return!1;var n=this.tryPrepareItemInWebGlScope(e,i,t,r);return i.endRenderScope(),n}},{key:"drawItem",value:function(e,t,r,i,n,a,o,s,l,c,u,d,h){var f,m=R(r.instances||v.Instance.DefaultArray);try{for(m.s();!(f=m.n()).done;){var p=f.value,g=r;if(r instanceof v.Group&&void 0!==p.groupIndex&&r.items.length>0){var y=p.groupIndex;y>=0&&y<r.items.length?g=r.items.getAt(y):(g=void 0,x.Log.Error(509617671,"Instance index out of range: ".concat(y,", count: ").concat(r.items.length)))}if(g){var _,S,T,b,C,w,P,I,k,E=null!==(_=p.transform.toMatrix3().multiply(n))&&void 0!==_?_:n,L={opacity:null!==(S=null!==(T=p.opacity)&&void 0!==T?T:null==h?void 0:h.opacity)&&void 0!==S?S:1,colorMatrix:null!==(b=null!==(C=p.colorMatrix)&&void 0!==C?C:null==h?void 0:h.colorMatrix)&&void 0!==b?b:void 0,colorOffset:null!==(w=null!==(P=p.colorOffset)&&void 0!==P?P:null==h?void 0:h.colorOffset)&&void 0!==w?w:void 0,colorize:null!==(I=null!==(k=p.colorize)&&void 0!==k?k:null==h?void 0:h.colorize)&&void 0!==I?I:void 0};this.drawItemOnce(e,t,g,i,E,a,o,s,l,c,u,d,L)}}}catch(e){m.e(e)}finally{m.f()}}},{key:"drawItemOnce",value:function(e,t,r,i,n,a,o,s,l,d,f,m,p){var g,y,S,b,C=0==s||7==s,w=a||r.animationTransform,P=r instanceof v.Shape?r.role==v.ShapeRole.text?"text":"shape":"group",I=C&&w?n.multiply(w.multiply(o)):n.multiply(o);if(!this.m_graphicsProcessor||9==s||7==s&&r.isHitTestHidden||r.isHidden||f&&f.filter&&!f.filter(r)||r instanceof v.Group&&0==r.opacity){if(r instanceof v.Group){var E,L=R(r.items.elements);try{for(L.s();!(E=L.n()).done;){var A=E.value;l&&l.next(),this.drawItem(v.EffectFlags.all,t,A,i,n,a,o,9,l,d,f,m,p)}}catch(e){L.e(e)}finally{L.f()}}}else{this.m_graphicsProcessor.setScissorRect(null==m?void 0:m.inflateToInteger(),!0);var M,O=this.ensureRenderNode(r),D=null===(g=O.cache)||void 0===g?void 0:g.fade,F=null!==(y=null===(S=O.cache)||void 0===S?void 0:S.fadeMode)&&void 0!==y?y:0,B=7==s?1:(null!==(b=null==p?void 0:p.opacity)&&void 0!==b?b:1)*(r instanceof v.Group?r.opacity:1),N=H(r),V=!1;if(r instanceof v.Shape&&r.clipBounds&&N&&(V=!(M=(M=(M=(M=r.getBounds())?M.transformedBounds(r.transform.toInverseMatrix3()):void 0)?r.clipBounds.clip(M):void 0)?M.translate(N.center.negate()).multiply(r.transform.scale):void 0)),C&&O.cache.spriteTexture&&(7!=s||O.cache.spriteHitTest)){if(N&&!V){var U=new T.SpriteLayer(O.cache.spriteTexture,(0,_.transformedRectLocation)(N,r.transform));U.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,U.localClipRect=M,U.clientObject=O.cache,U.overallOpacity=B,U.colorMatrix=null==p?void 0:p.colorMatrix,U.colorOffset=null==p?void 0:p.colorOffset,U.colorize=null==p?void 0:p.colorize;var W=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,U,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"SpriteCache",W,U)}}else{var G=e!=v.EffectFlags.none&&r.effects&&(r.effects.glow||r.effects.shadow||r.effects.reflection||r.effects.echo||r.effects.replicate)&&c.debugMode==c.debug_OFF&&7!=s&&!(f&&f.textRange)&&N&&!V;if(G){var j,z=N.center.transformPoint(r.transform);if(e&v.EffectFlags.reflection&&r.effects.reflection||e&v.EffectFlags.shadow&&r.effects.shadow){var q=new u.Transform(z.negate(),u.Vector2.One,r.effects.direction,z);j=r.effectsBoundsOverride?r.effectsBoundsOverride.transformedBounds(q):(0,v.getBoundsForEffects)(r,!1,v.EffectFlags.none,v.EffectFlags.border|v.EffectFlags.glow,q.toMatrix3())}var Z=N?(0,_.transformedRectLocation)(N,r.transform):void 0,X=Z?new u.Transform(u.Vector2.Zero,u.Vector2.Flip(Z.flipX,Z.flipY),Z.rotation+r.effects.direction,Z.center):void 0,Y=X?X.toInverseMatrix3():void 0;if(e&v.EffectFlags.reflection&&r.effects.reflection&&O.cache.reflectionTexture&&j&&N&&Z&&X&&Y&&!V){var J=r.effects.reflection,K=j.bottom+J.distance/2;r instanceof v.Shape&&r.textEffectMetrics&&(K-=r.textEffectMetrics.descent);var Q=u.Matrix3.Translation2D(new u.Vector2(0,-K)).multiply(u.Matrix3.Scale2D(new u.Vector2(1,-1))).multiply(u.Matrix3.Translation2D(new u.Vector2(0,K))),$=new u.Vector2(j.center.x,K),ee=new u.Vector2(j.center.x,K+j.height),te={opacity0:J.startAlpha,opacity1:J.endAlpha,pos0:u.Vector2.InterpolateLinear($,ee,J.startPosition).transformPoint(Y),pos1:u.Vector2.InterpolateLinear($,ee,J.endPosition).transformPoint(Y)},re=new T.SpriteLayer(O.cache.reflectionTexture,Z);re.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,re.effectTransform=u.Matrix3.FromTransforms(X,Q,Y),re.localClipRect=M,re.reflectionGradient=te,re.clientObject=O.cache,re.overallOpacity=B,re.colorMatrix=null==p?void 0:p.colorMatrix,re.colorOffset=null==p?void 0:p.colorOffset,re.colorize=null==p?void 0:p.colorize;var ie=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,re,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"Reflection",ie,re)}if(e&v.EffectFlags.shadow&&r.effects.shadow&&O.cache.shadowTexture&&j&&N&&Z&&X&&Y&&!V){var ne=(0,v.getAlignmentPoint)(r.effects.shadow.alignment,j),ae=(0,v.getEffectTransformsMatrix)(r.effects.shadow.angle,r.effects.shadow.distance,r.effects.shadow.scale,r.effects.shadow.skew,ne),oe=new T.SpriteLayer(O.cache.shadowTexture,Z);oe.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,oe.effectTransform=u.Matrix3.FromTransforms(X,ae,Y),oe.localClipRect=M,oe.clientObject=O.cache,oe.overallOpacity=B,oe.colorMatrix=null==p?void 0:p.colorMatrix,oe.colorOffset=null==p?void 0:p.colorOffset,oe.colorize=null==p?void 0:p.colorize;var se=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,oe,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"Shadow",se,oe)}if(e&v.EffectFlags.glow&&r.effects.glow&&O.cache.glowTexture&&N&&Z&&X&&Y&&!V){var le,ce=this.getTextureFromImage(r.effects.glow.image);(le=ce?new T.SpriteLayer(ce,Z,void 0,O.cache.glowTexture):new T.SpriteLayer(O.cache.glowTexture,Z)).fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,le.localClipRect=M,le.clientObject=O.cache,le.overallOpacity=B,le.colorMatrix=null==p?void 0:p.colorMatrix,le.colorOffset=null==p?void 0:p.colorOffset,le.colorize=null==p?void 0:p.colorize,le.blendingMode=r.effects.glow.blendingMode;var ue=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,le,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"Glow",ue,le)}if(e&v.EffectFlags.border&&r.effects.border&&O.cache.borderTexture&&N&&Z&&!V){var de=new T.SpriteLayer(O.cache.borderTexture,Z);de.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,de.localClipRect=M,de.clientObject=O.cache,de.overallOpacity=B,de.colorMatrix=null==p?void 0:p.colorMatrix,de.colorOffset=null==p?void 0:p.colorOffset,de.colorize=null==p?void 0:p.colorize;var he=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,de,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"Border",he,de)}if(e&v.EffectFlags.replicate&&r.effects.replicate&&O.cache.replicateBottomTexture&&N&&Z&&!V){var fe=new T.SpriteLayer(O.cache.replicateBottomTexture,Z);fe.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,fe.localClipRect=M,fe.clientObject=O.cache,fe.overallOpacity=B,fe.colorMatrix=null==p?void 0:p.colorMatrix,fe.colorOffset=null==p?void 0:p.colorOffset,fe.colorize=null==p?void 0:p.colorize,fe.blendingMode=r.effects.replicate.blendingMode;var me=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,fe,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"ReplicateBottom",me,fe)}if(e&v.EffectFlags.echo&&r instanceof v.Shape&&r.effects.echo&&O.cache.echoStyleCache&&N&&Z&&X&&Y&&!V){if(r.effects.echo.instances.length!=O.cache.echoStyleCache.length)throw x.Log.Error(507338888,"echoStyleCache count mismatch");for(var pe,ge,ve,ye=r,_e=ye.isSolidRect()?[void 0]:O.cache.distanceFields,Se=null!==(pe=null!==(ge=null===(ve=r.effectsBoundsOverride)||void 0===ve?void 0:ve.center)&&void 0!==ge?ge:null==N?void 0:N.center.transformPoint(ye.transform))&&void 0!==pe?pe:u.Vector2.Zero,Te=r.effects.echo.instances.length-1;Te>=0;Te--){var be,Ce=r.effects.echo.instances.getAt(Te),we=O.cache.echoStyleCache[Te],Pe=u.Matrix3.FromTransforms(u.Matrix3.Translation2D(Se.negate()),Ce.transform,u.Matrix3.Translation2D(Se)),Ie=C&&w?Pe.multiply(n).multiply(w.multiply(o)):Pe.multiply(n).multiply(o),ke=R(_e||[]);try{for(ke.s();!(be=ke.n()).done;){var Ee=be.value;Ee&&Ee.isDisplacementMap||(0,k.drawShapeWithDistanceField)(this,O.cache,we,Ee,e,t,ye,Ce.style,i,Ie,s,l?l.color:void 0,M,B,null==p?void 0:p.colorMatrix,null==p?void 0:p.colorOffset,null==p?void 0:p.colorize)}}catch(e){ke.e(e)}finally{ke.f()}}}}if(8!=s)if(r.getType()==v.ItemType.shape){var xe=r;if(!(f&&f.textRange||V)){var Le,Ae=xe.isSolidRect()?[void 0]:O.cache.distanceFields,Me=C&&w?n.multiply(w.multiply(o)):n.multiply(o),Re=R(Ae||[]);try{for(Re.s();!(Le=Re.n()).done;){var Oe=Le.value;if(!Oe||!Oe.isDisplacementMap){var De=11==s||12==s||10==s;(0,k.drawShapeWithDistanceField)(this,O.cache,O.cache.styleCache,Oe,e,t,xe,xe.style,i,Me,s,l?l.color:void 0,M,B,null==p?void 0:p.colorMatrix,null==p?void 0:p.colorOffset,null==p?void 0:p.colorize,!(!xe.effects.replicate||(De?12!=s:1&xe.effects.replicate.mainFilter)),!(!xe.effects.replicate||(De?11!=s:2&xe.effects.replicate.mainFilter)))}}}catch(e){Re.e(e)}finally{Re.f()}}if(xe.text&&xe.text.cache&&(!f||!f.noSubtree||f.textRange)){var Fe=new u.Transform(u.Vector2.Zero,u.Vector2.One,xe.transform.rotation,xe.transform.translation),Be=c.s_isAnimationTransformAbsolute?Fe.toMatrix3().multiply(n):Fe.toMatrix3(),Ne=c.s_isAnimationTransformAbsolute&&!xe.text.animationProps?w:void 0,Ve=c.s_isAnimationTransformAbsolute?o:xe.text.hasAnimationProps()?n.multiply(o):I;if(l){var Ue,We=R(xe.text.cache.hitTestLineShapes||[]);try{for(We.s();!(Ue=We.n()).done;){var Ge=Ue.value;(!f||!f.textRange||Ge.textRange&&f.textRange.includes(Ge.textRange.start))&&this.drawItem(v.EffectFlags.all,t,Ge,i,Be,Ne,Ve,s,l,d,void 0,m,p)}}catch(e){We.e(e)}finally{We.f()}}else if(xe.text.renderMode==h.TextRenderMode.TextInFrontOfShape){var He,je=R(xe.text.cache.textShapes||[]);try{for(je.s();!(He=je.n()).done;){var ze=He.value;(!f||!f.textRange||ze.textRange&&f.textRange.includes(ze.textRange.start))&&this.drawItem(v.EffectFlags.all,t,ze,i,Be,Ne,Ve,s,l,d,void 0,m,p)}}catch(e){je.e(e)}finally{je.f()}if(0==s){var qe,Ze=R(xe.text.cache.selectionShapes||[]);try{for(Ze.s();!(qe=Ze.n()).done;){var Xe=qe.value;this.drawItem(v.EffectFlags.all,t,Xe,i,Be,Ne,Ve,s,l,d,void 0,m,p)}}catch(e){Ze.e(e)}finally{Ze.f()}}}}}else if(r.getType()==v.ItemType.group&&(!f||!f.noSubtree&&!f.textRange)){var Ye=r;if(Ye)for(var Je=0;Je<Ye.items.length;Je++){var Ke=Ye.items.getAt(Je);l&&l.next();var Qe=c.s_isAnimationTransformAbsolute?Ye.transform.toMatrix3().multiply(n):u.Matrix3.Identity,$e=c.s_isAnimationTransformAbsolute?w:void 0,et=c.s_isAnimationTransformAbsolute?o:Ye.transform.toMatrix3().multiply(I),tt=m,rt=!1;if(Ye.clipBounds){var it=m||new u.Rect(0,0,i.x,i.y),nt=$e?u.Matrix3.FromTransforms(Qe,$e,et):Qe.multiply(et),at=null==nt?void 0:nt.inverse(),ot=at?it.transformedBounds(at):void 0,st=ot?Ye.clipBounds.clip(ot):void 0,lt=null==st?void 0:st.transformedBounds(nt);rt=null==(tt=lt?u.Rect.IntersectRect(lt,it):void 0)}this.drawItem(v.EffectFlags.all,t,Ke,i,Qe,$e,et,rt?9:s,l,d,f,tt,p)}}if(G&&e&v.EffectFlags.replicate&&r.effects.replicate&&O.cache.replicateTopTexture&&N&&!V){var ct=N?(0,_.transformedRectLocation)(N,r.transform):void 0;if(ct){var ut=new T.SpriteLayer(O.cache.replicateTopTexture,ct);ut.fadeInfo=C&&D?{fade:D,fadeTexture:O.cache.fadeTexture,fadeMode:F}:void 0,ut.localClipRect=M,ut.clientObject=O.cache,ut.overallOpacity=B,ut.colorMatrix=null==p?void 0:p.colorMatrix,ut.colorOffset=null==p?void 0:p.colorOffset,ut.colorize=null==p?void 0:p.colorize,ut.blendingMode=r.effects.replicate.blendingMode;var dt=performance.now();(0,T.drawLayer)(this.m_graphicsProcessor,ut,t,i,I,l?l.color:void 0,s),this.onLayerRendered(P,"ReplicateTop",dt,ut)}}}this.m_graphicsProcessor.setScissorRect(void 0)}}},{key:"renderToTexture",value:function(e,t,r,i,n,a,o,s,l,c){n&&n.size.equals(a)||(n=new _.TargetTexture(e,this,a,l,{isMipMapped:c}));var d=t.activateShaderProgram(M.ProgramId.shapeRender);d.begin(n.tryGetBabylonTextureForRenderToTexture(t),f.Color.Transparent,!0);var h={noSubtree:(3==s||4==s)&&r instanceof v.Shape};return this.drawItemOnce(i,d,r,a,u.Matrix3.Identity,void 0,o.toMatrix3(),s,void 0,!1,h,void 0,void 0),d.end(),n}},{key:"drawTextureToTexture",value:function(e,t,r,i){var n=this.m_graphicsProcessor;if(!n)throw x.Log.Error(592525137,"No Graphics Processor");var a=r==_.DrawTextureMode.noFilter?M.ProgramId.copyTexture:r==_.DrawTextureMode.drawMask?M.ProgramId.copyTextureDrawMask:M.ProgramId.copyTexturePictureEffects,o=n.isInRenderScope();if(!o&&!n.beginRenderScope())throw x.Log.Error(591541203,"Failed to begin RenderScope");var s=n.activateShaderProgram(a);s.begin(e.tryGetBabylonTextureForRenderToTexture(n),f.Color.Transparent,!0),(0,_.drawTexture)(n,s,t,[new u.Rect(0,0,t.size.x,t.size.y)],[new u.Rect(0,0,e.size.x,e.size.y)],e.size,r,1,void 0,i),s.end(),o||n.endRenderScope()}},{key:"createTextureRasterizedItem",value:function(e,t,r,i,n,a,o,s,l,c){var d=this.m_graphicsProcessor;if(!d)throw x.Log.Error(591541204,"No Graphics Processor");l<=0&&x.Log.Error(509698625,"Quality is ".concat(l));var h=performance.now(),f=o!=v.EffectFlags.border&&a?l*Math.min(1,4/Math.sqrt(a)):l,m=!!(o&v.EffectFlags.reflection),p=!!(o&(v.EffectFlags.innerShadow|v.EffectFlags.softEdges)),g=!(t.getType()==v.ItemType.group&&t.isDocumentShape),y=m||g&&!p,S=(0,v.getBoundsForEffects)(t,y,r,v.EffectFlags.all,t.transform.toInverseMatrix3().multiply(u.Matrix3.Scale2D(t.transform.scale)));if(S){var b=(S=S.inflate(Math.max(2/f,a))).size,C=S.center.divide(t.transform.scale).transformPoint(t.transform);if(b&&C){var w=Math.min(f,_.scratchBufferSize/Math.max(b.x,b.y)),P=b.scale(w);if(P.isFinitePositive()){var I=0!=a||null!=n,k=new u.Vector2((0,u.clamp)(I?(0,u.getNearestPowerOfTwo)(P.x):P.x,16,_.scratchBufferSize),(0,u.clamp)(I?(0,u.getNearestPowerOfTwo)(P.y):P.y,16,_.scratchBufferSize)),E=Math.min(w,Math.min(k.x/b.x,k.y/b.y)),L=new u.Transform(C.negate(),new u.Vector2(E,E),-t.transform.rotation,new u.Vector2(k.x/2,k.y/2)),A=H(t);if(A){i=this.renderToTexture(e,d,t,r,i,k,L,s,c,o!=v.EffectFlags.border&&I),I&&(0,T.applyBlur)(this,i,a*E,o,n,this.ensureRenderNode(t).cache),i.contentLocation={logicalCenter:A.center.transformPoint(t.transform).transformPoint(L),logicalSize:A.size.multiply(t.transform.scale).scale(E),physicalCenter:i.size.scale(.5),physicalSize:b.scale(E),rotation:0,flipX:!1,flipY:!1};var M=performance.now()-h;return 6==s||3==s||4==s||2==s||5==s?this.m_currentFramePerformanceSummary.effectsCostMs+=M:1==s&&(this.m_currentFramePerformanceSummary.cacheToSpriteCostMs+=M),i.renderCost=M,i}}}}}},{key:"preCompileShaderAsync",value:function(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preCompileShaderAsync(e):x.Log.Error(592525138,"Graphics Processor not initialized")}},{key:"preLinkShaderAsync",value:function(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preLinkShaderAsync(e):x.Log.Error(592525139,"Graphics Processor not initialized")}},{key:"getDebugString",value:function(e){return this.m_debugStringProvider?e instanceof v.Item?this.m_debugStringProvider.getDebugStringForItem(e,this):e instanceof d.Morph?this.m_debugStringProvider.getDebugStringForMorph(e,this):"unsupported object":"no debug string provider"}},{key:"getTexturesUsedByObject",value:function(e,t){var r=this;if(e instanceof _.Texture&&t.push(e),e instanceof v.Item){var i=e.getBrushImages();t.push.apply(t,(0,a.default)(i.map((function(e){return r.ensureImageRenderData(e).texture})))),this.getTexturesUsedItemCacheGL(e,t)}if(e instanceof d.Morph){var n,o=R(e.elements);try{for(o.s();!(n=o.n()).done;){var s,l=R(n.value.keyFrames);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c){var u=this.ensureMorphKeyFrameRenderData(c);u.texture&&t.push(u.texture),u.textureDeltaWhite&&t.push(u.textureDeltaWhite),u.texturePicture&&t.push(u.texturePicture)}}}catch(e){l.e(e)}finally{l.f()}}}catch(e){o.e(e)}finally{o.f()}}}},{key:"getTexturesUsedItemCacheGL",value:function(e,t){var r=this.ensureRenderNode(e).cache;if(t.push.apply(t,(0,a.default)(r.getFulltextureList())),e instanceof v.Group){var i,n=R(e.items.elements);try{for(n.s();!(i=n.n()).done;){var o=i.value;this.getTexturesUsedItemCacheGL(o,t)}}catch(e){n.e(e)}finally{n.f()}}if(e instanceof v.Shape&&e.text&&e.text.cache){var s,l=R(e.text.cache.getTextShapes());try{for(l.s();!(s=l.n()).done;){var c=s.value;this.getTexturesUsedItemCacheGL(c,t)}}catch(e){l.e(e)}finally{l.f()}var u,d=R(e.text.cache.getSelectionShapes());try{for(d.s();!(u=d.n()).done;){var h=u.value;this.getTexturesUsedItemCacheGL(h,t)}}catch(e){d.e(e)}finally{d.f()}}}},{key:"getAllocatedTextures",value:function(e){var t,r=new Array,i=R(e||[]);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.getTexturesUsedByObject(n,r)}}catch(e){i.e(e)}finally{i.f()}return this.getTextureManager().allocatedTextures.filter((function(e){return!r.includes(e)}))}},{key:"getAllocatedTexturesDebugTable",value:function(e,t){var r,i=[],n=[" Valid"," Empty"," Sneaky"," WrongR"," WrongC"],a=["Keep","Dispose","External"],o=R(this.getAllocatedTextures(t));try{for(o.s();!(r=o.n()).done;){var s=r.value,l=s.lastUsage?performance.now()-s.lastUsage:void 0,c=s.lastRenderTime?performance.now()-s.lastRenderTime:void 0,u=s.scenario,d=n[s.getState(this)],h=a[s.releasePolicy],f=s.size.x,m=s.size.y,p=s.memoryUsage,g=s.renderCost,v="[ ";if(s.usageRecord.length>0)for(var y=0;y<s.usageRecord.length;y++){var _=s.usageRecord[y];v+=0==y?"":", ",v+='{"id":"'+G(_.clientObject,e)+'", "scenario":"'+_.lastScenario+'", "lastRead":'+(performance.now()-_.lastUsage)+"}"}v+="]",i.push({lastRead:l,lastWrite:c,scenario:u,state:d,policy:h,width:f,height:m,memory:p,cost:g,clients:v})}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"enableVerboseRenderLogging",value:function(e){this.m_verboseRenderLogging=e}},{key:"isVerboseRenderLoggingEnabled",value:function(){return this.m_verboseRenderLogging}},{key:"onLayerRendered",value:function(e,t,r,i){var n=Math.ceil(i.contentSize.x)*Math.ceil(i.contentSize.y);if(this.getCurrentFramePerformanceSummary().pixelCountShapeRender+=n,"text"==e&&this.getCurrentFramePerformanceSummary().shapeLayerCountText++,this.isVerboseRenderLoggingEnabled()){var a=Y(performance.now()-r);x.Log.Message(529077968,"RenderBatch ".concat(e," layer ").concat(t," rendered ").concat(n," pixels, cost ").concat(a,"ms"))}}},{key:"testRenderFidelity",value:function(){var e=new v.Shape([m.Path.CreateFromFigure(new m.Figure([0,10,1,10,0,1,10,10,1]))],new f.Style(new f.SolidBrush(f.Color.Blue))),t=new v.Shape([m.Path.CreateFromFigure(new m.Figure([0,0,1,0,10,1,10,10,1]))],new f.Style(new f.SolidBrush(f.Color.Red))),r=new v.Shape([m.Path.CreateFromFigure(new m.Figure([0,10,1,5,5,1,10,10,1]))],new f.Style(new f.SolidBrush(new f.Color(1,1,0,.5)))),i=new v.Group([e,t,r]),n=new _.TargetTexture("RenderTest",this,new u.Vector2(9,9),_.TextureReleasePolicy.KeepUntilRelease);this.render(i,f.Color.Green,{target:n});var a=n.tryConvertToBufferRGBA();n.release();var o=!0,s=[];if(a)for(var l=0,c=[{x:1,y:4,r:255,g:0,b:0,a:255,tolerence:1},{x:4,y:1,r:0,g:255,b:0,a:255,tolerence:1},{x:7,y:4,r:0,g:0,b:255,a:255,tolerence:1},{x:4,y:7,r:255,g:128,b:0,a:255,tolerence:2}];l<c.length;l++){var d=c[l],h=4*(d.x+9*(8-d.y));(Math.abs(a[h]-d.r)>d.tolerence||Math.abs(a[h+1]-d.g)>d.tolerence||Math.abs(a[h+2]-d.b)>d.tolerence||Math.abs(a[h+3]-d.a)>d.tolerence)&&(o=!1,s.push({expectedValues:d,actualValues:{r:a[h],g:a[h+1],b:a[h+2],a:a[h+3]}}))}return{fSucceeded:o,triangleTestDifferences:s}}},{key:"getWebGLState",value:function(){var e;return null===(e=this.m_graphicsProcessor)||void 0===e?void 0:e.getWebGLState()}}]);var e}();function G(e,t){if(e){var r,i=e&&e.constructor?e.constructor.name:void 0,n=e,a=R(t.split("."));try{for(a.s();!(r=a.n()).done;){var o=r.value;n=n?n[o]:void 0}}catch(e){a.e(e)}finally{a.f()}return(i||"")+(n?" "+n:"")}}function H(e){return e.getType()==v.ItemType.shape?(0,v.getBoundsOfPaths)(e,!1):(0,v.getBoundsForEffects)(e,!1,v.EffectFlags.none,v.EffectFlags.none,e.transform.toInverseMatrix3())}function j(e){return e?e.memoryUsage:0}function z(e,t){e&&(e instanceof _.TargetTexture&&e.tag?t.otherBrushes+=j(e):e.releasePolicy!=_.TextureReleasePolicy.ExternallyManaged?t.managedImages+=j(e):t.externalImages+=j(e))}function q(e,t,r){var i,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.ensureRenderNode(t);if(a.cache){var o,s=R(a.cache.distanceFields||[]);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.texture&&(n?r.textDistanceFields+=j(l.texture):r.shapeDistanceFields+=j(l.texture))}}catch(e){s.e(e)}finally{s.f()}z(a.cache.styleCache.resolvedFillTexture,r),z(a.cache.styleCache.resolvedLineTexture,r),z(a.cache.styleCache.resolvedPictureTexture,r);var c,u=R(a.cache.echoStyleCache);try{for(u.s();!(c=u.n()).done;){var d=c.value;z(d.resolvedFillTexture,r),z(d.resolvedLineTexture,r),z(d.resolvedPictureTexture,r)}}catch(e){u.e(e)}finally{u.f()}r.effects+=j(a.cache.innerShadowTexture),r.effects+=j(a.cache.softEdgesTexture),r.effects+=j(a.cache.glowTexture),r.effects+=j(a.cache.borderTexture),r.effects+=j(a.cache.shadowTexture),r.effects+=j(a.cache.reflectionTexture),r.effects+=j(a.cache.replicateBottomTexture),r.fadeMasks+=j(a.cache.fadeTexture),r.rasterizedItems+=j(a.cache.spriteTexture)}if(t instanceof v.Shape&&null!==(i=t.text)&&void 0!==i&&i.cache){var h=t.text.cache;h.textShapes.forEach((function(t){q(e,t,r,!0)})),h.hitTestLineShapes.forEach((function(t){q(e,t,r,!0)})),h.selectionShapes&&h.selectionShapes.forEach((function(t){q(e,t,r,!0)}))}t instanceof v.Group&&t.items.elements.forEach((function(t){q(e,t,r)}))}function Z(e,t,r){var i,n=R(t.elements);try{for(n.s();!(i=n.n()).done;){var a,o=R(i.value.keyFrames);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s){var l=e.ensureMorphKeyFrameRenderData(s);l.texture&&(r.morphTextures+=j(l.texture))}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}}function X(e,t,r,i,n,a,o,s,l,c,d,h,m,p){var g=i?i.texture:void 0,v=u.Matrix3.ScaleTranslation2D(a,a.scale(.5).subtract(s)),y=v,_=u.Matrix3.Translation2D(s),S=v.multiply((0,T.getTextureContentTransformUV)(r,o)),b=g?v.multiply((0,T.getTextureContentTransformUV)(g,o)):u.Matrix3.Identity,C=t.getBabylonEffect();C.setMatrix3x3("u_0",y.m),C.setMatrix3x3("u_1",_.m),C.setMatrix3x3("u_2",S.m),C.setMatrix3x3("u_3",b.m),C.setVector2("u_4",a),C.setInt("ufrag_0",i?1:0),C.setVector2("ufrag_1",i?i.size.inverse().scale(i.contentQuality):u.Vector2.Zero),C.setFloat("ufrag_2",i?2*i.distRangeSize:0),C.setFloat("ufrag_3",i?-i.distRangeSize+.5*c:0),C.setVector2("ufrag_4",l);var w=new Array(16);w.fill(0);var P=new Array(12);P.fill(0);var I=new Array(16);if(I.fill(0),d)for(var k=0;k<Math.min(d.lights.length,4);k++){var E=d.lights[k],x=Math.sqrt(E.direction.x*E.direction.x+E.direction.y*E.direction.y+E.direction.z*E.direction.z);w[4*k]=Math.abs(E.color.r),w[4*k+1]=Math.abs(E.color.g),w[4*k+2]=Math.abs(E.color.b),w[4*k+3]=Math.abs(E.color.a),P[3*k]=E.direction.x/x,P[3*k+1]=E.direction.y/x,P[3*k+2]=E.direction.z/x,I[4*k]=E.wrapScale,I[4*k+1]=E.wrapOffset,I[4*k+2]=E.diffuse,I[4*k+3]=E.specular}C.setDirectColor4("ufrag_5",d?d.ambientColor:f.Color.Black),C.setArray4("ufrag_6",w),C.setArray3("ufrag_7",P),C.setArray4("ufrag_8",I),C.setDirectColor4("ufrag_9",h?h.diffuseColor:f.Color.Black),C.setDirectColor4("ufrag_10",h?h.specularColor:f.Color.Black),C.setDirectColor4("ufrag_11",h?h.ambientColor:f.Color.Black),C.setDirectColor4("ufrag_12",h?h.emissiveColor:f.Color.Black),h?C.setFloat4("ufrag_13",h.specularPower,h.useBlinnHighlight?1:0,h.diffuseFresnel,h.alphaFresnel):C.setFloat4("ufrag_13",0,0,0,0),C.setInt("ufrag_14",h?h.materialType:0),C.setFloat("ufrag_15",p),C.setDirectColor4("ufrag_16",m);var L=_?_.transformVector(u.Vector2.One.scale(Math.sqrt(2)/2)).length():1;C.setFloat("ufrag_17",1/L),t.setTexture("t_0",r.tryUseBabylonTexture(e,void 0,"draw3D:T")),t.setTexture("t_1",g?g.tryUseBabylonTexture(e,void 0,"draw3D:D"):void 0),t.setTexture("t_2",n?n.tryUseBabylonTexture(e,void 0,"draw3D:P"):void 0),t.drawQuadInstances(1)}function Y(e){return Math.round(1e3*(e+100*Number.EPSILON))/1e3}t.DuckRenderer=W},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DuckImageRenderData=t.ImageDebugData=t.DuckPathRenderData=void 0;var n=i(r(1)),a=i(r(2)),o=r(111),s=r(63),l=r(38),c=r(64);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var d=(0,a.default)((function e(){(0,n.default)(this,e),this.m_compatibleGraphicsProcessorId=0}),[{key:"tapeBuffers",get:function(){return this.m_tapeBuffers}},{key:"hwTapeBuffers",get:function(){return this.m_hwTapeBuffers}},{key:"releaseGeneratedResources",value:function(){if(this.m_hwTapeBuffers&&this.m_engine){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this.m_hwTapeBuffers);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.m_engine._releaseBuffer(r)}}catch(e){t.e(e)}finally{t.f()}}this.m_hwTapeBuffers=void 0}},{key:"onFinalization",value:function(){}},{key:"refreshCachedTapeBuffers",value:function(e){return this.m_tapeBuffers||(this.m_tapeBuffers=(0,o.getTapeBuffersForPath)(e,(0,s.getMaxTapeFloatsOrThrow)()).buffers),this.m_tapeBuffers}},{key:"refreshCachedHwTapeBuffers",value:function(e,t){if(!this.m_hwTapeBuffers||!this.m_engine||this.m_compatibleGraphicsProcessorId!=t.getUniqueGraphicsProcessorId()){var r=(0,o.getTapeBuffersForPath)(e,(0,s.getMaxTapeFloatsOrThrow)(),!1,!1,void 0),i=t.getBabylonEngine();this.m_hwTapeBuffers=r.buffers.map((function(e){return i.createVertexBuffer(e)})),this.m_compatibleGraphicsProcessorId=t.getUniqueGraphicsProcessorId(),this.m_engine=t.getBabylonEngine()}return this.m_hwTapeBuffers}}]);t.DuckPathRenderData=d;var h=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.m_state=t,this.m_texture=r}),[{key:"getState",value:function(){return this.m_state}},{key:"getSize",value:function(){return this.m_texture?this.m_texture.size:void 0}},{key:"getLogicalCenter",value:function(){return this.m_texture&&this.m_texture.contentLocation?this.m_texture.contentLocation.logicalCenter:void 0}},{key:"tryConvertToBufferRGBA",value:function(){return this.m_texture instanceof l.TargetTexture?this.m_texture.tryConvertToBufferRGBA():void 0}}]);t.ImageDebugData=h;var f=(0,a.default)((function e(){(0,n.default)(this,e),this.m_state=c.ImageContainerState.uninitialized}),[{key:"releaseGeneratedResources",value:function(){this.m_texture&&(this.m_texture.release(),this.m_state=c.ImageContainerState.deleted)}},{key:"onFinalization",value:function(){}},{key:"texture",get:function(){return this.m_texture},set:function(e){this.m_loader&&(this.m_loader.release(),this.m_loader=void 0),this.m_texture=e,this.m_state=c.ImageContainerState.assigned}},{key:"loader",get:function(){return this.m_loader},set:function(e){this.m_texture&&(this.m_texture=void 0),this.m_loader&&this.m_loader!=e&&this.m_loader.release(),this.m_loader=e,this.m_state=c.ImageContainerState.assigned}},{key:"state",get:function(){return this.m_state}}]);t.DuckImageRenderData=f},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.createTextureFromLookupTable=T,t.ItemCacheGL=t.StyleCache=t.InitTextureStage=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(85),l=r(30),c=r(27),u=r(36),d=r(38),h=r(141),f=r(268),m=r(13),p=r(12),g=r(20);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.InitTextureStage=n,function(e){e[e.fromBegining=0]="fromBegining",e[e.distanceFieldsReady=1]="distanceFieldsReady",e[e.brushTexturesReady=2]="brushTexturesReady",e[e.fadeReady=3]="fadeReady",e[e.effectsReady=4]="effectsReady"}(n||(t.InitTextureStage=n={}));var _=(0,o.default)((function e(){(0,a.default)(this,e)}),[{key:"resolvedFillTexture",get:function(){var e;return this.fillTexture instanceof d.Texture?this.fillTexture:null===(e=this.fillTexture)||void 0===e?void 0:e.loader.getTexture(this.fillTexture.wrapMode)}},{key:"resolvedLineTexture",get:function(){var e;return this.lineTexture instanceof d.Texture?this.lineTexture:null===(e=this.lineTexture)||void 0===e?void 0:e.loader.getTexture(this.lineTexture.wrapMode)}},{key:"resolvedPictureTexture",get:function(){var e;return this.pictureTexture instanceof d.Texture?this.pictureTexture:null===(e=this.pictureTexture)||void 0===e?void 0:e.loader.getTexture(this.pictureTexture.wrapMode)}},{key:"clearTextures",value:function(){this.fillTexture instanceof d.Texture&&this.fillTexture.releasePolicy==d.TextureReleasePolicy.DisposableCache&&(this.fillTexture.release(),this.fillTexture=void 0),this.lineTexture instanceof d.Texture&&this.lineTexture.releasePolicy==d.TextureReleasePolicy.DisposableCache&&(this.lineTexture.release(),this.lineTexture=void 0),this.pictureTexture instanceof d.Texture&&this.pictureTexture.releasePolicy==d.TextureReleasePolicy.DisposableCache&&(this.pictureTexture.release(),this.pictureTexture=void 0)}},{key:"getBrushTexture",value:function(e){switch(e){case l.BrushSource.fill:return this.fillTexture;case l.BrushSource.line:return this.lineTexture;case l.BrushSource.picture:return this.pictureTexture}m.Log.Error(591192833,"Invalid brush source")}},{key:"setBrushTexture",value:function(e,t){switch(e){case l.BrushSource.fill:this.fillTexture=t;break;case l.BrushSource.line:this.lineTexture=t;break;case l.BrushSource.picture:this.pictureTexture=t;break;default:m.Log.Error(591192834,"Invalid brush source")}}}]);t.StyleCache=_;var S=(0,o.default)((function e(){(0,a.default)(this,e),this.initTextureStage=n.fromBegining,this.fadeMode=0,this.spriteQuality=0,this.spriteHitTest=!1,this.isBlankSlate=!1,this.styleCache=new _,this.echoStyleCache=[]}),[{key:"beforeInitTextures",value:function(e,t){if(this.isBlankSlate=!1,this.clientData=e.clientData,this.hasInvalidTexture(t)&&this.clearTextures(),this.checkDistanceFields(e),this.lastKnownShapeVersion==e.version&&e.alphaTracker.version==this.lastKnownAlphaVersion||(this.clearEffectsTextures(this.lastKnownShapeVersion!=e.version,e.alphaTracker.version!=this.lastKnownAlphaVersion),this.drawDistribution=void 0),this.lastKnownShapeVersion=e.version,this.lastKnownAlphaVersion=e.alphaTracker.version,e.getType()==l.ItemType.shape){var r=e;r.geometryTracker.version!=this.lastKnownGeometryVersion&&(this.initTextureStage=n.fromBegining,this.lastKnownGeometryVersion=r.geometryTracker.version)}}},{key:"getFulltextureList",value:function(){var e=[this.innerShadowTexture,this.softEdgesTexture,this.glowTexture,this.borderTexture,this.shadowTexture,this.reflectionTexture,this.replicateBottomTexture,this.replicateTopTexture,this.fadeTexture,this.spriteTexture];e.push.apply(e,[this.styleCache.resolvedFillTexture,this.styleCache.resolvedLineTexture,this.styleCache.resolvedPictureTexture]);var t,r=v(this.echoStyleCache);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.push.apply(e,[i.resolvedFillTexture,i.resolvedLineTexture,i.resolvedPictureTexture])}}catch(e){r.e(e)}finally{r.f()}var n,a=v(this.distanceFields||[]);try{for(a.s();!(n=a.n()).done;){var o=n.value;e.push(o.texture)}}catch(e){a.e(e)}finally{a.f()}return this.coutoutLayer&&e.push(this.coutoutLayer.texture),e}},{key:"getBevelDistanceField",value:function(){var e,t=v(this.distanceFields||[]);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.isDisplacementMap)return r}}catch(e){t.e(e)}finally{t.f()}}},{key:"hasInvalidTexture",value:function(e){var t,r=this.getFulltextureList(),i=v(this.distanceFields||[]);try{for(i.s();!(t=i.n()).done;){var n=t.value;r.push(n.texture)}}catch(e){i.e(e)}finally{i.f()}var a,o=v(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s&&!s.isValidForGraphicsProcessor(e))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"checkDistanceFields",value:function(e){if(e.getType()==l.ItemType.shape){var t=e;if(t.geometryTracker.version!=this.lastKnownGeometryVersion)return void this.clearTextures();var r,i=v(this.distanceFields||[]);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.geometryUniqueId!=t.geometryTracker.currentUniqueId||n.lastKnownQualitySetting!=d.distanceFieldQuality||n.lastKnownLineWidth!=t.style.pen.adjustedLineWidth||n.lastKnownLineWidthForArrowHead!=t.style.pen.adjustedLineWidthForArrowHead||n.lastKnownHitTestSlop!=u.s_hitTestSlop)return void this.clearTextures()}}catch(e){i.e(e)}finally{i.f()}}}},{key:"clearBounds",value:function(){this.initTextureStage=n.fromBegining}},{key:"clearEffectsTextures",value:function(e,t){this.initTextureStage=n.fromBegining,e&&(this.reflectionTexture&&this.reflectionTexture.release(),this.fadeTexture&&this.fadeTexture.release(),this.spriteTexture&&this.spriteTexture.release(),this.reflectionTexture=this.fadeTexture=this.spriteTexture=void 0),t&&(this.innerShadowTexture&&this.innerShadowTexture.release(),this.softEdgesTexture&&this.softEdgesTexture.release(),this.glowTexture&&this.glowTexture.release(),this.borderTexture&&this.borderTexture.release(),this.shadowTexture&&this.shadowTexture.release(),this.replicateBottomTexture&&this.replicateBottomTexture.release(),this.replicateTopTexture&&this.replicateTopTexture.release(),this.innerShadowTexture=this.softEdgesTexture=this.glowTexture=this.borderTexture=this.shadowTexture=this.replicateBottomTexture=this.replicateTopTexture=void 0)}},{key:"clearBrushTextures",value:function(){var e,t,r;this.styleCache.clearTextures();var i,n,a,o,s=v(this.echoStyleCache);try{for(s.s();!(i=s.n()).done;)i.value.clearTextures()}catch(e){s.e(e)}finally{s.f()}this.echoStyleCache=[],null!==(e=this.fillLookupTableCache)&&void 0!==e&&e.texture&&(null===(n=this.fillLookupTableCache)||void 0===n||n.texture.release(),this.fillLookupTableCache=void 0),null!==(t=this.lineLookupTableCache)&&void 0!==t&&t.texture&&(null===(a=this.lineLookupTableCache)||void 0===a||a.texture.release(),this.lineLookupTableCache=void 0),null!==(r=this.pictureLookupTableCache)&&void 0!==r&&r.texture&&(null===(o=this.pictureLookupTableCache)||void 0===o||o.texture.release(),this.pictureLookupTableCache=void 0)}},{key:"clearTextures",value:function(){this.initTextureStage=n.fromBegining;var e,t=v(this.distanceFields||[]);try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&r.texture&&r.texture.release()}}catch(e){t.e(e)}finally{t.f()}this.clearBrushTextures(),this.clearEffectsTextures(!0,!0),this.distanceFields=void 0}},{key:"releaseGeneratedResources",value:function(){var e;this.clearBounds(),this.clearTextures(),this.isBlankSlate=!0,this.coutoutLayer&&(null===(e=this.coutoutLayer.texture)||void 0===e||e.release(),this.coutoutLayer=void 0)}},{key:"initFadeTexture",value:function(e,t,r){if(e.getGraphicsProcessor()){var i=r?r.preset==s.FadePreset.draw?t.changeTracker.currentUniqueId:r.param+":"+r.preset:"";if(!this.fadeTexture||r&&r.preset!=s.FadePreset.uniform&&this.fadeTexture.isValid(e)&&this.fadeTexture.tag==i||(this.fadeTexture.release(),this.fadeTexture=void 0),!this.fadeTexture)if(t.getType()==l.ItemType.shape&&r&&r.preset==s.FadePreset.draw){var n=t,a=n.style.pictureBrush,o=a?e.getTextureFromImageBrush(a):void 0;if(a&&o){var u,m,g,v,y=d.TargetTexture.RecycleOrReplace("PictureDrawFade",void 0,e,o.size,d.TextureReleasePolicy.DisposableCache,{useFloat:!0});y.originalSize=o.originalSize;var _=(0,l.getAlignmentPoint)(a.alignment),S=new p.Transform(_.negate(),a.scale,0,_.add(a.offset)),T=new p.Transform(new p.Vector2(0,-1),new p.Vector2(1,-1)),b=p.Matrix3.FromTransforms(T,S.toInverseMatrix3(),T),C=null!==(u=null===(m=r.drawFadeOptions)||void 0===m?void 0:m.mode)&&void 0!==u?u:0,w=null!==(g=null===(v=r.drawFadeOptions)||void 0===v?void 0:v.order)&&void 0!==g?g:0,P=r.param,I=p.Vector2.Flip(r.flipX,r.flipY),k=r.transposeXY;e.drawTextureToTexture(y,o,d.DrawTextureMode.drawMask,{textureTransform:b,drawMaskParams:{drawMaskMode:C,drawMaskOrder:w,drawMaskParam:P,drawMaskFlipXY:I,drawMaskTransposeXY:k}}),this.fadeTexture=y,this.fadeMode=3}else if(n.paths&&n.paths.length>0){var E=new h.DistanceField("FadeMask/Draw",e,void 0,c.PathFillMode.normal,n.mergeMode,0,d.TextureReleasePolicy.DisposableCache,!1);E.generateDrawFadeMask=!0,E.refresh(e,n,!1),this.fadeTexture=E.texture,this.fadeMode=2}}else r&&r.preset!=s.FadePreset.uniform&&r.preset!=s.FadePreset.draw?(this.fadeTexture=(0,f.refreshFadeTexture)(e,this.fadeTexture,r.preset,r.param,i),this.fadeMode=2):this.fadeMode=r?1:0}}},{key:"initBrushTexture",value:function(e,t,r){var i=this.styleCache.getBrushTexture(r),n=(0,f.refreshBrushTexture)(e,i,t,r,-1);i!=n&&this.styleCache.setBrushTexture(r,n)}},{key:"initEchoBrushTextures",value:function(e,t){var r,i,n=(null===(r=t.effects.echo)||void 0===r?void 0:r.instances.length)||0;if(this.echoStyleCache.length!=(null===(i=t.effects.echo)||void 0===i?void 0:i.instances.length)){var a,o=v(this.echoStyleCache);try{for(o.s();!(a=o.n()).done;)a.value.clearTextures()}catch(e){o.e(e)}finally{o.f()}this.echoStyleCache=[];for(var s=0;s<n;s++)this.echoStyleCache.push(new _)}for(var c=0;c<n;c++)for(var u=0,d=[l.BrushSource.fill,l.BrushSource.line,l.BrushSource.picture];u<d.length;u++){var h=d[u],m=this.echoStyleCache[c].getBrushTexture(h),p=(0,f.refreshBrushTexture)(e,m,t,h,c);m!=p&&this.echoStyleCache[c].setBrushTexture(h,p)}}},{key:"initTextCutoutLayer",value:function(e,t,r){if(t){this.coutoutLayer=new h.DistanceField("TextCutoutLayer",e,void 0,c.PathFillMode.normal,l.MergeMode.fragment,0,d.TextureReleasePolicy.DisposableCache,!1),this.coutoutLayer.isGlyphCacheDisabled=!0;var i=new l.Shape(t,r.style);this.coutoutLayer.refresh(e,i,!1);var n=(0,l.getBoundsOfPaths)(i,!1);this.coutoutLayerCenter=null==n?void 0:n.center}else{var a;this.coutoutLayer&&(null===(a=this.coutoutLayer.texture)||void 0===a||a.release(),this.coutoutLayer=void 0)}}},{key:"updateLookupTableCache",value:function(e,t,r){var i=t;return t?t.texture&&(!r||!t.texture.isValid(e)||r&&t.lookupTable&&r!=t.lookupTable&&!r.equals(t.lookupTable))&&(t.texture.release(),t.texture=void 0):r&&(i={lookupTable:r}),i&&!i.texture&&r&&(i.texture=T(e,r,d.TextureReleasePolicy.DisposableCache)),i}},{key:"ensureLookupTableTexture",value:function(e,t,r){var i,n,a;switch(t){case l.BrushSource.fill:return this.fillLookupTableCache=this.updateLookupTableCache(e,this.fillLookupTableCache,r),null===(i=this.fillLookupTableCache)||void 0===i?void 0:i.texture;case l.BrushSource.line:return this.lineLookupTableCache=this.updateLookupTableCache(e,this.lineLookupTableCache,r),null===(n=this.lineLookupTableCache)||void 0===n?void 0:n.texture;case l.BrushSource.picture:return this.pictureLookupTableCache=this.updateLookupTableCache(e,this.pictureLookupTableCache,r),null===(a=this.pictureLookupTableCache)||void 0===a?void 0:a.texture}m.Log.Error(509728260,"Invalid brush source")}}]);function T(e,t,r){return d.Texture.CreateFromByteBuffer("LookupTable",e,t.resolution,t.table,g.TextureFormat.RGB,g.WrapMode.clamp,!0,!1,r,!1,1)}t.ItemCacheGL=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refreshBrushTexture=function(e,t,r,l,m){var p=e.getGraphicsProcessor();if(p){var y=t instanceof s.Texture&&!t.isValidForGraphicsProcessor(p),S=t,b=(0,a.GetBrush)(r,l,m);if(b){var C=b.getType();if(C==o.BrushType.image){var w=b;if(w.image){var P=b.wrapMode,I=void 0!==P?P:o.WrapMode.clamp,k=e.ensureImageRenderData(w.image);k.state==u.ImageContainerState.deleted?d.Log.Error(592472275,"Trying to use deleted texture id:".concat(w.image.id)):k.state==u.ImageContainerState.uninitialized&&d.Log.Error(592472276,"Trying to use uninitialized texture id:".concat(w.image.id));var E=k.texture,x=w.pictureEffects||(r instanceof a.Shape&&l==a.BrushSource.picture?r.style.pictureEffects:void 0);if(k.loader&&r instanceof a.Shape){var L,A,M,R=(0,a.getBoundsOfPaths)(r,!1,i.Matrix3.Scale2D(r.transform.scale.abs())),O=null!==(L=null==R?void 0:R.size.x)&&void 0!==L?L:0,D=null!==(A=null==R?void 0:R.size.y)&&void 0!==A?A:0,F=f(r.instances||[]);try{for(F.s();!(M=F.n()).done;){var B,N,V=M.value,U=(0,a.getBoundsOfPaths)(r,!1,V.transform.toMatrix3());O=Math.max(O,null!==(B=null==U?void 0:U.width)&&void 0!==B?B:0),D=Math.max(O,null!==(N=null==U?void 0:U.height)&&void 0!==N?N:0)}}catch(e){F.e(e)}finally{F.f()}O>0&&D>0&&k.loader.prepareForRenderSize(new i.Vector2(O,D)),S={loader:k.loader,wrapMode:I}}else!y&&t instanceof s.Texture&&(t==E||E&&t.tag==E.changeTracker.currentUniqueId)||(S=null!=x&&x.hasImpact||!E||E.wrapMode==I?E:E.cloneWithNewWrapMode("ImageWrapResample",e,I,s.TextureReleasePolicy.DisposableCache));if(null!=x&&x.hasImpact){var W,G=S instanceof s.Texture?S:null===(W=S)||void 0===W?void 0:W.loader.getTexture(S.wrapMode);if(G){var H=G.changeTracker.currentUniqueId+"/"+x.changeTracker.currentUniqueId+"/"+I;if(t instanceof s.Texture&&!y&&t.tag==H)S=t;else{var j,z=e.ensureRenderNode(r).cache.ensureLookupTableTexture(e,l,x.lookupTable),q=null!=x&&x.mask?e.getTextureFromImage(null==x||null===(j=x.mask)||void 0===j?void 0:j.mask):void 0;(S=T(e,t!=E&&t instanceof s.TargetTexture?t:void 0,G,x,I,z,q))&&(S.tag=H)}}}}else S=void 0}else if(C==o.BrushType.pattern){var Z=-performance.now();t&&!y&&t instanceof s.Texture&&t.tag==b.pattern||(S=_(e,b.pattern,s.TextureReleasePolicy.DisposableCache)),Z+=performance.now(),e.getCurrentFramePerformanceSummary().patternTextureCostMs+=Z}else if(o.Brush.IsGradient(C)){var X=-performance.now();if(C==o.BrushType.pathGradient){var Y=t instanceof s.TargetTexture?t:void 0;Y&&!y&&Y.tag==r.changeTracker.currentUniqueId||(r instanceof a.Shape?S=function(e,t,r,l,u){var m=e.getGraphicsProcessor();if(!m)throw d.Log.Error(592525324,"Graphics processor not initialized");if(l.getType()!=o.BrushType.pathGradient)throw d.Log.Error(592525325,"This is not a path gradient");var p=(0,a.getBoundsOfPaths)(r,!1);if(p&&!p.isEmpty()&&r.paths){var y=p.size.multiply(r.transform.scale.abs()),_=y.scale(Math.min(1,s.distanceFieldMaxRes/y.x,s.distanceFieldMaxRes/y.y)),S=new i.Vector2(Math.floor(_.x+1),Math.floor(_.y+1)),T=s.TargetTexture.RecycleOrReplace("PathGradient",t,e,S,u);return T.tag=r.changeTracker.currentUniqueId,function(e,t,r,a,s,l){var u=performance.now(),d=g(r),m=d.colors,p=d.colors.length<4?o.Color.Transparent:new o.Color(m[m.length-4],m[m.length-3],m[m.length-2],m[m.length-1]),y=e.activateShaderProgram(h.ProgramId.gradient);y.begin(t.tryGetBabylonTextureForRenderToTexture(e),p,!1);var _=y.getBabylonEffect(),S=y.getBabylonEngine();if(_.setInt("u_0",1),_.setVector2("u_1",s),_.setVector2("u_2",l),_.setFloatArray("bfrag_0",d.stops),_.setFloatArray4("bfrag_1",d.colors),_.setInt("ufrag_0",0),_.setInt("ufrag_3",r&&r.isGammaCorrected?1:0),_.setInt("ufrag_4",r.blendBellShape?1:0),_.setVector2("ufrag_5",r.blendBellShape||i.Vector2.Zero),a){var T,b=(0,c.getMaxTapeFloatsOrThrow)(),C=f(a);try{for(C.s();!(T=C.n()).done;)for(var w=T.value,P=w.transform.toMatrix3(),I=(0,n.getTapeBuffersForPath)(w,b,!0).buffers,k=I.map((function(e){return S.createVertexBuffer(e)})),E=0;E<I.length;E++){var x=I[E].length/4-4;S.bindInstancesBuffer(k[E],v,!1),_.setMatrix3x3("u_3",P.m),y.drawQuadInstances(x),S._releaseBuffer(k[E])}}catch(e){C.e(e)}finally{C.f()}y.disableInstanceAttribute("a_p1"),y.disableInstanceAttribute("a_p2")}y.end(),t.renderCost=performance.now()-u}(m,T,l,r.paths,p.center,p.size.inverse()),T}}(e,Y,r,b,s.TextureReleasePolicy.DisposableCache):d.Log.Error(592525320,"Path gradient only supported on Shape items")),X+=performance.now(),e.getCurrentFramePerformanceSummary().pathGradientTextureCostMs+=X}else{var J=t instanceof s.TargetTexture?t:void 0;J&&!y&&J.tag==b.changeTracker.currentUniqueId||(S=function(e,t,r,n){var a=e.getGraphicsProcessor();if(!a)throw d.Log.Error(592525322,"Graphics processor not initialized");var l=r.getType();if(l!=o.BrushType.linearGradient&&l!=o.BrushType.rectangularGradient&&l!=o.BrushType.radialGradient)throw d.Log.Error(592525323,"Unsupported Gradient type");var c=l==o.BrushType.linearGradient||l==o.BrushType.rectangularGradient,u=new i.Vector2(s.gradientResolution,c?1:s.gradientResolution),f=l==o.BrushType.linearGradient?"LinearGradient":l==o.BrushType.rectangularGradient?"RectangularGradient":"RadialGradient",m=s.TargetTexture.RecycleOrReplace(f,t,e,u,n);return m.tag=r.changeTracker.currentUniqueId,function(e,t,r){var n=performance.now(),a=g(r),s=e.activateShaderProgram(h.ProgramId.gradient);s.begin(t.tryGetBabylonTextureForRenderToTexture(e),o.Color.Black,!1);var l=s.getBabylonEffect();s.setDummyPointerAttribute("a_p1"),s.setDummyPointerAttribute("a_p2"),l.setFloatArray("bfrag_0",a.stops),l.setFloatArray4("bfrag_1",a.colors),l.setInt("u_0",0);var c=r&&r.getType()==o.BrushType.radialGradient;if(l.setInt("ufrag_0",c?1:0),l.setFloat("ufrag_6",r&&r.isGammaCorrected?2.2:1),l.setFloat("ufrag_7",r&&r.alphaGamma),r&&c){var u=r.fillToRect?r.fillToRect.center:new i.Vector2(.5,.5),d=r.fillFromRect?u.subtract(r.fillFromRect.leftTop).divide(r.fillFromRect.size):u;l.setVector2("ufrag_2",d)}l.setInt("ufrag_4",r.blendBellShape?1:0),l.setVector2("ufrag_5",r.blendBellShape||i.Vector2.Zero),s.drawQuads(1),s.end(),t.renderCost=performance.now()-n}(a,m,r),m}(e,J,b,s.TextureReleasePolicy.DisposableCache)),X+=performance.now(),e.getCurrentFramePerformanceSummary().gradientTextureCostMs+=X}}}else S=void 0;return t&&t!=S&&t instanceof s.Texture&&t.releasePolicy==s.TextureReleasePolicy.DisposableCache&&t.release(),S}},t.refreshFadeTexture=function(e,t,r,i,n){var a=e.getGraphicsProcessor();if(!a)throw d.Log.Error(592525321,"Graphics processor not initialized");var l=s.TargetTexture.RecycleOrReplace("FadeMask/Standard",t,e,p,s.TextureReleasePolicy.DisposableCache);return l.tag=n,function(e,t,r,i){var n=performance.now(),a=e.activateShaderProgram(h.ProgramId.fade);a.begin(t.tryGetBabylonTextureForRenderToTexture(e),o.Color.Black,!1);var s=a.getBabylonEffect();s.setInt("ufrag_0",r),s.setFloat("ufrag_1",i),a.drawQuads(1),a.end(),t.renderCost=performance.now()-n}(a,l,r,i),l},t.createPatternTexture=_,t.applyPictureEffects=T;var i=r(12),n=r(111),a=r(30),o=r(16),s=r(38),l=r(51),c=r(63),u=r(64),d=r(13),h=r(41);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=new i.Vector2(1024,1024);function g(e){for(var t=e.gradientStops.length,r=new Float32Array(t+2),i=new Float32Array(4*(t+2)),n=0;n<t+2;n++){var a=Math.min(Math.max(n-1,0),t-1),o=e.gradientStops[a].color;r[n]=0==n?0:n==t+1?1:e.gradientStops[a].position,i[4*n+0]=o.r,i[4*n+1]=o.g,i[4*n+2]=o.b,i[4*n+3]=o.a}return{stops:r,colors:i}}var v=[{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32}],y=new i.Vector2(8,8);function _(e,t,r){if(!e.getGraphicsProcessor())throw d.Log.Error(592525326,"Graphics processor not initialized");if(!(t<0||t>o.PatternType.count)){for(var i=new Uint8Array(64),n=S[t],a=0;a<16;a++)for(var c=n[a],u=0;u<4;u++){var h=(c&3<<2*u)>>2*u,f=0==h?255:1==h?127:0;i[4*a+u]=f}var m=s.Texture.CreateFromByteBuffer("Pattern",e,y,i,l.TextureFormat.LUMINANCE,o.WrapMode.tile,!1,!1,r);return m.tag=t,m}d.Log.Error(592525327,"pattern out of range")}var S=[[255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,64,29,0,116,0,208,1,64,7,0,29,0,116,1,208],[1,208,0,116,0,29,64,7,208,1,116,0,29,0,7,64],[255,255,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,208,29,116,116,29,208,7,208,7,116,29,29,116,7,208],[3,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0],[3,0,0,0,0,3,0,0,3,0,0,0,0,3,0,0],[3,3,0,0,48,48,0,0,3,3,0,0,48,48,0,0],[3,3,48,48,3,3,48,48,3,3,48,48,3,3,48,48],[51,51,12,12,51,51,192,192,51,51,12,12,51,51,192,192],[51,51,204,204,51,51,204,192,51,51,204,204,51,51,192,204],[51,51,204,204,51,51,204,204,51,51,204,204,51,51,204,204],[63,63,204,204,243,243,204,204,63,63,204,204,243,243,204,204],[252,252,207,207,252,252,207,207,252,252,207,207,252,252,207,207],[252,252,255,255,207,207,255,255,252,252,255,255,207,207,255,255],[63,255,255,255,255,63,255,255,63,255,255,255,255,63,255,255],[255,255,255,255,255,255,255,252,255,255,255,255,255,255,252,255],[3,3,12,12,48,48,192,192,3,3,12,12,48,48,192,192],[192,192,48,48,12,12,3,3,192,192,48,48,12,12,3,3],[15,15,60,60,240,240,195,195,15,15,60,60,240,240,195,195],[240,240,60,60,15,15,195,195,240,240,60,60,15,15,195,195],[15,192,63,0,252,0,240,3,192,15,0,63,0,252,3,240],[3,240,0,252,0,63,192,15,240,3,252,0,63,0,15,192],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0],[204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204],[255,255,0,0,255,255,0,0,255,255,0,0,255,255,0,0],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[255,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0],[0,0,0,0,3,3,12,12,48,48,192,192,0,0,0,0],[0,0,0,0,192,192,48,48,12,12,3,3,0,0,0,0],[255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,0,3,0,3,0,3,0,3],[3,0,0,3,12,0,0,48,192,0,0,192,48,0,0,12],[243,192,240,0,0,240,192,243,207,3,15,0,0,15,3,207],[3,192,12,48,48,12,192,3,3,192,12,48,48,12,192,3],[0,0,192,3,48,204,15,0,0,0,192,3,48,204,15,0],[0,192,0,48,0,12,0,3,192,3,48,12,12,48,3,192],[255,255,3,0,3,0,3,0,255,255,0,3,0,3,0,3],[3,3,204,12,48,48,12,204,3,3,192,12,48,48,204,192],[51,51,204,204,51,51,204,204,255,0,255,0,255,0,255,0],[0,0,192,0,0,3,192,0,0,0,3,0,0,192,3,0],[51,51,0,0,3,0,0,0,3,0,0,0,3,0,0,0],[3,0,0,0,48,48,0,0,0,3,0,0,48,48,0,0],[0,240,3,12,12,3,240,0,0,15,0,48,0,192,0,192],[255,255,60,60,255,255,195,195,255,255,60,60,255,255,195,195],[252,252,3,195,3,255,3,255,252,252,195,3,255,3,255,3],[255,255,3,3,3,3,3,3,255,255,3,3,3,3,3,3],[195,195,60,60,60,60,195,195,195,195,60,60,60,60,195,195],[255,0,255,0,255,0,255,0,0,255,0,255,0,255,0,255],[3,48,12,12,48,3,192,0,48,3,12,12,3,48,0,192],[192,0,240,3,252,15,255,63,252,15,240,3,192,0,0,0]];function T(e,t,r,i,n,a,o){var l,c,u=e.getGraphicsProcessor();if(u){var d=s.Texture.GetRequiredSizeForWrapMode(u,r.size,n),h=2===(null===(l=e.getBabylonEngine())||void 0===l?void 0:l.webGLVersion)||(0,s.isPowerOfTwo)(d.x)&&(0,s.isPowerOfTwo)(d.y),f=s.TargetTexture.RecycleOrReplace("PictureEffects",t,e,d,s.TextureReleasePolicy.DisposableCache,{format:r.format,wrapMode:n,isMipMapped:h});if(f.originalSize=r.originalSize,null!=i&&null!==(c=i.sharpness)&&void 0!==c&&c.hasImpact){var m,p=new s.TargetTexture("PictureEffects/Sharpness/BlurIntermediateTexture",e,d,s.TextureReleasePolicy.DisposableCache);p.originalSize=r.originalSize,(0,s.applySharpnessFilter)(e,r,p,i.sharpness,f,null==i||null===(m=i.mask)||void 0===m?void 0:m.mode,o,i.maskChannel),e.drawTextureToTexture(f,p,s.DrawTextureMode.pictureEffects,{pictureEffects:i,lookupTableTexture:a,maskTexture:o}),p.release()}else e.drawTextureToTexture(f,r,s.DrawTextureMode.pictureEffects,{pictureEffects:i,lookupTableTexture:a,maskTexture:o});return f}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawShapeWithDistanceField=function(e,t,r,h,f,m,p,g,v,y,_,S,T,b,C,w,P,I,k){var E=e.getGraphicsProcessor();if(E){var x=(0,a.getBoundsOfPaths)(p,!1);if(x){var L=new s.DistanceFieldSpriteLayer(h?h.texture:void 0,(0,o.transformedRectLocation)(x,p.transform),g);if(L.fillTexture=r.resolvedFillTexture||void 0,L.lineTexture=r.resolvedLineTexture||void 0,L.pictureTexture=r.resolvedPictureTexture||void 0,L.innerShadowTexture=t.innerShadowTexture||void 0,L.softEdgesTexture=t.softEdgesTexture||void 0,L.fillTransformUV=d(e,p,g.fillBrush,!1,v),L.pictureTransformUV=d(e,p,g.pictureBrush,!1,v),L.lineTransformUV=d(e,p,g.lineBrush,!0,v),L.localClipRect=T,L.fillBrightness=h?h.getFillBrightness():0,L.mergeMode=p.mergeMode,L.distanceFieldMode=h?h.distanceFieldMode:2,L.distRangeSize=h?h.distRangeSize:0,L.softEdges=p.effects&&f&a.EffectFlags.softEdges?p.effects.softEdges:void 0,L.innerShadow=p.effects&&f&a.EffectFlags.innerShadow?p.effects.innerShadow:void 0,L.blendingMode=g.blendingMode,L.fillBoundsOverride=p.fillBoundsOverride,L.pictureFillMode=p.style.pictureFillMode,L.hideFill=I,L.hideLine=k,0!=_&&7!=_||!t.fade||(L.fadeInfo={fade:t.fade,fadeTexture:t.fadeTexture,fadeMode:t.fadeMode}),L.clientObject=t,p.text&&p.text.renderMode!=u.TextRenderMode.TextInFrontOfShape)if(p.text&&p.text.cache instanceof c.TextGeneratedShapesCache&&t.coutoutLayer&&t.coutoutLayer.texture&&t.coutoutLayerCenter){L.textRenderMode=p.text.renderMode;var A=t.coutoutLayer.texture.contentLocation.logicalSize.scale(1/t.coutoutLayer.contentQuality),M=x.multiply(p.transform.scale.abs()),R=t.coutoutLayerCenter;L.textCutoutTransform=i.Matrix3.Scale2D(p.transform.scale.sign()),L.textCutoutTransform=L.textCutoutTransform.multiply(i.Matrix3.Translation2D(M.center)),L.textCutoutTransform=L.textCutoutTransform.multiply(p.text.frameToShape.toInverseMatrix3()),L.textCutoutTransform=L.textCutoutTransform.multiply(i.Matrix3.Translation2D(p.transform.preTranslation.multiply(p.transform.scale.abs()).subtract(R))),L.textCutoutTransform=L.textCutoutTransform.multiply(i.Matrix3.Scale2D(M.size.divide(A))),L.textCutoutTexture=t.coutoutLayer.texture}else if(p.text.renderMode!=u.TextRenderMode.ShapeCutout)return;L.overallOpacity=b,L.colorMatrix=C,L.colorOffset=w,L.colorize=P;var O=performance.now();(0,s.drawLayer)(E,L,m,v,y,5==_?n.Color.White:S,_),e.onLayerRendered(p.role==a.ShapeRole.text?"text":"shape","SDF",O,L)}else l.Log.Error(588006215,"Unable to get bounds")}else l.Log.Error(572867293,"Unable to get graphicsProcessor")};var i=r(12),n=r(16),a=r(30),o=r(38),s=r(89),l=r(13),c=r(128),u=r(84);function d(e,t,r,o,s){if(!r)return i.Matrix3.Identity;var c=r.getType();if(c==n.BrushType.pattern)return i.Matrix3.Scale2D(s.scale(1/16));var u=n.Brush.IsGradient(c);if(c!=n.BrushType.image&&!u)return i.Matrix3.Identity;var d=r.rotateWithShape,h=0,f=d?i.Matrix3.Scale2D(t.transform.scale):t.transform.toMatrix3(),m=(0,a.getBoundsOfPaths)(t,o,f),p=t.fillBoundsOverride?t.fillBoundsOverride:m;if(t.fillBoundsOverride&&p&&d&&(p=p.transformedBounds(i.Matrix3.FromTransforms(t.transform.toInverseMatrix3(),f))),!m||!p)return i.Matrix3.Identity;var g=p.size,v=i.Vector2.One,y=i.Vector2.Zero,_=!0,S=i.AlignmentType.center;if(c==n.BrushType.image){var T=r;if(y=T.offset,v=T.scale.abs(),h=T.rotation,_=T.isStretched,S=T.alignment,_){if(v=v.multiply(g),T.fillToPreserveAspectRatio){var b=e.getTextureFromImageBrush(T);if(b){var C=b.originalSize.x/b.originalSize.y,w=g.x/g.y;v=v.multiply(new i.Vector2(C>w?C/w:1,C<w?w/C:1))}else l.Log.Error(524026452,"No texture")}y=y.multiply(g)}else{var P=e.getTextureFromImageBrush(T);P?v=v.multiply(P.originalSize):l.Log.Error(590960595,"No texture")}}else if(c==n.BrushType.pathGradient)v=g;else if(u){var I=r;if(v=I.fillFromRect?I.fillFromRect.size:i.Vector2.One,y=(I.fillFromRect?I.fillFromRect.center:i.Vector2.Zero).subtract(new i.Vector2(.5,.5)).multiply(g),_=I.isStretched||c==n.BrushType.rectangularGradient,c==n.BrushType.linearGradient){v=v.multiply(g);var k=_?i.Rect.FromSize(i.Vector2.One):i.Rect.FromSize(v),E=k.transformedBounds(i.Matrix3.RotationZ(I.angle));v=E?v.scale(E.width/k.width):v,h=I.angle}else _?v=v.multiply(g):(v=v.scale(Math.max(g.x,g.y)),c==n.BrushType.radialGradient&&(v=v.scale(Math.sqrt(g.x*g.x+g.y*g.y)/Math.max(g.x,g.y))))}else v=v.multiply(g);var x=new i.Rect(-g.x/2+v.x/2,-g.y/2+v.y/2,g.x/2-v.x/2,g.y/2-v.y/2);y=y.add((0,a.getAlignmentPoint)(S,x)).multiply(new i.Vector2(1,-1));var L=i.Matrix3.Identity;if(L=(L=L.multiply(i.Matrix3.Translation2D(m.center.subtract(p.center)))).multiply(i.Matrix3.Scale2D(new i.Vector2(1,-1))),d||(L=(L=L.multiply(i.Matrix3.Scale2D(t.transform.scale.sign()))).multiply(i.Matrix3.RotationZ(-t.transform.rotation))),L=L.multiply(i.Matrix3.Translation2D(y.negate())),h)if(u)L=L.multiply(i.Matrix3.Translation2D(p.center.subtract(m.center))),_&&(L=L.multiply(i.Matrix3.Scale2D(g.inverse()))),L=L.multiply(i.Matrix3.RotationZ(h)),_&&(L=L.multiply(i.Matrix3.Scale2D(g))),L=L.multiply(i.Matrix3.Translation2D(m.center.subtract(p.center)));else if(c==n.BrushType.image){var A=r.rotationCenter.add(new i.Vector2(-.5,-.5)).multiply(new i.Vector2(v.x,-v.y));L=L.multiply(i.Matrix3.RotationAroundPoint(h,A))}return(L=L.multiply(i.Matrix3.Scale2D(v.inverse()))).multiply(i.Matrix3.Scale2D(new i.Vector2(1,-1)))}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Veto=void 0;var n=i(r(1)),a=i(r(2)),o=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"Record",value:function(t,r){e.s_recorder.recordVeto(t,r)}},{key:"setRecorder",value:function(t){t&&(e.s_recorder=t)}}])}();t.Veto=o,o.s_recorder={recordVeto:function(e,t){console.log("Veto",e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStateRestorer=function(e){return new i.StateRestorerGL(!!e)};var i=r(139)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MagicGenerator=t.MagicScenario=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(13),l=r(12),c=r(16),u=r(41),d=r(38);t.MagicScenario=n,function(e){e[e.shape=0]="shape",e[e.overlay=1]="overlay",e[e.gradient=2]="gradient"}(n||(t.MagicScenario=n={}));var h=(0,o.default)((function e(t,r,i){if((0,a.default)(this,e),this.ambientTime=0,this.samScan=0,this.clickPos=l.Vector2.Zero,this.clickAnim=0,this.magicOpacity=0,this.magicHole=0,this.mousePos=l.Vector2.Zero,this.showMouse=!1,this.iridescentRingProgress=0,this.iridescentRingOpacity=0,this.imageFlip=!1,this.m_image=new c.ImageContainer,4!=r.length)throw s.Log.Error(507581189,"Need to provide 4 theme colors");this.size=t,this.colors=r,this.scenario=i}),[{key:"update",value:function(e){var t,r,i,n,a=e.getGraphicsProcessor();if(!a)throw s.Log.Error(507581188,"Graphics processor not initialized");if(!a.beginRenderScope())throw s.Log.Error(507581187,"Failed to enter render scope.");var o=this.m_texture;this.m_texture=d.TargetTexture.RecycleOrReplace("Magic",this.m_texture,e,this.size,d.TextureReleasePolicy.KeepUntilRelease),this.m_texture!=o&&e.attachTextureToImage(this.m_image,this.m_texture);var l=a.activateShaderProgram(u.ProgramId.magic);l.begin(this.m_texture.tryGetBabylonTextureForRenderToTexture(a),c.Color.Transparent,!0),l.getBabylonEffect().setFloat("u_0",this.ambientTime),l.getBabylonEffect().setVector2("u_1",this.size),l.getBabylonEffect().setVector2("ufrag_0",this.size),l.getBabylonEffect().setInt("ufrag_1",this.scenario),l.getBabylonEffect().setFloat("ufrag_2",this.ambientTime),l.getBabylonEffect().setFloat("ufrag_3",this.samScan),l.getBabylonEffect().setVector2("ufrag_4",this.clickPos),l.getBabylonEffect().setFloat("ufrag_5",this.clickAnim),l.getBabylonEffect().setFloat("ufrag_6",this.magicOpacity),l.getBabylonEffect().setFloat("ufrag_7",this.magicHole),l.getBabylonEffect().setVector2("ufrag_8",this.mousePos),l.getBabylonEffect().setFloat("ufrag_9",this.showMouse?1:0),l.getBabylonEffect().setDirectColor4("ufrag_10",this.colors[0]),l.getBabylonEffect().setDirectColor4("ufrag_11",this.colors[1]),l.getBabylonEffect().setDirectColor4("ufrag_12",this.colors[2]),l.getBabylonEffect().setDirectColor4("ufrag_13",this.colors[3]),l.getBabylonEffect().setInt("ufrag_14",null!=this.scanOverlayTexture?1:0),l.getBabylonEffect().setFloat("ufrag_15",this.iridescentRingProgress),l.getBabylonEffect().setFloat("ufrag_16",this.iridescentRingOpacity),l.getBabylonEffect().setInt("ufrag_17",this.imageRevealTexture?1:0),l.getBabylonEffect().setInt("ufrag_18",this.imageFlip?1:0),l.setTexture("t_0",null===(t=this.iridescentTexture_mask)||void 0===t?void 0:t.tryUseBabylonTexture(a,void 0,"iridescentTexture")),l.setTexture("t_1",null===(r=this.iridescence_color)||void 0===r?void 0:r.tryUseBabylonTexture(a,void 0,"iridescentTexture")),l.setTexture("t_2",null===(i=this.scanOverlayTexture)||void 0===i?void 0:i.tryUseBabylonTexture(a,void 0,"scanOverlayTexture")),l.setTexture("t_3",null===(n=this.imageRevealTexture)||void 0===n?void 0:n.tryUseBabylonTexture(a,void 0,"imageRevealtexture")),l.drawQuads(1),l.end(),a.endRenderScope(),this.m_texture.changeTracker.notifyChange()}},{key:"texture",get:function(){return this.m_texture}},{key:"image",get:function(){return this.m_image}},{key:"release",value:function(){var e;null===(e=this.m_texture)||void 0===e||e.release(),this.m_texture=void 0}}]);t.MagicGenerator=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGlyphPathFromFontHandler=function(e,t,r,c,u,d,h,f,m){var p=function(e,t){switch(t){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();case"none":return e;default:return i.Log.Error(529092686,"Unsupported caps type: "+t),e}}(e[t],f),g=o.FontHandler.getInstance().getFontPage(u,p,d,h);if(void 0===g){o.FontHandler.getInstance().downloadFont(u,p,d,h,m);var v={figures:l({w:0,g:0,f:"",pts:""})};return new a.Path(v)}if(void 0!==g){var y=g[p];if(void 0===y){if(s.includes(p))return;i.Log.Error(529388307,"Character not in font: ".concat(p)),y=g[""]}if(void 0!==y&&void 0===y.path){var _={figures:l(y)};_.glyphCacheId={fontId:y.f,glyphId:y.g},y.path=new a.Path(_)}var S=c/4096;if(void 0!==y&&void 0!==y.path&&y.path.figures.length>0)return new a.Path(y.path,n.Transform.fromScaleAndTranslation(new n.Vector2(S,S),r))}m&&m(0)},t.createGlyphFigures=l,t.createFiguresFromPathString=c;var i=r(13),n=r(12),a=r(27),o=r(274),s=[" ","","\t","\r","\n"];function l(e){return void 0!==e.pts?c(e.pts):[]}function c(e){for(var t,r=function(e){var t=e.replace(/(M|L|Q|C|A|E|;)/g,(function(e){return"M"===e?"0":"L"===e?"1":"Q"===e?"2":"C"===e?"3":"A"===e?"4":"E"===e?"5":","}));return"[".concat(t,"]")}(e),n=new Float32Array(JSON.parse(r)),a=[],o=0,s=2*Math.PI/216e5;o<n.length;)switch(n[o]){case 0:t=p(o+=1,n,t,a),o+=2;break;case 1:m(t,o+=1,n),o+=2;break;case 2:f(t,o+=1,n),o+=4;break;case 3:h(t,o+=1,n),o+=6;break;case 4:d(t,o+=1,n,s),o+=4;break;case 5:o+=1,u(t,a),t=void 0;break;default:i.Log.Error(539854432,"Invalid path string")}return void 0!==t&&a.push(t),a}function u(e,t){if(null==e)throw i.Log.Error(539854433,"All paths should start with a MoveTo"),new Error;e.close(),t.push(e)}function d(e,t,r,n){if(null==e||t+3>=r.length)throw i.Log.Error(539854434,"Invalid Arc of ellipse"),new Error;e.arcTo(r[t],r[t+1],r[t+2]*n,r[t+3]*n)}function h(e,t,r){if(null==e||t+5>=r.length)throw i.Log.Error(539854435,"Invalid CubicBezierTo"),new Error;e.cubicBezierTo(r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}function f(e,t,r){if(null==e||t+3>=r.length)throw i.Log.Error(539854464,"Invalid quadratic bezier curve"),new Error;e.quadBezierTo(r[t],r[t+1],r[t+2],r[t+3])}function m(e,t,r){if(null==e||t+1>=r.length)throw i.Log.Error(539854465,"Invalid LineToSegment"),new Error;e.lineTo(r[t],r[t+1])}function p(e,t,r,n){if(e+1>=t.length)throw i.Log.Error(539854466,"Invalid move to new figure"),new Error;null!=r&&n.push(r);var o=new a.FigureBuilder;return o.moveTo(t[e],t[e+1]),o}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.FontHandler=void 0;var n=i(r(1)),a=i(r(2)),o=r(13),s=r(143);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=function(){function e(){(0,n.default)(this,e),this.BASE_URL="https://cdn.int.designerapp.osi.office.net/fonts/",this.fontFamilyCollection={},this.attemptedUrls=[],this.badUrls=[],this.downloadCallbacksMap=new Map}return(0,a.default)(e,[{key:"getattemptedUrls",value:function(){return this.attemptedUrls}},{key:"getbadUrls",value:function(){return this.badUrls}},{key:"getFontPage",value:function(t,r,i,n){var a=t.toLowerCase(),o=e.getInstance().fontAndStyle(a,i,n),s=Math.floor(r.charCodeAt(0)/256);if(void 0!==this.fontFamilyCollection[o])return this.fontFamilyCollection[o][s]}},{key:"addFont",value:function(t,r,i,n,a){var o=t.toLowerCase(),s=e.getInstance().fontAndStyle(o,i,n);void 0===this.fontFamilyCollection[s]&&(this.fontFamilyCollection[s]={}),this.fontFamilyCollection[s][r]=a}},{key:"addFontPageWire",value:function(e,t,r,i,n){var a={};if(void 0!==n.dt){var o,s=l(n.dt);try{for(s.s();!(o=s.n()).done;){var c=o.value,u={w:c.w};void 0!==c.g&&(u.g=c.g.g,u.f=c.g.f,void 0!==c.g.p&&(u.pts=c.g.p.pts)),a[c.nm]=u}}catch(e){s.e(e)}finally{s.f()}}this.addFont(e,t,r,i,a)}},{key:"fontFlagsToString",value:function(e,t){return e||t?(e?"Bold":"")+(t?"Italic":""):"Normal"}},{key:"fontAndStyle",value:function(t,r,i){var n=e.getInstance().fontFlagsToString(r,i);return"".concat(t,"/").concat(n)}},{key:"fontDownloadIdentifier",value:function(e,t,r,i){return"".concat(this.fontAndStyle(e,t,r),"/").concat(i)}},{key:"storeFetchedData",value:function(t,r,i,n,a){e.getInstance().addFontPageWire(t,r,i,n,a)}},{key:"AddDownloadSuceededCallbackForFont",value:function(t,r){var i=e.getInstance().downloadCallbacksMap.get(t);i?void 0===i.find((function(e){return e===r}))&&i.push(r):e.getInstance().downloadCallbacksMap.set(t,[r])}},{key:"NotifyFontDownloaded",value:function(t){var r=e.getInstance().downloadCallbacksMap.get(t);r&&(r.forEach((function(e){e(2)})),e.getInstance().downloadCallbacksMap.delete(t))}},{key:"downloadFont",value:function(t,r,i,n,a){var l=this,c=new XMLHttpRequest,u=e.getInstance().fontFlagsToString(i,n),d=Math.floor(r.charCodeAt(0)/256),h=256*(d+1)-1,f="".concat(256*d,"-").concat(h),m=encodeURIComponent(t),p=s.s_fontLocationOverride?s.s_fontLocationOverride:this.BASE_URL,g="".concat(p).concat(m,"/").concat(u,"/").concat(f,".json");if(a){var v=e.getInstance().fontDownloadIdentifier(t,i,n,d);this.AddDownloadSuceededCallbackForFont(v,a)}void 0===e.getInstance().attemptedUrls.find((function(e){return g===e}))&&(e.getInstance().attemptedUrls.push(g),c.responseType="json",c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){e.getInstance().storeFetchedData(t,d,i,n,c.response);var r=e.getInstance().fontDownloadIdentifier(t,i,n,d);l.NotifyFontDownloaded(r)}},c.onerror=function(){o.Log.Error(539854467,"bad URL: ".concat(g)),e.getInstance().badUrls.push(g),a&&a(3)},c.open("GET",g),c.send())}}],[{key:"getInstance",value:function(){return void 0===e.instance&&(e.instance=new e),e.instance}}])}();t.FontHandler=u,u.instance=new u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeViewElement=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(25),l=r(3),c=r(35),u=r(42),d=r(4);function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var m=function(){function e(t,r,i,n,o,l){(0,a.default)(this,e),this.shapeType=s.ShapeType.Shape,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=t.id,this.m_emuToPixelScale=i,this.m_shapeViewData=r,this.m_slideEvents=n,this.m_environment=o,this.m_shapeItem=l&&l.item||void 0}return(0,o.default)(e,[{key:"ensure",value:function(){return this.m_shapeItem||this.init(),this.m_shapeItem?u.ShapeViewElementUtils.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData,{shapeId:this.id}):(l.ULS.sendTraceTag(595621973,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"ShapeViewElement::ensureTexture: invalid shapeItem."),{invalidShape:!0})}},{key:"init",value:function(){this.animatableContentViewElements=[],this.m_shapeItem=u.ShapeViewElementUtils.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment)}},{key:"getAnimatableContentIdFromClickTarget",value:function(e){return e.action?e.action.animatableContentId:e.animation?e.animation.animatableContentId:e.hyperlink?e.hyperlink.animatableContentId:e.zoom?e.zoom.animatableContentId:void 0}},{key:"getAllZoomsOnShape",value:function(){var e=[];if(this.m_shapeViewData&&this.m_shapeViewData.clickTargets){var t,r=h(this.m_shapeViewData.clickTargets.entries());try{for(r.s();!(t=r.n()).done;){var i=(0,n.default)(t.value,2),a=(i[0],i[1]);a.zoom&&e.push(a.zoom)}}catch(e){r.e(e)}finally{r.f()}}return e}},{key:"ensureClickTarget",value:function(){var t=this;if(this.m_shapeViewData.clickTargets&&!document.getElementById("".concat(c.ViewController.SlideLevelHtmlElementsDivId,"-").concat(JSON.stringify(this.id)))){var r,i=h(this.m_shapeViewData.clickTargets.entries());try{var a,o=function(){var i=(0,n.default)(r.value,2),a=i[0],o=i[1],l=t.getAnimatableContentIdFromClickTarget(o),c=t.m_shapeViewData.animatableContents.find((function(e){return e.id===l}));if(!c)return{v:void 0};var f=c.parts[0].regionPos.pos;if(o.action){var m=o.action,p=t.ensureClickTargetDiv(),g=document.createElement("a");g.tabIndex=0,g.onkeydown=function(e){e&&e.key&&"enter"===e.key.toLowerCase()&&(t.m_slideEvents.emit("clickTarget-gotoSlide",m.slideId),e.stopImmediatePropagation())},g.style.pointerEvents="auto",g.style.background="none",g.style.border="none",g.style.padding="0",g.style.cursor="pointer",g.title="",g.id="sp-".concat(JSON.stringify(t.id),"-i-").concat(a),g.onclick=function(){t.m_slideEvents.emit("clickTarget-gotoSlide",m.slideId)},d.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(g.style.backgroundColor="rgba(0,0,0,0.5)"),p.appendChild(g),u.ShapeViewElementUtils.setClickTargetRegion(g,m.region,f)}if(o.hyperlink){var v=o.hyperlink;if(!e.hasValidProtocol(v.url))return 0;var y=t.ensureClickTargetDiv(),_="http://www.w3.org/2000/svg",S=document.createElementNS(_,"a");S.style.pointerEvents="auto",S.setAttributeNS(null,"href",v.url),S.setAttributeNS(null,"rel","noreferrer"),S.setAttributeNS(null,"target","_blank");var T=v.tip?v.tip:v.url;S.setAttributeNS(null,"title",T),S.textContent=v.desc?v.desc:v.url,S.style.color="rgba(0,0,0,0)",d.Settings.readBooleanOrDefault("stopPropagationForKeyDown",!0)&&(S.onkeydown=function(e){e&&e.key&&"enter"===e.key.toLowerCase()&&e.stopImmediatePropagation()});var b=document.createElementNS(_,"title");b.textContent=T,S.appendChild(b);var C,w=h(v.subRegions);try{for(w.s();!(C=w.n()).done;){var P=C.value,I=document.createElementNS(_,"rect");I.setAttributeNS(null,"x",(P.left-v.region.left).toString()),I.setAttributeNS(null,"y",(P.top-v.region.top).toString()),I.setAttributeNS(null,"height",(P.bottom-P.top).toString()),I.setAttributeNS(null,"width",(P.right-P.left).toString()),I.setAttributeNS(null,"fill-opacity","0"),S.appendChild(I)}}catch(e){w.e(e)}finally{w.f()}var k=document.createElementNS(_,"svg");k.id="sp-".concat(JSON.stringify(t.id),"-i-").concat(a),k.setAttribute("role","presentation"),k.classList.add("svm-interactive-element-focus-class"),k.setAttributeNS(null,"viewbox","".concat(v.region.left," ").concat(v.region.top," ").concat((v.region.right-v.region.left).toString()," ").concat((v.region.bottom-v.region.top).toString())),d.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(k.style.backgroundColor="rgba(0,0,0,0.5)"),k.appendChild(S),y.appendChild(k),u.ShapeViewElementUtils.setClickTargetRegion(k,v.region,f)}if(o.zoom){var E=o.zoom,x=t.ensureClickTargetDiv(),L=document.createElement("a");L.tabIndex=0,L.onkeydown=function(e){if(e&&e.key&&"enter"===e.key.toLowerCase()){if(E.type===s.ZoomType.Slide){var r={slideId:E.slideId,returnToParent:E.returnToParent};t.m_slideEvents.emit("clickTarget-gotoZoomSlide",r)}else if(E.type===s.ZoomType.Section){var i={sectionId:E.sectionId,returnToParent:E.returnToParent};t.m_slideEvents.emit("clickTarget-gotoZoomSection",i)}e.stopImmediatePropagation()}},L.style.pointerEvents="auto",L.style.background="none",L.style.border="none",L.style.padding="0",L.style.cursor="pointer",L.title="",L.id="sp-".concat(JSON.stringify(t.id),"-i-").concat(a),L.onclick=function(){var e={slideId:E.slideId,returnToParent:E.returnToParent};if(E.type===s.ZoomType.Slide)t.m_slideEvents.emit("clickTarget-gotoZoomSlide",e);else if(E.type===s.ZoomType.Section){var r={sectionId:E.sectionId,returnToParent:E.returnToParent};t.m_slideEvents.emit("clickTarget-gotoZoomSection",r)}},d.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(L.style.backgroundColor="rgba(0,0,0,0.5)"),x.appendChild(L),u.ShapeViewElementUtils.setClickTargetRegion(L,E.region,f)}if(o.animation){var A=o.animation,M=t.ensureClickTargetDiv(),R=document.createElement("a");R.tabIndex=0,R.onkeydown=function(e){e&&e.key&&"enter"===e.key.toLowerCase()&&(t.m_slideEvents.emit("clickTarget-interactiveAnimation",A.sequenceId),e.stopImmediatePropagation())},R.style.pointerEvents="auto",R.style.background="none",R.style.border="none",R.style.padding="0",R.style.cursor="pointer",R.title="",R.id="sp-".concat(JSON.stringify(t.id),"-i-").concat(a),R.onclick=function(){t.m_slideEvents.emit("clickTarget-interactiveAnimation",A.sequenceId)},d.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(R.style.backgroundColor="rgba(0,0,0,0.5)"),M.appendChild(R),u.ShapeViewElementUtils.setClickTargetRegion(R,A.region,f)}};for(i.s();!(r=i.n()).done;)if(0!==(a=o())&&a)return a.v}catch(e){i.e(e)}finally{i.f()}}}},{key:"ensureClickTargetDiv",value:function(){var e=u.ShapeViewElementUtils.ensureShapeViewElementParentDiv(this.id,"2");return e.style.pointerEvents="none",e}},{key:"update",value:function(){this.ensureClickTarget(),u.ShapeViewElementUtils.ensureAccessibilityElement(this.id)}},{key:"applyAnimation",value:function(e){this.m_shapeItem&&u.ShapeViewElementUtils.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}},{key:"tryPrepare",value:function(e){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,e),this.m_environment.rendererEnvironment.flush()),this.fPrepared}},{key:"addToScene",value:function(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}},{key:"removeFromScene",value:function(e){if(this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)){var t=e.items.elements.slice(0);t.splice(e.items.elements.indexOf(this.m_shapeItem),1),e.setItems(t)}}},{key:"cleanUp",value:function(){}},{key:"shapeItem",get:function(){return this.m_shapeItem}}],[{key:"hasValidProtocol",value:function(e){try{return["http:","https:","mailto:","ftp:","file:","news:","tel:","onenote:","notes:","mms:","mssv:","bookmark:"].includes(new URL(e).protocol)}catch(e){}return!1}}])}();t.ShapeViewElement=m},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getUlsLogger=function(e,t){return new c(e,t)},t.getUlsLoggerDeprecated=function(e,t){var r=new s.bUlsCache(e,t);return{sendTraceTag:function(e,t,i,n){return u(r,e,t,i,n,"")},shipAssertTag:function(e,t,i,n){i&&u(r,e,t,l.TraceLevel.Error,n,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:function(){}}},t.RemoteUlsLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(148),s=r(277),l=r(73),c=(0,a.default)((function e(t,r,i){(0,n.default)(this,e),this.correlationId="",this.cache=new s.bUlsCache(t,r,i)}),[{key:"setCorrelationId",value:function(e){this.correlationId=e}},{key:"sendTraceTag",value:function(e,t,r,i){u(this.cache,e,t,r,i,this.correlationId)}},{key:"debugAssertTag",value:function(e,t,r,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")}},{key:"shipAssertTag",value:function(e,t,r,i){r&&u(this.cache,e,t,l.TraceLevel.Error,i,this.correlationId)}},{key:"flush",value:function(){this.cache.flush()}},{key:"flushOnClose",value:function(){this.cache.flushOnClose}}]);function u(e,t,r,i,n,a){if(!(i>l.TraceLevel.Info)){var s={timestamp:Date.now(),category:r,tag:t,level:i,type:o.LogType.Trace,message:n,correlationId:a};e.handleTrace(s)}}t.RemoteUlsLogger=c},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.bUlsCache=void 0;var n=i(r(1)),a=i(r(2)),o=r(149),s=r(150),l=r(73),c=function(){function e(t,r,i){var a=this;(0,n.default)(this,e),this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){a.triggerUpload(!1,!1)},this.flush=function(){a.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return a.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,r){if(window.clearTimeout(a.timeoutId),a.logCache.length>0){a.uploadId+=1;var i=(0,s.formatForUpload)(a.logCache,a.userSessionId,a.uploadId,a.timestampBase);(0,o.uploadLogs)(i,a.remoteUrlEndpoint,r),a.logCache=[],a.timestampBase=Date.now()}t&&(a.timeoutId=window.setTimeout(a.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t;var l=r+"?usid="+t;void 0!==i&&i.forEach((function(e,t){l+="&"+t+"="+e})),this.remoteUrlEndpoint=l,window.setTimeout((function(){return a.triggerUpload(!0,!0)}),0)}return(0,a.default)(e,[{key:"handleTrace",value:function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===l.TraceLevel.Error)&&this.triggerUploadAsync()}}])}();t.bUlsCache=c,c.messageMaxChars=3072,c.uploadCadenceInMsSec=3e4,c.uploadTriggerSize=30,c.trimmedMessage="... [Trimmed]"},function(e,t,r){},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.UnitTestLogger=void 0;var n=i(r(2)),a=i(r(1)),o=i(r(9)),s=i(r(8)),l=i(r(10));function c(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var u=function(e){function t(){return(0,a.default)(this,t),c(this,t,arguments)}return(0,l.default)(t,e),(0,n.default)(t)}(r(112).NoopLogger);t.UnitTestLogger=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(73),s=r(145),l=(0,a.default)((function e(t){(0,n.default)(this,e),this.category=t}),[{key:"info",value:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];s.ULS.sendTraceTag(e,this.category,o.TraceLevel.Info,this.messageToLog(t,i))}},{key:"warn",value:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];s.ULS.sendTraceTag(e,this.category,o.TraceLevel.Warning,this.messageToLog(t,i))}},{key:"error",value:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];s.ULS.sendTraceTag(e,this.category,o.TraceLevel.Error,this.messageToLog(t,i))}},{key:"messageToLog",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(!r.length)return e;var n=r.map((function(e){return JSON.stringify(e)})).join(", ");return"".concat(e,": ").concat(n)}}]);t.CategoryLogger=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupGlobals_Animations=function(e){e.logger&&i.ULS.setLogger(e.logger),e.settings&&a.Settings.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&n.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.anim=o)};var i=r(3),n=r(11),a=r(4),o={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeGate=void 0;var i=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=i},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var n=i(r(15)),a=i(r(1)),o=i(r(2));function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var c=function(){function e(){(0,a.default)(this,e)}return(0,o.default)(e,null,[{key:"load",value:function(t){for(var r in t)e.m_settings[r]=t[r]}},{key:"readBooleanOrDefault",value:function(t,r){var i=void 0===e.m_settings?"":(0,n.default)(e.m_settings[t]);return"string"===i?"true"===e.m_settings[t].toLowerCase():"boolean"===i?e.m_settings[t]:r}},{key:"readNumberOrDefault",value:function(t,r){var i=void 0===e.m_settings?"":(0,n.default)(e.m_settings[t]);return"string"===i||"number"===i?Number(e.m_settings[t]):r}},{key:"readStringOrDefault",value:function(t,r){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?r:e.m_settings[t]}},{key:"addOrUpdateSettingsFromUrl",value:function(t,r){var i=r.get("wdset");if(!i)return t;var n,a=s(i.split(","));try{for(a.s();!(n=a.n()).done;){var o=n.value.split(":"),l=o[0].split("."),c=l[0],u=l[1],d=o[1];u&&d&&e.addOrUpdateSetting(t,c,u,d)}}catch(e){a.e(e)}finally{a.f()}return t}},{key:"addOrUpdateSetting",value:function(e,t,r,i){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][r]=i)}}])}();t.Settings=c,c.m_settings={}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.tokenLevel=g,t.LEVEL=t.EQN_TOKEN=t.BinaryFormula=t.UnaryFormula=t.SymbolFormula=t.ProgressFormula=t.ConstantStringFormula=t.ConstantFormula=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(286),l=(0,a.default)((function e(t){(0,n.default)(this,e),(0,o.default)(this,"val",void 0),this.val=t}),[{key:"evalulate",value:function(e,t){return this.val}},{key:"isConst",value:function(){return!0}},{key:"isString",value:function(){return!1}},{key:"level",value:function(){return m.FACTOR}}]);t.ConstantFormula=l;var c=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"evalulate",value:function(e,t){return 0}},{key:"isConst",value:function(){return!0}},{key:"isString",value:function(){return!0}},{key:"level",value:function(){return m.FACTOR}}]);t.ConstantStringFormula=c;var u=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"evalulate",value:function(e,t){return e}},{key:"isConst",value:function(){return!1}},{key:"isString",value:function(){return!1}},{key:"level",value:function(){return m.FACTOR}}]);t.ProgressFormula=u;var d=(0,a.default)((function e(t,r){(0,n.default)(this,e),(0,o.default)(this,"propertyName",void 0),(0,o.default)(this,"fEditVal",void 0),this.propertyName=t,this.fEditVal=r}),[{key:"evalulate",value:function(e,t){var r;return(r=this.fEditVal?t.getPropStaticValue(this.propertyName):t.getPropAnimatedValue(this.propertyName))&&r.getType()===s.AnimValueType.Double?r.getDoubleValue():0}},{key:"isConst",value:function(){return!1}},{key:"isString",value:function(){return!1}},{key:"level",value:function(){return m.FACTOR}}]);t.SymbolFormula=d;var h=(0,a.default)((function e(t,r){(0,n.default)(this,e),(0,o.default)(this,"tok",void 0),(0,o.default)(this,"arg",void 0),this.tok=t,this.arg=r}),[{key:"evalulate",value:function(e,t){if(!this.arg)return 0;var r=this.arg.evalulate(e,t);switch(this.tok){case f.SUB:return-r;case f.SIN:return Math.sin(r);case f.COS:return Math.cos(r);case f.TAN:return Math.tan(r);case f.ASIN:return Math.asin(r);case f.ACOS:return Math.acos(r);case f.ATAN:return Math.atan(r);case f.SQRT:return Math.sqrt(r);case f.EXP:return Math.exp(r);case f.LN:return Math.log(r);case f.ABS:return Math.abs(r);case f.SINH:return Math.sinh(r);case f.COSH:return Math.cosh(r);case f.TANH:return Math.tanh(r);case f.CEIL:return Math.ceil(r);case f.FLOOR:return Math.floor(r);case f.RAND:return r*Math.random();case f.RAD:return r*Math.PI/180;case f.DEG:return 180*r/Math.PI;default:return r}}},{key:"isConst",value:function(){return!!this.arg&&this.arg.isConst()}},{key:"isString",value:function(){return!1}},{key:"level",value:function(){return this.tok===f.SUB?m.UNARY:g(this.tok)}}]);t.UnaryFormula=h;var f,m,p=(0,a.default)((function e(t,r,i){(0,n.default)(this,e),(0,o.default)(this,"tok",void 0),(0,o.default)(this,"left",void 0),(0,o.default)(this,"right",void 0),this.tok=t,this.left=r,this.right=i}),[{key:"evalulate",value:function(e,t){if(!this.left||!this.right)return 0;var r=this.left.evalulate(e,t),i=this.right.evalulate(e,t);switch(this.tok){case f.ADD:return r+i;case f.SUB:return r-i;case f.MUL:return r*i;case f.DIV:return r/i;case f.POW:return Math.pow(r,i);case f.MOD:return r%i;case f.MIN:return r<i?r:i;case f.MAX:return r>i?r:i;default:return r}}},{key:"isConst",value:function(){return!this.left||!this.right||this.left.isConst()&&this.right.isConst()}},{key:"isString",value:function(){return!1}},{key:"level",value:function(){return g(this.tok)}}]);function g(e){switch(e){case f.NUMBER:case f.QUOTE:return m.FACTOR;case f.NOT:return m.UNARY;case f.POW:return m.POWER;case f.MUL:case f.DIV:case f.MOD:return m.MULDIV;case f.ADD:case f.SUB:return m.ADDSUB;case f.GT:case f.GTE:case f.LT:case f.LTE:return m.GTLT;case f.EQ:case f.NEQ:return m.EQNEQ;case f.AND:return m.AND;case f.OR:return m.OR;case f.COND:case f.ALT:return m.COND;case f.UNKNOWN:return m.UNKNOWN;default:return f.FACTOR_FIRST<e&&e<f.FACTOR_LAST?m.FACTOR:m.UNKNOWN}}t.BinaryFormula=p,t.EQN_TOKEN=f,function(e){e[e.FIRST=0]="FIRST",e[e.UNKNOWN=1]="UNKNOWN",e[e.FACTOR_FIRST=2]="FACTOR_FIRST",e[e.NUMBER=3]="NUMBER",e[e.SYMBOL=4]="SYMBOL",e[e.QUOTE=5]="QUOTE",e[e.PROGRESS=6]="PROGRESS",e[e.EDITVAL=7]="EDITVAL",e[e.PARAM_FIRST=8]="PARAM_FIRST",e[e.SIN=9]="SIN",e[e.COS=10]="COS",e[e.TAN=11]="TAN",e[e.ASIN=12]="ASIN",e[e.ACOS=13]="ACOS",e[e.ATAN=14]="ATAN",e[e.SQRT=15]="SQRT",e[e.EXP=16]="EXP",e[e.LN=17]="LN",e[e.ABS=18]="ABS",e[e.SINH=19]="SINH",e[e.COSH=20]="COSH",e[e.TANH=21]="TANH",e[e.CEIL=22]="CEIL",e[e.FLOOR=23]="FLOOR",e[e.RAND=24]="RAND",e[e.RAD=25]="RAD",e[e.DEG=26]="DEG",e[e.TWO_PARAMS_FIRST=27]="TWO_PARAMS_FIRST",e[e.MIN=28]="MIN",e[e.MAX=29]="MAX",e[e.PARAM_LAST=30]="PARAM_LAST",e[e.FACTOR_LAST=31]="FACTOR_LAST",e[e.ADD=32]="ADD",e[e.SUB=33]="SUB",e[e.MUL=34]="MUL",e[e.DIV=35]="DIV",e[e.POW=36]="POW",e[e.MOD=37]="MOD",e[e.COND_FIRST=38]="COND_FIRST",e[e.NOT=39]="NOT",e[e.GT=40]="GT",e[e.GTE=41]="GTE",e[e.LT=42]="LT",e[e.LTE=43]="LTE",e[e.EQ=44]="EQ",e[e.NEQ=45]="NEQ",e[e.AND=46]="AND",e[e.OR=47]="OR",e[e.COND=48]="COND",e[e.ALT=49]="ALT",e[e.COND_LAST=50]="COND_LAST",e[e.COMMA=51]="COMMA",e[e.LPAR=52]="LPAR",e[e.RPAR=53]="RPAR",e[e.LBRACE=54]="LBRACE",e[e.RBRACE=55]="RBRACE",e[e.LCURL=56]="LCURL",e[e.RCURL=57]="RCURL",e[e.LAST=58]="LAST"}(f||(t.EQN_TOKEN=f={})),t.LEVEL=m,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.COND=1]="COND",e[e.OR=2]="OR",e[e.AND=3]="AND",e[e.EQNEQ=4]="EQNEQ",e[e.GTLT=5]="GTLT",e[e.ADDSUB=6]="ADDSUB",e[e.MULDIV=7]="MULDIV",e[e.POWER=8]="POWER",e[e.UNARY=9]="UNARY",e[e.FACTOR=10]="FACTOR"}(m||(t.LEVEL=m={}))},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AnimValueType=void 0,t.AnimValueType=i,function(e){e[e.Unset=0]="Unset",e[e.Double=1]="Double",e[e.String=2]="String",e[e.Color=3]="Color",e[e.Image=4]="Image",e[e.Array=5]="Array",e[e.Point=6]="Point",e[e.Filter=7]="Filter"}(i||(t.AnimValueType=i={}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimClock=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(26),l=(0,a.default)((function e(){(0,n.default)(this,e),(0,o.default)(this,"m_startTimeMs",0),(0,o.default)(this,"m_pausedTimeMs",0),(0,o.default)(this,"m_requestId",-1),(0,o.default)(this,"events",new s.EventEmitter)}),[{key:"start",value:function(e){this.stop(),this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.m_startTimeMs=Date.now()-(e||0),this.events.emit("tick",this.currentTimeMs)}},{key:"stop",value:function(){window.cancelAnimationFrame(this.m_requestId),this.m_pausedTimeMs=0,this.events.emit("notRunning",null)}},{key:"pause",value:function(){this.stop(),this.m_pausedTimeMs=Date.now()}},{key:"resume",value:function(){var e=this.m_pausedTimeMs?this.m_pausedTimeMs-this.m_startTimeMs:0;this.start(e)}},{key:"currentTimeMs",get:function(){return Date.now()-this.m_startTimeMs}},{key:"loop",value:function(){this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.events.emit("tick",this.currentTimeMs)}}]);t.AnimClock=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimTimeline=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=i(r(5)),l=r(74),c=r(53);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var h=function(){function e(){(0,a.default)(this,e),(0,s.default)(this,"m_currentRelativeTime",0),(0,s.default)(this,"m_animObjectList",[]),(0,s.default)(this,"m_clickTimeListMap",new Map),(0,s.default)(this,"m_timelineIdList",[]),(0,s.default)(this,"m_endTimeMap",new Map),(0,s.default)(this,"m_callbackVisEvaluatorList",void 0)}return(0,o.default)(e,[{key:"getEndTime",value:function(e){return this.m_endTimeMap[e]}},{key:"onClickTimeListsChanged",value:function(e){if(this.m_callbackVisEvaluatorList){var t,r=u(this.m_callbackVisEvaluatorList);try{for(r.s();!(t=r.n()).done;)t.value.onClickListsChanged()}catch(e){r.e(e)}finally{r.f()}}e&&e()}},{key:"clearAllClickTimeLists",value:function(){this.m_clickTimeListMap=new Map;var e,t=u(this.m_timelineIdList);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.m_clickTimeListMap[r]=[]}}catch(e){t.e(e)}finally{t.f()}}},{key:"createVisEvaluatorCallbackList",value:function(e){var t,r=[],i=u(e);try{for(i.s();!(t=i.n()).done;){var n,a=u(t.value.Attributes);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o.AttrId===c.AnimAttributeId.Visible){var s,l=u(o.Evaluators);try{for(l.s();!(s=l.n()).done;){var d=s.value;d.EvalId===c.AnimEvaluatorId.VisTrack&&r.push(d)}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"adjustClickTimeListOnPop",value:function(t){var r,i=u(t);try{for(i.s();!(r=i.n()).done;){var n=r.value;n.HasOccurred&&(n.ClickTime-=e.c_removeClickTimeAdjustInMs)}}catch(e){i.e(e)}finally{i.f()}}},{key:"setTimeAndCalculate",value:function(e){this.m_currentRelativeTime=e;var t,r=!1,i=u(this.m_animObjectList);try{for(i.s();!(t=i.n()).done;)t.value.aggregateAllAttributesForTime(e)&&(r=!0)}catch(e){i.e(e)}finally{i.f()}return r}},{key:"forceSlideRedraw",value:function(){if(this.m_animObjectList){var e,t=u(this.m_animObjectList);try{for(t.s();!(e=t.n()).done;)e.value.clearCachedAttributeValues()}catch(e){t.e(e)}finally{t.f()}}}},{key:"resetTimeline",value:function(e,t){this.m_clickTimeListMap[e]=[],this.onClickTimeListsChanged(t)}},{key:"hasTimelineFinished",value:function(e){var t=this.m_endTimeMap[e];if(null==t)return!1;var r=this.m_clickTimeListMap[e];if(null==r)return!1;if(r.length<t.ClickNum)return!1;if(r.length>t.ClickNum)return!0;if(0===r.length)return 0===t.ClickNum&&this.m_currentRelativeTime>=t.Offs;var i=this.m_currentRelativeTime-r[r.length-1].ClickTime;return t.Offs<i}},{key:"addTimelineClickInternal",value:function(e,t,r){null!=this.m_clickTimeListMap[e]&&(this.m_clickTimeListMap[e].push(new l.AnimClickTime(t)),this.onClickTimeListsChanged(r))}},{key:"addTimelineClicks",value:function(e,t,r){for(var i=0;i<t;i+=1)this.addTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(r)}},{key:"addTimelineClick",value:function(e,t){if(null!=this.m_clickTimeListMap){var r=this.m_currentRelativeTime;this.addTimelineClickInternal(e,r,t)}}},{key:"removeTimelineClicks",value:function(e,t,r){for(var i=0;i<t;i+=1)this.removeTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(r)}},{key:"removeTimelineClick",value:function(e,t){if(null!=this.m_clickTimeListMap){var r=this.m_clickTimeListMap[e];null!=r&&r.length>0&&(r.pop(),this.adjustClickTimeListOnPop(r),this.onClickTimeListsChanged(t))}}},{key:"getTimelineStates",value:function(e){if(!this.m_timelineIdList)return null;var t,r=[],i=u(this.m_timelineIdList);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=this.getNumTimelineClicks(n),o=this.getClickTime(n,a).ClickTime;e?r.push({timelineId:n,step:a,lastClickTime:o}):r.push({timelineId:n,step:a})}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"setTimelineStates",value:function(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,n=this.m_clickTimeListMap[i.timelineId];if(n&&this.m_endTimeMap[i.timelineId]){var a=n.length,o=this.m_endTimeMap[i.timelineId].ClickNum,s=Math.min(Math.max(i.step,0),o+1);s>a?this.addTimelineClicks(i.timelineId,s-a):s<a&&this.removeTimelineClicks(i.timelineId,a-s),null!=i.lastClickTime&&n.length>0&&(n[n.length-1].ClickTime=i.lastClickTime)}}}catch(e){r.e(e)}finally{r.f()}}},{key:"getNumTimelineClicks",value:function(e){if(null==this.m_clickTimeListMap)return 0;var t=this.m_clickTimeListMap[e];return null==t?0:t.length}},{key:"getClickTime",value:function(e,t){if(null==this.m_clickTimeListMap)return new l.AnimClickTime(c.AnimConstants.Undefined);var r=this.m_clickTimeListMap[e];return null==r||t===c.AnimConstants.Undefined?new l.AnimClickTime(c.AnimConstants.Undefined):0===t?new l.AnimClickTime(0):r.length<t?new l.AnimClickTime(c.AnimConstants.Undefined):r[t-1]}},{key:"initTimeline",value:function(e,t,r,i,a){if(null!=t&&0!==t.length){this.m_timelineIdList=t,this.m_animObjectList=e,this.m_callbackVisEvaluatorList=this.createVisEvaluatorCallbackList(e),this.clearAllClickTimeLists();var o,s=u(r.entries());try{for(s.s();!(o=s.n()).done;){var l=(0,n.default)(o.value,2),c=l[0],d=l[1];if(d)for(var h=0;h<d.ClickNum;h+=1){var f=h===d.ClickNum-1?d.Offs:0;this.addTimelineClickInternal(c,f,void 0)}}}catch(e){s.e(e)}finally{s.f()}this.onClickTimeListsChanged(a),this.setTimeAndCalculate(i),this.calculateEndTimes()}}},{key:"calculateEndTimes",value:function(){this.m_endTimeMap=new Map;var e,t=u(this.m_animObjectList);try{for(t.s();!(e=t.n()).done;){var r,i=u(e.value.getAnimEndTime());try{for(i.s();!(r=i.n()).done;){var a=(0,n.default)(r.value,2),o=a[0],s=a[1],l=this.m_endTimeMap[o];(null==l||s.ClickNum>l.ClickNum||s.ClickNum===l.ClickNum&&s.Offs>l.Offs)&&(this.m_endTimeMap[o]=s)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){t.e(e)}finally{t.f()}null==this.m_endTimeMap[c.AnimConstants.MainTimelineId]&&(this.m_endTimeMap[c.AnimConstants.MainTimelineId]={ClickNum:0,Offs:0})}}])}();t.AnimTimeline=h,(0,s.default)(h,"c_removeClickTimeAdjustInMs",36e5)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AnimEvaluatorCreator=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(74),l=r(53),c=r(151),u=r(152),d=r(3);function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var m=function(){function e(t,r){(0,n.default)(this,e),(0,o.default)(this,"m_clickTimeProvider",void 0),(0,o.default)(this,"m_visTrackTable",void 0),this.m_clickTimeProvider=t,this.m_visTrackTable=r}return(0,a.default)(e,[{key:"addEvaluatorConstantAfter",value:function(e,t,r,i,n){var a={Start:{ClickNum:r,Offs:i},End:{ClickNum:l.AnimConstants.Undefined,Offs:l.AnimConstants.Undefined},SkipClickNum:l.AnimConstants.Undefined},o=new c.ConstantAnimEvaluator(e,a,0,0,this.m_clickTimeProvider,n);t.registerAnimEvaluator(o)}},{key:"addEvaluatorConstantObjectAfter",value:function(e,t,r,i,n){var a={Start:{ClickNum:r,Offs:i},End:{ClickNum:l.AnimConstants.Undefined,Offs:l.AnimConstants.Undefined},SkipClickNum:l.AnimConstants.Undefined},o=new c.ConstantObjectAnimEvaluator(e,a,0,0,this.m_clickTimeProvider,n);t.registerAnimEvaluator(o)}},{key:"addEvaluatorConstantObject",value:function(t,r,i,n,a,o,s,u){var d=e.getRepeatsSkipClick(i+1,s),h=e.getEvalNumRepeats(s),f={Start:{ClickNum:i,Offs:n},End:{ClickNum:l.AnimConstants.Undefined,Offs:a},SkipClickNum:d},m=new c.ConstantObjectAnimEvaluator(t,f,h,u,this.m_clickTimeProvider,o);return r.registerAnimEvaluator(m),m}},{key:"addEvaluatorConstantDuration",value:function(e,t,r,i,n,a,o,s){this.addEvaluatorConstantSpan(e,t,r,i,l.AnimConstants.Undefined,n,a,o,s)}},{key:"addEvaluatorConstantSpan",value:function(t,r,i,n,a,o,s,u,d){var h=e.getRepeatsSkipClick(a===l.AnimConstants.Undefined?l.AnimConstants.Undefined:a+1,u),f=e.getEvalNumRepeats(u),m={Start:{ClickNum:i,Offs:n},End:{ClickNum:a,Offs:o},SkipClickNum:h},p=new c.ConstantAnimEvaluator(t,m,f,d,this.m_clickTimeProvider,s);r.registerAnimEvaluator(p)}},{key:"addEvaluatorConstantObjectSpan",value:function(t,r,i,n,a,o,s,u,d){var h=e.getRepeatsSkipClick(a===l.AnimConstants.Undefined?l.AnimConstants.Undefined:a+1,u),f=e.getEvalNumRepeats(u),m={Start:{ClickNum:i,Offs:n},End:{ClickNum:a,Offs:o},SkipClickNum:h},p=new c.ConstantObjectAnimEvaluator(t,m,f,d,this.m_clickTimeProvider,s);r.registerAnimEvaluator(p)}},{key:"addEvaluatorLinear",value:function(t,r,i,n,a,o,s,u,d){var h=e.getRepeatsSkipClick(i+1,u),f=e.getEvalNumRepeats(u),m={Start:{ClickNum:i,Offs:n},End:{ClickNum:l.AnimConstants.Undefined,Offs:a},SkipClickNum:h},p={Val1:o,Val2:s},g=new c.LinearAnimEvaluator(t,m,f,d,this.m_clickTimeProvider,p);return r.registerAnimEvaluator(g),g}},{key:"addEvaluatorLinearList",value:function(t,r,i,n,a,o,s,u,d,h){var f=e.getRepeatsSkipClick(i+1,d),m=e.getEvalNumRepeats(d),p={Start:{ClickNum:i,Offs:n},End:{ClickNum:l.AnimConstants.Undefined,Offs:a},SkipClickNum:f},g=new c.LinearListAnimEvaluator(t,p,m,h,this.m_clickTimeProvider,o,s,u);return r.registerAnimEvaluator(g),g}},{key:"addEvaluatorConstantObjectBidir",value:function(e,t,r,i,n,a,o,s,c,d){if(this.m_visTrackTable[e])return s?(this.m_visTrackTable[e].becomesVisibleAt(t,i,n),this.addEvaluatorConstantObject(t,r,i,n,a,o,c,d)):(c!==l.AnimConstants.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,u.AnimTranslate.getRepeatsClick(i,c),u.AnimTranslate.getRepeatsOffs(n,a+d,c)),this.addEvaluatorConstantObject(t,r,i,n+d,a,o,c,d))}},{key:"addEvaluatorVisLinearBidir",value:function(e,t,r,i,n,a,o,s,c,d,h){var f;if(this.m_visTrackTable[e])return c?(this.m_visTrackTable[e].becomesVisibleAt(t,i,n),f=this.addEvaluatorLinear(t,r,i,n,a,s,o,d,h)):(f=this.addEvaluatorLinear(t,r,i,n+h,a,o,s,d,h),d!==l.AnimConstants.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,u.AnimTranslate.getRepeatsClick(i,d),u.AnimTranslate.getRepeatsOffs(n,a+h,d))),f}},{key:"addTimeSmoother",value:function(t,r,i,n,a,o,c,u,d){if(r>0||i>0){var h={Start:{ClickNum:a,Offs:o},End:{ClickNum:l.AnimConstants.Undefined,Offs:c},SkipClickNum:e.getRepeatsSkipClick(a+1,u)},f=new s.AnimTimeSmoother(n,h,e.getEvalNumRepeats(u),d,this.m_clickTimeProvider,r,i);t.TimeSmoother=f}}},{key:"addEvaluatorVisTrack",value:function(e,t){return new c.VisTrackAnimEvaluator(e,t,this.m_clickTimeProvider)}},{key:"addEvaluatorsForSegmentList",value:function(e,t,r,i,n,a,o){if(null!==o&&0!==o.length){var s,c=this.m_visTrackTable[e];if(null!=c)if(n){s=o[0],c.becomesVisibleAt(t,i,s.Offs);var f,m=h(o);try{for(m.s();!(f=m.n()).done;){var p=f.value;this.addEvaluatorLinear(t,r,i,p.Offs,p.Dur,p.OffsVal,p.BaseVal,a,p.SegOffs)}}catch(e){m.e(e)}finally{m.f()}}else{for(var g=o[0],v=(s=o[o.length-1]).Offs+s.Dur,y=o.length-1;y>=0;y-=1){var _=v-((s=o[y]).Offs-g.Offs)-s.Dur;this.addEvaluatorLinear(t,r,i,_,s.Dur,s.BaseVal,s.OffsVal,a,s.SegOffs)}if(a!==l.AnimConstants.RepeatUntilEnd){var S=g.Offs,T=v-S;c.becomesInvisibleAt(t,u.AnimTranslate.getRepeatsClick(i,a),u.AnimTranslate.getRepeatsOffs(S,T,a))}}else d.ULS.sendTraceTag(508822156,d.LogCategory.msoulscat_Wac_PptAnimation,d.TraceLevel.Error,"Bad visTrack for aoId ".concat(e," at AddEvaluatorsForSegmentList."))}else d.ULS.sendTraceTag(508822157,d.LogCategory.msoulscat_Wac_PptAnimation,d.TraceLevel.Error,"Bad segList input to AddEvaluatorsForSegmentList.")}},{key:"addEvaluatorBezier",value:function(t,r,i,n,a,o,s,u){var d=e.getRepeatsSkipClick(i+1,s),h=e.getEvalNumRepeats(s),f={Start:{ClickNum:i,Offs:n},End:{ClickNum:l.AnimConstants.Undefined,Offs:a},SkipClickNum:d},m=new c.BezierAnimEvaluator(t,f,h,u,this.m_clickTimeProvider,o);return r.registerAnimEvaluator(m),m}}],[{key:"getEvalNumRepeats",value:function(e){return e===l.AnimConstants.RepeatUntilClick||e===l.AnimConstants.RepeatUntilEnd?l.AnimConstants.RepeatForever:e}},{key:"getRepeatsSkipClick",value:function(e,t){return t===l.AnimConstants.RepeatUntilEnd?l.AnimConstants.Undefined:e}}])}();t.AnimEvaluatorCreator=m},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,t.TraceLevel=i,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(t.TraceLevel=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(292);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}));var n=r(293);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}))},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getLoggableUserId=function(e){if(!e)return e;var t=e;return t.startsWith("urn%3aspo%3")?t="":t.toLowerCase().startsWith("8:orgid:")&&(t=t.substring(8,t.length)),t},t.HealthAdapter=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=i(r(5)),c=r(3),u=r(153),d=function(){function e(){(0,o.default)(this,e)}return(0,s.default)(e,null,[{key:"init",value:(i=(0,a.default)(n.default.mark((function t(r,i,a){var o,s,l=this;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=Date.now().valueOf(),c.ULS.sendTraceTag(508842070,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"HealthAdapter::init starting"),this.s_health){t.next=9;break}return t.next=5,e.createSmallHealth(r,i);case 5:this.s_health=t.sent,a&&e.addOrUpdatePartCDimensions(a),this.s_pillarAdditionsDuringInit.forEach((function(e){l.s_health.addQosPillar(e)})),this.s_additionalDimensionsAddedDuringInit.size>0&&e.addOrUpdatePartCDimensions(this.s_additionalDimensionsAddedDuringInit);case 9:this.s_vetoListener||(this.s_vetoListener=function(t,r){e.onVetoRecorded(t,r)},u.VetoUtils.registerVetoRecordedListener(this.s_vetoListener),u.VetoUtils.getSessionVetos().forEach((function(e,t){l.onVetoRecorded(t,e)}))),s=Date.now().valueOf()-o,c.ULS.sendTraceTag(508842069,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"HealthAdapter::init ending. ElapsedMs: ".concat(s));case 12:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"addToQosPillar",value:function(e){this.s_health?this.s_health.addQosPillar(e):this.s_pillarAdditionsDuringInit.push(e)}},{key:"addOrUpdatePartCDimensions",value:function(e){var t=this;this.s_health?e.forEach((function(e,r){c.ULS.sendTraceTag(508842068,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"HealthAdapter::addOrUpdatePartCDimensions ".concat(r,", ").concat(e)),t.s_health.addOrUpdatePartCDimension(r,e)})):e.forEach((function(e,r){c.ULS.sendTraceTag(508842067,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"HealthAdapter::addOrUpdatePartCDimensions deferring update until init ".concat(r,", ").concat(e)),t.s_additionalDimensionsAddedDuringInit.set(r,e)}))}},{key:"createSmallHealth",value:(t=(0,a.default)(n.default.mark((function e(t,i){var a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.remoteTelemetryUrl){e.next=2;break}throw new Error("settings.remoteTelemetryUrl is not set");case 2:return e.next=4,r.e(15).then(r.t.bind(null,466,7));case 4:if(a=e.sent,o={dimensions:i,isHealthEnabled:void 0===t.isHealthEnabled||t.isHealthEnabled,remoteTelemetryUrl:t.remoteTelemetryUrl,heartbeatIntervalMs:void 0!==t.heartbeatIntervalMs?t.heartbeatIntervalMs:this.s_defaultHearbeatIntervalMs,recordPillarToWarmPipelineIntervalMs:void 0!==t.recordQosPillarToWarmPipelineIntervalMs?t.recordQosPillarToWarmPipelineIntervalMs:this.s_defaultRecordQosPillarToWarmPipelineIntervalMs},s=a.HealthFactoryGlobal.getHealthInstance(o)){e.next=9;break}throw new Error("Unable to create health object");case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"onVetoRecorded",value:function(e,t){if(this.s_health)try{var r=void 0!==t.errorName?t.errorName.trim():e.trim(),i=void 0!==t.qosVeto?t.qosVeto.trim():e.trim(),n=void 0!==t.isIntentional&&t.isIntentional,a=void 0===t.isInternal||t.isInternal,o=void 0===t.alertOnPillar||t.alertOnPillar,s=void 0!==t.isSessionEndingError&&t.isSessionEndingError,l={};for(var u in t)t.hasOwnProperty(u)&&"errorName"!==u&&"isIntentional"!==u&&"isInternal"!==u&&"alertOnPillar"!==u&&"isSessionEndingError"!==u&&"qosVeto"!==u&&(l[u]=t[u]);this.s_health&&this.s_health.recordQosError(r,[i],n,a,o,s,l)}catch(t){c.ULS.sendTraceTag(508842066,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"HealthAdapter hit an exception recording veto: ".concat(e,", ").concat(t.message))}}},{key:"clear",value:function(){c.ULS.sendTraceTag(508842065,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"HealthAdapter::clear called"),this.s_vetoListener&&(u.VetoUtils.unregisterVetoRecordedListener(this.s_vetoListener),this.s_vetoListener=void 0),this.s_pillarAdditionsDuringInit.length>0&&(this.s_pillarAdditionsDuringInit=[]),this.s_additionalDimensionsAddedDuringInit.size>0&&(this.s_additionalDimensionsAddedDuringInit=new Map),this.s_health&&(this.s_health=void 0)}}]);var t,i}();t.HealthAdapter=d,(0,l.default)(d,"s_health",void 0),(0,l.default)(d,"s_vetoListener",void 0),(0,l.default)(d,"s_pillarAdditionsDuringInit",[]),(0,l.default)(d,"s_additionalDimensionsAddedDuringInit",new Map),(0,l.default)(d,"s_defaultHearbeatIntervalMs",3e5),(0,l.default)(d,"s_defaultRecordQosPillarToWarmPipelineIntervalMs",864e5)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OtelJSWrapper=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=i(r(5)),c=r(3),u=r(154),d=function(){function e(){(0,o.default)(this,e)}return(0,s.default)(e,null,[{key:"init",value:(i=(0,a.default)(n.default.mark((function t(i,a){var o,s,l=this;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.ULS.sendTraceTag(508842075,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"OTelJsWrapper::init starting"),this.s_Telemetry){t.next=11;break}return t.next=4,r.e(14).then(r.t.bind(null,467,7));case 4:this.s_Telemetry=t.sent,o={name:a.application,platform:"Web",version:a.clientVersion,osVersion:a.osVersion,sessionId:a.session_id,serverDocId:a.serverDocId,audienceGroup:this.getAudienceGroupFromRing(a.ring),browserName:a.browser,browserVersion:a.browserVersion,host:a.host,applicationMode:a.applicationMode,applicationModeExtended:a.applicationModeExtended,ring:a.ring,loggableUserId:a.loggableUserId,loggableUserIdSpace:a.loggableUserIdSpace,uiHost:this.getOtelLoggableUiHost(a.uiHost),appLanguage:a.applicationLcid,datacenter:a.datacenter,omsTenantId:a.tenantId},s={alwaysOnMetadata:o,ulsLogger:i.logger,sendToAria:!0,ariaEndpointTarget:i.ariaEndpointTarget},this.s_Telemetry.setEnabledState(!0),this.s_Telemetry.initializeEventProcessor(s),this.s_Telemetry.registerEventHandler(this.s_Telemetry.processEvent),window.addEventListener("unload",(function(){c.ULS.sendTraceTag(508842074,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"Shutting down otel Telemetry"),l.s_Telemetry&&l.s_Telemetry.shutdown()}));case 11:this.s_actionListener||(this.s_actionListener=function(t){e.sendUserActionEvent(t)},u.UserActionUtils.registerUserActionListener(this.s_actionListener),u.UserActionUtils.getUserActions().forEach((function(t){e.sendUserActionEvent(t)}))),c.ULS.sendTraceTag(508842073,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"OTelJsWrapper::init completed");case 13:case"end":return t.stop()}}),t,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"sendOtelEvent",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.s_Telemetry){e.next=2;break}throw new Error("OtelJsWrapper not initialized");case 2:try{this.s_Telemetry.sendTelemetryEvent(t)}catch(e){c.ULS.sendTraceTag(508842072,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Error,"Failed to sendTelemetryEvent. Ex: ".concat(e))}case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"sendUserActionEvent",value:function(e){if(this.s_Telemetry){var t={name:"Office.PowerPoint.Online.UserAction.".concat(e.actionName),dataFields:[{name:"UserAction.Name",string:e.actionName}]};e.durationMs&&t.dataFields.push({name:"Activity.DurationMs",int64:e.durationMs}),e.succeeded&&t.dataFields.push({name:"Activity.Succeeded",bool:e.succeeded}),this.sendOtelEvent(t)}}},{key:"getOtelLoggableUiHost",value:function(e){switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";default:return e}}},{key:"getAudienceGroupFromRing",value:function(e){if(!e)return"Automation";switch(e){case"1":return"Dogfood";case"2":return"Microsoft";case"3":case"5":case"6":return"Production";default:return"Automation"}}},{key:"reset",value:function(){this.s_Telemetry=void 0,this.s_actionListener&&(u.UserActionUtils.unregisterUserActionListener(this.s_actionListener),this.s_actionListener=void 0)}}]);var t,i}();t.OtelJSWrapper=d,(0,l.default)(d,"s_Telemetry",void 0),(0,l.default)(d,"s_actionListener",void 0)},function(e,t,r){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(296);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}))},function(e,t,r){"use strict";var i=r(0),n=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.ParseJson=void 0;var a,o=i(r(18)),s=i(r(297)),l=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(r(20));function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}t.ParseJson=a,function(e){function t(t,n){if(!t)return l.Transform.Identity;var a=t.pt?r(t.pt).scale(n):void 0,o=t.s?i(t.s):new l.Vector2(1,1),s=t.rSpecified?t.r*e.c_internalAngleToRadianFactor:void 0,c=t.t?r(t.t).scale(n):void 0;return new l.Transform(a,o,s,c)}function r(e){return new l.Vector2(e.x,e.y)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new l.Vector2(e.x||t,e.y||t)}function n(e){return new l.Color(e[0]/255,e[1]/255,e[2]/255,e[3]/255)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new l.Rect(e.l*t,e.t*t,e.r*t,e.b*t)}function u(e){var t,r=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.pos,s=n(a.clr);r.push(new l.GradientStop(o,s))}}catch(e){i.e(e)}finally{i.f()}return r.sort((function(e,t){return e.position-t.position})),r}function d(e,t){if(e.gradientStops=t,e.isGammaCorrected=!1,2==t.length||3==t.length){var r=t[0],i=t[t.length-1];if(0==Math.min(r.position,i.position)&&1==Math.max(r.position,i.position))if(2==t.length)e.isGammaCorrected=!0,e.blendBellShape=l.Vector2.One;else if(3==t.length&&r.color.equals(i.color)){var n=t[1];e.gradientStops=[new l.GradientStop(0,r.color),new l.GradientStop(1,n.color)],e.isGammaCorrected=!0,e.blendBellShape=new l.Vector2(n.position,1)}}}function h(t,r,i){switch(t.bt){case 0:return new l.SolidBrush(l.Color.Transparent);case 1:var o=n(t.Item.clr);return new l.SolidBrush(o);case 2:var s=t.Item,c=new l.GradientBrush(l.BrushType.linearGradient);return c.isStretched=s.isStretched,c.rotateWithShape=s.rtSp,c.angle=s.ang*e.c_internalAngleToRadianFactor,s.ftrct&&(c.fillToRect=a(s.ftrct)),s.ffrct&&(c.fillFromRect=a(s.ffrct)),s.stops&&d(c,u(s.stops)),c;case 3:var h=t.Item,m=new l.GradientBrush(l.BrushType.radialGradient);return m.isStretched=h.isStretched,m.rotateWithShape=h.rtSp,m.angle=h.ang*e.c_internalAngleToRadianFactor,h.ftrct&&(m.fillToRect=a(h.ftrct)),h.ffrct&&(m.fillFromRect=a(h.ffrct)),h.stops&&d(m,u(h.stops)),m;case 4:var p=t.Item,g=new l.GradientBrush(l.BrushType.rectangularGradient);return g.isStretched=p.isStretched,g.rotateWithShape=p.rtSp,g.angle=p.ang*e.c_internalAngleToRadianFactor,p.ftrct&&(g.fillToRect=a(p.ftrct)),p.ffrct&&(g.fillFromRect=a(p.ffrct)),p.stops&&d(g,u(p.stops)),g;case 5:var v=t.Item,y=new l.GradientBrush(l.BrushType.pathGradient);return y.isStretched=v.isStretched,y.rotateWithShape=v.rtSp,y.angle=v.ang*e.c_internalAngleToRadianFactor,v.ftrct&&(y.fillToRect=a(v.ftrct)),v.ffrct&&(y.fillFromRect=a(v.ffrct)),v.stops&&d(y,u(v.stops)),y;case 7:var _=t.Item;return new l.PatternBrush(_.type,n(_.clrFg),n(_.clrBg));case 6:return f(t.Item,r);case 8:case 9:i.Message(39084627,"unsupported Brush ".concat(JSON.stringify(t)))}return new l.SolidBrush(l.Color.Transparent)}function f(e,t){if(e.id){var r=new l.ImageContainer;r.id=e.id;var i=new l.ImageBrush(r);return i.wrapMode=e.wrpmd,i.alignment=e.algn,i.isStretched=e.isStretched,i.offset=new l.Vector2(e.off.x,e.off.y),i.scale=new l.Vector2(e.scale.x,e.scale.y),i.opacity=e.opcty,i.rotateWithShape=e.rotWShp,i.isStretched||(i.scale=i.scale.divide(new l.Vector2(e.dpi.x,e.dpi.y)).scale(t.fromInch),i.offset=i.offset.scale(t.fromHighPrecisionUnit)),i}}function m(e){return{cap:e.capType,end:e.type,length:e.len,width:e.width,widthMin:e.widthMin}}function p(e,t,r){if(!e)return new l.Style;var i,n;e.fillBrsh&&(i=h(e.fillBrsh,t,r)),e.outlnBrsh&&(n=h(e.outlnBrsh,t,r));var a=function(e,t,r,i){var n=new l.Pen(t*i);return n.lineHeight=r*i,e?(e.dtSpecified&&(n.dashType=e.dt),e.jtSpecified&&(n.lineJoin=e.jt),e.mlSpecified&&(n.miterLimit=e.ml),e.ctSpecified&&(n.compoundType=e.ct),e.atSpecified&&(n.alignment=e.at),e.doffSpecified&&(n.dashOffset=e.doff),e.dctSpecified&&(n.useRoundDash=1==e.dct),e.headEnd&&(n.headEnd=m(e.headEnd)),e.tailEnd&&(n.tailEnd=m(e.tailEnd)),e.tip&&(n.tipType=e.tip),n):n}(e.pen,e.lnWdth,e.lnHgth,t.fromHighPrecisionUnit),o=new l.Style(i,n,a);return e.pctBrush&&(o.pictureBrush=f(e.pctBrush,t)),e.blend&&(o.blendingMode=e.blend),o}function g(t,r,i){var a,o,s,c,u;if(t.glw){var d=t.glw.blrRd*r,h=n(t.glw.clr);a=new l.Glow(h,d)}if(t.otrSdw){var f=t.otrSdw;(o=new l.Shadow(n(f.clr),f.blrRd*r,f.ang*e.c_internalAngleToRadianFactor,f.dst*r,new l.Vector2(f.sx*i,f.sy*i),new l.Vector2(f.kx,f.ky))).alignment=f.algn,o.shadowType=f.tp}if(t.inrSdw){var m=t.inrSdw;s=new l.InnerShadow(n(m.clr),m.blrRd*r,m.ang*e.c_internalAngleToRadianFactor,m.dst*r)}if(t.rflctn){var p=t.rflctn;c=new l.Reflection(p.blrRd*r,p.sAlph,p.sPos,p.eAlph,p.ePos,p.dst*r)}return t.sftEdg&&(u=new l.SoftEdges(t.sftEdg.blrRd*r)),new l.Effects(a,o,s,c,u)}function v(e,r,i){var n=e.pts;if(n){var a,o,s=null==(a=e.f)?l.PathFillMode.normal:0==a?l.PathFillMode.none:2==a?l.PathFillMode.lighten:3==a?l.PathFillMode.lightenLess:4==a?l.PathFillMode.darken:5==a?l.PathFillMode.darkenLess:l.PathFillMode.normal;if(e.h>0){var c=JSON.parse("["+n+"]");o={figures:[new l.Figure(c,!1,e.h)]}}else o={figures:l.createFiguresFromPathString(n)};return o.fillMode=s,o.lineEnabled=e.s,e.xfrm?o.transform=t(e.xfrm,i):o.transform=l.Transform.Identity,o.transform=o.transform.applyScaleAndTranslationBefore(new l.Vector2(r,r),l.Vector2.Zero),o.extrusionEnabled=e.e,o}}function y(e,r,n){var a,o=[],s=e.xfrm?t(e.xfrm,r.fromHighPrecisionUnit):l.Transform.Identity,u=e.fontInfo,d=c(e.glyphInstance);try{for(d.s();!(a=d.n()).done;){var h=a.value;if(h.glyph&&n){var f=n.getGlyph(u,h.glyph);if(!f)continue;if(!f.clientData){var m=v(f.p,1,1);m&&(m.lineEnabled=!0,m.fillMode=l.PathFillMode.normal,m.glyphCacheId={fontId:u,glyphId:h.glyph},f.clientData=new l.Path(m))}if(!f.clientData)continue;var p=i(h.scale,1).scale(r.fromHighPrecisionUnit);p=p.scale(1/4096);var g=i(h.off).scale(r.fromHighPrecisionUnit),y=new l.Path(f.clientData,s.applyScaleAndTranslationBefore(p,g));o.push(y)}}}catch(e){d.e(e)}finally{d.f()}return o}function _(e){return new l.TextRange(e.cp,e.len)}function S(e,t){var r=v(e,1,1);if(r){var i=r.figures.length?r.figures[0]:void 0;if(i){var n=i instanceof l.Figure?i:i.createFigure();if(1==t)return n;for(var a=n.points.slice(0),o=0;o<n.getPointCount();o++)a[o*n.pointDataSize]*=t,a[o*n.pointDataSize+1]*=t;return new l.Figure(a,n.isClosed,n.format)}}}function T(e,t){if(!e)return l.TextStrokeType.highlighter;switch(e){case 0:return l.TextStrokeType.highlighter;case 1:return l.TextStrokeType.single;case 2:return l.TextStrokeType.double;case 3:return l.TextStrokeType.heavy;case 4:return l.TextStrokeType.dotted;case 5:return l.TextStrokeType.dottedHeavy;case 6:return l.TextStrokeType.dash;case 7:return l.TextStrokeType.dashHeavy;case 8:return l.TextStrokeType.dashLong;case 9:return l.TextStrokeType.dashLongHeavy;case 10:return l.TextStrokeType.dotDash;case 11:return l.TextStrokeType.dotDashHeavy;case 12:return l.TextStrokeType.dotDotDash;case 13:return l.TextStrokeType.dotDotDashHeavy;case 14:return l.TextStrokeType.wavy;case 15:return l.TextStrokeType.wavyHeavy;case 16:return l.TextStrokeType.wavyDouble}return t.Error(595637021,"Incorrect ShapeBuilder.TextStrokeType"),l.TextStrokeType.single}function b(e,t,r){var i,n=new l.TrackableArray,a=c(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=p(o.style,t,r);n.push(new l.TextStroke(T(o.type,r),o.verticalCenter*t.fromLowPrecisionUnit,o.thickness*t.fromLowPrecisionUnit,s))}}catch(e){a.e(e)}finally{a.f()}return n}function C(e,t,r,i,n,a){var o=a.getGlyph(n,e);if(o){if(!o.clientData){var s=v(o.p,1,1);s&&(s.lineEnabled=!0,s.fillMode=l.PathFillMode.normal,s.glyphCacheId={fontId:n,glyphId:e},o.clientData=new l.Path(s))}if(o.clientData)return new l.Path(o.clientData,new l.Transform(l.Vector2.Zero,t,i,r))}}function w(t,r,n,a,o,s){var u,d=[],h=t.fi?t.fi.v:r,f=c(t.gi||[]);try{for(f.s();!(u=f.n()).done;){var m=u.value;if(m.g&&o){var p=m.s?i(m.s,1).scale(a.fromHighPrecisionUnit/4096):n||l.Vector2.Zero;p.equals(l.Vector2.Zero)&&s.Error(0,"No glyph scale");var g=i(m.o).scale(a.fromHighPrecisionUnit),v=m.r?m.r.v*e.c_internalAngleToRadianFactor:0,y=C(m.g,p,g,v,h,o);y&&d.push(y)}}}catch(e){f.e(e)}finally{f.f()}return d}function P(e,t,r,i,n,o,s){var u,d=[],h=c(e.g||[]);try{for(h.s();!(u=h.n()).done;){var m=u.value;d=d.concat(w(m,t,r,i,n,s))}}catch(e){h.e(e)}finally{h.f()}var p,g=c(e.p||[]);try{for(g.s();!(p=g.n()).done;){var y=v(p.value,i.fromHighPrecisionUnit,i.fromHighPrecisionUnit);y&&d.push(new l.Path(y))}}catch(e){g.e(e)}finally{g.f()}var _,S=a(e.lb,i.fromLowPrecisionUnit);if(e.i){var T=f(e.i.i,i),b=a(e.i.b,i.fromLowPrecisionUnit);null!=T&&T.image&&b&&(_=new l.TextImage(T.image,b,o))}return new l.TextCharacter(S,d,e.f?e.f.v:void 0,e.w?e.w.v:void 0,_)}function I(e,t,r,i,n,o,s){var c,u=_(e.rng),d=a(e.lbnd,i.fromLowPrecisionUnit),h=new l.TextLine(u,d),f=[];if(e.c)for(var m=0;m<e.c.length;m++){var p=P(e.c[m],t.getAt(h.localRange.start+m),r.getAt(h.localRange.start+m),i,n,o,s);p&&f.push(p)}else null!==(c=e.s)&&void 0!==c&&c.v&&(f=function(e,t,r,i,n,a,o,s){for(var c=[],u=e.split(";"),d=0;d<u.length;d++){for(var h=u[d].split(/([A-VXYZ])/),f=h.length>0?h[0]:void 0,m=void 0,p=void 0,g=1;g<h.length-1;g+=2){var v=h[g];"L"==v&&(m=h[g+1]),"R"==v&&(p=h[g+1])}if(f&&m&&p){var y=parseFloat(m)*o.fromLowPrecisionUnit,_=parseFloat(p)*o.fromLowPrecisionUnit,S="W"==f,T=void 0;if(!S){var b=C(parseInt(f),n.getAt(a+d),new l.Vector2(y,0),0,i.getAt(a+d),r);b&&(T=[b])}var w=new l.Rect(y,t.top,_,t.bottom);c.push(new l.TextCharacter(w,T,!1,S))}else s.Error(0,"Wrong SimplifiedCharacterString: 0:"+f+", L:"+m+", R:"+p)}return c}(e.s.v,d,n,t,r,h.localRange.start,i,s));return h.characters=f,e.b&&(h.bender=function(e,t){return e.wenv?function(e,t){var r=S(e.tpp,t.fromLowPrecisionUnit),i=S(e.btp,t.fromLowPrecisionUnit);if(r&&i)return new l.WarpingEnvelope(a(e.rct,t.fromLowPrecisionUnit),r,i,e.vrt)}(e.wenv,t):e.plin?function(e,t){var r=S(e.pth,t.fromLowPrecisionUnit);if(r){var i=0==e.algn?0:2==e.algn?1:.5;return new l.PathingLine(a(e.rct,t.fromLowPrecisionUnit),r,i,e.s,e.pvt,e.vrt)}}(e.plin,t):void 0}(e.b,i)),e.o&&(h.offset=new l.Vector2(e.o.x*i.fromLowPrecisionUnit,e.o.y*i.fromLowPrecisionUnit)),h.fillBounds=a(e.fb,i.fromLowPrecisionUnit),h.textEffectMetrics=new l.TextEffectMetrics(e.ea*i.fromLowPrecisionUnit,e.ed*i.fromLowPrecisionUnit,e.eh*i.fromLowPrecisionUnit),h}function k(e,t,r,n,a){var o=new l.TextParagraph(_(e.gr),new l.Style(new l.PatternBrush(l.PatternType.narrowHorizontal,l.Color.Blue,l.Color.Yellow)));e.o&&(o.offset=new l.Vector2(e.o.x*r.fromLowPrecisionUnit,e.o.y*r.fromLowPrecisionUnit));var s,u=new l.RangeDataPartition(""),d=c(e.fipr||[]);try{for(d.s();!(s=d.n()).done;){var h=s.value;u.set(h.fontInfo,_(h.range))}}catch(e){d.e(e)}finally{d.f()}var f,m=new l.RangeDataPartition(l.Vector2.Zero),v=c(e.gspr||[]);try{for(v.s();!(f=v.n()).done;){var y=f.value;m.set(i(y.s,1).scale(r.fromHighPrecisionUnit/4096),_(y.rng))}}catch(e){v.e(e)}finally{v.f()}e.blt&&(o.bullet=function(e,t,r,i,n,a){var o;if(e.c){var s=P(e.c,t,void 0,r,i,n,a),c=p(e.style,r,a),u=e.fx?g(e.fx,r.fromHighPrecisionUnit,1):void 0,d=(null===(o=e.stks)||void 0===o?void 0:o.length)>0?b(e.stks,r,a):void 0;return new l.TextBullet(s,c,u,d)}}(e.blt,e.blt.fi,r,t,n,a));var S,T=new Array,C=c(e.l||[]);try{for(C.s();!(S=C.n()).done;){var w=I(S.value,u,m,r,t,n,a);w&&T.push(w)}}catch(e){C.e(e)}finally{C.f()}var k,E=c(e.spr||[]);try{for(E.s();!(k=E.n()).done;){var x=k.value,L=p(x.style,r,a);o.stylePerLocalRange.set(L,_(x.range))}}catch(e){E.e(e)}finally{E.f()}var A,M=c(e.stkspr||[]);try{for(M.s();!(A=M.n()).done;){var R=A.value,O=b(R.textStrokeList,r,a);O?o.strokesPerLocalRange.set(O,_(R.range)):a.Error(39084627,"Unable to convert stroke")}}catch(e){M.e(e)}finally{M.f()}var D,F=c(e.lwrng||[]);try{for(F.s();!(D=F.n()).done;){var B=D.value;o.addLocalWordRange(_(B))}}catch(e){F.e(e)}finally{F.f()}var N,V=c(e.fxpr||[]);try{for(V.s();!(N=V.n()).done;){var U=N.value;o.effectsPerLocalRange.set(g(U.fx,r.fromHighPrecisionUnit,1),_(U.range))}}catch(e){V.e(e)}finally{V.f()}return o.lines=T,o}function E(e,t){return e?new l.ClipBounds(e.l?e.l.v*t:void 0,e.t?e.t.v*t:void 0,e.r?e.r.v*t:void 0,e.b?e.b.v*t:void 0):void 0}e.c_internalAngleToRadianFactor=2*Math.PI/216e5,e.getPresWidthAndHeightJson=function(e){return new l.Vector2(e.w,e.h)};var x=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0];function L(e){var t=x[e];if(t)return t;var r=new l.FigureBuilder;switch(r.moveTo(0,0),e){case 0:r.cubicBezierTo(0,.367,.124605,.82,.507899,1),r.cubicBezierTo(.724115,.737,.790455,.64,1,.64);break;case 1:r.cubicBezierTo(0,.55627,.44373,1,1,1);break;case 2:r.quadBezierTo(0,.125,.025,.25),r.lineTo(.125,.75),r.cubicBezierTo(.175,1,.25,1,.375,1),r.lineTo(.5,1),r.cubicBezierTo(.625,1,.7,1,.75,.75),r.lineTo(.875,.125),r.cubicBezierTo(.9,.01,.98,.01,1,.01);break;case 3:r.cubicBezierTo(0,.05563,.04437,.1,.1,.1),r.lineTo(.4,.1),r.cubicBezierTo(.45563,.1,.5,.14437,.5,.2),r.lineTo(.5,.9),r.cubicBezierTo(.5,.95563,.54437,1,.6,1);break;case 4:r.lineTo(1,1);break;case 5:r.cubicBezierTo(0,.4775,.0968736,1,.156301,1),r.cubicBezierTo(.264179,1,.376919,.33333,1,.33333);break;case 6:r.cubicBezierTo(0,.07082,.0297458,.1,.101416,.1),r.cubicBezierTo(.501416,.1,.9,.7,.901416,.899999),r.cubicBezierTo(.9,.97167,.93343,1,1,1);break;case 7:r.cubicBezierTo(0,.138122,0,.2,.271356,.775535),r.cubicBezierTo(.377654,1,.519455,1,.583589,1);break;case 8:r.cubicBezierTo(0,.236604,.119276,.607024,.263046,.760235),r.cubicBezierTo(.361098,.864726,.457934,.909567,.537806,.925082),r.cubicBezierTo(.559245,.929246,.567625,.89793,.542066,.845567),r.cubicBezierTo(.484073,.726757,.477103,.393693,.551651,.393693),r.lineTo(.899894,.393693),r.cubicBezierTo(.99148,.393693,.958466,.746659,.907348,.779629),r.lineTo(.879394,.797658),r.cubicBezierTo(.845545,.819489,.848775,.954172,.874334,.971627),r.quadBezierTo(.915883,1,1,1);break;case 9:r.cubicBezierTo(0,.238519,.132047,.500741,.357567,.731852),r.cubicBezierTo(.513167,.891311,.563798,.912593,.735905,.912593),r.lineTo(.873887,.912593),r.cubicBezierTo(.956973,.912593,.878338,1,1,1);break;case 10:r.quadBezierTo(0,.092437,.042353,.305322),r.lineTo(.170124,.947558),r.cubicBezierTo(.177203,.983142,.2,1,.268235,.998599),r.lineTo(.614118,.998599),r.cubicBezierTo(.647059,.998599,.656471,.987395,.663529,.969188),r.cubicBezierTo(.687006,.908633,.802353,.822129,1,.822129);break;case 11:r.cubicBezierTo(0,.184095,.149238,.333333,.333333,.333333),r.cubicBezierTo(.333333,.701523,.63181,1,1,1);break;default:r.lineTo(1,0)}return t=r.createFigure(),x[e]=t,t}function A(e,r,i,n,a){var o=new l.TextLayout,s=new l.Transform(n.translation.negate(),l.Vector2.One,-n.rotation,l.Vector2.Zero);return o.paragraphs=function(e,t,r,i,n){var a,o=[],s=c(e||[]);try{for(s.s();!(a=s.n()).done;){var l=a.value;o.push(k(l,t,r,i,n))}}catch(e){s.e(e)}finally{s.f()}return o}(e.p,r,i,s,a),o.layoutToFrame=t(e.ltfxfrm,i.fromHighPrecisionUnit),o.frameToShape=t(e.ftsxfrm,i.fromHighPrecisionUnit),o.clipBounds=E(e.c,i.fromLowPrecisionUnit),o.applyEffectsPerCharacter=!!e.s&&e.s.v,o}function M(e,r,i,a,u){try{if(!e)return;var d=[],h=t(e.xfrm,a.fromHighPrecisionUnit),f=new Array;if(r){var m,_=c(r);try{for(_.s();!(m=_.n()).done;){var S=m.value;if(S){var T=v(S,a.fromHighPrecisionUnit,a.fromHighPrecisionUnit);T&&f.push(new l.Path(T))}}}catch(e){_.e(e)}finally{_.f()}}e.tx&&function(e,r,i,n,a,u){(0,s.default)(r);var d,h=c(e);try{for(h.s();!(d=h.n()).done;){var f=d.value;if(f.primitives){var m,g=new Array,_=c(f.primitives);try{for(_.s();!(m=_.n()).done;){var S,T=m.value;if(null!=T&&null!==(S=T.p)&&void 0!==S&&S.pts.length){var b=v(T.p,n.fromHighPrecisionUnit,n.fromHighPrecisionUnit);if(!b)continue;b.lineEnabled=!0,b.fillMode=l.PathFillMode.normal,g.push(new l.Path(b))}else if(T.r){var C=y(T.r,n,i);g.push.apply(g,(0,o.default)(C))}}}catch(e){_.e(e)}finally{_.f()}var w={fromLowPrecisionUnit:n.fromLowPrecisionUnit,fromHighPrecisionUnit:n.fromLowPrecisionUnit,fromInch:n.fromInch},P=p(f.style,w,u),I=t(f.xfrm,n.fromHighPrecisionUnit),k=new l.Shape(g,P,void 0,I);k.overlapMode=l.OverlapMode.winding,k.mergeMode=f.union?l.MergeMode.union:l.MergeMode.fragment,k.role=l.ShapeRole.text,a.push(k)}}}catch(e){h.e(e)}finally{h.f()}}(e.tx,h,i,a,d,u);var b=p(e.style,a,u),C=e.fx?g(e.fx,a.fromHighPrecisionUnit,.01):void 0;if(e.tx){var w=C?new l.Effects(void 0,void 0,C.innerShadow,void 0,C.softEdges):void 0,P=C?new l.Effects(C.glow,C.shadow,void 0,C.reflection,void 0):void 0,I=new l.Shape(f,b,w,h);return e.tl&&(I.text=A(e.tl,i,a,h,u)),new l.Group([I].concat(d),P)}var k=new l.Shape(f,b,C,h);if(e.tl&&(k.text=A(e.tl,i,a,h,u)),void 0!==e.ioff){var E,x=[],M=c(e.ioff);try{for(M.s();!(E=M.n()).done;){var R=E.value,O=new l.Vector2(R.x*a.fromHighPrecisionUnit,R.y*a.fromHighPrecisionUnit);x.push(O)}}catch(e){M.e(e)}finally{M.f()}x.length>0&&(k.instances=x.map((function(e){return new l.Instance(l.Matrix3.Translation2D(e))})))}if(e.s3d){var D=e.s3d.tb?new l.Bevel(L(e.s3d.tb.p),new l.Vector2(e.s3d.tb.w*a.fromLowPrecisionUnit,e.s3d.tb.h*a.fromLowPrecisionUnit)):void 0,F=e.s3d.bb?new l.Bevel(L(e.s3d.bb.p),new l.Vector2(e.s3d.bb.w*a.fromLowPrecisionUnit,e.s3d.bb.h*a.fromLowPrecisionUnit)):void 0,B=function(e,t,r,i){var n=t,a=l.MaterialType.Default,o=l.Color.Black,s=l.Color.Black,c=l.Color.Black,u=0,d=!1,h=0,f=0;switch(e){case 0:s=t,d=!0;break;case 1:o=l.Color.White,s=t,u=32,d=!0;break;case 2:var m=l.Color.InterpolateLinear(t,l.Color.Black,1/3);n=m,o=t,s=m,u=32,d=!0,a=l.MaterialType.Metal;break;case 3:a=l.MaterialType.Wireframe;break;case 4:s=t;break;case 5:o=l.Color.Gray(.6),s=t,u=12;break;case 6:var p=l.Color.InterpolateLinear(t,l.Color.White,.2);o=p=l.Color.InterpolateLinear(p,l.Color.White,1.4),s=t,u=12,h=4,a=l.MaterialType.Metal;break;case 7:o=l.Color.Gray(.3),s=t,u=8;break;case 8:var g=new l.Color(t.r,t.g,t.b,.7);n=g,o=l.Color.Gray(.3),s=g,u=10,d=!0,h=2,f=-1;break;case 9:n=l.Color.InterpolateLinear(t,l.Color.White,.5),o=l.Color.Gray(.3),s=l.Color.InterpolateLinear(t,l.Color.White,.5),u=10,d=!0,h=2;break;case 10:o=l.Color.White,s=t,u=35,h=-2;break;case 11:o=l.Color.White,s=t,u=35,h=4,f=-10;break;case 12:var v=new l.Color(t.r,t.g,t.b,.1);n=v,o=l.Color.Gray(.6),s=v,u=20,h=-8,f=1;break;case 13:n=new l.Color(0,0,0,t.a),o=l.Color.Gray(.8),c=t,u=50,h=-4,f=1;break;case 14:n=l.Color.InterpolateLinear(t,l.Color.White,.5),s=t,u=8,a=l.MaterialType.Metal;break;default:o=l.Color.White,s=t,u=40}return r||0!=e&&1!=e&&2!=e||(n=new l.Color(0,0,0,t.a),o=l.Color.Gray(.8),s=l.Color.Black,c=t,u=50,d=!1,h=-4,f=0),new l.Material(a,n,o,s,c,u,d,h,f)}(e.s3d.mt,l.Color.White,b.fillBrush instanceof l.SolidBrush&&b.lineBrush instanceof l.SolidBrush),N=e.s3d.cc?n(e.s3d.cc.v):B.materialType==l.MaterialType.Wireframe?l.Color.Black:void 0,V=e.s3d.cc?e.s3d.cw*a.fromLowPrecisionUnit:0,U=e.s3d.xc?n(e.s3d.xc.v):void 0,W=new l.Shape3D(D,F,B,U,e.s3d.h*a.fromLowPrecisionUnit,N,V,e.s3d.z*a.fromLowPrecisionUnit);k.shape3D=W}return k}catch(e){u.Error(595637020,"Unexpected exception parsing shape")}}function R(e){return e.clientData||(e.clientData={}),e.clientData}function O(e,t,r,i,a){var o;if(e){var s,u=(null===(o=e.bapi)||void 0===o?void 0:o.v)||"";if(e.Items){var d,h=[],f=c(e.Items);try{for(f.s();!(d=f.n()).done;){var m=O(d.value,t,r,i,a);m&&h.push(m)}}catch(e){f.e(e)}finally{f.f()}var p=e.fx?g(e.fx,r.fromHighPrecisionUnit,.01):void 0;s=new l.Group(h,p)}else(s=M(e,e.pthLst||[],t,r,i))&&e.c&&((s=new l.Group([s])).clipBounds=E(e.c,r.fromLowPrecisionUnit));return s&&(s.scene3D=e.scn?function(e){var t,r=[],i=c(e.l||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r.push(new l.Light(new l.Color(a.cr,a.cg,a.cb,1),new l.Vector3(a.dx,a.dy,a.dz),a.ws,a.wo,a.d,a.s))}}catch(e){i.e(e)}finally{i.f()}return new l.Scene3D(n(e.a),r)}(e.scn):void 0,R(s).partId=u,R(s).renderDataId=e.id,null!=a&&a.defaultClientData&&function(e,t){for(var r=R(e),i=0,n=Object.keys(t);i<n.length;i++){var a=n[i];r[a]=t[a]}}(s,a.defaultClientData)),s}}e.convertDocShapeOrGroup=function(e,t,r,i,n){if(e){var a=12700*r;return O(e,t,{fromLowPrecisionUnit:e.lpu?e.lpu.v*a:1,fromHighPrecisionUnit:e.hpu?e.hpu.v*a:r,fromInch:914400*r},i,n)}},e.convertShapeOrGroupRenderData=O}(a||(t.ParseJson=a={}))},function(e,t){e.exports=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CameoViewElement=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(20),c=r(42),u=r(25),d=r(14),h=r(4),f=r(155);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}var g=(0,o.default)((function e(t,r,i,n){var o=this;if((0,a.default)(this,e),this.shapeType=u.ShapeType.Cameo,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_supportedFormats=["RGBA","BGRA","NV12"],this.onCameoSharedTextureUpdated=function(e){o.m_frameSize&&o.m_frameSize.equals(e)||(o.m_frameSize=e,o.maintainAspectRatio()),o.attachSharedTextureToShapeImage(),o.restoreLineBrushIfNeeded()},this.onCameoSharedTextureReleased=function(){o.clearLineBrush()},this.id=t.id,this.m_emuToPixelScale=i,this.m_shapeViewData=r,this.m_environment=n,this.m_cameoTextureManager=f.CameoTextureManager.getInstance(this.m_environment),!r.cameo)throw s.ULS.sendTraceTag(544024275,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"CameoViewElement:: Invalid shapeViewData. cameo:".concat(!!r.cameo,".")),d.VetoUtils.recordVeto("CameoNotRendering",{errorName:"ShapeViewDataMissing",qosVeto:"CameoNotRendering"}),new Error("Invalid cameo");this.m_backgroundProps=r.cameo.backgroundProps;var l=this.m_environment.settings.uiHost;this.m_fTeams=null!=l&&-1!==l.toLowerCase().indexOf("teams");var c=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_size=new u.Vector2(c.region.rect.right-c.region.rect.left,c.region.rect.bottom-c.region.rect.top),!h.Settings.readBooleanOrDefault("forceSvg",!1)&&this.m_environment.rendererEnvironment.glContext||s.ULS.sendTraceTag(529078227,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"CameoViewElement::ctor: in SVG fallback"),s.ULS.sendTraceTag(544024276,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement ctor: ".concat(JSON.stringify(this.getCameoDataLog("CameoViewElement::ctor"))))}),[{key:"ensure",value:function(){this.m_shapeItem||this.init();var e={};return this.m_shapeItem?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e):(s.ULS.sendTraceTag(544024277,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"CameoViewElement::ensure: invalid shapeItem."),d.VetoUtils.recordVeto("CameoNotRendering",{errorName:"FailedShapeItemInit",qosVeto:"CameoNotRendering"}),e.invalidShape=!0,e)}},{key:"ensureCameoTextureAttached",value:function(){this.attachSharedTextureToShapeImage()}},{key:"init",value:function(){if(this.animatableContentViewElements=[],this.m_shapeItem=c.ShapeViewElementUtils.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.isFallbackCameoBrush()&&(s.ULS.sendTraceTag(527447241,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"CameoViewElement::init: Cameo in FillBrush fallback"),d.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"CameoFillBrushFallback",qosVeto:"CameoRenderedWithIssues"})),this.m_originalLineBrush=this.getLineBrush(),this.clearLineBrush(),this.m_originalScale&&this.m_originalOffset||(this.m_originalScale=this.getImageBrushScale(),this.m_originalOffset=this.getImageBrushOffset(),s.ULS.sendTraceTag(527246537,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::init: originalBrushScale=".concat(this.getFormattedVectorString(this.m_originalScale),", originalBrushOffset=").concat(this.getFormattedVectorString(this.m_originalOffset)))),this.setAlphaInvariant(),this.m_shapeItem){var e;if(this.m_shapeItem.transform&&0!==this.m_shapeItem.transform.rotation){var t=this.m_shapeItem.transform.toInverseMatrix3().tryGetTransform(this.m_shapeItem.transform.preTranslation);t||(s.ULS.sendTraceTag(526952522,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"CameoViewElement::init: element is rotated but failed to grab inverse transform. Aspect ratio adjustment may be incorrect!"),d.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"AspectRatioForRotatedCameo",qosVeto:"CameoRenderedWithIssues"})),e=this.m_shapeItem.getBounds(!1,!1,!1,t)}else e=this.m_shapeItem.getBounds(!1,!1,!1);if(e){var r=e.width,i=e.height;this.isCropped()&&this.m_originalScale?this.m_size=new u.Vector2(r*this.m_originalScale.x,i*this.m_originalScale.y):this.m_size=new u.Vector2(r,i)}}this.ensureCameoTextureAttached()}},{key:"update",value:function(){}},{key:"applyAnimation",value:function(e){this.m_shapeItem&&c.ShapeViewElementUtils.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}},{key:"addToScene",value:function(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_cameoTextureManager.events.on("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.on("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.subscribeToSharedTexture()}},{key:"removeFromScene",value:function(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&c.ShapeViewElementUtils.removeFromScene(e,this.m_shapeItem),this.m_cameoTextureManager.events.off("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.off("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.unsubscribeFromSharedTexture(),this.clearLineBrush()}},{key:"tryPrepare",value:function(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}},{key:"cleanUp",value:function(){}},{key:"shapeItem",get:function(){return this.m_shapeItem}},{key:"getCameoInfo",value:function(){return{m_cameoId:c.ShapeViewElementUtils.generateShapeIdString(this.id),m_heightInPixels:this.m_size.y,m_widthInPixels:this.m_size.x,m_formats:this.m_supportedFormats,m_backgroundType:this.m_backgroundProps.backgroundType}}},{key:"attachSharedTextureToShapeImage",value:function(){if(this.m_shapeItem&&this.m_cameoTextureManager.cameoSharedTexture){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this.m_shapeItem.getBrushImages());try{for(t.s();!(e=t.n()).done;){var r=e.value;r.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(r,this.m_cameoTextureManager.cameoSharedTexture),this.m_cameoTextureManager.cameoSharedTexture.changeTracker.notifyChange())}}catch(e){t.e(e)}finally{t.f()}}else s.ULS.sendTraceTag(526987918,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"CameoViewElement::attachSharedTextureToShapeImage: Unexpectedly ShapeItem:".concat(!!this.m_shapeItem," or CameoSharedTexture:").concat(!!this.m_cameoTextureManager.cameoSharedTexture," is undefined"))}},{key:"getCameoDataLog",value:function(e){return{id:JSON.stringify(this.id),fTeams:this.m_fTeams,backgroundType:this.m_backgroundProps.backgroundType,msg:e}}},{key:"isFallbackCameoBrush",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof l.Shape){var e=this.m_shapeItem;if(e.style&&e.style.fillBrush&&e.style.fillBrush instanceof l.ImageBrush&&!e.style.pictureBrush)return!0}return!1}},{key:"isCropped",value:function(){return!(!this.m_originalScale||!this.m_originalOffset||1===this.m_originalScale.x&&1===this.m_originalScale.y&&0===this.m_originalOffset.x&&0===this.m_originalOffset.y)}},{key:"setAlphaInvariant",value:function(){if(this.m_backgroundProps.backgroundType!==u.CameoBackgroundType.Removed){var e=this.getImageBrush();e&&(e.isAlphaInvariant=!0,s.ULS.sendTraceTag(527251170,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}}},{key:"getImageBrush",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof l.Shape){var e=this.m_shapeItem;if(e.style&&e.style.pictureBrush&&e.style.pictureBrush instanceof l.ImageBrush)return e.style.pictureBrush}s.ULS.sendTraceTag(527246538,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"CameoViewElement::getImageBrush: failed to grab ImageBrush (picture)")}},{key:"getImageBrushOffset",value:function(){var e=this.getImageBrush();return e&&e.offset?new u.Vector2(e.offset.x,e.offset.y):new u.Vector2(0,0)}},{key:"getImageBrushScale",value:function(){var e=this.getImageBrush();return e&&e.scale?new u.Vector2(e.scale.x,e.scale.y):new u.Vector2(1,1)}},{key:"getLineBrush",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof l.Shape){var e=this.m_shapeItem;if(e.style&&e.style.lineBrush)return e.style.lineBrush}}},{key:"clearLineBrush",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof l.Shape){var e=this.m_shapeItem;e.style&&e.style.lineBrush&&(e.style.lineBrush=void 0)}}},{key:"restoreLineBrushIfNeeded",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof l.Shape){var e=this.m_shapeItem;this.m_originalLineBrush&&e.style&&!e.style.lineBrush&&(e.style.lineBrush=this.m_originalLineBrush)}}},{key:"getFormattedVectorString",value:function(e){return e?"[x:".concat(e.x.toFixed(4),", y:").concat(e.y.toFixed(4),"]"):"undefined"}},{key:"maintainAspectRatio",value:function(){if(this.m_size&&this.m_frameSize){var e=this.m_frameSize.x,t=this.m_frameSize.y,r=this.m_size.x,i=this.m_size.y,n=this.getImageBrush();if(s.ULS.sendTraceTag(526770845,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::maintainAspectRatio: Frame Size(WxH)=".concat(e,"x").concat(t,".")),n&&n.scale&&n.offset&&0!==i&&0!==r&&0!==t&&0!==e){var a=r/i,o=e/t;if(a===o)return;s.ULS.sendTraceTag(527246539,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::maintainAspectRatio: Started aspect ratio adjustment - frameAspectRatio=[".concat(o.toFixed(6),"], shapeAspectRatio=[").concat(a.toFixed(6),"], scale=").concat(this.getFormattedVectorString(n.scale),", offset=").concat(this.getFormattedVectorString(n.offset))),n.alignment=l.AlignmentType.center;var c=0,d=0;if(a>o?(d=r,c=t/e*r):(c=i,d=e/t*i),this.isCropped()){s.ULS.sendTraceTag(527246540,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::maintainAspectRatio: crop detected - new offset will be calculated"),n.alignment=l.AlignmentType.topLeft;var h=(d-r)/2,f=(c-i)/2;if(this.m_originalOffset&&this.m_originalScale){var m=h*this.m_originalScale.x/r,p=f*this.m_originalScale.y/i,g=new u.Vector2(this.m_originalOffset.x-m,this.m_originalOffset.y-p);n.offset=g}}var v=d/r,y=c/i;if(this.m_originalScale){var _=new u.Vector2(this.m_originalScale.x*v,this.m_originalScale.y*y);n.scale=_}s.ULS.sendTraceTag(528767181,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"CameoViewElement::maintainAspectRatio: Completed aspect ratio adjustment - scale=".concat(this.getFormattedVectorString(n.scale),", offset=").concat(this.getFormattedVectorString(n.offset)))}}}}]);t.CameoViewElement=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaViewElement=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(5)),s=i(r(1)),l=i(r(2)),c=r(25),u=r(20),d=r(49),h=r(341),f=r(3),m=r(14),p=r(35),g=r(52),v=r(42),y=r(54),_=r(11),S=r(4),T=r(168),b=r(342),C=r(343),w=r(58),P=r(346),I=r(347),k=r(348),E=r(349),x=r(350),L=r(351),A=r(352),M=r(353),R=r(354);function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return D(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=function(){function e(t,r,i,n,a,o,l){var u=this;if((0,s.default)(this,e),this.shapeType=c.ShapeType.Media,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fChangingSlide=!1,this.m_lastAnimTimeMS=0,this.m_fHasMediaBeenSynced=!1,this.m_fHasCustomPlayButtonBeenSynced=!1,this.m_fHasOnlineVideoPlayButtonBeenClicked=!1,this.m_fIsPlayerReady=!1,this.m_fSuppressMediaSyncEvents=!0,this.m_fIsGloballyUnmuting=!1,this.m_shouldRenderToCanvas=!1,this.m_hasPendingRender=!1,this.m_fLogCanvasRenderError=!0,this.m_logCanvasInfo=!0,this.m_fCropForCanvasRender=!1,this.m_firstPlayAnimation=!0,this.m_fOnSlide=!1,this.m_isNotAllowedError=!1,this.m_fMuteSyncDisabled=!1,this.m_fPreviouslyMuted=!1,this.m_fMutingOtherMedia=!1,this.m_fIsFirstNavigation=!0,this.m_requestGuid=(0,w.v4)(),this.m_slideScale=1,this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_pixelScale=new c.Vector2(1,1),this.m_wasTranscodingRequested=!1,this.id=t.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_slideSizePixels=a,this.m_shapeViewData=r,this.m_slideEvents=o,this.m_isLoopingBackgroundVideo=void 0,this.m_fCropInSVG=void 0,this.m_presenterToPresenterMediaCycleLockMs=S.Settings.readNumberOrDefault("presenterToPresenterMediaCycleLockMs",1e3),((0,d.isTeams)(n)||S.Settings.readBooleanOrDefault("enablePresenterToPresenterMediaCycleLock",!1))&&(this.m_mediaSyncLock=new h.MediaSyncLock(this.m_presenterToPresenterMediaCycleLockMs)),this.m_slideEvents.on("navigatingFrom",(function(){if(u.m_transparentShapeItem&&(u.m_transparentShapeItem.isHidden=!0),u.m_fSuppressMediaSyncEvents=!0,u.m_localMediaPlaybackController&&!u.m_media.playAcrossSlides&&u.m_localMediaPlaybackController.onNavigatingFrom(),u.m_localMediaInfo&&u.m_localMediaInfo.el){if(u.m_media.playAcrossSlides&&u.m_mediaType===c.MediaType.Audio)return;u.shouldCleanupLocalPlayerOnNavigatedFrom()||(u.resetCurrentTime(u.m_localMediaInfo),u.m_localMediaInfo.el.muted=!0,u.pauseMedia())}u.stopVideoFrameTracker("navigatingFrom"),u.isCaptionsEnabled()&&u.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.onNavigatingFrom(),u.m_onlineVideoPlayer&&u.m_onlineVideoPlaybackTelemetry&&u.m_onlineVideoPlaybackTelemetry.onNavigatingFrom(u.m_onlineVideoPlayer.getPlaybackData()),u.m_localMediaPlayer&&u.m_localMediaPlaybackTelemetry&&u.m_localMediaPlaybackTelemetry.onNavigatingFrom(u.m_localMediaPlayer.getPlaybackData())})),this.m_slideEvents.on("navigatedFrom",(function(){u.m_fOnSlide=!1,u.m_fHasMediaBeenSynced=!1,u.m_fIsPlayerReady=!1,u.m_fHasCustomPlayButtonBeenSynced=!1,u.m_fHasOnlineVideoPlayButtonBeenClicked=!1,u.m_fLinkedMediaReachedEnd&&(u.m_fLinkedMediaReachedEnd=!1),u.m_localMediaInfo&&(u.m_localMediaInfo.fReachedEnd=!1),u.cleanupLocalPlayerOnNavigatedFrom(),u.cleanupOnlinePlayerOnNavigatedFrom()})),this.m_slideEvents.on("navigatingTo",(function(){u.m_isPrefetch=!1,u.m_localMediaPlaybackController&&!u.m_media.playAcrossSlides&&u.m_localMediaPlaybackController.onNavigatingTo(),u.m_localMediaPlaybackPerf&&u.m_localMediaPlaybackPerf.onNavigatingTo(),u.m_transparentShapeItem&&(u.m_transparentShapeItem.isHidden=!0),u.resetLocalPlayerOnNavigatingTo()})),this.m_slideEvents.on("navigatedTo",(function(){if(u.m_fOnSlide=!0,u.m_onlineVideoPlayer&&(u.m_onlineVideoPlaybackTelemetry&&u.m_onlineVideoPlaybackTelemetry.onNavigatedTo(),u.m_fIsFirstNavigation||u.m_onlineVideoPlayer.ensure(),(u.m_mediaType===c.MediaType.YouTube||u.m_mediaType===c.MediaType.Vimeo)&&u.isVideoPartiallyOffSlide())){var t=u.ensureLinkedMediaElementDiv(),r=p.ViewController.getElementFromCollection(t.children,e.LinkedMediaContainerName);u.handlePartiallyOffSlideLinkedMedia(r),f.ULS.sendTraceTag(559244870,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Linked media with type:".concat(u.m_mediaType," is partially off slide."))}u.m_localMediaPlaybackTelemetry&&u.m_localMediaPlaybackTelemetry.onNavigatedTo(),u.m_media.autoPlay&&(f.ULS.sendTraceTag(508630853,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Calling playMedia on autoplay media ".concat(u.m_media.name," upon arrival to slide")),u.playMedia()),u.m_fChangingSlide=!1,u.m_firstPlayAnimation=!0,u.m_isPrefetch=!1,u.m_fIsFirstNavigation=!1})),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",(function(){return u.beforeFirstRender()})),!r.media)throw f.ULS.sendTraceTag(594909142,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement:: Invalid shapeViewData. media:".concat(!!r.media,", animatableContents.length:").concat(this.m_shapeViewData.animatableContents.length,", parts.length:").concat(this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0,".")),new Error("Invalid media");var m=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_mediaSize=new c.Vector2(m.region.rect.right-m.region.rect.left,m.region.rect.bottom-m.region.rect.top),this.m_mediaPosition=new c.Vector2(m.pos.x,m.pos.y),this.m_media=r.media,this.m_mediaType=e.getMediaType(this.m_media),this.m_isPrefetch=l||!1,this.m_environment=n,this.ShapeMediaTargetId="media-element-".concat(JSON.stringify(this.id)),this.m_fLogCanvasRenderError=!0,this.updatePixelScale(),this.m_useTranscodedVideos=this.m_mediaType===c.MediaType.Video&&(!S.Settings.readBooleanOrDefault("useTranscodingForMobileOnly",!1)||(0,d.isMobileDevice)(this.m_environment))&&this.isMediaDownloadHandlerEnabled(this.m_media.src),this.m_isTranscoded=this.m_useTranscodedVideos,this.m_initialRetryCount=this.getTotalRetryCount(),p.exposed.updateMediaSource=function(e){u.m_localMediaInfo&&u.m_localMediaInfo.el&&(u.m_localMediaInfo.el.src=e),u.playLocalMedia()},p.exposed.updateMediaSourceHLS=function(e){u.m_localMediaInfo&&u.m_localMediaInfo.el&&u.setHlsSourceAsync(e,u.m_localMediaInfo.el),u.playLocalMedia()},this.m_gfxVideoSettings=this.createGfxVideoAppSettings(),(0,y.setSettingCallbacks)({getBoolean:function(e){var t=u.m_gfxVideoSettings[e];return"boolean"==typeof t?t:S.Settings.readBooleanOrDefault(e,!1)},getNumber:function(e){var t=u.m_gfxVideoSettings[e];return"number"==typeof t?t:S.Settings.readNumberOrDefault(e,0)},getString:function(e){var t=u.m_gfxVideoSettings[e];return"string"==typeof t?t:S.Settings.readStringOrDefault(e,"")}})}return(0,l.default)(e,[{key:"beforeFirstRender",value:function(){var e=this;if(this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!1),this.m_fChangingSlide=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el){var t=this.m_localMediaInfo.el;this.m_localMediaInfo.fMutedInFile||(t.muted=!1),this.addCaptionTracks(this.m_localMediaInfo.el),f.ULS.sendTraceTag(540919814,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement: Local video muted: ".concat(t.muted));var r=this.useLoadedMetadataAsInteractivityEvent();this.verifyPlatfromSpecificReadyState(this.m_localMediaInfo)?this.onPlayerReadyCallBack():t.addEventListener(r?"loadedmetadata":"canplay",(function(){e.onPlayerReadyCallBack()}),{once:!0}),this.shouldRenderToCanvas&&(this.m_localMediaInfo.el.style.opacity="0",this.m_localMediaInfo.el.controls=!1),this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!1,this.isCaptionsEnabled()&&this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.stopCaptionTrack())}}},{key:"shouldCleanupLocalPlayerOnNavigatedFrom",value:function(){return!(!S.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)&&this.m_media.autoPlay)}},{key:"cleanupLocalPlayerOnNavigatedFrom",value:function(){this.m_localMediaPlayer&&this.m_localMediaPlayer.cleanup(),this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.cleanupPlayerOnNavigatedFrom():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&!this.m_media.playAcrossSlides&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&(this.m_localMediaInfo.el.src&&f.ULS.sendTraceTag(540587273,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Cancelling media request requestGuid: ".concat(this.m_requestGuid)),_.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")||(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_wasTranscodingRequested=!1,_.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")&&(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),f.ULS.sendTraceTag(558965442,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::cleanupLocalPlayerOnNavigatedFrom"))}},{key:"cleanupOnlinePlayerOnNavigatedFrom",value:function(){this.m_localMediaInfo&&this.m_localMediaInfo.el||this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(557176144,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::cleanupOnlinePlayerOnNavigatedFrom: ".concat(this.m_media.name,".")),this.m_onlineVideoPlayer.cleanup())}},{key:"resetLocalPlayerOnNavigatingTo",value:function(){this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.resetPlayerOnNavigatingTo():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&!this.m_localMediaInfo.el.src&&(this.m_localMediaInfo.retriesRemaining=this.m_initialRetryCount,_.ChangeGate.isChangeGateEnabled("SVM.ResetRetryTimeout")&&(this.m_localMediaInfo.retryTimeoutMs=S.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",e.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS)),this.setSourceAsync(this.m_localMediaInfo.el,this.m_localMediaInfo),f.ULS.sendTraceTag(558965443,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::resetLocalPlayerOnNavigatingTo"))}},{key:"ensure",value:function(){this.m_shapeItem||this.init();var e={name:this.m_media.name,type:c.MediaType[this.m_mediaType],contentType:this.m_media.contentType,fPlayable:this.isMediaPlayable(this.m_media.contentType),fAutoPlay:this.m_media.autoPlay,playAcrossSlides:this.m_media.playAcrossSlides,fullBleed:this.m_mediaType!==c.MediaType.Video&&this.m_mediaType!==c.MediaType.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fFullBleed):"undefined",looping:this.m_mediaType!==c.MediaType.Video&&this.m_mediaType!==c.MediaType.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fLooping):"undefined",muted:this.m_mediaType!==c.MediaType.Video&&this.m_mediaType!==c.MediaType.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fMutedInFile):"undefined"};this.shouldRenderToCanvas||!this.m_environment.settings.transparentCanvasForVideoEnabled||this.m_transparentShapeItem||(e.fTransparentCanvas=this.initTransparentShape());var t={mediaInfo:e};if(!this.m_shapeItem)return f.ULS.sendTraceTag(594909143,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::ensure: invalid shapeItem."),t.invalidShape=!0,t;var r=v.ShapeViewElementUtils.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return B(B({},t),r)}},{key:"init",value:function(){if(this.animatableContentViewElements=[],this.m_shapeItem=v.ShapeViewElementUtils.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),(0,y.setVideoLogger)({info:function(e,t){f.ULS.sendTraceTag(e,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,t)},warn:function(e,t){f.ULS.sendTraceTag(e,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,t)},error:function(e,t){f.ULS.sendTraceTag(e,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,t)}}),this.m_mediaType!==c.MediaType.Audio&&this.m_mediaType!==c.MediaType.Video||!this.m_shapeItem)this.initLinkedMediaInfo();else if(this.initLocalMediaInfo(),this.m_localMediaInfo&&S.Settings.readBooleanOrDefault("forceSvg",!1)){var e=this.m_environment.rendererEnvironment.renderer;this.m_shapeItem.getType()===u.ItemType.group?e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem.items.getAt(0)):e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem)}}},{key:"initTransparentShape",value:function(){return!!this.isUnderlayElements()&&!!this.isMediaPlayable(this.m_media.contentType)&&(this.m_transparentShapeItem=u.Shape.CreateRectangle(new u.Rect(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+this.m_mediaSize.x,this.m_mediaPosition.y+this.m_mediaSize.y),new u.Style(new u.SolidBrush(u.Color.White),void 0,void 0,u.BlendingMode.cutout)),!0)}},{key:"setAlphaInvariant",value:function(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.Shape){var e=this.m_shapeItem;e.style.pictureBrush&&(e.style.pictureBrush.isAlphaInvariant=!0,f.ULS.sendTraceTag(523870277,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}}},{key:"isUnderlayElements",value:function(){return this.m_mediaType===c.MediaType.Video&&!this.shouldRenderToCanvas||this.m_mediaType===c.MediaType.YouTube||this.m_mediaType===c.MediaType.StreamClassic||this.m_mediaType===c.MediaType.Vimeo||this.m_mediaType===c.MediaType.Flip||this.m_mediaType===c.MediaType.Ted||this.m_mediaType===c.MediaType.Stream2}},{key:"shouldRenderToCanvas",get:function(){return this.m_shouldRenderToCanvas}},{key:"isPlaybackControlsEnabled",value:function(){return!(!(0,d.isTeams)(this.m_environment)&&!(0,d.isTeamsWeb)(this.m_environment))||S.Settings.readBooleanOrDefault("usePlaybackControls",!1)}},{key:"usePlaybackControls",value:function(){return this.m_mediaType===c.MediaType.Video&&(this.isPlaybackControlsEnabled()||this.m_shouldRenderToCanvas)&&""!==L.PlaybackControlHelper.getCssPath(this.m_environment)}},{key:"isVideoCropped",value:function(e){if(!e.style.pictureBrush)return!1;if(1!==e.style.pictureBrush.scale.x||1!==e.style.pictureBrush.scale.y||0!==e.style.pictureBrush.offset.x||0!==e.style.pictureBrush.offset.y)return!0;var t=this.m_shapeViewData.shapeBuilderData.style.pctBrush;return!!(t.cs&&1!==t.cs.x&&0!==t.cs.x||t.cs&&1!==t.cs.y&&0!==t.cs.y||t.co&&0!==t.co.x||t.co&&0!==t.co.y)&&(this.m_fCropForCanvasRender=!0,!0)}},{key:"shouldRenderLocalVideoToCanvas",value:function(t){if(!t)return!1;var r=!(0,d.isPPTO)(this.m_environment)||S.Settings.readBooleanOrDefault("renderLocalVideoToCanvas",!1);if(t instanceof u.Shape){var i=t,n=this.isVideoCropped(i),a=e.isVideoCroppedToShape(i),o=e.isVideoRotated(i);if(f.ULS.sendTraceTag(509752475,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media:".concat(this.m_media.name," has crop:").concat(n,", crop-to-shape:").concat(a,", outline:").concat(i.style.lineBrush,", rotation:").concat(o,", effects:").concat(i.effects.hasEffects,". Rendering canvas: ").concat(this.m_environment.rendererEnvironment,".")),i.effects.hasEffects&&f.ULS.sendTraceTag(509752474,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media has effects applied. Glow:".concat(void 0!==i.effects.glow,", Shadow:").concat(i.effects.shadow,", InnerShadow:").concat(void 0!==i.effects.innerShadow,", Reflection:").concat(i.effects.reflection,", SoftEdges:").concat(i.effects.softEdges,". Rendering canvas: ").concat(this.m_environment.rendererEnvironment,".")),r&&(n||a||i.style.lineBrush||o))return!this.shouldRenderEffects()&&i.effects.hasEffects&&this.removeEffects(i),!0}return this.shouldRenderEffects()&&t.effects.hasEffects}},{key:"shouldRenderEffects",value:function(){return!!(0,d.isTeams)(this.m_environment)||S.Settings.readBooleanOrDefault("renderVideoWithEffectsToCanvas",!1)}},{key:"removeEffects",value:function(t){t.effects.hasEffects&&(t.effects.shadow=void 0,t.effects.innerShadow=void 0,t.effects.reflection=void 0,t.effects.softEdges=void 0,t.effects.glow=void 0,this.isVideoCropped(t)||e.isVideoCroppedToShape(t)||(t.paths=void 0,t.clearPathCache()),f.ULS.sendTraceTag(520618384,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"removeEffects: media = ".concat(this.m_media.name,". shouldRenderToCanvas = ").concat(this.m_shouldRenderToCanvas)))}},{key:"isPlaying",value:function(){var e=this.getMediaCurrentState();return void 0===e&&f.ULS.sendTraceTag(512234247,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"isPlaying: mediaState is undefined"),void 0!==e&&e.playerState===c.MediaPlayerState.MediaPlayed}},{key:"shouldUpdateMediaOnCanvas",value:function(){return this.shouldRenderToCanvas&&(this.isPlaying()||this.m_hasPendingRender)}},{key:"update",value:function(){this.m_mediaType===c.MediaType.Audio||this.m_mediaType===c.MediaType.Video?this.updateLocalMediaElement():this.updateLinkedMediaElement(),this.shouldUpdateMediaOnCanvas()&&this.renderFrame()}},{key:"renderFrame",value:function(){if(this.m_fIsPlayerReady){this.m_hasPendingRender=!1;var e=this.m_environment.rendererEnvironment.glContext;if(this.m_localMediaInfo&&this.m_localMediaInfo.el&&e&&!e.isContextLost()){try{this.m_videoTexture=u.Texture.CreateOrUpdateFromHTMLElement("video",this.m_videoTexture,this.m_environment.rendererEnvironment.renderer,this.m_localMediaInfo.el),this.m_logCanvasInfo&&(f.ULS.sendTraceTag(509096201,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"CreateOrUpdateFromHTMLElement succeeded for media: ".concat(this.m_media.name)),this.m_logCanvasInfo=!1)}catch(e){return void(this.m_fLogCanvasRenderError&&(f.ULS.sendTraceTag(542935119,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::renderFrame: Unable to draw video frame. CreateOrUpdateFromHTMLElement threw an exception: ".concat(e," for media: ").concat(this.m_media.name,".")),m.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"CreateOrUpdateFromHTMLElementException",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1))}if(this.m_shapeItem){var t=this.m_shapeItem;if(t.style.pictureBrush&&this.m_fCropForCanvasRender){var r=this.m_shapeViewData.shapeBuilderData.style.pctBrush;t.style.pictureBrush.scale=new c.Vector2(r.cs.x,r.cs.y),t.style.pictureBrush.offset=new c.Vector2(r.co.x,r.co.y)}var i,n=O(this.m_shapeItem.getBrushImages());try{for(n.s();!(i=n.n()).done;){var a=i.value;a.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(a,this.m_videoTexture),this.m_videoTexture.changeTracker.notifyChange())}}catch(e){n.e(e)}finally{n.f()}this.m_frameTracker&&this.m_frameTracker.updateRenderFrameCount()}else this.m_fLogCanvasRenderError&&(f.ULS.sendTraceTag(545378768,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::renderFrame: Unable to draw video frame. ShapeItem:".concat(!!this.m_shapeItem)),m.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"MissingShapeItem",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1)}else this.m_fLogCanvasRenderError&&(f.ULS.sendTraceTag(545378765,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::renderFrame: Unable to draw video frame. m_localMediaInfo: ".concat(!!this.m_localMediaInfo,".\n          m_localMediaInfo.el: ").concat(this.m_localMediaInfo?!!this.m_localMediaInfo.el:"",".\n          gl: ").concat(!!e,".\n          isContextLost: ").concat(e?e.isContextLost():"")),m.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"RenderingContextLost",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1)}else f.ULS.sendTraceTag(512234246,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"renderFrame called while m_fIsPlayerReady = ".concat(this.m_fIsPlayerReady))}},{key:"applyAnimation",value:function(e,t){if(this.m_shapeItem){if(this.m_mediaType!==c.MediaType.Audio||_.ChangeGate.isChangeGateEnabled("disableAnimationsOnAudio")){var r,i=O(e.Attributes);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.AttrId!==g.AnimAttributeId.Visible&&n.AttrId!==g.AnimAttributeId.MediaPlaybackCmd)return}}catch(e){i.e(e)}finally{i.f()}}if(!this.m_fChangingSlide){var a=g.AnimAttributeHelper.getAnimAttributeValue(e.Attributes,g.AnimAttributeId.MediaPlaybackCmd,null);if(null!=a){var o=S.Settings.readNumberOrDefault("minMediaAnimationSpacing",200),s=Date.now()-this.m_lastAnimTimeMS;if(s<o)f.ULS.sendTraceTag(557417807,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Skipping animation command as it's been less than minMediaAnimationSpacing: ".concat(o,"(ms), actual: ").concat(s,"(ms), mediaCmd: ").concat(a.mediaCmd));else{this.m_lastAnimTimeMS=Date.now();var l=!(this.m_localMediaInfo&&this.m_localMediaInfo.el||!this.m_onlineVideoPlayer);if(f.ULS.sendTraceTag(556316491,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Animation media cmd: ".concat(a.mediaCmd,"; Online: ").concat(l)),-1!==a.mediaCmd.toLowerCase().indexOf("play")){var u=d.MediaHelper.parseSeekTimeFromMediaCommandString(a.mediaCmd,this.m_media.bmkLst?this.m_media.bmkLst:[]);if(-1===u)this.m_lastAnimTimeMS=0,f.ULS.sendTraceTag(571236834,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"Not able to parse time from media cmd : ".concat(a.mediaCmd,"."));else{if(this.shouldSkipAnimation(t))return;this.m_firstPlayAnimation=!1,this.m_media.trimStartMs>0&&(u+=this.m_media.trimStartMs/1e3),this.seekMedia(u),this.playMedia(),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setInClickSequence(),this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.setInClickSequence(),this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setInClickSequence()}}else-1!==a.mediaCmd.toLowerCase().indexOf("togglepause")?this.togglePauseMedia():-1!==a.mediaCmd.toLowerCase().indexOf("stop")?this.stopMedia():(this.m_lastAnimTimeMS=0,f.ULS.sendTraceTag(561639819,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"Unsupported animation media command : ".concat(a.mediaCmd,".")))}}}v.ShapeViewElementUtils.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData),this.m_mediaType===c.MediaType.Audio&&this.m_media&&this.m_media.hideWhenStopped&&this.shapeItem&&(this.shapeItem.isHidden=!0)}}},{key:"addToScene",value:function(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_transparentShapeItem&&e.items.push(this.m_transparentShapeItem)}},{key:"removeFromScene",value:function(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&v.ShapeViewElementUtils.removeFromScene(e,this.m_shapeItem),this.m_transparentShapeItem&&-1!==e.items.elements.indexOf(this.m_transparentShapeItem)&&v.ShapeViewElementUtils.removeFromScene(e,this.m_transparentShapeItem)}},{key:"playMedia",value:function(){this.restorePreviousMuteState(),this.muteAllPlayingMediaiOS(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(f.ULS.sendTraceTag(588002453,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Playing media for received event, from host. media: ".concat(this.m_media.name,".")),this.playLocalMedia()):this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(578609472,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Playing online media for received event, from host. media: ".concat(this.m_media.name,".")),this.m_onlineVideoPlayer.playMedia())}},{key:"playLocalMedia",value:function(){var e=this;if(this.m_localMediaInfo&&this.m_localMediaInfo.el)if(S.Settings.readBooleanOrDefault("mutedPlaybackOnNotAllowedError",!0)){var t=this.playHelper(this.m_localMediaInfo);void 0!==t&&t.then((function(){f.ULS.sendTraceTag(538722767,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Local media playback started for media: ".concat(e.m_media.name,"."))})).catch((function(t){f.ULS.sendTraceTag(538722768,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Local media playback failed to start for media: ".concat(e.m_media.name,", error: ").concat(t.name,", isTeams: ").concat((0,d.isTeams)(e.m_environment),", isTeamsWeb: ").concat((0,d.isTeamsWeb)(e.m_environment),".")),"NotAllowedError"===t.name&&(0,d.isTeamsWeb)(e.m_environment)?e.playLocalMediaMuted():m.VetoUtils.recordVeto("MediaPlaybackFailure",{qosVeto:"MediaPlaybackFailure",errorName:"MediaPlayPromiseFailed_".concat(t.name),media:e.m_media.name,msg:t.message})}))}else this.playHelper(this.m_localMediaInfo)}},{key:"playLocalMediaMuted",value:function(){this.m_localMediaInfo&&this.m_localMediaInfo.el&&(f.ULS.sendTraceTag(538722769,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Starting local media playback muted: ".concat(this.m_media.name,".")),this.m_localMediaInfo.el.muted=!0,this.playHelper(this.m_localMediaInfo))}},{key:"pauseMedia",value:function(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(f.ULS.sendTraceTag(588002454,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Pausing media for received event, from host. media: ".concat(this.m_media.name,".")),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(578609433,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Pausing online media for received event, from host. media: ".concat(this.m_media.name,".")),this.m_onlineVideoPlayer.pauseMedia())}},{key:"togglePauseMedia",value:function(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(f.ULS.sendTraceTag(571236864,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Toggle pausing media. media: ".concat(this.m_media.name,".")),this.m_localMediaInfo.el.paused?(this.muteAllPlayingMediaiOS(),this.playHelper(this.m_localMediaInfo)):this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(571236835,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Toggle pause online media. media: ".concat(this.m_media.name,".")),this.m_onlineVideoPlayer.isPaused()&&this.muteAllPlayingMediaiOS(),this.m_onlineVideoPlayer.togglePauseMedia())}},{key:"syncOnlineVideoPoster",value:function(e){(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?e.state.playerState===c.MediaPlayerState.MediaPaused&&this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.showPoster():this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.hidePoster())}},{key:"updateMediaState",value:function(e){if(!this.m_fHasOnlineVideoPlayButtonBeenClicked||this.m_fIsPlayerReady&&!e.origin.isFromLocalCache)if(this.m_fIsPlayerReady&&(this.m_fHasMediaBeenSynced=!0),this.m_mediaSyncLock&&this.m_mediaSyncLock.updateLastTimeRecievedEvent(),this.m_fIsPlayerReady&&(this.m_onlineVideoPlayer?this.syncOnlineVideoPoster(e):S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===c.MediaType.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?e.state.playerState===c.MediaPlayerState.MediaPaused&&(this.setCustomPlayButtonVisible(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!1)):(this.m_fHasCustomPlayButtonBeenSynced=!0,this.setCustomPlayButtonHidden(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!0)))),this.shouldSyncMediaEnded(e)){if(this.shouldSyncMediaVolumeChanged(e)){var t=S.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute;if(t||this.m_fMuteSyncDisabled||(void 0!==e.state.volume&&this.setMediaVolume(e.state.volume),void 0!==e.state.muted&&this.setMediaMute(e.state.muted)),!e.origin.isFromLocalCache&&!e.origin.isFromRoleChange&&!e.origin.isFromStateServiceCache)return void(0,d.updateMediaSyncMetadataAndLog)("Only Attempted to Sync Mute/Volume State (globalMuteOverride: ".concat(t,", fMuteSyncDisabled: ").concat(this.m_fMuteSyncDisabled,")"),"MediaViewElement",e)}var r=.001*e.state.playerPositionSkew;void 0!==e.state.position&&this.seekMedia(e.state.position+r),this.syncPlayerState(e.state.playerState),(0,d.updateMediaSyncMetadataAndLog)("Media Sync Attempt Finished","MediaViewElement",e)}else(0,d.updateMediaSyncMetadataAndLog)("Blocking - Media Sync Message Originated from MediaEnded Event","MediaViewElement",e);else(0,d.updateMediaSyncMetadataAndLog)("Blocking - Preserving pending play command for online video is executed before syncing state to presenter","MediaViewElement",e)}},{key:"updateVideoPlayButtonVisibility",value:function(e){if(S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&S.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&(this.m_environment.settings.showCustomPlayButtonForVideo=e,this.m_mediaType===c.MediaType.Video&&!this.m_media.autoPlay&&this.m_localMediaInfo&&this.m_localMediaInfo.el)){var t=this.isCustomPlayButtonVisible();!e&&t?this.setCustomPlayButtonHidden():!e||t||this.isPlaying()||(this.setCustomPlayButtonVisible(),this.m_localMediaInfo.el.controls=!1)}}},{key:"syncPlayerState",value:function(e){if(void 0!==e)switch(e){case c.MediaPlayerState.MediaPlayed:this.playMedia();break;case c.MediaPlayerState.MediaPaused:this.pauseMedia();break;case c.MediaPlayerState.MediaEnded:break;default:f.ULS.sendTraceTag(556398351,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Unexpected player state when updating media state ".concat(this.m_media.name,", ").concat(this.m_mediaType,", ").concat(e,"."))}}},{key:"initAfterSlideContentChanged",value:function(){if(S.Settings.readBooleanOrDefault("initMediaAfterSlideContentChanged",!0)){var e=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",t=v.ShapeViewElementUtils.ensureShapeViewElementParentDiv(this.id,e,this.m_media&&this.m_media.playAcrossSlides>0);if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if((this.usePlaybackControls()||this.shouldRenderToCanvas)&&this.ensureVideoEventsDiv(t),S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&S.Settings.readBooleanOrDefault("forceSVG",!1)&&this.m_mediaType===c.MediaType.Video&&!this.m_playButtonHandler){var r=this.getBounds(),i=this.createCustomPlayButton(t,r);this.m_playButtonHandler=new P.MediaPlayButtonHandler(i,this.m_isNotAllowedError),this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo||this.isPlaying()?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible()}this.beforeFirstRender()}}}},{key:"seekMedia",value:function(e){this.m_localMediaInfo&&this.m_localMediaInfo.el?(f.ULS.sendTraceTag(588002455,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Seek media for received event, from host. media: ".concat(this.m_media.name," at position: ").concat(e,".")),this.setCurrentTime(this.m_localMediaInfo,e)):this.m_onlineVideoPlayer&&(this.m_onlineVideoPlayer.seekMedia(e),f.ULS.sendTraceTag(575545991,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Seek online media for received event, from host. media: ".concat(this.m_media.name," at position: ").concat(e,".")))}},{key:"setSourceAsync",value:(o=(0,a.default)(n.default.mark((function t(r,i){var a,o,s;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.m_localMediaPlaybackSource){t.next=3;break}return f.ULS.sendTraceTag(512271843,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Unexpected setSourceAsync with LocalMediaPlaybackSource"),t.abrupt("return");case 3:if(a=this.generateMediaSrcUrl(i.mediaUrl,i.retriesRemaining),this.isMediaPlayable(this.m_media.contentType)){t.next=6;break}return t.abrupt("return");case 6:try{this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onSourceSet(a),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onSourceSet(a)}catch(e){f.ULS.sendTraceTag(556048640,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: ".concat(e))}return f.ULS.sendTraceTag(540587274,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Creating media request requestGuid: ".concat(this.m_requestGuid,", retriesRemaining: ").concat(i.retriesRemaining)),this.m_localMediaPlaybackController&&(o=new URL(a),this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,i.retriesRemaining,e.getMediaLengthFromMediaUrl(o),this.m_isTranscoded)),t.next=11,this.setHlsSourceAsync(a,r);case 11:if(t.sent){t.next=28;break}if(this.m_hlsError=!1,this.m_wasLoadStarted=!1,s=new URL(a),!_.ChangeGate.isChangeGateEnabled("SVM.DisableProgressiveTranscoding")||!this.m_isTranscoded){t.next=27;break}if(!this.isPlayable()){t.next=23;break}s.searchParams.delete("transcode"),this.m_isTranscoded=!1,this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setIsTranscoding(!1),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality(d.TranscodedMediaQuality.Raw),t.next=27;break;case 23:return f.ULS.sendTraceTag(512336969,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setSourceAsync setHlsSource failed for unplayable media, mediaName: ".concat(this.m_media.name,", retrying.")),this.m_hlsError=!0,this.onMediaError(i),t.abrupt("return");case 27:r.src=s.toString();case 28:case"end":return t.stop()}}),t,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setHlsSourceAsync",value:(i=(0,a.default)(n.default.mark((function e(t,r){var i,a,o,s,l;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsAutoRecoverRetryCount=0,this.setHlsBandwidthEstimatesForTelemetry(void 0),this.setIsHlsForTelemetry(!1),i=!_.ChangeGate.isChangeGateEnabled("SVM.UnplayableUsesHLS")||this.isPlayable(),a=this.m_hlsErrorCount>=this.getHLSRetryCount(),!i||!a){e.next=9;break}return e.abrupt("return",!1);case 9:if(this.m_mediaType===c.MediaType.Video){e.next=11;break}return e.abrupt("return",!1);case 11:if(this.isMediaDownloadHandlerEnabled(t)){e.next=13;break}return e.abrupt("return",!1);case 13:if(-1===t.indexOf("disableHLS")){e.next=16;break}return f.ULS.sendTraceTag(520153309,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::generateMediaSrcUrl disable HLS for mediaName: ".concat(this.m_media.name)),e.abrupt("return",!1);case 16:if(this.isMP4()||this.m_isTranscoded){e.next=19;break}return f.ULS.sendTraceTag(512336968,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::setHlsSourceAsync Tried using HLS+Raw for non-MP4 file, mediaName: ".concat(this.m_media.name)),e.abrupt("return",!1);case 19:if(o=t,this.m_isTranscoded&&!(0,d.isMobileDevice)(this.m_environment)&&((s=new URL(o)).searchParams.set("transcode","All"),o=s.toString()),!S.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1)){e.next=32;break}return e.next=24,this.tryImportHLSJsInstance();case 24:if(!e.sent){e.next=27;break}this.tryInitializeHLSJs(),f.ULS.sendTraceTag(509655110,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setHlsSourceAsync() HLS js initialized successfully");case 27:if(void 0!==this.m_hls||!this.setNativeHlsSource(o,r)){e.next=30;break}return f.ULS.sendTraceTag(509655109,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setHlsSourceAsync() Native HLS set successfully"),e.abrupt("return",!0);case 30:e.next=38;break;case 32:if(!this.setNativeHlsSource(o,r)){e.next=34;break}return e.abrupt("return",!0);case 34:return e.next=36,this.tryImportHLSJsInstance();case 36:if(!e.sent){e.next=38;break}this.tryInitializeHLSJs();case 38:if(l=d.UIHostType[(0,d.getUIHostType)(this.m_environment)],!this.m_hls){e.next=46;break}return f.ULS.sendTraceTag(524817115,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"HLS mediaName: ".concat(this.m_media.name," requestGuid: ").concat(this.m_requestGuid," uiHostType: ").concat(l)),this.m_wasLoadStarted=!1,this.m_hls.loadSource(this.getHLSUrlWithSlashes(o)),this.m_hls.attachMedia(r),this.setIsHlsForTelemetry(!0),e.abrupt("return",!0);case 46:return f.ULS.sendTraceTag(524898944,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"HLS is not supported: ".concat(l)),e.abrupt("return",!1);case 48:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"isMP4",value:function(){return"video/mp4"===this.m_media.contentType}},{key:"isPlayable",value:function(){return this.getMediaRenderAs(this.m_media.contentType)!==d.RenderAs.None}},{key:"getHLSRetryCount",value:function(){return this.isMP4()&&this.m_wasTranscodingRequested?2:1}},{key:"tryImportHLSJsInstance",value:(t=(0,a.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.e(13).then(r.bind(null,210));case 3:e.m_hlsJs=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),f.ULS.sendTraceTag(523031559,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Exception importing hls.js: ".concat(t.t0));case 9:if(e.m_hlsJs){t.next=11;break}return t.abrupt("return",!1);case 11:return t.abrupt("return",!0);case 12:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return t.apply(this,arguments)})},{key:"tryInitializeHLSJs",value:function(){var t=this;if(e.m_hlsJs&&f.ULS.sendTraceTag(509655108,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::tryInitializeHLSJs(): HLS.js supported for uiHostType ".concat(d.UIHostType[(0,d.getUIHostType)(this.m_environment)],": ").concat(e.m_hlsJs.default.isSupported())),e.m_hlsJs&&!this.m_hls&&e.m_hlsJs.default.isSupported()){var r=(0,d.isMobileDevice)(this.m_environment)?S.Settings.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):S.Settings.readNumberOrDefault("hlsBackBufferLength",1/0),i=!_.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream");this.m_hls=new e.m_hlsJs.default({progressive:i,backBufferLength:r}),this.m_hls.on(e.m_hlsJs.default.Events.MANIFEST_LOADED,(function(e){t.m_hlsJsManifestLoaded=!0})),this.m_hls.on(e.m_hlsJs.default.Events.FRAG_BUFFERED,(function(e){t.m_hls&&t.setHlsBandwidthEstimatesForTelemetry(t.m_hls.bandwidthEstimate)})),this.m_hls.on(e.m_hlsJs.default.Events.ERROR,(function(r,i){var n=i.type,a=i.fatal;if(f.ULS.sendTraceTag(524341858,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"HLS error: mediaName: ".concat(t.m_media.name,", errorFatal: ").concat(a,", errorType: ").concat(n,", errorMessage: ").concat(i.reason,", errorDetail: ").concat(i.details,", uiHostType: ").concat(d.UIHostType[(0,d.getUIHostType)(t.m_environment)],".")),t.m_localMediaPlaybackController&&t.m_localMediaPlaybackController.addHlsError(i.type,i.details),a){if(t.m_hlsJsManifestLoaded&&e.m_hlsJs&&t.m_hls&&t.m_hlsAutoRecoverRetryCount<=S.Settings.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2))switch(i.type){case e.m_hlsJs.default.ErrorTypes.NETWORK_ERROR:return f.ULS.sendTraceTag(520128163,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"HLS network error: mediaName: ".concat(t.m_media.name,", autoRecoverRetryCount: ").concat(t.m_hlsAutoRecoverRetryCount,".")),t.m_hls.startLoad(),void(t.m_hlsAutoRecoverRetryCount+=1);case e.m_hlsJs.default.ErrorTypes.MEDIA_ERROR:return f.ULS.sendTraceTag(520128162,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"HLS media error: mediaName: ".concat(t.m_media.name,", autoRecoverRetryCount: ").concat(t.m_hlsAutoRecoverRetryCount,".")),t.m_hls.recoverMediaError(),void(t.m_hlsAutoRecoverRetryCount+=1)}t.m_wasMetadataLoaded||(t.m_hlsError=!0,t.m_hlsErrorCount+=1),t.m_localMediaInfo&&t.onMediaError(t.m_localMediaInfo)}}))}}},{key:"setNativeHlsSource",value:function(e,t){if(t.canPlayType("application/vnd.apple.mpegurl"))try{var r=this.getHLSUrlWithSlashes(e);return(0,d.isHostIOS)(this.m_environment)&&(r+="#t=0.1"),f.ULS.sendTraceTag(521208256,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Native HLS mediaName: ".concat(this.m_media.name," requestGuid: ").concat(this.m_requestGuid)),this.m_wasLoadStarted=!1,t.src=r,this.setIsHlsForTelemetry(!0),!0}catch(e){f.ULS.sendTraceTag(521208227,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Exception in setting native hls video source: ".concat(e,".")),this.m_hlsError=!0,this.m_hlsErrorCount=1/0}return!1}},{key:"getHLSUrlWithSlashes",value:function(e){return"".concat(e.replace(/[?&]/g,"/"),"/index.m3u8")}},{key:"isMediaDownloadHandlerEnabled",value:function(e){return e.includes("MediaDownloadHandler")}},{key:"resetCurrentTime",value:function(e){this.setCurrentTime(e,e.props.trimStartMs/1e3)}},{key:"setCurrentTime",value:function(e,t){try{if(this.m_localMediaPlaybackController)return void this.m_localMediaPlaybackController.seek(t);e.el&&(f.ULS.sendTraceTag(537720079,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Changed the current position on media:".concat(e.props.name," from ").concat(e.el.currentTime," to ").concat(t)),e.el.currentTime=t)}catch(e){f.ULS.sendTraceTag(556048641,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Exception in setCurrentTime: ".concat(e))}}},{key:"stopMedia",value:function(){this.m_localMediaInfo&&this.m_localMediaInfo.el?(f.ULS.sendTraceTag(571236866,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Stop local media. media: ".concat(this.m_media.name,".")),this.resetCurrentTime(this.m_localMediaInfo),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(571236865,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Stop online media. media: ".concat(this.m_media.name,".")),this.m_onlineVideoPlayer.stopMedia())}},{key:"setMediaVolume",value:function(e){this.enableVolumeSync()&&!this.m_fMuteSyncDisabled&&(e<0||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.volume=e,f.ULS.sendTraceTag(557176146,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Set volume local media. media: ".concat(this.m_media.name,". Volume: ").concat(e))):this.m_onlineVideoPlayer&&(this.m_onlineVideoPlayer.setVolume(e),f.ULS.sendTraceTag(557176145,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Set volume online media. media: ".concat(this.m_media.name,". Volume: ").concat(e)))))}},{key:"setMediaMute",value:function(e){this.m_fMuteSyncDisabled||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.muted=e,e?f.ULS.sendTraceTag(557176148,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Mute local media. media: ".concat(this.m_media.name,".")):f.ULS.sendTraceTag(557176150,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Unmute local media. media: ".concat(this.m_media.name,"."))):this.m_onlineVideoPlayer&&(e?(this.m_onlineVideoPlayer.setMute(),f.ULS.sendTraceTag(557176147,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Mute volume online media. media: ".concat(this.m_media.name,"."))):(this.m_onlineVideoPlayer.setUnMute(),f.ULS.sendTraceTag(557176149,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Unmute volume online media. media: ".concat(this.m_media.name,".")))))}},{key:"getMediaName",value:function(){return this.m_media.name}},{key:"getMediaInfo",value:function(){return{name:this.m_media.name,type:this.m_mediaType,isLoopingBackgroundVideo:void 0!==this.m_localMediaInfo&&this.isLoopingBackgroundVideo(this.m_localMediaInfo),isRenderedToCanvas:this.shouldRenderToCanvas,duration:this.getMediaDuration()}}},{key:"getMediaDuration",value:function(){var e;return this.m_localMediaInfo&&this.m_localMediaInfo.el&&!isNaN(this.m_localMediaInfo.el.duration)?e=this.m_localMediaInfo.el.duration:this.m_onlineVideoPlayer&&(e=this.m_onlineVideoPlayer.getDuration()),e||f.ULS.sendTraceTag(521175494,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"getMediaDuration: Unable to get duration for ".concat(this.m_media.name)),e}},{key:"cleanUp",value:function(){var e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_videoTexture&&(this.m_videoTexture.release(),this.m_environment.viewDataManager.memoryStats.videoTextures-=this.m_mediaSize.x*this.m_mediaSize.y*4),this.m_videoTexture=void 0;var t=this.m_shapeItem;this.m_fCropForCanvasRender&&t.style.pictureBrush&&(t.style.pictureBrush.scale=new c.Vector2(1,1),t.style.pictureBrush.offset=new c.Vector2(0,0)),this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.remove(),this.m_controls=void 0}},{key:"tryPrepare",value:function(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.settings.transparentCanvasForVideoEnabled&&this.m_transparentShapeItem&&(this.fPrepared=this.fPrepared&&this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_transparentShapeItem,!1,5)),this.m_environment.rendererEnvironment.flush()),this.fPrepared}},{key:"getMediaRenderAs",value:function(e){return void 0===this.m_renderAs&&(this.m_renderAs=d.MediaHelper.getMediaRenderAs(e)),this.m_renderAs}},{key:"isMediaPlayable",value:function(e){if(!this.m_localMediaPlaybackSource&&this.m_isTranscoded)return!0;if(void 0!==this.m_fMediaPlayable)return this.m_fMediaPlayable;var t=d.RenderAs.None;if((t=this.m_localMediaPlaybackSource?this.m_localMediaPlaybackSource.isUnplayable()?d.RenderAs.None:d.RenderAs.HTML5:this.getMediaRenderAs(e))===d.RenderAs.None){this.m_fMediaPlayable=!1,f.ULS.sendTraceTag(593356511,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Slide ".concat(this.m_slideId.sid," shape ").concat(this.id.shapeId," has media with unplayable contentType ").concat(e,"."));var r={errorCode:0,mediaName:"".concat(this.m_slideId.sid,"s").concat(this.id.shapeId),contentType:e,mediaType:d.MediaHelper.getMediaTypeFromContentType(e)};f.ULS.sendTraceTag(570750435,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(r))),m.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,contentType:e,mediaType:d.MediaHelper.getMediaTypeFromContentType(e),errorName:"UnplayableContentType",mediaName:r.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}else this.m_fMediaPlayable=!0,f.ULS.sendTraceTag(593356512,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Slide ".concat(this.m_slideId.sid," shape ").concat(this.id.shapeId," has media with contentType ").concat(e,", will play back via ").concat(d.RenderAs[t],"."));return this.m_fMediaPlayable}},{key:"isLoopingBackgroundVideo",value:function(e){return void 0!==this.m_isLoopingBackgroundVideo?this.m_isLoopingBackgroundVideo:!!e.el&&!isNaN(e.el.duration)&&(f.ULS.sendTraceTag(577632458,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Video duration: ".concat(e.el.duration)),this.m_mediaType===c.MediaType.Video&&e.autoPlay&&e.fLooping&&e.fMutedInFile&&e.el.duration<15?(f.ULS.sendTraceTag(588002456,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media is Looping Background Video: ".concat(this.m_media.name)),this.m_isLoopingBackgroundVideo=!0):this.m_isLoopingBackgroundVideo=!1,this.m_isLoopingBackgroundVideo)}},{key:"isVideoPartiallyOffSlide",value:function(){return this.m_mediaPosition.x<0&&this.m_mediaPosition.x+this.m_mediaSize.x>0||this.m_mediaPosition.y<0&&this.m_mediaPosition.y+this.m_mediaSize.y>0||this.m_mediaPosition.x<this.m_slideSizePixels.x&&this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x||this.m_mediaPosition.y<this.m_slideSizePixels.y&&this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y}},{key:"isFullSizeVideo",value:function(){return this.m_mediaType===c.MediaType.Video&&(this.m_mediaSize.x>.95*this.m_slideSizePixels.x&&this.m_mediaSize.x<1.05*this.m_slideSizePixels.x&&this.m_mediaSize.y>.95*this.m_slideSizePixels.y&&this.m_mediaSize.y<1.05*this.m_slideSizePixels.y)}},{key:"getAdjustedBounds",value:function(){var e=this.getBounds(),t=e.left,r=e.right,i=e.top,n=e.bottom;return _.ChangeGate.isChangeGateEnabled("SVM.AdjustPlaybackControlBounds")&&(e.left<0&&e.right>0&&(t=0),e.top<0&&e.bottom>0&&(i=0),e.right>this.m_slideSizePixels.x&&e.left<this.m_slideSizePixels.x&&(r=this.m_slideSizePixels.x),e.bottom>this.m_slideSizePixels.y&&e.top<this.m_slideSizePixels.y&&(n=this.m_slideSizePixels.y)),new u.Rect(t,i,r,n)}},{key:"onGfxControlsPlay",value:function(){this.playMedia(),!this.m_playbackControlCallbacks||_.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPlayClick()}},{key:"onGfxControlsPause",value:function(){this.pauseMedia(),!this.m_playbackControlCallbacks||_.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPauseClick()}},{key:"onGfxControlsSeek",value:function(e){this.seekMedia(e),this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onSeeked()}},{key:"onGfxControlsVolumeChange",value:function(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeChanged()}},{key:"onGfxControlsVolumeClick",value:function(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeClick()}},{key:"isPresenter",value:function(){if(this.m_environment.rendererEnvironment.viewController.mediaCommandScope!==p.MediaCommandScope.None)return this.m_environment.rendererEnvironment.viewController.mediaCommandScope===p.MediaCommandScope.All}},{key:"initPlaybackControls",value:function(e){var t=this;if(this.m_playbackControlCallbacks||(this.m_playbackControlCallbacks=new x.PlaybackControlCallbacks((function(e,r){return t.sendMediaSyncEvent(e,r)}),(function(e){return t.sendUserMediaActionEvent(e)}))),!this.m_controls){var r={playMediaCallback:function(){return t.onGfxControlsPlay()},pauseMediaCallback:function(){return t.onGfxControlsPause()},seekMediaCallback:function(e){return t.onGfxControlsSeek(e)},muteUnmuteCallback:function(){return t.onGfxControlsVolumeClick()},volumeChangedCallback:function(){return t.onGfxControlsVolumeChange()},logVetoCallback:function(e){return(0,d.logPlaybackControlsVeto)(e)},isPresenterCallback:function(){return t.isPresenter()}},i=this.m_localMediaInfo,n=L.PlaybackControlHelper.getMediaControlInfo(i,this.getAdjustedBounds(),this.m_environment);n.captionsEnabled=this.isCaptionsEnabled(),this.isCaptionsEnabled()&&(n.captionsRenderer=this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer),n.volumeSliderEnabled=this.isVolumeSliderEnabled(),n.speedEnabled=this.isSpeedEnabled(),n.fullscreenEnabled=this.isFullscreenEnabled(),n.nestedTabbingEnabled=this.isNestedTabbingEnabled(),this.isTooltipsEnabled()&&(n.tooltipMap=L.PlaybackControlHelper.getTooltipMap()),S.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0)&&void 0!==this.m_localMediaInfo&&(n.playPauseOnly=this.isLoopingBackgroundVideo(this.m_localMediaInfo)),n.captionsPositioningStrategy=S.Settings.readNumberOrDefault("captionsPositioningStrategy",0),n.transferCaptionsFullScreen=_.ChangeGate.isChangeGateEnabled("SVM.transferCaptionsFullScreen"),this.m_controls=new y.PlaybackControls(e,n,r),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlaybackControlsFlag()}}},{key:"sendUserMediaActionEvent",value:function(e){f.ULS.sendTraceTag(520161045,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement: Emitting User Media Action Event (actionType: ".concat(e,", mediaName: ").concat(this.m_media.name,")")),this.m_slideEvents.emit("userMediaAction",{actionType:e,mediaName:this.m_media.name})}},{key:"sendMediaSyncEvent",value:function(t,r){if(void 0===r||!_.ChangeGate.isChangeGateEnabled("SVM.dontSendMediaSyncEventsFromUserMediaActions"))if(this.shouldSuppressMediaSyncEvent(t,this.m_localMediaInfo))f.ULS.sendTraceTag(528570271,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media Sync event ".concat(e.getEventName(t)," for ").concat(this.m_media.name," suppressed."));else{var i,n,a;this.m_localMediaInfo&&this.m_localMediaInfo.el?(i=this.m_localMediaInfo.el.currentTime,n=this.m_localMediaInfo.el.volume,a=this.m_localMediaInfo.el.muted):this.m_onlineVideoPlayer&&(i=this.m_onlineVideoPlayer.getCurrentTime(),n=this.m_onlineVideoPlayer.getVolume(),a=this.m_onlineVideoPlayer.isMuted()),S.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute&&(a=void 0);var o={mediaName:this.m_media.name,event:{eventType:t,position:i||0,volume:n,muted:a},origin:{hostName:c.MediaType[this.m_mediaType],actionType:r},correlationId:(0,w.v4)()};e.logMediaSyncEmission(o),this.m_slideEvents.emit(e.getEventName(t),o)}}},{key:"isCropInSVGSupported",value:function(){return!!S.Settings.readBooleanOrDefault("forceSvg",!1)&&(!(!(0,d.isTeams)(this.m_environment)&&!(0,d.isTeamsWeb)(this.m_environment))||S.Settings.readBooleanOrDefault("cropSupportInSVG",!1))}},{key:"isCropInSVGEnabled",value:function(){return void 0!==this.m_fCropInSVG||(this.m_media.cropInfo&&this.isCropInSVGSupported()&&(0!==this.m_media.cropInfo.top||0!==this.m_media.cropInfo.left||1!==this.m_media.cropInfo.bottom||1!==this.m_media.cropInfo.right)?(this.m_fCropInSVG=!0,f.ULS.sendTraceTag(509614208,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Cropped media is rendered in SVG.")):this.m_fCropInSVG=!1),this.m_fCropInSVG}},{key:"localMediaEventHandler",value:function(e){0===e?this.m_wasLoadStarted=!0:2===e&&this.m_localMediaInfo?this.onLoadedData(this.m_localMediaInfo):1===e&&this.m_localMediaInfo?(0,d.isHostIOS)(this.m_environment)&&this.onLoadedMetaData(this.m_localMediaInfo):3===e&&this.m_localMediaInfo?(0,d.isHostIOS)(this.m_environment)||this.onLoadedMetaData(this.m_localMediaInfo):4===e&&this.m_localMediaInfo?this.onPlay(this.m_localMediaInfo):5===e?this.onPlaying():6===e&&this.m_localMediaInfo?this.onPause(this.m_localMediaInfo):7===e&&this.m_localMediaInfo?this.onSeeked(this.m_localMediaInfo):9===e&&this.m_localMediaInfo?this.onTimeUpdate(this.m_localMediaInfo):11===e&&this.m_localMediaInfo?this.onEnded(this.m_localMediaInfo):10===e&&this.m_localMediaInfo?this.onVolumeChange(this.m_localMediaInfo):12===e&&this.m_localMediaInfo&&this.onMediaError(this.m_localMediaInfo)}},{key:"createMediaElement",value:function(){var e;return this.m_mediaType===c.MediaType.Audio?e=document.createElement("audio"):(S.Settings.readBooleanOrDefault("dontCreateNewMediaElement",!0)&&(e=document.getElementById(this.ShapeMediaTargetId))||(e=document.createElement("video")),e.crossOrigin="anonymous"),e}},{key:"initLocalMediaTelemetry",value:function(){var e=this;this.m_localMediaPlaybackTelemetry=new M.LocalMediaPlaybackTelemetry(this.m_media,this.m_environment,this.m_slideId,(function(t){if(e.m_localMediaPlayer){var r=new URL(t),i=r.searchParams.get("ext");if(null!==i)e.m_localMediaPlayer.setMediaExtension(i);else{var n=r.searchParams.get("mediaId");if(null!==n){var a=/^.+\.([^\.]+)\.media$/.exec(n);null!==a&&2===a.length&&e.m_localMediaPlayer.setMediaExtension(a[1])}}var o=r.searchParams.get("mediaLength");null!==o&&e.m_localMediaPlayer.setMediaLength(parseInt(o,10));var s=r.searchParams.get("retries");null!==s&&e.m_localMediaPlayer.setRetriesLeft(parseInt(s,10)),e.m_localMediaPlayer.onSourceSet()}}),this.m_isPrefetch,this.shouldRenderToCanvas)}},{key:"initLocalMediaInfo",value:function(){var t=this;if(f.ULS.sendTraceTag(541329225,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Local video type: ".concat(this.m_media.contentType)),this.isMediaPlayable(this.m_media.contentType)){if(S.Settings.readBooleanOrDefault("disableOffSlideVideoInSVG",!1)&&this.isVideoPartiallyOffSlide()&&S.Settings.readBooleanOrDefault("forceSvg",!1)){var r={errorCode:-1,mediaName:"".concat(this.m_slideId.sid,"s").concat(this.id.shapeId)};return f.ULS.sendTraceTag(509638094,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Unable to render media on slide ".concat(this.m_slideId.sid," shape ").concat(this.id.shapeId,": off-slide media is rendered as image in SVG.")),f.ULS.sendTraceTag(570750435,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(r))),void m.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,mediaName:r.mediaName,errorName:"MediaRenderedAsImage",qosVeto:"MediaPlaybackFailed",isIntentional:!0})}var i="".concat(this.m_environment.settings.serverUrl).concat(this.m_media.src.substring(1));this.isMediaDownloadHandlerEnabled(this.m_media.src)&&(i="".concat(this.m_media.src));var n,a={elID:this.ShapeMediaTargetId,autoPlay:this.m_media.autoPlay,nativeWidth:this.m_mediaSize.x,nativeHeight:this.m_mediaSize.y,retriesRemaining:this.m_initialRetryCount,retryTimeoutMs:S.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",e.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS),numRepeatsRemaining:this.m_media.repeat,numRepeatsOriginal:this.m_media.repeat,fFullBleed:0===this.m_mediaPosition.x&&0===this.m_mediaPosition.y&&this.m_mediaSize.x===this.m_slideSizePixels.x&&this.m_mediaSize.y===this.m_slideSizePixels.y,fLooping:-1===this.m_media.repeat||this.m_media.repeat>1,fMutedInFile:0===this.m_media.volume,fReachedEnd:!1,fPositionInitialized:!1,fPendingPlay:!1,fPendingPause:!1,props:this.m_media,el:void 0,mediaUrl:decodeURIComponent(i)};if(this.m_mediaType===c.MediaType.Audio||this.m_mediaType===c.MediaType.Video){if(S.Settings.readBooleanOrDefault("useLocalMediaPlayer",!0)){a.props.ariaLabel=this.m_mediaType===c.MediaType.Video?e.getLocalizedString().videoStr:e.getLocalizedString().audioStr;var o={mediaInfo:a,id:this.id,type:this.m_mediaType,size:this.getMediaSize(),position:this.m_mediaPosition,settings:this.m_environment.settings,isTeams:(0,d.isTeams)(this.m_environment),uiHostType:d.UIHostType[(0,d.getUIHostType)(this.m_environment)],cropInfo:this.m_media.cropInfo,shouldRenderToCanvas:this.shouldRenderToCanvas,usePlaybackControls:this.usePlaybackControls(),isCropInSVGEnabled:this.isCropInSVGEnabled(),isHostIOS:(0,d.isHostIOS)(this.m_environment),onMediaEventCallbacks:function(e){return t.localMediaEventHandler(e)}};if(this.m_localMediaPlayer=(0,A.createLocalMediaPlayer)(o),!this.m_localMediaPlayer||!this.m_localMediaPlayer.getMediaElement())return void f.ULS.sendTraceTag(508380034,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Failed to create LocalMediaPlayer for ".concat(c.MediaType[this.m_mediaType]," element:  ").concat(this.m_media.name));n=this.m_localMediaPlayer.getMediaElement(),this.initLocalMediaTelemetry()}else n=this.createMediaElement();if(this.m_mediaType===c.MediaType.Video&&!this.isCropInSVGEnabled()){var s=this.getVideoPosterFrameUri();s?n.poster=s:f.ULS.sendTraceTag(509154584,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Failed to find local video poster frame")}if(void 0===this.m_localMediaPlaybackPerf&&(_.ChangeGate.isChangeGateEnabled("SVM.playAcrossSlidesWithController")||!this.m_media.playAcrossSlides))try{var l=(0,d.isMobileDevice)(this.m_environment);this.m_localMediaPlaybackController=new b.LocalMediaPlaybackController(n,this.m_media.name,this.m_mediaType,(0,d.isHostIOS)(this.m_environment),l,(0,d.isTeams)(this.m_environment),(0,d.isTeamsWeb)(this.m_environment),this.onLocalPlaybackQualityImpactError,(function(){t.m_isNotAllowedError=!0,t.setCustomPlayButtonVisible()})),this.m_localMediaPlaybackPerf=new T.LocalMediaPlaybackPerf(n,this.m_pixelScale,this.m_slideEvents,(0,d.getUIHostType)(this.m_environment),this.m_media,this.m_mediaType,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,void 0,this.m_initialRetryCount,this.m_isPrefetch,this.m_environment.settings.teamsCallId),_.ChangeGate.isChangeGateEnabled("SVM.AddWasVetoLogged")&&this.m_localMediaPlaybackController.setLocalMediaPlaybackPerf(this.m_localMediaPlaybackPerf);var u=new URL(a.mediaUrl),h=e.getMediaLengthFromMediaUrl(u);this.m_localMediaPlaybackSource=new C.LocalMediaPlaybackSource(n,u,this.m_media.name,this.isMediaDownloadHandlerEnabled(this.m_media.src),void 0===h?0:h,this.isPlayable(),this.m_mediaType===c.MediaType.Video,"video/mp4"===this.m_media.contentType,l,(0,d.getUIHostType)(this.m_environment),this.getTotalRetryCount(),this.m_environment.settings.sessionId,this.m_requestGuid,this.m_localMediaPlaybackPerf,this.m_localMediaPlaybackController,(function(){t.isRetryUxEnabledForMedia()&&(t.setCustomPlayButtonHidden(),t.setRetryButtonVisible())}),this.m_localMediaPlaybackTelemetry)}catch(e){f.ULS.sendTraceTag(570716893,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::initLocalMediaInfo Failed to construct LocalMediaPlaybackPerf ".concat(e))}if(this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.setSourceAsync(n,a),!S.Settings.readBooleanOrDefault("useLocalMediaPlayer",!0)){if(this.m_mediaType===c.MediaType.Video){var p=n;if(this.m_mediaSize=this.getMediaSize(),p.width=this.m_mediaSize.x,p.height=this.m_mediaSize.y,this.isCropInSVGEnabled()&&this.m_media.cropInfo){p.style.clipPath="inset(".concat(100*this.m_media.cropInfo.top,"% ").concat(100*(1-this.m_media.cropInfo.right),"% ").concat(100*(1-this.m_media.cropInfo.bottom),"% ").concat(100*this.m_media.cropInfo.left,"%)");var g=1/(this.m_media.cropInfo.right-this.m_media.cropInfo.left),v=1/(this.m_media.cropInfo.bottom-this.m_media.cropInfo.top);p.style.transform="translate(".concat((1-this.m_media.cropInfo.right-this.m_media.cropInfo.left)*g*100/2,"%, ").concat((1-this.m_media.cropInfo.bottom-this.m_media.cropInfo.top)*v*100/2,"%) scale(").concat(g,", ").concat(v,")")}(0,d.isHostIOS)(this.m_environment)&&(p.playsInline=!0,f.ULS.sendTraceTag(545645912,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::initLocalMediaInfo: Set playsInline flag to true"))}else n.style.width="".concat(this.m_mediaSize.x,"px"),n.style.height="".concat(this.m_mediaSize.y,"px");if((0,d.isHostIOS)(this.m_environment)?n.preload="metadata":n.preload="auto",0===this.m_media.volume?n.muted=!0:(!_.ChangeGate.isChangeGateEnabled("SVM.disableSetIOSVolumeMax")&&(0,d.isHostIOS)(this.m_environment)&&(this.m_media.volume=1),n.volume=this.m_media.volume),n.id=a.elID,S.Settings.readBooleanOrDefault("forceSvg",!1)||(n.style.left="".concat(this.m_mediaPosition.x,"px"),n.style.top="".concat(this.m_mediaPosition.y,"px")),this.m_mediaType===c.MediaType.Audio&&(n.style.visibility=a.props.hideWhenStopped?"hidden":"visible"),n.style.position="absolute",this.m_environment.settings.transparentCanvasForVideoEnabled||S.Settings.readBooleanOrDefault("forceSvg",!1)||(n.style.zIndex="4"),this.m_mediaType===c.MediaType.Audio&&(n.setAttribute("role","link"),n.setAttribute("aria-role","link"),n.setAttribute("aria-label",this.m_media.ariaLabel||e.getLocalizedString().audioStr)),n.addEventListener("error",(function(){t.m_localMediaPlaybackSource||(a&&a.el&&a.el.src.endsWith("m3u8")&&(t.m_wasMetadataLoaded||(t.m_hlsError=!0,t.m_hlsErrorCount+=1)),t.onMediaError(a))})),n.addEventListener("ended",(function(){return t.onEnded(a)})),n.addEventListener("loadeddata",(function(){return t.onLoadedData(a)})),(0,d.isHostIOS)(this.m_environment)?n.addEventListener("loadedmetadata",(function(){return t.onLoadedMetaData(a)})):n.addEventListener("canplay",(function(){return t.onLoadedMetaData(a)})),this.m_media.trimEndMs>0&&n.addEventListener("timeupdate",(function(){return t.onTimeUpdate(a)})),n.addEventListener("play",(function(){return t.onPlay(a)})),n.addEventListener("playing",(function(){return t.onPlaying()})),n.addEventListener("pause",(function(){return t.onPause(a)})),n.addEventListener("seeked",(function(){return t.onSeeked(a)})),n.addEventListener("volumechange",(function(){return t.onVolumeChange(a)})),this.m_mediaType!==c.MediaType.Audio&&this.m_mediaType!==c.MediaType.Video||n.setAttribute("controlsList","nodownload"),this.m_mediaType===c.MediaType.Audio&&this.m_environment.settings.editAudioEnabled){this.m_mediaSize.x<e.MIN_AUDIO_PLAYBACK_BAR_WIDTH&&(n.style.width="".concat(e.MIN_AUDIO_PLAYBACK_BAR_WIDTH,"px")),this.m_mediaSize.y<e.MIN_AUDIO_PLAYBACK_BAR_HEIGHT&&(n.style.height="".concat(e.MIN_AUDIO_PLAYBACK_BAR_HEIGHT,"px")),e.showMediaElement(n,!1);var y=!1;n.addEventListener("mouseover",(function(){e.showMediaElement(n,!0)})),n.addEventListener("focus",(function(){e.showMediaElement(n,!0),y=!0})),n.addEventListener("mouseout",(function(){y||e.showMediaElement(n,!1)})),n.addEventListener("blur",(function(){e.showMediaElement(n,!1),y=!1}))}n.addEventListener("loadstart",(function(){t.m_wasLoadStarted=!0})),n.addEventListener("loadedmetadata",(function(){t.m_wasMetadataLoaded=!0})),n.addEventListener("click",(function(t){e.ignoreClick(t)}),!1),this.m_mediaType!==c.MediaType.Video||this.usePlaybackControls()||(n.addEventListener("mouseover",(function(){(S.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&t.m_localMediaInfo&&!t.isLoopingBackgroundVideo(t.m_localMediaInfo)&&!t.isCustomPlayButtonVisible()||t.m_localMediaInfo&&t.m_localMediaInfo.fLooping&&!t.m_localMediaInfo.autoPlay&&!t.isCustomPlayButtonVisible())&&(n.controls=!0)})),n.addEventListener("mouseout",(function(){(S.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&t.m_localMediaInfo&&!t.isLoopingBackgroundVideo(t.m_localMediaInfo)&&!t.isCustomPlayButtonVisible()||t.m_localMediaInfo&&t.m_localMediaInfo.fLooping&&!t.m_localMediaInfo.autoPlay&&!t.isCustomPlayButtonVisible())&&(n.controls=!1)})))}if(this.m_media.playAcrossSlides){var w=(this.m_environment.crossSlideMediaMap?this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]:null)||[];w.push({mediaElement:n,mediaProps:this.m_media}),this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]=w}this.m_mediaType===c.MediaType.Video&&this.isVideoPartiallyOffSlide()&&!S.Settings.readBooleanOrDefault("forceSvg",!1)&&(this.handlePartiallyOffSlideLocalVideo(n),f.ULS.sendTraceTag(559256072,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Local media is partially off slide.")),this.isFullSizeVideo()&&f.ULS.sendTraceTag(541405761,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Embedded video is full screen size"),a.el=n,this.m_shouldRenderToCanvas=!S.Settings.readBooleanOrDefault("forceSvg",!1)&&this.m_mediaType===c.MediaType.Video&&(!!S.Settings.readBooleanOrDefault("renderLocalVideoToCanvasMobile",!1)||!(0,d.isMobileDevice)(this.m_environment))&&this.shouldRenderLocalVideoToCanvas(this.m_shapeItem);var P=this.m_shapeItem;_.ChangeGate.isChangeGateEnabled("SVM.removeEffectsIfNotRenderingToCanvas")&&!this.m_shouldRenderToCanvas&&P.effects.hasEffects&&this.removeEffects(P),f.ULS.sendTraceTag(524870793,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media ".concat(this.m_media.name," shouldRenderToCanvas: ").concat(this.m_shouldRenderToCanvas)),this.m_shouldRenderToCanvas&&this.setAlphaInvariant(),a.el.tabIndex=0,S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&(a.el.onkeydown=function(e){"Enter"===e.key||" "===e.key?t.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),t.customPlayButtonAction(!0)):t.usePlaybackControls()&&t.m_localMediaInfo&&(!t.isLoopingBackgroundVideo(t.m_localMediaInfo)||S.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0))&&(e.stopImmediatePropagation(),t.sendUserMediaActionEvent(c.UserMediaActionType.VideoFrameClick),t.togglePauseMedia()):"j"!==e.key&&""!==e.key||!e.altKey||t.m_controls&&(e.stopImmediatePropagation(),t.isCustomPlayButtonVisible()&&t.customPlayButtonAction(!1),t.m_controls.toggleCaptionsMenu("Keyboard"))}),this.isVideoFrameTrackerEnabled()&&this.m_mediaType===c.MediaType.Video&&!this.m_frameTracker&&(this.m_frameTracker=new E.VideoFrameTracker(a.el,{mediaName:this.m_media.name})),this.m_localMediaInfo=a}else f.ULS.sendTraceTag(593356507,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::initLocalMediaInfo: It is not local media, skipping...")}}},{key:"isVideoFrameTrackerEnabled",value:function(){return!!(0,d.isTeams)(this.m_environment)||S.Settings.readBooleanOrDefault("enableVideoFrameTracker",!1)}},{key:"getVideoPosterFrameUri",value:function(){if(void 0!==this.m_shapeItem){var e,t=O(this.m_shapeItem.getBrushImages());try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.id){var i=this.m_environment.viewDataManager.imageDataMap.get(r.id);if(i&&i.dataUri)return i.dataUri}}}catch(e){t.e(e)}finally{t.f()}}}},{key:"isVolumeSliderEnabled",value:function(){return!(0,d.isHostIOS)(this.m_environment)||!S.Settings.readBooleanOrDefault("disableVolumeSliderIOS",!0)}},{key:"isNestedTabbingEnabled",value:function(){return!(!this.usePlaybackControls()||(0,d.isMobileDevice)(this.m_environment))}},{key:"isCaptionsEnabled",value:function(){return!!this.usePlaybackControls()&&((0,d.isHostIOS)(this.m_environment)?S.Settings.readBooleanOrDefault("enableMediaCaptionsIOS",!0):S.Settings.readBooleanOrDefault("enableMediaCaptionsTeams",!0))}},{key:"isTooltipsEnabled",value:function(){return!!this.usePlaybackControls()&&S.Settings.readBooleanOrDefault("enablePlaybackControlTooltips",!1)}},{key:"addCaptionTracks",value:function(e){var t=this;if(this.isCaptionsEnabled()&&e&&this.m_media){var r=e;if(r&&this.m_media.tracksInfo&&this.m_media.tracksInfo.trackLst){var i,n=!1,a=O(r.children);try{for(a.s();!(i=a.n()).done;)if("captions"===i.value.getAttribute("kind")){n=!0;break}}catch(e){a.e(e)}finally{a.f()}if(n){if(!_.ChangeGate.isChangeGateEnabled("SVM.RebuildCaptionTracks"))return;if(0===e.textTracks.length||e.textTracks[0].cues&&e.textTracks[0].cues.length>0)return;for(var o=r.children.length-1;o>=0;o-=1)"captions"===r.children[o].getAttribute("kind")&&r.children[o].remove()}this.m_media.tracksInfo.trackLst.forEach((function(e,i){var n=document.createElement("track"),a=e.lang&&""!==e.lang?e.lang:"unknown";n.setAttribute("mode","hidden"),n.setAttribute("kind","captions"),n.setAttribute("label",e.label),n.setAttribute("src",decodeURIComponent(e.src)),n.setAttribute("srclang",a),f.ULS.sendTraceTag(520652546,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement.addCaptionTracks: Adding caption track. Media name: ".concat(t.m_media.name,", index: ").concat(i,", language: ").concat(a)),r.appendChild(n)}))}}}},{key:"isSpeedEnabled",value:function(){return!!this.usePlaybackControls()&&(0,d.isPPTO)(this.m_environment)}},{key:"isFullscreenEnabled",value:function(){return!this.shouldRenderToCanvas&&(0,d.isPPTO)(this.m_environment)&&this.usePlaybackControls()&&!d.MediaHelper.isBrowserSafari()}},{key:"handlePartiallyOffSlideLocalVideo",value:function(e){var t=0,r=0,i=this.m_mediaPosition.x,n=this.m_mediaPosition.y;this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,i=0),this.m_mediaPosition.y<0&&(r=this.m_mediaPosition.y,n=0),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(t=this.m_mediaSize.x+this.m_mediaPosition.x-this.m_slideSizePixels.x,i=this.m_slideSizePixels.x-this.m_mediaSize.x),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(r=this.m_mediaSize.y+this.m_mediaPosition.y-this.m_slideSizePixels.y,n=this.m_slideSizePixels.y-this.m_mediaSize.y);var a=e;a.style.objectFit="fill",a.style.objectPosition="".concat(t,"px ").concat(r,"px"),e.style.left="".concat(i,"px"),e.style.top="".concat(n,"px")}},{key:"updateLocalMediaElement",value:function(){if(this.m_localMediaInfo&&this.m_localMediaInfo.el){var t=document.getElementById(this.ShapeMediaTargetId);if(!t){var r=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",i=v.ShapeViewElementUtils.ensureShapeViewElementParentDiv(this.id,r,this.m_media&&this.m_media.playAcrossSlides>0),n=p.ViewController.SlideLevelHtmlElementsParentDivId;if(!i)return void f.ULS.sendTraceTag(594909146,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::updateLocalMediaElement: couldn't find ".concat(n,"."));if(t=S.Settings.readBooleanOrDefault("forceSvg",!1)?this.m_localMediaInfo.el:i.appendChild(this.m_localMediaInfo.el),S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===c.MediaType.Video){var a=this.getBounds(),o=this.createCustomPlayButton(i,a);if(this.m_playButtonHandler=new P.MediaPlayButtonHandler(o,this.m_isNotAllowedError),this.m_fHasCustomPlayButtonBeenSynced||(this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible(),t.controls=!1),S.Settings.readBooleanOrDefault("enableVideoRetryButton",!1)){var s=this.createRetryButton(i,a);this.m_retryButtonHandler=new k.MediaRetryButtonHandler(s)}}if(!this.usePlaybackControls()||this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!S.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0))this.shouldRenderToCanvas&&this.ensureVideoEventsDiv(i);else{var l=this.ensureVideoEventsDiv(i);l&&this.m_controls&&this.m_controls.setParent(l)}}if(this.m_mediaType===c.MediaType.Video){var u=t;u.setAttribute("aria-label",this.m_media.ariaLabel||e.getLocalizedString().videoStr),this.isVideoPartiallyOffSlide()&&!S.Settings.readBooleanOrDefault("forceSvg",!1)?(this.handlePartiallyOffSlideLocalVideo(t),f.ULS.sendTraceTag(557074123,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Local media is partially off slide.")):(this.isFullscreenEnabled()&&this.m_controls&&this.m_controls.isFullScreen()?u.style.objectFit="contain":u.style.objectFit="fill",S.Settings.readBooleanOrDefault("forceSvg",!1)||(t.style.left="".concat(this.m_mediaPosition.x,"px"),t.style.top="".concat(this.m_mediaPosition.y,"px")))}else S.Settings.readBooleanOrDefault("forceSvg",!1)||(t.style.top="".concat(this.m_mediaPosition.y,"px"),t.style.left="".concat(this.m_mediaPosition.x,"px"));if(this.m_mediaType===c.MediaType.Audio){var d=Math.max(this.m_mediaSize.x,e.MIN_AUDIO_PLAYBACK_BAR_WIDTH),h=Math.max(this.m_mediaSize.y,e.MIN_AUDIO_PLAYBACK_BAR_HEIGHT);if(t.style.width="".concat(d,"px"),t.style.height="".concat(h,"px"),this.m_mediaPosition.x<0)t.style.left="0px";else if(this.m_mediaPosition.x+d>this.m_slideSizePixels.x){var m=this.m_mediaPosition.x+d-this.m_slideSizePixels.x;this.m_mediaPosition.x-m>=0&&(t.style.left="".concat(this.m_mediaPosition.x-m,"px"),t.style.width="".concat(d-1,"px"))}if(this.m_mediaPosition.y<0)t.style.top="0px";else if(this.m_mediaPosition.y+h>this.m_slideSizePixels.y){var g=this.m_mediaPosition.y+h-this.m_slideSizePixels.y;this.m_mediaPosition.y-g>=0&&(t.style.top="".concat(this.m_mediaPosition.y-g,"px"))}}}}},{key:"ensureVideoEventsDiv",value:function(e){var t=document.querySelector("#video-events-".concat(this.m_media.name));return t||(t=this.createEventHandlerDiv(),S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(t.style.pointerEvents="auto"),t.setAttribute("lang",p.ViewController.appLanguage),e.appendChild(t)),this.m_localMediaEventsDiv=t,t}},{key:"getBounds",value:function(){if(this.m_shapeItem){var e=this.m_shapeItem.getBounds(!1,!1,!1);if(e)return new u.Rect(e.left,e.top,e.right,e.bottom);if(this.m_mediaType===c.MediaType.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el){var t=this.m_localMediaInfo.el;if(t)return new u.Rect(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+t.width,this.m_mediaPosition.y+t.height)}}return f.ULS.sendTraceTag(541184912,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"MediaViewElement::getBounds: Not able to get bounds from shapebuilder."),(0,d.logPlaybackControlsVeto)("IncorrectPosition"),new u.Rect(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaSize.x,this.m_mediaSize.y)}},{key:"createEventHandlerDiv",value:function(){var t=this,r=document.createElement("div");r.id="video-events-".concat(this.m_media.name),r.style.position="absolute",S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()?r.tabIndex=-1:r.tabIndex=0,r.setAttribute("aria-label",this.m_media.ariaLabel||e.getLocalizedString().videoStr),r.setAttribute("role","undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.SlideShowAccessibilityLabelGroup:"group");var i=this.getAdjustedBounds();return r.style.left="".concat(i.left,"px"),r.style.top="".concat(i.top,"px"),r.style.width="".concat(i.width,"px"),r.style.height="".concat(i.height,"px"),this.setSizeAndScale(r,new c.Vector2(i.width,i.height)),this.addListenersForMediaFocus(r),r.addEventListener("mouseenter",(function(){t.m_controls&&!t.isCustomPlayButtonVisible()&&t.m_controls.show()})),r.addEventListener("mouseleave",(function(){t.m_controls&&t.m_controls.hide()})),r.addEventListener("focusin",(function(){t.m_controls&&!t.isCustomPlayButtonVisible()&&t.m_controls.show()})),r.addEventListener("focusout",(function(){t.m_controls&&t.m_controls.hide()})),_.ChangeGate.isChangeGateEnabled("SVM.PlayPauseVideoWithMouseClick")&&r.addEventListener("click",(function(){t.usePlaybackControls()&&t.m_localMediaInfo&&!t.isLoopingBackgroundVideo(t.m_localMediaInfo)&&(t.sendUserMediaActionEvent(c.UserMediaActionType.VideoFrameClick),t.togglePauseMedia())})),r.addEventListener("keydown",(function(e){"Enter"===e.key||" "===e.key?S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&t.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),t.customPlayButtonAction(!0)):t.usePlaybackControls()&&t.m_localMediaInfo&&!t.isLoopingBackgroundVideo(t.m_localMediaInfo)&&(e.stopImmediatePropagation(),t.sendUserMediaActionEvent(c.UserMediaActionType.VideoFrameClick),t.togglePauseMedia()):"ArrowLeft"===e.key||"ArrowRight"===e.key?!t.m_controls||!t.isNestedTabbingEnabled()||S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&t.isCustomPlayButtonVisible()||t.m_controls.onKeyDown(e):"j"!==e.key&&""!==e.key||!e.altKey||!t.m_controls||S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&t.isCustomPlayButtonVisible()||t.m_controls.toggleCaptionsMenu("Keyboard")})),r}},{key:"isRetryUxEnabledForMedia",value:function(){return!(!S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)||!S.Settings.readBooleanOrDefault("enableVideoRetryButton",!1)||this.m_mediaType!==c.MediaType.Video||this.m_media.autoPlay&&(-1===this.m_media.repeat||this.m_media.repeat>1)&&0===this.m_media.volume)}},{key:"getTotalRetryCount",value:function(){var t=S.Settings.readNumberOrDefault("mediaRetryCount",e.BD_HTML5_MEDIA_RETRY_COUNT);return t>5&&this.isRetryUxEnabledForMedia()&&(t-=3),this.m_localMediaPlaybackSource||this.m_useTranscodedVideos&&(t+=S.Settings.readNumberOrDefault("transcodingRetryCount",e.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT)),t}},{key:"generateMediaSrcUrl",value:function(e,t){try{var r=new URL(e);return r.searchParams.set("usid",this.m_environment.settings.sessionId),r.searchParams.set("retries",t.toString()),r.searchParams.set("requestGuid",this.m_requestGuid),r.hostname=r.hostname.toLowerCase().replace(".pods.",".media."),this.m_useTranscodedVideos&&(-1===e.indexOf("disableTranscode")?this.generateTranscodedMediaSrcUrl(t,r):f.ULS.sendTraceTag(520153308,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::generateMediaSrcUrl disable transcoding for mediaName: ".concat(this.m_media.name))),f.ULS.sendTraceTag(538489932,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Media URL includes media domain: ".concat(r.hostname.includes(".media."))),r.toString()}catch(e){f.ULS.sendTraceTag(570716894,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::generateMediaSrcUrl Invalid URL ".concat(e))}return-1===e.indexOf("?")?"".concat(e,"?retries=").concat(t):"".concat(e,"&retries=").concat(t)}},{key:"generateTranscodedMediaSrcUrl",value:function(t,r){var i=!1,n=e.getMediaLengthFromMediaUrl(r);void 0!==n&&(i=n<S.Settings.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!(0,d.isMobileDevice)(this.m_environment));var a=!this.isPlayable(),o=!_.ChangeGate.isChangeGateEnabled("SVM.TryTranscodingOnce")||!this.m_wasTranscodingRequested,s=!S.Settings.readBooleanOrDefault("noMP4Transcoding",!1)||!this.isMP4(),l=!S.Settings.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)||a,u=t>=this.m_initialRetryCount-S.Settings.readNumberOrDefault("transcodingRetryCount",e.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT),h=!_.ChangeGate.isChangeGateEnabled("SVM.DisableTranscodedVideosPrefetch")&&!this.m_fOnSlide;this.m_isTranscoded=a||o&&s&&l&&!i&&(u||h),this.m_wasTranscodingRequested=this.m_wasTranscodingRequested||this.m_isTranscoded,this.updatePixelScale();var m=this.m_environment.rendererEnvironment.isCanvasSizeSet||!_.ChangeGate.isChangeGateEnabled("SVM.CheckIfCanvasIsSet")?this.m_pixelScale:new c.Vector2(1,1),p=this.m_isTranscoded?d.TranscodedMediaQuality.Low:d.TranscodedMediaQuality.Raw;!S.Settings.readBooleanOrDefault("onlyLowTranscoding",!1)&&this.m_isTranscoded&&(p=d.MediaHelper.getTranscodeMediaQuality(e.getNetworkBandwidthInMbps(),this.m_mediaSize,m,this.m_environment)),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality(p),r.searchParams.set("transcode",d.TranscodedMediaQuality[p]),f.ULS.sendTraceTag(526956306,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"".concat(JSON.stringify({requestTranscodedMedia:this.m_isTranscoded,retryCount:t,selMediaQuality:d.TranscodedMediaQuality[p],onSlide:this.m_fOnSlide})))}},{key:"onMediaError",value:function(e){var t=this;e.el&&e.props&&(this.m_wasLoadStarted||this.m_hlsError)&&(e.el.error&&f.ULS.sendTraceTag(593356508,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"MediaViewElement::onMediaError {errorCode: ".concat(e.el.error.code,", errorMessage: ").concat(e.el.error.message,"}")),e.retriesRemaining>0?window.setTimeout((function(){t.retryMediaDownload(e)}),_.ChangeGate.isChangeGateEnabled("SVM.NoWaitHLSRetry")&&this.m_hlsError&&this.m_hlsErrorCount<=this.getHLSRetryCount()?1:e.retryTimeoutMs):(f.ULS.sendTraceTag(520161372,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"MediaViewElement::onMediaError No retries left mediaName: ".concat(this.m_media.name,".")),this.isRetryUxEnabledForMedia()&&(this.setCustomPlayButtonHidden(),this.setRetryButtonVisible())))}},{key:"onEnded",value:function(e){e.el&&e.props&&(this.sendMediaSyncEvent(c.MediaEventType.MediaEnded),-1===e.numRepeatsRemaining||e.numRepeatsRemaining>1?(this.resetCurrentTime(e),e.numRepeatsRemaining>1&&(e.numRepeatsRemaining-=1),this.playHelper(e)):(e.fReachedEnd=!0,this.stopVideoFrameTracker("onEnded"),this.pauseHelper(e),e.numRepeatsRemaining=e.numRepeatsOriginal))}},{key:"onLoadedData",value:function(e){if(f.ULS.sendTraceTag(544317722,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::onLoadedData: Media name: ".concat(e.props.name,", content type: ").concat(e.props.contentType)),S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===c.MediaType.Video){if(!e.el)return;if(this.usePlaybackControls())return;S.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&this.m_media.autoPlay&&this.m_environment.settings.showCustomPlayButtonForVideo&&!this.isLoopingBackgroundVideo(e)?e.el.controls=!0:!this.m_media.autoPlay&&!1!==this.m_environment.settings.showCustomPlayButtonForVideo||this.isLoopingBackgroundVideo(e)||(e.el.controls=!0)}}},{key:"onLoadedMetaData",value:function(e){f.ULS.sendTraceTag(544317723,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::onLoadedMetaData: Media name: ".concat(e.props.name,", content type: ").concat(e.props.contentType));var t=e.el;if(t){var r=this.isLoopingBackgroundVideo(e);if((this.m_environment.settings.transparentCanvasForVideoEnabled||S.Settings.readBooleanOrDefault("forceSvg",!1))&&r)t.style.pointerEvents="none",t.controls=!1;else{if(t.style.pointerEvents="auto",this.usePlaybackControls())return;S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType!==c.MediaType.Audio&&(r||!this.m_media.autoPlay||S.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&!this.m_environment.settings.showCustomPlayButtonForVideo)||(t.controls=!0)}}}},{key:"retryMediaDownload",value:function(t){if(t.el&&t.props&&(t.el.src||this.m_hlsError)){this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),f.ULS.sendTraceTag(593356510,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"MediaViewElement::retryMediaDownload: retrying media with id= ".concat(t.elID,", retriesRemaining=").concat(t.retriesRemaining)),t.retriesRemaining-=1,this.setSourceAsync(t.el,t);var r=S.Settings.readNumberOrDefault("mediaRetryMultiplier",e.BD_HTML5_MEDIA_RETRY_MULTIPLIER);t.retryTimeoutMs*=r}}},{key:"onTimeUpdate",value:function(e){if(e.el&&e.props){var t=e.el.duration-e.props.trimEndMs/1e3;e.el.currentTime>=t&&!e.fReachedEnd&&this.onEnded(e)}}},{key:"onPlay",value:function(e){if(e.el&&e.props){S.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===c.MediaType.Video&&(this.setCustomPlayButtonHidden(),_.ChangeGate.isChangeGateEnabled("SVM.SingleTabForMedia")&&this.m_localMediaEventsDiv&&(this.m_localMediaEventsDiv.tabIndex=0),this.usePlaybackControls()||this.m_media.autoPlay||e.fLooping||(e.el.controls=!0));var t=e.el.duration-e.props.trimEndMs/1e3,r=e.props.trimStartMs/1e3;e.el.currentTime<r&&this.resetCurrentTime(e),e.el.currentTime>=t&&e.fReachedEnd&&this.resetCurrentTime(e),e.fReachedEnd=!1,this.sendMediaSyncEvent(c.MediaEventType.MediaPlayed)}}},{key:"onPlaying",value:function(){this.m_frameTracker&&!this.m_frameTracker.isActive&&(f.ULS.sendTraceTag(512234245,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Starting VideoFrameTracker for media ".concat(this.m_media.name)),this.m_frameTracker.start())}},{key:"setAccessibleNameForLocalMedia",value:function(t){if(_.ChangeGate.isChangeGateEnabled("SVM.UpdateVideoNameWithPlayPauseState")&&this.m_localMediaInfo&&this.m_localMediaInfo.el){var r=(this.m_media.ariaLabel||e.getLocalizedString().videoStr)+" ";r+="undefined"!=typeof PowerpointSlideshowStrings?t?PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlayButton:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPauseButton:t?"Video Play":"Video Pause",this.m_localMediaInfo.el.setAttribute("aria-label",r),this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.setAttribute("aria-label",r)}}},{key:"playHelper",value:function(e){return e.el?(this.setAccessibleNameForLocalMedia(!0),this.m_localMediaPlaybackController?(this.m_localMediaPlaybackController.playOrPause(!0),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlayRequestTime(),this.m_localMediaPlayer&&this.m_localMediaPlayer.setPlayRequestTime(),Promise.resolve(void 0)):(f.ULS.sendTraceTag(537773278,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Calling play() media: ".concat(this.m_media.name," Ready state:").concat(e.el.readyState,".")),this.verifyPlatfromSpecificReadyState(e)||f.ULS.sendTraceTag(537773279,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Player haven't reached to ready state and started playing media: ".concat(this.m_media.name,".")),e.el.play())):(f.ULS.sendTraceTag(537773277,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"mediaInfo is null/undefined"),Promise.resolve(void 0))}},{key:"pauseHelper",value:function(e){e.el?(this.setAccessibleNameForLocalMedia(!1),this.m_localMediaPlaybackController?this.m_localMediaPlaybackController.playOrPause(!1):(f.ULS.sendTraceTag(537773281,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Calling pause() media: ".concat(this.m_media.name," Ready state:").concat(e.el.readyState,".")),e.el.pause())):f.ULS.sendTraceTag(537773280,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"mediaInfo is null/undefined")}},{key:"verifyPlatfromSpecificReadyState",value:function(e){if(!e.el)return f.ULS.sendTraceTag(537773282,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"mediaInfo is null/undefined"),!1;var t=this.useLoadedMetadataAsInteractivityEvent();return e.el.readyState>=(t?HTMLMediaElement.HAVE_METADATA:HTMLMediaElement.HAVE_FUTURE_DATA)}},{key:"useLoadedMetadataAsInteractivityEvent",value:function(){return(0,d.isHostIOS)(this.m_environment)&&S.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0)}},{key:"onPause",value:function(e){if(e.el){var t=e.el.duration-(e.props?e.props.trimEndMs/1e3:0);if(e.el.currentTime>=t)return;this.stopVideoFrameTracker("onPause"),this.sendMediaSyncEvent(c.MediaEventType.MediaPaused),f.ULS.sendTraceTag(509366741,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::onPause - currentTime: ".concat(e.el.currentTime," (seconds), media: ").concat(this.m_media.name,", isNarration: ").concat(this.m_media.narration))}}},{key:"stopVideoFrameTracker",value:function(t){if(this.m_frameTracker&&this.m_frameTracker.isActive){var r={};if(this.m_shapeItem instanceof u.Shape){var i=this.m_shapeItem;r={renderToCanvas:this.shouldRenderToCanvas,cropped:this.isVideoCropped(i),croppedToShape:e.isVideoCroppedToShape(i),rotated:e.isVideoRotated(i),effects:i.effects.hasEffects,outline:void 0!==i.style.lineBrush,trackingStopped:t}}this.m_frameTracker.stop(r)}}},{key:"onSeeked",value:function(e){e.el&&(e.el.currentTime<e.el.duration&&(e.fReachedEnd=!1),this.shouldRenderToCanvas&&e.el.paused&&(this.m_hasPendingRender=!0),this.sendMediaSyncEvent(c.MediaEventType.MediaSeeked))}},{key:"onVolumeChange",value:function(e){e.el&&this.sendMediaSyncEvent(c.MediaEventType.MediaVolumeChanged)}},{key:"getPlayButtonTooltip",value:function(){return void 0===this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlay:"Play":this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayPresenter:"Play for everyone":"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayAttendee:"Play for me only"}},{key:"initLinkedMediaInfo",value:function(){var e=this,t=this.m_shapeViewData.media;if(t&&!document.getElementById("media-element-".concat(JSON.stringify(this.id)))&&this.isMediaPlayable(t.contentType)){var r=d.MediaHelper.getMediaRenderAs(t.contentType);if(r===d.RenderAs.FlashObject){var i;try{i=new URL(t.src)}catch(e){return void f.ULS.sendTraceTag(512263779,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Media src URL is invalid")}this.isFullScreenByDefault()&&(i.searchParams.set("playsinline","true"),f.ULS.sendTraceTag(512263778,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::initLinkedMediaInfo: Set playsinline flag to true"));var n=document.createElement("div");n.id="LinkedMedia-Container",n.style.visibility="visible",n.style.position="absolute",n.style.pointerEvents="auto",n.style.left="".concat(this.m_mediaPosition.x,"px"),n.style.top="".concat(this.m_mediaPosition.y,"px");var a=this.getAdjustedBounds();if(this.setSizeAndScale(n,new c.Vector2(a.width,a.height)),n.tabIndex=0,this.addListenersForMediaFocus(n),this.m_environment.settings.transparentCanvasForVideoEnabled||S.Settings.readBooleanOrDefault("forceSvg",!1)||(n.style.zIndex="3"),r===d.RenderAs.FlashObject){var o,s=this.isVideoPartiallyOffSlide(),l={mediaPosition:this.m_mediaPosition,mediaSize:this.m_mediaSize,slideSize:this.m_slideSizePixels,fEnableCropping:s};(0,d.isTeams)(this.m_environment)&&!this.m_media.autoPlay&&void 0===(o=this.getVideoPosterFrameUri())&&f.ULS.sendTraceTag(509094100,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Failed to find online video poster frame"),this.m_onlineVideoPlayer=new y.OnlineVideoPlayer(i.toString(),n,this.m_gfxVideoSettings,l,o,(function(){return e.onPlayerReadyCallBack()}),(function(t){return e.onlineVideoEventEmitter(t)}),(function(t){return e.onlineVideoAuthEventEmitter(t)}),(function(){return e.m_fHasOnlineVideoPlayButtonBeenClicked=!0}),(function(t){f.ULS.sendTraceTag(508347999,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Error,"Online media sent veto: ".concat(JSON.stringify({veto:t.vetoName,error:t.errorName,details:t.details,correlationId:t.correlationId,mediaType:c.MediaType[e.m_mediaType],mediaName:e.m_media.name,uiHostType:d.UIHostType[(0,d.getUIHostType)(e.m_environment)],teamsCallId:e.m_environment.settings.teamsCallId}))),_.ChangeGate.isChangeGateEnabled("SVM.RecordOnlineMediaVeto")&&m.VetoUtils.recordVeto(t.vetoName,{qosVeto:t.vetoName,errorName:t.errorName,errorDetails:t.details,mediaName:e.m_media.name,mediaType:c.MediaType[e.m_mediaType]})}),this.m_media.name,this.getPlayButtonTooltip()),void 0!==this.m_onlineVideoPlaybackTelemetry||this.m_media.playAcrossSlides||(this.m_onlineVideoPlaybackTelemetry=new R.OnlineVideoPlaybackTelemetry(this.m_media,this.m_environment,this.m_slideId)),null!==this.m_onlineVideoPlayer&&(f.ULS.sendTraceTag(512263777,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Successful creation of OnlineVideoPlayer of type ".concat(c.MediaType[this.m_mediaType],".")),this.m_onlineVideoPlayer.setUiHostType(d.UIHostType[(0,d.getUIHostType)(this.m_environment)]))}else f.ULS.sendTraceTag(512263776,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Unable to play media: unknown RenderAs type ignored: ".concat(r,"."));this.isVideoPartiallyOffSlide()&&(this.handlePartiallyOffSlideLinkedMedia(n),f.ULS.sendTraceTag(512263775,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Linked media with type:".concat(this.m_mediaType," is partially off slide."))),this.m_linkedMediaEl=n}else this.m_transparentShapeItem=void 0}}},{key:"isFullScreenByDefault",value:function(){if((0,d.isHostIOS)(this.m_environment))switch(this.m_mediaType){case c.MediaType.Flip:case c.MediaType.StreamClassic:case c.MediaType.Ted:case c.MediaType.Vimeo:case c.MediaType.YouTube:case c.MediaType.Stream2:return!0}return!1}},{key:"setCustomPlayButtonHidden",value:function(){this.m_playButtonHandler&&!this.m_isNotAllowedError&&this.m_playButtonHandler.setPlayButtonHidden()}},{key:"setCustomPlayButtonVisible",value:function(){this.m_playButtonHandler&&this.m_playButtonHandler.setPlayButtonVisible()}},{key:"isCustomPlayButtonVisible",value:function(){return!!this.m_playButtonHandler&&this.m_playButtonHandler.isPlayButtonVisible()}},{key:"customPlayButtonOnClick",value:function(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.customPlayButtonAction(!0)}},{key:"customPlayButtonAction",value:function(e){this.m_isNotAllowedError=!1,this.setCustomPlayButtonHidden(),e&&(this.playMedia(),this.m_fIsPlayerReady&&this.sendMediaSyncEvent(c.MediaEventType.MediaPlayed,c.UserMediaActionType.CustomPlayButtonClick),this.sendUserMediaActionEvent(c.UserMediaActionType.CustomPlayButtonClick),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setWhenClickedOn()),this.m_localMediaInfo&&this.m_localMediaInfo.el&&!this.m_media.autoPlay&&this.m_fIsPlayerReady&&!this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!0)}},{key:"createCustomPlayButton",value:function(e,t){var r=this,i=(0,y.createSvgPlayButton)(this.getPlayButtonTooltip());return i.style.top="".concat(t.top+t.height/2-y.PLAYBUTTON_LENGTH/2,"px"),i.style.left="".concat(t.left+t.width/2-y.PLAYBUTTON_LENGTH/2,"px"),i.addEventListener("click",(function(e){return r.customPlayButtonOnClick(e)}),!1),e.appendChild(i),i}},{key:"setRetryButtonHidden",value:function(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonHidden(),f.ULS.sendTraceTag(526952099,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setRetryButtonHidden: Retry button hidden for media: ".concat(this.m_media.name)))}},{key:"setRetryButtonVisible",value:function(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonVisible(),f.ULS.sendTraceTag(526952128,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement::setRetryButtonVisible: Retry button shown for media: ".concat(this.m_media.name)))}},{key:"retryButtonOnClick",value:function(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.setRetryButtonHidden(),this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.m_localMediaInfo&&this.retryMediaDownload(this.m_localMediaInfo)}},{key:"createRetryButton",value:function(e,t){var r=this,i=(0,I.createRetryButton)();return i.style.top="".concat(t.top+t.height/2-y.PLAYBUTTON_LENGTH/2,"px"),i.style.left="".concat(t.left+t.width/2-y.PLAYBUTTON_LENGTH/2,"px"),i.style.display="none",i.addEventListener("click",(function(e){return r.retryButtonOnClick(e)}),!1),e.appendChild(i),i}},{key:"onPlayerReadyCallBack",value:function(){if(!this.m_fIsPlayerReady){if(this.m_fIsPlayerReady=!0,this.m_fSuppressMediaSyncEvents=!1,this.isSupportedMediaPlayer()&&!this.m_fHasMediaBeenSynced){if(this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_mediaType===c.MediaType.Video){var e,t=this.m_localMediaInfo.el;!this.usePlaybackControls()||this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!S.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0)?this.shouldRenderToCanvas&&t.parentElement&&this.ensureVideoEventsDiv(t.parentElement):(this.initPlaybackControls(t),(e=t.parentElement?this.ensureVideoEventsDiv(t.parentElement):void 0)&&this.m_controls&&this.m_controls.setParent(e))}this.emitMediaInitState()}this.m_fHasMediaBeenSynced&&this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setMediaSyncedOnReady(),!this.m_onlineVideoPlayer||this.m_mediaType!==c.MediaType.YouTube&&this.m_mediaType!==c.MediaType.Vimeo||this.m_fHasMediaBeenSynced||(f.ULS.sendTraceTag(520135564,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Setting ".concat(c.MediaType[this.m_mediaType]," video to be unmuted by default: ").concat(this.m_media.name)),this.m_onlineVideoPlayer.setUnMute()),this.m_localMediaInfo&&!this.m_fHasMediaBeenSynced&&(f.ULS.sendTraceTag(528601347,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Seeking media ".concat(this.m_media.name," to start at initial position ").concat(this.m_localMediaInfo.props.trimStartMs/1e3,"s")),this.resetCurrentTime(this.m_localMediaInfo)),S.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute&&(f.ULS.sendTraceTag(520984198,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Setting global mute on media: ".concat(this.m_media.name)),this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute())}}},{key:"isSupportedMediaPlayer",value:function(){return this.m_mediaType!==c.MediaType.Other}},{key:"emitMediaInitState",value:function(){var t,r={mediaName:this.m_media.name,slideId:this.m_slideId};if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if(this.isLoopingBackgroundVideo(this.m_localMediaInfo))return;t={playerState:!this.m_localMediaInfo.el.paused||this.m_media.autoPlay?c.MediaPlayerState.MediaPlayed:c.MediaPlayerState.MediaPaused,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,position:this.m_localMediaInfo.props.trimStartMs/1e3,mediaName:this.m_media.name,playerPositionSkew:-1}}else if(this.m_onlineVideoPlayer){var i=this.m_onlineVideoPlayer.isMuted();this.m_mediaType!==c.MediaType.YouTube&&this.m_mediaType!==c.MediaType.Vimeo||(i=!1),t={playerState:!this.m_onlineVideoPlayer.isPaused()||this.m_media.autoPlay?c.MediaPlayerState.MediaPlayed:c.MediaPlayerState.MediaPaused,volume:this.m_onlineVideoPlayer.getVolume(),muted:i,position:this.m_onlineVideoPlayer.getCurrentTime(),mediaName:this.m_media.name,playerPositionSkew:-1}}if(t){var n={mediaName:this.m_media.name,state:t,origin:{isInitial:!0,hostName:c.MediaType[this.m_mediaType]},correlationId:(0,w.v4)()};e.logMediaSyncEmission(n,!0),this.m_slideEvents.emit("mediaInitState",{mediaSlideInfo:r,mediaSyncInitState:n})}}},{key:"onlineVideoEventEmitter",value:function(e){e===c.MediaEventType.MediaEnded?this.m_fLinkedMediaReachedEnd=!0:e!==c.MediaEventType.MediaVolumeChanged&&(this.m_fLinkedMediaReachedEnd=!1),this.sendMediaSyncEvent(e)}},{key:"onlineVideoAuthEventEmitter",value:function(e){d.StreamPlayerAuthMessagingContext.setNewStreamPlayer(this.m_onlineVideoPlayer),f.ULS.sendTraceTag(509346826,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Emitting AADTokenRequest for media (name: ".concat(this.m_media.name,", type: ").concat(c.MediaType[this.m_mediaType],")")),this.m_slideEvents.emit("aadTokenRequest",e)}},{key:"createGfxVideoAppSettings",value:function(){var e=(0,d.isTeams)(this.m_environment);return{App:e?"Teams":"PowerPoint",AppPlatform:e?"Previewer":"WAC",AppCorrelation:this.m_environment.settings.sessionId,HubbleVideoEndpoint:this.m_environment.settings.hubbleVideoEndpoint||S.Settings.readStringOrDefault("PPTLiveHubbleEndpoint","https://hubble.officeapps.live.com"),IsStream2Enabled:!0,AcceptLanguage:this.m_environment.settings.acceptLanguage,MaxAADTokenWaitingTime:S.Settings.readNumberOrDefault("MaxAADTokenWaitingTime",3e3),TokenCacheTimeout:S.Settings.readNumberOrDefault("tokenCacheTimeout",3e4),hostComponent:e?"SlideshowApp":"Unified",hostView:e?"PowerPointLive":"Present",LocalizedHubble400ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble400Error:"400",LocalizedHubble404ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble404Error:"404",LocalizedHubble500ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble500Error:"500",LocalizedHubble403ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble403Error:"403",fixAutoPlayEnabled:_.ChangeGate.isChangeGateEnabled("fixAutoPlayEnabled")}}},{key:"ensureLinkedMediaElementDiv",value:function(){var e=document.getElementById(this.ShapeMediaTargetId);if(e)return e;(e=document.createElement("div")).id=this.ShapeMediaTargetId;var t=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2";return v.ShapeViewElementUtils.ensureShapeViewElementParentDiv(this.id,t).appendChild(e),e}},{key:"handlePartiallyOffSlideLinkedMedia",value:function(e){var t=0,r=0,i=p.ViewController.getElementFromCollectionByLocalName(e.children,"iframe");if(i){this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,e.style.left="0px",e.style.width="".concat(this.m_mediaSize.x+this.m_mediaPosition.x,"px")),this.m_mediaPosition.y<0&&(r=this.m_mediaPosition.y,e.style.top="0px",e.style.height="".concat(this.m_mediaSize.y+this.m_mediaPosition.y,"px")),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(this.m_mediaPosition.x<=0?e.style.width="".concat(this.m_slideSizePixels.x,"px"):e.style.width="".concat(this.m_slideSizePixels.x-this.m_mediaPosition.x,"px")),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(this.m_mediaPosition.y<=0?e.style.height="".concat(this.m_slideSizePixels.y,"px"):e.style.height="".concat(this.m_slideSizePixels.y-this.m_mediaPosition.y,"px")),e.style.overflow="hidden";var n=i;n.style.width="".concat(this.m_mediaSize.x,"px"),n.style.height="".concat(this.m_mediaSize.y,"px"),n.style.position="relative",n.style.left="".concat(t,"px"),n.style.top="".concat(r,"px")}}},{key:"updateLinkedMediaElement",value:function(){if(this.m_linkedMediaEl){var t=this.ensureLinkedMediaElementDiv(),r=p.ViewController.getElementFromCollection(t.children,e.LinkedMediaContainerName);r||(r=t.appendChild(this.m_linkedMediaEl));var i=r;i.style.left="".concat(this.m_mediaPosition.x,"px"),i.style.top="".concat(this.m_mediaPosition.y,"px");var n=this.getAdjustedBounds();if(this.setSizeAndScale(i,new c.Vector2(n.width,n.height)),this.isVideoPartiallyOffSlide())this.handlePartiallyOffSlideLinkedMedia(i),f.ULS.sendTraceTag(557672065,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Linked media with type:".concat(this.m_mediaType," is partially off slide."));else{var a=p.ViewController.getElementFromCollection(i.children,e.LinkedMediaIFramename);if(!a)return;var o=a;o.style.width="".concat(this.m_mediaSize.x,"px"),o.style.height="".concat(this.m_mediaSize.y,"px"),o.setAttribute("aria-label",this.m_media.ariaLabel||e.getLocalizedString().videoStr)}}}},{key:"addListenersForMediaFocus",value:function(e){var t=this,r=S.Settings.readNumberOrDefault("mediaFocusIndicatorWidth",4);e.onfocus=function(){var i=e.getBoundingClientRect();e.style.width="".concat(i.width-2*r,"px"),e.style.height="".concat(i.height-2*r,"px"),t.addFocusBorder(e)},e.onblur=function(){var r=t.getAdjustedBounds();t.setSizeAndScale(e,new c.Vector2(r.width,r.height)),t.removeFocusBorder(e)}}},{key:"addFocusBorder",value:function(e){var t=S.Settings.readNumberOrDefault("mediaFocusStyleOutlineWidth",2),r=S.Settings.readNumberOrDefault("mediaFocusStyleOutlineOffset",-4),i=S.Settings.readNumberOrDefault("mediaFocusStyleBorderWidth",4);this.addStyleToHTMLElement(e,{outline:"solid ".concat(t,"px white"),outlineOffset:"".concat(r,"px"),border:"solid ".concat(i,"px black")})}},{key:"removeFocusBorder",value:function(e){this.addStyleToHTMLElement(e,{outlineWidth:"0px",borderWidth:"0px"})}},{key:"getMediaSize",value:function(){var e=this.getBounds();return new c.Vector2(e.width,e.height)}},{key:"setSizeAndScale",value:function(e,t){var r=this.m_slideScale;this.addStyleToHTMLElement(e,{transform:"scale(".concat(1/r,", ").concat(1/r,")"),transformOrigin:"top left",width:"".concat(t.x*r,"px"),height:"".concat(t.y*r,"px")})}},{key:"addStyleToHTMLElement",value:function(e,t){for(var r in t)e.style[r]=t[r]}},{key:"shapeItem",get:function(){return this.m_shapeItem}},{key:"enableVolumeSync",value:function(){return!(0,d.isHostIOS)(this.m_environment)&&S.Settings.readBooleanOrDefault("mediaVolumeSync",!1)}},{key:"getMediaCurrentState",value:function(){if(this.m_fIsPlayerReady){if(this.m_localMediaInfo&&this.m_localMediaInfo.el){var e=this.m_localMediaInfo.fReachedEnd?c.MediaPlayerState.MediaEnded:void 0;return e||(e=this.m_localMediaInfo.el.paused?c.MediaPlayerState.MediaPaused:c.MediaPlayerState.MediaPlayed),{mediaName:this.m_media.name,playerState:e,position:this.m_localMediaInfo.el.currentTime,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,playerPositionSkew:0}}if(this.m_onlineVideoPlayer){var t=this.m_fLinkedMediaReachedEnd?c.MediaPlayerState.MediaEnded:void 0;return t||(t=this.m_onlineVideoPlayer.isPaused()?c.MediaPlayerState.MediaPaused:c.MediaPlayerState.MediaPlayed),{mediaName:this.m_media.name,playerState:t,position:this.m_onlineVideoPlayer.getCurrentTime(),volume:this.m_onlineVideoPlayer.getVolume(),muted:this.m_onlineVideoPlayer.isMuted(),playerPositionSkew:0}}}}},{key:"shouldSyncMediaVolumeChanged",value:function(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||e.origin.eventTrigger===c.MediaEventType.MediaVolumeChanged}},{key:"shouldSyncMediaEnded",value:function(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||e.origin.eventTrigger!==c.MediaEventType.MediaEnded}},{key:"shouldSuppressMediaSyncEvent",value:function(e,t){return!((e!==c.MediaEventType.MediaVolumeChanged||!this.shouldSuppressVolumeChangedEvents())&&(!t||!this.isLoopingBackgroundVideo(t))&&(!this.m_mediaSyncLock||this.m_mediaSyncLock.shouldSendMediaUpdate())&&!this.m_fSuppressMediaSyncEvents)}},{key:"shouldSuppressVolumeChangedEvents",value:function(){var e=S.Settings.readBooleanOrDefault("enableGlobalMute",!1);return f.ULS.sendTraceTag(520123267,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"shouldSuppressVolumeChangedEvents: ".concat(JSON.stringify({mediaName:this.m_media.name,globalMuteEnabled:e,isGlobalMute:this.m_environment.isGlobalMute,globallyUnmuting:this.m_fIsGloballyUnmuting}))),!(!e||!this.m_environment.isGlobalMute&&!this.m_fIsGloballyUnmuting||(this.m_fIsGloballyUnmuting=!1,0))}},{key:"updateGlobalMute",value:function(e){if(S.Settings.readBooleanOrDefault("enableGlobalMute",!1)){var t=!1;this.m_localMediaInfo&&this.m_localMediaInfo.el?(t=this.m_localMediaInfo.el.muted&&!e,this.m_localMediaInfo.el.muted=e):this.m_linkedMediaEl&&this.m_onlineVideoPlayer&&(t=!e&&this.m_fOnSlide&&!0===this.m_onlineVideoPlayer.isMuted(),e?this.m_onlineVideoPlayer.setMute():this.m_onlineVideoPlayer.setUnMute()),this.m_fIsGloballyUnmuting=t,f.ULS.sendTraceTag(520123266,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"Updated global mute state for media ".concat(this.m_media.name," (isGlobalMute: ").concat(this.m_environment.isGlobalMute,", muted: ").concat(e,", isGloballyUnmuting: ").concat(this.m_fIsGloballyUnmuting,")"))}}},{key:"resizeToScale",value:function(e){var t;if(this.m_slideScale!==e&&(this.m_slideScale=e,this.m_localMediaEventsDiv&&(t=this.m_localMediaEventsDiv),this.m_linkedMediaEl&&(t=this.m_linkedMediaEl),t)){var r=this.getAdjustedBounds();this.setSizeAndScale(t,new c.Vector2(r.width,r.height))}}},{key:"mutePlayingMedia",value:function(){if(!this.m_fMutingOtherMedia&&this.isPlaying())if(f.ULS.sendTraceTag(523347022,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement.mutePlayingMedia: Muting media name: ".concat(this.m_media.name,"}")),this.m_fMuteSyncDisabled=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el)this.m_fPreviouslyMuted=this.m_localMediaInfo.el.muted,this.m_localMediaInfo.el.muted=!0;else if(this.m_onlineVideoPlayer){var e=this.m_onlineVideoPlayer.isMuted();void 0!==e&&(this.m_fPreviouslyMuted=e),this.m_onlineVideoPlayer.setMute()}}},{key:"muteAllPlayingMediaiOS",value:function(){var e=this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.isSeeking();this.isMuteMultipleMediaiOSEnabled()&&(0,d.isHostIOS)(this.m_environment)&&!e&&(f.ULS.sendTraceTag(523347021,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement: Muting all playing media (iOS only)"),this.m_fMutingOtherMedia=!0,this.m_environment.muteAllPlayingMedia(),this.m_fMutingOtherMedia=!1)}},{key:"restorePreviousMuteState",value:function(){this.m_fMuteSyncDisabled&&(f.ULS.sendTraceTag(521422149,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement.restorePreviousMuteState: Previously muted: ".concat(this.m_fPreviouslyMuted,", media name: ").concat(this.m_media.name,"}")),this.m_fPreviouslyMuted?this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute():this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!1:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setUnMute(),this.m_fMuteSyncDisabled=!1)}},{key:"isMuteMultipleMediaiOSEnabled",value:function(){return S.Settings.readBooleanOrDefault("enableMuteMultipleMediaiOS",!0)}},{key:"updatePixelScale",value:function(){this.m_pixelScale=this.m_environment.rendererEnvironment.getPixelScale(this.m_slideSizePixels),this.m_localMediaPlaybackPerf&&(this.m_localMediaPlaybackPerf.pixelScale=this.m_pixelScale)}},{key:"setIsHlsForTelemetry",value:function(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHls(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHls(e)}},{key:"setHlsBandwidthEstimatesForTelemetry",value:function(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHlsBandwidthEstimate(e)}},{key:"shouldSkipAnimation",value:function(e){var t=this;if(!_.ChangeGate.isChangeGateEnabled("SVM.SkipAnimationIfPlayed")||!this.m_firstPlayAnimation||1!==e)return!1;var r=this.getMediaCurrentState(),i=r&&r.playerState&&(r.playerState===c.MediaPlayerState.MediaPlayed||r.playerState===c.MediaPlayerState.MediaEnded),n=this.getMediaCurrentState(),a=n&&n.position?n.position:0,o=!1;if(o=_.ChangeGate.isChangeGateEnabled("SVM.checkTrimStartTime")?Math.abs(a-this.m_media.trimStartMs/1e3)>.1:0!==a,!i&&!o)return!1;if(f.ULS.sendTraceTag(526989073,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"".concat(JSON.stringify({Description:"MediaViewElement.shouldSkipAnimation - Skipping play animation since the video has already played",playerPlayed:i,playerNotAtStart:o,position:a,trimStartMs:this.m_media.trimStartMs,playerState:r?r.playerState:"undefined"}))),_.ChangeGate.isChangeGateEnabled("SVM.suppressMediaNextStep")&&!this.isPresenter())return f.ULS.sendTraceTag(509689889,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement.shouldSkipAnimation - Skipping mediaAnimation-nextStep since we're an attendee"),!0;this.m_firstPlayAnimation=!1;var s=S.Settings.readNumberOrDefault("mediaNextStepDelay",100);return window.setTimeout((function(){return t.m_slideEvents.emit("mediaAnimation-nextStep")}),s),!0}},{key:"onLocalPlaybackQualityImpactError",value:function(e){var t=e;t.qosVeto=e.impactType,m.VetoUtils.recordVeto(t.qosVeto,t)}}],[{key:"isVideoCroppedToShape",value:function(e){return!(!e.paths||0===e.paths.length||1===e.paths.length&&e.paths[0].isUntransformedRect)}},{key:"isVideoRotated",value:function(e){return!(!e.transform||!e.transform.rotation||0===e.transform.rotation)}},{key:"getLocalizedString",value:function(){return"undefined"!=typeof PowerpointSlideshowStrings?{audioStr:PowerpointSlideshowStrings.AudioMediaElementLabel,videoStr:PowerpointSlideshowStrings.VideoMediaElementLabel}:{audioStr:"Audio",videoStr:"Video"}}},{key:"getNetworkBandwidthInMbps",value:function(){var e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null,t=void 0;return e?t=e.downlink:f.ULS.sendTraceTag(527217103,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Warning,"MediaViewElement::getNetworkBandwidthInMbps: Could not find network connection as connection is ".concat(e," ")),t}},{key:"ignoreClick",value:function(e){e||(e=window.event),e&&(e.cancelBubble=!0),e&&e.stopPropagation&&e.stopPropagation()}},{key:"showMediaElement",value:function(e,t){e&&(e.style.opacity=t?"1":"0")}},{key:"getEventName",value:function(e){switch(e){case c.MediaEventType.MediaPlayed:return"mediaPlayed";case c.MediaEventType.MediaPaused:return"mediaPaused";case c.MediaEventType.MediaSeeked:return"mediaSeeked";case c.MediaEventType.MediaVolumeChanged:return"mediaVolumeChanged";case c.MediaEventType.MediaEnded:return"mediaEnded";default:return""}}},{key:"getMediaType",value:function(e){if(e.isLocal)return 0===e.contentType.toLowerCase().indexOf("audio/")?c.MediaType.Audio:c.MediaType.Video;var t=(0,y.getProviderName)(e.src);return"YouTube"===t?c.MediaType.YouTube:"Vimeo"===t?c.MediaType.Vimeo:"StreamClassic"===t?c.MediaType.StreamClassic:"Flip"===t?c.MediaType.Flip:"Ted"===t?c.MediaType.Ted:"SlideShare"===t?c.MediaType.SlideShare:c.MediaType.Stream2}},{key:"logMediaSyncEmission",value:function(e,t){f.ULS.sendTraceTag(527262535,f.LogCategory.msoulscat_Wac_PptSession,f.TraceLevel.Info,"MediaViewElement: Emitting Media Sync ".concat(t?"Initial State":"Event",": ").concat(JSON.stringify(e)))}},{key:"getMediaLengthFromMediaUrl",value:function(e){var t,r=e.searchParams.get("mediaLength");return null!==r&&(t=Number(r)),Number.isNaN(t)?void 0:t}}]);var t,i,o}();t.MediaViewElement=N,N.BD_HTML5_MEDIA_RETRY_COUNT=6,N.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT=1,N.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS=600,N.BD_HTML5_MEDIA_RETRY_MULTIPLIER=2,N.MIN_AUDIO_PLAYBACK_BAR_WIDTH=240,N.MIN_AUDIO_PLAYBACK_BAR_HEIGHT=30,N.LinkedMediaContainerName="LinkedMedia-Container",N.LinkedMediaIFramename="LinkedMedia-IFrame"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIconSvg=function(e){var t="";switch(e){case"play-pause-gfxicon":t=o;break;case"volume-gfxicon":t=a;break;case"captions-gfxicon":t=s;break;case"captions-active-gfxicon":t=l;break;case"checkmark-gfxicon":t=c;break;case"fullscreen-gfxicon":t=u}var r=(new DOMParser).parseFromString(t,"image/svg+xml"),i=document.importNode(r.documentElement,!0);return i.classList.add(e),i.setAttribute("aria-hidden","true"),i};var i='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">',n='<path d="M12.4014 13.2403C13.222 12.83 14.2039 12.9967 14.8536 13.6464C15.0488 13.8417 15.0488 14.1583 14.8535 14.3536C14.6583 14.5488 14.3417 14.5488 14.1464 14.3535C13.7961 14.0032 13.278 13.92 12.8486 14.1347C12.4366 14.3407 12 14.8852 12 16C12 17.1148 12.4366 17.6593 12.8486 17.8653C13.278 18.08 13.7961 17.9967 14.1464 17.6464C14.3417 17.4512 14.6583 17.4512 14.8536 17.6464C15.0488 17.8417 15.0488 18.1583 14.8536 18.3535C14.2039 19.0032 13.222 19.17 12.4014 18.7597C11.5634 18.3407 11 17.3852 11 16C11 14.6149 11.5634 13.6593 12.4014 13.2403ZM20.3536 13.6465C19.7039 12.9968 18.722 12.83 17.9014 13.2403C17.0634 13.6593 16.5 14.6149 16.5 16C16.5 17.3852 17.0634 18.3407 17.9014 18.7597C18.722 19.17 19.7039 19.0033 20.3536 18.3536C20.5488 18.1583 20.5488 17.8417 20.3536 17.6465C20.1583 17.4512 19.8417 17.4512 19.6464 17.6465C19.2961 17.9968 18.778 18.08 18.3486 17.8653C17.9366 17.6593 17.5 17.1148 17.5 16C17.5 14.8852 17.9366 14.3408 18.3486 14.1347C18.778 13.9201 19.2961 14.0033 19.6464 14.3536C19.8417 14.5488 20.1583 14.5488 20.3535 14.3536C20.5488 14.1583 20.5488 13.8417 20.3536 13.6465ZM8 13C8 11.3431 9.34315 10 11 10H21C22.6569 10 24 11.3431 24 13V19C24 20.6569 22.6569 22 21 22H11C9.34315 22 8 20.6569 8 19V13ZM11 11C9.89543 11 9 11.8954 9 13V19C9 20.1046 9.89543 21 11 21H21C22.1046 21 23 20.1046 23 19V13C23 11.8954 22.1046 11 21 11H11Z" fill="white"/>',a="".concat(i).concat('<path id="volume-low-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995Z"/>').concat('<path id="volume-medium-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/>').concat('<path id="volume-high-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM22.1422 10.7746C22.3478 10.5903 22.6639 10.6076 22.8482 10.8133C25.5644 13.8449 25.5645 18.449 22.8483 21.4806C22.664 21.6863 22.3479 21.7036 22.1422 21.5194C21.9365 21.3351 21.9192 21.019 22.1035 20.8133C24.4794 18.1615 24.4794 14.1324 22.1034 11.4806C21.9192 11.2749 21.9365 10.9588 22.1422 10.7746ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/>').concat('<path id="volume-muted-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.029 14.1665C20.2243 13.9712 20.5409 13.9712 20.7361 14.1665L22.3826 15.8129L24.029 14.1665C24.2243 13.9712 24.5409 13.9712 24.7361 14.1665C24.9314 14.3617 24.9314 14.6783 24.7361 14.8736L23.0897 16.52L24.7361 18.1665C24.9314 18.3617 24.9314 18.6783 24.7361 18.8736C24.5409 19.0688 24.2243 19.0688 24.029 18.8736L22.3826 17.2271L20.7361 18.8736C20.5409 19.0688 20.2243 19.0688 20.029 18.8736C19.8338 18.6783 19.8338 18.3617 20.029 18.1665L21.6755 16.52L20.029 14.8736C19.8338 14.6783 19.8338 14.3617 20.029 14.1665Z"/>').concat("</svg>"),o="".concat(i).concat('<path id="play-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M24.1059 15.0879C25.1413 15.6575 25.1413 17.1443 24.1059 17.7139L14.1089 23.2129C13.1092 23.7628 11.8855 23.0402 11.8855 21.9L11.8855 10.9018C11.8855 9.76156 13.1092 9.03893 14.1089 9.58883L24.1059 15.0879ZM23.6236 16.8385C23.9688 16.6487 23.9688 16.1531 23.6236 15.9632L13.6266 10.4641C13.2934 10.2808 12.8855 10.5217 12.8855 10.9018L12.8855 21.9C12.8855 22.28 13.2934 22.5209 13.6266 22.3376L23.6236 16.8385Z"/>').concat('<path  id="pause-gfxicon" fill="#FFFFFF" fill-opacity="1.000" d="M11.8855 8.77393C10.7809 8.77393 9.8855 9.66936 9.8855 10.7739V22.7739C9.8855 23.8785 10.7809 24.7739 11.8855 24.7739H13.8855C14.9901 24.7739 15.8855 23.8785 15.8855 22.7739V10.7739C15.8855 9.66936 14.9901 8.77393 13.8855 8.77393H11.8855ZM10.8855 10.7739C10.8855 10.2216 11.3332 9.77393 11.8855 9.77393H13.8855C14.4378 9.77393 14.8855 10.2216 14.8855 10.7739V22.7739C14.8855 23.3262 14.4378 23.7739 13.8855 23.7739H11.8855C11.3332 23.7739 10.8855 23.3262 10.8855 22.7739V10.7739ZM19.8855 8.77393C18.7809 8.77393 17.8855 9.66936 17.8855 10.7739V22.7739C17.8855 23.8785 18.7809 24.7739 19.8855 24.7739H21.8855C22.9901 24.7739 23.8855 23.8785 23.8855 22.7739V10.7739C23.8855 9.66936 22.9901 8.77393 21.8855 8.77393H19.8855ZM18.8855 10.7739C18.8855 10.2216 19.3332 9.77393 19.8855 9.77393H21.8855C22.4378 9.77393 22.8855 10.2216 22.8855 10.7739V22.7739C22.8855 23.3262 22.4378 23.7739 21.8855 23.7739H19.8855C19.3332 23.7739 18.8855 23.3262 18.8855 22.7739V10.7739Z"/>').concat("</svg>"),s="".concat(i).concat(n).concat("</svg>"),l="".concat(i).concat(n).concat('<rect y="31.885" width="2" height="32" transform="rotate(-90 0 31.885)" fill="white"/>').concat("</svg>"),c="".concat('<svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3516 1.35156L5 9.71094L0.648438 5.35156L1.35156 4.64844L5 8.28906L12.6484 0.648438L13.3516 1.35156Z" fill="white"/>').concat("</svg>"),u="".concat(i).concat('<path id="fullscreen-enter-gfxicon" d="M9.8855 11.8931C9.8855 10.7885 10.7809 9.89307 11.8855 9.89307H13.8855C14.1616 9.89307 14.3855 10.1169 14.3855 10.3931C14.3855 10.6692 14.1616 10.8931 13.8855 10.8931H11.8855C11.3332 10.8931 10.8855 11.3408 10.8855 11.8931V13.8931C10.8855 14.1692 10.6616 14.3931 10.3855 14.3931C10.1094 14.3931 9.8855 14.1692 9.8855 13.8931V11.8931ZM19.3855 10.3931C19.3855 10.1169 19.6094 9.89307 19.8855 9.89307H21.8855C22.9901 9.89307 23.8855 10.7885 23.8855 11.8931V13.8931C23.8855 14.1692 23.6616 14.3931 23.3855 14.3931C23.1094 14.3931 22.8855 14.1692 22.8855 13.8931V11.8931C22.8855 11.3408 22.4378 10.8931 21.8855 10.8931H19.8855C19.6094 10.8931 19.3855 10.6692 19.3855 10.3931ZM10.3855 19.3931C10.6616 19.3931 10.8855 19.6169 10.8855 19.8931V21.8931C10.8855 22.4454 11.3332 22.8931 11.8855 22.8931H13.8855C14.1616 22.8931 14.3855 23.1169 14.3855 23.3931C14.3855 23.6692 14.1616 23.8931 13.8855 23.8931H11.8855C10.7809 23.8931 9.8855 22.9976 9.8855 21.8931V19.8931C9.8855 19.6169 10.1094 19.3931 10.3855 19.3931ZM23.3855 19.3931C23.6616 19.3931 23.8855 19.6169 23.8855 19.8931V21.8931C23.8855 22.9976 22.9901 23.8931 21.8855 23.8931H19.8855C19.6094 23.8931 19.3855 23.6692 19.3855 23.3931C19.3855 23.1169 19.6094 22.8931 19.8855 22.8931H21.8855C22.4378 22.8931 22.8855 22.4454 22.8855 21.8931V19.8931C22.8855 19.6169 23.1094 19.3931 23.3855 19.3931Z" fill="white"/>').concat('<path id="fullscreen-exit-gfxicon" d="M20.8855 11.2661C20.8855 11.8184 21.3332 12.2661 21.8855 12.2661L23.8855 12.2661C24.1616 12.2661 24.3855 12.49 24.3855 12.7661C24.3855 13.0423 24.1616 13.2661 23.8855 13.2661H21.8855C20.7809 13.2661 19.8855 12.3707 19.8855 11.2661V9.26611C19.8855 8.98997 20.1094 8.76611 20.3855 8.76611C20.6616 8.76611 20.8855 8.98997 20.8855 9.26611V11.2661ZM12.8855 21.2661C12.8855 20.7138 12.4378 20.2661 11.8855 20.2661H9.8855C9.60936 20.2661 9.3855 20.0423 9.3855 19.7661C9.3855 19.49 9.60936 19.2661 9.8855 19.2661H11.8855C12.9901 19.2661 13.8855 20.1615 13.8855 21.2661V23.2661C13.8855 23.5423 13.6616 23.7661 13.3855 23.7661C13.1094 23.7661 12.8855 23.5423 12.8855 23.2661V21.2661ZM20.8855 21.2661C20.8855 20.7138 21.3332 20.2661 21.8855 20.2661H23.8855C24.1616 20.2661 24.3855 20.0423 24.3855 19.7661C24.3855 19.49 24.1616 19.2661 23.8855 19.2661H21.8855C20.7809 19.2661 19.8855 20.1615 19.8855 21.2661V23.2661C19.8855 23.5423 20.1094 23.7661 20.3855 23.7661C20.6616 23.7661 20.8855 23.5423 20.8855 23.2661V21.2661ZM11.8855 12.2661C12.4378 12.2661 12.8855 11.8184 12.8855 11.2661L12.8855 9.26611C12.8855 8.98997 13.1094 8.76611 13.3855 8.76611C13.6616 8.76611 13.8855 8.98997 13.8855 9.26611V11.2661C13.8855 12.3707 12.9901 13.2661 11.8855 13.2661H9.8855C9.60936 13.2661 9.3855 13.0423 9.3855 12.7661C9.3855 12.49 9.60936 12.2661 9.8855 12.2661L11.8855 12.2661Z" fill="white"/>').concat("</svg>")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translateTagtoLanguage=function(e){for(var t,r=e.toLowerCase();void 0===t&&(t=i.get(r),!(r.indexOf("-")<0));)r=r.substring(0,r.lastIndexOf("-"));return void 0===t?e:t},t.checkPartialLangMatch=function(e,t){return null!==e&&null!==t&&e.toLowerCase().startsWith(t.toLowerCase())&&e.length>t.length&&"-"===e.charAt(t.length)},t.languageMap=void 0;var i=new Map([["af","Afrikaans"],["am",""],["ar",""],["as",""],["bg",""],["bn",""],["bs","Bosanski"],["ca","Catal"],["cs","esky"],["cy","Cymraeg"],["da","Dansk"],["de","Deutsch"],["el",""],["en","English"],["es","Espaol"],["et","Eesti"],["fa",""],["fi","Suomi"],["fil","Filipino"],["fj","Viti"],["fr","Franais"],["ga","Gaeilge (ire)"],["gu",""],["he",""],["hi",""],["hr","Hrvatski"],["ht","Ayisyen"],["hu","Magyar"],["id","Bahasa Indonesia"],["is","slenska"],["it","Italiano"],["ja",""],["jv","Jawa"],["kk",""],["km",""],["kmr","Kurd (Bakur)"],["kn",""],["ko",""],["ku"," ()"],["lt","Lietuvi"],["lo",""],["lv","Latvieu"],["mg","Malagasy"],["mi","Te reo Mori"],["mk",""],["ml",""],["mr",""],["ms","Melayu"],["mt","Malti"],["mww","Hmoob"],["my",""],["nb","Norsk Bokml"],["nl","Nederlands"],["no","Norsk"],["or",""],["otq","Maxei hho"],["pa",""],["pl","Polski"],["prs",""],["ps",""],["pt","Portugus"],["ro","Romn"],["ru",""],["si",""],["sk","Slovenina"],["sl","Slovenina"],["sm","Samoa"],["sr-cyrl"," ()"],["sr-latn","srpski (latinica)"],["sv","Svenska"],["sw","Kiswahili"],["ta",""],["te",""],["th",""],["to","Tonga"],["tr","Trke"],["ty","Tahiti"],["uk",""],["ur",""],["uz","ozbek"],["vi","Ting Vit"],["yua","Yucateco"],["yue",""],["zh",""],["zh-cn"," ()"],["zh-hans"," ()"],["zh-hant"," ()"],["zh-hk"," ()"],["zh-tw"," ()"],["zu","isiZulu"],["unknown","Unknown"]]);t.languageMap=i},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.toSeconds=function(e){return e/1e3},t.formatTime=function(e){var t=s(e),r=(0,n.default)(t,3),i=r[0],a=r[1],o=r[2];return i>0?"".concat(i,":").concat(a<10?"0":"").concat(a,":").concat(a<10?"0":"").concat(o):"".concat(a,":").concat(o<10?"0":"").concat(o)},t.formatTimeForScreenReader=function(e,t){var r,i=(r=t.localizedLabelsStr,void 0!==t.localizedTimeStr&&null!==t.localizedTimeStr&&Array.isArray(r)&&void 0!==r[0]&&null!==r[0]&&void 0!==r[1]&&null!==r[1]&&void 0!==r[2]&&null!==r[2]&&void 0!==r[3]&&null!==r[3]&&void 0!==r[4]&&null!==r[4]&&void 0!==r[5]&&null!==r[5]);i||o.Log.error(507381641,"PlaybackControlsUtils::formatTimeForScreenReader invalid string resources.");var l,c,u,d=s(e),h=(0,n.default)(d,3),f=h[0],m=h[1],p=h[2];return a.Settings.getBoolean("checkScreenReaderLocalizedTimeStrUndefinedDisabled")||i?t.localizedTimeStr.replace("{0}","".concat(f>0?f.toFixed(0):"")).replace("{1}","".concat(f>0?(u=f,1===u?t.localizedLabelsStr[0]:t.localizedLabelsStr[1]):"")).replace("{2}","".concat(m>0?m.toFixed(0):"")).replace("{3}","".concat(m>0?(c=m,1===c?t.localizedLabelsStr[2]:t.localizedLabelsStr[3]):"")).replace("{4}",(l=p,0===e?"0":l>0?l.toFixed(0):"")).replace("{5}",function(r){return e>0&&0===r?"":1===r?t.localizedLabelsStr[4]:t.localizedLabelsStr[5]}(p)):""},t.hasVisibleClass=function(e){return e.classList.contains("visible")},t.setVisibleClass=function(e){e.classList.add("visible")},t.removeVisibleClass=function(e){e.classList.remove("visible")},t.hasInvisibleClass=function(e){return e.classList.contains("invisible")},t.setInvisibleClass=function(e){e.classList.add("invisible")},t.removeInvisibleClass=function(e){e.classList.remove("invisible")},t.toggleInvisibleClass=function(e){e.classList.toggle("invisible")};var n=i(r(19)),a=r(44),o=r(17);function s(e){var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60);return[t,r,Math.floor(e-3600*t-60*r)]}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackControlsOrganizer=void 0;var n=i(r(1)),a=i(r(2)),o=r(44);function s(e,t){void 0!==e&&(e.style.display=t)}function l(e,t){void 0!==t&&e.appendChild(t)}var c=(0,a.default)((function e(t,r,i,a,s,l,c,u,d){(0,n.default)(this,e),this.playbackSpeedBeforeCaptions=!1,this.playbackSpeedBeforeCaptions=o.Settings.getBoolean("playbackSpeedBeforeCaptions"),this.leftControls=t,this.rightControls=r,this.progressBar=i,this.timeContainer=a,this.volumeContainer=s,this.volumeSliderContainer=l,this.speedButton=c,this.captionsButton=u,this.fullscreenButton=d;for(var h=0,f=0,m=[this.speedButton,this.captionsButton,this.fullscreenButton];f<m.length;f++)void 0!==m[f]&&(h+=32);var p=166+h;this.breakPoints=[p],this.breakPoints.push(p-86);for(var g=0,v=[this.speedButton,this.captionsButton,this.fullscreenButton];g<v.length;g++)void 0!==v[g]&&this.breakPoints.push(this.breakPoints[this.breakPoints.length-1]-32)}),[{key:"onHeightChanged",value:function(e){if(void 0!==this.volumeSliderContainer){var t=e>=165;this.volumeSliderFitsInVideoRect!==t&&(t?this.volumeContainer.appendChild(this.volumeSliderContainer):this.volumeSliderContainer.remove(),this.volumeSliderFitsInVideoRect=t)}}},{key:"onWidthChanged",value:function(e){if(0!==e){for(var t=0;t<this.breakPoints.length&&!(e>=this.breakPoints[t]);)t++;if(this.breakPointsIdx!==t){var r=!0,i=!0,n=!0,a=void 0!==this.captionsButton,o=void 0!==this.speedButton,s=void 0!==this.fullscreenButton,l=!1;switch(t){case this.breakPoints.length:case 5:r=!1,i=!1,n=!1,a=!1,o=!1,s=!1,l=!0;break;case 4:r=!1,n=!1,a=!1,o=!1,s=!1,l=!0;break;case 3:r=!1,n=!1;for(var c=0;c<2;c+=1)o?o=!1:s?s=!1:a&&(a=!1);l=!0;break;case 2:r=!1,n=!1,o?o=!1:s?s=!1:a&&(a=!1),l=!0;break;case 1:r=!1,n=!1}this.organize(r,n,i,o,a,s,l),this.breakPointsIdx=t}}}},{key:"organize",value:function(e,t,r,i,n,a,o){s(this.progressBar,e?"":"none"),s(this.timeContainer,t?"":"none"),s(this.volumeContainer,r?"":"none"),s(this.speedButton,i?"":"none"),s(this.captionsButton,n?"":"none"),s(this.fullscreenButton,a?"":"none"),o?(this.playbackSpeedBeforeCaptions?(l(this.leftControls,this.speedButton),l(this.leftControls,this.captionsButton)):(l(this.leftControls,this.captionsButton),l(this.leftControls,this.speedButton)),l(this.leftControls,this.fullscreenButton),this.leftControls.style.width="100%",this.leftControls.style.justifyContent="space-between"):(this.playbackSpeedBeforeCaptions?(l(this.rightControls,this.speedButton),l(this.rightControls,this.captionsButton)):(l(this.rightControls,this.captionsButton),l(this.rightControls,this.speedButton)),l(this.rightControls,this.fullscreenButton),this.leftControls.style.width="",this.leftControls.style.justifyContent="")}}]);t.PlaybackControlsOrganizer=c},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlayer=void 0;var n=i(r(1)),a=i(r(2)),o=r(159),s=r(17),l=r(305),c=r(316),u=r(44),d=(0,a.default)((function e(t,r,i,a,u,d,h,f){(0,n.default)(this,e);var m=void 0!==u.loggableId?u.loggableId:"",p=void 0!==u.mediaType?o.MediaType[u.mediaType]:"Unknown";this.playbackTracker=new l.LocalMediaPlaybackTracker(a,m,p,h);try{this.client=(0,c.createLocalClient)(t,r,i,u,this.playbackTracker,d,f)}catch(e){s.Log.info(508650255,"Error creating local video client: ".concat(e.message))}void 0!==u.contentType&&this.playbackTracker.setContentType(u.contentType),!0===u.useCustomControls&&this.playbackTracker.setIsUsingPlaybackControls()}),[{key:"playMedia",value:function(){void 0!==this.client&&this.client.play()}},{key:"pauseMedia",value:function(){void 0!==this.client&&this.client.pause()}},{key:"seekMedia",value:function(e){if(void 0!==this.client)if(u.Settings.getBoolean("sanitizeLocalInputs")){var t=Math.max(e,0);this.client.seekTo(t)}else this.client.seekTo(e)}},{key:"stopMedia",value:function(){void 0!==this.client&&this.client.stop()}},{key:"togglePauseMedia",value:function(){void 0!==this.client&&this.client.togglePause()}},{key:"isPaused",value:function(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}},{key:"setMute",value:function(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}},{key:"setUnMute",value:function(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}},{key:"isMuted",value:function(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}},{key:"setVolume",value:function(e){if(void 0!==this.client&&void 0!==this.client.setVolume)if(u.Settings.getBoolean("sanitizeLocalInputs")){var t=Math.min(Math.max(e,0),1);this.client.setVolume(t)}else this.client.setVolume(e)}},{key:"getVolume",value:function(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}},{key:"setCrossOrigin",value:function(e){var t=this.getMediaElement();void 0!==t&&(t.crossOrigin=e)}},{key:"setSource",value:function(e){void 0!==this.client&&void 0!==this.client.setSource&&this.client.setSource(e),this.onSourceSet()}},{key:"onSourceSet",value:function(){void 0!==this.playbackTracker&&this.playbackTracker.onSourceSet()}},{key:"setMediaExtension",value:function(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaExtension(e)}},{key:"setMediaLength",value:function(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaLength(e)}},{key:"setRetriesLeft",value:function(e){void 0!==this.playbackTracker&&this.playbackTracker.setRetriesLeft(e)}},{key:"setUiHostType",value:function(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}},{key:"setFlights",value:function(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}},{key:"setPlayRequestTime",value:function(){var e;null===(e=this.playbackTracker)||void 0===e||e.onPlayRequested()}},{key:"getMediaElement",value:function(){if(void 0!==this.client)return this.client.getPlayer()}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"getCurrentTime",value:function(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}},{key:"getDuration",value:function(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}},{key:"cleanup",value:function(){void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient()}}]);t.LocalMediaPlayer=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlaybackTracker=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10)),u=r(44),d=r(160),h=r(17);function f(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var m=function(e){function t(e,r,i,a){var o;return(0,n.default)(this,t),(o=f(this,t,[e,"Local",r,i,a])).isFirstCanPlay=!0,o.isFirstCanPlayThrough=!0,o.isFirstPlay=!0,o.useLoadedMetadataAsInteractivityEvent=!1,o.localData={},o.useLoadedMetadataAsInteractivityEvent=u.Settings.getBoolean("useLoadedMetadataAsInteractivityEvent"),o}return(0,c.default)(t,e),(0,a.default)(t,[{key:"onLoadStart",value:function(){void 0===this.baseData.timeOfLoadStart&&(this.localData.timeOfLoadedMetadata=void 0,this.localData.timeOfCanPlayThrough=void 0),(0,s.default)((0,l.default)(t.prototype),"onLoadStart",this).call(this)}},{key:"onLoadedMetadata",value:function(){void 0===this.localData.timeOfLoadedMetadata&&(this.localData.timeOfLoadedMetadata=Date.now(),this.useLoadedMetadataAsInteractivityEvent?this.baseData.timeOfCanPlay=this.localData.timeOfLoadedMetadata:this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}},{key:"onCanPlay",value:function(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||(0,s.default)((0,l.default)(t.prototype),"onCanPlay",this).call(this)),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||h.Log.error(508695704,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: ".concat(this.baseData.loggableMediaId)))}},{key:"onCanPlayThrough",value:function(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||(0,s.default)((0,l.default)(t.prototype),"onCanPlay",this).call(this)),this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.localData.timeOfCanPlayThrough=Date.now(),this.isFirstCanPlay&&h.Log.error(508704418,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: ".concat(this.baseData.loggableMediaId)))}},{key:"onPlay",value:function(){this.checkPlayerNotReady("play"),(0,s.default)((0,l.default)(t.prototype),"onPlay",this).call(this),this.isFirstPlay&&(this.isFirstPlay=!1,this.isFirstCanPlay&&h.Log.error(508704417,"No 'canplay' event was triggered before triggering the 'play' event on media: ".concat(this.baseData.loggableMediaId)))}},{key:"onPlaying",value:function(){this.checkPlayerNotReady("playing"),(0,s.default)((0,l.default)(t.prototype),"onPlaying",this).call(this),this.isFirstPlay&&h.Log.error(507540381,"No 'play' event was triggered before triggering the 'playing' event on media: ".concat(this.baseData.loggableMediaId))}},{key:"onStalled",value:function(){this.isPlaying&&(void 0===this.localData.numberOfStalls?this.localData.numberOfStalls=1:this.localData.numberOfStalls+=1)}},{key:"cleanup",value:function(){this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,(0,s.default)((0,l.default)(t.prototype),"cleanup",this).call(this)}},{key:"getPlaybackData",value:function(){return Object.assign(Object.assign({},(0,s.default)((0,l.default)(t.prototype),"getPlaybackData",this).call(this)),this.localData)}},{key:"setSrcDimensions",value:function(e,t){this.localData.sourceVideoWidth=e,this.localData.sourceVideoHeight=t}},{key:"setMediaExtension",value:function(e){this.localData.mediaExtension=e}},{key:"setContentType",value:function(e){this.localData.contentType=e}},{key:"setMediaLength",value:function(e){this.localData.mediaLength=e}},{key:"setRetriesLeft",value:function(e){this.localData.retriesLeft=e}},{key:"setIsUsingPlaybackControls",value:function(){this.localData.isUsingPlaybackControls=!0}},{key:"checkPlayerNotReady",value:function(e){void 0===this.baseData.timeOfCanPlay&&h.Log.info(507540380,"Event emitted before media became interactive: ".concat(JSON.stringify({event:e,media:this.baseData.loggableMediaId,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid})))}}])}(d.BaseMediaPlaybackTracker);t.LocalMediaPlaybackTracker=m},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a,o=i(r(161)),s=i(r(91)),l=0,c=0;t.default=function(e,t,r){var i=t&&r||0,u=t||new Array(16),d=(e=e||{}).node||n,h=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==h){var f=e.random||(e.rng||o.default)();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=a=16383&(f[6]<<8|f[7]))}var m=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:c+1,g=m-l+(p-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||m>l)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=m,c=p,a=h;var v=(1e4*(268435455&(m+=122192928e5))+p)%4294967296;u[i++]=v>>>24&255,u[i++]=v>>>16&255,u[i++]=v>>>8&255,u[i++]=255&v;var y=m/4294967296*1e4&268435455;u[i++]=y>>>8&255,u[i++]=255&y,u[i++]=y>>>24&15|16,u[i++]=y>>>16&255,u[i++]=h>>>8|128,u[i++]=255&h;for(var _=0;_<6;++_)u[i+_]=d[_];return t||(0,s.default)(u)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(162)),a=i(r(309)),o=(0,n.default)("v3",48,a.default);t.default=o},function(e,t,r){"use strict";function i(e){return 14+(e+64>>>9<<4)+1}function n(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function a(e,t,r,i,a,o){return n((s=n(n(t,e),n(i,o)))<<(l=a)|s>>>32-l,r);var s,l}function o(e,t,r,i,n,o,s){return a(t&r|~t&i,e,t,n,o,s)}function s(e,t,r,i,n,o,s){return a(t&i|r&~i,e,t,n,o,s)}function l(e,t,r,i,n,o,s){return a(t^r^i,e,t,n,o,s)}function c(e,t,r,i,n,o,s){return a(r^(t|~i),e,t,n,o,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,i=0;i<r;i+=8){var n=e[i>>5]>>>i%32&255,a=parseInt("0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[i(t)-1]=t;for(var r=1732584193,a=-271733879,u=-1732584194,d=271733878,h=0;h<e.length;h+=16){var f=r,m=a,p=u,g=d;r=o(r,a,u,d,e[h],7,-680876936),d=o(d,r,a,u,e[h+1],12,-389564586),u=o(u,d,r,a,e[h+2],17,606105819),a=o(a,u,d,r,e[h+3],22,-1044525330),r=o(r,a,u,d,e[h+4],7,-176418897),d=o(d,r,a,u,e[h+5],12,1200080426),u=o(u,d,r,a,e[h+6],17,-1473231341),a=o(a,u,d,r,e[h+7],22,-45705983),r=o(r,a,u,d,e[h+8],7,1770035416),d=o(d,r,a,u,e[h+9],12,-1958414417),u=o(u,d,r,a,e[h+10],17,-42063),a=o(a,u,d,r,e[h+11],22,-1990404162),r=o(r,a,u,d,e[h+12],7,1804603682),d=o(d,r,a,u,e[h+13],12,-40341101),u=o(u,d,r,a,e[h+14],17,-1502002290),r=s(r,a=o(a,u,d,r,e[h+15],22,1236535329),u,d,e[h+1],5,-165796510),d=s(d,r,a,u,e[h+6],9,-1069501632),u=s(u,d,r,a,e[h+11],14,643717713),a=s(a,u,d,r,e[h],20,-373897302),r=s(r,a,u,d,e[h+5],5,-701558691),d=s(d,r,a,u,e[h+10],9,38016083),u=s(u,d,r,a,e[h+15],14,-660478335),a=s(a,u,d,r,e[h+4],20,-405537848),r=s(r,a,u,d,e[h+9],5,568446438),d=s(d,r,a,u,e[h+14],9,-1019803690),u=s(u,d,r,a,e[h+3],14,-187363961),a=s(a,u,d,r,e[h+8],20,1163531501),r=s(r,a,u,d,e[h+13],5,-1444681467),d=s(d,r,a,u,e[h+2],9,-51403784),u=s(u,d,r,a,e[h+7],14,1735328473),r=l(r,a=s(a,u,d,r,e[h+12],20,-1926607734),u,d,e[h+5],4,-378558),d=l(d,r,a,u,e[h+8],11,-2022574463),u=l(u,d,r,a,e[h+11],16,1839030562),a=l(a,u,d,r,e[h+14],23,-35309556),r=l(r,a,u,d,e[h+1],4,-1530992060),d=l(d,r,a,u,e[h+4],11,1272893353),u=l(u,d,r,a,e[h+7],16,-155497632),a=l(a,u,d,r,e[h+10],23,-1094730640),r=l(r,a,u,d,e[h+13],4,681279174),d=l(d,r,a,u,e[h],11,-358537222),u=l(u,d,r,a,e[h+3],16,-722521979),a=l(a,u,d,r,e[h+6],23,76029189),r=l(r,a,u,d,e[h+9],4,-640364487),d=l(d,r,a,u,e[h+12],11,-421815835),u=l(u,d,r,a,e[h+15],16,530742520),r=c(r,a=l(a,u,d,r,e[h+2],23,-995338651),u,d,e[h],6,-198630844),d=c(d,r,a,u,e[h+7],10,1126891415),u=c(u,d,r,a,e[h+14],15,-1416354905),a=c(a,u,d,r,e[h+5],21,-57434055),r=c(r,a,u,d,e[h+12],6,1700485571),d=c(d,r,a,u,e[h+3],10,-1894986606),u=c(u,d,r,a,e[h+10],15,-1051523),a=c(a,u,d,r,e[h+1],21,-2054922799),r=c(r,a,u,d,e[h+8],6,1873313359),d=c(d,r,a,u,e[h+15],10,-30611744),u=c(u,d,r,a,e[h+6],15,-1560198380),a=c(a,u,d,r,e[h+13],21,1309151649),r=c(r,a,u,d,e[h+4],6,-145523070),d=c(d,r,a,u,e[h+11],10,-1120210379),u=c(u,d,r,a,e[h+2],15,718787259),a=c(a,u,d,r,e[h+9],21,-343485551),r=n(r,f),a=n(a,m),u=n(u,p),d=n(d,g)}return[r,a,u,d]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(i(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(161)),a=i(r(91));t.default=function(e,t,r){var i=(e=e||{}).random||(e.rng||n.default)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=i[o];return t}return(0,a.default)(i)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(162)),a=i(r(312)),o=(0,n.default)("v5",80,a.default);t.default=o},function(e,t,r){"use strict";function i(e,t,r,i){switch(e){case 0:return t&r^~t&i;case 1:return t^r^i;case 2:return t&r^t&i^r&i;case 3:return t^r^i}}function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=[];for(var o=0;o<a.length;++o)e.push(a.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,l=Math.ceil(s/16),c=new Array(l),u=0;u<l;++u){for(var d=new Uint32Array(16),h=0;h<16;++h)d[h]=e[64*u+4*h]<<24|e[64*u+4*h+1]<<16|e[64*u+4*h+2]<<8|e[64*u+4*h+3];c[u]=d}c[l-1][14]=8*(e.length-1)/Math.pow(2,32),c[l-1][14]=Math.floor(c[l-1][14]),c[l-1][15]=8*(e.length-1)&4294967295;for(var f=0;f<l;++f){for(var m=new Uint32Array(80),p=0;p<16;++p)m[p]=c[f][p];for(var g=16;g<80;++g)m[g]=n(m[g-3]^m[g-8]^m[g-14]^m[g-16],1);for(var v=r[0],y=r[1],_=r[2],S=r[3],T=r[4],b=0;b<80;++b){var C=Math.floor(b/20),w=n(v,5)+i(C,y,_,S)+T+t[C]+m[b]>>>0;T=S,S=_,_=n(y,30)>>>0,y=v,v=w}r[0]=r[0]+v>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+_>>>0,r[3]=r[3]+S>>>0,r[4]=r[4]+T>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(92));t.default=function(e){if(!(0,n.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlaybackVetoes=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=(0,a.default)((function e(t,r,i,a,o){(0,n.default)(this,e),this.providerName="",this.mediaId="",this.vetoLogged=!1,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.appSettings=t,this.correlationId=r,void 0!==i&&(this.providerName=i),void 0!==a&&(this.mediaId=a),this.onVetoCallback=o,void 0!==t.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=t.SlowPlayVetoThreshold),void 0!==t.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=t.NotYetPlayedVetoThreshold)}),[{key:"wasVetoLogged",get:function(){return this.vetoLogged}},{key:"getError",value:function(){return this.error}},{key:"setError",value:function(e){this.error=e}},{key:"setProviderName",value:function(e){this.providerName=e}},{key:"setLoggableId",value:function(e){this.mediaId=e}},{key:"setCorrelationId",value:function(e){this.correlationId=e}},{key:"onError",value:function(e,t,r,i,n,a){var s=this.getPrefix(),l="".concat(s,"VideoError");r?l="".concat(s,"VideoErrorWhilePlaying"):void 0!==i?l="".concat(s,"VideoErrorAfterPlaying"):"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?l="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(l="Stream2VideoRedemptionStormError"));var c=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");o.Log.error(508671629,"Media raised error: ".concat(JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:l,message:c,provider:this.providerName,correlationId:this.correlationId})));var u=t?1:3;(void 0===this.error||u<=this.error.severity)&&(this.error={severity:u,name:l,message:c,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===n&&void 0===a||this.sendVeto("".concat(s,"MediaPlaybackFailure"),this.error.name,this.error.message))}},{key:"hasCriticalError",value:function(){return void 0!==this.error&&1===this.error.severity}},{key:"logPlaybackFailure",value:function(){if(void 0!==this.error&&1===this.error.severity){var e=this.getPrefix();this.sendVeto("".concat(e,"MediaPlaybackFailure"),this.error.name,this.error.message)}}},{key:"logIfSlowPlaybackStart",value:function(e){this.clearVideoNotPlayedTimeout(),e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow","Video played after ".concat(e," ms"))}},{key:"setVideoNotPlayedTimeout",value:function(e){var t=this;this.videoNotYetPlayedTimeout=window.setTimeout((function(){t.videoNotYetPlayedTimeout=void 0,void 0===e()&&t.onSlowPerfError("VideoNotYetPlayed","Video hasn't played after ".concat(t.notYetPlayedVetoThreshold," ms"))}),this.notYetPlayedVetoThreshold)}},{key:"clearVideoNotPlayedTimeout",value:function(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}},{key:"cleanup",value:function(){this.clearVideoNotPlayedTimeout(),this.error=void 0,this.vetoLogged=!1}},{key:"onSlowPerfError",value:function(e,t){var r=this.getPrefix(),i=r+e;o.Log.error(508671628,"Media slow perf: ".concat(JSON.stringify({name:i,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId}))),(void 0===this.error||2<=this.error.severity)&&(this.error={name:i,severity:2,message:t,timestamp:Date.now()}),this.sendVeto("".concat(r,"MediaPerfSlow"),i,t)}},{key:"getPrefix",value:function(){return"Local"===this.providerName?"Local":"Stream2"===this.providerName?"Stream2":"Online"}},{key:"sendVeto",value:function(e,t,r){this.vetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback({vetoName:e,errorName:t,details:r,correlationId:this.correlationId,mediaId:this.mediaId,providerName:this.providerName})}}]);t.MediaPlaybackVetoes=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalClient=function(e,t,r,n,a,o,s){return new i.Local(t,e,r,n,!1,!1,a,o,s)};var i=r(317)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Local=void 0;var n=i(r(6)),a=i(r(1)),o=i(r(2)),s=r(24),l=r(17),c=r(65),u=r(75),d=r(159),h=r(318),f=r(164),m=r(319),p=(0,o.default)((function e(t,r,i,n,o,s,c,u,d){var h=this;(0,a.default)(this,e),this.onTimeUpdateForEndTime=function(){void 0!==h.player&&void 0!==h.endTime&&h.player.currentTime>=h.endTime&&(h.player.pause(),h.endTime=void 0,h.player.removeEventListener("timeupdate",h.onTimeUpdateForEndTime),h.player.removeEventListener("pause",h.onPauseForEndTime))},this.onPauseForEndTime=function(){void 0!==h.player&&(h.endTime=void 0,h.player.removeEventListener("pause",h.onPauseForEndTime))},this.isDesignerElement=i,this.mediaProperties=n,this.player=this.createLocalPlayer(t,r,i,n.mediaType,o,s,d),void 0!==c?(this.eventHandler=new m.LocalMediaEventHandler(this.player,this.mediaProperties.trimEndSec>0,c,u),c.setTimeOfCreation()):l.Log.info(507573786,"Local: playbackTracker is undefined")}),[{key:"play",value:function(){return(0,s.__awaiter)(this,void 0,void 0,n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.player.play();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),l.Log.error(541882e3,"Local.play: Failed to play local video. ".concat(e.t0 instanceof DOMException?e.t0.name:""," ").concat(e.t0 instanceof DOMException?e.t0.message:""));case 8:l.Log.info(520378572,"Local.play: this.player.paused: ".concat(this.player.paused));case 9:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"pause",value:function(){this.player.pause()}},{key:"setVisible",value:function(){this.isDesignerElement&&(this.player.loop=!0),this.player.style.visibility="visible",this.setFocus()}},{key:"setHidden",value:function(){this.isDesignerElement&&(this.player.loop=!1,this.player.autoplay=!1),this.player.style.pointerEvents="none",this.player.style.visibility="hidden"}},{key:"stop",value:function(){this.player.pause(),this.player.currentTime=0}},{key:"togglePause",value:function(){return(0,s.__awaiter)(this,void 0,void 0,n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.Log.info(520378573,"Local.togglePause: Before toggle, this.player.paused: ".concat(this.player.paused)),this.player.paused){e.next=5;break}this.pause(),e.next=13;break;case 5:return e.prev=5,e.next=8,this.play();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),l.Log.info(541882001,"Error local video play while toggle pause");case 13:l.Log.info(520378574,"Local.togglePause: After toggle, this.player.paused: ".concat(this.player.paused));case 14:case"end":return e.stop()}}),e,this,[[5,10]])})))}},{key:"isPaused",value:function(){return this.player.paused}},{key:"getPlayer",value:function(){return this.player}},{key:"setSource",value:function(e){this.player.src=e}},{key:"getCurrentTime",value:function(){return this.player.currentTime}},{key:"setEndTime",value:function(e){this.endTime=e,this.player.addEventListener("timeupdate",this.onTimeUpdateForEndTime),this.player.addEventListener("pause",this.onPauseForEndTime)}},{key:"clearEndTime",value:function(){this.pause(),this.endTime=void 0,this.player.removeEventListener("timeupdate",this.onTimeUpdateForEndTime),this.player.removeEventListener("pause",this.onPauseForEndTime)}},{key:"getDuration",value:function(){return this.player.duration}},{key:"seekTo",value:function(e){this.player.currentTime=e}},{key:"ensureMediaClient",value:function(){}},{key:"cleanUpMediaClient",value:function(){void 0!==this.eventHandler&&void 0!==this.eventHandler.cleanup&&this.eventHandler.cleanup()}},{key:"setMute",value:function(){this.player.muted=!0}},{key:"setUnMute",value:function(){this.player.muted=!1}},{key:"isMuted",value:function(){return this.player.muted}},{key:"setVolume",value:function(e){this.player.volume=e}},{key:"getVolume",value:function(){return this.player.volume}},{key:"getPlaybackData",value:function(){if(void 0!==this.eventHandler&&void 0!==this.eventHandler.getPlaybackData)return this.eventHandler.getPlaybackData()}},{key:"updateTrackList",value:function(e){this.removeCaptionsTracks(this.player),this.createCaptionsTracks(this.player,e)}},{key:"setFocus",value:function(){void 0!==this.player&&this.player.focus()}},{key:"seekToTrimStartIfNeeded",value:function(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&(this.player.currentTime<this.mediaProperties.trimStartSec||this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec)&&void 0===this.endTime&&(this.player.currentTime=this.mediaProperties.trimStartSec)}},{key:"onTimeUpdate",value:function(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec&&void 0===this.endTime&&this.player.pause()}},{key:"isTrimValid",value:function(){return void 0!==this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimEndSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec+this.mediaProperties.trimEndSec<this.mediaProperties.durationSec}},{key:"setTrim",value:function(e){var t=this;void 0===e||isNaN(e.duration)||(this.mediaProperties.durationSec=e.duration,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec-this.mediaProperties.trimEndSec,this.isTrimValid()?(e.addEventListener("timeupdate",(function(){t.onTimeUpdate()})),e.addEventListener("play",(function(){t.seekToTrimStartIfNeeded()}))):(this.mediaProperties.trimStartSec=0,this.mediaProperties.trimEndSec=0,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec))}},{key:"removeCaptionsTracks",value:function(e){for(var t=e.getElementsByTagName("track"),r=t.length-1;r>=0;r--)t[r].remove()}},{key:"createCaptionsTracks",value:function(e,t){t.forEach((function(t){var r,i=document.createElement("track"),n=t.lang&&""!==t.lang?t.lang:"unknown";i.setAttribute("kind","captions"),i.setAttribute("label",null!==(r=t.label)&&void 0!==r?r:""),i.setAttribute("src",decodeURIComponent(t.src)),i.setAttribute("srclang",n),i.setAttribute("id",t.name),e.appendChild(i)}))}},{key:"createLocalPlayer",value:function(e,t,r,i,n,a,o){var s=this,l=i===d.MediaType.Audio?document.createElement("audio"):document.createElement("video");return void 0!==e&&e.appendChild(l),l.style.visibility=r||n||a?"hidden":"visible",l.style.pointerEvents=n||a?"none":"all",this.setProperties(l),void 0!==this.mediaProperties.attributes?(0,f.setAttributes)(l,this.mediaProperties.attributes):(0,h.setDefaultAttributes)(l),void 0!==this.mediaProperties.styles?(0,u.setStyles)(l,this.mediaProperties.styles):(0,c.setDefaultStyles)(l),r?(l.loop=!0,l.muted=!0,l.addEventListener("canplay",(function(){l.style.visibility="visible"}),{once:!0})):this.setFocus(),(this.mediaProperties.trimStartSec>0||this.mediaProperties.trimEndSec>0)&&l.addEventListener("loadedmetadata",(function(){s.setTrim(l)}),{once:!0}),null!=o&&this.createCaptionsTracks(l,o),l.src=t,l}},{key:"setProperties",value:function(e){e.autoplay=void 0===this.mediaProperties.autoPlay||this.mediaProperties.autoPlay,e.controls=void 0===this.mediaProperties.controls||this.mediaProperties.controls,void 0!==this.mediaProperties.elementId&&(e.id=this.mediaProperties.elementId),void 0!==this.mediaProperties.crossOrigin&&(e.crossOrigin=this.mediaProperties.crossOrigin),void 0!==this.mediaProperties.zIndex&&(e.style.zIndex=this.mediaProperties.zIndex),void 0!==this.mediaProperties.preload&&(e.preload=this.mediaProperties.preload),e instanceof HTMLVideoElement&&(void 0!==this.mediaProperties.playsInline&&(e.playsInline=this.mediaProperties.playsInline),void 0!==this.mediaProperties.width&&(e.width=this.mediaProperties.width),void 0!==this.mediaProperties.height&&(e.height=this.mediaProperties.height))}}]);t.Local=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultAttributes=function(e){(0,i.setAttributes)(e,{disablePictureInPicture:"true",controlsList:"nodownload nofullscreen noremoteplayback"})};var i=r(164)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaEventHandler=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t,r,i,a){(0,n.default)(this,e),this.player=t,this.playbackTracker=i,this.onMediaEventCallback=a,this.playbackTracker.setIsMuted(this.player.muted),this.playbackTracker.setVolume(this.player.volume),this.registerEventListeners(r)}),[{key:"registerEventListeners",value:function(e){var t=this;this.player.addEventListener("loadstart",(function(){t.playbackTracker.onLoadStart(),t.sendEvent(0)})),this.player.addEventListener("loadedmetadata",(function(){t.playbackTracker.onLoadedMetadata(),t.playbackTracker.setDuration(Math.round(1e3*t.player.duration)),t.player instanceof HTMLVideoElement&&t.playbackTracker.setSrcDimensions(t.player.videoWidth,t.player.videoHeight),t.sendEvent(1)})),this.player.addEventListener("loadeddata",(function(){t.sendEvent(2)})),this.player.addEventListener("canplay",(function(){t.playbackTracker.onCanPlay(),t.sendEvent(3)})),this.player.addEventListener("canplaythrough",(function(){t.playbackTracker.onCanPlayThrough()})),this.player.addEventListener("play",(function(){t.playbackTracker.onPlay(),t.sendEvent(4)})),this.player.addEventListener("playing",(function(){t.playbackTracker.onPlaying(),t.sendEvent(5)})),this.player.addEventListener("pause",(function(){t.playbackTracker.onPause(),t.sendEvent(6)})),this.player.addEventListener("seeked",(function(){t.sendEvent(7)})),this.player.addEventListener("seeking",(function(){t.sendEvent(8)})),e&&this.player.addEventListener("timeupdate",(function(){t.sendEvent(9)})),this.player.addEventListener("volumechange",(function(){t.playbackTracker.onVolumeChanged(t.player.volume),t.playbackTracker.setIsMuted(t.player.muted),t.sendEvent(10)})),this.player.addEventListener("stalled",(function(){t.playbackTracker.onStalled(),t.sendEvent(8)})),this.player.addEventListener("ended",(function(){t.playbackTracker.onEnded(),t.sendEvent(11)})),this.player.addEventListener("error",(function(){var e="Local media error.".concat(t.player.error?" Code: ".concat(t.player.error.code,", message: ").concat(t.player.error.message):"");t.playbackTracker.onError(e),t.sendEvent(12)}))}},{key:"getPlaybackData",value:function(){return this.playbackTracker.getPlaybackData()}},{key:"cleanup",value:function(){this.playbackTracker.cleanup()}},{key:"sendEvent",value:function(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}}]);t.LocalMediaEventHandler=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineVideoPlayer=void 0;var n=i(r(1)),a=i(r(2)),o=r(321),s=r(165),l=r(338),c=r(339),u=r(17),d=r(340),h=(0,a.default)((function e(t,r,i,a,s,u,h,f,m,p,g,v){var y,_=this;(0,n.default)(this,e),this.url=t,this.parent=r,this.appSettings=i,this.mediaSizeInfo=a,this.playbackTracker=new d.OnlineMediaPlaybackTracker(i,void 0,g,p),this.onReadyCallback=u,this.onMediaEventCallback=h,this.onTokenRequestCallback=f,void 0!==s&&(this.poster=new l.OnlineVideoPoster(s,r,(function(){_.playMedia(),void 0!==m&&m()}),v)),this.onReadyCallback=function(){var e;null===(e=_.controller)||void 0===e||e.onReady(),void 0!==u&&u()};try{this.client=(0,o.createOnlineClient)(this.url,this.parent,this.appSettings,this.mediaSizeInfo,this.playbackTracker,this.onReadyCallback,this.onMediaEventCallback,this.onTokenRequestCallback),void 0!==this.poster&&this.poster.isVisible&&(null===(y=this.client)||void 0===y||y.setHidden()),this.controller=new c.OnlineVideoController(this.client,this.playbackTracker)}catch(e){this.playbackTracker.onError("Error creating online video client: ".concat(e.message),!0)}}),[{key:"playMedia",value:function(){var e;void 0!==this.poster&&this.poster.isVisible&&this.hidePoster(),null===(e=this.controller)||void 0===e||e.play()}},{key:"pauseMedia",value:function(){var e;null===(e=this.controller)||void 0===e||e.pause()}},{key:"seekMedia",value:function(e){var t;null===(t=this.controller)||void 0===t||t.seekTo(e)}},{key:"stopMedia",value:function(){var e;null===(e=this.controller)||void 0===e||e.stop()}},{key:"togglePauseMedia",value:function(){var e;null===(e=this.controller)||void 0===e||e.togglePlayPause()}},{key:"isPaused",value:function(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}},{key:"setMute",value:function(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}},{key:"setUnMute",value:function(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}},{key:"isMuted",value:function(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}},{key:"setVolume",value:function(e){void 0!==this.client&&void 0!==this.client.setVolume&&this.client.setVolume(e)}},{key:"getVolume",value:function(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}},{key:"getPlaybackData",value:function(){if(void 0!==this.client&&void 0!==this.client.getPlaybackData)return this.client.getPlaybackData()}},{key:"getCurrentTime",value:function(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}},{key:"getDuration",value:function(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}},{key:"ensure",value:function(){void 0!==this.client&&void 0!==this.client.ensureMediaClient&&this.client.ensureMediaClient(),this.showPoster()}},{key:"postAuthToken",value:function(e){void 0!==this.client&&void 0!==this.client.postAuthToken&&this.client.postAuthToken(e)}},{key:"cleanup",value:function(){var e;this.hidePoster(),void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient(),null===(e=this.controller)||void 0===e||e.cleanup()}},{key:"showPoster",value:function(){var e;void 0!==this.poster&&(u.Log.info(508691866,"Showing poster frame (correlationId: ".concat(this.playbackTracker.getCorrelationId(),")")),this.poster.show(),null===(e=this.client)||void 0===e||e.setHidden())}},{key:"hidePoster",value:function(){var e;void 0!==this.poster&&(u.Log.info(508691865,"Hiding poster frame (correlationId: ".concat(this.playbackTracker.getCorrelationId(),")")),this.poster.hide(),null===(e=this.client)||void 0===e||e.setVisible())}},{key:"setUiHostType",value:function(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}},{key:"setFlights",value:function(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}}],[{key:"setAADToken",value:function(e){s.Stream2.setAADTokenForWaitingClients(e)}}]);t.OnlineVideoPlayer=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOnlineClient=function(e,t,r,d,h,f,m,p){if(!function(e){try{return void 0!==new URL(e)}catch(e){return!1}}(e))throw new Error("Attempted to create an online video client with an invalid URL");if("https:"!==new URL(e).protocol)throw new Error("Attempted to create an online video client with an unsafe URL");null==h||h.setTimeOfCreation();var g=(0,n.getProviderName)(e);return!0===r.IsStream2Enabled&&void 0===g&&(g="Stream2"),void 0!==h&&void 0!==g&&h.setProviderName(g),"YouTube"===g?new u.YouTube(e,t,h,d,f,m,r):"Vimeo"===g?new c.Vimeo(e,t,h,f,m):"Flip"===g?new o.Flip(e,t,h,f,m):"StreamClassic"===g?new s.StreamClassic(e,t,r,h,f,m,p):"Ted"===g||"SlideShare"===g?new a.Default(e,t,h):"Stream2"===g?new l.Stream2(e,t,r,h,f,m,p):(i.Log.warn(512271066,"Creating Default client for unidentified provider URL"),new a.Default(e,t,h))};var i=r(17),n=r(115),a=r(326),o=r(327),s=r(328),l=r(165),c=r(333),u=r(337)},function(e,t,r){var i=r(8),n=r(102),a=r(323),o=r(324);function s(t){var r="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!a(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return o(e,arguments,i(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n(t,e)},s(t)}e.exports=s},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,r){var i=r(102),n=r(325);function a(t,r,o){return n()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&i(a,r.prototype),a},a.apply(null,arguments)}e.exports=a},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Default=void 0;var n=i(r(1)),a=i(r(2)),o=r(65),s=(0,a.default)((function e(t,r,i){var a,s=this;(0,n.default)(this,e),this.url=t,this.iFrame=document.createElement("iframe"),this.playbackTracker=i,this.iFrame.src=t,this.iFrame.setAttribute("frameBorder","0"),this.iFrame.setAttribute("allow","autoplay"),(0,o.setDefaultStyles)(this.iFrame),null===(a=this.playbackTracker)||void 0===a||a.onSourceSet(),this.iFrame.addEventListener("load",(function(){null!==s.iFrame.contentWindow&&s.iFrame.contentWindow.focus()})),r.appendChild(this.iFrame)}),[{key:"play",value:function(){""===this.iFrame.src&&(this.iFrame.src=this.url),this.setFocus()}},{key:"pause",value:function(){}},{key:"stop",value:function(){this.iFrame.src=""}},{key:"togglePause",value:function(){}},{key:"setVisible",value:function(){this.iFrame.style.visibility="visible"}},{key:"setHidden",value:function(){this.iFrame.style.visibility="hidden"}},{key:"getPlayer",value:function(){return this.iFrame}},{key:"getCurrentTime",value:function(){}},{key:"getDuration",value:function(){}},{key:"getPlaybackData",value:function(){return void 0!==this.playbackTracker?this.playbackTracker.getPlaybackData():void 0}},{key:"seekTo",value:function(e){}},{key:"ensureMediaClient",value:function(){var e,t;null===(e=this.playbackTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet()}},{key:"cleanUpMediaClient",value:function(){var e;null===(e=this.playbackTracker)||void 0===e||e.cleanup()}},{key:"setFocus",value:function(){null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}}]);t.Default=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Flip=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=r(65),l=(0,a.default)((function e(t,r,i,a,o){var s=this;(0,n.default)(this,e),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.onMessage=function(e){e.origin===s.url.origin&&void 0!==s.flipIFrame&&s.flipIFrame.contentWindow===e.source&&(s.handlePlayerEvent(e),void 0!==s.playbackTracker&&s.capturePlaybackTelemetry(e))},this.url=new URL(t),this.parent=r,this.playbackTracker=i,this.onReadyCallback=a,this.onMediaEventCallback=o,this.url.searchParams.set("options","messaging");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Flip video client: ".concat(e.message),!0)}}),[{key:"play",value:function(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){var e=this.getMessage("fg-wvp-play",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}},{key:"pause",value:function(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){var e=this.getMessage("fg-wvp-pause",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}},{key:"stop",value:function(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){var e=this.getMessage("fg-wvp-stop",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}},{key:"togglePause",value:function(){this.paused?this.play():this.pause()}},{key:"setVisible",value:function(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="visible")}},{key:"setHidden",value:function(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="hidden")}},{key:"getPlayer",value:function(){return this.flipIFrame}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.duration}},{key:"seekTo",value:function(e){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){var t=this.getMessage("fg-wvp-seek",{time:e});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}}},{key:"ensureMediaClient",value:function(){this.cleanUpMediaClient(),this.init()}},{key:"isPaused",value:function(){return this.paused}},{key:"cleanUpMediaClient",value:function(){void 0!==this.flipIFrame&&this.flipIFrame.remove(),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.flipIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"init",value:function(){var e;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.flipIFrame=document.createElement("iframe"),this.flipIFrame.src=this.url.toString(),this.setProperties(this.flipIFrame),this.parent.append(this.flipIFrame),window.addEventListener("message",this.onMessage)}},{key:"setProperties",value:function(e){null!==e&&(e.setAttribute("allow","autoplay"),(0,s.setDefaultStyles)(e),e.style.border="0px",this.setVisible())}},{key:"handlePlayerEvent",value:function(e){switch(e.data.name){case"fg-wvp-onReady":case"fg-wvp-onInitialReady":if(this.isFirstReady){if(this.isFirstReady=!1,void 0===this.duration&&void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){var t=this.getMessage("fg-wvp-getDuration",{});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}void 0!==this.onReadyCallback&&this.onReadyCallback()}break;case"fg-wvp-onPlay":this.paused=!1,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1);break;case"fg-wvp-onPause":this.paused=!0,(void 0===this.duration||this.currentTime<this.duration)&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0);break;case"fg-wvp-onSeek":void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"fg-wvp-onTimeUpdate":this.currentTime=e.data.data.currentTime;break;case"fg-wvp-onBuffering":break;case"fg-wvp-onEnded":this.paused=!0,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6);break;case"fg-wvp-onError":o.Log.error(508895832,"Flipgrid player entered error state ".concat(e.data.data.error));break;case"fg-wvp-getDurationResult":this.duration=e.data.data.duration;break;case"fg-wvp-getCurrentTimeResult":this.currentTime=e.data.data.currentTime}}},{key:"capturePlaybackTelemetry",value:function(e){var t=e.data.name;if(void 0!==this.playbackTracker)switch(t){case"fg-wvp-onReady":this.playbackTracker.onCanPlay(),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.playbackTracker.onPlaying();break;case"fg-wvp-onPause":this.playbackTracker.onPause();break;case"fg-wvp-onSeek":break;case"fg-wvp-onEnded":this.playbackTracker.onEnded();break;case"fg-wvp-onError":var r="Flipgrid player entered error state ".concat(e.data.data.error);this.playbackTracker.onError(r,!0)}}},{key:"getMessage",value:function(e,t){return{name:e,data:t}}}]);t.Flip=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.StreamClassic=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=r(65),l=(0,a.default)((function e(t,r,i,a,s,l,c){var u=this;(0,n.default)(this,e),this.paused=!0,this.currentTime=0,this.streamAuthFailed=!1,this.onMessage=function(e){var t,r,i,n;if(u.url.origin===e.origin&&void 0!==u.streamIFrame&&u.streamIFrame.contentWindow===e.source)switch(e.data.name){case"initializestreamconnection":o.Log.info(508895829,"StreamAuth: Received handshake request");var a=!1;if(void 0!==u.streamIFrame){var s=u.streamIFrame.contentWindow;if(null!==s){var l=e.data;l.result=!0,s.postMessage(l,e.origin),a=!0}}a||o.Log.info(508895828,"StreamAuth: Received handshake request, but unable to reply");break;case"getstreamtoken":u.handleTokenRequest(e);break;case"signinevent":u.streamAuthFailed||"signinfailed"===(null===(t=e.data.eventData)||void 0===t?void 0:t.eventname)&&(null===(r=u.playbackTracker)||void 0===r||r.onError("Authentication Error - User failed to authenticate",!0),u.streamAuthFailed=!0);break;case"loaddata":var c=null===(i=e.data.eventData)||void 0===i?void 0:i.responsecode;"200"!==c&&(null===(n=u.playbackTracker)||void 0===n||n.onError("Load Error - Video responded with status code ".concat(c),!0));break;case"playerevent":u.handlePlayerEvent(e),u.trackPlaybackTelemetry(e)}},this.url=new URL(t),this.parent=r,this.playbackTracker=a,this.onReadyCallback=s,this.onMediaEventCallback=l,this.onTokenRequestCallback=c,void 0!==i.App&&this.url.searchParams.set("app",i.App),void 0!==i.AppPlatform&&this.url.searchParams.set("appPlatform",i.AppPlatform),void 0!==i.AppCorrelation&&this.url.searchParams.set("appCorrelation",i.AppCorrelation),this.url.searchParams.set("thinEmbed","true");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream Classic video client: ".concat(e.message),!0)}}),[{key:"play",value:function(){var e=this.getMessage("playerfunction","play");this.sendMessage(e)}},{key:"pause",value:function(){var e=this.getMessage("playerfunction","pause");this.sendMessage(e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0)}},{key:"togglePause",value:function(){this.paused?this.play():this.pause()}},{key:"getPlayer",value:function(){return this.streamIFrame}},{key:"isPaused",value:function(){return this.paused}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){}},{key:"seekTo",value:function(e){var t=this.getMessage("playerfunction","setplaytime",e.toString());this.sendMessage(t)}},{key:"setVisible",value:function(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="visible")}},{key:"setHidden",value:function(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="hidden")}},{key:"ensureMediaClient",value:function(){this.cleanUpMediaClient(),this.init()}},{key:"cleanUpMediaClient",value:function(){void 0!==this.streamIFrame&&this.streamIFrame.remove(),this.paused=!0,this.currentTime=0,this.streamIFrame=void 0,this.streamAuthFailed=!1,window.removeEventListener("message",this.onMessage),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"postAuthToken",value:function(e){if(void 0!==this.streamIFrame){var t=this.streamIFrame.contentWindow;null!==t&&void 0!==this.streamAuthContext?(void 0===this.streamAuthContext.messageObj.eventData&&(this.streamAuthContext.messageObj.eventData={}),this.streamAuthContext.messageObj.eventData.token=e,this.streamAuthContext.messageObj.result=!0,t.postMessage(this.streamAuthContext.messageObj,this.streamAuthContext.origin),o.Log.info(508895831,"StreamAuth: Posted Aad Token back to Stream Player")):o.Log.error(508895830,"StreamAuth: Got a Stream iframe but unable to get ContentWindow or cached Context")}}},{key:"init",value:function(){var e;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.streamIFrame=document.createElement("iframe"),this.streamIFrame.src=this.url.toString(),this.setProperties(this.streamIFrame),this.parent.append(this.streamIFrame),window.addEventListener("message",this.onMessage)}},{key:"setProperties",value:function(e){null!==e&&(e.setAttribute("allow","autoplay"),(0,s.setDefaultStyles)(e),e.style.border="0px",this.setVisible())}},{key:"handleTokenRequest",value:function(e){var t,r;if(!this.streamAuthFailed){if(void 0===this.onTokenRequestCallback)return this.streamAuthFailed=!0,void(null===(t=this.playbackTracker)||void 0===t||t.onError("Authentication Error - onTokenRequestCallback is undefined",!0));o.Log.info(508895827,"StreamAuth: Requesting AAD token from Host");var i=e.data,n=e.origin;this.streamAuthContext={messageObj:i,origin:n},this.onTokenRequestCallback(null===(r=i.eventData)||void 0===r?void 0:r.resourceId)}}},{key:"handlePlayerEvent",value:function(e){var t,r,i,n,a=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname;if(void 0!==this.onMediaEventCallback){switch(a){case"play":this.onMediaEventCallback(1);break;case"playing":this.paused=!1,this.onMediaEventCallback(1);break;case"pause":this.paused=!0,this.onMediaEventCallback(0);break;case"ready":void 0!==this.onReadyCallback&&this.onReadyCallback();break;case"timeupdate":var s=this.currentTime;this.currentTime=null===(r=e.data.eventData)||void 0===r?void 0:r.time,void 0!==this.currentTime&&Math.abs(this.currentTime-s)>=1&&this.onMediaEventCallback(3);break;case"error":o.Log.error(538039177,"Stream media error: ".concat(null===(i=e.data.eventData)||void 0===i?void 0:i.errorcode,", message: ").concat(null===(n=e.data.eventData)||void 0===n?void 0:n.message))}o.Log.info(508895824,"Stream Media Event: ".concat(a))}}},{key:"trackPlaybackTelemetry",value:function(e){var t,r;if(void 0!==this.playbackTracker){var i=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,n=null===(r=e.data.eventData)||void 0===r?void 0:r.message;switch(i){case"play":this.playbackTracker.onPlay();break;case"playing":this.playbackTracker.onPlaying();break;case"pause":this.playbackTracker.onPause();break;case"ready":this.playbackTracker.onCanPlay();break;case"error":void 0!==n&&this.playbackTracker.onError(n,!0)}}}},{key:"getMessage",value:function(e,t,r){return void 0!==r?{name:e,methodData:{methodname:t,data:r},eventData:{}}:{name:e,methodData:{methodname:t},eventData:{}}}},{key:"sendMessage",value:function(e){void 0!==this.streamIFrame&&null!==this.streamIFrame.contentWindow&&(o.Log.info(528623694,"sendMessage: Calling postMessage with: msg = ".concat(JSON.stringify(e),", target = ").concat(this.streamIFrame.src)),this.streamIFrame.contentWindow.postMessage(e,this.streamIFrame.src))}}]);t.StreamClassic=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequestor=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=r(166),l=r(330),c=r(331),u=r(332);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var f=(0,a.default)((function e(){(0,n.default)(this,e),this.cache=new l.TokenCache,this.clients=new c.TokenRequestorClients,this.requestWithRetry=new u.TokenRequestWithRetries}),[{key:"updateSettings",value:function(e,t){this.cache.updateSettings(e),this.requestWithRetry.updateSettings(e,t)}},{key:"request",value:function(e,t){var r=this.cache.find(e);void 0===r?(this.clients.add(e,t),this.requestWithRetry.isPending||this.requestWithRetry.start(e)):t.onTokenSet(e,r)}},{key:"cancelAllIfPending",value:function(e){var t,r=d(s.AppId.all);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.cancelIfPending(i,e)}}catch(e){r.e(e)}finally{r.f()}this.requestWithRetry.isPending||this.startPendingRequest()}},{key:"setAADToken",value:function(e){var t=this.requestWithRetry.currentAppId;if(void 0!==t)if(0!==e.length){this.cache.update(t,e),this.requestWithRetry.completeOrCancel(e.length);var r,i=d(this.clients.getClients(t));try{for(i.s();!(r=i.n()).done;)r.value.onTokenSet(t,e)}catch(e){i.e(e)}finally{i.f()}this.startPendingRequest()}else o.Log.error(509171016,"Error: Got empty token");else o.Log.error(509166815,"Error: AppId is not set")}},{key:"startPendingRequest",value:function(){var e=this.clients.getPendingAppId();void 0!==e&&this.requestWithRetry.start(e)}},{key:"cancelIfPending",value:function(e,t){this.clients.has(e,t)&&this.clients.remove(e,t)&&e===this.requestWithRetry.currentAppId&&this.requestWithRetry.completeOrCancel(void 0)}}]);t.TokenRequestor=f},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TokenCache=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(17),l=(0,o.default)((function e(){(0,a.default)(this,e),this.cache=new Map,this.timeValid=33e5}),[{key:"timeout",get:function(){return this.timeValid}},{key:"updateSettings",value:function(e){void 0!==e.TokenCacheTimeout?this.timeValid=e.TokenCacheTimeout:this.timeValid=33e5}},{key:"update",value:function(e,t){0!==t.length?this.cache.set(e,[Date.now(),t]):s.Log.error(509167387,"Error: Empty token")}},{key:"find",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e),r=(0,n.default)(t,2),i=r[0],a=r[1];if(!(Date.now()>i+this.timeValid))return a}}}]);t.TokenCache=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequestorClients=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(17);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var c=(0,o.default)((function e(){(0,a.default)(this,e),this.clients=new Map}),[{key:"add",value:function(e,t){var r=this.clients.get(e);void 0!==r?r.has(t)?s.Log.error(509171084,"Error: Client already exists"):r.add(t):this.clients.set(e,new Set([t]))}},{key:"has",value:function(e,t){var r=this.clients.get(e);return void 0!==r&&r.has(t)}},{key:"remove",value:function(e,t){var r=this.clients.get(e);return void 0===r?(s.Log.error(509171083,"Error: AppId does not exist"),!1):r.delete(t)?0===r.size:(s.Log.error(509171082,"Error: Client does not exist"),!1)}},{key:"getClients",value:function(e){var t=this.clients.get(e);if(void 0===t)return s.Log.error(509171081,"Error: AppId does not exist"),[];if(0===t.size)return s.Log.error(509171080,"Error: Clients do not exist"),[];var r=Array.from(t);return t.clear(),r}},{key:"getPendingAppId",value:function(){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this.clients);try{for(t.s();!(e=t.n()).done;){var r=(0,n.default)(e.value,2),i=r[0];if(0!==r[1].size)return i}}catch(e){t.e(e)}finally{t.f()}}}]);t.TokenRequestorClients=c},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequestWithRetries=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=(0,a.default)((function e(){(0,n.default)(this,e),this.waitBeforeRetry=3e3,this.maxRetries=3,this.startTime=0,this.retries=0}),[{key:"timeout",get:function(){return this.waitBeforeRetry}},{key:"maxRetryCount",get:function(){return this.maxRetries}},{key:"elapsedTime",get:function(){return Date.now()-this.startTime}},{key:"numberOfRetries",get:function(){return this.retries}},{key:"willRetry",get:function(){return this.numberOfRetries<=this.maxRetryCount}},{key:"currentAppId",get:function(){return this.appId}},{key:"isPending",get:function(){return void 0!==this.tokenRequestTimeout}},{key:"updateSettings",value:function(e,t){void 0!==e.MaxAADTokenWaitingTime?this.waitBeforeRetry=e.MaxAADTokenWaitingTime:this.waitBeforeRetry=3e3,void 0!==e.MaxAADTokenRequestRetries?this.maxRetries=e.MaxAADTokenRequestRetries:this.maxRetries=3,void 0!==t?this.tokenRequestCallback=t:o.Log.error(509166869,"Error: No token request callback")}},{key:"start",value:function(e){void 0!==this.tokenRequestCallback?void 0===this.currentAppId?this.isPending?o.Log.error(509171090,"Error: Request is already pending"):(this.startTime=Date.now(),this.retries=0,this.appId=e,this.tryRequest()):o.Log.error(509166861,"Error: AppId already set"):o.Log.error(509166818,"Error: No token request callback")}},{key:"completeOrCancel",value:function(e){if(void 0!==this.currentAppId)if(this.isPending){clearTimeout(this.tokenRequestTimeout),this.tokenRequestTimeout=void 0;var t={tokenLength:e,isCompleted:void 0!==e,tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};o.Log.info(509194645,JSON.stringify(t)),this.appId=void 0}else o.Log.error(509171089,"Error: Request is not pending");else o.Log.error(509166860,"Error: AppId is not set")}},{key:"tryRequest",value:function(){var e=this;if(void 0!==this.tokenRequestCallback)if(void 0!==this.currentAppId)if(this.isPending)o.Log.error(509171086,"Error: Request is already pending");else if(this.willRetry){var t={tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};o.Log.info(509166817,JSON.stringify(t)),this.tokenRequestTimeout=window.setTimeout((function(){e.tokenRequestTimeout=void 0,e.retries+=1,e.tryRequest()}),this.timeout),this.tokenRequestCallback(this.currentAppId.guid)}else o.Log.error(508700001,"Error: Request will not be retried");else o.Log.error(509171087,"Error: AppId is not set");else o.Log.error(509171088,"Error: No token request callback")}}]);t.TokenRequestWithRetries=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Vimeo=void 0;var n=i(r(6)),a=i(r(1)),o=i(r(2)),s=r(24),l=i(r(334)),c=r(17),u=r(65),d=(0,o.default)((function e(t,r,i,n,o){(0,a.default)(this,e),this.url=t,this.parent=r,this.playbackTracker=i,this.onReadyCallback=n,this.onMediaEventCallback=o;try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Vimeo video client: ".concat(e.message),!0)}}),[{key:"play",value:function(){void 0!==this.player&&this.player.play().catch((function(e){c.Log.error(508572036,"Vimeo error while playing video (error: ".concat(e.message,")"))}))}},{key:"pause",value:function(){void 0!==this.player&&this.player.pause().catch((function(e){c.Log.error(508572035,"Vimeo error while pausing video (error: ".concat(e.message,")"))}))}},{key:"stop",value:function(){void 0!==this.player&&(this.pause(),this.seekTo(0))}},{key:"togglePause",value:function(){void 0!==this.player&&void 0!==this.paused&&(this.paused?this.play():this.pause())}},{key:"setVisible",value:function(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="visible"),void 0!==this.backDrop&&(this.backDrop.style.visibility="visible")}},{key:"setHidden",value:function(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="hidden"),void 0!==this.backDrop&&(this.backDrop.style.visibility="hidden")}},{key:"getPlayer",value:function(){return this.vimeoIframe}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.duration}},{key:"isPaused",value:function(){return this.paused}},{key:"seekTo",value:function(e){void 0!==this.player&&this.player.setCurrentTime(e).catch((function(e){c.Log.error(508572034,"Vimeo error while setting current time (error: ".concat(e.message,")"))}))}},{key:"setVolume",value:function(e){void 0!==this.player&&this.player.setVolume(e).catch((function(e){c.Log.error(508572033,"Vimeo error while setting video volume (error: ".concat(e.message,")"))}))}},{key:"setMute",value:function(){void 0!==this.player&&this.player.setMuted(!0).catch((function(e){c.Log.error(508572032,"Vimeo error while setting muted true (error: ".concat(e.message,")"))}))}},{key:"setUnMute",value:function(){if(void 0!==this.player){if(0===this.volume){var e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.25))}this.player.setMuted(!1).catch((function(e){c.Log.error(508572003,"Vimeo error while setting muted false (error: ".concat(e.message,")"))}))}}},{key:"getVolume",value:function(){return this.volume}},{key:"isMuted",value:function(){return this.muted}},{key:"ensureMediaClient",value:function(){this.cleanUpMediaClient(),this.init()}},{key:"cleanUpMediaClient",value:function(){void 0!==this.vimeoIframe&&this.vimeoIframe.remove(),void 0!==this.backDrop&&this.backDrop.remove(),this.paused=void 0,this.player=void 0,this.currentTime=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.muted=void 0,this.vimeoIframe=void 0,this.backDrop=void 0,void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"init",value:function(){var e,t=this;null===(e=this.playbackTracker)||void 0===e||e.onSourceSet(),this.backDrop=document.createElement("div"),this.backDrop.style.backgroundColor="black",this.setProperties(this.backDrop),this.parent.append(this.backDrop),this.vimeoIframe=document.createElement("iframe"),this.vimeoIframe.src=this.url,this.vimeoIframe.setAttribute("allow","autoplay"),this.setProperties(this.vimeoIframe),this.parent.append(this.vimeoIframe),this.player=new l.default(this.vimeoIframe,{controls:!0,responsive:!1}),this.player.ready().then((function(){return(0,s.__awaiter)(t,void 0,void 0,n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.player){e.next=2;break}return e.abrupt("return");case 2:return this.registerOnStateChange(),e.prev=3,e.next=6,this.player.getPaused();case 6:return this.paused=e.sent,e.next=9,this.player.getCurrentTime();case 9:return this.currentTime=e.sent,e.next=12,this.player.getDuration();case 12:return this.duration=e.sent,e.next=15,this.player.getVolume();case 15:return this.volume=e.sent,e.next=18,this.player.getMuted();case 18:this.muted=e.sent,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),c.Log.error(509354830,"Vimeo error while getting video info on player ready (error: ".concat(e.t0.message,")"));case 24:this.paused=!0,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),void 0!==this.volume&&this.playbackTracker.setVolume(this.volume),void 0!==this.muted&&this.playbackTracker.setIsMuted(this.muted),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration)),void 0!==this.onReadyCallback&&this.onReadyCallback(),void 0!==this.player.setAutopause&&this.player.setAutopause(!1).catch((function(e){c.Log.error(508572002,"Vimeo error while setting video autopause (error: ".concat(e.message,")"))}));case 29:case"end":return e.stop()}}),e,this,[[3,21]])})))})).catch((function(e){void 0!==t.playbackTracker&&t.playbackTracker.onError("Error loading Vimeo player (error: ".concat(e.message,")"),!0)}))}},{key:"registerOnStateChange",value:function(){var e=this;void 0!==this.player&&(this.player.on("play",(function(t){e.paused=!1,e.onStateChange(1,t.seconds),void 0!==e.playbackTracker&&e.playbackTracker.onPlay()})),this.player.on("pause",(function(t){e.paused=!0,Math.abs(t.seconds-t.duration)>.1&&e.onStateChange(0,t.seconds),void 0!==e.playbackTracker&&e.playbackTracker.onPause()})),this.player.on("seeked",(function(t){e.onStateChange(3,t.seconds)})),this.player.on("volumechange",(function(t){return(0,s.__awaiter)(e,void 0,void 0,n.default.mark((function e(){var r,i,a,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.volume,i=this.muted,this.volume=t.volume,void 0===this.player){e.next=7;break}return e.next=6,this.player.getMuted();case 6:this.muted=e.sent;case 7:0!==this.volume&&(this.lastNonZeroVolume=this.volume),a=r!==this.volume,o=i!==this.muted,(a||o)&&this.onStateChange(4),a&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),o&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted);case 13:case"end":return e.stop()}}),e,this)})))})),this.player.on("playing",(function(){void 0!==e.playbackTracker&&e.playbackTracker.onPlaying()})),this.player.on("ended",(function(t){e.paused=!0,e.onStateChange(6,t.seconds),void 0!==e.playbackTracker&&e.playbackTracker.onEnded()})),this.player.on("error",(function(t){if(void 0!==e.playbackTracker){var r="".concat(t.name," error raised by Vimeo player's \"").concat(t.method,'" method: (').concat(t.message,")");e.playbackTracker.onError(r)}})),this.player.on("timeupdate",(function(t){e.currentTime=t.seconds})))}},{key:"onStateChange",value:function(e,t){void 0!==t&&(this.currentTime=t),void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}},{key:"setProperties",value:function(e){null!==e&&((0,u.setDefaultStyles)(e),e.style.border="0px",this.setVisible())}}]);t.Vimeo=d},function(e,t,r){"use strict";(function(e,i){var n=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(15));function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=void 0!==e&&"[object global]"==={}.toString.call(e);function c(e,t){return 0===e.indexOf(t.toLowerCase())?e:"".concat(t.toLowerCase()).concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}function u(e){return Boolean(e&&1===e.nodeType&&"nodeName"in e&&e.ownerDocument&&e.ownerDocument.defaultView)}function d(e){return!isNaN(parseFloat(e))&&isFinite(e)&&Math.floor(e)==e}function h(e){return/^(https?:)?\/\/((player|www)\.)?vimeo\.com(?=$|\/)/.test(e)}function f(e){return/^https:\/\/player\.vimeo\.com\/video\/\d+/.test(e)}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.url,i=t||r;if(!i)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(d(i))return"https://vimeo.com/".concat(i);if(h(i))return i.replace("http:","https:");if(t)throw new TypeError("".concat(t," is not a valid video id."));throw new TypeError("".concat(i," is not a vimeo.com url."))}var p=void 0!==Array.prototype.indexOf,g="undefined"!=typeof window&&void 0!==window.postMessage;if(!(l||p&&g))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};!function(e){if(!e.WeakMap){var t=Object.prototype.hasOwnProperty,r=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),i=function(e,t,i){r?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:i}):e[t]=i};e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(i(this,"_id",o("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function r(e,r){if(!n(e)||!t.call(e,"_id"))throw new TypeError(r+" method called on incompatible receiver "+(0,a.default)(e))}function o(e){return e+"_"+s()+"."+s()}function s(){return Math.random().toString().substring(2)}return i(e.prototype,"delete",(function(e){if(r(this,"delete"),!n(e))return!1;var t=e[this._id];return!(!t||t[0]!==e||(delete e[this._id],0))})),i(e.prototype,"get",(function(e){if(r(this,"get"),n(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}})),i(e.prototype,"has",(function(e){if(r(this,"has"),!n(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)})),i(e.prototype,"set",(function(e,t){if(r(this,"set"),!n(e))throw new TypeError("Invalid value used as weak map key");var a=e[this._id];return a&&a[0]===e?(a[1]=t,this):(i(e,this._id,[e,t]),this)})),i(e,"_polyfill",!0),e}()}function n(e){return Object(e)===e}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:v);var y=function(e,t){return function(e){var t,r,n;n=function(){var e,t,r,n=Object.prototype.toString,o=void 0!==i?function(e){return i(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,t,r,i){return Object.defineProperty(e,t,{value:r,writable:!0,configurable:!1!==i})}}catch(t){e=function(e,t,r){return e[t]=r,e}}function s(e,i){r.add(e,i),t||(t=o(r.drain))}function l(e){var t,r=(0,a.default)(e);return null==e||"object"!=r&&"function"!=r||(t=e.then),"function"==typeof t&&t}function c(){for(var e=0;e<this.chain.length;e++)u(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function u(e,t,r){var i,n;try{!1===t?r.reject(e.msg):(i=!0===t?e.msg:t.call(void 0,e.msg))===r.promise?r.reject(TypeError("Promise-chain cycle")):(n=l(i))?n.call(i,r.resolve,r.reject):r.resolve(i)}catch(e){r.reject(e)}}function d(e){var t,r=this;if(!r.triggered){r.triggered=!0,r.def&&(r=r.def);try{(t=l(e))?s((function(){var i=new m(r);try{t.call(e,(function(){d.apply(i,arguments)}),(function(){h.apply(i,arguments)}))}catch(e){h.call(i,e)}})):(r.msg=e,r.state=1,r.chain.length>0&&s(c,r))}catch(e){h.call(new m(r),e)}}}function h(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,t.chain.length>0&&s(c,t))}function f(e,t,r,i){for(var n=0;n<t.length;n++)!function(n){e.resolve(t[n]).then((function(e){r(n,e)}),i)}(n)}function m(e){this.def=e,this.triggered=!1}function p(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function g(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var t=new p(this);this.then=function(e,r){var i={success:"function"!=typeof e||e,failure:"function"==typeof r&&r};return i.promise=new this.constructor((function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");i.resolve=e,i.reject=t})),t.chain.push(i),0!==t.state&&s(c,t),i.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,(function(e){d.call(t,e)}),(function(e){h.call(t,e)}))}catch(e){h.call(t,e)}}r=function(){var e,r,i;function n(e,t){this.fn=e,this.self=t,this.next=void 0}return{add:function(t,a){i=new n(t,a),r?r.next=i:e=i,r=i,i=void 0},drain:function(){var i=e;for(e=r=t=void 0;i;)i.fn.call(i.self),i=i.next}}}();var v=e({},"constructor",g,!1);return g.prototype=v,e(v,"__NPO__",0,!1),e(g,"resolve",(function(e){return e&&"object"==(0,a.default)(e)&&1===e.__NPO__?e:new this((function(t,r){if("function"!=typeof t||"function"!=typeof r)throw TypeError("Not a function");t(e)}))})),e(g,"reject",(function(e){return new this((function(t,r){if("function"!=typeof t||"function"!=typeof r)throw TypeError("Not a function");r(e)}))})),e(g,"all",(function(e){var t=this;return"[object Array]"!=n.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t((function(r,i){if("function"!=typeof r||"function"!=typeof i)throw TypeError("Not a function");var n=e.length,a=Array(n),o=0;f(t,e,(function(e,t){a[e]=t,++o===n&&r(a)}),i)}))})),e(g,"race",(function(e){var t=this;return"[object Array]"!=n.call(e)?t.reject(TypeError("Not an array")):new t((function(r,i){if("function"!=typeof r||"function"!=typeof i)throw TypeError("Not a function");f(t,e,(function(e,t){r(t)}),i)}))})),g},(r=v)[t="Promise"]=r[t]||n(),e.exports&&(e.exports=r[t])}(t={exports:{}}),t.exports}(),_=new WeakMap;function S(e,t,r){var i=_.get(e.element)||{};t in i||(i[t]=[]),i[t].push(r),_.set(e.element,i)}function T(e,t){return(_.get(e.element)||{})[t]||[]}function b(e,t,r){var i=_.get(e.element)||{};if(!i[t])return!0;if(!r)return i[t]=[],_.set(e.element,i),!0;var n=i[t].indexOf(r);return-1!==n&&i[t].splice(n,1),_.set(e.element,i),i[t]&&0===i[t].length}function C(e,t){var r=_.get(e);_.set(t,r),_.delete(e)}function w(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.warn(e),{}}return e}function P(e,t,r){if(e.element.contentWindow&&e.element.contentWindow.postMessage){var i={method:t};void 0!==r&&(i.value=r);var n=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));n>=8&&n<10&&(i=JSON.stringify(i)),e.element.contentWindow.postMessage(i,e.origin)}}function I(e,t){var r,i=[];if((t=w(t)).event)"error"===t.event&&T(e,t.data.method).forEach((function(r){var i=new Error(t.data.message);i.name=t.data.name,r.reject(i),b(e,t.data.method,r)})),i=T(e,"event:".concat(t.event)),r=t.data;else if(t.method){var n=function(e,t){var r=T(e,t);if(r.length<1)return!1;var i=r.shift();return b(e,t,i),i}(e,t.method);n&&(i.push(n),r=t.value)}i.forEach((function(t){try{if("function"==typeof t)return void t.call(e,r);t.resolve(r)}catch(e){}}))}var k=["autopause","autoplay","background","byline","color","controls","dnt","height","id","interactive_params","keyboard","loop","maxheight","maxwidth","muted","playsinline","portrait","responsive","speed","texttrack","title","transparent","url","width"];function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return k.reduce((function(t,r){var i=e.getAttribute("data-vimeo-".concat(r));return(i||""===i)&&(t[r]=""===i?1:i),t}),t)}function x(e,t){var r=e.html;if(!t)throw new TypeError("An element must be provided");if(null!==t.getAttribute("data-vimeo-initialized"))return t.querySelector("iframe");var i=document.createElement("div");return i.innerHTML=r,t.appendChild(i.firstChild),t.setAttribute("data-vimeo-initialized","true"),t.querySelector("iframe")}function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return new Promise((function(i,n){if(!h(e))throw new TypeError("".concat(e," is not a vimeo.com url."));var a="https://vimeo.com/api/oembed.json?url=".concat(encodeURIComponent(e));for(var o in t)t.hasOwnProperty(o)&&(a+="&".concat(o,"=").concat(encodeURIComponent(t[o])));var s="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;s.open("GET",a,!0),s.onload=function(){if(404!==s.status)if(403!==s.status)try{var t=JSON.parse(s.responseText);if(403===t.domain_status_code)return x(t,r),void n(new Error("".concat(e," is not embeddable.")));i(t)}catch(e){n(e)}else n(new Error("".concat(e," is not embeddable.")));else n(new Error("".concat(e," was not found.")))},s.onerror=function(){var e=s.status?" (".concat(s.status,")"):"";n(new Error("There was an error fetching the embed code from Vimeo".concat(e,".")))},s.send()}))}var A=new WeakMap,M=new WeakMap,R={},O=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,e),window.jQuery&&t instanceof jQuery&&(t.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),t=t[0]),"undefined"!=typeof document&&"string"==typeof t&&(t=document.getElementById(t)),!u(t))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==t.nodeName){var n=t.querySelector("iframe");n&&(t=n)}if("IFRAME"===t.nodeName&&!h(t.getAttribute("src")||""))throw new Error("The player element passed isnt a Vimeo embed.");if(A.has(t))return A.get(t);this._window=t.ownerDocument.defaultView,this.element=t,this.origin="*";var a=new y((function(e,n){if(r._onMessage=function(t){if(h(t.origin)&&r.element.contentWindow===t.source){"*"===r.origin&&(r.origin=t.origin);var i=w(t.data);if(i&&"error"===i.event&&i.data&&"ready"===i.data.method){var a=new Error(i.data.message);return a.name=i.data.name,void n(a)}var o=i&&"ready"===i.event,s=i&&"ping"===i.method;if(o||s)return r.element.setAttribute("data-ready","true"),void e();I(r,i)}},r._window.addEventListener("message",r._onMessage),"IFRAME"!==r.element.nodeName){var a=E(t,i);L(m(a),a,t).then((function(e){var i=x(e,t);return r.element=i,r._originalElement=t,C(t,i),A.set(r.element,r),e})).catch(n)}}));if(M.set(this,a),A.set(this.element,this),"IFRAME"===this.element.nodeName&&P(this,"ping"),R.isEnabled){var s=function(){return R.exit()};this.fullscreenchangeHandler=function(){R.isFullscreen?S(r,"event:exitFullscreen",s):b(r,"event:exitFullscreen",s),r.ready().then((function(){P(r,"fullscreenchange",R.isFullscreen)}))},R.on("fullscreenchange",this.fullscreenchangeHandler)}return this}var t,r;return t=e,(r=[{key:"callMethod",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new y((function(i,n){return t.ready().then((function(){S(t,e,{resolve:i,reject:n}),P(t,e,r)})).catch(n)}))}},{key:"get",value:function(e){var t=this;return new y((function(r,i){return e=c(e,"get"),t.ready().then((function(){S(t,e,{resolve:r,reject:i}),P(t,e)})).catch(i)}))}},{key:"set",value:function(e,t){var r=this;return new y((function(i,n){if(e=c(e,"set"),null==t)throw new TypeError("There must be a value to set.");return r.ready().then((function(){S(r,e,{resolve:i,reject:n}),P(r,e,t)})).catch(n)}))}},{key:"on",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===T(this,"event:".concat(e)).length&&this.callMethod("addEventListener",e).catch((function(){})),S(this,"event:".concat(e),t)}},{key:"off",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(t&&"function"!=typeof t)throw new TypeError("The callback must be a function.");b(this,"event:".concat(e),t)&&this.callMethod("removeEventListener",e).catch((function(e){}))}},{key:"loadVideo",value:function(e){return this.callMethod("loadVideo",e)}},{key:"ready",value:function(){var e=M.get(this)||new y((function(e,t){t(new Error("Unknown player. Probably unloaded."))}));return y.resolve(e)}},{key:"addCuePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.callMethod("addCuePoint",{time:e,data:t})}},{key:"removeCuePoint",value:function(e){return this.callMethod("removeCuePoint",e)}},{key:"enableTextTrack",value:function(e,t){if(!e)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:e,kind:t})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return R.isEnabled?R.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return R.isEnabled?R.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return R.isEnabled?y.resolve(R.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var e=this;return new y((function(t){if(M.delete(e),A.delete(e.element),e._originalElement&&(A.delete(e._originalElement),e._originalElement.removeAttribute("data-vimeo-initialized")),e.element&&"IFRAME"===e.element.nodeName&&e.element.parentNode&&(e.element.parentNode.parentNode&&e._originalElement&&e._originalElement!==e.element.parentNode?e.element.parentNode.parentNode.removeChild(e.element.parentNode):e.element.parentNode.removeChild(e.element)),e.element&&"DIV"===e.element.nodeName&&e.element.parentNode){e.element.removeAttribute("data-vimeo-initialized");var r=e.element.querySelector("iframe");r&&r.parentNode&&(r.parentNode.parentNode&&e._originalElement&&e._originalElement!==r.parentNode?r.parentNode.parentNode.removeChild(r.parentNode):r.parentNode.removeChild(r))}e._window.removeEventListener("message",e._onMessage),R.isEnabled&&R.off("fullscreenchange",e.fullscreenchangeHandler),t()}))}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(e){return this.set("autopause",e)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(e){return this.set("cameraProps",e)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"setColor",value:function(e){return this.set("color",e)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(e){return this.set("currentTime",e)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(e){return this.set("loop",e)}},{key:"setMuted",value:function(e){return this.set("muted",e)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(e){return this.set("playbackRate",e)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(e){return this.set("quality",e)}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(e){return this.set("volume",e)}}])&&s(t.prototype,r),e}();l||(R=function(){var e=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=t.length,n={};r<i;r++)if((e=t[r])&&e[1]in document){for(r=0;r<e.length;r++)n[t[0][r]]=e[r];return n}return!1}(),t={fullscreenchange:e.fullscreenchange,fullscreenerror:e.fullscreenerror},r={request:function(t){return new Promise((function(i,n){var a=function e(){r.off("fullscreenchange",e),i()};r.on("fullscreenchange",a);var o=(t=t||document.documentElement)[e.requestFullscreen]();o instanceof Promise&&o.then(a).catch(n)}))},exit:function(){return new Promise((function(t,i){if(r.isFullscreen){var n=function e(){r.off("fullscreenchange",e),t()};r.on("fullscreenchange",n);var a=document[e.exitFullscreen]();a instanceof Promise&&a.then(n).catch(i)}else t()}))},on:function(e,r){var i=t[e];i&&document.addEventListener(i,r)},off:function(e,r){var i=t[e];i&&document.removeEventListener(i,r)}};return Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),r}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=[].slice.call(e.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),r=function(e){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(e))};t.forEach((function(e){try{if(null!==e.getAttribute("data-vimeo-defer"))return;var t=E(e);L(m(t),t,e).then((function(t){return x(t,e)})).catch(r)}catch(e){r(e)}}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var t=function(t){if(h(t.origin)&&t.data&&"spacechange"===t.data.event)for(var r=e.querySelectorAll("iframe"),i=0;i<r.length;i++)if(r[i].contentWindow===t.source){r[i].parentElement.style.paddingBottom="".concat(t.data.data[0].bottom,"px");break}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var t=function(t){if(h(t.origin)){var r=w(t.data);if(r&&"ready"===r.event)for(var i=e.querySelectorAll("iframe"),n=0;n<i.length;n++){var a=i[n],o=a.contentWindow===t.source;f(a.src)&&o&&new O(a).callMethod("appendVideoMetadata",window.location.href)}}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var t=function(e){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(e))},r=function(r){if(h(r.origin)){var i=w(r.data);if(i&&"ready"===i.event)for(var n=e.querySelectorAll("iframe"),a=0;a<n.length;a++){var o=n[a],s=o.contentWindow===r.source;f(o.src)&&s&&function(){var e=new O(o);e.getVideoId().then((function(t){var r=new RegExp("[?&]vimeo_t_".concat(t,"=([^&#]*)")).exec(window.location.href);if(r&&r[1]){var i=decodeURI(r[1]);e.setCurrentTime(i)}})).catch(t)}()}}};window.addEventListener("message",r)}}());var D=O;t.default=D}).call(this,r(57),r(335).setImmediate)},function(e,t,r){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(n.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new a(n.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(336),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(57))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var i,n,a,o,s,l=1,c={},u=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){m(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&m(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){m(e.data)},i=function(e){a.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(n=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(m,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return c[l]=n,i(l),l++},h.clearImmediate=f}function f(e){delete c[e]}function m(e){if(u)setTimeout(m,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(57),r(194))},function(e,t,r){"use strict";var i=r(0),n=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.YouTube=void 0;var a=i(r(1)),o=i(r(2)),s=r(114),l=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(r(43)),c=r(17);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function h(){return!!document.head.querySelector('script[src="'.concat(l.YOUTUBE_IFRAME_API,'"]'))}function f(){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src="https://www.youtube.com/iframe_api",document.head.appendChild(e)}var m=function(){function e(t,r,i,n,o,s,l){(0,a.default)(this,e),this.paused=!0,this.url=new URL(t),this.parent=r,this.playbackTracker=i,this.mediaSizeInfo=n,this.onReadyCallback=o,this.onMediaEventCallback=s,this.appSettings=null!=l?l:{};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating YouTube video client: ".concat(e.message),!0)}}return(0,o.default)(e,[{key:"play",value:function(){void 0!==this.player&&void 0!==this.player.playVideo&&this.player.playVideo()}},{key:"getVolume",value:function(){if(void 0!==this.player&&void 0!==this.player.getVolume)return this.player.getVolume()}},{key:"pause",value:function(){void 0!==this.player&&void 0!==this.player.pauseVideo&&this.player.pauseVideo()}},{key:"getPlayer",value:function(){return this.youTubeIFrame}},{key:"stop",value:function(){void 0!==this.player&&void 0!==this.player.stopVideo&&this.player.stopVideo()}},{key:"togglePause",value:function(){void 0!==this.player&&(this.paused?this.play():this.pause())}},{key:"setVisible",value:function(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="visible")}},{key:"setHidden",value:function(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="hidden")}},{key:"getCurrentTime",value:function(){if(void 0!==this.player&&void 0!==this.player.getCurrentTime)return this.player.getCurrentTime();c.Log.warn(508895497,"Attempted to getCurrentTime ".concat(l.YOUTUBE_HOSTNAME," but undefined player"))}},{key:"getDuration",value:function(){if(void 0!==this.player&&void 0!==this.player.getDuration)return this.player.getDuration()}},{key:"seekTo",value:function(e){void 0!==this.player?this.shouldSeekOnlineMedia(e)&&void 0!==this.player.seekTo&&this.player.seekTo(e,!0):c.Log.warn(508895496,"Attempted to seek ".concat(l.YOUTUBE_HOSTNAME," but undefined player"))}},{key:"setMute",value:function(){void 0!==this.player&&void 0!==this.player.mute&&this.player.mute()}},{key:"setUnMute",value:function(){void 0!==this.player&&void 0!==this.player.unMute&&this.player.unMute()}},{key:"isMuted",value:function(){if(void 0!==this.player&&void 0!==this.player.isMuted)return this.player.isMuted()}},{key:"setVolume",value:function(e){void 0!==this.player&&void 0!==this.player.setVolume&&this.player.setVolume(e)}},{key:"isPaused",value:function(){return this.paused}},{key:"ensureMediaClient",value:function(){this.cleanUpMediaClient(),this.init()}},{key:"cleanUpMediaClient",value:function(){void 0!==this.youTubeIFrame&&this.youTubeIFrame.remove(),void 0!==this.pollPlayerVol&&clearInterval(this.pollPlayerVol),this.paused=!0,this.player=void 0,this.muted=void 0,this.volume=void 0,this.youTubeIFrame=void 0,this.pollPlayerVol=void 0,void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}},{key:"getPlaybackData",value:function(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}},{key:"init",value:function(){var t,r;null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.url.searchParams.set("enablejsapi","1"),this.youTubeIFrame=document.createElement("iframe"),this.youTubeIFrame.src=this.url.toString(),this.youTubeIFrame.id="gfx-video-youtube-".concat((0,s.v4)()),this.setProperties(this.youTubeIFrame),this.parent.append(this.youTubeIFrame),void 0!==this.mediaSizeInfo&&this.mediaSizeInfo.fEnableCropping&&this.handlePartiallyOffSlideLinkedMedia(this.mediaSizeInfo),!0===this.appSettings.fixAutoPlayEnabled?(c.Log.warn(507576588,"YouTube script loaded: ".concat(h()," IFrameAPI Ready: ").concat(null!==(r=window.isYouTubeIFrameAPIReady)&&void 0!==r&&r)),h()&&!0===window.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(c.Log.warn(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),e.clientsWaitingForIFrameAPI.push(this),window.onYouTubeIframeAPIReady=function(){window.isYouTubeIFrameAPIReady=!0;var t,r=u(e.clientsWaitingForIFrameAPI);try{for(r.s();!(t=r.n()).done;)t.value.initYouTubePlayer()}catch(e){r.e(e)}finally{r.f()}e.clientsWaitingForIFrameAPI=[]},h()||f())):(h()||(window.onYouTubeIframeAPIReady=function(){e.isYouTubeIFrameAPIReady=!0;var t,r=u(e.clientsWaitingForIFrameAPI);try{for(r.s();!(t=r.n()).done;)t.value.initYouTubePlayer()}catch(e){r.e(e)}finally{r.f()}e.clientsWaitingForIFrameAPI=[]},f()),e.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(c.Log.info(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),e.clientsWaitingForIFrameAPI.push(this)))}},{key:"initYouTubePlayer",value:function(){var e=this;void 0!==this.youTubeIFrame&&(document.body.contains(this.youTubeIFrame)?this.player=new YT.Player(this.youTubeIFrame.id,{events:{onReady:function(t){e.onPlayerReady(t)},onError:function(t){void 0!==e.playbackTracker&&e.playbackTracker.onError("YouTube player entered error state ".concat(t.data),!0)}}}):this.youTubeIFrame.onload=function(){e.initYouTubePlayer()})}},{key:"shouldSeekOnlineMedia",value:function(e){if(void 0!==this.player){var t=this.getCurrentTime();if(void 0!==t&&Math.abs(e-t)>=1)return!0}return!1}},{key:"handlePartiallyOffSlideLinkedMedia",value:function(e){var t=0,r=0;e.mediaPosition.x<0&&(t=e.mediaPosition.x,this.parent.style.left="0px",this.parent.style.width="".concat(e.mediaSize.x+e.mediaPosition.x,"px")),e.mediaPosition.y<0&&(r=e.mediaPosition.y,this.parent.style.top="0px",this.parent.style.height="".concat(e.mediaSize.y+e.mediaPosition.y,"px")),e.mediaPosition.x+e.mediaSize.x>e.slideSize.x&&(e.mediaPosition.x<=0?this.parent.style.width="".concat(e.slideSize.x,"px"):this.parent.style.width="".concat(e.slideSize.x-e.mediaPosition.x,"px")),e.mediaPosition.y+e.mediaSize.y>e.slideSize.y&&(e.mediaPosition.y<=0?this.parent.style.height="".concat(e.slideSize.y,"px"):this.parent.style.height="".concat(e.slideSize.y-e.mediaPosition.y,"px")),this.parent.style.overflow="hidden",void 0!==this.youTubeIFrame?(this.youTubeIFrame.style.width="".concat(e.mediaSize.x,"px"),this.youTubeIFrame.style.height="".concat(e.mediaSize.y,"px"),this.youTubeIFrame.style.position="relative",this.youTubeIFrame.style.left="".concat(t,"px"),this.youTubeIFrame.style.top="".concat(r,"px")):c.Log.warn(541881949,"Attempted to adjust iframe bounds but iframe is null")}},{key:"onPlayerReady",value:function(e){var t=this;this.onVolumeChangeHandler(),this.pollPlayerVol=setInterval((function(){return t.onVolumeChangeHandler()}),500),void 0!==this.player&&void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),this.playbackTracker.setVolume(this.player.getVolume()),this.playbackTracker.setIsMuted(this.player.isMuted()),this.playbackTracker.setDuration(this.player.getDuration())),e.target.addEventListener("onStateChange",(function(e){t.onStateChange(e),t.capturePlaybackTelemetry(e)})),void 0!==this.onReadyCallback&&this.onReadyCallback()}},{key:"onVolumeChangeHandler",value:function(){if(void 0!==this.player){var e=this.player.isMuted(),t=this.player.getVolume(),r=void 0===this.muted||void 0===this.volume,i=this.muted!==e,n=this.volume!==t;this.muted=e,this.volume=t,r||((i||n)&&this.sendMediaEvent(4),n&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),i&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted))}}},{key:"onStateChange",value:function(e){switch(e.data){case-1:break;case 0:this.paused=!0,this.sendMediaEvent(6);break;case 1:this.paused=!1,this.sendMediaEvent(1);break;case 2:this.paused=!0,this.sendMediaEvent(0);break;case 3:this.sendMediaEvent(3);break;case 5:break;default:c.Log.info(508895495,"Unexpected Youtube Media Event: ".concat(e.data))}}},{key:"capturePlaybackTelemetry",value:function(e){if(void 0!==this.playbackTracker)switch(e.data){case 0:this.playbackTracker.onEnded();break;case 1:this.playbackTracker.onPlaying();break;case 2:this.playbackTracker.onPause();break;case 3:this.playbackTracker.onBuffering()}}},{key:"sendMediaEvent",value:function(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}},{key:"setProperties",value:function(e){e.style.zIndex="".concat(l.VIDEO_Z_INDEX),e.style.width="100%",e.style.height="100%",e.style.pointerEvents="all",e.style.position="absolute",e.style.objectFit="fill",e.style.border="0px",e.setAttribute("allow","autoplay"),this.setVisible()}}])}();t.YouTube=m,m.isYouTubeIFrameAPIReady=h(),m.clientsWaitingForIFrameAPI=[]},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineVideoPoster=void 0;var n=i(r(1)),a=i(r(2)),o=r(43),s=r(167),l=(0,a.default)((function e(t,r,i,a){var l=this;(0,n.default)(this,e),this.poster=document.createElement("img"),this.poster.src=t,this.poster.tabIndex=-1,this.poster.style.position="absolute",this.poster.style.width="100%",this.poster.style.height="100%",this.poster.style.zIndex="".concat(o.VIDEO_Z_INDEX+1),this.playButton=(0,s.createSvgPlayButton)(a),this.poster.tabIndex=-1,this.playButton.style.zIndex="".concat(o.VIDEO_Z_INDEX+2),this.playButton.addEventListener("click",(function(){i()})),r.addEventListener("mousedown",(function(e){e.preventDefault()})),r.addEventListener("keydown",(function(e){!l.isVisible||"Enter"!==e.key&&" "!==e.key||(e.stopImmediatePropagation(),i())})),r.appendChild(this.poster),r.appendChild(this.playButton)}),[{key:"isVisible",get:function(){return"none"!==this.poster.style.display&&"none"!==this.playButton.style.display}},{key:"hide",value:function(){this.poster.style.display="none",this.playButton.style.display="none"}},{key:"show",value:function(){this.poster.style.display="inline",this.playButton.style.display="inline"}}]);t.OnlineVideoPoster=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineVideoController=void 0;var n=i(r(1)),a=i(r(2)),o=r(17),s=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.isReady=!1,this.pendingPlay=!1,this.client=t,this.playbackTracker=r}),[{key:"play",value:function(){this.logCommand("play"),this.isReady?this.client.play():this.pendingPlay=!0,this.playbackTracker.onPlayCommand()}},{key:"pause",value:function(){this.logCommand("pause"),this.pendingPlay=!1,this.isReady&&this.client.pause(),this.playbackTracker.onPauseCommand()}},{key:"stop",value:function(){this.logCommand("stop"),this.pendingPlay=!1,this.isReady&&this.client.stop(),this.playbackTracker.onStopCommand()}},{key:"seekTo",value:function(e){this.logCommand("seek to ".concat(e,"s")),this.isReady?this.client.seekTo(e):this.pendingSeekTime=e}},{key:"togglePlayPause",value:function(){this.logCommand("togglePlayPause"),this.isReady?void 0===this.client.isPaused||void 0===this.client.isPaused()||!0===this.client.isPaused()?this.play():this.pause():this.pendingPlay?this.pause():this.play()}},{key:"onReady",value:function(){this.isReady=!0,void 0!==this.pendingSeekTime&&(this.client.seekTo(this.pendingSeekTime),this.pendingSeekTime=void 0),this.pendingPlay&&(this.client.play(),this.pendingPlay=!1)}},{key:"cleanup",value:function(){this.isReady=!1,this.pendingPlay=!1,this.pendingSeekTime=void 0}},{key:"logCommand",value:function(e){o.Log.info(508870985,"OnlineVideoController recieved command: ".concat(JSON.stringify({command:e,isReady:this.isReady,pendingPlay:this.pendingPlay,pedingSeekTime:this.pendingSeekTime,correlationId:this.playbackTracker.getCorrelationId()})))}}]);t.OnlineVideoController=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineMediaPlaybackTracker=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10));function u(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var d=function(e){function t(e,r,i,a){var o;return(0,n.default)(this,t),(o=u(this,t,[e,r,i,r,a])).onlineData={},o}return(0,c.default)(t,e),(0,a.default)(t,[{key:"getPlaybackData",value:function(){return Object.assign(Object.assign({},(0,s.default)((0,l.default)(t.prototype),"getPlaybackData",this).call(this)),this.onlineData)}},{key:"onHubbleTokenSet",value:function(){void 0===this.onlineData.timeOfHubbleToken&&(this.onlineData.timeOfHubbleToken=Date.now())}},{key:"onOEmbedResponse",value:function(){void 0===this.onlineData.timeOfOEmbedResponse&&(this.onlineData.timeOfOEmbedResponse=Date.now())}},{key:"onNavigatedToEmbedPage",value:function(){void 0===this.onlineData.timeOfNavigatedToEmbedPage&&(this.onlineData.timeOfNavigatedToEmbedPage=Date.now())}},{key:"onPostMessagingInitialized",value:function(){void 0===this.onlineData.timeOfPostMessagingInitialized&&(this.onlineData.timeOfPostMessagingInitialized=Date.now())}},{key:"onODSPVideoLoad",value:function(e){void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now()-e)}},{key:"onVideoElementStopPlaying",value:function(){var e=this.baseData.lastVolume,t=this.baseData.lastMuteState,r=this.vetoHandler.getError();this.cleanup(),void 0!==e&&this.setVolume(e),void 0!==t&&this.setIsMuted(t),void 0!==r&&this.vetoHandler.setError(r)}},{key:"onPlayCommand",value:function(){var e="Other"!==this.baseData.providerName&&"Ted"!==this.baseData.providerName&&"SlideShare"!==this.baseData.providerName;(0,s.default)((0,l.default)(t.prototype),"onPlayCommand",this).call(this,e)}},{key:"onPauseCommand",value:function(){void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}},{key:"cleanup",value:function(){this.onlineData.timeOfHubbleToken=void 0,this.onlineData.timeOfOEmbedResponse=void 0,this.onlineData.timeOfPostMessagingInitialized=void 0,(0,s.default)((0,l.default)(t.prototype),"cleanup",this).call(this)}}])}(r(160).BaseMediaPlaybackTracker);t.OnlineMediaPlaybackTracker=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSyncLock=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=(0,a.default)((function e(t){(0,n.default)(this,e),this.presenterToPresenterWaitTimeMs=t}),[{key:"shouldSendMediaUpdate",value:function(){if(void 0!==this.lastRecievedEvent){var e=Date.now(),t=e-this.lastRecievedEvent,r=t<this.presenterToPresenterWaitTimeMs;if(o.ULS.sendTraceTag(520181122,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"shouldSendMediaUpdate: Date.now(): ".concat(e,", lastReceivedEvent: ").concat(this.lastRecievedEvent,", timeElapsed: ").concat(t,",\n        presenterToPresenterWaitTimeMs: ").concat(this.presenterToPresenterWaitTimeMs,", fSuppressUpdate: ").concat(r)),r)return!1}else o.ULS.sendTraceTag(520181121,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Info,"shouldSendMediaUpdate: lastReceivedEvent is undefined");return!0}},{key:"updateLastTimeRecievedEvent",value:function(){this.lastRecievedEvent=Date.now()}}]);t.MediaSyncLock=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlaybackController=t.PerfSlowError=t.PlaybackInterruptedError=t.PlaybackFailedError=t.PlaybackQualityImpactType=void 0;var n,a,o,s,l=i(r(1)),c=i(r(2)),u=r(3),d=r(11),h=r(4),f=r(25);t.PlaybackQualityImpactType=n,function(e){e.MediaPlaybackFailed="MediaPlaybackFailed",e.MediaPlaybackInterrupted="MediaPlaybackInterrupted",e.MediaPerfSlow="MediaPerfSlow"}(n||(t.PlaybackQualityImpactType=n={})),t.PlaybackFailedError=a,function(e){e.VideoNotPlayedWithSeek="VideoNotPlayedWithSeek",e.VideoNotPlayed="VideoNotPlayed",e.VideoNotPlayedWithSeekOnLastRetry="VideoNotPlayedWithSeekOnLastRetry",e.VideoNotPlayedOnLastRetry="VideoNotPlayedOnLastRetry"}(a||(t.PlaybackFailedError=a={})),t.PlaybackInterruptedError=o,function(e){e.VideoNotPlayedWithSeekSubsequent="VideoNotPlayedWithSeekSubsequent",e.VideoNotPlayedSubsequent="VideoNotPlayedSubsequent",e.VideoNotResumed="VideoNotResumed",e.VideoErrorAfterPlaying="VideoErrorAfterPlaying",e.VideoNotSeeked="VideoNotSeeked"}(o||(t.PlaybackInterruptedError=o={})),t.PerfSlowError=s,function(e){e.VideoStalledExcessively="VideoStalledExcessively",e.VideoNotPlayedWaiting="VideoNotPlayedWaiting",e.VideoPlayedSlow="VideoPlayedSlow",e.VideoResumedSlow="VideoResumedSlow",e.VideoSeekedSlow="VideoSeekedSlow"}(s||(t.PerfSlowError=s={}));var m=(0,c.default)((function e(t,r,i,n,a,o,s,c,d){var m=this;(0,l.default)(this,e),this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,this.hlsErrorTypes=new Set,this.hlsErrorDetails=new Set,this.player=t,this.mediaName=r,this.mediaType=i===f.MediaType.Video?"Video":"Audio",this.isTeams=o,this.isTeamsWeb=s,this.isMobileDevice=a,this.isReadyOnLoadedMetadata=n,this.onQualityImpactErrorCallback=c,this.onNotAllowedError=d,u.ULS.sendTraceTag(528599055,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Creating controller ".concat(this.state)),this.seekPrecision=h.Settings.readNumberOrDefault("videoSeekPrecision",.1),this.slowToPlayingTime=h.Settings.readNumberOrDefault("minTimeForSlowToPlayingVeto",1e4),this.notPlayingTime=h.Settings.readNumberOrDefault("minTimeForNotPlayingVeto",1e4),this.slowToSeekedTime=h.Settings.readNumberOrDefault("minTimeForSlowToSeekedVeto",1e4),this.notSeekedTime=h.Settings.readNumberOrDefault("minTimeForNotSeekedVeto",1e4),this.slowToResumedTime=h.Settings.readNumberOrDefault("minTimeForSlowToResumedVeto",1e4),this.notResumedTime=h.Settings.readNumberOrDefault("minTimeForNotResumedVeto",1e4),this.mediaMaxNotPlayingTime=h.Settings.readNumberOrDefault("maxTimeForVideoNotPlayedVeto",1e4),this.notPlayingAfterErrorTime=h.Settings.readNumberOrDefault("minTimeForNotPlayingAfterErrorVeto",1e3),this.minStallCount=h.Settings.readNumberOrDefault("stalledCountForGoodStalledVeto",3),t.addEventListener("loadedmetadata",(function(){return m.onLoadedMetadata()})),t.addEventListener("canplay",(function(){return m.onCanPlay()})),t.addEventListener("play",(function(){return m.onPlay()})),t.addEventListener("playing",(function(){return m.onPlaying()})),t.addEventListener("seeking",(function(){return m.onSeeking()})),t.addEventListener("seeked",(function(){return m.onSeeked()})),t.addEventListener("pause",(function(){return m.onPause()})),t.addEventListener("ended",(function(){return m.onEnded()})),t.addEventListener("error",(function(){return m.onError()})),t.addEventListener("stalled",(function(){return m.onStalled()})),this.isMobileDevice&&document.addEventListener("visibilitychange",(function(){return m.onVisibilityChange()}))}),[{key:"onSourceSet",value:function(e,t,r,i,n,a){this.requestGuid=e,this.retriesLeft=t,this.mediaLength=r,this.isTranscoding=i,this.isHls=n,this.navigationCount=a,this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,u.ULS.sendTraceTag(528599056,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Setting source ".concat(this.state))}},{key:"onNavigatingTo",value:function(){u.ULS.sendTraceTag(528599057,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Navigating to ".concat(this.state)),this.isPlayOrPausePending=void 0,this.pendingSeekTime=void 0,this.clearTimeoutHelper(),this.playTime=void 0,this.seekTime=void 0,this.clearStallTracking()}},{key:"onNavigatingFrom",value:function(){if(u.ULS.sendTraceTag(528599058,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Navigating from ".concat(this.state)),this.clearTimeoutHelper(),void 0!==this.playTime&&void 0!==this.seekTime){var e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?n.MediaPlaybackInterrupted:n.MediaPlaybackFailed,this.wasPlaying?o.VideoNotPlayedWithSeekSubsequent:a.VideoNotPlayedWithSeek,"".concat(this.mediaType," is not playing with seek ").concat(this.wasPlaying?"during subsequent playback ":"","after: ").concat(e)),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){var t=this.timeElapsedWhileVisibleFrom(this.playTime);t>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?n.MediaPlaybackInterrupted:n.MediaPlaybackFailed,this.wasPlaying?o.VideoNotPlayedSubsequent:a.VideoNotPlayed,"".concat(this.mediaType," is not playing ").concat(this.wasPlaying?"during subsequent playback ":"","after: ").concat(t)),this.playTime=void 0}if(void 0!==this.seekTime){var r=this.timeElapsedWhileVisibleFrom(this.seekTime);r>=this.notSeekedTime&&this.onQualityImpactError(n.MediaPlaybackInterrupted,o.VideoNotSeeked,"".concat(this.mediaType," is not seeked after: ").concat(r)),this.seekTime=void 0}if(void 0!==this.stallTime){var i=this.timeElapsedWhileVisibleFrom(this.stallTime);if(d.ChangeGate.isChangeGateEnabled("SVM.FixVideoNotResumedVeto")){var l=function(e,t){if(void 0!==e&&void 0!==t)return e-t},c=l(this.player.currentTime,this.playerTimeAtStall),h=function(e){if(void 0!==e)return Math.abs(e)}(l(c,i/1e3));u.ULS.sendTraceTag(512567435,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Stall tracking. timeSinceStall: ".concat(i,", playerTimeElapsedSinceStallSec: ").concat(c,", diffPlayedTimeStallTimeSec: ").concat(h,", ").concat(this.state)),i>=this.notResumedTime&&(!h||h>this.seekPrecision)&&this.onQualityImpactError(n.MediaPlaybackInterrupted,o.VideoNotResumed,"".concat(this.mediaType," is not resumed after: ").concat(i))}else i>=this.notResumedTime&&this.onQualityImpactError(n.MediaPlaybackInterrupted,o.VideoNotResumed,"".concat(this.mediaType," is not resumed after: ").concat(i));this.clearStallTracking()}0!==this.numberOfStalls&&(this.numberOfStalls>=this.minStallCount&&this.onQualityImpactError(n.MediaPerfSlow,s.VideoStalledExcessively,"".concat(this.mediaType," was stalled excessively: ").concat(this.numberOfStalls)),this.numberOfStalls=0),this.shouldCleanupLocalPlayerOnNavigatedFrom()&&(this.isSeekInProgress=!1,this.isReady=!1,this.firstPlayingTime=void 0)}},{key:"shouldCleanupLocalPlayerOnNavigatedFrom",value:function(){return!(!h.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)&&this.localMediaPlaybackPerf&&this.localMediaPlaybackPerf.isAutoPlay())}},{key:"playOrPause",value:function(e){var t=this;e&&void 0===this.m_maxWaitingMediaNotPlayingTimeout&&(this.m_maxWaitingMediaNotPlayingTimeout=window.setTimeout((function(){t.mediaPlayingWaitingTimeout()}),this.mediaMaxNotPlayingTime)),e&&void 0===this.playTime&&(this.playTime=Date.now()),this.isReady?this.doPlayOrPause(e):(e?u.ULS.sendTraceTag(528599059,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Delaying playing ".concat(this.state)):u.ULS.sendTraceTag(528599060,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Delaying pausing ".concat(this.state)),this.isPlayOrPausePending=e)}},{key:"seek",value:function(e){void 0===this.seekTime&&(this.seekTime=Date.now()),this.isReady?this.doSeek(e):(u.ULS.sendTraceTag(528599061,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Delaying seeking ".concat(this.state," to: ").concat(e)),this.pendingSeekTime=e)}},{key:"setHls",value:function(e){this.isHls=e}},{key:"setIsTranscoding",value:function(e){this.isTranscoding=e}},{key:"isSeeking",value:function(){return!(!this.isSeekInProgress||this.player.paused&&this.player.currentTime<=this.seekPrecision)}},{key:"onLoadedMetadata",value:function(){u.ULS.sendTraceTag(528599062,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"LoadedMetadata event ".concat(this.state)),this.isReadyOnLoadedMetadata&&this.onReady()}},{key:"onCanPlay",value:function(){u.ULS.sendTraceTag(528599063,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"CanPlay event ".concat(this.state)),this.onReady()}},{key:"onPlay",value:function(){u.ULS.sendTraceTag(528599064,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Play event ".concat(this.state)),this.isReady=!1}},{key:"mediaPlayingWaitingTimeout",value:function(){if(void 0!==this.playTime){var e=Date.now()-this.playTime;this.onQualityImpactError(n.MediaPerfSlow,s.VideoNotPlayedWaiting,"".concat(this.mediaType," is still not playing after: ").concat(e))}}},{key:"clearTimeoutHelper",value:function(){window.clearTimeout(this.m_maxWaitingMediaNotPlayingTimeout),this.m_maxWaitingMediaNotPlayingTimeout=void 0,window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=void 0}},{key:"onPlaying",value:function(){if(u.ULS.sendTraceTag(528599065,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Playing event ".concat(this.state)),this.clearTimeoutHelper(),this.firstPlayingTime=Date.now(),void 0!==this.playTime){var e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.slowToPlayingTime&&this.onQualityImpactError(n.MediaPerfSlow,s.VideoPlayedSlow,"".concat(this.mediaType," was playing after: ").concat(e)),this.playTime=void 0}if(void 0!==this.stallTime){var t=this.timeElapsedWhileVisibleFrom(this.stallTime);t>=this.slowToResumedTime&&this.onQualityImpactError(n.MediaPerfSlow,s.VideoResumedSlow,"".concat(this.mediaType," was resumed after: ").concat(t)),this.clearStallTracking()}this.onReady()}},{key:"onSeeking",value:function(){u.ULS.sendTraceTag(528599104,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Seeking event ".concat(this.state)),this.isSeekInProgress=!0,this.isReady=!1}},{key:"onSeeked",value:function(){if(u.ULS.sendTraceTag(528599105,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Seeked event ".concat(this.state)),void 0!==this.seekTime){var e=Date.now()-this.seekTime;e>=this.slowToSeekedTime&&this.onQualityImpactError(n.MediaPerfSlow,s.VideoSeekedSlow,"".concat(this.mediaType," was seeked after: ").concat(e)),this.seekTime=void 0}this.isSeekInProgress=!1,this.onReady()}},{key:"onPause",value:function(){u.ULS.sendTraceTag(528599106,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Pause event ".concat(this.state)),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.onReady()}},{key:"onEnded",value:function(){u.ULS.sendTraceTag(528599107,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Ended event ".concat(this.state)),this.clearStallTracking()}},{key:"setVetoTimerForPlaybackInterruptionAfterError",value:function(e){var t=this;window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=window.setTimeout((function(e,r){t.onQualityImpactError(n.MediaPlaybackInterrupted,o.VideoErrorAfterPlaying,"".concat(t.mediaType," error, not resumed after playing with error code ").concat(e," after: ").concat(t.timeElapsedWhileVisibleFrom(r)))}),this.notPlayingAfterErrorTime,e,this.firstPlayingTime)}},{key:"getLastErrorCode",value:function(){return null!==this.player.error?this.player.error.code:-1}},{key:"onError",value:function(){var e=this.getLastErrorCode();if(u.ULS.sendTraceTag(528599108,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Error event ".concat(this.state," errorCode: ").concat(e)),0===this.retriesLeft&&!this.wasPlaying){if(void 0!==this.playTime&&void 0!==this.seekTime){var t=Date.now()-this.playTime;t>=this.notPlayingTime&&this.onQualityImpactError(n.MediaPlaybackFailed,a.VideoNotPlayedWithSeekOnLastRetry,"".concat(this.mediaType," is not playing with seek on last retry with error code ").concat(e," after: ").concat(t)),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){var r=Date.now()-this.playTime;r>=this.notPlayingTime&&this.onQualityImpactError(n.MediaPlaybackFailed,a.VideoNotPlayedOnLastRetry,"".concat(this.mediaType," is not playing on last retry with error code ").concat(e," after: ").concat(r)),this.playTime=void 0}}void 0!==this.firstPlayingTime&&(u.ULS.sendTraceTag(520161375,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"".concat(this.mediaType," playback interrupted after playing with error code: ").concat(e," for mediaName: ").concat(this.mediaName)),void 0===this.mediaNotResumedAfterErrorTimeout&&this.setVetoTimerForPlaybackInterruptionAfterError(e)),this.isSeekInProgress=!1,this.isReady=!1}},{key:"wasPlaying",get:function(){return void 0!==this.firstPlayingTime}},{key:"doPlayOrPause",value:function(e){var t=this;if(this.isPlayOrPausePending=void 0,u.ULS.sendTraceTag(520410972,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"LocalMediaPlaybackController.doPlayOrPause: isPlay: ".concat(e,", this.player.paused: ").concat(this.player.paused,", this.state: ").concat(this.state)),e===this.player.paused){var r=!1;return e?(u.ULS.sendTraceTag(528599109,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Playing ".concat(this.state)),this.player.play().catch((function(e){u.ULS.sendTraceTag(528599110,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Play promise failed ".concat(t.state," error: ").concat(e.name," muted: ").concat(t.player.muted," isTeams: ").concat(t.isTeams," isTeamsWeb: ").concat(t.isTeamsWeb," message: ").concat(e.message)),"NotAllowedError"===e.name&&!t.player.muted&&t.isTeamsWeb?(t.player.muted=!0,t.doPlayOrPause(!0)):(u.ULS.sendTraceTag(520161373,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Play promise failed unexepectedly ".concat(t.state," error: ").concat(e.name," muted: ").concat(t.player.muted," isTeams: ").concat(t.isTeams," isTeamsWeb: ").concat(t.isTeamsWeb," message: ").concat(e.message," isCloseToEndOfMediaResource: ").concat(t.isCloseToEndOfMediaResource())),d.ChangeGate.isChangeGateEnabled("SVM.ShowPlayButtonOnNotAllowedError")&&"NotAllowedError"===e.name&&"Video"===t.mediaType&&(r=!0,t.isReady=!0,t.clearTimeoutHelper(),t.playTime=void 0,t.onNotAllowedError()))}))):(u.ULS.sendTraceTag(528599111,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Pausing ".concat(this.state)),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.player.pause()),void(r||(this.isReady=!1))}e?u.ULS.sendTraceTag(527241492,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Skipping playing ".concat(this.state)):u.ULS.sendTraceTag(527241493,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Skipping pausing ".concat(this.state)),this.clearTimeoutHelper(),this.playTime=void 0}},{key:"doSeek",value:function(e){return this.pendingSeekTime=void 0,e<0||e>this.player.duration?(u.ULS.sendTraceTag(526984739,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Skipping out-of-bounds seeking ".concat(this.state," to: ").concat(e)),this.seekTime=void 0,!1):Math.abs(e-this.player.currentTime)>this.seekPrecision?(u.ULS.sendTraceTag(528599112,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Seeking ".concat(this.state," to: ").concat(e)),this.clearStallTracking(),this.isSeekInProgress=!0,this.isReady=!1,this.player.currentTime=e,!0):(u.ULS.sendTraceTag(527241494,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Skipping seeking ".concat(this.state," to: ").concat(e)),this.seekTime=void 0,!1)}},{key:"onStalled",value:function(){void 0!==this.playTime||void 0!==this.seekTime||void 0!==this.stallTime||this.isSeekInProgress||this.player.paused?u.ULS.sendTraceTag(526161288,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Skipped stalled event ".concat(this.state)):(this.stallTime=Date.now(),this.playerTimeAtStall=this.player.currentTime,this.numberOfStalls+=1,u.ULS.sendTraceTag(527193424,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"Stalled event ".concat(this.state)))}},{key:"onReady",value:function(){this.isReady=!0,void 0!==this.pendingSeekTime&&this.doSeek(this.pendingSeekTime)||void 0===this.isPlayOrPausePending||this.isSeekInProgress||this.doPlayOrPause(this.isPlayOrPausePending)}},{key:"state",get:function(){return"mediaName: ".concat(this.mediaName,"\n      requestGuid: ").concat(this.requestGuid,"\n      networkState: ").concat(this.player.networkState,"\n      readyState: ").concat(this.player.readyState,"\n      isReadyOnLoadedMetadata: ").concat(this.isReadyOnLoadedMetadata,"\n      currentTime: ").concat(this.player.currentTime,"\n      visibility: ").concat(document.visibilityState)}},{key:"onQualityImpactError",value:function(e,t,r){if(u.ULS.sendTraceTag(526934468,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"".concat(r," ").concat(this.state)),!this.isMobileDevice||"hidden"!==document.visibilityState){this.localMediaPlaybackPerf&&this.localMediaPlaybackPerf.vetoLogged();var i={impactType:e,errorName:t,details:r,mediaName:this.mediaName,mediaType:this.mediaType,requestGuid:this.requestGuid,networkState:this.player.networkState,readyState:this.player.readyState,isReadyOnLoadedMetadata:this.isReadyOnLoadedMetadata,currentTime:this.player.currentTime,paused:this.player.paused,muted:this.player.muted,mediaLength:this.mediaLength,visibility:document.visibilityState,retriesLeft:this.retriesLeft,isTeams:this.isTeams,isTeamsWeb:this.isTeamsWeb,isTranscoding:this.isTranscoding,isHls:this.isHls,navigationCount:this.navigationCount,hlsErrorTypes:Array.from(this.hlsErrorTypes),hlsErrorDetails:Array.from(this.hlsErrorDetails),hlsBandwidthEstimate:this.hlsBandwidthEstimate};this.onQualityImpactErrorCallback(i),h.Settings.readBooleanOrDefault("alertMediaVeto",!1)&&window.alert("MediaQualityImpactInfo: ".concat(e,"-").concat(t,", ").concat(r," ").concat(this.state)),this.clearHlsErrors()}}},{key:"isCloseToEndOfMediaResource",value:function(){return!isNaN(this.player.duration)&&this.player.currentTime>this.player.duration-this.seekPrecision}},{key:"addHlsError",value:function(e,t){this.hlsErrorTypes.add(e),this.hlsErrorDetails.add(t)}},{key:"clearHlsErrors",value:function(){this.hlsErrorTypes.clear(),this.hlsErrorDetails.clear()}},{key:"setHlsBandwidthEstimate",value:function(e){this.hlsBandwidthEstimate=e}},{key:"clearStallTracking",value:function(){this.stallTime=void 0,this.playerTimeAtStall=void 0}},{key:"onVisibilityChange",value:function(){"visible"===document.visibilityState?this.lastBecameVisibleTime=Date.now():"hidden"===document.visibilityState&&(this.lastHideTime=Date.now())}},{key:"timeElapsedWhileVisibleFrom",value:function(e){var t=Date.now();if(void 0===this.lastBecameVisibleTime&&void 0===this.lastHideTime)return t-e;var r=void 0===this.lastHideTime?0:Math.max(0,this.lastHideTime-e);return void 0!==this.lastBecameVisibleTime?r+(void 0!==this.lastHideTime&&this.lastHideTime>this.lastBecameVisibleTime?0:t-Math.max(this.lastBecameVisibleTime,e)):r}},{key:"setLocalMediaPlaybackPerf",value:function(e){this.localMediaPlaybackPerf=e}}]);t.LocalMediaPlaybackController=m},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlaybackSource=void 0;var n,a,o,s,l,c,u,d,h,f,m=i(r(6)),p=i(r(7)),g=i(r(1)),v=i(r(2)),y=r(11),_=r(4),S=r(49),T=r(3);!function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.EnabledOriginalNotPlayable=3]="EnabledOriginalNotPlayable",e[e.DisabledOnlyPlayableBrs=4]="DisabledOnlyPlayableBrs",e[e.DisabledNoMp4Brs=5]="DisabledNoMp4Brs",e[e.DisabledTooSmallForDesktopBrs=6]="DisabledTooSmallForDesktopBrs",e[e.Enabled=7]="Enabled",e[e.DisabledNoHls=8]="DisabledNoHls"}(n||(n={})),function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.DisabledNotMp4AndNotTranscoding=3]="DisabledNotMp4AndNotTranscoding",e[e.Enabled=4]="Enabled"}(a||(a={})),function(e){e[e.Raw=0]="Raw",e[e.LowNoMultivariantMobileBrs=1]="LowNoMultivariantMobileBrs",e[e.All=2]="All"}(o||(o={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.EnabledProbably=1]="EnabledProbably",e[e.EnabledMaybe=2]="EnabledMaybe",e[e.DisabledNotSupported=3]="DisabledNotSupported"}(s||(s={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.DisabledOriginalNotPlayable=1]="DisabledOriginalNotPlayable",e[e.DisabledNotMp4=2]="DisabledNotMp4",e[e.Enabled=3]="Enabled"}(l||(l={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.HLSTranscoding=1]="HLSTranscoding",e[e.HLSRaw=2]="HLSRaw",e[e.ProgressiveRaw=3]="ProgressiveRaw"}(c||(c={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Progressive=1]="Progressive",e[e.HLSjs=2]="HLSjs",e[e.NativeHLS=3]="NativeHLS",e[e.ProgressiveNoHLS=4]="ProgressiveNoHLS"}(u||(u={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Raw=1]="Raw",e[e.RawNoHLS=2]="RawNoHLS",e[e.Transcoding=3]="Transcoding"}(d||(d={})),function(e){e[e.Raw=0]="Raw",e[e.Low=1]="Low",e[e.All=2]="All"}(h||(h={})),function(e){e[e.StoppedRetrying=0]="StoppedRetrying",e[e.Unloaded=1]="Unloaded",e[e.NotYetStarted=2]="NotYetStarted",e[e.Retrying=3]="Retrying",e[e.SourceSet=4]="SourceSet",e[e.LoadStart=5]="LoadStart",e[e.LoadedMetadata=6]="LoadedMetadata",e[e.CanPlay=7]="CanPlay"}(f||(f={}));var b=function(){function e(t,r,i,m,p,v,y,_,b,C,w,P,I,k,E,x,L){var A=this;(0,g.default)(this,e),this.m_playbackOptions=[],this.m_navigationCount=0,this.m_loadingState=f.NotYetStarted,this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,this.m_playbackOption=c.Unplayable,this.m_hlsOption=u.Unplayable,this.m_transcodingOption=d.Unplayable,this.m_transcodingUrlParam=h.Raw,this.m_element=t,this.m_url=r,this.m_mediaName=i,this.m_isMediaSnap=m,this.m_originalMediaLength=p,this.m_isOriginalPlayable=v,this.m_isVideo=y,this.m_isMP4=_,this.m_isMobileDevice=b,this.m_uiHostType=C,this.m_requestGuid=I,this.m_localMediaPlaybackPerf=k,this.m_localMediaPlaybackController=E,this.m_localMediaPlaybackTelemetry=L,this.m_onFatalError=x,this.m_transcodingState=this.getTranscodingState(),this.m_hlsState=this.getHlsState(),this.m_transcodingState=this.isHlsEnabled()?this.m_transcodingState:n.DisabledNoHls,this.m_transcodingQuality=this.getTranscodingQuality(),this.m_nativeHlsState=this.getNativeHlsState(),this.m_hlsRawState=this.getHlsRawState(),this.m_initialRetryCount=this.getInitialRetryCount(w),this.m_initialRetryDelayMs=this.getInitialRetryDelay();var M=[];this.isHlsTranscodingEnabled()&&(this.m_playbackOptions.push(c.HLSTranscoding),M.push(c[c.HLSTranscoding])),this.isHlsRawEnabled()&&(this.m_playbackOptions.push(c.HLSRaw),M.push(c[c.HLSRaw])),this.m_isOriginalPlayable&&(this.m_playbackOptions.push(c.ProgressiveRaw),M.push(c[c.ProgressiveRaw]));var R={mediaName:i,isMediaSnap:m,originalMediaLength:p,isOriginalPlayable:v,isVideo:y,isMP4:_,isMobileDevice:b,uiHostType:S.UIHostType[C],requestGuid:I,transcodingState:n[this.m_transcodingState],transcodingQuality:o[this.m_transcodingQuality],hlsState:a[this.m_hlsState],nativeHlsState:s[this.m_nativeHlsState],hlsRawState:l[this.m_hlsRawState],initialRetryCount:this.m_initialRetryCount,initialRetryDelayMs:this.m_initialRetryDelayMs,playbackOptions:M.toString()};T.ULS.sendTraceTag(512271880,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Info,JSON.stringify(R)),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_url.hostname=this.m_url.hostname.toLowerCase().replace(".pods.",".media."),this.m_url.searchParams.set("usid",P),this.m_url.searchParams.set("requestGuid",this.m_requestGuid),this.m_element.addEventListener("loadstart",(function(){A.m_loadingState=f.LoadStart})),this.m_element.addEventListener("loadedmetadata",(function(){A.m_loadingState=f.LoadedMetadata})),this.m_element.addEventListener("canplay",(function(){A.m_loadingState!==f.CanPlay&&(A.m_loadingState=f.CanPlay,A.onCanPlay())})),this.m_element.addEventListener("error",(function(){A.onError()}))}return(0,v.default)(e,[{key:"isUnplayable",value:function(){return 0===this.m_playbackOptions.length}},{key:"shouldSkipCleanup",value:function(){return!(_.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)||!this.m_localMediaPlaybackPerf.isAutoPlay())||!_.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0)&&this.m_hlsOption===u.HLSjs||!_.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)&&this.m_hlsOption===u.NativeHLS}},{key:"cleanupPlayerOnNavigatedFrom",value:function(){this.m_navigationCount+=1,this.shouldSkipCleanup()||(T.ULS.sendTraceTag(512271879,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Info,"cleanupPlayerOnNavigatedFrom mediaName: ".concat(this.m_mediaName)),this.m_loadingState=f.Unloaded,this.cancelRetryTimeout(),this.destroyHlsJsInstance(),this.m_element.src&&(this.m_element.removeAttribute("src"),this.m_element.load()))}},{key:"resetPlayerOnNavigatingTo",value:function(){this.m_loadingState>=f.Retrying||(T.ULS.sendTraceTag(512271878,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Info,"resetPlayerOnNavigatingTo mediaName: ".concat(this.m_mediaName)),this.setSource())}},{key:"setSource",value:function(){this.m_loadingState!==f.NotYetStarted&&this.m_loadingState!==f.StoppedRetrying&&T.ULS.sendTraceTag(509436766,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,"Unexpected loadingState in setSourceAsync"),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_loadingState=f.NotYetStarted,this.cancelRetryTimeout(),this.setSourceAsync()}},{key:"setSourceAsync",value:(i=(0,p.default)(m.default.mark((function e(){var t,r,i,n,a,o;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isUnplayable()){e.next=4;break}return T.ULS.sendTraceTag(512271877,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,"Unexpected setSourceAsync with isUnplayable"),this.stopRetrying(),e.abrupt("return");case 4:return this.destroyHlsJsInstance(),this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,e.next=9,this.importHlsJsIfNecessaryAsync();case 9:if(this.m_playbackOption=this.getPlaybackOption(),this.m_hlsOption=this.getHlsOption(),this.m_transcodingOption=this.getTranscodingOption(),this.m_transcodingUrlParam=this.getTranscodingUrlParam(),t=this.isHlsSelected(),r=this.isTranscodingSelected(),i=!r&&!this.m_isOriginalPlayable,n={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:c[this.m_playbackOption],hlsOption:u[this.m_hlsOption],transcodingOption:d[this.m_transcodingOption],transcodingUrlParam:h[this.m_transcodingUrlParam],isHls:t,isTranscoding:r,isUnplayable:i},a=i?T.TraceLevel.Error:T.TraceLevel.Info,T.ULS.sendTraceTag(512271876,T.LogCategory.msoulscat_Wac_PptSession,a,JSON.stringify(n)),!i){e.next=22;break}return this.stopRetrying(),e.abrupt("return");case 22:this.updateUrlParams(),this.m_localMediaPlaybackPerf.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackPerf.setHlsAndTranscoding(t,r),this.m_localMediaPlaybackTelemetry&&(this.m_localMediaPlaybackTelemetry.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackTelemetry.setHlsAndTranscoding(t,r)),this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,this.m_retriesRemaining,this.m_originalMediaLength,r,t,this.m_navigationCount),this.m_loadingState=f.SourceSet,o=this.addPreloadParam(this.getUrlWithSlashes()),this.m_hlsOption===u.HLSjs&&this.m_hls?(this.m_hls.loadSource(o),this.m_hls.attachMedia(this.m_element)):this.m_element.src=o;case 30:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateUrlParams",value:function(){this.m_url.searchParams.set("retries",this.m_retriesRemaining.toString()),this.m_url.searchParams.set("transcode",h[this.m_transcodingUrlParam])}},{key:"getUrlWithSlashes",value:function(){var e=this.m_url.toString();return this.isHlsSelected()?"".concat(e.replace(/[?&]/g,"/"),"/index.m3u8"):e}},{key:"addPreloadParam",value:function(e){return(0,S.isHostTypeIOS)(this.m_uiHostType)&&_.Settings.readBooleanOrDefault("iOSHlsPreload",!0)?"".concat(e,"#t=0.1"):e}},{key:"getHlsOption",value:function(){if(this.isUnplayable())return u.Unplayable;if(!this.isHls())return u.Progressive;if(_.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1)){if(this.tryInitializeHlsJsInstance())return u.HLSjs;if(this.isNativeHlsEnabled())return u.NativeHLS}else{if(this.isNativeHlsEnabled())return u.NativeHLS;if(this.tryInitializeHlsJsInstance())return u.HLSjs}return u.ProgressiveNoHLS}},{key:"isHlsSelected",value:function(){return this.m_hlsOption===u.HLSjs||this.m_hlsOption===u.NativeHLS}},{key:"getTranscodingOption",value:function(){return this.isUnplayable()?d.Unplayable:this.isHlsTranscoding()?this.isHlsSelected()?d.Transcoding:d.RawNoHLS:d.Raw}},{key:"isTranscodingSelected",value:function(){return this.m_transcodingOption===d.Transcoding}},{key:"getTranscodingUrlParam",value:function(){if(!this.isTranscodingSelected())return h.Raw;switch(this.m_transcodingQuality){case o.All:return h.All;case o.LowNoMultivariantMobileBrs:return h.Low;default:return h.Raw}}},{key:"importHlsJsIfNecessaryAsync",value:(t=(0,p.default)(m.default.mark((function t(){var i;return m.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isHls()){t.next=2;break}return t.abrupt("return");case 2:if(!e.s_hlsJs){t.next=4;break}return t.abrupt("return");case 4:if(self.MediaSource||self.WebKitMediaSource){t.next=6;break}return t.abrupt("return");case 6:return i=Date.now(),t.prev=7,t.next=10,r.e(13).then(r.bind(null,210));case 10:e.s_hlsJs=t.sent,T.ULS.sendTraceTag(509436765,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Info,"HLS.js successfully loaded in ".concat(Date.now()-i," ms")),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(7),T.ULS.sendTraceTag(509436764,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,"HLS.js failed to load in ".concat(Date.now()-i," ms exception: ").concat(t.t0," mediaName: ").concat(this.m_mediaName));case 17:case"end":return t.stop()}}),t,this,[[7,14]])}))),function(){return t.apply(this,arguments)})},{key:"tryInitializeHlsJsInstance",value:function(){var t=this;if(this.m_hls)return!0;if(!e.s_hlsJs)return!1;if(!e.s_hlsJs.default.isSupported())return T.ULS.sendTraceTag(512271874,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,"HLS.js is not supported mediaName: ".concat(this.m_mediaName)),!1;var r=!y.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream"),i=this.m_isMobileDevice?_.Settings.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):_.Settings.readNumberOrDefault("hlsBackBufferLength",1/0);return this.m_hls=new e.s_hlsJs.default({progressive:r,backBufferLength:i}),this.m_hls.on(e.s_hlsJs.default.Events.MANIFEST_LOADED,(function(e){t.m_hlsJsManifestLoaded=!0})),this.m_hls.on(e.s_hlsJs.default.Events.FRAG_BUFFERED,(function(e){if(t.m_hls){var r=t.m_hls.bandwidthEstimate;t.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(r),t.m_localMediaPlaybackController.setHlsBandwidthEstimate(r),t.m_localMediaPlaybackTelemetry&&t.m_localMediaPlaybackTelemetry.setHlsBandwidthEstimate(r)}})),this.m_hls.on(e.s_hlsJs.default.Events.ERROR,(function(e,r){t.onHlsJsError(r)})),!0}},{key:"destroyHlsJsInstance",value:function(){this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0)}},{key:"onHlsJsError",value:function(t){var r=this.m_hlsJsManifestLoaded&&this.m_hlsJsAutoRecoverRetryCount<=_.Settings.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2),i={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:c[this.m_playbackOption],hlsOption:u[this.m_hlsOption],transcodingOption:d[this.m_transcodingOption],transcodingUrlParam:h[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:t.fatal,errorType:t.type,errorReason:t.reason,errorDetails:t.details,loadingState:f[this.m_loadingState],wasManifestLoaded:this.m_hlsJsManifestLoaded,isAutorecoveryEnabled:r,autorecoveryRetryCount:this.m_hlsJsAutoRecoverRetryCount},n=t.fatal?T.TraceLevel.Error:T.TraceLevel.Warning;if(T.ULS.sendTraceTag(512271873,T.LogCategory.msoulscat_Wac_PptSession,n,JSON.stringify(i)),t.fatal){if(this.m_localMediaPlaybackController.addHlsError(t.type,t.details),r&&e.s_hlsJs&&this.m_hls)switch(t.type){case e.s_hlsJs.default.ErrorTypes.NETWORK_ERROR:return this.m_hls.startLoad(),void(this.m_hlsJsAutoRecoverRetryCount+=1);case e.s_hlsJs.default.ErrorTypes.MEDIA_ERROR:return this.m_hls.recoverMediaError(),void(this.m_hlsJsAutoRecoverRetryCount+=1)}this.retryLoading()}}},{key:"onError",value:function(){var e=this.m_element.error?this.m_element.error.code:-1,t=this.m_element.error?this.m_element.error.message:"",r={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:c[this.m_playbackOption],hlsOption:u[this.m_hlsOption],transcodingOption:d[this.m_transcodingOption],transcodingUrlParam:h[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:!0,errorCode:e,errorMessage:t,loadingState:f[this.m_loadingState]};T.ULS.sendTraceTag(512271872,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,JSON.stringify(r)),this.m_loadingState<f.LoadStart?T.ULS.sendTraceTag(509436763,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Error,"Unexpected error before loadstart"):this.retryLoading()}},{key:"onCanPlay",value:function(){var e={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:c[this.m_playbackOption],hlsOption:u[this.m_hlsOption],transcodingOption:d[this.m_transcodingOption],transcodingUrlParam:h[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),loadingState:f[this.m_loadingState]};T.ULS.sendTraceTag(509380167,T.LogCategory.msoulscat_Wac_PptSession,T.TraceLevel.Info,JSON.stringify(e))}},{key:"stopRetrying",value:function(){this.m_loadingState=f.StoppedRetrying,this.cancelRetryTimeout(),this.m_onFatalError()}},{key:"retryLoading",value:function(){var e=this;this.m_retriesRemaining<=0?this.stopRetrying():(this.m_retriesRemaining-=1,this.m_loadingState=f.Retrying,this.cancelRetryTimeout(),this.m_retryTimeoutId=window.setTimeout((function(){e.setSourceAsync()}),this.getRetryDelay()))}},{key:"cancelRetryTimeout",value:function(){void 0!==this.m_retryTimeoutId&&(window.clearTimeout(this.m_retryTimeoutId),this.m_retryTimeoutId=void 0)}},{key:"getRetryDelay",value:function(){if(this.getRetryCount()<this.m_playbackOptions.length)return 1;var t=_.Settings.readNumberOrDefault("mediaRetryMultiplier",e.RETRY_DELAY_MULTIPLIER);return this.m_retryDelayMs*=t,this.m_retryDelayMs}},{key:"getInitialRetryCount",value:function(e){var t=e;return this.isHlsTranscodingEnabled()&&(t+=1),this.isHlsRawEnabled()&&(t+=1),t}},{key:"getInitialRetryDelay",value:function(){return _.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",e.RETRY_INITIAL_DELAY_MS)}},{key:"getTranscodingState",value:function(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableTranscode")?n.DisabledUrlParameter:this.m_isOriginalPlayable?_.Settings.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)?n.DisabledOnlyPlayableBrs:_.Settings.readBooleanOrDefault("noMP4Transcoding",!1)&&this.m_isMP4?n.DisabledNoMp4Brs:this.m_originalMediaLength>0&&this.m_originalMediaLength<_.Settings.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!this.m_isMobileDevice?n.DisabledTooSmallForDesktopBrs:n.Enabled:n.EnabledOriginalNotPlayable:n.DisabledNotMediaSnap:n.DisabledNotVideo}},{key:"getHlsState",value:function(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableHLS")?a.DisabledUrlParameter:this.m_isMP4||this.isTranscodingEnabled()?a.Enabled:a.DisabledNotMp4AndNotTranscoding:a.DisabledNotMediaSnap:a.DisabledNotVideo}},{key:"getTranscodingQuality",value:function(){return this.isTranscodingEnabled()?!_.Settings.readBooleanOrDefault("multivariantPlaylistEnabledOnMobile",!1)&&this.m_isMobileDevice?o.LowNoMultivariantMobileBrs:o.All:o.Raw}},{key:"getNativeHlsState",value:function(){if(!this.isHlsEnabled())return s.DisabledNoHls;var e=this.m_element.canPlayType("application/vnd.apple.mpegurl");return"probably"===e?s.EnabledProbably:"maybe"===e?s.EnabledMaybe:s.DisabledNotSupported}},{key:"getHlsRawState",value:function(){return this.isHlsEnabled()?this.m_isOriginalPlayable?this.m_isMP4?l.Enabled:l.DisabledNotMp4:l.DisabledOriginalNotPlayable:l.DisabledNoHls}},{key:"isTranscodingEnabled",value:function(){return this.m_transcodingState===n.EnabledOriginalNotPlayable||this.m_transcodingState===n.Enabled}},{key:"isHlsEnabled",value:function(){return this.m_hlsState===a.Enabled}},{key:"isNativeHlsEnabled",value:function(){return this.m_nativeHlsState===s.EnabledProbably||this.m_nativeHlsState===s.EnabledMaybe}},{key:"isHlsRawEnabled",value:function(){return this.m_hlsRawState===l.Enabled}},{key:"isHlsTranscodingEnabled",value:function(){return this.isHlsEnabled()&&this.isTranscodingEnabled()}},{key:"getRetryCount",value:function(){return this.m_initialRetryCount-this.m_retriesRemaining}},{key:"getPlaybackOption",value:function(){return this.isUnplayable()?c.Unplayable:this.m_playbackOptions[Math.min(this.getRetryCount(),this.m_playbackOptions.length-1)]}},{key:"isHlsTranscoding",value:function(){return this.getPlaybackOption()===c.HLSTranscoding}},{key:"isHlsRaw",value:function(){return this.getPlaybackOption()===c.HLSRaw}},{key:"isHls",value:function(){return this.isHlsTranscoding()||this.isHlsRaw()}}]);var t,i}();t.LocalMediaPlaybackSource=b,b.RETRY_INITIAL_DELAY_MS=600,b.RETRY_DELAY_MULTIPLIER=2},function(e,t,r){var i,n,a=r(170),o=r(171),s=0,l=0;e.exports=function(e,t,r){var c=t&&r||0,u=t||[],d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:n;if(null==d||null==h){var f=a();null==d&&(d=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=n=16383&(f[6]<<8|f[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:l+1,g=m-s+(p-l)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||m>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,l=p,n=h;var v=(1e4*(268435455&(m+=122192928e5))+p)%4294967296;u[c++]=v>>>24&255,u[c++]=v>>>16&255,u[c++]=v>>>8&255,u[c++]=255&v;var y=m/4294967296*1e4&268435455;u[c++]=y>>>8&255,u[c++]=255&y,u[c++]=y>>>24&15|16,u[c++]=y>>>16&255,u[c++]=h>>>8|128,u[c++]=255&h;for(var _=0;_<6;++_)u[c+_]=d[_];return t||o(u)}},function(e,t,r){var i=r(170),n=r(171);e.exports=function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||n(o)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayButtonHandler=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t,r){(0,n.default)(this,e),this.m_mediaPlayButton=t,r?this.setPlayButtonVisible():this.setPlayButtonHidden()}),[{key:"setPlayButtonVisible",value:function(){this.m_mediaPlayButton.style.display="block",this.m_mediaPlayButton.style.pointerEvents="visible"}},{key:"setPlayButtonHidden",value:function(){this.m_mediaPlayButton.style.display="none"}},{key:"isPlayButtonVisible",value:function(){return"none"!==this.m_mediaPlayButton.style.display}}]);t.MediaPlayButtonHandler=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRetryButton=function(){var e=n("svg");e.style.height="".concat(i.PLAYBUTTON_LENGTH.toString(),"px"),e.style.width="".concat(i.PLAYBUTTON_LENGTH.toString(),"px"),e.setAttribute("viewBox","0 0 57 58"),e.style.position="absolute",e.style.zIndex="99",e.style.top="calc(50% - ".concat((i.PLAYBUTTON_LENGTH/2).toString(),"px)"),e.style.left="calc(50% - ".concat((i.PLAYBUTTON_LENGTH/2).toString(),"px)"),e.style.cursor="pointer",e.style.pointerEvents="all";var t=n("path");t.setAttribute("d","M52.977 15.15C60.7919 28.6857 56.1542 45.9937 42.6185 53.8085C29.0828 61.6234 11.7748 56.9857 3.95999 43.45C-3.85483 29.9143 0.782832 12.6063 14.3185 4.79151C27.8542 -3.02332 45.1622 1.61434 52.977 15.15Z"),t.setAttribute("fill","#404040");var r=n("path");return r.setAttribute("d","M40.2575 18.4817L41.7287 18.8673L39.7805 25.7953L32.7936 24.0261L33.2082 22.5516L37.6683 23.6987L37.4485 23.318C36.965 22.4806 36.3926 21.7395 35.7314 21.0949C35.0566 20.4467 34.3244 19.8995 33.5349 19.453C32.7366 19.0115 31.897 18.6786 31.0159 18.4541C30.1262 18.2346 29.2241 18.1239 28.3095 18.1217C27.3863 18.1246 26.4691 18.2481 25.558 18.4922C24.6333 18.7328 23.7418 19.1009 22.8834 19.5965C22.025 20.0921 21.2647 20.6776 20.6027 21.3531C19.9271 22.0252 19.3572 22.7602 18.8931 23.5583C18.429 24.3564 18.0739 25.193 17.8278 26.0683C17.5816 26.9435 17.4501 27.8372 17.4333 28.7492C17.4165 29.6612 17.5244 30.569 17.757 31.4724C17.976 32.3723 18.3272 33.241 18.8108 34.0785C19.2943 34.916 19.8734 35.6588 20.5482 36.3069C21.2094 36.9515 21.9391 37.4946 22.7374 37.9361C23.5356 38.3775 24.3753 38.7105 25.2563 38.935C26.1374 39.1594 27.0395 39.2702 27.9627 39.2673C28.8859 39.2644 29.8099 39.1427 30.7346 38.9021C31.6457 38.658 32.5305 38.2882 33.3889 37.7926C34.386 37.2169 35.2481 36.5274 35.9751 35.7242C36.7021 34.9209 37.2982 34.041 37.7633 33.0845L38.6497 34.6198C38.1196 35.5237 37.4787 36.3561 36.7273 37.1171C35.971 37.8696 35.1072 38.5262 34.1361 39.0868C33.1563 39.6525 32.1404 40.0755 31.0883 40.3558C30.0314 40.6277 28.979 40.7672 27.9311 40.7744C26.8832 40.7816 25.851 40.6557 24.8344 40.3967C23.8178 40.1377 22.8575 39.756 21.9535 39.2515C21.0495 38.747 20.2178 38.1275 19.4584 37.3929C18.6854 36.6548 18.023 35.8079 17.4711 34.852C16.9192 33.8961 16.5194 32.9031 16.2716 31.8732C16.0102 30.8398 15.8871 29.8055 15.9022 28.7704C15.9173 27.7353 16.0668 26.7127 16.3508 25.7028C16.6348 24.6929 17.0419 23.736 17.5721 22.8321C18.1023 21.9282 18.7518 21.0908 19.5206 20.3199C20.2845 19.5405 21.1563 18.8679 22.1361 18.3022C23.1159 17.7365 24.1343 17.3178 25.1912 17.0459C26.2346 16.7706 27.2803 16.6294 28.3281 16.6221C29.376 16.6149 30.4083 16.7408 31.4249 16.9998C32.4415 17.2588 33.4018 17.6406 34.3058 18.1451C35.2098 18.6495 36.0482 19.2708 36.8212 20.0089C37.5806 20.7434 38.2362 21.5887 38.7881 22.5446L39.0079 22.9253L40.2575 18.4817Z"),r.setAttribute("fill","white"),r.setAttribute("opacity",".5"),e.appendChild(t),e.appendChild(r),e};var i=r(54);function n(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MediaRetryButtonHandler=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t){(0,n.default)(this,e),this.m_mediaRetryButton=t}),[{key:"setRetryButtonVisible",value:function(){this.m_mediaRetryButton.style.display="block",this.m_mediaRetryButton.style.pointerEvents="visible"}},{key:"setRetryButtonHidden",value:function(){this.m_mediaRetryButton.style.display="none"}}]);t.MediaRetryButtonHandler=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.VideoFrameTracker=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(4);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=(0,o.default)((function e(t,r){var i=this;(0,a.default)(this,e),this.m_startTime=0,this.m_lastMediaTime=0,this.m_videoFrameCount=0,this.m_isActive=!1,this.m_renderFrameCount=0,this.videoFrameCallback=function(e,t){Math.abs(t.mediaTime-i.m_lastMediaTime)>0&&(i.m_videoFrameCount+=1,i.m_lastMediaTime=t.mediaTime),i.m_isActive&&i.m_videoEl.requestVideoFrameCallback(i.videoFrameCallback)},this.m_videoEl=t,this.m_metadata=r,this.m_metadata.dirtyRectTracking=l.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=l.Settings.readStringOrDefault("hostContainer","undefined")}),[{key:"start",value:function(){this.m_startTime=performance.now(),this.m_renderFrameCount=0,this.m_videoFrameCount=0,this.m_isActive=!0,"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(this.m_lastMediaTime=0,this.m_videoEl.requestVideoFrameCallback(this.videoFrameCallback))}},{key:"stop",value:function(e){var t=performance.now()-this.m_startTime;if(t>0){var r=1e3*this.m_renderFrameCount/t,i=1e3*this.m_videoFrameCount/t,n={Metadata:u(u({},this.m_metadata),e),VideoFrameCount:this.m_videoFrameCount,VideoFrameRate:i.toFixed(2),RenderedFrameCount:this.m_renderFrameCount,RenderFrameRate:r.toFixed(2),Duration:t.toFixed(0),Length:this.m_videoEl.duration};s.ULS.sendTraceTag(512279298,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,JSON.stringify(n))}this.m_isActive=!1}},{key:"updateRenderFrameCount",value:function(){this.m_renderFrameCount+=1}},{key:"isActive",get:function(){return this.m_isActive}}]);t.VideoFrameTracker=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackControlCallbacks=void 0;var n=i(r(1)),a=i(r(2)),o=r(25),s=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.m_mediaSyncEmitter=t,this.m_mediaActionEmitter=r}),[{key:"onPlayClick",value:function(){this.emitEventAndAction(o.MediaEventType.MediaPlayed,o.UserMediaActionType.PlayButtonClick)}},{key:"onPauseClick",value:function(){this.emitEventAndAction(o.MediaEventType.MediaPaused,o.UserMediaActionType.PauseButtonClick)}},{key:"onVolumeClick",value:function(){this.emitEvent(o.MediaEventType.MediaVolumeChanged,o.UserMediaActionType.VolumeButtonClick)}},{key:"onVolumeChanged",value:function(){this.emitEvent(o.MediaEventType.MediaVolumeChanged,o.UserMediaActionType.VolumeSliderInput)}},{key:"onSeeked",value:function(){this.emitEventAndAction(o.MediaEventType.MediaSeeked,o.UserMediaActionType.ProgressSliderInput)}},{key:"emitEvent",value:function(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t)}},{key:"emitEventAndAction",value:function(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t),this.m_mediaActionEmitter&&this.m_mediaActionEmitter(t)}}]);t.PlaybackControlCallbacks=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackControlHelper=void 0;var n=i(r(1)),a=i(r(2)),o=r(25),s=r(3),l=r(14),c=r(54),u=r(4),d=r(49),h=r(11),f=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"getPosition",value:function(e){var t=e.bottom-this.s_videoControlsHeight,r=e.left;return new o.Vector2(r,t)}},{key:"getMediaControlInfo",value:function(e,t,r){return{position:this.getPosition(t),size:{x:t.width,y:this.s_videoControlsHeight},zIndex:2,trimInfo:{trimStartMs:e.props.trimStartMs,trimEndMs:e.props.trimEndMs},cssUrl:this.getCssPath(r),screenReaderInfo:this.getLocalizedStrings(),controlHidingEnabled:u.Settings.readBooleanOrDefault("playbackControlHidingEnabled",!1),widthThresholdForHidingControls:u.Settings.readNumberOrDefault("thresholdForHidingPlaybackControls",275)}}},{key:"getLocalizedStrings",value:function(){return"undefined"!=typeof PowerpointSlideshowStrings?{progressBarStr:PowerpointSlideshowStrings.CustomControlAccessibilityLabelProgressBar,playButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlayButton,pauseButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPauseButton,muteButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMuteButton,unmuteButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelUnmuteButton,volumeSliderStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVolumeSlider,localizedLabelsStr:[PowerpointSlideshowStrings.CustomControlsAccessibilityLabelHour,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelHours,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMinute,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMinutes,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelSecond,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelSeconds],localizedTimeStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVideoTime,progressStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVideoProgress,captionsButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsButton,speedButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlaybackSpeedButton,fullScreenButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelFullScreenButton,captionsMenuStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsMenu,captionsMenuOffOptionStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsMenuOffOption,speedMenuOptionStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlaybackSpeedMenuOption}:{progressBarStr:"Video Progress Bar",playButtonStr:"Video Play",pauseButtonStr:"Video Pause",muteButtonStr:"Video Mute",unmuteButtonStr:"Video Unmute",volumeSliderStr:"Volume Level Slider",localizedLabelsStr:["hour","hours","minute","minutes","second","seconds"],localizedTimeStr:"{0} {1} {2} {3} {4} {5}",progressStr:"{0} of {1}",captionsButtonStr:"Video Closed Captions",speedButtonStr:"Video Playback Speed",fullScreenButtonStr:"Video Full Screen",captionsMenuStr:"Video Closed Captions Menu",captionsMenuOffOptionStr:"Off",speedMenuOptionStr:"{0}x"}}},{key:"getTooltipMap",value:function(){return h.ChangeGate.isChangeGateEnabled("SVM.useLocalizedTooltipStrings")&&"undefined"!=typeof PowerpointSlideshowStrings?new Map([["Play",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelPlay)],["Pause",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelPausePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelPauseAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelPause)],["Mute",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelMutePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelMuteAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelMute)],["Unmute",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmutePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmuteAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmute)],["Captions",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptions)],["Captions disabled",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabledPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabledAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabled)],["Seek",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelSeekPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelSeekAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelSeek)],["Playback speed",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeedPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeedAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeed)],["Volume slider",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSliderPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSliderAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSlider)],["Full screen",new c.Tooltip(PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen,PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen,PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen)]]):new Map([["Play",new c.Tooltip("Play for everyone","Play for me only","Play")],["Pause",new c.Tooltip("Pause for everyone","Pause for me only","Pause")],["Mute",new c.Tooltip("Mute for everyone","Mute for me only","Mute")],["Unmute",new c.Tooltip("Unmute for everyone","Unmute for me only","Unmute")],["Captions",new c.Tooltip("Show closed captions for me only","Show closed captions for me only","Show closed captions")],["Captions disabled",new c.Tooltip("Video does not contain closed captions","Video does not contain closed captions","Video does not contain closed captions")],["Seek",new c.Tooltip("Play from here for everyone","Play from here for me only","Play from here")],["Playback speed",new c.Tooltip("Set playback speed for me only","Set playback speed for me only","Set playback speed")],["Volume slider",new c.Tooltip("Adjust volume for me only","Adjust volume for me only","Adjust volume")],["Full screen",new c.Tooltip("Full screen","Full screen","Full screen")]])}},{key:"getCssPath",value:function(e){return(0,d.getUIHostType)(e)===d.UIHostType.SSCTestApp?"PlaybackControls.css":e.settings.jsScriptsBasePath&&e.settings.applicationLcid?h.ChangeGate.isChangeGateEnabled("SVM.lowercaseUrl")?e.settings.jsScriptsBasePath.replace("pptscripts/ssapp/","pptresources/".concat(e.settings.applicationLcid,"/PlaybackControls.css")):e.settings.jsScriptsBasePath.replace("pptscripts/ssapp/","PptResources/".concat(e.settings.applicationLcid,"/PlaybackControls.css")):(s.ULS.sendTraceTag(509646339,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Warning,"PlaybackControls: Custom controls css path is empty"),l.VetoUtils.recordVeto("CustomControlFailure",{errorName:"NoCssPath",qosVeto:"CustomControlFailure",isIntentional:!0}),"")}}]);t.PlaybackControlHelper=f,f.s_videoControlsHeight=50},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalMediaPlayer=function(e){var t=function(e){var t=e.isTeams;return{App:t?"Teams":"PowerPoint",AppPlatform:t?"Previewer":"WAC",AppCorrelation:e.settings.sessionId,AcceptLanguage:e.settings.acceptLanguage,hostComponent:t?"SlideshowApp":"Unified",hostView:t?"PowerPointLive":"Present"}}(e),r=function(e){var t=e.mediaInfo.props,r={trimStartSec:t.trimStartMs/1e3,trimEndSec:t.trimEndMs/1e3,volume:t.volume,mute:e.mediaInfo.fMutedInFile,repeat:e.mediaInfo.fLooping,rewind:!1,playAcrossSlides:t.playAcrossSlides>0,hideDuringShow:!1,startOption:"",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:t.name,elementId:e.mediaInfo.elID,mediaType:e.type,contentType:t.contentType,autoPlay:!1,crossOrigin:"anonymous",controls:!e.shouldRenderToCanvas&&!e.usePlaybackControls,useCustomControls:e.usePlaybackControls,handleTimeUpdate:t.trimEndMs>0,playsInline:!(e.type!==a.MediaType.Video||!e.isHostIOS)||void 0,zIndex:e.settings.transparentCanvasForVideoEnabled&&e.type===a.MediaType.Video&&!e.shouldRenderToCanvas?"0":"2",height:e.size.y,width:e.size.x,preload:e.isHostIOS?"metadata":"auto",styles:{pointerEvents:"auto",position:"absolute",objectFit:"fill",opacity:e.shouldRenderToCanvas?"0":void 0},attributes:{"aria-label":e.mediaInfo.props.ariaLabel,controlsList:"nodownload",disablePictureInPicture:"true"}};if(e.settings.transparentCanvasForVideoEnabled||s.Settings.readBooleanOrDefault("forceSvg",!1)||(r.zIndex="4"),r.styles){if(e.type===a.MediaType.Video&&e.isCropInSVGEnabled&&t.cropInfo){r.styles.clipPath="inset(".concat(100*t.cropInfo.top,"% ").concat(100*(1-t.cropInfo.right),"% ").concat(100*(1-t.cropInfo.bottom),"% ").concat(100*t.cropInfo.left,"%)");var i=1/(t.cropInfo.right-t.cropInfo.left),n=1/(t.cropInfo.bottom-t.cropInfo.top);r.styles.transform="translate(".concat((1-t.cropInfo.right-t.cropInfo.left)*i*100/2,"%, ").concat((1-t.cropInfo.bottom-t.cropInfo.top)*n*100/2,"%) scale(").concat(i,", ").concat(n,")")}s.Settings.readBooleanOrDefault("forceSvg",!1)||(r.styles.left="".concat(e.position.x,"px"),r.styles.top="".concat(e.position.y,"px")),e.type==a.MediaType.Audio&&(r.styles.visibility=t.hideWhenStopped?"hidden":"visible",r.styles.width="".concat(e.size.x,"px"),r.styles.height="".concat(e.size.y,"px"),e.settings.editAudioEnabled&&(e.size.x<240&&(r.styles.width="".concat(240,"px")),e.size.y<30&&(r.styles.height="".concat(30,"px"))))}return r.attributes&&e.type===a.MediaType.Audio&&(r.attributes.role="link",r.attributes["aria-role"]="link"),r}(e),l=new i.LocalMediaPlayer(e.mediaInfo.mediaUrl,void 0,!1,t,r,e.onMediaEventCallbacks,(function(t){n.ULS.sendTraceTag(508380035,n.LogCategory.msoulscat_Wac_PptSession,n.TraceLevel.Error,"Local media sent veto: ".concat(JSON.stringify({vetoName:t.vetoName,errorName:t.errorName,details:t.details,correlationId:t.correlationId,mediaType:a.MediaType[e.type],mediaName:e.mediaInfo.props.name,uiHostType:e.uiHostType,teamsCallId:e.settings.teamsCallId})))}));if(l){n.ULS.sendTraceTag(508372962,n.LogCategory.msoulscat_Wac_PptSession,n.TraceLevel.Info,"Created LocalMediaPlayer.  Media name: ".concat(e.mediaInfo.props.name));var c={hlsJsFirst:s.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1),useLoadedMetadata:s.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0),iOSPreload:s.Settings.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:s.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:s.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};l.setFlights(JSON.stringify(c)),l.setUiHostType(e.uiHostType),0===e.mediaInfo.props.volume?l.setMute():(!o.ChangeGate.isChangeGateEnabled("SVM.disableSetIOSVolumeMax")&&e.isHostIOS&&(e.mediaInfo.props.volume=1),l.setVolume(e.mediaInfo.props.volume))}else n.ULS.sendTraceTag(508372961,n.LogCategory.msoulscat_Wac_PptSession,n.TraceLevel.Error,"Failed to create LocalMediaPlayer. Media name: ".concat(e.mediaInfo.props.name));return l};var i=r(54),n=r(3),a=r(25),o=r(11),s=r(4)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalMediaPlaybackTelemetry=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(4),c=r(49),u=r(11),d=r(169);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(){function e(t,r,i,n,o,s){(0,a.default)(this,e),this.isOnSlide=!1,this.mediaName=t.name,this.m_onSetSource=n,this.summary={isAutoPlay:t.autoPlay||void 0,slideNumber:r.viewDataManager.getSlideIndex(i),startFromTime:r.settings.startFromTime,fullscreen:t.fullscreen,hideWhenStopped:t.hideWhenStopped,playAcrossSlides:t.playAcrossSlides,isSVG:l.Settings.readBooleanOrDefault("forceSvg",!1),isPrefetch:o,isNarration:t.narration,navigationCount:0,isTeams:(0,c.isTeams)(r),isTeamsWeb:(0,c.isTeamsWeb)(r),teamsCallId:r.settings.teamsCallId,isWebGL:s}}return(0,o.default)(e,[{key:"onNavigatedTo",value:function(){this.isOnSlide?s.ULS.sendTraceTag(508355586,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"Already on slide with local media (name: ".concat(this.mediaName,")")):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,e.sendNavigatedTo&&(e.sendNavigatedTo=!1,s.ULS.sendTraceTag(508355585,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"Navigated to a slide with local media (name: ".concat(this.mediaName,")"))))}},{key:"onNavigatingFrom",value:function(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),s.ULS.sendTraceTag(508355554,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(f(f({},this.summary),e)))),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0):s.ULS.sendTraceTag(508355555,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"No local video playback data was collected for local media (name: ".concat(this.mediaName,")")):s.ULS.sendTraceTag(508355584,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"Not on slide with local media (name: ".concat(this.mediaName,") yet"))}},{key:"onSourceSet",value:function(e){var t=new URL(e).searchParams.get("docId");null!==t&&u.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=(0,d.simpleHash)(t).toString()),this.m_onSetSource(e)}},{key:"setInClickSequence",value:function(){this.summary.isInClickSequence=!0,s.ULS.sendTraceTag(508355553,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"Playback started through animation for local media (name: ".concat(this.mediaName,")"))}},{key:"setDocIdHash",value:function(e){this.summary.docIdHash=e}},{key:"setHlsBandwidthEstimate",value:function(e){this.summary.hlsBandwidthEstimate=e}},{key:"setHlsAndTranscoding",value:function(e,t){e&&t&&void 0===this.summary.timeOfHlsTranscoding?this.summary.timeOfHlsTranscoding=Date.now():e&&!t&&void 0===this.summary.timeOfHlsRaw?this.summary.timeOfHlsRaw=Date.now():e||t||void 0!==this.summary.timeOfProgressiveRaw||(this.summary.timeOfProgressiveRaw=Date.now())}}])}();t.LocalMediaPlaybackTelemetry=m,m.sendNavigatedTo=!0},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineVideoPlaybackTelemetry=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(49);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(){function e(t,r,i){(0,a.default)(this,e),this.isOnSlide=!1,this.mediaName=t.name,this.summary={slideNumber:r.viewDataManager.getSlideIndex(i),isAutoPlay:t.autoPlay||void 0,isTeams:(0,l.isTeams)(r)||void 0,isTeamsWeb:(0,l.isTeamsWeb)(r)||void 0,teamsCallId:r.settings.teamsCallId,navigationCount:0}}return(0,o.default)(e,[{key:"onNavigatedTo",value:function(){this.isOnSlide?s.ULS.sendTraceTag(508348034,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"Already on slide with online video (name: ".concat(this.mediaName,")")):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,e.sendNavigatedTo&&(e.sendNavigatedTo=!1,s.ULS.sendTraceTag(508348033,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"Navigated to a slide with an online video (name: ".concat(this.mediaName,")"))))}},{key:"onNavigatingFrom",value:function(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),s.ULS.sendTraceTag(508348002,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"NavigatingFrom ".concat(JSON.stringify(u(u({},this.summary),e)))),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0,this.summary.wasMediaSyncedOnReady=void 0):s.ULS.sendTraceTag(508348003,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"No online video performance data was collected (name: ".concat(this.mediaName,")")):s.ULS.sendTraceTag(508348032,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"Not on slide with online video (name: ".concat(this.mediaName,") yet"))}},{key:"setInClickSequence",value:function(){this.summary.isInClickSequence=!0,s.ULS.sendTraceTag(508348001,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"Online video playback started through animation (name: ".concat(this.mediaName,")"))}},{key:"setMediaSyncedOnReady",value:function(){this.summary.wasMediaSyncedOnReady=!0,s.ULS.sendTraceTag(508348e3,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"Online video synced to Media Sync state on ready (name: ".concat(this.mediaName,")"))}}])}();t.OnlineVideoPlaybackTelemetry=d,d.sendNavigatedTo=!0},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.GifViewElement=t.GifMode=void 0;var n,a=i(r(5)),o=i(r(1)),s=i(r(2)),l=r(14),c=r(3),u=r(20),d=r(168),h=r(49),f=r(58),m=r(42),p=r(35),g=r(25);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.GifMode=n,function(e){e[e.ShowAsImageEl=0]="ShowAsImageEl",e[e.ShowAsVideoEl=1]="ShowAsVideoEl",e[e.FramesToCanvas=2]="FramesToCanvas"}(n||(t.GifMode=n={}));var T=function(){function e(t,r,i,a,s,l){var u=this;if((0,o.default)(this,e),this.shapeType=g.ShapeType.GIF,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fLoadedPoster=!1,this.m_fInSlideTransition=!1,this.m_videoRequestGuid=(0,f.v4)(),this.m_imageRequestGuid=(0,f.v4)(),this.id=t.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=r,this.m_environment=s,this.m_pixelScale=s.rendererEnvironment.clientSize.scale(window.devicePixelRatio).divide(l),!r.gif)throw c.ULS.sendTraceTag(592531609,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement:: Invalid shapeViewData. gif:".concat(!!r.gif,",\n        animatableContents.length:").concat(this.m_shapeViewData.animatableContents.length,",\n        parts.length:").concat(this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0,".")),new Error("Invalid gif");var d=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_gifInfo={elID:"".concat("gif-element","-").concat(JSON.stringify(this.id)),size:new g.Vector2(d.region.rect.right-d.region.rect.left,d.region.rect.bottom-d.region.rect.top),position:new g.Vector2(d.pos.x,d.pos.y),retriesRemaining:e.s_downloadMaxRetryCount,retryTimeoutMs:e.s_downloadInitialRetryDelayMs,mode:n.ShowAsImageEl,props:r.gif};var h=decodeURIComponent(s.settings.serverUrl);"/"===h.slice(-1)&&(h=h.slice(0,-1)),this.m_gifInfo.props.imageUrl&&(this.m_gifInfo.mode=n.ShowAsImageEl,this.m_gifInfo.props.imageUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.imageUrl="".concat(h).concat(this.m_gifInfo.props.imageUrl.substring(1)))),this.m_gifInfo.props.videoUrl&&(this.m_gifInfo.mode=n.FramesToCanvas,this.m_gifInfo.props.videoUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.videoUrl="".concat(h).concat(this.m_gifInfo.props.videoUrl.substring(1)))),this.m_slideEvents=a,this.m_slideEvents.on("navigatingTo",(function(){return u.onNavigatingTo()})),this.m_slideEvents.on("navigatingFrom",(function(){return u.onNavigatingFrom()})),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",(function(){return u.onBeforeFirstRenderAfterNavigation()})),this.loadPoster(!1),c.ULS.sendTraceTag(578863264,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"GifViewElement ctor: ".concat(JSON.stringify(e.getGifInfoLog(this.m_gifInfo,"GifViewElement::ctor"))))}return(0,s.default)(e,[{key:"ensure",value:function(){this.m_shapeItem||this.init();var e={};if(!this.m_shapeItem)return c.ULS.sendTraceTag(592531610,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;var t=m.ShapeViewElementUtils.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return S(S({},e),t)}},{key:"init",value:function(){var e=this;this.animatableContentViewElements=[],this.m_shapeItem=m.ShapeViewElementUtils.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_gifInfo?this.m_gifInfo.mode===n.ShowAsImageEl?(this.initImageEl(this.m_gifInfo),this.m_gifInfo.imageEl.addEventListener("load",(function(){return e.onMediaLoaded()}))):(this.initVideoEl(this.m_gifInfo),this.m_gifInfo.videoEl.addEventListener("load",(function(){return e.onMediaLoaded()}))):c.ULS.sendTraceTag(578863265,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::init: invalid gifInfo.")}},{key:"initImageEl",value:function(e){var t=this,r=document.createElement("img");r.id=e.elID,r.width=e.size.x,r.height=e.size.y,r.style.left="".concat(e.position.x,"px"),r.style.top="".concat(e.position.y,"px"),r.style.position="absolute",r.style.pointerEvents="none",r.style.zIndex="4",e.props.imageUrl?(r.addEventListener("error",(function(){return t.onImageError(e)})),r.src=this.getRetryUrl(e.props.imageUrl,e.retriesRemaining,!1)):r.src=e.props.src,e.imageEl=r}},{key:"initVideoEl",value:function(e){var t=this,r=document.createElement("video");r.id=e.elID,r.width=e.size.x,r.height=e.size.y,r.style.left="".concat(e.position.x,"px"),r.style.top="".concat(e.position.y,"px"),r.style.position="absolute",r.style.pointerEvents="none",r.style.zIndex="4",r.crossOrigin="anonymous",r.autoplay=!0,r.controls=!1,r.loop=!0,r.muted=!0,r.playsInline=!0,c.ULS.sendTraceTag(545645913,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"GifViewElement::initVideoEl: Set playsInline flag to true"),e.props.videoUrl?(r.addEventListener("error",(function(){return t.onVideoError(e)})),r.src=this.getRetryUrl(e.props.videoUrl,e.retriesRemaining,!0)):r.src=e.props.src,e.videoEl=r,this.initLocalMediaPlaybackPerf()}},{key:"initLocalMediaPlaybackPerf",value:function(){if(!this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf=new d.LocalMediaPlaybackPerf(this.m_gifInfo.videoEl,this.m_pixelScale,this.m_slideEvents,(0,h.getUIHostType)(this.m_environment),null,null,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,this.m_gifInfo,e.s_downloadMaxRetryCount,!1,this.m_environment.settings.teamsCallId)}catch(e){c.ULS.sendTraceTag(526989327,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::initVideoEl Failed to construct LocalVideoPlaybackPerf ".concat(e))}if(this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf.onSourceSet(this.m_gifInfo.videoEl.src)}catch(e){c.ULS.sendTraceTag(526989328,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: ".concat(e))}}},{key:"update",value:function(){if(this.m_gifInfo){var t=this.m_gifInfo.mode,r=!1;if(this.m_gifInfo.videoEl&&(t===n.ShowAsVideoEl||t===n.FramesToCanvas)){r=e.isVideoLoaded(this.m_gifInfo.videoEl);var i=e.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.videoEl,this.id,r);i&&r&&(i.style.left="".concat(this.m_gifInfo.position.x,"px"),i.style.top="".concat(this.m_gifInfo.position.y,"px"),i.width=this.m_gifInfo.size.x,i.height=this.m_gifInfo.size.y,i.hidden=t===n.FramesToCanvas,i.paused&&i.play(),i.hidden?this.drawFrame(this.m_gifInfo.videoEl):this.m_fInSlideTransition||this.unloadPoster(),this.m_gifInfo.imageEl=void 0)}if(this.m_gifInfo.imageEl&&(t===n.ShowAsImageEl||!r)){r=e.isImageLoaded(this.m_gifInfo.imageEl);var a=e.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.imageEl,this.id,r);a&&r&&(a.style.left="".concat(this.m_gifInfo.position.x,"px"),a.style.top="".concat(this.m_gifInfo.position.y,"px"),a.width=this.m_gifInfo.size.x,a.height=this.m_gifInfo.size.y,this.m_fInSlideTransition||this.unloadPoster())}r||this.m_fLoadedPoster||this.loadPoster(!0),m.ShapeViewElementUtils.ensureAccessibilityElement(this.id)}}},{key:"loadPoster",value:function(t){var r=this;this.m_posterImage&&this.m_posterImage.src?t&&e.isImageLoaded(this.m_posterImage)&&(this.drawFrame(this.m_posterImage),this.m_fLoadedPoster=!0):this.m_gifInfo&&this.m_gifInfo.props.src.startsWith("data")&&(this.m_posterImage=new Image,t&&(this.m_posterImage.onload=function(){r.drawFrame(r.m_posterImage),r.m_fLoadedPoster=!0}),this.m_posterImage.src=this.m_gifInfo.props.src)}},{key:"unloadPoster",value:function(){if(this.m_shapeItem){var e,t=v(this.m_shapeItem.getBrushImages());try{for(t.s();!(e=t.n()).done;){var r=e.value;r.id&&(r.releaseGeneratedResources(),this.m_fLoadedPoster=!1)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"drawFrame",value:function(e){var t=this.m_environment.rendererEnvironment.glContext;if(t&&!t.isContextLost()){var r=this.m_gifTexture?this.m_gifTexture.tryGetWebGLTexture():void 0;if(!this.m_gifTexture||!r){this.m_gifTexture&&this.cleanUp();var i=new g.Vector2(this.m_gifInfo.size.x,this.m_gifInfo.size.y);m.ShapeViewElementUtils.verifyTextureSize(this.m_environment,"gif",i);var n=new u.TargetTexture("Gif",this.m_environment.rendererEnvironment.renderer,i,u.TextureReleasePolicy.KeepUntilRelease);if(r=n.tryGetWebGLTexture(),this.m_environment.viewDataManager.memoryStats.gifTextures+=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4,!r)return void c.ULS.sendTraceTag(590976993,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::drawFrame: failed to create gif target texture.");this.m_gifTexture=n}if(this.m_shapeItem){t.bindTexture(t.TEXTURE_2D,r),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null);var a,o=v(this.m_shapeItem.getBrushImages());try{for(o.s();!(a=o.n()).done;){var s=a.value;s.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(s,this.m_gifTexture),this.m_gifTexture.changeTracker.notifyChange())}}catch(e){o.e(e)}finally{o.f()}}else c.ULS.sendTraceTag(590976994,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::drawFrame: ShapeItem:".concat(!!this.m_shapeItem))}else c.ULS.sendTraceTag(590976991,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::drawFrame: missing glContext.")}},{key:"applyAnimation",value:function(e){this.m_shapeItem&&m.ShapeViewElementUtils.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}},{key:"addToScene",value:function(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}},{key:"removeFromScene",value:function(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&m.ShapeViewElementUtils.removeFromScene(e,this.m_shapeItem)}},{key:"tryPrepare",value:function(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}},{key:"cleanUp",value:function(){var e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_gifTexture&&(this.m_gifTexture.release(),this.m_environment.viewDataManager.memoryStats.gifTextures-=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4),this.m_gifTexture=void 0}},{key:"shapeItem",get:function(){return this.m_shapeItem}},{key:"onNavigatingTo",value:function(){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onNavigatingTo(),this.m_fInSlideTransition=!0,this.m_gifInfo&&(this.m_gifInfo.mode===n.FramesToCanvas&&e.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0),e.isVideoLoaded(this.m_gifInfo.videoEl)&&(this.m_gifInfo.videoEl.currentTime=0))}},{key:"onNavigatingFrom",value:function(){this.m_fInSlideTransition=!0,this.m_gifInfo&&(this.m_gifInfo.mode===n.FramesToCanvas&&e.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0))}},{key:"onBeforeFirstRenderAfterNavigation",value:function(){this.m_fInSlideTransition=!1}},{key:"onMediaLoaded",value:function(){this.m_gifInfo&&(this.m_gifInfo.mode!==n.FramesToCanvas&&this.update(),c.ULS.sendTraceTag(543474187,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"MediaLoaded: ".concat(JSON.stringify(e.getGifInfoLog(this.m_gifInfo,"GifViewElement::onMediaLoaded")))))}},{key:"onImageError",value:function(t){var r=this,i=t.imageEl;i?t.retriesRemaining<=0?l.VetoUtils.recordVeto("GIFFailure",S({errorName:"GIFAsImageRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:"".concat(this.id.slideId.sid,"s").concat(this.id.shapeId),requestGuid:this.m_imageRequestGuid},e.getGifInfoLog(t,"GIFAsImageRetryFailed"))):window.setTimeout((function(){!e.isImageLoaded(i)&&t.props.imageUrl&&(t.mode===n.ShowAsImageEl&&(t.retriesRemaining-=1,t.retryTimeoutMs*=2),i.src=r.getRetryUrl(t.props.imageUrl,t.retriesRemaining,!1))}),t.retryTimeoutMs):c.ULS.sendTraceTag(575160839,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::onImageError: ".concat(JSON.stringify(e.getGifInfoLog(t,"Invalid gif element."))))}},{key:"onVideoError",value:function(t){var r=this,i=t.videoEl;if(i){var a=e.getGifInfoLog(t,"GIFAsVideoRetryFailed"),o={errCode:i.error?i.error.code:"unknown",errMessage:i.error?i.error.message:"unknown",canPlayType:i.canPlayType(a.type),fallbackLoaded:e.isImageLoaded(t.imageEl)};if(a.err=o,c.ULS.sendTraceTag(590977024,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"GifViewElement::onVideoError: ".concat(JSON.stringify(a))),t.retriesRemaining<=0)o.fallbackLoaded?l.VetoUtils.recordVeto("GIFFallbackToImage",{qosVeto:"ContentFallback"}):l.VetoUtils.recordVeto("GIFFailure",S({errorName:"GIFAsVideoRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:"".concat(this.id.slideId.sid,"s").concat(this.id.shapeId),requestGuid:this.m_videoRequestGuid},a));else{if(!o.canPlayType)return t.mode=n.ShowAsImageEl,void this.initImageEl(t);t.retriesRemaining!==e.s_downloadGifFallbackInRetry||o.fallbackLoaded||this.initImageEl(t),window.setTimeout((function(){!e.isVideoLoaded(t.videoEl)&&t.props.videoUrl&&(t.retriesRemaining-=1,t.retryTimeoutMs*=2,t.videoEl.src=r.getRetryUrl(t.props.videoUrl,t.retriesRemaining,!0),r.m_localMediaPlaybackPerf&&t.videoEl&&t.videoEl.src&&r.m_localMediaPlaybackPerf.onSourceSet(t.videoEl.src))}),t.retryTimeoutMs)}}else c.ULS.sendTraceTag(575160840,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::onVideoError: ".concat(JSON.stringify(e.getGifInfoLog(t,"Invalid gif element"))))}},{key:"getRetryUrl",value:function(e,t,r){var i=new URL(e);i.searchParams.append("retries",t.toString());var n="".concat(this.id.slideId.sid,"s").concat(this.id.shapeId);return i.searchParams.append("mediaName",n),i.searchParams.set("usid",this.m_environment.settings.sessionId),i.searchParams.append("requestGuid",r?this.m_videoRequestGuid:this.m_imageRequestGuid),i.toString()}}],[{key:"ensureDOMElement",value:function(e,t,r,i){var n=document.getElementById(e);if(!n||n!==t){if(!document.getElementById(p.ViewController.SlideLevelHtmlElementsParentDivId))return c.ULS.sendTraceTag(592531611,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"GifViewElement::ensureDOMElement: couldn't find ".concat(p.ViewController.SlideLevelHtmlElementsParentDivId,".")),null;var a=m.ShapeViewElementUtils.ensureShapeViewElementParentDiv(r,"2");i&&(n=n?a.replaceChild(t,n):a.appendChild(t))}return n}},{key:"isImageLoaded",value:function(e){return!!e&&e.complete&&0!==e.naturalWidth&&0!==e.naturalHeight}},{key:"isVideoLoaded",value:function(e){return!!e&&e.readyState>=3}},{key:"getGifInfoLog",value:function(e,t){var r=["",""];try{var i=e.mode===n.ShowAsImageEl?e.props.imageUrl:e.props.videoUrl,a=new URL(i||"").searchParams.get("mediaId")||"",o=new RegExp(/^(\w+).(\w+).media$/i).exec(a);if(o&&3===o.length){var s=e.mode===n.ShowAsImageEl?"image":"video";r=[o[1],"".concat(s,"/").concat(o[2]).toLowerCase()]}}catch(e){r=["err","err"]}return{elId:e.elID,mediaId:r[0],type:r[1],mode:e.mode,src:e.props.src.split(";",1)[0],retry:e.retriesRemaining,msg:t}}}])}();t.GifViewElement=T,T.s_downloadMaxRetryCount=5,T.s_downloadGifFallbackInRetry=3,T.s_downloadInitialRetryDelayMs=800},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.AddinViewElement=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=r(35),l=r(25),c=r(3),u=r(42);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=(0,o.default)((function e(t,r,i,n){if((0,a.default)(this,e),this.shapeType=l.ShapeType.Addin,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=t.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=r,this.m_environment=n,!r.appForOffice)throw c.ULS.sendTraceTag(554260320,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"AddinViewElement:: Invalid shapeViewData. Addin:".concat(!!r.appForOffice,", animatableContents.length:").concat(this.m_shapeViewData.animatableContents.length,", parts.length:").concat(this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0,".")),new Error("Invalid Addin");this.m_appForOffice=r.appForOffice,this.m_appForOfficeTheme=r.appForOfficeTheme,this.ShapeAddinTargetId="addin-element-".concat(JSON.stringify(this.id))}),[{key:"ensure",value:function(){var e={addinInfo:{instanceId:this.m_appForOffice.InstanceId,solutionId:this.m_appForOffice.AppForOfficeRef.Id,storeId:this.m_appForOffice.AppForOfficeRef.Store,storeType:this.m_appForOffice.AppForOfficeRef.StoreType}};if(!this.m_shapeItem){var t=this.init();e=h(h({},e),t)}if(!this.m_shapeItem)return c.ULS.sendTraceTag(554260321,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"AddinViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;var r=u.ShapeViewElementUtils.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return h(h({},e),r)}},{key:"init",value:function(){var e={showAppForOffice:{start:s.ViewController.performanceNowTrimmed(),end:s.ViewController.performanceNowTrimmed()}};if(this.animatableContentViewElements=[],this.m_shapeItem=u.ShapeViewElementUtils.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_environment.addinManager){this.m_addinElement=this.ensureAddinElementDiv();var t=this.m_environment.addinManager.showAppForOffice(this.m_addinElement,this.m_slideId,this.m_appForOffice,this.m_appForOfficeTheme);e.showAppForOffice=t}return e}},{key:"update",value:function(){this.m_environment.addinManager&&this.m_addinElement&&(u.ShapeViewElementUtils.ensureShapeViewElementParentDiv(this.id,"2").appendChild(this.m_addinElement),this.m_environment.addinManager.updateAppForOfficeLayout(this.m_addinElement,this.m_appForOffice),this.shapeItem&&(this.shapeItem.isHidden=!0)),u.ShapeViewElementUtils.ensureAccessibilityElement(this.id)}},{key:"ensureAddinElementDiv",value:function(){var e=document.getElementById(this.ShapeAddinTargetId);if(e)return e;(e=document.createElement("div")).id=this.ShapeAddinTargetId;var t=document.getElementById(s.ViewController.PreactivedAddinsDivId);return t&&t.appendChild(e),e}},{key:"applyAnimation",value:function(e){}},{key:"addToScene",value:function(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}},{key:"removeFromScene",value:function(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&u.ShapeViewElementUtils.removeFromScene(e,this.m_shapeItem)}},{key:"tryPrepare",value:function(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,10),this.m_environment.rendererEnvironment.flush()),this.fPrepared}},{key:"cleanUp",value:function(){}},{key:"shapeItem",get:function(){return this.m_shapeItem}}]);t.AddinViewElement=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tp_8=t.tp_1=t.tp_4=t.tp_3=t.tp_2=t.tp_9=t.tp_7=t.tp_6=t.tp_5=t.tp_0=void 0,t.tp_0={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float f=clamp(uFactor*(uProgress-aDelay),0.0,1.0);f=1.0-0.5*(1.0+cos(f*PI));gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);d=aTexcoord;c=vec4(f);}",f:"precision mediump float;uniform float uStyle;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;float e(float x,float y){return 1.0-abs(sign(x-y));}void main(void){gl_FragColor=e(uStyle,1.0)*mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a)+e(uStyle,2.0)*(texture2D(uSampler1,d)*c.a);}"},t.tp_5={v:"uniform mat4 uModelViewProj;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAngle;uniform float uXAxis;uniform float uBack;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uAngle-aDelay),0.0,PI);l+=uBack;float m=sin(l*uDirection);float n=cos(l*uDirection);vec4 o;o.xy=aPosition.xy-aCenter;o.z=0.0;o.xyz=(uXAxis > 0.0)? f(m,n,o.xyz): k(m,n,o.xyz);o.xyz+=vec3(0,0,m*uZmovement)+vec3(aCenter.x,aCenter.y,0.0);o.w=1.0;gl_Position=uModelViewProj*o;d=aTexcoord;float p=max(0.0,n);c.rgb=vec3(clamp(p+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_6={v:"attribute vec3 aPosition;attribute vec3 aNormal;attribute vec2 aTexCoord;uniform mat4 uModelToView;uniform mat4 uModelToWorld;uniform mat4 uModelToWorldIT;uniform vec3 uLightPosition;uniform vec3 uEyePosition;uniform vec3 uAmbientColor;uniform vec4 uDiffuseColor;uniform bool uIsNormalDirectionChangeReq;varying vec4 c;varying vec2 d;void main(void){gl_Position=uModelToView*vec4(aPosition,1.0);d=aTexCoord;vec3 e=(uModelToWorld*vec4(aPosition,1.0)).xyz;vec3 f=normalize(uLightPosition-e);vec3 h=(uIsNormalDirectionChangeReq && aNormal.z < 0.0)? aNormal*vec3(-1,-1,-1): aNormal;vec3 i=normalize(uModelToWorldIT*vec4(h,0.0)).xyz;float j=max(0.0,dot(i,f));c.rgb=j*uDiffuseColor.rgb+uAmbientColor;c.a=uDiffuseColor.a;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,vec2(1.0,1.0)-d)*c;}"},t.tp_7={v:"attribute vec2 aPosition;attribute vec3 aCenter;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform float uProgress;uniform float opacity;uniform float style;uniform bool isX;varying vec4 c;varying vec2 d;varying vec2 e;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}vec3 f(float h,float i,vec2 j){return vec3(j.x,i*j.y,h*j.y);}vec3 k(float h,float i,vec2 j){return vec3(i*j.x,j.y,-h*j.x);}void main(void){highp vec4 l=vec4(aPosition,0.0,1.0);if(style==1.0){mediump float m=uProgress;mediump float n,o;l.xyz=l.xyz-aCenter;l.w=1.0;if(! isX){if(aCenter.x < 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=k(n,o,l.xy)+aCenter;l.z=l.z-uProgress/6.0;l.x=l.x+m/2.0;}else{if(aCenter.y > 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=f(n,o,l.xy)+aCenter;l.z=l.z-uProgress/4.0;l.y=l.y-m/1.5;}}else if(style==2.0){mediump float p=uProgress;if(aCenter.z < 0.0)p=-p;l.z+=p;}l=l*offsetMatrix;gl_Position=uModelViewProj*l;d=aTexcoord;e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}"},t.tp_9={v:"attribute vec2 aPosition;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform mat4 dirMatrix;uniform float opacity;uniform bool isInvX;varying vec4 c;varying vec2 d;varying vec2 e;void main(void){highp vec4 f=vec4(aPosition,0.0,1.0);f=f*dirMatrix;f.y=f.y-0.5;f=f*offsetMatrix;gl_Position=uModelViewProj*f;d=vec2(isInvX ? 1.0-aTexcoord.x : aTexcoord.x,aTexcoord.y);e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}"},t.tp_2={v:"uniform mat4 uModelViewProj;attribute vec2 aPosition;attribute vec2 aTexcoord;varying vec2 c;void main(void){gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);c=aTexcoord;}",f:"precision mediump float;varying vec2 c;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,c);}"},t.tp_3={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAnglePlus;uniform float uMaxAngle;uniform float uZCenter;uniform float uXAxis;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uProgress-aDelay),0.0,uMaxAngle);l=(1.0-cos(l*PI/uMaxAngle))/2.0*uMaxAngle;float m=(sin((PI-uMaxAngle)/2.0+l)-sin((PI-uMaxAngle)/2.0))*uZmovement;l+=uAnglePlus;float n=sin(l*uDirection);float o=cos(l*uDirection);vec3 p=vec3(aCenter.x,aCenter.y,uZCenter);vec4 q;q.xyz=aPosition.xyz-p;q.xyz=(uXAxis > 0.0)? f(n,o,q.xyz): k(n,o,q.xyz);q.xyz+=vec3(0,0,m)+p;q.w=1.0;gl_Position=uModelViewProj*q;d=aTexcoord;float s=max(0.0,o);c.rgb=vec3(clamp(s+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_4={v:"uniform mat4 uModelViewProj;uniform vec2 uProgress;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDistance;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float e=6.0;float f=0.025;float h=0.3;float i=0.7;float j=(1.0-uProgress.y);float k=(aDistance-uProgress.x)*e+PI/2.0;vec4 l=vec4(aPosition,0.0,1.0);l.z=j*sin(k)*f;if(aDistance > uProgress.x){l.z=0.0;}l=uModelViewProj*l;float m=j*cos(k)*h;if(aDistance > uProgress.x)m=0.0;float n=max(0.0,m);gl_Position=l;d=aTexcoord;float o=clamp((uProgress.x-aDistance)/i,0.0,1.0);float rgb=1.0-n;c=vec4(rgb,rgb,rgb,o);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a);gl_FragColor.rgb*=c.rgb;}"},t.tp_1={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uOpacity;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute vec2 aDirection;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){vec4 e;float f=uProgress-aDelay;if(f < 0.0){f=0.0;}else{f*=uFactor;f*=f/2.0;}e.xy=aPosition.xy+f*aDirection;e.z=0.0;e.w=1.0;gl_Position=uModelViewProj*e;d=aTexcoord;c=vec4(uOpacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_8={v:"attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;uniform mat4 uModelViewProj;uniform float uTime;uniform float uSpinFactor;uniform float uFactor;uniform float uReverseAngle;uniform float uGrowFactor;uniform float uOpacitySpeed;varying vec4 c;varying vec2 d;vec3 e(float f,float h,vec3 i){return vec3(h*i.x-f*i.y*9.0/16.0,f*i.x*16.0/9.0+h*i.y,i.z);}void main(){float j=clamp(uTime-aDelay,0.0,1.0);mediump float k=uSpinFactor*j*uFactor*uReverseAngle;float l,m;l=sin(k);m=cos(k);highp vec4 n;n.xy=aPosition.xy-aCenter;n.xy*=1.0+j*uGrowFactor;n.z=0.0;n.y=n.y;n.xyz=e(l,m,n.xyz)+vec3(aCenter,0.0);n.w=1.0;gl_Position=uModelViewProj*n;d=aTexcoord;if(uOpacitySpeed==0.0)c=vec4(1.0);else c=vec4(1.0-pow(j,uOpacitySpeed));}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,d)*c;}"}},function(e,t,r){"use strict";var i=r(62);i.ThinEngine.prototype.updateDynamicIndexBuffer=function(e,t){var r;this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),r=e.is32Bits?t instanceof Uint32Array?t:new Uint32Array(t):t instanceof Uint16Array?t:new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,r,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},i.ThinEngine.prototype.updateDynamicVertexBuffer=function(e,t,r,i){this.bindArrayBuffer(e),void 0===r&&(r=0);var n=t.byteLength||t.length;void 0===i||i>=n&&0===r?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,r,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,r,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(r,r+i)):(t=t instanceof ArrayBuffer?new Uint8Array(t,r,i):new Uint8Array(t.buffer,t.byteOffset+r,i),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyEngineExtensions=function(){void 0===i.ThinEngine.prototype.clearToBlack&&(i.ThinEngine.prototype.isContextLost=function(){return this._gl.isContextLost()},i.ThinEngine.prototype.clearToBlack=function(){this.clear(l,!0,!0)},i.ThinEngine.prototype.resetViewport=function(){var e=this._gl.canvas.width,t=this._gl.canvas.height;this.setSize(e,t),this.setViewport(s)},i.ThinEngine.prototype.wrapExternalTexture=function(e){var t=new n.InternalTexture(this,0,!0);return t._hardwareTexture=new o.WebGLHardwareTexture(e,this._gl),t.type=0,t},i.ThinEngine.prototype.setTranstionBlend=function(e){e?(this.alphaState.alphaBlend=!0,this.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),this.alphaState.setAlphaEquationParameters(32774,32774)):this.alphaState.alphaBlend=!1})};var i=r(62),n=r(40),a=r(360),o=r(110),s=new a.Viewport(0,0,1,1),l={r:0,g:0,b:0,a:1}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var n=i(r(1)),a=i(r(2)),o=function(){function e(t,r,i,a){(0,n.default)(this,e),this.x=t,this.y=r,this.width=i,this.height=a}return(0,a.default)(e,[{key:"toGlobal",value:function(t,r){return new e(this.x*t,this.y*r,this.width*t,this.height*r)}},{key:"toGlobalToRef",value:function(e,t,r){return r.x=this.x*e,r.y=this.y*t,r.width=this.width*e,r.height=this.height*t,this}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}}])}();t.Viewport=o},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.VertexBuffer=t.Buffer=void 0;var n=i(r(15)),a=i(r(1)),o=i(r(2)),s=r(136),l=r(61),c=(0,o.default)((function e(t,r,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0;(0,a.default)(this,e),this._isAlreadyOwned=!1,this._isDisposed=!1,t&&t.getScene?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=i,this._instanced=l,this._divisor=u||1,this._label=d,r instanceof s.DataBuffer?(this._data=null,this._buffer=r):(this._data=r,this._buffer=null),this.byteStride=c?n:n*Float32Array.BYTES_PER_ELEMENT,o||this.create()}),[{key:"isDisposed",get:function(){return this._isDisposed}},{key:"createVertexBuffer",value:function(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0,s=a?t:t*Float32Array.BYTES_PER_ELEMENT,l=i?a?i:i*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new u(this._engine,this,e,this._updatable,!0,l,void 0===n?this._instanced:n,s,r,void 0,void 0,!0,this._divisor||o)}},{key:"isUpdatable",value:function(){return this._updatable}},{key:"getData",value:function(){return this._data}},{key:"getBuffer",value:function(){return this._buffer}},{key:"getStrideSize",value:function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e,this._label),this._data=e):this._buffer=this._engine.createVertexBuffer(e,void 0,this._label))}},{key:"_rebuild",value:function(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.capacity>0)return void(this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.capacity,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.capacity,void 0,this._label));l.Logger.Warn('Missing data for buffer "'.concat(this._label,'" ').concat(this._buffer?"(uniqueId: "+this._buffer.uniqueId+")":"",". Buffer reconstruction failed.")),this._buffer=null}}},{key:"update",value:function(e){this.create(e)}},{key:"updateDirectly",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,i?t:t*Float32Array.BYTES_PER_ELEMENT,r?r*this.byteStride:void 0),this._data=0===t&&void 0===r?e:null)}},{key:"_increaseReferences",value:function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}},{key:"dispose",value:function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)}}]);t.Buffer=c;var u=function(){function e(t,r,i,o,s,l,u,d,h,f){var m=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=arguments.length>11&&void 0!==arguments[11]&&arguments[11],g=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,v=arguments.length>13&&void 0!==arguments[13]&&arguments[13];(0,a.default)(this,e),this._isDisposed=!1;var y,_,S,T,b,C=!1;if(this.engine=t,"object"===(0,n.default)(o)&&null!==o?(C=null!==(y=o.updatable)&&void 0!==y&&y,s=o.postponeInternalCreation,l=o.stride,u=o.instanced,d=o.offset,h=o.size,f=o.type,m=null!==(_=o.normalized)&&void 0!==_&&_,p=null!==(S=o.useBytes)&&void 0!==S&&S,g=null!==(T=o.divisor)&&void 0!==T?T:1,v=null!==(b=o.takeBufferOwnership)&&void 0!==b&&b,this._label=o.label):C=!!o,r instanceof c?(this._buffer=r,this._ownsBuffer=v):(this._buffer=new c(t,r,C,l,s,u,p,g,this._label),this._ownsBuffer=!0),this.uniqueId=e._Counter++,this._kind=i,void 0===f){var w=this.getData();this.type=w?e.GetDataType(w):e.FLOAT}else this.type=f;var P=e.GetTypeByteLength(this.type);p?(this._size=h||(l?l/P:e.DeduceStride(i)),this.byteStride=l||this._buffer.byteStride||this._size*P,this.byteOffset=d||0):(this._size=h||l||e.DeduceStride(i),this.byteStride=l?l*P:this._buffer.byteStride||this._size*P,this.byteOffset=(d||0)*P),this.normalized=m,this._instanced=void 0!==u&&u,this._instanceDivisor=u?g:0,this._alignBuffer(),this._computeHashCode()}return(0,o.default)(e,[{key:"isDisposed",get:function(){return this._isDisposed}},{key:"instanceDivisor",get:function(){return this._instanceDivisor},set:function(e){var t=0!=e;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())}},{key:"_maxVerticesCount",get:function(){var e=this.getData();return e?Array.isArray(e)?e.length/(this.byteStride/4)-this.byteOffset/4:(e.byteLength-this.byteOffset)/this.byteStride:0}},{key:"_computeHashCode",value:function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}},{key:"_rebuild",value:function(){var e;null===(e=this._buffer)||void 0===e||e._rebuild()}},{key:"getKind",value:function(){return this._kind}},{key:"isUpdatable",value:function(){return this._buffer.isUpdatable()}},{key:"getData",value:function(){return this._buffer.getData()}},{key:"getFloatData",value:function(t,r){var i=this.getData();return i?e.GetFloatData(i,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,t,r):null}},{key:"getBuffer",value:function(){return this._buffer.getBuffer()}},{key:"getWrapperBuffer",value:function(){return this._buffer}},{key:"getStrideSize",value:function(){return this.byteStride/e.GetTypeByteLength(this.type)}},{key:"getOffset",value:function(){return this.byteOffset/e.GetTypeByteLength(this.type)}},{key:"getSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?this._size*e.GetTypeByteLength(this.type):this._size}},{key:"getIsInstanced",value:function(){return this._instanced}},{key:"getInstanceDivisor",value:function(){return this._instanceDivisor}},{key:"create",value:function(e){this._buffer.create(e),this._alignBuffer()}},{key:"update",value:function(e){this._buffer.update(e),this._alignBuffer()}},{key:"updateDirectly",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._buffer.updateDirectly(e,t,void 0,r),this._alignBuffer()}},{key:"dispose",value:function(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0}},{key:"forEach",value:function(t,r){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,r)}},{key:"_alignBuffer",value:function(){}}],[{key:"DeduceStride",value:function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.ColorInstanceKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}}},{key:"GetDataType",value:function(t){return t instanceof Int8Array?e.BYTE:t instanceof Uint8Array?e.UNSIGNED_BYTE:t instanceof Int16Array?e.SHORT:t instanceof Uint16Array?e.UNSIGNED_SHORT:t instanceof Int32Array?e.INT:t instanceof Uint32Array?e.UNSIGNED_INT:e.FLOAT}},{key:"GetTypeByteLength",value:function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '".concat(t,"'"))}}},{key:"ForEach",value:function(t,r,i,n,a,o,s,l){if(t instanceof Array)for(var c=r/4,u=i/4,d=0;d<o;d+=n){for(var h=0;h<n;h++)l(t[c+h],d+h);c+=u}else for(var f=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),m=e.GetTypeByteLength(a),p=0;p<o;p+=n){for(var g=r,v=0;v<n;v++)l(e._GetFloatValue(f,a,g,s),p+v),g+=m;r+=i}}},{key:"_GetFloatValue",value:function(t,r,i,n){switch(r){case e.BYTE:var a=t.getInt8(i);return n&&(a=Math.max(a/127,-1)),a;case e.UNSIGNED_BYTE:var o=t.getUint8(i);return n&&(o/=255),o;case e.SHORT:var s=t.getInt16(i,!0);return n&&(s=Math.max(s/32767,-1)),s;case e.UNSIGNED_SHORT:var l=t.getUint16(i,!0);return n&&(l/=65535),l;case e.INT:return t.getInt32(i,!0);case e.UNSIGNED_INT:return t.getUint32(i,!0);case e.FLOAT:return t.getFloat32(i,!0);default:throw new Error("Invalid component type ".concat(r))}}},{key:"GetFloatData",value:function(t,r,i,n,a,o,s,l){var c=r*e.GetTypeByteLength(i),u=s*r;if(i!==e.FLOAT||a!==c){var d=new Float32Array(u);return e.ForEach(t,n,a,r,i,u,o,(function(e,t){return d[t]=e})),d}if(!(t instanceof Array||t instanceof Float32Array)||0!==n||t.length!==u){if(t instanceof Array){var h=n/4;return t.slice(h,h+u)}if(t instanceof ArrayBuffer)return new Float32Array(t,n,u);var f=t.byteOffset+n;if(l){var m=new Float32Array(u),p=new Float32Array(t.buffer,f,u);return m.set(p),m}var g=f%4;return g&&(f=Math.max(0,f-g)),new Float32Array(t.buffer,f,u)}return l?t.slice():t}}])}();t.VertexBuffer=u,u._Counter=0,u.BYTE=5120,u.UNSIGNED_BYTE=5121,u.SHORT=5122,u.UNSIGNED_SHORT=5123,u.INT=5124,u.UNSIGNED_INT=5125,u.FLOAT=5126,u.PositionKind="position",u.NormalKind="normal",u.TangentKind="tangent",u.UVKind="uv",u.UV2Kind="uv2",u.UV3Kind="uv3",u.UV4Kind="uv4",u.UV5Kind="uv5",u.UV6Kind="uv6",u.ColorKind="color",u.ColorInstanceKind="instanceColor",u.MatricesIndicesKind="matricesIndices",u.MatricesWeightsKind="matricesWeights",u.MatricesIndicesExtraKind="matricesIndicesExtra",u.MatricesWeightsExtraKind="matricesWeightsExtra"},function(e,t,r){"use strict";function i(e,t,r,i,n,a,o,s,l,c,u,d,h,f,m,p){var g=new Float32Array(16);return g[0]=e,g[1]=t,g[2]=r,g[3]=i,g[4]=n,g[5]=a,g[6]=o,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=d,g[12]=h,g[13]=f,g[14]=m,g[15]=p,g}function n(){return i(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}Object.defineProperty(t,"__esModule",{value:!0}),t.mat16=i,t.mat16Identity=n,t.mat16Mul=function(e,t){for(var r=n(),i=0;i<4;i+=1)r[4*i+0]=e[4*i+0]*t[0]+e[4*i+1]*t[4]+e[4*i+2]*t[8]+e[4*i+3]*t[12],r[4*i+1]=e[4*i+0]*t[1]+e[4*i+1]*t[5]+e[4*i+2]*t[9]+e[4*i+3]*t[13],r[4*i+2]=e[4*i+0]*t[2]+e[4*i+1]*t[6]+e[4*i+2]*t[10]+e[4*i+3]*t[14],r[4*i+3]=e[4*i+0]*t[3]+e[4*i+1]*t[7]+e[4*i+2]*t[11]+e[4*i+3]*t[15];return r},t.mat16MulVec3=function(e,t,r,i){for(var n=[0,0,0,0],a=0;a<4;a+=1)n[a]=e[0+a]*t+e[4+a]*r+e[8+a]*i+e[12+a];return n},t.mat16Translate=function(e,t,r){var i=n();return i[12]=e,i[13]=t,i[14]=r,i},t.mat16TranslateColumn=function(e,t,r){var i=n();return i[3]=e,i[7]=t,i[11]=r,i},t.mat16Scale=function(e,t,r){var i=n();return i[0]=e,i[5]=t,i[10]=r,i},t.mat16RotateX=function(e){var t=Math.cos(e),r=Math.sin(e);return i(1,0,0,0,0,t,r,0,0,-r,t,0,0,0,0,1)},t.mat16RotateY=function(e){var t=Math.cos(e),r=Math.sin(e);return i(t,0,-r,0,0,1,0,0,r,0,t,0,0,0,0,1)},t.mat16RotateZ=function(e){var t=Math.cos(e),r=Math.sin(e);return i(t,r,0,0,-r,t,0,0,0,0,1,0,0,0,0,1)},t.mat16Prespective=function(){return i(1,0,0,0,0,1,0,0,1.5,1.5,1,3,0,0,0,1)},t.enableVertexAttribArray=function(e,t,r){var i=e.getAttribLocation(t,r);return e.enableVertexAttribArray(i),i},t.bindArrayBufferToVertexAttribPointer=function(e,t,r,i,n){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(r,i,n,!1,0,0)},t.initTexture=function(e,t,r,i,n,a){e.bindTexture(e.TEXTURE_2D,t);var o=new Uint8Array(r);e.texImage2D(e.TEXTURE_2D,0,i,n,a,0,i,e.UNSIGNED_BYTE,o)},t.initReflectionMask=function(e,t,r,i){for(var n=new Uint8Array(4*r),a=0;a<r;a+=1){var o=a/r;n[4*a+0]=0,n[4*a+1]=0,n[4*a+2]=0,n[4*a+3]=230*Math.pow(o,i)}e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,r,0,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BabylonTransitionFactory=void 0;var n=i(r(2)),a=i(r(1)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(55),u=r(364),d=r(365),h=r(366),f=r(367),m=r(368),p=r(369),g=r(370),v=r(371),y=r(372),_=r(373),S=r(374),T=r(375),b=r(376),C=r(377);function w(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var P=function(e){function t(){var e;return(0,a.default)(this,t),(e=w(this,t,arguments)).transactionConstructors={AlphaTransition:function(){return new c.AlphaTransition},FadeThroughBlackTransition:function(){return new g.FadeThroughBlackTransition},PushTransition:function(){return new S.PushTransition},WeaveTransition:function(){return new b.WeaveTransition},CutTransition:function(){return new m.CutTransition},CoverTransition:function(){return new d.CoverTransition},PrismTransition:function(){return new _.PrismTransition},RippleTransition:function(){return new T.RippleTransition},ZoomWithSpinTransition:function(){return new C.ZoomWithSpinTransition},BlindsTransition:function(){return new u.BlindsTransition},CustomTransition:function(){return new f.CustomTransition},GalleryTransition:function(){return new y.GalleryTransition},CrossZoomTransition:function(){return new h.CrossZoomTransition},FlyThroughTransition:function(){return new v.FlyThroughTransition},DoorsTransition:function(){return new p.DoorsTransition}},e}return(0,l.default)(t,e),(0,n.default)(t)}(r(173).BaseTransitionFactory);t.BabylonTransitionFactory=P},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BlindsTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(33),u=r(22),d=r(29),h=r(23),f=r(28),m=r(32);function p(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var g=function(e){function t(){var e;return(0,n.default)(this,t),(e=p(this,t,arguments)).zMovement=0,e.vres=0,e.hres=0,e}return(0,l.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e){this.zMovement=null!=e.zMovement?e.zMovement:10,this.vres=e.vres,this.hres=e.hres;var t=this.getDrawInfo(u.ProgramId.vortex,[d.aPosition,d.aTexcoord,d.aDelay,d.aCenter],!0);if(t){var r=(0,f.defaultViewModelProjectionMatrix)();return t.shaderProgram.setMatrix("uModelViewProj",r),t.shaderProgram.setFloat("uFactor",e.factor),t.shaderProgram.setFloat("uXAxis",e.xAxis?1:0),t}}},{key:"internalDraw",value:function(e,t,r){(0,h.setDepthBlendCulling)(r.engine,!0,!0,1028);var i=Math.PI,n=t.delayFormula===m.DelayFormula.None?0:1,a=this.zMovement/10;a/=t.xAxis?this.vres:this.hres;var o=e*(n+i/t.factor+t.jitter/100),s=0,l=-1,c=(0,h.bindDrawInfo)(r);return c.setFloat("uZmovement",a),c.setFloat("uDirection",l),c.setFloat("uAngle",o),c.setFloat("uBack",s),c._bindTexture("uSampler1",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),(0,h.drawTriangles)(r),t.randomCenters?(o=(1-e)*(1+i/t.factor+t.jitter/100),s=0,l=1):(s=i,l=-1),c.setFloat("uDirection",l),c.setFloat("uAngle",o),c.setFloat("uBack",s),c._bindTexture("uSampler1",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),(0,h.drawTriangles)(r),!0}}])}(c.MeshTransition);t.BlindsTransition=g},function(e,t,r){"use strict";var i=r(0),n=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.CoverTransition=void 0;var a=i(r(5)),o=i(r(1)),s=i(r(2)),l=i(r(9)),c=i(r(8)),u=i(r(10)),d=r(33),h=r(22),f=r(29),m=r(23),p=r(28),g=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(r(76)),v=r(45);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t=(0,c.default)(t),(0,l.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}var T=function(e){function t(){var e;return(0,o.default)(this,t),(e=S(this,t,arguments)).modelViewProjectionMatrix=new p.ThinMatrix,e.center={x:-.5,y:-.5},e.positionSlide0={x:0,y:0},e.positionSlide1={x:0,y:0},e}return(0,u.default)(t,e),(0,s.default)(t,[{key:"internalInit",value:function(e){var t={x:0,y:0};switch(e.direction){case v.kTransitionEffectOptions.Top:t.y=1;break;case v.kTransitionEffectOptions.Bottom:t.y=-1;break;case v.kTransitionEffectOptions.Left:t.x=-1;break;case v.kTransitionEffectOptions.TopLeft:t.y=1,t.x=-1;break;case v.kTransitionEffectOptions.BottomLeft:t.y=-1,t.x=-1;break;case v.kTransitionEffectOptions.TopRight:t.y=1,t.x=1;break;case v.kTransitionEffectOptions.BottomRight:t.y=-1,t.x=1;break;case v.kTransitionEffectOptions.Right:default:t.x=1}e.isCover||(t.x*=-1,t.y*=-1);var r=this.getDrawInfo(h.ProgramId.alpha,[f.aPosition,f.aTexcoord,f.aDelay]);if(r)return _(_({},r),{},{direction:t})}},{key:"internalDraw",value:function(e,t,r){var i=e;t.isCover||(i=1-i);var n=(0,m.bindDrawInfo)(r);n.setFloat("uFactor",1),n.setFloat("uStyle",1),t.isCover?(n._bindTexture("uSampler1",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),n._bindTexture("uSampler2",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture)):(n._bindTexture("uSampler1",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),n._bindTexture("uSampler2",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture));var a=g.MotionFilter.getScaledProgress(g.MotionType.MotionQuadratic,i);return this.positionSlide0.x=this.center.x,this.positionSlide0.y=this.center.y,this.positionSlide1.x=this.center.x+(1-a)*-r.direction.x,this.positionSlide1.y=this.center.y+(1-a)*-r.direction.y,this.modelViewProjectionMatrix.translationScaling(this.positionSlide0.x,this.positionSlide0.y,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),n.setFloat("uProgress",0),(0,m.drawTriangles)(r),this.modelViewProjectionMatrix.translationScaling(this.positionSlide1.x,this.positionSlide1.y,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),n.setFloat("uProgress",1),(0,m.drawTriangles)(r),!0}}])}(d.MeshTransition);t.CoverTransition=T},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CrossZoomTransition=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(31)),c=i(r(8)),u=i(r(10)),d=r(55),h=r(28),f=r(23),m=r(22),p=r(29),g=r(33),v=r(21),y=r(32);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return t=(0,c.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}var b=function(e){function t(){var e;return(0,a.default)(this,t),(e=T(this,t,arguments)).crossZoomMatrix=new h.ThinMatrix,e.eyePositionMatrix=new h.ThinMatrix,e.alphaTransition=new d.AlphaTransition(!1),e}return(0,u.default)(t,e),(0,o.default)(t,[{key:"internalInit",value:function(e,t,r){if(e.incomingSlideForeground&&e.outgoingSlideForeground){var i=this.getDrawInfo(m.ProgramId.alpha,[p.aPosition,p.aTexcoord,p.aDelay]);if(i){var n;n=e.m_fTransitionWhite?t.createMonochromeTexture(255,255,255,255):t.createMonochromeTexture(0,0,0,255),e.delayFormula=y.DelayFormula.None,this.alphaTransition.init(e,r);var a=(0,h.defaultViewModelMatrix)(),o=(0,h.perspectiveMatrix)();o.multiply(a);var s=i.engine.wrapExternalTexture(e.incomingSlideForeground),l=i.engine.wrapExternalTexture(e.outgoingSlideForeground);return S(S({},i),{},{solidTexture:n,modelViewMatrix:a,modelViewProjectionMatrix:o,incomingSlideTextureForeGround:s,outgoingSlideTextureForeGround:l})}}else(0,v.logError)("Either incomingSlideTextureForeGround or outgoingSlideTextureForeGround is undefined")}},{key:"internalDraw",value:function(e,t,r){(0,f.setDepthBlendCulling)(r.engine,!1,t.m_fTransitionWhite);var i=e;if(t.m_fTransitionWhite)this.alphaTransition.draw(i);else if(t.m_deadTime>0){var n=t.m_deadTime/100;i<.5?i*=1-n:i=(1-n)*(i-.5)+.5+n/2}var a=t.forward?r.incomingSlideTexture:r.outgoingSlideTexture,o=t.forward?r.outgoingSlideTexture:r.incomingSlideTexture,s=t.forward?r.incomingSlideTextureForeGround:r.outgoingSlideTextureForeGround,l=t.forward?r.outgoingSlideTextureForeGround:r.incomingSlideTextureForeGround,c=i,u=(c*=2)<1;u||(c=2-c);var d=t.factor/4,h=1+1/d+t.jitter/100,m=(0,f.bindDrawInfo)(r);return t.m_fTransitionWhite?(m.setFloat("uFactor",d),m.setFloat("uProgress",(1-c)*h)):(m.setFloat("uProgress",h),m.setFloat("uFactor",1),m.setMatrix("uModelViewProj",r.modelViewProjectionMatrix),m.setFloat("uStyle",2),m._bindTexture("uSampler1",u?o:a),(0,f.drawTriangles)(r)),this.calculateEyePosition(i,t,r.modelViewMatrix),m.setMatrix("uModelViewProj",this.crossZoomMatrix),m.setFloat("uStyle",2),m._bindTexture("uSampler1",u?l:s),(0,f.drawTriangles)(r),t.m_fTransitionWhite||(m.setMatrix("uModelViewProj",r.modelViewProjectionMatrix),m.setFloat("uFactor",d),m.setFloat("uProgress",c*h),m.setFloat("uStyle",2),m._bindTexture("uSampler1",r.solidTexture),(0,f.drawTriangles)(r)),!0}},{key:"calculateEyePosition",value:function(e,t,r){var i=t.m_dx/100,n=t.m_dy/100,a=t.m_dz/100,o=2*e;o>1&&(o=2-o,t.m_fInvertXZoomOut&&(i*=-1));var s=i*o,l=n*o,c=-1.5/(a*o-1.5);this.crossZoomMatrix.scaling(c,c,1),this.eyePositionMatrix.translation(-s,-l,0),this.crossZoomMatrix.multiply(this.eyePositionMatrix),r.multiplyToRef(this.crossZoomMatrix,this.crossZoomMatrix)}},{key:"dispose",value:function(){this.alphaTransition.dispose(),(0,l.default)((0,c.default)(t.prototype),"dispose",this).call(this)}}])}(g.MeshTransition);t.CrossZoomTransition=b},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(93),u=r(28),d=r(22),h=r(23),f=r(21),m=r(45);function p(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var g=function(e){function t(){var e;return(0,n.default)(this,t),(e=p(this,t,arguments)).aspectRatio=0,e.diffuse=0,e.backgroundProgress=0,e.isStaticBackground=!0,e}return(0,l.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e,t){this.aspectRatio=16/9,this.diffuse=1-e.ambient;var r=!1;e.effectID===m.kTransitionIds.PPT_TRANSITION_DRAPE?(this.backgroundProgress=1,r=!r):this.backgroundProgress=0,e.forward||(r=!r);var i=e.engine;if(i){var n=i.wrapExternalTexture(r?e.outgoingSlideBackground:e.incomingSlideBackground),a=i.wrapExternalTexture(r?e.incomingSlideBackground:e.outgoingSlideBackground),o=(0,d.activateShader)(i,d.ProgramId.custom);if(o){var s=e.indexBuffer,l=t.createIndexBuffer(e.indexBuffer),c=e.indexBuffer.length,h=new Float32Array(e.textureCoordBuffer);if(e.isInvX)for(var p=0;p<h.length/2;p+=1)h[2*p]=1-h[2*p];var g,v=h.length/2*3,y=new Float32Array(v),_=new Float32Array(v),S=t.createVertexBuffers([{name:"aTexCoord",data:h,itemSize:2},{name:"aPosition",data:y,itemSize:3},{name:"aNormal",data:_,itemSize:3}]);i.getCaps().vertexArrayObject&&(g=t.recordVertexArrayObject(S,l,o));var T=new u.ThinMatrix,b=new u.ThinMatrix,C=new u.ThinMatrix,w=new u.ThinMatrix,P=new u.ThinMatrix,I=new u.ThinMatrix;T.scaling(1.031,1.031/this.aspectRatio,.5),b.rotationY(Math.PI),C.translation(0,0,2.8),b.multiplyToRef(T,w),C.multiplyToRef(w,w),this.perspectiveMat(45,this.aspectRatio,.01,100,I),w.multiplyToRef(I,I),this.perspectiveMat(45,this.aspectRatio,.1,100,P),w.multiplyToRef(P,P),o.setMatrix("uModelToWorld",w),o.setMatrix("uModelToWorldIT",w),o.setFloat3("uLightPosition",0,0,-10),e.effectID===m.kTransitionIds.PPT_TRANSITION_FALLOVER?o.setFloat("uIsNormalDirectionChangeReq",0):o.setFloat("uIsNormalDirectionChangeReq",1);var k={engine:i,shaderProgram:o,incomingSlideTexture:n,outgoingSlideTexture:a,perspectiveMatrix:P,perspectiveBackgroundMatrix:I,vertexBuffers:S,vertexIndexBuffer:l,vertexIndexLength:c,tempVertexDataArray:y,tempVertexNormalDataArray:_,vertexIndexData:s,positionBufferList:e.positionBufferList,vertexArrayObject:g,autoClear:!0};if(e.textureCoordBufferBack&&e.indexBufferBack&&e.positionBufferListBack){var E=e.indexBufferBack,x=t.createIndexBuffer(e.indexBufferBack),L=e.indexBufferBack.length,A=new Float32Array(e.textureCoordBufferBack);if(e.isInvX)for(var M=0;M<A.length/2;M+=1)A[2*M]=1-A[2*M];var R,O=h.length/2*3,D=new Float32Array(O),F=new Float32Array(O),B=t.createVertexBuffers([{name:"aTexCoord",data:A,itemSize:2},{name:"aPosition",data:D,itemSize:3},{name:"aNormal",data:F,itemSize:3}]);i.getCaps().vertexArrayObject&&(R=t.recordVertexArrayObject(B,x,o)),k.back={vertexBuffers:B,vertexIndexBuffer:x,vertexIndexLength:L,vertexIndexData:E,tempVertexDataArray:D,tempVertexNormalDataArray:F,positionBufferList:e.positionBufferListBack,vertexArrayObject:R}}return k}(0,f.logError)("Can not init shaders, shader program is undefined.")}}},{key:"internalDraw",value:function(e,t,r){var i=r.engine;this.setTransitionProperties(i,t.effectID,t.isInvX);var n=r.shaderProgram;if(i.enableEffect(n),t.effectID===m.kTransitionIds.PPT_TRANSITION_FLIP||t.effectID===m.kTransitionIds.PPT_TRANSITION_SWITCH){var a=this.isStaticBackground;this.isStaticBackground=!0,this.drawUtil(r,0,r,!0,0,0,t.isInvX,t.effectID),this.isStaticBackground=a}return r.back&&t.positionBufferListBack?this.drawUtil(r,e,r.back,!0,t.ambient,this.diffuse,t.isInvX,t.effectID):this.drawUtil(r,this.backgroundProgress,r,!0,t.ambient,this.diffuse,t.isInvX,t.effectID),this.drawUtil(r,e,r,!1,t.ambient,this.diffuse,t.isInvX,t.effectID),!0}},{key:"setUniforms",value:function(e,t,r,i){var n;n=t&&this.isStaticBackground?e.perspectiveBackgroundMatrix:e.perspectiveMatrix,e.shaderProgram.setMatrix("uModelToView",n),e.shaderProgram.setFloat3("uAmbientColor",r,r,r),e.shaderProgram.setFloat4("uDiffuseColor",i,i,i,1)}},{key:"setTransitionProperties",value:function(e,t,r){switch(e.setTranstionBlend(!1),e.depthCullingState.depthTest=!0,t){case m.kTransitionIds.PPT_TRANSITION_FLIP:case m.kTransitionIds.PPT_TRANSITION_SWITCH:case m.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:this.isStaticBackground=!1,e.depthCullingState.cull=!0,e.depthCullingState.cullFace=r?1029:1028;break;case m.kTransitionIds.PPT_TRANSITION_AIRPLANE:case m.kTransitionIds.PPT_TRANSITION_CRUSH:case m.kTransitionIds.PPT_TRANSITION_CURTAINS:case m.kTransitionIds.PPT_TRANSITION_FRACTURE:case m.kTransitionIds.PPT_TRANSITION_ORIGAMI:case m.kTransitionIds.PPT_TRANSITION_PEELOFF:case m.kTransitionIds.PPT_TRANSITION_PRESTIGE:case m.kTransitionIds.PPT_TRANSITION_WIND:case m.kTransitionIds.PPT_TRANSITION_FALLOVER:case m.kTransitionIds.PPT_TRANSITION_DRAPE:case m.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:e.depthCullingState.cull=!1,this.isStaticBackground=!0}}},{key:"drawUtil",value:function(e,t,r,i,n,a,o,s){var l=r.vertexIndexData,c=r.tempVertexDataArray,u=r.tempVertexNormalDataArray,d=r.vertexBuffers,f=r.vertexIndexBuffer,m=r.vertexIndexLength,p=r.positionBufferList,g=r.vertexArrayObject,v=t*(p.length-1),y=Math.floor(v),_=y+1,S=v-y,T=p[y],b=p[_];if(null==b)for(var C=0;C<T.length;C+=1)c[C]=T[C];else for(var w=0;w<T.length;w+=1)c[w]=T[w]*(1-S)+b[w]*S;if(o)for(var P=0;P<T.length/3;P+=1)c[3*P]=-c[3*P];d.aPosition.update(c),this.getNormalBufferInPlace(c,u,l,m,o,s),d.aNormal.update(u),g?e.engine.bindVertexArrayObject(g,f):e.engine.bindBuffers(d,f,e.shaderProgram),this.setUniforms(e,i,n,a),e.shaderProgram._bindTexture("uSampler",i?e.incomingSlideTexture:e.outgoingSlideTexture),(0,h.drawTriangles)(e)}},{key:"getNormalBufferInPlace",value:function(e,t,r,i,n,a){for(var o=0;o<e.length;o+=1)t[o]=0;for(var s=0;s<i/3;s+=1){var l=r[3*s],c=r[3*s+1],u=r[3*s+2],d=e[3*l],h=e[3*l+1],f=e[3*l+2],p=e[3*c]-d,g=e[3*c+1]-h,v=e[3*c+2]-f,y=e[3*u]-d,_=e[3*u+1]-h,S=e[3*u+2]-f,T=_*v-g*S,b=S*p-v*y,C=y*g-p*_;a!==m.kTransitionIds.PPT_TRANSITION_FALLOVER||n||(T=-T,b=-b,C=-C),t[3*l]+=T,t[3*l+1]+=b,t[3*l+2]+=C,t[3*c]+=T,t[3*c+1]+=b,t[3*c+2]+=C,t[3*u]+=T,t[3*u+1]+=b,t[3*u+2]+=C}}},{key:"perspectiveMat",value:function(e,t,r,i,n){var a=r*Math.tan(e*Math.PI/360),o=a*t;this.frustum(-o,o,-a,a,r,i,n)}},{key:"frustum",value:function(e,t,r,i,n,a,o){var s=t-e,l=i-r,c=a-n;o.setValues(2*n/s,0,0,0,0,2*n/l,0,0,(t+e)/s,(i+r)/l,-(a+n)/c,-1,0,0,-a*n*2/c,0)}}])}(c.Transition);t.CustomTransition=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CutTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(33),u=r(23);function d(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var h=function(e){function t(){return(0,n.default)(this,t),d(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e){var t=this.initModel(e);if(t)return t}},{key:"internalDraw",value:function(e,t,r){return(0,u.setDepthBlendCulling)(r.engine),1===e?this.drawTexture(t.forward?r.incomingSlideTexture:r.outgoingSlideTexture):t.m_fThroughBlack&&e>.5?r.engine.clearToBlack():this.drawTexture(t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),!0}}])}(c.MeshTransition);t.CutTransition=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.DoorsTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10)),u=r(55),d=r(33),h=r(28),f=r(22),m=r(23),p=r(29),g=r(21),v=r(32);function y(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var _=function(e){function t(){return(0,n.default)(this,t),y(this,t,arguments)}return(0,c.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e,t,r){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void(0,g.logError)("Outgoing textures have not been defined");e.delayFormula=v.DelayFormula.None,this.alphaTransition=new u.AlphaTransition(!1),this.alphaTransition.init(e,r),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var i=this.getDrawInfo(f.ProgramId.flyThrough,[p.aPosition,p.aTexcoord,p.aCenter],!0);if(i){if(!e.forward){var n=i.incomingSlideTexture,a=i.outgoingSlideTexture;i.incomingSlideTexture=a,i.outgoingSlideTexture=n}var o=(0,h.defaultViewModelProjectionMatrix)(),s=(0,h.identityMatrix)();return i.shaderProgram.setMatrix("uModelViewProj",o),i.shaderProgram.setMatrix("offsetMatrix",s),i}}},{key:"internalDraw",value:function(e,t,r){(0,m.setDepthBlendCulling)(r.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);var i=(0,m.bindDrawInfo)(r),n=this.alphaTransitionTextures;return n&&i._bindTexture("uSampler2",t.forward?n.incomingSlideTexture:n.outgoingSlideTexture),this.drawSlide(t,r,e,!0),this.drawSlide(t,r,e,!1),!0}},{key:"drawSlide",value:function(e,t,r,i){var n=t.shaderProgram,a=r;i&&(a=1-a),n._bindTexture("uSampler1",i?t.incomingSlideTexture:t.outgoingSlideTexture),this.alphaTransitionTextures||n._bindTexture("uSampler2",i?t.outgoingSlideTexture:t.incomingSlideTexture),i?n.setFloat("style",2):n.setFloat("style",1);var o=!e.m_fUseContent&&i?1:1-a,s=a;i&&(s=a/4),n.setFloat("uProgress",s),n.setFloat("opacity",o),n.setFloat("isX",e.m_isX?1:0),(0,m.drawTriangles)(t)}},{key:"dispose",value:function(){this.alphaTransition&&this.alphaTransition.dispose(),(0,s.default)((0,l.default)(t.prototype),"dispose",this).call(this)}}])}(d.MeshTransition);t.DoorsTransition=_},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.FadeThroughBlackTransition=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(8)),c=i(r(10)),u=r(33),d=r(28),h=r(22),f=r(29),m=r(23),p=r(32);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t=(0,l.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var _=function(e){function t(){var e;return(0,a.default)(this,t),(e=y(this,t,arguments)).delayDuration=0,e.style=1,e}return(0,c.default)(t,e),(0,o.default)(t,[{key:"internalInit",value:function(e,t){var r=this.getDrawInfo(h.ProgramId.alpha,[f.aPosition,f.aTexcoord,f.aDelay]);if(r){this.delayDuration=e.delayFormula==p.DelayFormula.None?0:1;var i=(0,d.defaultViewModelProjectionMatrix)();r.shaderProgram.setMatrix("uModelViewProj",i);var n=t.createMonochromeTexture(0,0,0,255);return v(v({},r),{},{blackTexture:n})}}},{key:"internalDraw",value:function(e,t,r){var i;(0,m.setDepthBlendCulling)(r.engine),i=e<=.5?2*e*(this.delayDuration+1/t.factor+t.jitter/100):2*(e-.5)*(this.delayDuration+1/t.factor+t.jitter/100);var n=(0,m.bindDrawInfo)(r);n.setFloat("uProgress",i),n.setFloat("uFactor",t.factor),n.setFloat("uStyle",this.style);var a=r.incomingSlideTexture,o=r.outgoingSlideTexture;return e<=.5?(n._bindTexture("uSampler1",t.forward?o:a),n._bindTexture("uSampler2",r.blackTexture)):(n._bindTexture("uSampler1",r.blackTexture),n._bindTexture("uSampler2",t.forward?a:o)),(0,m.drawTriangles)(r),!0}}])}(u.MeshTransition);t.FadeThroughBlackTransition=_},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.FlyThroughTransition=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(31)),c=i(r(8)),u=i(r(10)),d=r(55),h=r(33),f=r(176),m=r(28),p=r(22),g=r(29),v=r(23),y=r(21),_=r(76),S=r(45),T=r(32);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return t=(0,c.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}var P=function(e){function t(){var e;return(0,a.default)(this,t),(e=w(this,t,arguments)).m_zEyeDest=0,e.m_zMoveMin=0,e.m_zMoveMax=0,e.m_zMoveDecel=0,e.m_defaultEye=new T.Vector3(0,0,-1.5),e.projectionMatrix=(0,m.perspectiveMatrix)(),e.modelViewMatrix=new m.ThinMatrix,e.modelViewProjectionMatrix=new m.ThinMatrix,e.defaultOffsetMatrix=(0,m.identityMatrix)(),e.scale4Matrix=(0,m.scaleMatrix)(4,4,1),e.newWorldMatrix=new m.ThinMatrix,e.newWorldMatrixTransform=new m.ThinMatrix,e.eyePosition={x:0,y:0,z:0},e}return(0,u.default)(t,e),(0,o.default)(t,[{key:"internalInit",value:function(e,t,r){if(this.m_zMoveMin=0,this.m_zMoveMax=1,this.m_zMoveDecel=.5,e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void(0,y.logError)("Outgoing textures have not been defined");e.delayFormula=T.DelayFormula.None,this.alphaTransition=new d.AlphaTransition(!1),this.alphaTransition.init(e,r),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var i=this.getDrawInfo(p.ProgramId.flyThrough,[g.aPosition,g.aTexcoord,g.aCenter],!0);if(i){var n=(0,f.getReflectionData)(512,12),a=t.createTexture(n,1,512),o=t.createMonochromeTexture(0,0,0,255),s=i.incomingSlideTexture,l=i.outgoingSlideTexture;return C(C({},i),{},{incomingSlideTexture:e.forward?s:l,outgoingSlideTexture:e.forward?l:s,reflectionMask:a,blackTexture:o})}}},{key:"internalDraw",value:function(e,t,r){(0,v.setDepthBlendCulling)(r.engine,!1,!0);var i=t.m_length/10;if(this.m_zEyeDest=i+this.m_defaultEye.z,this.alphaTransition){this.alphaTransition.draw(e);var n=(0,v.bindDrawInfo)(r);if(this.alphaTransitionTextures){var a=this.alphaTransitionTextures,o=a.incomingSlideTexture,s=a.outgoingSlideTexture;n._bindTexture("uSampler1",t.forward?s:o),n._bindTexture("uSampler2",t.forward?o:s)}}else this.drawSlide(t,r,e,S.FlySlideDrawType.DrawNextSlideReflection),(0,v.bindDrawInfo)(r);return this.drawSlide(t,r,e,S.FlySlideDrawType.DrawNextSlide),this.drawSlide(t,r,e,S.FlySlideDrawType.DrawPreviousSlide),!0}},{key:"drawSlide",value:function(e,t,r,i){var n=r;e.m_fOut&&(n=1-n),this.computeEyePosition(e,n);var a=this.eyePosition,o=a.z;i===S.FlySlideDrawType.DrawNextSlide&&(a.z-=e.m_length/10),e.m_fOut&&(a.z=this.m_defaultEye.z-(a.z-this.m_defaultEye.z)),this.modelViewMatrix.translationScaling(-.5-a.x,-.5-a.y,0,2,2,1),this.projectionMatrix.multiplyToRef(this.modelViewMatrix,this.modelViewProjectionMatrix);var s=t.shaderProgram;if(s.setMatrix("offsetMatrix",this.defaultOffsetMatrix),e.m_fUseContent||s._bindTexture("uSampler2",e.forward?t.incomingSlideTexture:t.outgoingSlideTexture),s.setFloat("style",2),i!==S.FlySlideDrawType.DrawNextSlideReflection){if(i===S.FlySlideDrawType.DrawPreviousSlide){if(o>0)return;n=e.m_doorType===S.FlyDoorTypes.DoorSlidingHorizontal||e.m_doorType===S.FlyDoorTypes.DoorSlidingVertical?Math.abs(o-this.m_defaultEye.z)*e.m_slidingDoorSpeed/25:Math.abs(o-this.m_defaultEye.z);var l=e.m_fFade?Math.abs(o/this.m_defaultEye.z):1,c=e.m_fOut?this.getScaledReverseProgress(e,n):n;s.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),s.setFloat("uProgress",c),s.setFloat("opacity",l),s._bindTexture("uSampler1",e.m_fOut?t.incomingSlideTexture:t.outgoingSlideTexture)}else{var u=e.m_fOut||e.m_fUseContent?n:1,d=n;e.m_fUseContent&&(d=e.m_fOut?n:Math.abs(o-this.m_defaultEye.z)/1.8),this.modelViewProjectionMatrix.multiply(this.scale4Matrix),s.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),s.setFloat("uProgress",d),s.setFloat("opacity",u),s._bindTexture("uSampler1",e.m_fOut?t.outgoingSlideTexture:t.incomingSlideTexture)}(0,v.drawTriangles)(t)}else this.drawReflection(e,t,n,Math.abs(this.m_zEyeDest-a.z))}},{key:"getScaledReverseProgress",value:function(e,t){switch(e.m_endType){case _.MotionType.MotionQuadratic:return t;case _.MotionType.MotionQuadraticBounce:var r=e.m_bounceTime/100,i=t/1.5;if(i<r){var n=r/2;return i<n?i:n-(i-n)}return(i-r)/(1-r);default:return-1e4}}},{key:"computeEyePosition",value:function(e,t){var r;switch(e.m_endType){case _.MotionType.MotionQuadratic:r=this.m_defaultEye.z+_.MotionFilter.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case _.MotionType.MotionLinear:r=this.m_defaultEye.z+t*e.m_length/10;break;case _.MotionType.MotionQuadraticHard:(r=this.m_defaultEye.z+_.MotionFilter.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1))>this.m_zEyeDest&&(r=this.m_zEyeDest);break;case _.MotionType.MotionQuadraticBounce:var i=e.m_bounceTime/100,n=e.m_length/10*2/this.sqr(1-i),a=this.m_zMoveMax-i;if(t>a){var o=this.getVelocity(e,t),s=this.getBounce(e,t,o);r=this.m_defaultEye.z+e.m_length/10+s}else r=this.m_defaultEye.z+_.MotionFilter.getPositionFromTime(t,n,this.m_zMoveMin,a,a,!1);break;default:r=-100}this.eyePosition.z=r}},{key:"sqr",value:function(e){return e*e}},{key:"getVelocity",value:function(e,t){var r;switch(e.m_endType){case _.MotionType.MotionQuadratic:r=_.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case _.MotionType.MotionLinear:r=e.m_length/10;break;case _.MotionType.MotionQuadraticHard:r=_.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1);break;case _.MotionType.MotionQuadraticBounce:var i=this.m_zMoveMax-e.m_bounceTime/100;r=_.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,i,i,!1);break;default:r=-1e4}return r}},{key:"getBounce",value:function(e,t,r){var i=e.m_bounceTime/100,n=(t-(this.m_zMoveMax-i))/i,a=2*n*Math.PI;return 1/e.m_bounceDampening*(1-n)*i*Math.sin(a)*r}},{key:"drawReflection",value:function(e,t,r,i){var n=t.shaderProgram,a=e.m_reflectionType;if(a!==S.FlyReflectionTypes.ReflectionNone){this.newWorldMatrix.translation(0,.5,0),a===S.FlyReflectionTypes.ReflectionShrink&&(this.newWorldMatrixTransform.scaling(1,2*i/3,1),this.newWorldMatrix.multiply(this.newWorldMatrixTransform));var o=a===S.FlyReflectionTypes.ReflectionSimple?-Math.PI:-Math.PI/2;this.newWorldMatrixTransform.rotationX(o),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.newWorldMatrixTransform.translation(0,-.5,0),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.setReflectionMask(t,n,!0),n.setMatrix("offsetMatrix",this.newWorldMatrix);var s=a===S.FlyReflectionTypes.ReflectionShrink?1.5/i:1;n.setFloat("opacity",s*(1-r)),n._bindTexture("uSampler1",t.incomingSlideTexture),(0,v.drawTriangles)(t),this.setReflectionMask(t,n,!1)}}},{key:"setReflectionMask",value:function(e,t,r){r?t._bindTexture("uSampler2",e.reflectionMask):t._bindTexture("uSampler2",e.blackTexture)}},{key:"dispose",value:function(){this.alphaTransition&&this.alphaTransition.dispose(),(0,l.default)((0,c.default)(t.prototype),"dispose",this).call(this)}}])}(h.MeshTransition);t.FlyThroughTransition=P},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.GalleryTransition=void 0;var n=i(r(5)),a=i(r(1)),o=i(r(2)),s=i(r(9)),l=i(r(31)),c=i(r(8)),u=i(r(10)),d=r(55),h=r(33),f=r(176),m=r(28),p=r(22),g=r(29),v=r(23),y=r(21),_=r(76);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t=(0,c.default)(t),(0,s.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}var C=new m.ThinMatrix,w=function(e){function t(){var e;return(0,a.default)(this,t),(e=b(this,t,arguments)).worldViewMatrix=new m.ThinMatrix,e.reflectionWorldViewMatrix=new m.ThinMatrix,e.dirMatrix=new m.ThinMatrix,e.offsetMatrix=new m.ThinMatrix,e.reflectionPreTranslationMatrix=new m.ThinMatrix,e.reflectionPostTranslationMatrix=new m.ThinMatrix,e.swivel={scaledProgress:0,swivelPercent:0},e}return(0,u.default)(t,e),(0,o.default)(t,[{key:"internalInit",value:function(e,t,r){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void(0,y.logError)("Outgoing textures have not been defined");this.alphaTransition=new d.AlphaTransition(!1),this.alphaTransition.init(e,r),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var i=this.getDrawInfo(p.ProgramId.gallery,[g.aPosition,g.aTexcoord]);if(i&&this.initModel(e)){this.reflectionPreTranslationMatrix.translationColumn(0,e.m_reflectionDistance/100,0),this.reflectionPostTranslationMatrix.translationColumn(0,1,0);var n=(0,f.getReflectionData)(512,12),a=t.createTexture(n,1,512),o=t.createMonochromeTexture(0,0,0,255);return T(T({},i),{},{reflectionMask:a,blackTexture:o})}}},{key:"internalDraw",value:function(e,t,r){(0,v.setDepthBlendCulling)(r.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);var i=(0,v.bindDrawInfo)(r),n=this.alphaTransitionTextures;n&&i._bindTexture("uSampler2",t.forward?n.incomingSlideTexture:n.outgoingSlideTexture),this.offsetMatrix.identity();var a=0;t.m_fSwivel&&(this.doSwivel(t,e),a=this.swivel.swivelPercent/10),this.calculateDirection(t,!1,e),this.worldViewMatrix.translationScaling(-.5,0,0,t.m_isInvX?-2:2,2,1),this.worldViewMatrix.setValueAt(15,a+1);var o=this.worldViewMatrix.getValueAt(12)+(t.m_isInvX?a:-a);return this.worldViewMatrix.setValueAt(12,o),i.setFloat("isInvX",t.m_isInvX?1:0),i.setFloat("opacity",1),i.setMatrix("offsetMatrix",this.offsetMatrix),i.setMatrix("dirMatrix",this.dirMatrix),i.setMatrix("uModelViewProj",this.worldViewMatrix),i._bindTexture("uSampler1",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),(0,v.drawTriangles)(r),this.drawReflection(r,t,!t.forward,e),this.calculateDirection(t,!0,e),i.setFloat("opacity",1),i.setMatrix("offsetMatrix",this.offsetMatrix),i.setMatrix("dirMatrix",this.dirMatrix),i.setMatrix("uModelViewProj",this.worldViewMatrix),i._bindTexture("uSampler1",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),(0,v.drawTriangles)(r),this.drawReflection(r,t,t.forward,e),!0}},{key:"drawReflection",value:function(e,t,r,i){if(t.m_fReflection){var n=e.shaderProgram;this.reflectionWorldViewMatrix.rotationX(-Math.PI),this.reflectionWorldViewMatrix.multiply(this.reflectionPreTranslationMatrix),this.reflectionWorldViewMatrix.multiply(this.offsetMatrix),this.reflectionWorldViewMatrix.multiply(this.reflectionPostTranslationMatrix),n.setFloat("opacity",1-(t.m_fFadeReflection?i:0)),n.setMatrix("offsetMatrix",this.reflectionWorldViewMatrix),n._bindTexture("uSampler1",r?e.outgoingSlideTexture:e.incomingSlideTexture),n._bindTexture("uSampler2",e.reflectionMask),(0,v.drawTriangles)(e),n._bindTexture("uSampler2",e.blackTexture)}}},{key:"calculateDirection",value:function(e,t,r){var i=r,n=0;e.m_fSwivel&&(i=this.swivel.scaledProgress,n=this.swivel.swivelPercent),i=_.MotionFilter.getScaledProgress(e.motionType,i);var a=16*(e.m_distance/100+.65)/9;a*=t?i:-(1-i),1!==n&&0!==n&&(a+=Math.abs(.5-Math.abs(n-.5))/70),this.dirMatrix.translationColumn(a,0,0)}},{key:"doSwivel",value:function(e,t){var r,i,n=t,a=e.m_swivelTime/100,o=e.m_waitTime/100,s=-e.m_swivelAngle*Math.PI/180,l=e.m_swivelZoom/100;n<a+o?(n>a&&(n=a),r=1-(a-n)/a,i=0):n<1-a?(r=1,i=(n-a)/(1-2*a)):(r=(1-n)/a,i=1),this.offsetMatrix.multiply(C.translation(0,0,r*l)),this.offsetMatrix.multiply(C.rotationY(r*s)),this.swivel.scaledProgress=i,this.swivel.swivelPercent=r}},{key:"dispose",value:function(){this.alphaTransition&&this.alphaTransition.dispose(),(0,l.default)((0,c.default)(t.prototype),"dispose",this).call(this)}}])}(h.MeshTransition);t.GalleryTransition=w},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrismTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10)),u=r(55),d=r(33),h=r(28),f=r(22),m=r(29),p=r(23),g=r(21),v=r(32);function y(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var _=function(e){function t(){var e;return(0,n.default)(this,t),(e=y(this,t,arguments)).zMovement=0,e.extraDistance=0,e.vRes=0,e.hRes=0,e}return(0,c.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e,t,r){if(e.useContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void(0,g.logError)("Outgoing textures have not been defined");this.alphaTransition=new u.AlphaTransition(!1),this.alphaTransition.init(e,r),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}this.vRes=e.vres,this.hRes=e.hres,this.zMovement=null!=e.zMovement?e.zMovement:10,this.extraDistance=null!=e.extraDistance?e.extraDistance:0;var i=this.getDrawInfo(f.ProgramId.prism,[m.aPosition,m.aTexcoord,m.aDelay,m.aCenter],!0);if(i){var n=(0,h.perspectiveMatrix)(),a=(0,h.translateScaleMatrix)(-.5,-.5,-.5,2,2,1);return n.multiply(a),i.shaderProgram.setMatrix("uModelViewProj",n),i}}},{key:"internalDraw",value:function(e,t,r){if((0,p.setDepthBlendCulling)(r.engine,!0,t.useContent,1028),t.useContent){if(!this.alphaTransition)return(0,g.logError)("AlphaTransition has not been initialized."),!1;this.alphaTransition.draw(e)}var i=(0,p.bindDrawInfo)(r),n=3.141592653589793,a=2*n/t.sides,o=t.xAxis?1/this.vRes:1/this.hRes,s=e*((t.delayFormula===v.DelayFormula.None?0:1)+a/t.factor+t.jitter/100),l=o/2*Math.tan((n-a)/2);l*=1+this.extraDistance/100,t.inverse&&(l=-l);var c=this.zMovement/10*l/Math.sin((n-a)/2);return i.setFloat("uFactor",t.factor),i.setFloat("uProgress",s),i.setFloat("uDirection",t.invertDirection?-1:1),i.setFloat("uAnglePlus",0),i.setFloat("uMaxAngle",a),i.setFloat("uZCenter",l),i.setFloat("uZmovement",c),i.setFloat("uXAxis",t.xAxis?1:0),i._bindTexture("uSampler1",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),(0,p.drawTriangles)(r),i.setFloat("uAnglePlus",-a),i._bindTexture("uSampler1",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),(0,p.drawTriangles)(r),!0}},{key:"dispose",value:function(){this.alphaTransition&&this.alphaTransition.dispose(),(0,s.default)((0,l.default)(t.prototype),"dispose",this).call(this)}}])}(d.MeshTransition);t.PrismTransition=_},function(e,t,r){"use strict";var i=r(0),n=r(15);Object.defineProperty(t,"__esModule",{value:!0}),t.PushTransition=void 0;var a=i(r(5)),o=i(r(1)),s=i(r(2)),l=i(r(9)),c=i(r(31)),u=i(r(8)),d=i(r(10)),h=r(55),f=r(93),m=r(28),p=r(22),g=r(29),v=r(23),y=r(21),_=r(45),S=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return function(e){return e?r:t}(e)}(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,r&&r.set(e,i),i}(r(76));function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return t=(0,u.default)(t),(0,l.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,u.default)(e).constructor):t.apply(e,r))}var w=function(e){function t(){var e;return(0,o.default)(this,t),(e=C(this,t,arguments)).direction={x:0,y:0},e.modelViewMatrix=new m.ThinMatrix,e}return(0,d.default)(t,e),(0,s.default)(t,[{key:"internalInit",value:function(e,t,r){e.useContent&&e.incomingSlideForeground&&e.outgoingSlideForeground&&(this.alphaTransition=new h.AlphaTransition(!1),this.alphaTransition.init(e,r),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground);var i=this.getDrawInfo(p.ProgramId.alpha,[g.aPosition,g.aTexcoord,g.aDelay]);if(i){var n=i.engine.wrapExternalTexture(e.incomingSlideBackground),a=i.engine.wrapExternalTexture(e.outgoingSlideBackground);switch(this.direction={x:0,y:0},e.direction){case _.kTransitionEffectOptions.Top:this.direction.y=1;break;case _.kTransitionEffectOptions.Bottom:this.direction.y=-1;break;case _.kTransitionEffectOptions.Right:this.direction.x=1;break;case _.kTransitionEffectOptions.Left:default:this.direction.x=-1}return e.forward||(this.direction.x*=-1,this.direction.y*=-1),b(b({},i),{},{incomingSlideTexture:n,outgoingSlideTexture:a})}}},{key:"internalDraw",value:function(e,t,r){(0,v.setDepthBlendCulling)(r.engine,!1,t.useContent),this.alphaTransition&&this.alphaTransition.draw(e);var i=(0,v.bindDrawInfo)(r);i.setFloat("uFactor",1),i.setFloat("uStyle",1);var n=r.incomingSlideTexture,a=r.outgoingSlideTexture;i._bindTexture("uSampler1",t.forward?a:n),i._bindTexture("uSampler2",t.forward?n:a);var o=S.MotionFilter.getScaledProgress(S.MotionType.MotionQuadratic,e);if(!this.direction)return(0,y.logError)("Direction undefined"),!1;var s=o*this.direction.x-.5,l=o*this.direction.y-.5,c=(1-o)*-this.direction.x-.5,u=(1-o)*-this.direction.y-.5;return this.modelViewMatrix.translationScaling(s,l,0,2,2,1),i.setMatrix("uModelViewProj",this.modelViewMatrix),i.setFloat("uProgress",0),(0,v.drawTriangles)(r),this.modelViewMatrix.translationScaling(c,u,0,2,2,1),i.setMatrix("uModelViewProj",this.modelViewMatrix),i.setFloat("uProgress",1),(0,v.drawTriangles)(r),!0}},{key:"dispose",value:function(){this.alphaTransition&&this.alphaTransition.dispose(),(0,c.default)((0,u.default)(t.prototype),"dispose",this).call(this)}}])}(f.Transition);t.PushTransition=w},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.RippleTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(33),u=r(28),d=r(22),h=r(29),f=r(23),m=r(32);function p(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var g=function(e){function t(){return(0,n.default)(this,t),p(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e){e.m_rippleType=e.m_rippleType||m.RippleType.RippleCenter;var t=this.getDrawInfo(d.ProgramId.ripple,[h.aPosition,h.aTexcoord,h.aDistance],!0);if(t){var r=(0,u.defaultViewModelProjectionMatrix)();return t.shaderProgram.setMatrix("uModelViewProj",r),t}}},{key:"internalDraw",value:function(e,t,r){(0,f.setDepthBlendCulling)(r.engine);var i=(0,f.bindDrawInfo)(r);return i.setFloat2("uProgress",3.14159265359*e,e),i._bindTexture("uSampler1",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),i._bindTexture("uSampler2",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),(0,f.drawTriangles)(r),!0}}])}(c.MeshTransition);t.RippleTransition=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WeaveTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(31)),l=i(r(8)),c=i(r(10)),u=r(33),d=r(28),h=r(22),f=r(23),m=r(29);function p(e,t,r){return t=(0,l.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}var g=function(e){function t(){return(0,n.default)(this,t),p(this,t,arguments)}return(0,c.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(e){var t=this.getDrawInfo(h.ProgramId.weave,[m.aPosition,m.aTexcoord,m.aDelay,m.aDirection]);if(t){var r=(0,d.defaultViewModelProjectionMatrix)();if(t.shaderProgram.setMatrix("uModelViewProj",r),this.initModel(e))return t}}},{key:"internalDraw",value:function(e,r,i){(0,f.setDepthBlendCulling)(i.engine),(0,s.default)((0,l.default)(t.prototype),"internalDraw",this).call(this,e,r,i);var n=(0,f.bindDrawInfo)(i);return n.setFloat("uFactor",r.factor),n.setFloat("uProgress",3*e),n.setFloat("uOpacity",1),n._bindTexture("uSampler1",r.forward?i.outgoingSlideTexture:i.incomingSlideTexture),(0,f.drawTriangles)(i),!0}},{key:"dispose",value:function(){(0,s.default)((0,l.default)(t.prototype),"dispose",this).call(this)}}])}(u.MeshTransition);t.WeaveTransition=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ZoomWithSpinTransition=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(9)),s=i(r(8)),l=i(r(10)),c=r(33),u=r(28),d=r(22),h=r(23),f=r(29);function m(e,t,r){return t=(0,s.default)(t),(0,o.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,s.default)(e).constructor):t.apply(e,r))}var p=function(e){function t(){return(0,n.default)(this,t),m(this,t,arguments)}return(0,l.default)(t,e),(0,a.default)(t,[{key:"internalInit",value:function(){var e=this.getDrawInfo(d.ProgramId.zoomWithSpin,[f.aPosition,f.aTexcoord,f.aDelay,f.aCenter],!0);if(e){var t=(0,u.defaultViewModelProjectionMatrix)();return e.shaderProgram.setMatrix("uModelViewProj",t),e}}},{key:"internalDraw",value:function(e,t,r){(0,h.setDepthBlendCulling)(r.engine,!1,!0);var i=(0,h.bindDrawInfo)(r);return i.setFloat("uFactor",1),i.setFloat("uReverseAngle",-1),i.setFloat("uGrowFactor",0),i.setFloat("uOpacitySpeed",0),i.setFloat("uSpinFactor",0),i.setFloat("uTime",1),i._bindTexture("uSampler",t.forward?r.outgoingSlideTexture:r.incomingSlideTexture),(0,h.drawTriangles)(r),i.setFloat("uOpacitySpeed",3),i.setFloat("uTime",1-e),i.setFloat("uSpinFactor",7),i.setFloat("uGrowFactor",-1),i._bindTexture("uSampler",t.forward?r.incomingSlideTexture:r.outgoingSlideTexture),(0,h.drawTriangles)(r),!0}}])}(c.MeshTransition);t.ZoomWithSpinTransition=p},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.isTransitionReadyForDraw=function(e){return null!=e&&!e.isContextLost()},t.BaseTransition=void 0;var n=i(r(1)),a=i(r(2)),o=r(379),s=(0,a.default)((function e(){(0,n.default)(this,e)}),[{key:"init",value:function(e,t){this.gl=e.gl,this.gl&&(this.resourcesManager=new o.ResourcesManager(this.gl,t))}},{key:"dispose",value:function(){if(this.resourcesManager&&(this.resourcesManager.dispose(),this.gl))for(var e=this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),t=0;t<e;t+=1)this.gl.disableVertexAttribArray(t)}},{key:"createBuffer",value:function(){var e;return(null===(e=this.resourcesManager)||void 0===e?void 0:e.createBuffer())||null}},{key:"createTexture",value:function(){var e;return(null===(e=this.resourcesManager)||void 0===e?void 0:e.createTexture())||null}}]);t.BaseTransition=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesManager=void 0;var n=i(r(1));function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var s=(0,i(r(2)).default)((function e(t,r){(0,n.default)(this,e),this.gl=t,this.memoryReport=r,this.buffers=[],this.textures=[]}),[{key:"createBuffer",value:function(){var e=this.gl.createBuffer();return this.buffers.push(e),this.memoryReport.buffers.count+=1,e}},{key:"createTexture",value:function(){var e=this.gl.createTexture();return this.textures.push(e),this.memoryReport.textures.count+=1,e}},{key:"dispose",value:function(){var e,t=a(this.buffers);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.gl.deleteBuffer(r),this.memoryReport.buffers.count-=1}}catch(e){t.e(e)}finally{t.f()}var i,n=a(this.textures);try{for(n.s();!(i=n.n()).done;){var o=i.value;this.gl.deleteTexture(o),this.memoryReport.textures.count-=1}}catch(e){n.e(e)}finally{n.f()}this.buffers.length=0,this.textures.length=0}}]);t.ResourcesManager=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionResourceLoader=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(177),c=r(3),u=r(21),d=function(){return(0,s.default)((function e(t,r){(0,o.default)(this,e),this.m_resourceCache={},this.isCacheEnabled=r||!1,this.wacCDNPath=t}),[{key:"load",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.wacCDNPath){e.next=2;break}return e.abrupt("return",null);case 2:return e.abrupt("return",this.prefetchTransitionResource(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"enableResourceCache",value:function(e){this.isCacheEnabled=e,e||(this.m_resourceCache={})}},{key:"prefetchTransitionResource",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i,a,o,s,d;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isCacheEnabled||!this.m_resourceCache[t]){e.next=3;break}return e.abrupt("return",this.m_resourceCache[t]);case 3:if(r=(0,l.getTransitionResourceId)(t)){e.next=6;break}return e.abrupt("return",null);case 6:return i=performance.now(),a=this.wacCDNPath+r,e.next=10,fetch(a);case 10:return o=e.sent,e.next=13,o.json();case 13:return s=e.sent,this.isCacheEnabled&&(this.m_resourceCache[t]=s),d=performance.now(),c.ULS.sendTraceTag(507331296,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"TransitionResourceLoader::prefetchTransitionResource transitionID:".concat(t,", resourceLoadTime:").concat(d-i)),e.abrupt("return",s);case 20:e.prev=20,e.t0=e.catch(0),(0,u.logError)("Exception at prefetchTransitionResource : ".concat(e.t0," for transitionID:").concat(t));case 23:case"end":return e.stop()}}),e,this,[[0,20]])}))),function(t){return e.apply(this,arguments)})}]);var e,t}();t.TransitionResourceLoader=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MorphTransition=void 0;var n=i(r(1)),a=i(r(2)),o=r(66),s=r(20),l=r(25),c=r(3),u=r(11),d=r(4),h=r(90),f=r(42);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var g=function(){function e(t,r,i,a,l,h){(0,n.default)(this,e),this.createdItems=[],this.fallbackReasons=new Set,this.isForwards=!1,this.m_cameoViewElements=[],this.m_isDisposed=!1,this.metadata={numFallbackElement:0,numTextElement:0,numOtherElement:0,numCameoElement:0},this.m_environment=t,this.morph=new s.Morph,l.slideSizePixels.x===h.slideSizePixels.x&&l.slideSizePixels.y===h.slideSizePixels.y||c.ULS.sendTraceTag(591984863,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"MorphTransition::createMorphKeyFrame: slide size mismatch."),this.m_slideSizePixels=h.slideSizePixels;var f,p=new s.Vector2(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(d.Settings.readNumberOrDefault("hackMorphRenderSizeScale",1)),g=this.m_environment.rendererEnvironment.calculateRenderTransform(l.slideSizePixels),v=this.m_environment.rendererEnvironment.calculateRenderTransform(h.slideSizePixels),y=this.m_environment.rendererEnvironment.calculateRenderTransform(r.slideSizePixels),_=this.m_environment.rendererEnvironment.calculateRenderTransform(p),S=g.toMatrix3().multiply(_.toInverseMatrix3()),T=v.toMatrix3().multiply(_.toInverseMatrix3()),b=y.toMatrix3().multiply(_.toInverseMatrix3()),C=m(r.elements);try{for(C.s();!(f=C.n()).done;){var w=f.value,P=[this.createMorphKeyFrame(w.keyFrameA,l,S,b),this.createMorphKeyFrame(w.keyFrameB,h,T,b)],I=new s.MorphElement(P);if(I.keyFrames[0]&&I.keyFrames[0].contents[0]&&I.keyFrames[0].contents[0].item&&I.keyFrames[1]&&I.keyFrames[1].contents[0]&&I.keyFrames[1].contents[0].item){var k,E=m(this.m_cameoViewElements);try{for(E.s();!(k=E.n()).done;){var x=k.value;if(x.shapeItem===I.keyFrames[0].contents[0].item||x.shapeItem===I.keyFrames[1].contents[0].item){I.hasDynamicContent=!0;break}}}catch(e){E.e(e)}finally{E.f()}}I.rotateClockwise=w.rotateClockwise,this.morph.elements.push(I)}}catch(e){C.e(e)}finally{C.f()}if(i===o.kTransitionIds.PPT_TRANSITION_PAN)switch(a){case o.kTransitionEffectOptions.Left:this.morph.panVector=new s.Vector2(-this.m_slideSizePixels.x,0);break;case o.kTransitionEffectOptions.Top:this.morph.panVector=new s.Vector2(0,-this.m_slideSizePixels.y);break;case o.kTransitionEffectOptions.Right:this.morph.panVector=new s.Vector2(this.m_slideSizePixels.x,0);break;case o.kTransitionEffectOptions.Bottom:this.morph.panVector=new s.Vector2(0,this.m_slideSizePixels.y)}if(c.ULS.sendTraceTag(592197024,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,JSON.stringify(this.metadata)),!u.ChangeGate.isChangeGateEnabled("SSC.CheckMorphZPos")){var L,A=[new Set,new Set],M=m(this.morph.elements);try{for(M.s();!(L=M.n()).done;)for(var R=L.value,O=0;O<2;O+=1){var D=R.keyFrames[O]?R.keyFrames[O].zPosition:void 0;if(void 0!==D){if(A[O].has(D))return void this.fallbackReasons.add("duplicate z position");A[O].add(D)}}}catch(e){M.e(e)}finally{M.f()}}}return(0,a.default)(e,[{key:"createMorphKeyFrame",value:function(t,r,i,n){var a=this;if(t){var o=[];if(t.isBg){var u,d={slideId:r.slideId,shapeId:-1},p=m(r.shapeViewElements.filter((function(e){return e.id.slideId.sid===d.slideId.sid&&e.id.shapeId===d.shapeId})));try{for(p.s();!(u=p.n()).done;){var g=u.value;if(g.shapeItem){var v={item:g.shapeItem,textRange:void 0,includeSubtree:!0};o.push(v),this.metadata.numOtherElement+=1}}}catch(e){p.e(e)}finally{p.f()}}var y,_=m(t.parts);try{var S=function(){var e=y.value,t=r.shapeViewElements.find((function(t){return e.shapeId?t.id.slideId.sid===e.shapeId.slideId.sid&&t.id.shapeId===e.shapeId.shapeId:void 0}));if(t&&t.shapeItem){var i=t.shapeItem,n=t.shapeType===l.ShapeType.Cameo&&!a.m_cameoViewElements.includes(t);n&&a.m_cameoViewElements.push(t),e.bigPart&&(i=(0,h.findItem)(i,e.bigPart)||i);var u=void 0,d=(0,h.getTextItem)(i);e.textRange&&(d&&d.text?(u=new s.TextRange(e.textRange.begin,e.textRange.length),i=d):(c.ULS.sendTraceTag(593020765,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"MorphTransition::createMorphKeyFrame: text not found for shapebuilder shape."),a.fallbackReasons.add("text missing")));var f={item:i,textRange:u,includeSubtree:e.isSubtreeIncluded};o.push(f),u?a.metadata.numTextElement+=1:n?a.metadata.numCameoElement+=1:a.metadata.numOtherElement+=1}};for(_.s();!(y=_.n()).done;)S()}catch(e){_.e(e)}finally{_.f()}if(0===o.length){var T,b=m(t.parts);try{for(b.s();!(T=b.n()).done;){var C,w=T.value,P=void 0,I=void 0,k=m(r.shapeViewElements);try{for(k.s();!(C=k.n()).done;){var E=C.value;if(w.animatableContentId){var x,L=m(E.animatableContentViewElements);try{for(L.s();!(x=L.n()).done;){var A=x.value,M=w.animatableContentId.toString();A.id===M&&(P=E,I=A)}}catch(e){L.e(e)}finally{L.f()}}}}catch(e){k.e(e)}finally{k.f()}if(P&&P.shapeItem&&I){var R=P.shapeItem;if(w.animatablePartIndicies&&0!==w.animatablePartIndicies.length){var O,D=m(w.animatablePartIndicies);try{for(D.s();!(O=D.n()).done;){var F=O.value,B={item:(0,h.findItem)(R,"".concat(I.id,"c").concat(F))||R,includeSubtree:!1};o.push(B),this.metadata.numFallbackElement+=1}}catch(e){D.e(e)}finally{D.f()}}else{var N={item:(0,h.findItem)(R,I.id)||R,includeSubtree:!1};o.push(N),this.metadata.numFallbackElement+=1}}}}catch(e){b.e(e)}finally{b.f()}}if(0===o.length&&t.fallbackImage){var V=this.m_environment.viewDataManager.imageDataMap.get(t.fallbackImage.imgID);if(V&&V.size){var U=V.size,W=V.size,G=V.size.scale(.5);f.ShapeViewElementUtils.verifyTextureSize(this.m_environment,"morph_fallback",U);var H=new s.ImageContainer;H.id=t.fallbackImage.imgID,this.m_environment.rendererEnvironment.attachImage("MorphImageFallback",H,V,V.size);var j=new s.ImageBrush(H);j.scale=W.divide(U),j.offset=W.scale(.5).subtract(G).divide(U);var z=new s.Rect(t.fallbackImage.rect.left,t.fallbackImage.rect.top,t.fallbackImage.rect.right,t.fallbackImage.rect.bottom),q=s.Shape.CreateRectangle(z,new s.Style(j));this.createdItems.push(q);var Z={item:q,includeSubtree:!1};o.push(Z),this.metadata.numFallbackElement+=1}else c.ULS.sendTraceTag(592561536,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"MorphTransition::createMorphKeyFrame: fallback image not found for shapebuilder shape."),this.fallbackReasons.add("fallback image missing")}var X={center:n?e.toVector2(t.center).transformPoint(n):e.toVector2(t.center),flipX:t.flipX,flipY:t.flipY,rotation:t.angleRadians,size:n?e.toVector2(t.size).transformVector(n):e.toVector2(t.size)},Y=t.grid?{data:t.grid.data,size:e.toVector2(t.grid.size)}:void 0;return new s.MorphKeyFrame(o,X,t.zIndex,Y,i)}}},{key:"init",value:function(e){}},{key:"tryPrepareMorph",value:function(e){return this.m_isDisposed?(c.ULS.sendTraceTag(520681372,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"MorphTransition tried to prepare after being disposed."),!0):this.m_environment.rendererEnvironment.renderer.tryPrepareMorph(this.morph,e)}},{key:"draw",value:function(t){if(this.m_isDisposed)return c.ULS.sendTraceTag(520681371,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"MorphTransition tried to draw after being disposed."),!1;var r,i=m(this.m_cameoViewElements);try{for(i.s();!(r=i.n()).done;)r.value.ensureCameoTextureAttached()}catch(e){i.e(e)}finally{i.f()}(d.Settings.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||d.Settings.readBooleanOrDefault("enableCameoInT2",!1))&&this.m_cameoViewElements.length>0&&this.m_environment.updateCameoTextureFromVideoElement();var n=this.isForwards?e.applyShotgunToPillowCurve(t):1-e.applyShotgunToPillowCurve(1-t),a=new s.Vector2(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(d.Settings.readNumberOrDefault("hackMorphRenderSizeScale",1)),o=this.m_environment.rendererEnvironment.calculateRenderTransform(a);return this.m_environment.rendererEnvironment.renderer.renderMorph(this.morph,n,s.Color.White,o),!0}},{key:"dispose",value:function(){this.morph.clearCache();var e,t=m(this.createdItems);try{for(t.s();!(e=t.n()).done;)e.value.releaseGeneratedResources()}catch(e){t.e(e)}finally{t.f()}this.m_isDisposed=!0}}],[{key:"toVector2",value:function(e){return new s.Vector2(e.x,e.y)}},{key:"applyShotgunToPillowCurve",value:function(e){return.5-.5*Math.cos(2*Math.PI*(1-1/(e+1)))}}])}();t.MorphTransition=g},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PowerPointResourceProvider=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=i(r(5)),c=r(26),u=r(3),d=r(179),h=function(){function e(t,r){(0,o.default)(this,e),(0,l.default)(this,"loadResults",[]),(0,l.default)(this,"events",new c.EventEmitter),(0,l.default)(this,"loader",void 0),(0,l.default)(this,"policy",void 0),(0,l.default)(this,"ongoingLoads",new Map),this.loader=t,this.policy=r}return(0,s.default)(e,[{key:"load",value:(t=(0,a.default)(n.default.mark((function t(r,i){var a,o,s,l,c;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=this.getLoadResultInCache(r,i))){t.next=3;break}return t.abrupt("return",a);case 3:if(o={resourceId:r,metadata:{errorName:"ErrorResourceNotFound"}},!this.policy||this.policy.shouldLoad(this,i)){t.next=7;break}return o.metadata.errorName="ErrorResourceNotAllowed",t.abrupt("return",o);case 7:if(this.loader){t.next=10;break}return o.metadata.errorName="ErrorResourceLoaderNotAvailable",t.abrupt("return",o);case 10:return s="".concat(r,"_").concat(JSON.stringify(e.removeMetadata(i))),(l=this.ongoingLoads.get(s))||(l=this.loader.load(r,i),this.ongoingLoads.set(s,l)),t.prev=13,t.next=16,l;case 16:c=t.sent,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(13),u.ULS.sendTraceTag(508842323,u.LogCategory.msoulscat_Wac_PptLive,u.TraceLevel.Warning,"unexpected error on load: ".concat(t.t0 instanceof Error&&d.stringifyError?(0,d.stringifyError)(t.t0):t.t0));case 22:if(this.ongoingLoads.delete(s),c){t.next=26;break}return u.ULS.sendTraceTag(508842322,u.LogCategory.msoulscat_Wac_PptLive,u.TraceLevel.Error,"PowerPointResourceProvider::load - failed to load resource. ".concat(JSON.stringify({requestedLoadKey:s,resourceIdsInCache:JSON.stringify(this.getAllLoadResultsInCache().map((function(e){return e.resourceId})))}))),t.abrupt("return",o);case 26:if(c.resource){t.next=28;break}return t.abrupt("return",c);case 28:return c.options=i,t.abrupt("return",this.add(c));case 30:case"end":return t.stop()}}),t,this,[[13,19]])}))),function(e,r){return t.apply(this,arguments)})},{key:"add",value:function(t){var r=this.getLoadResultInCache(t.resourceId,t.options);if(r)return r;var i=e.removeMetadata(t.options);return t.options=i,t.metadata.created=t.metadata.created?t.metadata.created:new Date,t.metadata.lastAccessed=new Date,t.metadata.resourceUsers=[],t.metadata.optionsKey=JSON.stringify(i),this.loadResults.push(t),e.updateMetadata(t,t.options),t}},{key:"remove",value:function(e,t){var r=this.getLoadResultInCache(e,t);if(!r)return!1;var i=this.loadResults.splice(this.loadResults.indexOf(r),1);return this.events.emit("removed",i),!0}},{key:"getAllLoadResultsInCache",value:function(){return this.loadResults}},{key:"getLoadResultsInCache",value:function(e){return this.loadResults.filter((function(t){return t.resourceId===e}))}},{key:"getLoadResultInCache",value:function(t,r){var i=JSON.stringify(e.removeMetadata(r)),n=this.loadResults.filter((function(e){return e.resourceId===t&&e.metadata.optionsKey===i}))[0];if(n)return e.updateMetadata(n,r),n}}],[{key:"removeMetadata",value:function(e){if(void 0!==e){var t=Object.keys(e).filter((function(e){return!e.startsWith("meta_")}));if(0!==t.length){var r={};return t.map((function(t){r[t]=e[t]})),r}}}},{key:"updateMetadata",value:function(e,t){t&&(e.metadata.lastAccessed=new Date,t.meta_user&&!e.metadata.resourceUsers.includes(t.meta_user)&&e.metadata.resourceUsers.push(t.meta_user))}}]);var t}();t.PowerPointResourceProvider=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowCoreResourcePolicy=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(178);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=(0,a.default)((function e(t,r,i,a){(0,n.default)(this,e),(0,o.default)(this,"capacity",void 0),(0,o.default)(this,"inUseFunction",void 0),(0,o.default)(this,"compareFunction",void 0),(0,o.default)(this,"costFunction",s.defaultCostFunction),this.capacity=t,this.inUseFunction=r,this.compareFunction=i,this.costFunction=a||s.defaultCostFunction}),[{key:"shouldLoad",value:function(e,t){return!this.atCapacity(e)||!!(t&&t.meta_user&&this.inUseFunction([t.meta_user]))}},{key:"atCapacity",value:function(e){return this.calculateCost(e)>this.capacity}},{key:"clean",value:function(e){if(this.atCapacity(e)){var t=this.calculateCost(e)-this.capacity,r=e.getAllLoadResultsInCache();r.sort(this.compareFunction);var i,n=l(r);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(!this.inUseFunction(a.metadata.resourceUsers)&&a.resource){var o=this.costFunction(a.resource);if(e.remove(a.resourceId,a.options)&&(t-=o),t<=0)break}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"calculateCost",value:function(e){var t,r=0,i=l(e.getAllLoadResultsInCache());try{for(i.s();!(t=i.n()).done;){var n=t.value;n.resource&&(r+=this.costFunction(n.resource))}}catch(e){i.e(e)}finally{i.f()}return r}}]);t.SlideShowCoreResourcePolicy=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BatchResourceProvider=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=i(r(9)),c=i(r(8)),u=i(r(10)),d=i(r(5)),h=r(83),f=r(3);var m=function(e){function t(e,r,i){var n;return(0,o.default)(this,t),n=function(e,t,r){return t=(0,c.default)(t),(0,l.default)(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return!!e}()?Reflect.construct(t,r||[],(0,c.default)(e).constructor):t.apply(e,r))}(this,t,[r,i]),(0,d.default)(n,"m_batchLoader",void 0),(0,d.default)(n,"ongoingBatchLoads",new Map),n.m_batchLoader=e,n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"batchLoad",value:(r=(0,a.default)(n.default.mark((function e(t){var r,i,a,o,s,l,c,u,d,m=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t&&!(t.length<=0)){e.next=4;break}return f.ULS.sendTraceTag(508842325,f.LogCategory.msoulscat_Wac_PptLive,f.TraceLevel.Error,"BatchResourceProvider::batchLoad - Invalid loadRequestList"),e.abrupt("return",[]);case 4:for(r=[],i=[],a=0;a<t.length;a+=1)o=t[a],(s=this.getLoadResultInCache(o.resourceId,o.options))?i.push(s):(l="".concat(o.resourceId,"_").concat(JSON.stringify(h.PowerPointResourceProvider.removeMetadata(o.options))),this.ongoingBatchLoads.get(l)||r.push(o));if(r.length>0&&(c=this.m_batchLoader.batchLoad(r),r.forEach((function(e){if(c){var t="".concat(e.resourceId,"_").concat(JSON.stringify(h.PowerPointResourceProvider.removeMetadata(e.options)));m.ongoingBatchLoads.set(t,c)}}))),u=[],!c){e.next=14;break}return e.next=12,c;case 12:u=e.sent,r.forEach((function(e){var t="".concat(e.resourceId,"_").concat(JSON.stringify(h.PowerPointResourceProvider.removeMetadata(e.options)));m.ongoingBatchLoads.delete(t)}));case 14:return u.forEach((function(e){m.add(e)})),d=i.concat(u),e.abrupt("return",d);case 19:return e.prev=19,e.t0=e.catch(0),f.ULS.sendTraceTag(508842324,f.LogCategory.msoulscat_Wac_PptLive,f.TraceLevel.Error,"BatchResourceProvider::batchLoad - exception occured: ".concat(e.t0)),e.abrupt("return",[]);case 23:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e){return r.apply(this,arguments)})}]);var r}(h.PowerPointResourceProvider);t.BatchResourceProvider=m},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLRendererEnvironment=void 0;var n,a=i(r(6)),o=i(r(5)),s=i(r(7)),l=i(r(1)),c=i(r(2)),u=r(3),d=r(20),h=r(35),f=r(66),m=r(118),p=r(42),g=r(14),v=r(4),y=r(77),_=r(11),S=r(26);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return w(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}!function(e){e[e.ShapeBuilder=0]="ShapeBuilder",e[e.Transitions=1]="Transitions"}(n||(n={}));var P=function(){return(0,c.default)((function e(t){(0,l.default)(this,e),this.supportsTransitions=!0,this.supportsGif=!0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,this.m_tech="WebGL",this.events=new S.EventEmitter,u.ULS.sendTraceTag(561639874,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"creating WebGLRendererEnvironment"),console.log("creating WebGLRendererEnvironment"),this.m_shapeBuilderCanvasContext=t,t.addUser(this.events),t.events.on("initStateRestorer",this.onInitStateRestorer.bind(this)),t.events.on("contextLost",this.onContextLost.bind(this)),t.events.on("contextRestored",this.onContextRestored.bind(this)),t.events.on("restoreContextFailed",this.onRestoreContextFailed.bind(this)),t.events.on("logContextCreation",this.logContextCreation.bind(this)),t.events.on("logContextCreationError",this.logContextCreationError.bind(this)),h.exposed.createImageFromTexture=this.createImageFromTexture.bind(this)}),[{key:"gl",get:function(){return this.m_shapeBuilderCanvasContext.gl}},{key:"isGLContextValid",get:function(){return!!this.gl&&!this.gl.isContextLost()}},{key:"isSBValid",get:function(){return this.m_shapeBuilderCanvasContext.isReady}},{key:"glContext",get:function(){return this.gl}},{key:"renderer",get:function(){return this.m_shapeBuilderCanvasContext.renderer}},{key:"webGLRenderer",get:function(){return this.renderer}},{key:"canvas",get:function(){return this.m_shapeBuilderCanvasContext.canvas}},{key:"tech",get:function(){return this.m_tech}},{key:"clientSize",get:function(){return this.viewController.getBounds.getClientSizeFromCanvas()}},{key:"onInitStateRestorer",value:function(){this.setRenderingScenario(n.ShapeBuilder)}},{key:"logContextCreation",value:function(e){if(!e.fSuccess)return u.ULS.sendTraceTag(561639883,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Unable to initialize WebGL"),void g.VetoUtils.recordVeto("SetupWebGLContextFailed",{msg:m.ErrorCode.SetupWebGLContextFailed});e.data&&(h.ViewController.s_rendererTech=e.data.rendererTech,e.data.unmaskedRenderer&&(h.ViewController.s_isBadGpu=v.Settings.readStringOrDefault("badGpuList","").toLowerCase().indexOf(e.data.unmaskedRenderer)>=0),h.ViewController.s_gpuHardwareDisabled=e.data.hasPerfCaveat,e.data.hasPerfCaveat&&u.ULS.sendTraceTag(520897678,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"WebGL initialized with gpu hardware disabled"),u.ULS.sendTraceTag(561639882,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"WebGL initialized ".concat(JSON.stringify({rendererTech:h.ViewController.s_rendererTech,isBadGpu:h.ViewController.s_isBadGpu,fPerfCaveat:h.ViewController.s_gpuHardwareDisabled}))))}},{key:"setRenderingScenario",value:function(e){if(e!==this.m_renderingScenario){var t=this.renderer.getBabylonEngine();t&&t.wipeCaches(!0),this.m_renderingScenario=e}}},{key:"removeCanvas",value:function(e){this.releaseResources(),this.m_shapeBuilderCanvasContext.removeCanvas(e),this.isCanvasSizeSet=!1}},{key:"releaseResources",value:function(){this.viewController.viewDataManager.imageDataMap=new Map,this.viewController.viewDataManager.memoryStats.gifTextures=0,this.viewController.viewDataManager.memoryStats.transitionTextures=0,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport=new f.MemoryReport,this.viewController.viewDataManager.memoryStats.videoTextures=0,this.viewController.viewDataManager.memoryStats.cameoTextures=0;var e,t=C(this.viewController.viewDataManager.externalTexturesToRelease);try{for(t.s();!(e=t.n()).done;)e.value.texture.release()}catch(e){t.e(e)}finally{t.f()}this.viewController.viewDataManager.externalTexturesToRelease=[];var r,i=C(this.viewControllerInternals.slideSceneView);try{for(i.s();!(r=i.n()).done;){var n=r.value;n.scene&&this.viewControllerInternals.deleteScene(n),n.slideViewElement.shapeViewElements=[]}}catch(e){i.e(e)}finally{i.f()}this.events.emit("releasedResources"),h.exposed.gl=this.gl}},{key:"setupCanvas",value:function(e){this.m_shapeBuilderCanvasContext.setupCanvas(e,{useRemovableCanvas:this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled,useZIndex1:this.viewControllerInternals.settings.transparentCanvasForVideoEnabled}),h.exposed.gl=this.gl,this.canvas.style.pointerEvents="none",this.isCanvasSizeSet=!1}},{key:"setCanvasSize",value:function(e,t){var r=e.scale(window.devicePixelRatio*t),i=new d.Vector2(Math.round(r.x),Math.round(r.y));this.m_shapeBuilderCanvasContext.setCanvasSize(e,i)&&(this.isCanvasSizeSet=!0,this.devicePixelsToRenderedPixelsScale=t)}},{key:"calculateRenderTransform",value:function(e){var t=this.getPixelScale(e),r=Math.min(t.x,t.y);return new d.Transform(new d.Vector2(-e.x/2,-e.y/2),new d.Vector2(r,r),void 0,new d.Vector2(this.canvas.width/2,this.canvas.height/2))}},{key:"calculateRenderTransformWithZoom",value:function(e,t,r){var i=this.getPixelScale(e),n=t,a=r;return n&&a||(n=Math.min(i.x,i.y),a=new d.Vector2(n*e.x/2,n*e.y/2)),new d.Transform(new d.Vector2(-e.x/2,-e.y/2),new d.Vector2(n,n),void 0,(0,y.calculateTranslationForAlignment)(new d.Vector2(this.clientSize.x/2,this.clientSize.y/2),a,e,n,window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale))}},{key:"preloadShadersAsync",value:(r=(0,s.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_shapeBuilderCanvasContext.preloadShadersAsync(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:function(){this.gl&&this.gl.flush()}},{key:"getPerformanceSummary",value:function(){return this.renderer.getPerformanceSummary()}},{key:"generateTextureMemoryReport",value:function(e,t){return this.renderer.generateTextureMemoryReport(e,t)}},{key:"verifyGlyphCacheIntegrityAndTryRecover",value:function(){return this.renderer.verifyGlyphCacheIntegrityAndTryRecover()}},{key:"attachImage",value:function(e,t,r,i){if(!r.texture)throw u.ULS.sendTraceTag(561639876,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"texture missing"),new Error("texture missing");var n=new d.Texture(e,this.renderer,r.texture,i,d.TextureFormat.RGBA,d.WrapMode.clamp,d.TextureReleasePolicy.ExternallyManaged);r.size.equals(i)||u.ULS.sendTraceTag(559269018,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"attachImage imageData.size:".concat(JSON.stringify(r.size)," != size:").concat(JSON.stringify(i))),t.id||u.ULS.sendTraceTag(561639877,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Missing imageContainer.id: ".concat(t.id)),this.viewController.viewDataManager.externalTexturesToRelease.push({imageId:t.id||"unknown",texture:n}),this.renderer.attachTextureToImage(t,n)}},{key:"releaseImageData",value:function(e){e.texture&&this.gl&&this.gl.deleteTexture(e.texture)}},{key:"saveImageData",value:function(e,t,r,i,n){var a=this.gl;if(!a)return u.ULS.sendTraceTag(561639878,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"No webGL Context found"),{errorName:m.ErrorCode.CannotLoadTextureNoWebGLContext};var o=a.createTexture();if(!o)return u.ULS.sendTraceTag(561639879,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Failed to create texture"),{errorName:m.ErrorCode.CreateTextureFailed};if(v.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){var s=v.Settings.readNumberOrDefault("maxSvgTextureSize",2048),l=Math.max(t.size.width,t.size.height),c=n.x/i.x,h=n.y/i.y,f=l*Math.min(c,h)*(i.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(Math.max(e.naturalHeight,e.naturalWidth,f),s),u.ULS.sendTraceTag(561639880,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"loadImageTexture: SVG width = ".concat(e.width,"px, height = ").concat(e.height))}a.bindTexture(a.TEXTURE_2D,o),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null);var p=e.ID,g=this.viewController.viewDataManager.imageDataMap.get(p);return g&&(this.viewController.viewDataManager.memoryStats.externalTextureLeaks+=g.size.x*g.size.y*4,v.Settings.readBooleanOrDefault("releaseExistingExternalImages",!1)&&(this.releaseImageData(g),this.viewController.viewDataManager.onExternalTextureReleased(p))),this.viewController.viewDataManager.imageDataMap.set(p,{dataUri:e.src,texture:o,size:new d.Vector2(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[r]}),u.ULS.sendTraceTag(561639881,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"loadImageTexture - loaded ".concat(JSON.stringify({id:e.ID,slideId:r,size:new d.Vector2(e.width,e.height),naturalSize:new d.Vector2(e.naturalWidth,e.naturalHeight),byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType}))),{}}},{key:"createTransition",value:(t=(0,s.default)(a.default.mark((function e(t,r,i,o,s,l,c){var u,m,p,g,v,y,S,T,b,w,P,I,k,E,x,L,A,M,R,O,D,F,B,N,V,U,W,G,H,j,z=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u={fSuccess:!1},m=t.type,p=t.dir,g=t.dur,v={},u.effectId=m,y=c&&c.correlationId,S={aspectRatio:s,direction:p,forward:o,gl:this.gl,engine:this.renderer.getBabylonEngine()},w=!0,P=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(P=h.ViewController.performanceNowTrimmed()),I=this.viewController.getSlideViewElement(i),k=this.viewController.getSlideViewElement(r),_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(v.getSlideViewElementMS=h.ViewController.performanceNowTrimmed()-P),E=function(){},x=function(){},!(l&&I&&k&&t.morph)||m!==f.kTransitionIds.PPT_TRANSITION_MORPH&&m!==f.kTransitionIds.PPT_TRANSITION_PAN){e.next=37;break}if(_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(u.metadata||(u.metadata={}),v.morphTransitionFlow=!0),L=this.viewController.viewDataManager.getSlideIndex(i),A=this.viewController.viewDataManager.getSlideIndex(r),!(M=this.slideIdsToMorphKey(i,r))||-1===L||-1===A||1!==Math.abs(A-L)){e.next=29;break}return R=0,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(R=h.ViewController.performanceNowTrimmed()),e.next=26,this.viewControllerInternals.morphCache.load(M,{meta_prevSlideId:o?i:r,meta_nextSlideId:o?r:i});case 26:O=e.sent,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(v.generateMorphResource=h.ViewController.performanceNowTrimmed()-R),O.resource&&((b=O.resource).tryPrepareMorph(),D=this.morphKeyToSlideIds(M),b.isForwards=D.slideIdA.sid===i.sid&&D.slideIdA.cid===i.cid);case 29:if(b){e.next=31;break}return e.abrupt("return",{fSuccess:!1});case 31:if(!(b.fallbackReasons.size>0)){e.next=33;break}return e.abrupt("return",{fSuccess:!1,metadata:{fallbackReasons:Array.from(b.fallbackReasons).join(", ")}});case 33:T=b,u.metadata=b.metadata,e.next=55;break;case 37:return F=[],!this.viewControllerInternals.transitionFactory.isTransitionDisabled(m,p)&&(0,f.isContentTransition)(m,p)?(B=0,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(B=h.ViewController.performanceNowTrimmed()),N={incomingSlideBackground:this.renderToTexture(r,{renderFilter:h.ViewController.createRenderBackgroundOrForegroundFilter(!0),correlationId:y,isContentTransition:!0}),outgoingSlideBackground:this.renderToTexture(i,{renderFilter:h.ViewController.createRenderBackgroundOrForegroundFilter(!0),correlationId:y,isContentTransition:!0}),incomingSlideForeground:this.renderToTexture(r,{renderFilter:h.ViewController.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:d.Color.Transparent,correlationId:y,isContentTransition:!0}),outgoingSlideForeground:this.renderToTexture(i,{renderFilter:h.ViewController.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:d.Color.Transparent,correlationId:y,isContentTransition:!0})},_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(v.renderTransitionTextures=h.ViewController.performanceNowTrimmed()-B),S.incomingSlideBackground=N.incomingSlideBackground?N.incomingSlideBackground.tryGetWebGLTexture():void 0,S.outgoingSlideBackground=N.outgoingSlideBackground?N.outgoingSlideBackground.tryGetWebGLTexture():void 0,S.incomingSlideForeground=N.incomingSlideForeground?N.incomingSlideForeground.tryGetWebGLTexture():void 0,S.outgoingSlideForeground=N.outgoingSlideForeground?N.outgoingSlideForeground.tryGetWebGLTexture():void 0,F=Object.values(N)):(V=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(V=h.ViewController.performanceNowTrimmed()),U={incomingSlideBackground:this.renderToTexture(r,{correlationId:y}),outgoingSlideBackground:this.renderToTexture(i,{correlationId:y})},_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(v.renderToTexture=h.ViewController.performanceNowTrimmed()-V),S.incomingSlideBackground=U.incomingSlideBackground?U.incomingSlideBackground.tryGetWebGLTexture():void 0,S.outgoingSlideBackground=U.outgoingSlideBackground?U.outgoingSlideBackground.tryGetWebGLTexture():void 0,F=Object.values(U)),W=new d.Vector2(this.canvas.width,this.canvas.height),this.setRenderingScenario(n.Transitions),G=new f.SlideTransitionInfo(S),H=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(H=h.ViewController.performanceNowTrimmed()),e.next=46,this.viewControllerInternals.transitionFactory.getTransition(m,p,G,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport);case 46:if(j=e.sent,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(v.transitionFactoryMS=h.ViewController.performanceNowTrimmed()-H),j.transition){e.next=51;break}return u.isSupported=!1,e.abrupt("return",u);case 51:w=j.isSupported,T=j.transition,E=function(){var e=z.gl;if(e&&!e.isContextLost()){var t,r=C(F);try{for(r.s();!(t=r.n()).done;){var i=t.value;i&&(z.viewController.viewDataManager.memoryStats.transitionTextures-=W.x*W.y*4,i.release())}}catch(e){r.e(e)}finally{r.f()}T.dispose()}},x=function(){z.setRenderingScenario(n.Transitions)};case 55:return this.viewControllerInternals.transitionController=new h.TransitionController(T,g,o,x,E),u.fSuccess=!0,u.isSupported=w,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(u.metadata||(u.metadata={}),u.metadata.rendererEnvironment=v),e.abrupt("return",u);case 60:case"end":return e.stop()}}),e,this)}))),function(e,r,i,n,a,o,s){return t.apply(this,arguments)})},{key:"enableVerboseRenderLogging",value:function(e){this.renderer.enableVerboseRenderLogging(e)}},{key:"getPixelScale",value:function(e){var t=this.clientSize.x/e.x,r=this.clientSize.y/e.y;return new d.Vector2(t,r).scale(window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale)}},{key:"logContextCreationError",value:function(e){u.ULS.sendTraceTag(555018370,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"Unable to initialize WebGL - ".concat(e.statusMessage||"Unknown error"))}},{key:"onContextLost",value:function(){u.ULS.sendTraceTag(561639884,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"WebGL context lost. CurrentSceneCount:".concat(this.viewControllerInternals.currentSceneCount,", MaxSceneCount:").concat(this.viewControllerInternals.forwardSceneCount+this.viewControllerInternals.backwardSceneCount+1,",\n       CurrentRenderedSlideId:").concat(JSON.stringify(this.viewControllerInternals.currentRenderedSlideId),", SlideSize:").concat(JSON.stringify(this.viewController.slideSizeEmus),",\n        CanvasWidth:").concat(this.canvas.width,", CanvasHeight:").concat(this.canvas.height,",\n        CanvasSizeWidth:").concat(this.clientSize.x,", CanvasSizeHeight:").concat(this.clientSize.y,",\n        DPI:").concat(window.devicePixelRatio,", ImageTextureMapSize:").concat(this.viewController.viewDataManager.imageDataMap.size,",\n        MemoryStats:").concat(JSON.stringify(this.viewController.viewDataManager.memoryStats))),this.viewController.viewDataManager.imageDataMap.forEach((function(e,t){u.ULS.sendTraceTag(561639885,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"WebGL context lost. imageDataMap Key:".concat(t," Size:").concat(JSON.stringify(e.size)," SlideIds:").concat(JSON.stringify(e.loadedSlideIDs)," Memory:").concat(e.size.x*e.size.y*4))}));var e=this.viewControllerInternals.slideSceneView.filter((function(e){return e.scene})).map((function(e){return e.scene})),t=this.viewControllerInternals.morphCache.getAllLoadResultsInCache().filter((function(e){return e.resource})).map((function(e){return e.resource.morph}));u.ULS.sendTraceTag(561639886,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"WebGL context lost. SB Scene Memory:".concat(JSON.stringify(this.generateTextureMemoryReport(e,t)))),this.releaseResources(),this.viewController.events.emit("webglcontextlost")}},{key:"onRestoreContextFailed",value:function(){u.ULS.sendTraceTag(561639887,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"webglcontextrestored not raised after 3 seconds"),this.viewController.events.emit("restoreWebGLContextFailed")}},{key:"renderToTexture",value:function(e,t){if(this.gl){var r=new d.Vector2(this.canvas.width,this.canvas.height);p.ShapeViewElementUtils.verifyTextureSize(this.viewController,"transition",r);var i=new d.TargetTexture("Transition",this.renderer,r,d.TextureReleasePolicy.KeepUntilRelease);if(i.tryGetWebGLTexture()){this.viewController.viewDataManager.memoryStats.transitionTextures+=this.canvas.width*this.canvas.height*4,u.ULS.sendTraceTag(561639888,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Info,"ViewController::renderToTexture - SlideId: ".concat(e.sid));var n={zoomLevel:v.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},a=!v.Settings.readBooleanOrDefault("saveVerifyGlyphForTransition",!1),o=this.viewController.renderSlideByIdExtended(e,!0,i,t&&t.renderFilter,t&&t.backgroundColor,a,!1,n);return u.ULS.sendTraceTag(507650462,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Warning,"".concat(JSON.stringify(b(b({},o),{},{correlationId:t&&t.correlationId,isContentTransition:t&&t.isContentTransition})))),i}}}},{key:"slideIdsToMorphKey",value:function(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?"".concat(JSON.stringify(e),"_").concat(JSON.stringify(t)):"".concat(JSON.stringify(t),"_").concat(JSON.stringify(e))}},{key:"morphKeyToSlideIds",value:function(e){var t=e.split("_");return{slideIdA:JSON.parse(t[0]),slideIdB:JSON.parse(t[1])}}},{key:"onContextRestored",value:(e=(0,s.default)(a.default.mark((function e(){var t,r,i,n,o=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.exposed.gl=this.gl,!this.viewControllerInternals.currentRenderedSlideId){e.next=14;break}if(!(t=this.viewControllerInternals.slideSceneView.find((function(e){return e.slideId.sid===o.viewControllerInternals.currentRenderedSlideId.sid})))){e.next=14;break}return e.next=6,this.viewControllerInternals.createImageTextureMapData(t);case 6:return(r=e.sent).hasOwnProperty("invalidImageIds")&&(u.ULS.sendTraceTag(561639890,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"ViewController::contextRestoredHandler - ".concat(JSON.stringify(r))),g.VetoUtils.recordVeto("ACE",r)),e.next=10,t.slideViewElement.ensure();case 10:((i=e.sent).hasOwnProperty("invalidShapeIds")||i.hasOwnProperty("missingTextureIds")||i.hasOwnProperty("errorName"))&&(u.ULS.sendTraceTag(561639891,u.LogCategory.msoulscat_Wac_PptSession,u.TraceLevel.Error,"ViewController::contextRestoredHandler - ".concat(JSON.stringify(i))),g.VetoUtils.recordVeto("ACE",i),i.hasOwnProperty("errorName")&&this.viewController.events.emit("restoreWebGLContextFailed")),n={zoomLevel:v.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},this.viewController.renderSlideById(this.viewControllerInternals.currentRenderedSlideId,n);case 14:this.viewController.events.emit("webglcontextrestored");case 15:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"createImageFromTexture",value:function(e,t){var r=this.gl;if(r&&this.isGLContextValid){var i,n,a;e instanceof d.Texture?(i=e.tryGetWebGLTexture(),0===e.size.x||0===e.size.y?(n=e.originalSize.x,a=e.originalSize.y):(n=e.size.x,a=e.size.y)):(i=e.texture,n=e.size.x,a=e.size.y);var o=r.createFramebuffer(),s=r.getParameter(r.FRAMEBUFFER_BINDING);r.bindFramebuffer(r.FRAMEBUFFER,o),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var l=new Uint8Array(n*a*4);r.readPixels(0,0,n,a,r.RGBA,r.UNSIGNED_BYTE,l),r.bindFramebuffer(r.FRAMEBUFFER,s),r.deleteFramebuffer(o);var c=y(),u=y(),h=u.canvas,f=u.context;if(f&&c.context){var m=c.context.createImageData(n,a);m.data.set(l),c.context.putImageData(m,0,0),f.translate(0,a),f.scale(1,-1),f.drawImage(c.canvas,0,0);var p=h.toDataURL();if(t&&t.fNewWindow){var g=window.open();if(g){var v=new Image;v.src=p,g.document.write(v.outerHTML)}}return p}console.log("createImageFromTexture: cannot create 2D context")}else console.log("createImageFromTexture: gl invalid");function y(){var e=document.createElement("canvas");e.width=n,e.height=a;var t=e.getContext("2d");return{canvas:e,context:t}}}}]);var e,t,r}();t.WebGLRendererEnvironment=P},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SVGRendererEnvironment=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(4),u=r(20),d=r(77),h=r(35),f=function(){return(0,s.default)((function e(){(0,o.default)(this,e),this.supportsTransitions=!1,this.supportsGif=!1,this.isGLContextValid=!0,this.isSBValid=!0,this.glContext=void 0,this.webGLRenderer=void 0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,l.ULS.sendTraceTag(561639892,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"creating SVGRendererEnvironment"),console.log("creating SVGRendererEnvironment");var t=document.createElement("div");t.style.position="absolute",t.style.overflow="hidden",t.setAttribute("aria-hidden","true"),this.renderer=(0,u.createSVGRenderer)({canvas:t}),c.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&t.addEventListener("scroll",(function(){t.scrollLeft=0,t.scrollTop=0})),this.canvas=document.createElement("div"),this.canvas.appendChild(t),this.svgRoot=t,h.ViewController.s_rendererTech="SVG",h.ViewController.s_isBadGpu=!1}),[{key:"clientSize",get:function(){return this.viewController.getBounds.getClientSizeFromCanvas()}},{key:"removeCanvas",value:function(e){this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.container=void 0,this.isCanvasSizeSet=!1)}},{key:"setupCanvas",value:function(e){if(!h.ViewController.getElementFromCollection(e.children,"svg-canvas")){if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){var t=h.ViewController.getElementFromCollection(this.container.children,"svg-canvas");if(t)return e.appendChild(t),void(this.container=e)}this.canvas.id="svg-canvas",this.canvas.style.pointerEvents="none",this.canvas.style.background="white",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}}},{key:"setCanvasSize",value:function(e,t){this.canvas.style.width="".concat(e.x,"px"),this.canvas.style.height="".concat(e.y,"px"),this.canvas.style.minWidth="".concat(e.x,"px"),this.canvas.style.minHeight="".concat(e.y,"px"),this.svgRoot.style.width="".concat(e.x,"px"),this.svgRoot.style.height="".concat(e.y,"px"),this.isCanvasSizeSet=!0}},{key:"calculateRenderTransform",value:function(e){var t=this.getPixelScale(e),r=Math.min(t.x,t.y);return new u.Transform(new u.Vector2(-e.x/2,-e.y/2),new u.Vector2(r,r),void 0,new u.Vector2(this.clientSize.x/2,this.clientSize.y/2))}},{key:"calculateRenderTransformWithZoom",value:function(e,t,r){var i=this.getPixelScale(e),n=t,a=r;return n&&a||(n=Math.min(i.x,i.y),a=new u.Vector2(n*e.x/2,n*e.y/2)),new u.Transform(new u.Vector2(-e.x/2,-e.y/2),new u.Vector2(n,n),void 0,(0,d.calculateTranslationForAlignment)(new u.Vector2(this.clientSize.x/2,this.clientSize.y/2),a,e,n,1))}},{key:"preloadShadersAsync",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"flush",value:function(){}},{key:"getPerformanceSummary",value:function(){}},{key:"generateTextureMemoryReport",value:function(e,t){}},{key:"verifyGlyphCacheIntegrityAndTryRecover",value:function(){return!0}},{key:"attachImage",value:function(e,t,r,i){if(!r.dataUri)throw l.ULS.sendTraceTag(561639893,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"dataUrl missing"),new Error("dataUrl missing");this.renderer.attachUriToImage(t,r.dataUri)}},{key:"releaseImageData",value:function(e){}},{key:"saveImageData",value:function(e,t,r,i,n){if(c.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){var a=c.Settings.readNumberOrDefault("maxSvgTextureSize",2048),o=Math.max(t.size.width,t.size.height),s=n.x/i.x,d=n.y/i.y,h=o*Math.min(s,d)*(i.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(a,h),l.ULS.sendTraceTag(561639894,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"loadImageTexture: SVG width = ".concat(e.width,"px, height = ").concat(e.height))}return this.viewController.viewDataManager.imageDataMap.set(e.ID,{dataUri:e.src,size:new u.Vector2(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[r]}),l.ULS.sendTraceTag(561639895,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"loadImageTexture - loaded ".concat(JSON.stringify({id:e.ID,slideId:r,width:e.naturalWidth,height:e.naturalHeight,byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType}))),{}}},{key:"createTransition",value:(e=(0,a.default)(n.default.mark((function e(t,r,i,a,o,s){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{fSuccess:!1});case 1:case"end":return e.stop()}}),e)}))),function(t,r,i,n,a,o){return e.apply(this,arguments)})},{key:"enableVerboseRenderLogging",value:function(e){}},{key:"getPixelScale",value:function(e){var t=this.clientSize.x/e.x,r=this.clientSize.y/e.y;return new u.Vector2(t,r)}}]);var e,t}();t.SVGRendererEnvironment=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParallelCriticalAsyncFunctionThrottler=void 0;var i=r(24),n=r(180),a=function(){function e(e,t,r){this.m_throttlers=new Map,this.m_functionToThrottle=e,this.m_queueHandler=t,this.m_parallelSplitter=r}return e.prototype.callAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.__awaiter(this,void 0,void 0,(function(){var t,r;return i.__generator(this,(function(i){switch(i.label){case 0:return t=this.m_parallelSplitter.apply(this,e),(r=this.m_throttlers.get(t))||(r=new n.CriticalAsyncFunctionThrottler(this.m_functionToThrottle,this.m_queueHandler),this.m_throttlers.set(t,r)),[4,r.callAsync.apply(r,e)];case 1:return[2,i.sent()]}}))}))},e}();t.ParallelCriticalAsyncFunctionThrottler=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeAllQueueHandler=t.executeMostRecentOnlyQueueHandler=t.executeFirstOnlyQueueHandler=void 0,t.executeFirstOnlyQueueHandler=function(e){return{nextArg:e[0].args,handledRequests:e,remainingRequests:[]}},t.executeMostRecentOnlyQueueHandler=function(e){return{nextArg:e[e.length-1].args,handledRequests:e,remainingRequests:[]}},t.executeAllQueueHandler=function(e){return{nextArg:e[0].args,handledRequests:[e[0]],remainingRequests:e.splice(1)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitUntilTrueAsync=t.waitMsAsync=void 0;var i=r(24);function n(e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return[2,new Promise((function(t){window.setTimeout(t,e)}))]}))}))}t.waitMsAsync=n,t.waitUntilTrueAsync=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r=this;return i.__generator(this,(function(a){return[2,new Promise((function(a){return i.__awaiter(r,void 0,void 0,(function(){var r,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:r=t&&t.checkIntervalMs?t.checkIntervalMs:50,o=t&&t.timeoutMs?t.timeoutMs:0,s=performance.now(),i.label=1;case 1:return e()?(a(!0),[2]):o&&performance.now()-s>o?(a(!1),[2]):[4,n(r)];case 2:return i.sent(),[3,1];case 3:return[2]}}))}))}))]}))}))}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.GetBounds=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=r(67),l=r(4),c=r(20),u=(0,a.default)((function e(t,r){var i=this;(0,n.default)(this,e),this.m_lastClientSizeFromCanvas=c.Vector2.Zero,this.m_lastClientSizeFromContainer=c.Vector2.Zero,this.m_container=t,this.m_rendererEnvironment=r,l.Settings.readBooleanOrDefault("useCachedClientSize",!1)&&(0,s.waitUntilTrueAsync)((function(){return i.ensureCachedBounds()}))}),[{key:"ensureCachedBounds",value:function(){var e=this.m_rendererEnvironment.canvas;return this.m_lastBoundingClientRectFromContainer||(this.m_lastBoundingClientRectFromContainer=this.m_container.getBoundingClientRect()),!this.m_lastBoundingClientRectFromCanvas&&e&&(this.m_lastBoundingClientRectFromCanvas=e.getBoundingClientRect()),this.m_lastClientSizeFromContainer===c.Vector2.Zero&&e&&(this.m_lastClientSizeFromContainer=new c.Vector2(e.clientWidth,e.clientHeight)),this.m_lastClientSizeFromCanvas===c.Vector2.Zero&&e&&(this.m_lastClientSizeFromCanvas=new c.Vector2(e.clientWidth,e.clientHeight)),!(!this.m_lastBoundingClientRectFromContainer||!this.m_lastBoundingClientRectFromCanvas||this.m_lastClientSizeFromContainer===c.Vector2.Zero||this.m_lastClientSizeFromCanvas===c.Vector2.Zero)}},{key:"getBoundingClientRectFromContainer",value:function(){if(l.Settings.readBooleanOrDefault("useCachedClientSize",!1)){var e=this.m_container.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromContainer?this.m_lastBoundingClientRectFromContainer:(o.ULS.sendTraceTag(512260235,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromContainer=e,e)}return this.m_container.getBoundingClientRect()}},{key:"getBoundingClientRectFromCanvas",value:function(){if(l.Settings.readBooleanOrDefault("useCachedClientSize",!1)){var e=this.m_rendererEnvironment.canvas.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromCanvas?this.m_lastBoundingClientRectFromCanvas:(o.ULS.sendTraceTag(512260234,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromCanvas=e,e)}return this.m_rendererEnvironment.canvas.getBoundingClientRect()}},{key:"getClientSizeFromCanvas",value:function(){var e=this.m_rendererEnvironment.canvas;if(l.Settings.readBooleanOrDefault("useCachedClientSize",!1)){var t=new c.Vector2(e.clientWidth,e.clientHeight);return 0===t.x||0===t.y?(0!==this.m_lastClientSizeFromCanvas.x&&0!==this.m_lastClientSizeFromCanvas.y||o.ULS.sendTraceTag(512260233,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"unable to get clientWidth or clientHeight from canvas"),this.m_lastClientSizeFromCanvas):(this.m_lastClientSizeFromCanvas=t,t)}return new c.Vector2(e.clientWidth,e.clientHeight)}},{key:"getClientSizeFromContainer",value:function(){if(l.Settings.readBooleanOrDefault("useCachedClientSize",!1)){var e=new c.Vector2(this.m_container.clientWidth,this.m_container.clientHeight);return 0===e.x||0===e.y?this.m_lastClientSizeFromContainer?this.m_lastClientSizeFromContainer:(o.ULS.sendTraceTag(512233990,o.LogCategory.msoulscat_Wac_PptSession,o.TraceLevel.Error,"unable to clientWidth or clientHeight from container"),e):(this.m_lastClientSizeFromContainer=e,e)}return new c.Vector2(this.m_container.clientWidth,this.m_container.clientHeight)}}]);t.GetBounds=u},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeBuilderCanvasContext=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(20),u=r(35),d=r(4),h=r(116),f=r(26),m=(0,s.default)((function e(t){(0,o.default)(this,e),this.m_onInitStateRestorer=t}),[{key:"init",value:function(e){this.m_onInitStateRestorer()}},{key:"setDefaults",value:function(){}},{key:"restore",value:function(){}}]),p=function(){return(0,s.default)((function e(){var t=this;(0,o.default)(this,e),this.events=new f.EventEmitter,this.m_isSBRendererReady=!1,this.onVisibilityChange=function(){t.m_webGLContextLostStartTime&&"visible"===document.visibilityState&&(void 0===t.m_webGLContextRestoreStartTime||t.m_webGLContextLostStartTime>t.m_webGLContextRestoreStartTime)?t.m_webGLContextRestoredTimeout=window.setTimeout((function(){document.removeEventListener("visibilitychange",t.onVisibilityChange),t.events.emit("restoreContextFailed")}),d.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3)):"hidden"===document.visibilityState&&(l.ULS.sendTraceTag(509723856,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(t.m_webGLContextRestoredTimeout),t.m_webGLContextRestoredTimeout=void 0)},l.ULS.sendTraceTag(0,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"Using the default ShapeBuilderCanvasContext"),console.log("Using the default ShapeBuilderCanvasContext");var r=new m((function(){t.events.emit("initStateRestorer")}));d.Settings.readBooleanOrDefault("hackStateRestorerOn",!1)&&(r=(0,c.createStateRestorer)(!1)),this.renderer=(0,c.createWebGLRenderer)({stateRestorer:r,morphPlayer:(0,c.createMorphPlayer)(),debugStringProvider:(0,c.createDebugStringProvider)()})}),[{key:"isReady",get:function(){return this.m_isSBRendererReady}},{key:"addUser",value:function(e){var t=this;e.on("releasedResources",(function(){t.gl=void 0}))}},{key:"setupCanvas",value:function(e,t){var r=this,i=u.ViewController.getElementFromCollection(e.children,"webgl-canvas");if(i)return this.canvas=i,void this.setupWebGLContext();if(t&&t.useRemovableCanvas&&this.m_container){var n=u.ViewController.getElementFromCollection(this.m_container.children,"webgl-canvas");if(n)return e.appendChild(n),void(this.m_container=e)}this.canvas=document.createElement("canvas"),this.canvas.id="webgl-canvas",t&&t.useZIndex1&&(this.canvas.style.zIndex="1"),this.setupWebGLContext(),this.canvas.addEventListener("webglcontextlost",(function(e){return r.lostContextHandler(e)})),this.canvas.addEventListener("webglcontextrestored",(function(){return r.contextRestoredHandler()})),e.appendChild(this.canvas),t&&t.useRemovableCanvas&&(this.m_container=e)}},{key:"setCanvasSize",value:function(e,t){return this.canvas.style.width="".concat(e.x,"px"),this.canvas.style.height="".concat(e.y,"px"),this.canvas.width=Math.round(t.x),this.canvas.height=Math.round(t.y),this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),!0}},{key:"lostContextHandler",value:function(e){var t=this;e.preventDefault(),this.events.emit("contextLost"),this.m_webGLContextLostStartTime=new Date,this.m_isSBRendererReady=!1,this.renderer.onWebGLContextLost(),"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout((function(){document.removeEventListener("visibilitychange",t.onVisibilityChange),t.events.emit("restoreContextFailed")}),d.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3))),document.addEventListener("visibilitychange",this.onVisibilityChange)}},{key:"contextRestoredHandler",value:(t=(0,a.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_webGLContextRestoreStartTime=new Date,t=this.m_webGLContextLostStartTime?this.m_webGLContextRestoreStartTime.getTime()-this.m_webGLContextLostStartTime.getTime():-1,l.ULS.sendTraceTag(561639889,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"WebGL context restored in ".concat(t,"ms")),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,document.removeEventListener("visibilitychange",this.onVisibilityChange),this.setupWebGLContext(),this.gl){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.preloadShadersAsync(this.gl);case 11:this.events.emit("contextRestored");case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setupWebGLContext",value:function(){var e=this;this.canvas.addEventListener("webglcontextcreationerror",(function(t){return e.events.emit("logContextCreationError",t)}));var t={failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},r={failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0},i=[{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t},{contextId:"webgl",options:r},{contextId:"experimental-webgl",options:r}];d.Settings.readBooleanOrDefault("webgl2Enabled",!1)&&(i=[{contextId:"webgl2",options:t},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t},{contextId:"webgl2",options:r},{contextId:"webgl",options:r},{contextId:"experimental-webgl",options:r}]);for(var n=0,a=i;n<a.length;n++){var o=a[n];if(this.gl=this.canvas.getContext(o.contextId,o.options)||void 0,this.gl){var s="webgl2"===o.contextId?"WebGL2":"WebGL",l=o.options===r,c=void 0,u=this.gl.getExtension("WEBGL_debug_renderer_info");u&&(c=this.gl.getParameter(u.UNMASKED_RENDERER_WEBGL).toLowerCase()),this.events.emit("logContextCreation",{fSuccess:!0,data:{rendererTech:s,unmaskedRenderer:c,hasPerfCaveat:l}});break}}this.gl?this.gl.viewport(0,0,this.canvas.width,this.canvas.height):this.events.emit("logContextCreation",{fSuccess:!1})}},{key:"removeCanvas",value:function(e){this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.m_container=void 0)}},{key:"preloadShadersAsync",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i,a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.getExtension("KHR_parallel_shader_compile"),r=u.ViewController.performanceNowTrimmed(),this.m_isSBRendererReady=!1,i=this.renderer.initializeAsync(t),a=this.renderer.getBabylonEngine()){e.next=9;break}throw l.ULS.sendTraceTag(538981318,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Error,"engine missing"),Error("no babylon engine");case 9:return o=(0,h.initializeAsync)(a),e.next=12,Promise.all([i,o]);case 12:this.m_isSBRendererReady=!0,s=u.ViewController.performanceNowTrimmed(),l.ULS.sendTraceTag(561639875,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Info,"SB Shader Compilation finished in ".concat(s-r,"ms")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),l.ULS.sendTraceTag(507884681,l.LogCategory.msoulscat_Wac_PptSession,l.TraceLevel.Warning,"preloadShaders failed: ".concat(e.t0));case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(t){return e.apply(this,arguments)})}]);var e,t}();t.ShapeBuilderCanvasContext=p},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLRendererEnvironmentDeprecated=void 0;var n=i(r(6)),a=i(r(5)),o=i(r(7)),s=i(r(1)),l=i(r(2)),c=r(3),u=r(20),d=r(35),h=r(66),f=r(118),m=r(42),p=r(14),g=r(4),v=r(116),y=r(77),_=r(11);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var w=(0,l.default)((function e(t){(0,s.default)(this,e),this.m_env=t}),[{key:"init",value:function(e){this.m_env.setRenderingScenario(0)}},{key:"setDefaults",value:function(){}},{key:"restore",value:function(){}}]),P=function(){return(0,l.default)((function e(){var t=this;(0,s.default)(this,e),this.supportsTransitions=!0,this.supportsGif=!0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,this.m_tech="WebGL",this.m_isSBRendererReady=!1,this.onVisibilityChange=function(){t.m_webGLContextLostStartTime&&"visible"===document.visibilityState&&(void 0===t.m_webGLContextRestoreStartTime||t.m_webGLContextLostStartTime>t.m_webGLContextRestoreStartTime)?t.m_webGLContextRestoredTimeout=window.setTimeout((function(){c.ULS.sendTraceTag(561639887,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",t.onVisibilityChange),t.viewController.events.emit("restoreWebGLContextFailed")}),g.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3)):"hidden"===document.visibilityState&&(c.ULS.sendTraceTag(509723856,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(t.m_webGLContextRestoredTimeout),t.m_webGLContextRestoredTimeout=void 0)},c.ULS.sendTraceTag(561639874,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"creating WebGLRendererEnvironment"),console.log("creating WebGLRendererEnvironment");var r=void 0;r=new w(this),g.Settings.readBooleanOrDefault("hackStateRestorerOn",!1)&&(r=(0,u.createStateRestorer)(!1)),this.renderer=(0,u.createWebGLRenderer)({stateRestorer:r,morphPlayer:(0,u.createMorphPlayer)(),debugStringProvider:(0,u.createDebugStringProvider)()}),d.exposed.createImageFromTexture=this.createImageFromTexture.bind(this)}),[{key:"isGLContextValid",get:function(){return!!this.gl&&!this.gl.isContextLost()}},{key:"isSBValid",get:function(){return this.m_isSBRendererReady}},{key:"glContext",get:function(){return this.gl}},{key:"webGLRenderer",get:function(){return this.renderer}},{key:"tech",get:function(){return this.m_tech}},{key:"clientSize",get:function(){return this.viewController.getBounds.getClientSizeFromCanvas()}},{key:"setRenderingScenario",value:function(e){if(e!==this.m_renderingScenario){var t=this.renderer.getBabylonEngine();t&&t.wipeCaches(!0),this.m_renderingScenario=e}}},{key:"removeCanvas",value:function(e){this.releaseResources(),this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.isCanvasSizeSet=!1,this.container=void 0)}},{key:"releaseResources",value:function(){this.viewController.viewDataManager.imageDataMap=new Map,this.viewController.viewDataManager.memoryStats.gifTextures=0,this.viewController.viewDataManager.memoryStats.transitionTextures=0,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport=new h.MemoryReport,this.viewController.viewDataManager.memoryStats.videoTextures=0,this.viewController.viewDataManager.memoryStats.cameoTextures=0;var e,t=b(this.viewController.viewDataManager.externalTexturesToRelease);try{for(t.s();!(e=t.n()).done;)e.value.texture.release()}catch(e){t.e(e)}finally{t.f()}this.viewController.viewDataManager.externalTexturesToRelease=[];var r,i=b(this.viewControllerInternals.slideSceneView);try{for(i.s();!(r=i.n()).done;){var n=r.value;n.scene&&this.viewControllerInternals.deleteScene(n),n.slideViewElement.shapeViewElements=[]}}catch(e){i.e(e)}finally{i.f()}this.gl=void 0,d.exposed.gl=this.gl}},{key:"setupCanvas",value:function(e){var t=this,r=d.ViewController.getElementFromCollection(e.children,"webgl-canvas");if(r)return this.canvas=r,void this.setupWebGLContext();if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){var i=d.ViewController.getElementFromCollection(this.container.children,"webgl-canvas");if(i)return e.appendChild(i),void(this.container=e)}this.canvas=document.createElement("canvas"),this.canvas.id="webgl-canvas",this.canvas.style.pointerEvents="none",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),this.setupWebGLContext(),this.canvas.addEventListener("webglcontextlost",(function(e){return t.lostContextHandler(e)})),this.canvas.addEventListener("webglcontextrestored",(function(){return t.contextRestoredHandler()})),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}},{key:"setCanvasSize",value:function(e,t){this.devicePixelsToRenderedPixelsScale=t,this.canvas.style.width="".concat(e.x,"px"),this.canvas.style.height="".concat(e.y,"px"),this.canvas.width=Math.round(e.x*window.devicePixelRatio*t),this.canvas.height=Math.round(e.y*window.devicePixelRatio*t),this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.isCanvasSizeSet=!0}},{key:"calculateRenderTransform",value:function(e){var t=this.getPixelScale(e),r=Math.min(t.x,t.y);return new u.Transform(new u.Vector2(-e.x/2,-e.y/2),new u.Vector2(r,r),void 0,new u.Vector2(this.canvas.width/2,this.canvas.height/2))}},{key:"calculateRenderTransformWithZoom",value:function(e,t,r){var i=this.getPixelScale(e),n=t,a=r;return n&&a||(n=Math.min(i.x,i.y),a=new u.Vector2(n*e.x/2,n*e.y/2)),new u.Transform(new u.Vector2(-e.x/2,-e.y/2),new u.Vector2(n,n),void 0,(0,y.calculateTranslationForAlignment)(new u.Vector2(this.clientSize.x/2,this.clientSize.y/2),a,e,n,window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale))}},{key:"preloadShadersAsync",value:(r=(0,o.default)(n.default.mark((function e(t){var r,i,a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.getExtension("KHR_parallel_shader_compile"),r=d.ViewController.performanceNowTrimmed(),this.m_isSBRendererReady=!1,i=this.renderer.initializeAsync(t),a=this.renderer.getBabylonEngine()){e.next=9;break}throw c.ULS.sendTraceTag(538981318,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"engine missing"),Error("no babylon engine");case 9:return o=(0,v.initializeAsync)(a),e.next=12,Promise.all([i,o]);case 12:this.m_isSBRendererReady=!0,s=d.ViewController.performanceNowTrimmed(),c.ULS.sendTraceTag(561639875,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"SB Shader Compilation finished in ".concat(s-r,"ms")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),c.ULS.sendTraceTag(507884681,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"preloadShaders failed: ".concat(e.t0));case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e){return r.apply(this,arguments)})},{key:"flush",value:function(){this.gl&&this.gl.flush()}},{key:"getPerformanceSummary",value:function(){return this.renderer.getPerformanceSummary()}},{key:"generateTextureMemoryReport",value:function(e,t){return this.renderer.generateTextureMemoryReport(e,t)}},{key:"verifyGlyphCacheIntegrityAndTryRecover",value:function(){return this.renderer.verifyGlyphCacheIntegrityAndTryRecover()}},{key:"attachImage",value:function(e,t,r,i){if(!r.texture)throw c.ULS.sendTraceTag(561639876,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"texture missing"),new Error("texture missing");var n=new u.Texture(e,this.renderer,r.texture,i,u.TextureFormat.RGBA,u.WrapMode.clamp,u.TextureReleasePolicy.ExternallyManaged);r.size.equals(i)||c.ULS.sendTraceTag(559269018,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"attachImage imageData.size:".concat(JSON.stringify(r.size)," != size:").concat(JSON.stringify(i))),t.id||c.ULS.sendTraceTag(561639877,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Missing imageContainer.id: ".concat(t.id)),this.viewController.viewDataManager.externalTexturesToRelease.push({imageId:t.id||"unknown",texture:n}),this.renderer.attachTextureToImage(t,n)}},{key:"releaseImageData",value:function(e){e.texture&&this.gl&&this.gl.deleteTexture(e.texture)}},{key:"saveImageData",value:function(e,t,r,i,n){var a=this.gl;if(!a)return c.ULS.sendTraceTag(561639878,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"No webGL Context found"),{errorName:f.ErrorCode.CannotLoadTextureNoWebGLContext};var o=a.createTexture();if(!o)return c.ULS.sendTraceTag(561639879,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Failed to create texture"),{errorName:f.ErrorCode.CreateTextureFailed};if(g.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){var s=g.Settings.readNumberOrDefault("maxSvgTextureSize",2048),l=Math.max(t.size.width,t.size.height),d=n.x/i.x,h=n.y/i.y,m=l*Math.min(d,h)*(i.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(Math.max(e.naturalHeight,e.naturalWidth,m),s),c.ULS.sendTraceTag(561639880,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"loadImageTexture: SVG width = ".concat(e.width,"px, height = ").concat(e.height))}a.bindTexture(a.TEXTURE_2D,o),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null);var p=e.ID,v=this.viewController.viewDataManager.imageDataMap.get(p);return v&&(this.viewController.viewDataManager.memoryStats.externalTextureLeaks+=v.size.x*v.size.y*4,g.Settings.readBooleanOrDefault("releaseExistingExternalImages",!1)&&(this.releaseImageData(v),this.viewController.viewDataManager.onExternalTextureReleased(p))),this.viewController.viewDataManager.imageDataMap.set(p,{dataUri:e.src,texture:o,size:new u.Vector2(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[r]}),c.ULS.sendTraceTag(561639881,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"loadImageTexture - loaded ".concat(JSON.stringify({id:e.ID,slideId:r,size:new u.Vector2(e.width,e.height),naturalSize:new u.Vector2(e.naturalWidth,e.naturalHeight),byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType}))),{}}},{key:"createTransition",value:(t=(0,o.default)(n.default.mark((function e(t,r,i,a,o,s,l){var c,f,m,p,g,v,y,S,T,C,w,P,I,k,E,x,L,A,M,R,O,D,F,B,N,V,U,W,G,H,j=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c={fSuccess:!1},f=t.type,m=t.dir,p=t.dur,g={},c.effectId=f,v=l&&l.correlationId,y={aspectRatio:o,direction:m,forward:a,gl:this.gl,engine:this.renderer.getBabylonEngine()},C=!0,w=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(w=d.ViewController.performanceNowTrimmed()),P=this.viewController.getSlideViewElement(i),I=this.viewController.getSlideViewElement(r),_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(g.getSlideViewElementMS=d.ViewController.performanceNowTrimmed()-w),k=function(){},E=function(){},!(s&&P&&I&&t.morph)||f!==h.kTransitionIds.PPT_TRANSITION_MORPH&&f!==h.kTransitionIds.PPT_TRANSITION_PAN){e.next=37;break}if(_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(c.metadata||(c.metadata={}),g.morphTransitionFlow=!0),x=this.viewController.viewDataManager.getSlideIndex(i),L=this.viewController.viewDataManager.getSlideIndex(r),!(A=this.slideIdsToMorphKey(i,r))||-1===x||-1===L||1!==Math.abs(L-x)){e.next=29;break}return M=0,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(M=d.ViewController.performanceNowTrimmed()),e.next=26,this.viewControllerInternals.morphCache.load(A,{meta_prevSlideId:a?i:r,meta_nextSlideId:a?r:i});case 26:R=e.sent,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(g.generateMorphResource=d.ViewController.performanceNowTrimmed()-M),R.resource&&((T=R.resource).tryPrepareMorph(),O=this.morphKeyToSlideIds(A),T.isForwards=O.slideIdA.sid===i.sid&&O.slideIdA.cid===i.cid);case 29:if(T){e.next=31;break}return e.abrupt("return",{fSuccess:!1});case 31:if(!(T.fallbackReasons.size>0)){e.next=33;break}return e.abrupt("return",{fSuccess:!1,metadata:{fallbackReasons:Array.from(T.fallbackReasons).join(", ")}});case 33:S=T,c.metadata=T.metadata,e.next=55;break;case 37:return D=[],!this.viewControllerInternals.transitionFactory.isTransitionDisabled(f,m)&&(0,h.isContentTransition)(f,m)?(F=0,_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(F=d.ViewController.performanceNowTrimmed()),B={incomingSlideBackground:this.renderToTexture(r,{renderFilter:d.ViewController.createRenderBackgroundOrForegroundFilter(!0),correlationId:v,isContentTransition:!0}),outgoingSlideBackground:this.renderToTexture(i,{renderFilter:d.ViewController.createRenderBackgroundOrForegroundFilter(!0),correlationId:v,isContentTransition:!0}),incomingSlideForeground:this.renderToTexture(r,{renderFilter:d.ViewController.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:u.Color.Transparent,correlationId:v,isContentTransition:!0}),outgoingSlideForeground:this.renderToTexture(i,{renderFilter:d.ViewController.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:u.Color.Transparent,correlationId:v,isContentTransition:!0})},_.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(g.renderTransitionTextures=d.ViewController.performanceNowTrimmed()-F),y.incomingSlideBackground=B.incomingSlideBackground?B.incomingSlideBackground.tryGetWebGLTexture():void 0,y.outgoingSlideBackground=B.outgoingSlideBackground?B.outgoingSlideBackground.tryGetWebGLTexture():void 0,y.incomingSlideForeground=B.incomingSlideForeground?B.incomingSlideForeground.tryGetWebGLTexture():void 0,y.outgoingSlideForeground=B.outgoingSlideForeground?B.outgoingSlideForeground.tryGetWebGLTexture():void 0,D=Object.values(B)):(N=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(N=d.ViewController.performanceNowTrimmed()),V={incomingSlideBackground:this.renderToTexture(r,{correlationId:v}),outgoingSlideBackground:this.renderToTexture(i,{correlationId:v})},_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(g.renderToTexture=d.ViewController.performanceNowTrimmed()-N),y.incomingSlideBackground=V.incomingSlideBackground?V.incomingSlideBackground.tryGetWebGLTexture():void 0,y.outgoingSlideBackground=V.outgoingSlideBackground?V.outgoingSlideBackground.tryGetWebGLTexture():void 0,D=Object.values(V)),U=new u.Vector2(this.canvas.width,this.canvas.height),this.setRenderingScenario(1),W=new h.SlideTransitionInfo(y),G=0,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(G=d.ViewController.performanceNowTrimmed()),e.next=46,this.viewControllerInternals.transitionFactory.getTransition(f,m,W,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport);case 46:if(H=e.sent,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(g.transitionFactoryMS=d.ViewController.performanceNowTrimmed()-G),H.transition){e.next=51;break}return c.isSupported=!1,e.abrupt("return",c);case 51:C=H.isSupported,S=H.transition,k=function(){var e=j.gl;if(e&&!e.isContextLost()){var t,r=b(D);try{for(r.s();!(t=r.n()).done;){var i=t.value;i&&(j.viewController.viewDataManager.memoryStats.transitionTextures-=U.x*U.y*4,i.release())}}catch(e){r.e(e)}finally{r.f()}S.dispose()}},E=function(){j.setRenderingScenario(1)};case 55:return this.viewControllerInternals.transitionController=new d.TransitionController(S,p,a,E,k),c.fSuccess=!0,c.isSupported=C,_.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(c.metadata||(c.metadata={}),c.metadata.rendererEnvironment=g),e.abrupt("return",c);case 60:case"end":return e.stop()}}),e,this)}))),function(e,r,i,n,a,o,s){return t.apply(this,arguments)})},{key:"enableVerboseRenderLogging",value:function(e){this.renderer.enableVerboseRenderLogging(e)}},{key:"getPixelScale",value:function(e){var t=this.clientSize.x/e.x,r=this.clientSize.y/e.y;return new u.Vector2(t,r).scale(window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale)}},{key:"setupWebGLContext",value:function(){var e=this;this.canvas.addEventListener("webglcontextcreationerror",(function(t){return e.logContextCreationError(t)}));var t={failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},r={failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0},i=[{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t},{contextId:"webgl",options:r},{contextId:"experimental-webgl",options:r}];g.Settings.readBooleanOrDefault("webgl2Enabled",!1)&&(i=[{contextId:"webgl2",options:t},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t},{contextId:"webgl2",options:r},{contextId:"webgl",options:r},{contextId:"experimental-webgl",options:r}]);for(var n=0,a=i;n<a.length;n++){var o=a[n];if(this.gl=this.canvas.getContext(o.contextId,o.options)||void 0,this.gl){var s="webgl2"===o.contextId?"WebGL2":"WebGL",l=o.options===r;d.ViewController.s_rendererTech=s;var u=!1,h=this.gl.getExtension("WEBGL_debug_renderer_info");if(h){var m=this.gl.getParameter(h.UNMASKED_RENDERER_WEBGL).toLowerCase();u=g.Settings.readStringOrDefault("badGpuList","").toLowerCase().indexOf(m)>=0}d.ViewController.s_isBadGpu=u,c.ULS.sendTraceTag(561639882,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"WebGL initialized ".concat(JSON.stringify({rendererTech:s,isBadGpu:u,fPerfCaveat:l}))),l&&(d.ViewController.s_gpuHardwareDisabled=!0,c.ULS.sendTraceTag(520897678,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"WebGL initialized with gpu hardware disabled"));break}}if(!this.gl)return c.ULS.sendTraceTag(561639883,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Unable to initialize WebGL"),void p.VetoUtils.recordVeto("SetupWebGLContextFailed",{msg:f.ErrorCode.SetupWebGLContextFailed});d.exposed.gl=this.gl,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"logContextCreationError",value:function(e){c.ULS.sendTraceTag(555018370,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Unable to initialize WebGL - ".concat(e.statusMessage||"Unknown error"))}},{key:"lostContextHandler",value:function(e){var t=this;e.preventDefault(),c.ULS.sendTraceTag(561639884,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"WebGL context lost. CurrentSceneCount:".concat(this.viewControllerInternals.currentSceneCount,", MaxSceneCount:").concat(this.viewControllerInternals.forwardSceneCount+this.viewControllerInternals.backwardSceneCount+1,",\n        CurrentRenderedSlideId:").concat(JSON.stringify(this.viewControllerInternals.currentRenderedSlideId),", SlideSize:").concat(JSON.stringify(this.viewController.slideSizeEmus),",\n        CanvasWidth:").concat(this.canvas.width,", CanvasHeight:").concat(this.canvas.height,", \n        CanvasSizeWidth:").concat(this.clientSize.x,", CanvasSizeHeight:").concat(this.clientSize.y,", \n        DPI:").concat(window.devicePixelRatio,", ImageTextureMapSize:").concat(this.viewController.viewDataManager.imageDataMap.size,",\n        MemoryStats:").concat(JSON.stringify(this.viewController.viewDataManager.memoryStats))),this.viewController.viewDataManager.imageDataMap.forEach((function(e,t){c.ULS.sendTraceTag(561639885,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"WebGL context lost. imageDataMap Key:".concat(t," Size:").concat(JSON.stringify(e.size)," SlideIds:").concat(JSON.stringify(e.loadedSlideIDs)," Memory:").concat(e.size.x*e.size.y*4))}));var r=this.viewControllerInternals.slideSceneView.filter((function(e){return e.scene})).map((function(e){return e.scene})),i=this.viewControllerInternals.morphCache.getAllLoadResultsInCache().filter((function(e){return e.resource})).map((function(e){return e.resource.morph}));c.ULS.sendTraceTag(561639886,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"WebGL context lost. SB Scene Memory:".concat(JSON.stringify(this.generateTextureMemoryReport(r,i)))),this.m_webGLContextLostStartTime=new Date,this.m_isSBRendererReady=!1,this.renderer.onWebGLContextLost(),this.releaseResources(),this.viewController.events.emit("webglcontextlost"),"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout((function(){c.ULS.sendTraceTag(561639887,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",t.onVisibilityChange),t.viewController.events.emit("restoreWebGLContextFailed")}),g.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3))),document.addEventListener("visibilitychange",this.onVisibilityChange)}},{key:"renderToTexture",value:function(e,t){if(this.gl){var r=new u.Vector2(this.canvas.width,this.canvas.height);m.ShapeViewElementUtils.verifyTextureSize(this.viewController,"transition",r);var i=new u.TargetTexture("Transition",this.renderer,r,u.TextureReleasePolicy.KeepUntilRelease);if(i.tryGetWebGLTexture()){this.viewController.viewDataManager.memoryStats.transitionTextures+=this.canvas.width*this.canvas.height*4,c.ULS.sendTraceTag(561639888,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"ViewController::renderToTexture - SlideId: ".concat(e.sid));var n={zoomLevel:g.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},a=!g.Settings.readBooleanOrDefault("saveVerifyGlyphForTransition",!1),o=this.viewController.renderSlideByIdExtended(e,!0,i,t&&t.renderFilter,t&&t.backgroundColor,a,!1,n);return c.ULS.sendTraceTag(507650462,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"".concat(JSON.stringify(T(T({},o),{},{correlationId:t&&t.correlationId,isContentTransition:t&&t.isContentTransition})))),i}}}},{key:"slideIdsToMorphKey",value:function(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?"".concat(JSON.stringify(e),"_").concat(JSON.stringify(t)):"".concat(JSON.stringify(t),"_").concat(JSON.stringify(e))}},{key:"morphKeyToSlideIds",value:function(e){var t=e.split("_");return{slideIdA:JSON.parse(t[0]),slideIdB:JSON.parse(t[1])}}},{key:"contextRestoredHandler",value:(e=(0,o.default)(n.default.mark((function e(){var t,r,i,a,o,s=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_webGLContextRestoreStartTime=new Date,t=this.m_webGLContextLostStartTime?this.m_webGLContextRestoreStartTime.getTime()-this.m_webGLContextLostStartTime.getTime():-1,c.ULS.sendTraceTag(561639889,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"WebGL context restored in ".concat(t,"ms")),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,document.removeEventListener("visibilitychange",this.onVisibilityChange),this.setupWebGLContext(),this.gl){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.preloadShadersAsync(this.gl);case 11:if(!this.viewControllerInternals.currentRenderedSlideId){e.next=24;break}if(!(r=this.viewControllerInternals.slideSceneView.find((function(e){return e.slideId.sid===s.viewControllerInternals.currentRenderedSlideId.sid})))){e.next=24;break}return e.next=16,this.viewControllerInternals.createImageTextureMapData(r);case 16:return(i=e.sent).hasOwnProperty("invalidImageIds")&&(c.ULS.sendTraceTag(561639890,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"ViewController::contextRestoredHandler - ".concat(JSON.stringify(i))),p.VetoUtils.recordVeto("ACE",i)),e.next=20,r.slideViewElement.ensure();case 20:((a=e.sent).hasOwnProperty("invalidShapeIds")||a.hasOwnProperty("missingTextureIds")||a.hasOwnProperty("errorName"))&&(c.ULS.sendTraceTag(561639891,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"ViewController::contextRestoredHandler - ".concat(JSON.stringify(a))),p.VetoUtils.recordVeto("ACE",a),a.hasOwnProperty("errorName")&&this.viewController.events.emit("restoreWebGLContextFailed")),o={zoomLevel:g.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},this.viewController.renderSlideById(this.viewControllerInternals.currentRenderedSlideId,o);case 24:this.viewController.events.emit("webglcontextrestored");case 25:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"createImageFromTexture",value:function(e,t){var r=this.gl;if(r&&this.isGLContextValid){var i,n,a;e instanceof u.Texture?(i=e.tryGetWebGLTexture(),n=e.size.x,a=e.size.y):(i=e.texture,n=e.size.x,a=e.size.y);var o=r.createFramebuffer(),s=r.getParameter(r.FRAMEBUFFER_BINDING);r.bindFramebuffer(r.FRAMEBUFFER,o),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var l=new Uint8Array(n*a*4);r.readPixels(0,0,n,a,r.RGBA,r.UNSIGNED_BYTE,l),r.bindFramebuffer(r.FRAMEBUFFER,s),r.deleteFramebuffer(o);var c=y(),d=y(),h=d.canvas,f=d.context;if(f&&c.context){var m=c.context.createImageData(n,a);m.data.set(l),c.context.putImageData(m,0,0),f.translate(0,a),f.scale(1,-1),f.drawImage(c.canvas,0,0);var p=h.toDataURL();if(t&&t.fNewWindow){var g=window.open();if(g){var v=new Image;v.src=p,g.document.write(v.outerHTML)}}return p}console.log("createImageFromTexture: cannot create 2D context")}else console.log("createImageFromTexture: gl invalid");function y(){var e=document.createElement("canvas");e.width=n,e.height=a;var t=e.getContext("2d");return{canvas:e,context:t}}}}]);var e,t,r}();t.WebGLRendererEnvironmentDeprecated=P},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ViewDataManager=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(394),c=r(3),u=r(66),d=r(20),h=r(4);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var p=function(){return(0,s.default)((function e(t,r,i){(0,o.default)(this,e),this.memoryStats={gifTextures:0,transitionTextures:0,transitionsMemoryReport:new u.MemoryReport,videoTextures:0,cameoTextures:0,externalTextureLeaks:0},this.externalTexturesToRelease=[],this.slideIdOrder=[],this.visibleSlideIdOrder=[],this.glyphStore=new l.GlyphStore,this.sections=[],this.m_hiddenSlideIdOrder=[],this.m_slideViewDataLoader=t,this.m_shapeViewDataLoader=r,this.m_localizedStringLoader=i,this.imageDataMap=new Map,this.slideMetadataMap=new Map}),[{key:"onExternalTextureReleased",value:function(e){for(var t=this.externalTexturesToRelease.length-1;t>=0;t-=1){var r=this.externalTexturesToRelease[t];r.imageId===e&&((h.Settings.readBooleanOrDefault("fixExternalTextureTracking",!0)?r.texture.releasePolicy===d.TextureReleasePolicy.ExternallyManaged:r.texture.releasePolicy!==d.TextureReleasePolicy.ExternallyManaged)?(r.texture.release(),c.ULS.sendTraceTag(520966875,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"Releasing externally managed texture id:".concat(e))):c.ULS.sendTraceTag(572610636,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"ViewDataManager::onExternalTextureReleased: tried to release texture that is not ExternallyManaged. id:".concat(e)),this.externalTexturesToRelease.splice(t,1))}}},{key:"getSlideViewData",value:(r=(0,a.default)(n.default.mark((function e(t,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_slideViewDataLoader.load(JSON.stringify(t),r);case 2:return(i=e.sent).resource&&i.resource.shapeGlyph&&this.glyphStore.mergeGlyphs(i.resource.shapeGlyph),i&&i.resource||c.ULS.sendTraceTag(591927432,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Warning,"ViewDataManager::getSlideViewData: missing slideViewData. slideId:".concat(t.sid,", item exists:").concat(!!i,", correlation:").concat(r?r.meta_correlationId:"",", errorName:").concat(i&&i.hasOwnProperty("metadata")&&i.metadata.hasOwnProperty("errorName")?i.metadata.errorName:"")),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"getShapeViewData",value:(t=(0,a.default)(n.default.mark((function e(t,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_shapeViewDataLoader.load("".concat(JSON.stringify(t),"_").concat(JSON.stringify(r)));case 2:return i=e.sent,e.abrupt("return",i&&i.resource);case 4:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"setSlideIdOrder",value:function(e){c.ULS.sendTraceTag(576247950,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"ViewDataManager::setSlideIdOrder slideIdOrder:".concat(JSON.stringify(e))),this.slideIdOrder=e}},{key:"setSlideIdOrderWithHidden",value:function(e,t){var r=this;this.setSlideIdOrder(e),c.ULS.sendTraceTag(576247951,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Info,"ViewDataManager::setSlideIdOrderWithHidden hiddenSlideIdOrder:".concat(JSON.stringify(t))),this.m_hiddenSlideIdOrder=t,this.visibleSlideIdOrder=e.filter((function(e){return!r.m_hiddenSlideIdOrder.some((function(t){return t.sid===e.sid&&t.cid===e.cid}))}))}},{key:"getLocalizedString",value:(e=(0,a.default)(n.default.mark((function e(t){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.m_localizedStringLoader.load(t);case 2:return(r=e.sent)&&r.resource||c.ULS.sendTraceTag(591136962,c.LogCategory.msoulscat_Wac_PptSession,c.TraceLevel.Error,"Failed to get localized string. id:".concat(t)),e.abrupt("return",r&&r.resource);case 5:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"getVisibleSlideIndex",value:function(e){if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex((function(t){return t.sid===e.sid}));var t,r=-1,i=f(this.slideIdOrder);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=this.slideMetadataMap.get(n.sid);if(!a||void 0===a.isHidden)return-1;if(a.isHidden||(r+=1),n.sid===e.sid)return a.isHidden?-1:r}}catch(e){i.e(e)}finally{i.f()}return-1}},{key:"getVisibleSlideIndexDifference",value:function(e,t){var r=this.getSlideIndex(e),i=this.getSlideIndex(t);if(-1!==r&&-1!==i){if(r===i)return 0;if(!1===this.getIsHiddenByIndex(r)&&!1===this.getIsHiddenByIndex(i)){if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex((function(e){return e.sid===t.sid}))-this.visibleSlideIdOrder.findIndex((function(t){return t.sid===e.sid}));for(var n=r<i?1:-1,a=1,o=r+n;o!==i;o+=n){var s=this.getIsHiddenByIndex(o);if(void 0===s)return;s||(a+=1)}return n*a}}}},{key:"getIsHiddenByIndex",value:function(e){var t=this.slideMetadataMap.get(this.slideIdOrder[e].sid);return t?t.isHidden:void 0}},{key:"getSlideIndex",value:function(e){if(0===this.slideIdOrder.length)return-1;var t,r=0,i=f(this.slideIdOrder);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(e.sid===n.sid)return r;r+=1}}catch(e){i.e(e)}finally{i.f()}return-1}}]);var e,t,r}();t.ViewDataManager=p},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphStore=void 0;var n=i(r(1)),a=i(r(2)),o=r(14),s=r(3),l=r(4);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var d=(0,a.default)((function e(){(0,n.default)(this,e),this.m_glyphMap=new Map,this.m_knownGlyphsString=""}),[{key:"mergeGlyphs",value:function(e){if(null!=e){var t,r=c(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.hasGlyph(i.f,i.g)||this.addGlyph(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"addGlyph",value:function(e){var t=this.m_glyphMap.get(e.f);t||(t=[],this.m_glyphMap.set(e.f,t)),t.push(e),this.updateKnownGlyphsString()}},{key:"hasGlyph",value:function(e,t){var r=this.m_glyphMap.get(e);if(!r)return!1;var i,n=c(r);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.f===e&&a.g===t)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"getGlyph",value:function(e,t){var r=this.m_glyphMap.get(e);if(!r)return s.ULS.sendTraceTag(590103965,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"glyph font info missing"),void o.VetoUtils.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"FontInfo",qosVeto:"ContentRenderFailed"});var i,n=c(r);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.f===e&&a.g===t)return a}}catch(e){n.e(e)}finally{n.f()}s.ULS.sendTraceTag(590103966,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"glyph missing"),o.VetoUtils.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"Glyph",qosVeto:"ContentRenderFailed"})}},{key:"knownGlyphsString",get:function(){return this.m_knownGlyphsString}},{key:"updateKnownGlyphsString",value:function(){var e={};this.m_glyphMap.forEach((function(t){var r,i=c(t);try{for(i.s();!(r=i.n()).done;){var n=r.value,a=h.parseFontInfo(n.f);a.fontName in e||(e[a.fontName]={}),a.key in e[a.fontName]||(e[a.fontName][a.key]=[]),e[a.fontName][a.key].push(n.g)}}catch(e){i.e(e)}finally{i.f()}for(var o in e)for(var s in e[o])e[o][s].sort((function(e,t){return 1*e-1*t}));for(var l in e)for(var u in e[l])for(var d=0;d<e[l][u].length-1;d+=1){for(var f=0;d+f+1<e[l][u].length&&e[l][u][d+f]+1===e[l][u][d+f+1];)f+=1;if(f>0){var m="".concat(e[l][u][d+f]);m.length<f.toString().length?e[l][u][d]="".concat(e[l][u][d],"-").concat(m):e[l][u][d]="".concat(e[l][u][d],"+").concat(f),e[l][u].splice(d+1,f)}}})),this.m_knownGlyphsString=JSON.stringify(e),l.Settings.readBooleanOrDefault("logKnownGlyphsString",!1)&&s.ULS.sendTraceTag(558130316,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"GetKnownGlyphsString length: ".concat(this.m_knownGlyphsString.length))}}]);t.GlyphStore=d;var h=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"parseFontInfo",value:function(t){var r=e.findSixthComma(t);return{fontName:t.substring(1,r),key:t.substring(r+1,t.length-1)}}},{key:"findSixthComma",value:function(e){for(var t=e.length,r=0;r<6;r+=1)t=e.lastIndexOf(",",t-1);return t}}])}()},function(e,t,r){},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationLoggerNew=t.BootSegmentType=t.ActionType=void 0;var n,a,o=i(r(5)),s=i(r(1)),l=i(r(2)),c=r(3),u=r(47),d=r(34),h=r(14),f=r(11),m=r(4);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.ActionType=n,function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(n||(t.ActionType=n={})),t.BootSegmentType=a,function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(a||(t.BootSegmentType=a={}));var y=function(){function e(){(0,s.default)(this,e),this.m_navigationData={},this.m_maxGotoSlideMs=0,this.m_startFromTime=0,this.m_userActionTimestamp=0,this.m_initInfo={}}return(0,l.default)(e,[{key:"init",value:function(e){this.m_settings=e}},{key:"recordInitData",value:function(t){if(t.hasOwnProperty(n.Init)&&this.m_settings){var r={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:t,initDurFromEndUser:t[n.Init].end-this.m_settings.appSettings.initTime,initDur:t[n.Init].end-t[n.Init].start,Config:u.SessionUtils.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=r.InitInfo);var i={initDur:r.initDur,initDurFromEndUser:r.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(r[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),u.SessionUtils.recordSessionStats(i),c.ULS.sendTraceTag(592483858,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("SSCoreInit",r))}}},{key:"recordNavData",value:function(t,r,i,a){if(i&&0!==Object.keys(i).length&&i.hasOwnProperty("sid")&&this.m_settings){var o=!1,s=!1,l=!1,p=i.sid.toString();if(a&&a.bootMetrics){if(0===this.m_startFromTime&&(o=!0,this.m_navigationData.hasOwnProperty(p))){var g=this.m_navigationData[p];g.hasOwnProperty(n.Prerender)&&(s=!0),g.hasOwnProperty(n.Prefetch)&&(l=!0)}this.m_startFromTime=a.startFromTime?a.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},a.startFromTime||c.ULS.sendTraceTag(588804161,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(p)||(this.m_navigationData[p]={}),f.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.hasOwnProperty(e.TextureMetadata)&&(i[e.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(e.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[e.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(e.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[e.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(e.RenderToTexture)&&(i.createTransition.rendererEnvironment[e.RenderToTexture]=void 0))),f.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMissingTextures")&&i.hasOwnProperty("missingTextureIds")){var y={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};c.ULS.sendTraceTag(507598877,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnTrimmedDataTextureIds",y)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}var _=this.m_navigationData[p];if(i.hasOwnProperty(e.Metadata)){_.hasOwnProperty(e.Metadata)||(_[e.Metadata]=[]),_[e.Metadata]=_[e.Metadata].concat(i[e.Metadata].filter((function(t){return!_[e.Metadata].includes(t)})));var S=!1;for(var T in i[e.Metadata])if(i[e.Metadata][T].hasOwnProperty(e.MediaInfo)){S=!0;break}S&&!u.SessionUtils.getSessionStats("hasMedia")&&u.SessionUtils.recordSessionStats({hasMedia:!0}),f.ChangeGate.isChangeGateEnabled("ssc.HasMediaPartCDimension")&&S&&h.HealthAdapter.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(f.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMetadata")&&i.hasOwnProperty(e.Metadata)){var b={id:i&&i.id,sr:i&&i.sr,metadata:i[e.Metadata]};c.ULS.sendTraceTag(507597592,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnTrimmedDataMetadata",b)),i[e.Metadata]=void 0,i.hasMetadata=!0}var C=0;if(a&&a.navMetrics&&a.navMetrics.checkHiddenSlideResult&&(C=e.getDuration(a.navMetrics.checkHiddenSlideResult)),!(r===n.Goto&&_.hasOwnProperty(n.Goto)&&i.hasOwnProperty(n.Goto)&&e.getDuration(_[n.Goto])+e.getDuration(_[n.CheckHidden])>=e.getDuration(i[n.Goto])+C||r===n.Prefetch&&_.hasOwnProperty(n.Prefetch))){for(var w in i)if(w===n.Goto)if(_[n.CheckHidden]=C,a&&a.bootMetrics){var P={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:a?a.startFromTime:void 0,bootMetrics:a?a.bootMetrics:void 0,Config:u.SessionUtils.getSessionConfig(),EUPL:a.startFromTime&&0!==a.startFromTime?i[w].end-a.startFromTime:void 0,firstStartMetrics:{firstStart:o}};if(f.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&a&&a.id&&(P.id=a.id),i.hasOwnProperty("pptSpinnerStartTime")&&P.bootMetrics&&(P.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(P.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(P[e.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(e.Metadata)){var I=this.getMetadataSummary(i[e.Metadata]);I.length>0&&(P[e.Metadata]=I),P.NavigationInfo=Object.keys(i).reduce((function(t,r){return r!==e.Metadata&&(t[r]=i[r]),t}),{})}else P.NavigationInfo=i;P.slideIndex=t.getVisibleSlideIndex({sid:i.sid,cid:0}),f.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=P.slideIndex),o&&(P.firstStartMetrics.prefetched=l,P.firstStartMetrics.prerendered=s),0!==Object.keys(this.m_initInfo).length&&(P.initMetrics=this.m_initInfo),P.EUPL>m.Settings.readNumberOrDefault("vetoBootDurationMs",2e3)&&h.VetoUtils.recordVeto("VetoedSlideShowBootTimeMs",v({qosVeto:"PerceivedOpenSlow"},P)),i.hasOwnProperty(e.GetItemsResult)&&void 0!==i[e.GetItemsResult]&&(P[e.GetItemsResult]=i[e.GetItemsResult]),f.ChangeGate.isChangeGateEnabled("AddSlideDuration")&&(this.m_bootLaunchId=a&&a.id),c.ULS.sendTraceTag(594650330,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("boot",P))}else a&&!a.bootMetrics&&(i.hasOwnProperty("errorName")||(_[w]=i[w],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(_[e.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(e.NavigationStep)&&0!==i[e.NavigationStep]&&1!==i[e.NavigationStep]&&(_[e.NavigationStep]=i[e.NavigationStep]),a&&a.navigationType&&a.navigationType!==d.NavigationType.Init&&a.navigationType!==d.NavigationType.Next&&a.navigationType!==d.NavigationType.Prev&&(_.navigation=a.navigationType),i.hasOwnProperty(e.CachedInServer)&&(_[e.CachedInServer]=i[e.CachedInServer]),i.hasOwnProperty(e.RequestInfo)&&(_[e.RequestInfo]=i[e.RequestInfo]),i.hasOwnProperty(e.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,e.getDuration(_[w])),e.getDuration(i[w])+C>m.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&h.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",v({qosVeto:"SlideShowNavSlow"},this.m_navigationData[p.toString()])))));else w===n.Prefetch&&(i.hasOwnProperty("errorName")?_.hasOwnProperty("errorCount")?_.errorCount+=1:_.errorCount=1:_[w]=i[w],i.hasOwnProperty(n.Prerender)&&(_[n.Prerender]=i[n.Prerender]),i.hasOwnProperty(e.CachedInServer)&&(_[e.CachedInServer]=i[e.CachedInServer]),i.hasOwnProperty(e.RequestInfo)&&(_[e.RequestInfo]=i[e.RequestInfo]));var k;if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=r,i.startFromTime=this.m_startFromTime,c.ULS.sendTraceTag(594650332,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,e.getLogString("navigation",i)),f.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(k=t.getVisibleSlideIndex({sid:i.sid,cid:0})),f.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&r===n.Goto){var E={id:i&&i.id,navType:a&&a.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(f.ChangeGate.isChangeGateEnabled("AddSlideDuration"))if(f.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(E.sr=i.sr,E.playTransitionMs=i.playTransitionMs,E.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==k?k-this.m_slideIndexFromBoot:void 0,E.loadSlide=i.LoadSlide,E.fPrepared=i.fPrepared),E.bootLaunchId=this.m_bootLaunchId,a&&a.navigationType===d.NavigationType.Init)this.m_userActionTimestamp=u.SessionUtils.performanceNowTrimmed();else if(a&&(a.navigationType===d.NavigationType.Next||a.navigationType===d.NavigationType.Prev||a.navigationType===d.NavigationType.GoTo)){var x=u.SessionUtils.performanceNowTrimmed();E.timeSpentOnPrevSlide=x-this.m_userActionTimestamp,this.m_userActionTimestamp=x,E.navType=a.navigationType}c.ULS.sendTraceTag(507787460,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("addOnnavigation",E))}}}}},{key:"logPerfData",value:function(){var t=this;if(0!==Object.keys(this.m_navigationData).length&&this.m_settings){var r=[],i=Object.keys(this.m_navigationData).map((function(i){var a=t.m_navigationData[i],o={};return o.id=i,Object.keys(a).forEach((function(i){if(i===n.Goto||i===n.Prefetch||i===n.Prerender)o[i]=e.getDuration(a[i]);else if(i===e.Metadata){var s,l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(a[e.Metadata]);try{for(l.s();!(s=l.n()).done;){var c=s.value;c.hasOwnProperty(e.MediaInfo)&&r.push(c[e.MediaInfo])}}catch(e){l.e(e)}finally{l.f()}var u=t.getMetadataSummary(a[e.Metadata]);u.length>0&&(o[e.Metadata]=u)}else o[i]=a[i]})),o})),a={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:i,Config:u.SessionUtils.getSessionConfig()};u.SessionUtils.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),c.ULS.sendTraceTag(594650331,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("navSummary",a));var o={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:r,Config:u.SessionUtils.getSessionConfig()};Object.keys(r).length>0&&c.ULS.sendTraceTag(591165197,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,e.getLogString("mediaSummary",o))}}},{key:"getMetadataSummary",value:function(t){var r=[];for(var i in t)if(t[i].hasOwnProperty(e.MediaInfo)){var n=t[i][e.MediaInfo];r.includes(n.type)||r.push(n.type)}else r.includes(t[i])||r.push(t[i]);return r}}],[{key:"getDuration",value:function(e){return e.end-e.start}},{key:"getLogString",value:function(e,t){if(!t)return"";var r=JSON.stringify(t),i=r.length;return i>3e3&&c.ULS.sendTraceTag(572289234,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"log size is too long! size:".concat(i,", source:").concat(e)),r}}])}();t.NavigationLoggerNew=y,y.RenderCost="render",y.Metadata="metadata",y.NavigationStep="step",y.CachedInServer="cached",y.PlayTransitionMs="playTransitionMs",y.GetItemsResult="getItemsResult",y.UseSnapDownloadUrlString="useSnap",y.MediaInfo="mediaInfo",y.RequestInfo="requestInfo",y.TextureMetadata="textureMetadata",y.RenderTransitionTextures="renderTransitionTextures",y.GenerateMorphResource="generateMorphResource",y.RenderToTexture="renderToTexture"},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingUI=void 0;var n=i(r(1)),a=(0,i(r(2)).default)((function e(t){(0,n.default)(this,e);var r=document.createElement("style");r.setAttribute("type","text/css"),r.textContent="\n     #scc_loading_ui{width:100%;height:100%;position:absolute;text-align:center;display:none;}\n     #scc_loading_centerer{position:absolute;left:50%;right:0;bottom:50%;}\n     #scc_loading_spinner {\n         position: absolute;\n         display: block;\n         border: 2px solid #d9d9d9;\n         border-top: 2px solid #b7472a;\n         border-radius: 95%;\n         top: 7px;\n         left: 6px;\n         width: 48px;\n         height: 48px;\n         margin-left: -25px;\n         margin-top: -25px;\n         z-index: 1051;\n         -moz-animation: scc_fastbootspin 1.4s ease infinite;\n         -webkit-animation: scc_fastbootspin 1.4s ease infinite;\n         animation: scc_fastbootspin 1.4s ease infinite;\n     }\n     @-moz-keyframes scc_fastbootspin {\n         100% {\n             -moz-transform: rotate(360deg);\n         }\n     }\n     @-webkit-keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n         }\n     }\n     @keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n             transform: rotate(360deg);\n         }\n     }",document.getElementsByTagName("head")[0].appendChild(r),this.m_loadingDiv=document.createElement("div"),this.m_loadingDiv.id="scc_loading_ui",t.appendChild(this.m_loadingDiv);var i=document.createElement("div");i.id="scc_loading_centerer",this.m_loadingDiv.appendChild(i);var a=document.createElement("span");a.id="scc_loading_spinner",i.appendChild(a)}),[{key:"show",value:function(){this.m_loadingDiv.style.display="block"}},{key:"hide",value:function(){this.m_loadingDiv.style.display="none"}},{key:"isVisible",get:function(){return"block"===this.m_loadingDiv.style.display}}]);t.LoadingUI=a},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowCoreStateManager=void 0;var n=i(r(1)),a=i(r(2)),o=r(26),s=r(3),l=r(4),c=r(47),u=r(34),d=(0,a.default)((function e(t,r){(0,n.default)(this,e),this.m_showLoadingUITimeoutId=-1,this.m_events=new o.EventEmitter,this.m_isBoot=!0,this.m_telemetry={},this.m_state=t,this.m_loadingUI=r,this.m_progressIndicatorWaitTimeMs=l.Settings.readNumberOrDefault("progressIndicatorWaitTimeMs",1250),s.ULS.sendTraceTag(507000078,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowCoreStateManager: Progress Indicator wait time: ".concat(this.m_progressIndicatorWaitTimeMs))}),[{key:"state",get:function(){return this.m_state}},{key:"getTelemetry",value:function(){return this.m_telemetry}},{key:"setState",value:function(e){var t=this;if(e!==this.m_state){switch(this.m_state=e,e){case u.SlideShowCoreState.Normal:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_isBoot=!1,this.m_loadingUI.hide();break;case u.SlideShowCoreState.Loading:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_showLoadingUITimeoutId=window.setTimeout((function(){t.m_loadingUI.show(),t.m_isBoot&&(t.m_telemetry.pptSpinnerStartTime=c.SessionUtils.performanceNowTrimmed()),s.ULS.sendTraceTag(574743133,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"SlideShowCoreStateManager: Showing Loading Spinner. isBoot: ".concat(t.m_isBoot,"."))}),this.m_progressIndicatorWaitTimeMs)}this.m_events.emit("stateChanged")}}}]);t.SlideShowCoreStateManager=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ZoomManager=t.ZoomEntry=void 0;var n=i(r(1)),a=i(r(2)),o=r(182),s=r(3);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=(0,a.default)((function e(t,r,i,a,o,s){(0,n.default)(this,e),this.m_returningEntry=!1,this.m_targetSlide=t,this.m_lastSlide=r,this.m_section=i,this.m_originSlide=o,this.m_returnToParent=a,this.m_returningEntry=s}),[{key:"targetSlide",get:function(){return this.m_targetSlide}},{key:"returnToParent",get:function(){return this.m_returnToParent}},{key:"originSlide",get:function(){return this.m_originSlide}},{key:"lastSlide",get:function(){return this.m_lastSlide}}]);t.ZoomEntry=u;var d=(0,a.default)((function e(t){(0,n.default)(this,e),this.m_zoomStack=[],this.m_zoomCollection=[],this.m_viewDataManager=t}),[{key:"clear",value:function(){this.m_zoomStack=[],this.m_zoomCollection=[]}},{key:"addSlide",value:function(e,t,r){var i=new u(e,e,"",r,t,!1);this.m_zoomStack.push(i),this.m_zoomCollection.push(i)}},{key:"addSection",value:function(e,t,r){var i=(0,o.getFirstSlideIdFromSection)(e,this.m_viewDataManager.sections),n=(0,o.getLastSlideIdFromSection)(e,this.m_viewDataManager.sections);if(i&&n){var a=new u(i,n,e,r,t,!1);this.m_zoomStack.push(a),this.m_zoomCollection.push(a),1===this.m_zoomCollection.length&&s.ULS.sendTraceTag(507122019,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowCoreZoomManager::addSection - Starting summary zoom navigation")}}},{key:"needsToReturnOnNext",value:function(e){return this.m_zoomStack.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent}},{key:"nextReturnToParentId",value:function(e){if(this.m_zoomCollection.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent){var t=this.m_zoomStack[this.m_zoomStack.length-1];return this.m_zoomStack.pop(),t=new u(t.targetSlide,t.lastSlide,t.m_section,t.returnToParent,t.originSlide,!0),this.m_zoomCollection.push(t),t?t.originSlide:null}return null}},{key:"needsToJumpOnNext",value:function(e){return!(this.m_zoomCollection.length<=0)&&(!this.m_zoomStack[this.m_zoomStack.length-1]||this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid===e.sid)&&e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry}},{key:"slideWhereZoomLeftOff",value:function(e){var t=e;return e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry&&(t=this.m_zoomCollection[this.m_zoomCollection.length-1].lastSlide),t.cid=0,t}},{key:"zoomOnCurrentSlide",value:function(e,t,r){var i,n=l(t);try{for(n.s();!(i=n.n()).done;){var a=i.value,s=void 0,c=void 0;if(a.slideId&&(s=a.slideId,c=a.slideId),a.sectionId&&(s=(0,o.getFirstSlideIdFromSection)(a.sectionId,this.m_viewDataManager.sections),c=(0,o.getLastSlideIdFromSection)(a.sectionId,this.m_viewDataManager.sections)),s&&c&&s.sid===e.sid)return a.slideId&&this.addSlide(s,r,a.returnToParent),a.sectionId&&this.addSection(a.sectionId,r,a.returnToParent),!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"checkZoomGoBack",value:function(e){if(this.m_zoomCollection.length>0){var t,r=this.m_zoomCollection[this.m_zoomCollection.length-1];return t=r.m_returningEntry?r.originSlide:r.targetSlide,e.sid===t.sid}return!1}},{key:"zoomGoBack",value:function(e){if(this.m_zoomCollection.length>0){var t,r,i=this.m_zoomCollection[this.m_zoomCollection.length-1];return i.m_returningEntry?(t=i.originSlide,r=i.lastSlide):(t=i.targetSlide,r=i.originSlide),e.sid===t.sid&&(this.m_zoomCollection.pop(),i.m_returningEntry?(i.m_returningEntry=!1,this.m_zoomStack.push(i)):this.m_zoomStack.pop()),r.cid=0,r}return null}}]);t.ZoomManager=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorUtils=void 0;var n=i(r(1)),a=i(r(2)),o=r(34),s=(0,a.default)((function e(){(0,n.default)(this,e)}),null,[{key:"convertToSlideShowError",value:function(e){switch(e){case"ErrorRESERVEDItemFailed":case"ErrorContentDispositionHeaderNotValid":case"ErrorItemNameNotValid":case"ErrorResponseNotValid":return o.SlideShowErrorCode.GetItemsFailedInvalidResponse;case"ErrorRequestTimeout":return o.SlideShowErrorCode.GetItemsTimeout;case"ErrorFailedToFetch":case"ErrorRequestCanceled":case"ErrorConnectionLost":case"ErrorRequestFailed":return o.SlideShowErrorCode.GetItemsRequestFailed;case"ServerErrorFileDownloadStatusCodeNotFound":return o.SlideShowErrorCode.GetItemsFailedDownloadFile;case"ErrorFailedToLoadPresInfo":case"ErrorMissingClientWidthOrHeight":case"ErrorFailedToLoadSlide":case"ErrorFailedToParseSlideInfo":case"ErrorFailedToLoadSlideViewData":case"ErrorFailedToLoadShapeViewData":case"ErrorFailedToLoadResourceEntry":case"ErrorMissingEntriesInOptions":case"ErrorFailedToLoadSlideInfo":case"ErrorMissingSlideId":return o.SlideShowErrorCode.LoadFailed;case"ErrorResourceNotFound":case"ErrorResourceNotAllowed":case"ErrorResourceLoaderNotAvailable":return o.SlideShowErrorCode.ResourceLoaderFailed;case"FailedToRenderContextLost":case"FailedToRenderSBNotReady":case"FailedToRenderMissingSceneView":case"TexturesNotLoaded":case"MissingSceneView":case"TryPrepareTimeout":return o.SlideShowErrorCode.SlideVisualizationFailed;case"InvalidHiddenSlideInfo":case"SlideMetadataNotFound":return o.SlideShowErrorCode.EnsureSlideFailed}return e}}]);t.ErrorUtils=s},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=function(){function e(){(0,n.default)(this,e),e.getMemoryUsage()&&window.setInterval(e.logMemoryUsage,6e4)}return(0,a.default)(e,null,[{key:"getMemoryUsage",value:function(){var e=window.performance;if(e&&e.memory){var t={heapLimit:e.memory.jsHeapSizeLimit,totalHeapSize:e.memory.totalJSHeapSize,usedHeapSize:e.memory.usedJSHeapSize};return navigator.deviceMemory&&(t.availableRAMInGB=navigator.deviceMemory),t}o.ULS.sendTraceTag(587560398,o.LogCategory.msoulscat_Wac_PptSlideshow,o.TraceLevel.Info,"performance.memory not supported")}},{key:"logMemoryUsage",value:function(){var t=e.getMemoryUsage();t&&o.ULS.sendTraceTag(587560399,o.LogCategory.msoulscat_Wac_PptSlideshow,t.usedHeapSize/t.heapLimit>.8?o.TraceLevel.Warning:o.TraceLevel.Info,JSON.stringify(t))}}])}();t.MemoryLogger=s},function(e,t,r){"use strict";var i,n,a;r(0)(r(15)),n=[r(405)],void 0===(a="function"==typeof(i=function(e){var t=/(^|@)\S+:\d+/,r=/^\s*at .*(\S+:\d+|\(native\))/m,i=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(r))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(r)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var r=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),i=r.match(/ (\((.+):(\d+):(\d+)\)$)/),n=(r=i?r.replace(i[0],""):r).split(/\s+/).slice(1),a=this.extractLocation(i?i[1]:n.pop()),o=n.join(" ")||void 0,s=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new e({functionName:o,fileName:s,lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(i)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var r=/((.*".+"[^@]*)?[^@]*)(?:@)/,i=t.match(r),n=i&&i[1]?i[1]:void 0,a=this.extractLocation(t.replace(r,""));return new e({functionName:n,fileName:a[0],lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var r=/Line (\d+).*script (?:in )?(\S+)/i,i=t.message.split("\n"),n=[],a=2,o=i.length;a<o;a+=2){var s=r.exec(i[a]);s&&n.push(new e({fileName:s[2],lineNumber:s[1],source:i[a]}))}return n},parseOpera10:function(t){for(var r=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,i=t.stacktrace.split("\n"),n=[],a=0,o=i.length;a<o;a+=2){var s=r.exec(i[a]);s&&n.push(new e({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:i[a]}))}return n},parseOpera11:function(r){return r.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var r,i=t.split("@"),n=this.extractLocation(i.pop()),a=i.shift()||"",o=a.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;a.match(/\(([^)]*)\)/)&&(r=a.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var s=void 0===r||"[arguments not available]"===r?void 0:r.split(",");return new e({functionName:o,args:s,fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:t})}),this)}}})?i.apply(t,n):i)||(e.exports=a)},function(e,t,r){"use strict";var i,n;r(0)(r(15)),void 0===(n="function"==typeof(i=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],i=["columnNumber","lineNumber"],n=["fileName","functionName","source"],a=r.concat(i,n,["args"],["evalOrigin"]);function o(t){if(t)for(var r=0;r<a.length;r++)void 0!==t[a[r]]&&this["set"+e(a[r])](t[a[r]])}o.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof o)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new o(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",r=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+r+")":"[eval]:"+t+":"+r:i?i+" ("+e+":"+t+":"+r+")":e+":"+t+":"+r}},o.fromString=function(e){var t=e.indexOf("("),r=e.lastIndexOf(")"),i=e.substring(0,t),n=e.substring(t+1,r).split(","),a=e.substring(r+1);if(0===a.indexOf("@"))var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,""),l=s[1],c=s[2],u=s[3];return new o({functionName:i,args:n||void 0,fileName:l,lineNumber:c||void 0,columnNumber:u||void 0})};for(var s=0;s<r.length;s++)o.prototype["get"+e(r[s])]=t(r[s]),o.prototype["set"+e(r[s])]=function(e){return function(t){this[e]=Boolean(t)}}(r[s]);for(var l=0;l<i.length;l++)o.prototype["get"+e(i[l])]=t(i[l]),o.prototype["set"+e(i[l])]=function(e){return function(t){if(r=t,isNaN(parseFloat(r))||!isFinite(r))throw new TypeError(e+" must be a Number");var r;this[e]=Number(t)}}(i[l]);for(var c=0;c<n.length;c++)o.prototype["get"+e(n[c])]=t(n[c]),o.prototype["set"+e(n[c])]=function(e){return function(t){this[e]=String(t)}}(n[c]);return o})?i.apply(t,[]):i)||(e.exports=n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppForOfficeManagerFactory=t.AppForOfficeManager=void 0;var i=r(24),n=r(119),a=r(3),o=r(407),s=r(408),l=r(409),c=r(411),u=r(120),d=r(94),h=r(4),f=r(26),m=function(){function e(){this.events=new f.EventEmitter,this.m_appForOfficeViewQueue=[],this.m_slideIdToAppForOfficeViewMap=new Map,this.m_slideIdToAppForOfficeThemeMap=new Map,this.m_appForOfficeToAppForOfficeViewMap=new Map,this.m_panelParentElement=null,this.m_instanceIdToAppMapping=new Map,this.m_instanceIdToSlideIdMapping=new Map,this.m_fInitialized=!1,this.m_frameTrustState=s.HostFrameTrustState.NotInitialized,this.m_osfruntimeloaded=!1,this.c_NumberOfMostRecentlyUsedAppForOfficeView=1,this.c_OsfRuntimeScriptId="OsfRuntimeScriptId",this.c_OsfRuntimeJSFileName="osfruntimepptwac.js",this.c_OsfRunTimeFunctionName="OfficeExt",this.c_UiHostUnifiedAppName="unified app",this.c_TimerInterval=20,this.m_fInitialized=!1,this.m_managerSettings={AppsForOfficePrivateCatalogEnabled:!0,AppForOfficeAllowExternalMarketplace:!0,AppForOfficeOmexBaseUrl:"https://store.office.com",AppForOfficeTrustUXIsEnabledForPowerPoint:!0,AppLcid:"1033",AppUILocale:"en-US",AreThirdPartyAddInsAllowed:!0,IsRtl:!1,ServerUrl:"",UploadFileDevCatalogIsDisabled:!1,SdxCdnUrl:"",Sdx1CdnUrl:"",ForceUseSdx1Cdn:!1,SdxDmsUrl:"",SovereignFederationDMSToken:"Production",SovereignFederationDMSTokenSuffix:"",DefaultManifestTokens:{__proto__:null}}}return e.prototype.initialize=function(e,t){this.m_managerSettings=t,this.updateManagerSettings(),this.m_panelParentElement=e,this.m_appForOfficeViewQueue=[],this.m_methodFactory=new l.ReaderMethodFactory(this),this.m_eventStore=new c.ReaderEventStore(this),this.m_fInitialized=!0},e.prototype.updateManagerSettings=function(){var e=this.m_managerSettings.JsScriptsBasePath;e&&(this.m_managerSettings.JsScriptsBasePath=e.replace("/ssapp/",""))},e.prototype.fInitialized=function(){return this.m_fInitialized},e.prototype.fOsfruntimeLoaded=function(){return this.m_osfruntimeloaded},e.prototype.prepareAppsForOfficeList=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,a,o;return(0,i.__generator)(this,(function(i){if(!this.fInitialized())return[2];if(null==t||0===t.length)return[2];for(n=0,a=t;n<a.length;n++)o=a[n],this.prepareAppForOffice(e,o,(function(){}));return r&&this.m_slideIdToAppForOfficeThemeMap.set(e,r),[2]}))}))},e.prototype.showAppsForOfficeForSlide=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,s;return(0,i.__generator)(this,(function(i){return this.fInitialized()?(this.m_currentSlideId=e,null==t||0===t.length?(this.hideAppForOfficeViewsExcludeCurrentSlide(),[2]):(this.setInstanceIdToAppMapForSlide(t),this.setInstanceIdToSlideIdMapForSlide(e,t),r&&this.m_slideIdToAppForOfficeThemeMap.set(e,r),null==(n=this.getAppForOfficeViewBySlide(this.m_currentSlideId))?(null==(n=this.m_slideIdToAppForOfficeViewMap.get(this.m_currentSlideId))?n=new o.AppForOfficeView(this,this.m_panelParentElement,this.m_currentSlideId,this.m_managerSettings.IsRtl):this.m_slideIdToAppForOfficeViewMap.delete(this.m_currentSlideId),this.m_appForOfficeViewQueue.push(n),this.m_appForOfficeViewQueue.length>this.c_NumberOfMostRecentlyUsedAppForOfficeView&&(s=this.m_appForOfficeViewQueue[0],this.m_appForOfficeViewQueue.splice(0,1),this.disposeAppForOfficeView(s)),n.activateAppsForOffice(t,this.contextActivationManager(),!0),n.updateLayout(),a.ULS.sendTraceTag(508688342,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are activated."))):(n.activateAppsForOffice(t,this.contextActivationManager(),!0),n.showAppsForOffice(),n.updateLayout(),a.ULS.sendTraceTag(508688341,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are showing."))),this.hideAppForOfficeViewsExcludeCurrentSlide(),[2])):[2]}))}))},e.prototype.loadOsfRuntime=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},this.m_managerSettings.UiHost&&this.m_managerSettings.UiHost.toLocaleLowerCase()===this.c_UiHostUnifiedAppName?(this.m_osfruntimeloaded=void 0!==window[this.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX),this.m_osfruntimeloaded?[3,2]:[4,this.ensureOsfRuntimeLoaded()]):[3,3];case 1:t=r.sent(),r.label=2;case 2:return[3,5];case 3:return this.m_osfruntimeloaded?[3,5]:[4,this.createScriptElement()];case 4:t=r.sent(),r.label=5;case 5:return[2,t]}}))}))},e.prototype.setFrameTrustStatus=function(t){this.m_frameTrustState=t?s.HostFrameTrustState.Trusted:s.HostFrameTrustState.NotTrusted,e.m_appForOfficeContextActivivationManager&&e.m_appForOfficeContextActivivationManager.hostCheckReadyHandler(this,this.m_frameTrustState)},e.prototype.ensureOsfRuntimeLoaded=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,i.__generator)(this,(function(r){return[2,new Promise((function(r,i){try{if(t.fInitialized()&&!t.m_osfruntimeloaded)var n={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a=h.Settings.readNumberOrDefault("ensureOsfRuntimeTimeout",1e4),o=setInterval((function(){(a-=t.c_TimerInterval)<1&&(clearInterval(o),i({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime."})),void 0!==window[t.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX)&&(clearInterval(o),t.m_osfruntimeloaded=!0,n.end=e.performanceNowTrimmed(),r(n))}),t.c_TimerInterval)}catch(e){i({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime ".concat(e)})}}))]}))}))},e.prototype.createScriptElement=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,i.__generator)(this,(function(r){return[2,new Promise((function(r,i){try{if(t.fInitialized()&&!t.m_osfruntimeloaded&&!document.getElementById(t.c_OsfRuntimeScriptId)){var n={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a=document.createElement("script");a.id=t.c_OsfRuntimeScriptId,h.Settings.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&a.setAttribute("crossdomain","anonymous"),a.type="text/javascript",a.async=!0;var o=t.m_managerSettings.JsScriptsBasePath;o&&o.length>0?a.src="".concat(o,"/").concat(t.c_OsfRuntimeJSFileName):a.src=h.Settings.readStringOrDefault("osfRunTimeJSFileName",t.c_OsfRuntimeJSFileName),a.onload=function(){t.m_osfruntimeloaded=!0,n.end=e.performanceNowTrimmed(),r(n)},a.onerror=function(){i({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script ".concat(a.src)})},document.body.appendChild(a)}}catch(e){i({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script ".concat(e)})}}))]}))}))},e.prototype.showAppForOffice=function(t,r,i,n){var s={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()};if(!i||!t||!r)return a.ULS.sendTraceTag(508688340,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Error,"AppForOfficeManager::showAppForOffice invalid input paramters."),s;if(!this.fInitialized()||!this.m_osfruntimeloaded)return s;var l=this.m_appForOfficeToAppForOfficeViewMap.get(i);return l&&(this.disposeAppForOfficeView(l),this.m_appForOfficeToAppForOfficeViewMap.delete(i)),this.setInstanceIdToAppMap(i.InstanceId,i),this.setInstanceIdToSlideIdMap(i.InstanceId,r),n&&this.m_slideIdToAppForOfficeThemeMap.set(r,n),l=new o.AppForOfficeView(this,t,r,this.m_managerSettings.IsRtl),this.m_appForOfficeToAppForOfficeViewMap.set(i,l),l.activateAppsForOffice([i],this.contextActivationManager(),!1),s.end=e.performanceNowTrimmed(),a.ULS.sendTraceTag(508688339,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"Apps For Office on the slide ".concat(this.m_currentSlideId," are activated.")),s},e.prototype.getAppForOfficeViewByAppForOffice=function(e){if(e&&this.m_appForOfficeToAppForOfficeViewMap.has(e))return this.m_appForOfficeToAppForOfficeViewMap.get(e)},e.prototype.getAppByInstanceId=function(e){return d.Helper.validateArgument(e),this.m_instanceIdToAppMapping.get(e)},e.prototype.setInstanceIdToAppMap=function(e,t){null!=t&&null!=e&&this.m_instanceIdToAppMapping.set(e,t)},e.prototype.setInstanceIdToAppMapForSlide=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.setInstanceIdToAppMap(i.InstanceId,i)}},e.prototype.getAppForOfficeViewBySlide=function(e){for(var t=0,r=this.m_appForOfficeViewQueue;t<r.length;t++){var i=r[t];if(i.Id===e)return i}return null},e.prototype.getAppForOfficeThemeBySlide=function(e){return this.m_slideIdToAppForOfficeThemeMap.get(e)},e.prototype.hideAppForOfficeViewsExcludeCurrentSlide=function(){if(null!=this.m_currentSlideId)for(var e=0,t=this.m_appForOfficeViewQueue;e<t.length;e++){var r=t[e];r.Id!==this.m_currentSlideId&&r.hideAppsForOffice()}},e.prototype.hideAppForOfficeOnSlide=function(e){if(this.fInitialized()&&(null==e||this.m_currentSlideId===e)&&null!=this.m_currentSlideId)for(var t=0,r=this.m_appForOfficeViewQueue;t<r.length;t++){var i=r[t];i.Id===this.m_currentSlideId&&i.hideAppsForOffice()}},e.prototype.updateAddinSyncState=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return this.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent.toString(),e.instanceId,e.liveShareState),[2]}))}))},e.prototype.notifyHostCallback=function(t,r){if(a.ULS.sendTraceTag(508688338,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"AppForOfficeManager::notifyHostCallback contextId:".concat(t," actionId:").concat(r)),r===OSF.AgaveHostAction.TabExit||r===OSF.AgaveHostAction.TabExitShift)try{var i=r===OSF.AgaveHostAction.TabExit?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift,n=void 0;if(null!=this.m_currentSlideId){var o=this.getAppForOfficeViewBySlide(this.m_currentSlideId);if(o){var s=r===OSF.AgaveHostAction.TabExit;n=o.findActivatedViewElementSiblingByInstanceId(t,s)}}if(null!=n)a.ULS.sendTraceTag(508688337,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to another Agave for TabExit/TabExitShift. ContextID of newly focused Agave: ".concat(n.AppForOffice.InstanceId)),e.m_appForOfficeContextActivivationManager.notifyAgave(n.AppForOffice.InstanceId,i);else{a.ULS.sendTraceTag(508688336,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to slide pane for TabExit/TabExitShift.");var l=this.getAppByInstanceId(t);if(l){var c=this.getAppForOfficeViewByAppForOffice(l);c&&c.ParentElement&&c.ParentElement.focus()}}}catch(e){a.ULS.sendTraceTag(508688335,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Error,"AppForOfficeManager::NotifyHostCallback Switching focus threw an exception: ".concat(e))}},e.prototype.contextActivationManager=function(){if(null==e.m_appForOfficeContextActivivationManager){var t=void 0;if(this.m_managerSettings.AppForOfficeContextActivationParameters)null!=(t=this.m_managerSettings.AppForOfficeContextActivationParameters).isHostFrameTrusted&&(this.m_frameTrustState=t.isHostFrameTrusted);else{(t=new Object).appVersion="16",t.appUILocale=this.m_managerSettings.AppUILocale,t.dataLocale=this.m_managerSettings.AppUILocale,t.osfOmexBaseUrl=this.m_managerSettings.AppForOfficeOmexBaseUrl,t.docUrl="",t.pageBaseUrl=this.m_managerSettings.ServerUrl,t.lcid=this.m_managerSettings.AppLcid,t.allowExternalMarketplace=this.m_managerSettings.AppForOfficeAllowExternalMarketplace;var r="".concat(this.m_managerSettings.ServerUrl,"/pptscripts/"),i="".concat(this.m_managerSettings.ServerUrl,"/pptresources/");this.m_managerSettings.JsScriptsBasePath&&(r=this.m_managerSettings.JsScriptsBasePath,i=this.m_managerSettings.JsScriptsBasePath.replace("_pptscripts","_pptresources")),t.localizedScriptsUrl="".concat(r,"/").concat(this.m_managerSettings.AppLcid,"/"),t.localizedImagesUrl="".concat(i,"/").concat(this.m_managerSettings.AppLcid,"/"),t.localizedStylesUrl="".concat(i,"/").concat(this.m_managerSettings.AppLcid,"/"),t.trustAgaves=this.m_managerSettings.AppForOfficeTrustUXIsEnabledForPowerPoint,t.enablePrivateCatalog=this.m_managerSettings.AppsForOfficePrivateCatalogEnabled,t.enableUploadFileDevCatalog=!this.m_managerSettings.UploadFileDevCatalogIsDisabled,t.appSettings={},t.hostFeatureGateFlag=0,t.isHostFrameTrustCheckEnabledForAddIns=!0,t.hostAllowedSdxEmbedding=!0,t.sdxCdnUrl=this.m_managerSettings.SdxCdnUrl,t.sdx1CdnUrl=this.m_managerSettings.Sdx1CdnUrl,t.forceUseSdx1Cdn=this.m_managerSettings.ForceUseSdx1Cdn,t.sdxDmsUrl=this.m_managerSettings.SdxDmsUrl,t.sovereignFederationDMSToken=this.m_managerSettings.SovereignFederationDMSToken,t.sovereignFederationDMSTokenSuffix=this.m_managerSettings.SovereignFederationDMSTokenSuffix,t.defaultManifestTokens=this.m_managerSettings.DefaultManifestTokens,this.m_frameTrustState===s.HostFrameTrustState.NotInitialized&&window.self===window.top&&(this.m_frameTrustState=s.HostFrameTrustState.Trusted),t.isHostFrameTrusted=this.m_frameTrustState}t.appName=OSF.AppName.PowerpointWebApp,t.clientMode=OSF.ClientMode.ReadOnly,t.formFactor=OSF.FormFactor.Default,t.notifyHost=this.notifyHostCallback.bind(this),t.hostControl=new u.AppForOfficeApiAdapter(this.m_methodFactory,this.m_eventStore),t.externalLogger=this.m_managerSettings.ExtLogger,t.appSettings&&(t.appSettings.PowerPointModernSlideShowEnabled=!0,t.appSettings.PowerPointModernSlideShowUiHost=this.m_managerSettings.UiHost||n.UIHostType.Unknown,t.appSettings.PowerPointModernSlideShowCurrentRole=this.m_managerSettings.SlideShowRole||n.SlideShowRole.Presenter,t.appSettings.PowerPointModernSlideShowTeamsCallId=this.m_managerSettings.TeamsCallId||"");var a=new OSF.ContextActivationManager(t);a.setWSA(this.m_managerSettings.TheWsaClient),e.m_appForOfficeContextActivivationManager=a,this.m_frameTrustState!==s.HostFrameTrustState.NotInitialized&&this.m_frameTrustState!==s.HostFrameTrustState.NotReady||this.events.emit("frameTrustCheck")}return e.m_appForOfficeContextActivivationManager},e.prototype.updateAppForOfficeLayout=function(e,t){if(this.fInitialized()&&e&&t){var r=this.getAppForOfficeViewByAppForOffice(t);if(r){r.hideAppsForOffice(),r.ParentElement=e;var i=r.findActivatedAppForOfficeViewElement(t);i&&r.ParentElement.appendChild(i.Element),r.updateLayout(),r.showAppsForOffice()}}},e.prototype.updateLayout=function(e){if(this.fInitialized()&&(null==e||this.m_currentSlideId===e)){var t=this.getAppForOfficeViewBySlide(this.m_currentSlideId);null!=t&&t.updateLayout()}},e.prototype.hasAppForOfficeBeenPrepared=function(e,t){return e===this.m_currentSlideId||!(null==this.m_slideIdToAppForOfficeViewMap||!this.m_slideIdToAppForOfficeViewMap.has(e))&&this.m_slideIdToAppForOfficeViewMap.get(e).hasAppForOfficeBeenPrepared(t)},e.prototype.prepareAppForOffice=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(i){return n=this.m_slideIdToAppForOfficeViewMap?this.m_slideIdToAppForOfficeViewMap.get(e):null,this.setInstanceIdToSlideIdMap(t.InstanceId,e),null==n&&(n=new o.AppForOfficeView(this,this.m_panelParentElement,e,this.m_managerSettings.IsRtl),this.m_slideIdToAppForOfficeViewMap.set(e,n)),n.preactivateAppsForOffice(t,this.contextActivationManager(),r),a.ULS.sendTraceTag(508688334,a.LogCategory.msoulscat_Wac_PptSlideshow,a.TraceLevel.Info,"Apps For Office on the slide ".concat(e," are showing.")),[2]}))}))},e.prototype.raiseEventToAppForOffice=function(e,t,r){if(void 0===r&&(r=!0),this.m_eventStore){var i=this.m_eventStore.getApiEvent(e);i&&i.raiseEvent(r,t)}},e.prototype.disposeAppForOfficeView=function(t){var r=this;t.getContainedAppsForOffice().forEach((function(t){r.m_eventStore&&r.m_eventStore.clearHandlersForApp(t.InstanceId),e.m_appForOfficeContextActivivationManager.purgeOsfControl(t.InstanceId,!1)})),t.dispose(),t&&e.m_appForOfficeContextActivivationManager},e.prototype.setInstanceIdToSlideIdMap=function(e,t){null!=e&&null!=t&&this.m_instanceIdToSlideIdMapping.set(e,t)},e.prototype.setInstanceIdToSlideIdMapForSlide=function(e,t){for(var r=0,i=t;r<i.length;r++){var n=i[r];this.setInstanceIdToSlideIdMap(n.InstanceId,e)}},e.prototype.getSlideIdByInstanceId=function(e){return null==e?null:this.m_instanceIdToSlideIdMapping.get(e)},e.prototype.getAccessTokenAsync=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),null==this.m_appsForOfficeAuthProvider){if(null==this.m_managerSettings.AppsForOfficeAuthFactory)return[2];this.m_appsForOfficeAuthProvider=this.m_managerSettings.AppsForOfficeAuthFactory.createAuthProviderAsync(this.contextActivationManager())}return[4,this.m_appsForOfficeAuthProvider];case 1:return[4,r.sent().getAccessTokenAsync(e,t)];case 2:return[2,r.sent()];case 3:return r.sent(),[2];case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"ApiFacade",{get:function(){return this.m_apiHelper},set:function(e){this.m_apiHelper=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AreThirdPartyAddInsAllowed",{get:function(){return this.m_managerSettings.AreThirdPartyAddInsAllowed},enumerable:!1,configurable:!0}),e.performanceNowTrimmed=function(){return Math.round(performance.now())},e}();t.AppForOfficeManager=m;var p=function(){function e(){}return e.ensureAppForOfficeManager=function(e,t){return this.s_appForOfficeManager||(this.s_appForOfficeManager=new m,this.s_appForOfficeManager.ApiFacade=t),this.s_appForOfficeManager&&!this.s_appForOfficeManager.fInitialized()&&this.s_appForOfficeManager.initialize(null,e),this.s_appForOfficeManager},e.getAppForOfficeManager=function(){return this.s_appForOfficeManager},e}();t.AppForOfficeManagerFactory=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppForOfficeViewElement=t.AppForOfficeView=t.AppForOfficeViewHelper=void 0;var i=r(3),n=function(){function e(){}return e.s_AppForOfficeContainerClassName="AppForOfficeContainer",e.s_AppForOfficeContainerHiddenClassName="AppForOfficeContainer AppForOfficeHidden",e}();t.AppForOfficeViewHelper=n;var a=function(){function e(e,t,r,i){this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[],this.m_isRightToLeft=!1,this.m_appForOfficeManager=e,this.m_parentElement=t,this.m_viewId=r,this.m_isRightToLeft=i,this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[]}return e.prototype.dispose=function(){this.removeAppsForOffice()},e.prototype.removeAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements){for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].dispose();this.m_activatedAppForOfficeViewElements=[]}if(void 0!==this.m_preactivatedAppForOfficeViewElements){for(var r=0,i=this.m_preactivatedAppForOfficeViewElements;r<i.length;r++)i[r].dispose();this.m_preactivatedAppForOfficeViewElements=[]}},e.prototype.getContainedAppsForOffice=function(){var e=[];if(void 0!==this.m_activatedAppForOfficeViewElements)for(var t=0,r=this.m_activatedAppForOfficeViewElements;t<r.length;t++){var i=r[t];e.push(i.AppForOffice)}if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(var n=0,a=this.m_preactivatedAppForOfficeViewElements;n<a.length;n++)i=a[n],e.push(i.AppForOffice);return e},e.prototype.findPreactivatedAppForOfficeViewElement=function(e){if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(var t=0,r=this.m_preactivatedAppForOfficeViewElements;t<r.length;t++){var i=r[t];if(e.InstanceId===i.AppForOffice.InstanceId)return i}},e.prototype.findActivatedAppForOfficeViewElement=function(e){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var t=0,r=this.m_activatedAppForOfficeViewElements;t<r.length;t++){var i=r[t];if(e.InstanceId===i.AppForOffice.InstanceId)return i}},e.prototype.findActivatedViewElementSiblingByInstanceId=function(e,t){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var r=0;r<this.m_activatedAppForOfficeViewElements.length;r+=1)if(e===this.m_activatedAppForOfficeViewElements[r].AppForOffice.InstanceId){if(t&&r+1<this.m_activatedAppForOfficeViewElements.length)return this.m_activatedAppForOfficeViewElements[r+1];if(!t&&r-1>=0)return this.m_activatedAppForOfficeViewElements[r-1]}},e.prototype.activateAppsForOffice=function(e,t,r){if(void 0!==e&&0!==e.length&&void 0!==t){void 0===this.m_activatedAppForOfficeViewElements&&(this.m_activatedAppForOfficeViewElements=[]);for(var i=0,n=e;i<n.length;i++){var a=n[i],s=this.findActivatedAppForOfficeViewElement(a);void 0===s?(void 0!==(s=this.findPreactivatedAppForOfficeViewElement(a))&&(s.AppForOffice=a),void 0===(s=this.findPreactivatedAppForOfficeViewElement(a))?(s=new o(a,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft)).activateAppForOffice(t,r):(s.showAppForOffice(),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(s.AppForOffice.InstanceId,!0),this.m_appForOfficeManager.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),s.AppForOffice.InstanceId)),this.m_activatedAppForOfficeViewElements.push(s)):s.AppForOffice=a}}},e.prototype.preactivateAppsForOffice=function(e,t,r){if(void 0===this.m_preactivatedAppForOfficeViewElements&&(this.m_preactivatedAppForOfficeViewElements=[]),void 0===this.findPreactivatedAppForOfficeViewElement(e)&&void 0===this.findActivatedAppForOfficeViewElement(e)){var i=new o(e,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft);i.preactivateAppForOffice(e,t,r),this.m_preactivatedAppForOfficeViewElements.push(i)}else void 0!==r&&r()},e.prototype.hasAppForOfficeBeenPrepared=function(e){return void 0!==this.findPreactivatedAppForOfficeViewElement(e)},e.prototype.showAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].showAppForOffice()},e.prototype.hideAppsForOffice=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].hideAppForOffice()},e.prototype.insertAppForOffice=function(e){throw new Error("not implement yet")},e.prototype.updateLayout=function(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(var e=0,t=this.m_activatedAppForOfficeViewElements;e<t.length;e++)t[e].updatePositionAndSize()},Object.defineProperty(e.prototype,"Id",{get:function(){return this.m_viewId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ParentElement",{get:function(){return this.m_parentElement},set:function(e){this.m_parentElement=e},enumerable:!1,configurable:!0}),e}();t.AppForOfficeView=a;var o=function(){function e(e,t,r,i){if(void 0===r)throw new Error("manager");this.m_appForOffice=e,this.m_appForOfficeManager=r,this.m_isRightToLeft=i,this.m_appForOfficeHtmlElement=document.createElement("div"),this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden",this.m_appForOfficeHtmlElement.id="AppForOffice_".concat(e.InstanceId),this.m_appForOfficeHtmlElement.style.position="absolute",this.m_appForOfficeHtmlElement.style.pointerEvents="auto",t.appendChild(this.m_appForOfficeHtmlElement)}return e.prototype.dispose=function(){this.removeAppForOfficeHtml()},e.prototype.removeAppForOfficeHtml=function(){void 0!==this.m_appForOfficeHtmlElement&&null!=this.m_appForOfficeHtmlElement.parentNode&&this.m_appForOfficeHtmlElement.parentNode.removeChild(this.m_appForOfficeHtmlElement)},e.prototype.clearElementHtml=function(e){e.textContent=""},e.prototype.activateAppForOffice=function(e,t){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0!==this.m_appForOffice&&void 0!==e){t?(this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"):(this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden");var r=new Object;r.div=this.m_appForOfficeHtmlElement,r.id=this.m_appForOffice.InstanceId,r.solutionId=this.m_appForOffice.AppForOfficeRef.Id,r.version=this.m_appForOffice.AppForOfficeRef.Version,r.storeId=this.m_appForOffice.AppForOfficeRef.Store,r.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,r.settings=this.m_appForOffice.Settings,r.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,r.osfControlType=OSF.OsfControlTarget.InContent,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(r.storeType)||(i.ULS.sendTraceTag(508688333,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Info,"Content web add-in disabled by doc IRM"),r.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),e.insertOsfControl(r),"function"==typeof e.setActivationCompletedStatus&&e.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}},e.prototype.preactivateAppForOffice=function(e,t,r){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0!==this.m_appForOffice&&void 0!==t&&null!=e){this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden";var a=new Object;a.div=this.m_appForOfficeHtmlElement,a.id=this.m_appForOffice.InstanceId,a.solutionId=this.m_appForOffice.AppForOfficeRef.Id,a.version=this.m_appForOffice.AppForOfficeRef.Version,a.storeId=this.m_appForOffice.AppForOfficeRef.Store,a.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,a.settings=this.m_appForOffice.Settings,a.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,a.osfControlType=OSF.OsfControlTarget.InContent,a.snapshotUrl="",a.preactivationCallback=r,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(a.storeType)||(i.ULS.sendTraceTag(508688332,i.LogCategory.msoulscat_Wac_PptSlideshow,i.TraceLevel.Info,"Content web add-in blocked for preactivate by doc IRM"),a.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),t.insertOsfControl(a),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}},e.prototype.updatePositionAndSize=function(){var e=this.m_appForOffice.Shape.Left,t=this.m_appForOffice.Shape.Top,r=this.m_appForOffice.Shape.Width,i=this.m_appForOffice.Shape.Height;this.m_appForOfficeHtmlElement.style.left="".concat(e-(this.m_isRightToLeft?r:0),"px"),this.m_appForOfficeHtmlElement.style.top="".concat(t,"px"),this.m_appForOfficeHtmlElement.style.width="".concat(r,"px"),this.m_appForOfficeHtmlElement.style.height="".concat(i,"px")},e.prototype.showAppForOffice=function(){this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"},e.prototype.hideAppForOffice=function(){this.m_appForOfficeHtmlElement.className=n.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden"},Object.defineProperty(e.prototype,"AppForOffice",{get:function(){return this.m_appForOffice},set:function(e){this.m_appForOffice=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Element",{get:function(){return this.m_appForOfficeHtmlElement},enumerable:!1,configurable:!0}),e}();t.AppForOfficeViewElement=o},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.HostFrameTrustState=void 0,t.HostFrameTrustState=i,function(e){e[e.NotInitialized=0]="NotInitialized",e[e.NotImplemented=1]="NotImplemented",e[e.NotReady=2]="NotReady",e[e.Exempted=3]="Exempted",e[e.NotTrusted=4]="NotTrusted",e[e.Trusted=5]="Trusted"}(i||(t.HostFrameTrustState=i={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReaderMethodFactory=t.ApiMethodFactory=void 0;var i=r(24),n=r(410),a=function(){function e(e){this.m_methodList=null,this.m_appForOfficeManager=e}return e.prototype.getApiMethod=function(e){if(null==this.m_methodList&&this.populateMethodList(),null==e||null==this.m_methodList[e])return null;var t=this.m_methodList[e]();return null!=t&&(t.AppForOfficeManager=this.m_appForOfficeManager),t},e.prototype.set=function(e,t){this.m_methodList[e]=t},e}();t.ApiMethodFactory=a;var o=function(e){function t(t){return e.call(this,t)||this}return(0,i.__extends)(t,e),t.prototype.populateMethodList=function(){this.m_methodList={},this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,(function(){return new n.LoadSettingsMethod})),this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,(function(){return new n.SaveSettingsMethod})),this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,(function(){return new n.GetActiveViewMethod})),this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,(function(){return new n.NavigateToMethod})),this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,(function(){return new n.GetSelectedDataMethod})),this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,(function(){return new n.GetFilePropertiesMethod})),this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,(function(){return new n.GetDocumentThemeMethod})),this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,(function(){return new n.GetOfficeThemeMethod})),this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,(function(){return new n.GetAccessTokenMethod})),this.set(OSF.DDA.MethodDispId.dispidSetLiveShareStateMethod,(function(){return new n.SetLiveShareStateMethod})),this.set(OSF.DDA.MethodDispId.dispidGetLiveShareStateMethod,(function(){return new n.GetLiveShareStateMethod}))},t}(a);t.ReaderMethodFactory=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetLiveShareStateMethod=t.SetLiveShareStateMethod=t.GetAccessTokenMethod=t.GetOfficeThemeMethod=t.GetDocumentThemeMethod=t.GetFilePropertiesMethod=t.GetSelectedDataMethod=t.NavigateToMethod=t.GetActiveViewMethod=t.SaveSettingsMethod=t.LoadSettingsMethod=t.ApiMethod=void 0;var i=r(24),n=r(3),a=r(120),o=r(94),s=r(183),l=function(){function e(e,t,r){this._errorCode=0,this._result={},this._apiFacade=null,this._parameters=e,this._callback=t,this._additionalParameters=r}return Object.defineProperty(e.prototype,"Parameters",{get:function(){return this._parameters},set:function(e){this._parameters=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AdditionalParameters",{get:function(){return this._additionalParameters},set:function(e){this._additionalParameters=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Callback",{get:function(){return this._callback},set:function(e){this._callback=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AppId",{get:function(){return this._appId},set:function(e){this._appId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AppForOfficeManager",{get:function(){return this._appForOfficeManager},set:function(e){this._appForOfficeManager=e,null!=this._appForOfficeManager?this._apiFacade=this._appForOfficeManager.ApiFacade:this._apiFacade=null},enumerable:!1,configurable:!0}),e.prototype.go=function(){var e=this;this._result,this.executeAsync().then((function(){e.sendResponse()}))},e.prototype.sendResponse=function(){this._result[a.ApiResponseKeyStrings.c_Error]=this._errorCode,this.Callback(this._result)},e.prototype.getAppById=function(){return this.AppId&&this._appForOfficeManager?this._appForOfficeManager.getAppByInstanceId(this.AppId):null},e}();t.ApiMethod=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return(0,i.__generator)(this,(function(i){return null!=(e=this.getAppById())?((t={}).Settings=this.formatSetting(e.Settings),this._result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(r="AppForOffice instance could not be found for ID ".concat(this.AppId),n.ULS.sendTraceTag(508688344,n.LogCategory.msoulscat_Wac_PptSlideshow,n.TraceLevel.Error,r),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Loads/Refreshes Settings object for an app"},enumerable:!1,configurable:!0}),t.prototype.formatSetting=function(e){var t={},r=0;for(var i in e){var n=i,a=e[i];t[r.toString()]={key:n,value:a},r+=1}return t},t}(l);t.LoadSettingsMethod=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"(Not implemented) Saves settings to document."},enumerable:!1,configurable:!0}),t}(l);t.SaveSettingsMethod=u;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){if(e=null,null!=this._apiFacade)switch(this._apiFacade.getEditMode()){case s.EditMode.ContinueEditing:e=Microsoft.Office.WebExtension.ActiveView.Edit;break;default:e=Microsoft.Office.WebExtension.ActiveView.Read}return null!=e?(this._result[Microsoft.Office.WebExtension.Parameters.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the ActiveView value for current mode."},enumerable:!1,configurable:!0}),t}(l);t.GetActiveViewMethod=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade)return[2];i.label=1;case 1:return i.trys.push([1,7,,8]),e=this.Parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],t=e[OSF.DDA.Marshaling.NavigationKeys.GoToType],r=e[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),t!==OSF.DDA.Marshaling.GoToType.Index?[3,3]:(n=this,[4,this._apiFacade.goToByIndex(r)]);case 2:return n._errorCode=i.sent(),[3,6];case 3:return t!==OSF.DDA.Marshaling.GoToType.Slide?[3,5]:(a=this,[4,this._apiFacade.goToBySlide(r)]);case 4:return a._errorCode=i.sent(),[3,6];case 5:this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration,i.label=6;case 6:return[3,8];case 7:return i.sent(),[2];case 8:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Go to the slide specified by user."},enumerable:!1,configurable:!0}),t}(l);t.NavigateToMethod=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade)return[2];i.label=1;case 1:return i.trys.push([1,6,,7]),this.Parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString()!==Microsoft.Office.WebExtension.CoercionType.SlideRange?[3,4]:(e=void 0,(t=this._apiFacade)?(n=(r=o.Helper).isNullOrUndefined,[4,this._apiFacade.getSelectedSlides()]):[3,3]);case 2:t=!n.apply(r,[e=i.sent()]),i.label=3;case 3:return t&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[3,5];case 4:this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported,i.label=5;case 5:return[3,7];case 6:return i.sent(),[2];case 7:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Get selected data from slide."},enumerable:!1,configurable:!0}),t}(l);t.GetSelectedDataMethod=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(r){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e=void 0,null==this._apiFacade||o.Helper.isNullOrUndefined(e=this._apiFacade.getDocumentUrl())||((t={})["".concat(OSF.DDA.Marshaling.FilePropertiesKeys.Url)]=e,this._result["".concat(OSF.DDA.Marshaling.FilePropertiesKeys.Properties)]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the file properties. Now it only returns the URL."},enumerable:!1,configurable:!0}),t}(l);t.GetFilePropertiesMethod=m;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,r,a;return(0,i.__generator)(this,(function(i){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._appForOfficeManager||null==this._apiFacade||null==(e=this._appForOfficeManager.getSlideIdByInstanceId(this.AppId))?[2]:null==(r=this._appForOfficeManager.getAppForOfficeThemeBySlide(e))||r.fIsEmpty?(n.ULS.sendTraceTag(508688343,n.LogCategory.msoulscat_Wac_PptSlideshow,n.TraceLevel.Error,"Error while fetching theming for Slide: slide theme returned as null."),[2]):(a=t.updateObjectWithDocumentThemeMapping({},r),this._result["".concat(OSF.DDA.Marshaling.ThemingKeys.DocumentTheme)]=a,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,[2])}))}))},t.updateObjectWithDocumentThemeMapping=function(e,r){if(null==e||null==r||r.fIsEmpty)return e;var i=e,n=r.colorScheme;null!=n&&(i[OSF.DDA.Marshaling.ThemingKeys.Accent1]=t.extractColorValue(n.Accent1),i[OSF.DDA.Marshaling.ThemingKeys.Accent2]=t.extractColorValue(n.Accent2),i[OSF.DDA.Marshaling.ThemingKeys.Accent3]=t.extractColorValue(n.Accent3),i[OSF.DDA.Marshaling.ThemingKeys.Accent4]=t.extractColorValue(n.Accent4),i[OSF.DDA.Marshaling.ThemingKeys.Accent5]=t.extractColorValue(n.Accent5),i[OSF.DDA.Marshaling.ThemingKeys.Accent6]=t.extractColorValue(n.Accent6),i[OSF.DDA.Marshaling.ThemingKeys.Background1]=t.extractColorValue(n.Background1),i[OSF.DDA.Marshaling.ThemingKeys.Background2]=t.extractColorValue(n.Background2),i[OSF.DDA.Marshaling.ThemingKeys.Text1]=t.extractColorValue(n.Text1),i[OSF.DDA.Marshaling.ThemingKeys.Text2]=t.extractColorValue(n.Text2),i[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=t.extractColorValue(n.Hyperlink),i[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=t.extractColorValue(n.FollowedHyperlink));var a=r.fontScheme;return null!=a&&(i[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=a.HeaderEastAsian,i[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=a.HeaderLatin,i[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=a.HeaderLocalized,i[OSF.DDA.Marshaling.ThemingKeys.HdScript]=a.HeaderScript,i[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=a.BodyEastAsian,i[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=a.BodyLatin,i[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=a.BodyLocalized,i[OSF.DDA.Marshaling.ThemingKeys.BdScript]=a.BodyScript),i[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=t.extractColorValue(r.backgroundColor),i},t.extractColorValue=function(e){if(e&&!(e.intColor<0))return e.intColor},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."},enumerable:!1,configurable:!0}),t}(l);t.GetDocumentThemeMethod=p;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,[2]}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"(Not implemented) Returns OfficeTheme properties."},enumerable:!1,configurable:!0}),t}(l);t.GetOfficeThemeMethod=g;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this.AppForOfficeManager?[2]:[4,this.AppForOfficeManager.getAccessTokenAsync(this.AppId,this.Parameters)];case 1:return(e=t.sent())?(this._errorCode=e.errorCode,0===e.errorCode&&(this._result["".concat(OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken)]=e.accessToken),[2]):[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Returns an access token for the add-in."},enumerable:!1,configurable:!0}),t}(l);t.GetAccessTokenMethod=v;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade||void 0===this.AppId)return[2];r.label=1;case 1:return r.trys.push([1,4,,5]),(e=JSON.stringify(this.Parameters[OSF.DDA.WAC.UniqueArguments.Data]))?(t=this,[4,this._apiFacade.setAddinSyncState({instanceId:this.AppId,liveShareState:e})]):[3,3];case 2:t._errorCode=r.sent(),r.label=3;case 3:return[3,5];case 4:return r.sent(),[2];case 5:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Set addin sync state."},enumerable:!1,configurable:!0}),t}(l);t.SetLiveShareStateMethod=y;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.executeAsync=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._apiFacade||void 0===this.AppId)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._apiFacade.getAddinSyncState(this.AppId)];case 2:return(e=t.sent())&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(e),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),[3,4];case 3:return t.sent(),[2];case 4:return[2]}}))}))},Object.defineProperty(t.prototype,"Description",{get:function(){return"Get addin sync state."},enumerable:!1,configurable:!0}),t}(l);t.GetLiveShareStateMethod=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReaderEventStore=t.ApiEventStore=void 0;var i=r(24),n=r(412),a=function(){function e(e){this.m_eventList=null,this.m_appForOfficeManager=e}return e.prototype.getApiEvent=function(e){if(null==this.m_eventList&&this.populateEventList(),null==e||null==this.m_eventList||null==this.m_eventList[e])return null;var t=this.m_eventList[e];return t.AppForOfficeManager=this.m_appForOfficeManager,t},e.prototype.clearHandlersForApp=function(e){for(var t in this.m_eventList)this.m_eventList[t].removeHandler(e)},e.prototype.set=function(e,t){null!=this.m_eventList&&(this.m_eventList[e]=t)},e}();t.ApiEventStore=a;var o=function(e){function t(t){return e.call(this,t)||this}return(0,i.__extends)(t,e),t.prototype.populateEventList=function(){this.m_eventList={},this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,n.SettingsChangedEvent.Instance),this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,n.ActiveViewChangedEvent.Instance),this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,n.ActivationStatusChangedEvent.Instance),this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,n.DocumentThemeChangedEvent.Instance),this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,n.OfficeThemeChangedEvent.Instance),this.set(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent,n.LiveShareStateChangedEvent.Instance)},t}(a);t.ReaderEventStore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveShareStateChangedEvent=t.OfficeThemeChangedEvent=t.DocumentThemeChangedEvent=t.ActivationStatusChangedEvent=t.ActiveViewChangedEvent=t.SettingsChangedEvent=t.ApiEvent=void 0;var i=r(24),n=r(120),a=function(){function e(){this.m_handlers={}}return e.prototype.apiEvent=function(){this.m_handlers},Object.defineProperty(e.prototype,"AppForOfficeManager",{get:function(){return this.m_appForOfficeManager},set:function(e){this.m_appForOfficeManager=e},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){var r=this.getProcessedEventArgs(e),i=void 0;if(t&&(i=this.m_handlers[t]))i(r);else for(var n in this.m_handlers)(i=this.m_handlers[n])&&i(r)},e.prototype.addHandler=function(e,t,r,i){this.m_handlers[e]=t,r&&this.callbackWithSuccess(r)},e.prototype.removeHandler=function(e,t,r,i){delete this.m_handlers[e],r&&this.callbackWithSuccess(r)},e.prototype.callbackWithSuccess=function(e){this.callbackWithErrorCode(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},e.prototype.callbackWithErrorCode=function(e,t){if(null!=e){var r={};r[n.ApiResponseKeyStrings.c_Error]=t,e(r)}},e}();t.ApiEvent=a;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return e},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.SettingsChangedEvent=o;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return"view"},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.ActiveViewChangedEvent=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return e},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.ActivationStatusChangedEvent=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return null},t.prototype.addHandler=function(e,t,r){r&&this.callbackWithErrorCode(r,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},t.prototype.removeHandler=function(e,t,r){r&&this.callbackWithErrorCode(r,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.DocumentThemeChangedEvent=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){return null},t.prototype.addHandler=function(e,t,r){r&&this.callbackWithErrorCode(r,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},t.prototype.removeHandler=function(e,t,r){r&&this.callbackWithErrorCode(r,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.OfficeThemeChangedEvent=u;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getProcessedEventArgs=function(e){var t={};try{var r=e;r&&(t[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(r.liveShareState),t[n.ApiResponseKeyStrings.c_Error]=OSF.DDA.ErrorCodeManager.ooeSuccess)}catch(e){t[n.ApiResponseKeyStrings.c_Error]=OSF.DDA.ErrorCodeManager.ooeInternalError}return t},Object.defineProperty(t,"Instance",{get:function(){return null==this.m_instance&&(this.m_instance=new t),this.m_instance},enumerable:!1,configurable:!0}),t}(a);t.LiveShareStateChangedEvent=d},function(e,t,r){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppForOfficeLoader=void 0;var i=r(24),n=r(3),a=r(119),o=r(4),s=r(184),l=r(94),c=function(){function e(){}return e.onCompleted=function(){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!0,n.ULS.sendTraceTag(508688331,n.LogCategory.msoulscat_Wac_PptSlideshow,n.TraceLevel.Info,"AppForOfficeLoader: ".concat(this.s_osfRunTimeJSFileName," downloaded."))},e.onFailure=function(e){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!1,this.s_scriptElement&&document.body.removeChild(this.s_scriptElement),n.ULS.sendTraceTag(508688330,n.LogCategory.msoulscat_Wac_PptSlideshow,n.TraceLevel.Error,"Failed to delay load ".concat(this.s_osfRunTimeJSFileName," error:").concat(e.message))},e.createScriptElement=function(e){var t=this;return new Promise((function(r,i){t.s_scriptElement=document.createElement("script"),t.s_scriptElement.addEventListener("error",i),t.s_scriptElement.addEventListener("load",r),null!=e&&-1===e.indexOf("null")?t.s_scriptElement.src=e:t.s_scriptElement.src=o.Settings.readStringOrDefault("osfRunTimeJSFileName",t.s_osfRunTimeJSFileName),o.Settings.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&t.s_scriptElement.setAttribute("crossdomain","anonymous"),document.body.appendChild(t.s_scriptElement)}))},e.load=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(void 0!==window[this.s_OsfRunTimeFunctionName]||this.s_fIsDownloadCompleted)return this.onCompleted(),[2];if(this.s_fIsJsDownloadInitiated)return[2];this.s_fIsJsDownloadInitiated=!0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.createScriptElement(e)];case 2:return r.sent(),this.onCompleted(),[3,4];case 3:return t=r.sent(),this.onFailure(t),[3,4];case 4:return[2]}}))}))},Object.defineProperty(e,"FIsDownloadInitiated",{get:function(){return this.s_fIsJsDownloadInitiated},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FIsDownloadCompleted",{get:function(){return this.s_fIsDownloadCompleted},enumerable:!1,configurable:!0}),e.createAppForOfficeByOsfExtensibleDataObject=function(e){if(null===e)return null;var t;switch(e.appReference.storeType){case 0:t="SPCatalog";break;case 2:t="OMEX";break;case 1:t="Filesystem";break;case 3:t="SPApp";break;case 4:t="Registry";break;case 6:t="UploadFileDevCatalog";break;case 7:t="excatalog";break;default:return null}var r=new s.AppForOfficeReference(e.appReference.id,e.appReference.version,e.appReference.store,t),i=new s.AppForOfficeShape(a.OsfControlTarget.InContent,e.appInstance.appShape.id,e.appInstance.appShape.pos.y,e.appInstance.appShape.pos.x,e.appInstance.appShape.extent.w,e.appInstance.appShape.extent.h);return new s.AppForOffice(r,e.appInstance.id,i,this.readAppForOfficeSettings(e.appInstance.appSettings))},e.readAppForOfficeSettings=function(e){var t={};return void 0!==e&&e.forEach((function(e){t[e.name]=e.value})),t},e.readAppForOfficeTheme=function(t){return null===t?new l.AppForOfficeTheme:new l.AppForOfficeTheme(e.readThemeColorScheme(t.clrSchm),e.readThemeFontScheme(t.ftSchm),e.readBackgroundColor(t.bgClr))},e.readThemeColorScheme=function(e){if(void 0!==e){var t=new l.ThemeColorScheme;return t.Accent1=new l.ThemeColor(e.accent1),t.Accent2=new l.ThemeColor(e.accent2),t.Accent3=new l.ThemeColor(e.accent3),t.Accent4=new l.ThemeColor(e.accent4),t.Accent5=new l.ThemeColor(e.accent5),t.Accent6=new l.ThemeColor(e.accent6),t.Background1=new l.ThemeColor(e.dk1),t.Background2=new l.ThemeColor(e.dk2),t.Text1=new l.ThemeColor(e.lt1),t.Text2=new l.ThemeColor(e.lt2),t.Hyperlink=new l.ThemeColor(e.hlink),t.FollowedHyperlink=new l.ThemeColor(e.folHlink),t}},e.readThemeFontScheme=function(e){if(void 0!==e){var t=new l.ThemeFontScheme;return t.HeaderEastAsian=e.hdEAFt,t.HeaderLatin=e.hdLtnFt,t.HeaderScript=e.hdSptFt,t.HeaderLocalized=e.hdLclFt,t.BodyEastAsian=e.bdEAFt,t.BodyLatin=e.bdLtnFt,t.BodyScript=e.bdSptFt,t.BodyLocalized=e.bdLclFt,t}},e.readBackgroundColor=function(e){if(void 0!==e)return new l.ThemeColor(e.Item)},e.s_fIsJsDownloadInitiated=!1,e.s_fIsDownloadCompleted=!1,e.s_osfRunTimeJSFileName="osfruntimePPTWAC.js",e.s_OsfRunTimeFunctionName="OfficeExt",e}();t.AppForOfficeLoader=c},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowAppForOfficeApiImpl=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(97),c=function(){return(0,s.default)((function e(t){(0,o.default)(this,e),this.m_slideshowCore=t}),[{key:"injectInterface",value:function(e){}},{key:"getEditMode",value:function(){return l.EditMode.None}},{key:"getThemeBySlideId",value:function(e){return new l.AppForOfficeTheme}},{key:"getDocumentUrl",value:function(){return""}},{key:"goToByIndex",value:(c=(0,a.default)(n.default.mark((function e(t){var r,i,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.m_slideshowCore&&0!==t.length){e.next=2;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeInternalError);case 2:r=this.m_slideshowCore.getSlideLocation(),i=void 0,e.t0=t,e.next="previous"===e.t0?7:"next"===e.t0?13:"first"===e.t0?19:"last"===e.t0?22:25;break;case 7:return e.next=9,this.m_slideshowCore.prevSlide(!1);case 9:if(i=this.m_slideshowCore.getSlideLocation(),!r||!i||r.slideIndex!==i.slideIndex){e.next=12;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeNavOutOfBound);case 12:return e.abrupt("break",33);case 13:return e.next=15,this.m_slideshowCore.nextSlide(!1);case 15:if(i=this.m_slideshowCore.getSlideLocation(),!r||!i||r.slideIndex!==i.slideIndex){e.next=18;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeNavOutOfBound);case 18:return e.abrupt("break",33);case 19:return e.next=21,this.m_slideshowCore.gotoFirstSlide(!0);case 21:return e.abrupt("break",33);case 22:return e.next=24,this.m_slideshowCore.gotoLastSlide(!0);case 24:return e.abrupt("break",33);case 25:if(a=Number.parseInt(t,10)-1,!Number.isNaN(a)){e.next=28;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeInternalError);case 28:if(!(a<0||a>=this.m_slideshowCore.getSlideCount())){e.next=30;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeNavOutOfBound);case 30:return e.next=32,this.m_slideshowCore.gotoSlide({slideIndex:a});case 32:return e.abrupt("break",33);case 33:return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeSuccess);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"goToBySlide",value:(i=(0,a.default)(n.default.mark((function e(t){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Number.parseInt(t,10),null!=this.m_slideshowCore&&!Number.isNaN(r)){e.next=3;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeInternalError);case 3:if(!(r<0)){e.next=5;break}return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeNavOutOfBound);case 5:return e.next=7,this.m_slideshowCore.gotoSlide({slideId:{sid:r,cid:0}});case 7:return e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeSuccess);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSelectedSlides",value:(r=(0,a.default)(n.default.mark((function e(){var t,r,i,a,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,this.m_slideshowCore&&(t=this.m_slideshowCore.getSlideLocation())){e.next=3;break}return e.abrupt("return","");case 3:return r=t.slideIndex,i=t.slideId.sid,r+=1,e.next=8,this.m_slideshowCore.getSlideTitle();case 8:return a=e.sent,o=[[i.toString(),a,r.toString()]],e.abrupt("return",JSON.stringify(o));case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setAddinSyncState",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.m_slideshowCore.events.emit("slideAddinSyncStateEvent",t),e.abrupt("return",l.ErrorCodeManager.errorCodes.ooeSuccess);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getAddinSyncState",value:(e=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})},{key:"requiredInterfaces",get:function(){return[]}}]);var e,t,r,i,c}();t.SlideShowAppForOfficeApiImpl=c},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkHealthManager=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(67),u=r(4),d=r(26),h=function(){return(0,s.default)((function e(t){var r=this;(0,o.default)(this,e),this.events=new d.EventEmitter,this.m_shouldPing=!1,this.m_pingLoopActive=!1,this.m_isPingHealthy=!0,this.m_isHealthy=!0,this.m_pingUrl=t,window.addEventListener("online",(function(){r.updateNetworkHealth()})),window.addEventListener("offline",(function(){r.updateNetworkHealth()}))}),[{key:"isHealthy",get:function(){return this.m_isHealthy}},{key:"startPinging",value:function(){this.m_shouldPing&&this.m_pingLoopActive||(this.m_shouldPing=!0,this.runPingLoopAsync())}},{key:"stopPinging",value:function(){this.m_shouldPing=!1}},{key:"runPingLoopAsync",value:(e=(0,a.default)(n.default.mark((function e(){var t,r=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.m_pingLoopActive=!0,t=n.default.mark((function e(){var t,i,a,o,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,i=!1,a=setTimeout((function(){r.m_isPingHealthy=!1,i=!0}),u.Settings.readNumberOrDefault("pingTimeoutMs",1e4)),e.prev=3,e.next=6,fetch(r.m_pingUrl,{cache:"no-cache"});case 6:o=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t=!0;case 12:return clearTimeout(a),r.m_isPingHealthy=!!o&&200===o.status&&!i&&!t,r.updateNetworkHealth(),s=r.m_isPingHealthy?u.Settings.readNumberOrDefault("pingIntervalMs",2e3):i?0:u.Settings.readNumberOrDefault("pingIntervalAfterFailureMs",200),e.next=18,(0,c.waitMsAsync)(s);case 18:case"end":return e.stop()}}),e,null,[[3,9]])}));case 2:if(!this.m_shouldPing){e.next=6;break}return e.delegateYield(t(),"t0",4);case 4:e.next=2;break;case 6:this.m_pingLoopActive=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"updateNetworkHealth",value:function(){var e=navigator.onLine&&this.m_isPingHealthy;e!==this.m_isHealthy&&(this.m_isHealthy=e,this.events.emit("isHealthyChanged",e),l.ULS.sendTraceTag(526399696,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,JSON.stringify({isHealthy:e,onLine:navigator.onLine,isPingHealthy:this.m_isPingHealthy})))}}]);var e}();t.NetworkHealthManager=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.OpticalZoomAnimationController=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(52),u=r(4),d=function(){return(0,s.default)((function e(t){(0,o.default)(this,e),this.m_isZooming=!1,this.m_zoomAnimClock=null,this.m_slideShowCore=t,this.resolvePromise=void 0,this.m_zoomSource=null;var r={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}};this.m_startOpticalZoomState=r,this.m_targetOpticalZoomState=r}),[{key:"zoomSource",get:function(){return this.m_zoomSource}},{key:"isZooming",get:function(){return this.m_isZooming}},{key:"animateZoomAsync",value:(t=(0,a.default)(n.default.mark((function e(t,r,i,a,o){var s=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){s.m_zoomAnimClock=new c.AnimClock;var n=s.m_slideShowCore.opticalZoomStateInfo.currentState.zoomLevel;s.m_isZooming=!0,s.resolvePromise=e,s.m_zoomSource=o||null,s.m_zoomAnimClock.events.on("tick",(function(c){var d=s.m_slideShowCore.getSlideLocation();if(!i)return l.ULS.sendTraceTag(521491746,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),void e();if(!d)return l.ULS.sendTraceTag(521491747,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),void e();try{var h=i.getBounds.getClientSizeFromCanvas(),f=Math.min(1,c/r),m=n+(t-n)*(.5-.5*Math.cos(2*Math.PI*(1-1/(f+1)))),p=a||h.scale(.5),g=i.calculateCanvasCenterSlidePointPercentAfterZoom(p,m,d.slideId,s.m_slideShowCore.opticalZoomStateInfo.currentState);if(!g)return void e();if(isNaN(g.x)||isNaN(g.y))return s.finishZoomAnimation(),void l.ULS.sendTraceTag(520978770,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN");var v={zoomLevel:m,canvasCenterSlidePointPercent:g};if(s.m_slideShowCore.setOpticalZoomState({currentState:v,metadata:o?{source:o}:void 0}),u.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)){var y=i.getBounds.getBoundingClientRectFromCanvas(),_={width:y.width*m,height:y.height*m,zoomPositionX:p.x,zoomPositionY:p.y,containerSizeChanged:!1};s.m_slideShowCore.events.emit("updateCanvasZoom",_)}f>=1&&(s.stopZoomAnimation(),e())}catch(t){l.ULS.sendTraceTag(521414423,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"OpticalZoomAnimationController::animateZoomAsync - ".concat(t)),s.stopZoomAnimation(),e()}})),s.m_zoomAnimClock.start()})));case 1:case"end":return e.stop()}}),e)}))),function(e,r,i,n,a){return t.apply(this,arguments)})},{key:"animateZoomWithAnimationProgressEventsAsync",value:(e=(0,a.default)(n.default.mark((function e(t,r,i,a){var o=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){o.m_zoomAnimClock=new c.AnimClock,o.m_isZooming=!0,o.resolvePromise=e,o.m_zoomSource=a&&a.source?a.source:null,o.m_startOpticalZoomState=o.m_slideShowCore.opticalZoomStateInfo.currentState;var n=i.getBounds.getClientSizeFromCanvas(),s=a&&a.canvasZoomPositionInPixels?a.canvasZoomPositionInPixels:n.scale(.5),l=o.calculateOpticalZoomStateAtTime(1,i,s);if(o.m_targetOpticalZoomState={zoomLevel:t,canvasCenterSlidePointPercent:{x:.5,y:.5}},l&&(o.m_targetOpticalZoomState=l),o.m_slideShowCore.setOpticalZoomState({currentState:o.m_slideShowCore.opticalZoomStateInfo.currentState,animationData:{startOpticalZoomState:o.m_startOpticalZoomState,targetOpticalZoomState:o.m_targetOpticalZoomState},metadata:a&&a.source?{source:a.source}:void 0}),l){if(window.matchMedia("(prefers-reduced-motion: no-preference)").matches)o.m_zoomAnimClock.events.on("tick",(function(e){o.calculateNextZoomFrame(e,r,i,a&&a.canvasZoomPositionInPixels)})),o.m_zoomAnimClock.start();else if(o.finishZoomAnimation(),u.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!u.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){var d=i.getBounds.getBoundingClientRectFromCanvas(),h={width:d.width*l.zoomLevel,height:d.height*l.zoomLevel,zoomPositionX:s.x,zoomPositionY:s.y,containerSizeChanged:!1};o.m_slideShowCore.events.emit("updateCanvasZoom",h)}}else o.finishZoomAnimation()})));case 1:case"end":return e.stop()}}),e)}))),function(t,r,i,n){return e.apply(this,arguments)})},{key:"calculateNextZoomFrame",value:function(e,t,r,i){try{var n=Math.min(1,e/t),a=r.getBounds.getClientSizeFromCanvas(),o=i||a.scale(.5),s=this.calculateOpticalZoomStateAtTime(n,r,o);if(!s)return void this.finishZoomAnimation();if(this.m_slideShowCore.setOpticalZoomState({currentState:s,animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}),u.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!u.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){var c=r.getBounds.getBoundingClientRectFromCanvas(),d={width:c.width*s.zoomLevel,height:c.height*s.zoomLevel,zoomPositionX:o.x,zoomPositionY:o.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",d)}n>=1&&this.stopZoomAnimation()}catch(e){l.ULS.sendTraceTag(509093531,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"OpticalZoomAnimationController::animateZoomAsync - ".concat(e)),this.stopZoomAnimation()}}},{key:"calculateOpticalZoomStateAtTime",value:function(e,t,r){var i=this.m_slideShowCore.getSlideLocation();if(!t)return l.ULS.sendTraceTag(509093534,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),null;if(!i)return l.ULS.sendTraceTag(509093533,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),null;var n=this.m_startOpticalZoomState.zoomLevel,a=n+(this.m_targetOpticalZoomState.zoomLevel-n)*(.5-.5*Math.cos(2*Math.PI*(1-1/(e+1)))),o=t.calculateCanvasCenterSlidePointPercentAfterZoom(r,a,i.slideId,this.m_slideShowCore.opticalZoomStateInfo.currentState);return o?isNaN(o.x)||isNaN(o.y)?(l.ULS.sendTraceTag(509093532,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN"),null):{zoomLevel:a,canvasCenterSlidePointPercent:o}:null}},{key:"stopZoomAnimation",value:function(){return this.m_isZooming=!1,!!this.m_zoomAnimClock&&(this.m_zoomAnimClock.stop(),this.resolvePromise&&this.resolvePromise(),this.resolvePromise=void 0,this.m_zoomAnimClock=null,!0)}},{key:"finishZoomAnimation",value:function(){return!!this.stopZoomAnimation()&&(u.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)?this.m_slideShowCore.setOpticalZoomState({currentState:{zoomLevel:this.m_targetOpticalZoomState.zoomLevel,canvasCenterSlidePointPercent:this.m_targetOpticalZoomState.canvasCenterSlidePointPercent},animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}):this.m_slideShowCore.zoomToAsync(1),!0)}}]);var e,t}();t.OpticalZoomAnimationController=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ActionToRenderLogger=void 0;var n=i(r(1)),a=i(r(2)),o=r(3),s=r(4),l=r(185);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"recordInput",value:function(t){e.s_queuedRenderEvents.push({source:t,startTime:performance.now()})}},{key:"recordRender",value:function(){if(0!==e.s_queuedRenderEvents.length){var t,r=performance.now(),i=s.Settings.readNumberOrDefault("actionToRenderTimeoutUntilLogMs",1e3),n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(e.s_queuedRenderEvents);try{var a=function(){var n=t.value,a=Math.round(r-n.startTime),o=e.s_sourceToAvgTimePerRenderMap.get(n.source);o?(o.timeToLog.setTime(i),o.inputToRenderTimesMs.push(a)):e.s_sourceToAvgTimePerRenderMap.set(n.source,{inputToRenderTimesMs:[a],timeToLog:new l.TimeoutClock((function(){e.logInputToRenderTime(n.source)}),i)})};for(n.s();!(t=n.n()).done;)a()}catch(e){n.e(e)}finally{n.f()}e.s_queuedRenderEvents=[]}}},{key:"logInputToRenderTime",value:function(t){var r=e.s_sourceToAvgTimePerRenderMap.get(t);r&&(o.ULS.sendTraceTag(509441479,o.LogCategory.msoulscat_Wac_PptSlideshow,o.TraceLevel.Info,JSON.stringify({source:t,actionToRenderTimes:r.inputToRenderTimesMs})),e.s_sourceToAvgTimePerRenderMap.delete(t))}}])}();t.ActionToRenderLogger=u,u.s_queuedRenderEvents=[],u.s_sourceToAvgTimePerRenderMap=new Map},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrefetchAddon=void 0;var n,a=i(r(6)),o=i(r(7)),s=i(r(1)),l=i(r(2)),c=r(4),u=r(3),d=r(11);!function(e){e.Init="init",e.WebGLContextRestored="webglcontextrestored",e.PrefetchOnRefreshPodSession="prefetchOnRefreshPodSession",e.OnSlideLocationChanged="onSlideLocationChanged"}(n||(n={}));var h=function(){return(0,l.default)((function e(t,r,i){var a=this;if((0,s.default)(this,e),this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_forwardPrefetchCount=5,this.m_backwardPrefetchCount=5,this.m_forwardPrerenderCount=2,this.m_backwardPrerenderCount=2,this.m_symbol=Symbol("Init"),this.m_isPrefetchEnabled=!0,u.ULS.setLogger(r),this.m_slideshowCore=t,i&&(this.m_forwardPrefetchCount=i.forwardPrefechCount?i.forwardPrefechCount:this.m_forwardPrefetchCount,this.m_backwardPrefetchCount=i.backwardPrefechCount?i.backwardPrefechCount:this.m_backwardPrefetchCount,c.Settings.readBooleanOrDefault("prerenderWindowChange",!1)?(this.m_forwardPrerenderCount=c.Settings.readNumberOrDefault("forwardPrerenderCount",this.m_forwardPrerenderCount),this.m_backwardPrerenderCount=c.Settings.readNumberOrDefault("backwardPrerenderCount",this.m_backwardPrerenderCount)):(this.m_forwardPrerenderCount=i.forwardPrerenderCount?i.forwardPrerenderCount:this.m_forwardPrerenderCount,this.m_backwardPrerenderCount=i.backwardPrerenderCount?i.backwardPrerenderCount:this.m_backwardPrerenderCount)),c.Settings.readBooleanOrDefault("enablePrefetchOnInit",!1)?t.events.on("prefetchOnInit",(function(e){return a.prefetchSlides(a.m_symbol,n.Init,e)})):t.events.on("prefetchOnInit",(function(){return a.prefetchSlides(a.m_symbol,n.Init)})),c.Settings.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){var o=c.Settings.readNumberOrDefault("SSPrefetchOnRehydrateForwardCount",this.m_forwardPrefetchCount),l=c.Settings.readNumberOrDefault("SSPrefetchOnRehydrateBackwardCount",this.m_backwardPrefetchCount);t.events.on("prefetchOnRefreshPodSession",(function(e){return a.prefetchSlides(a.m_symbol,n.PrefetchOnRefreshPodSession,e,o,l)}))}t.events.on("slideLocationChanged",(function(){return a.onSlideLocationChanged()})),t.events.on("webglcontextrestored",(function(){return a.prefetchSlides(a.m_symbol,n.WebGLContextRestored)}))}),[{key:"enablePrefetch",value:function(){this.m_isPrefetchEnabled=!0}},{key:"disablePrefetch",value:function(){this.m_isPrefetchEnabled=!1}},{key:"onSlideLocationChanged",value:function(e){this.m_isPrefetchEnabled&&(this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_symbol=Symbol("Cancel"),this.prefetchSlides(this.m_symbol,n.OnSlideLocationChanged))}},{key:"prefetchSlides",value:(e=(0,o.default)(a.default.mark((function e(t,r,i,o,s){var l,h,f,m,p,g,v,y;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_slideshowCore.setMaxSceneCount(this.m_forwardPrerenderCount,this.m_backwardPrerenderCount),l=i||this.m_slideshowCore.getSlideLocation()){e.next=5;break}return u.ULS.sendTraceTag(592228697,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Warning,"PrefetchAddon: undefined slide location in prefetchSlide."),e.abrupt("return");case 5:if(h=l.slideIndex,u.ULS.sendTraceTag(593827930,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Info,"PrefetchAddon::prefetchSlides - currentSlideIndex:".concat(h)),-1!==h){e.next=9;break}return e.abrupt("return");case 9:for(f=o,d.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=f||(f=d.ChangeGate.isChangeGateEnabled("PrefetchOnInitSlideAddition")&&r===n.Init?c.Settings.readNumberOrDefault("SSPrefetchOnInitForwardCount",this.m_forwardPrefetchCount):this.m_forwardPrefetchCount),m=1;m<=f;m+=1)this.m_slidesToPrefetch.push({slideIndex:h+m});for(p=s,d.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=p||(p=this.m_backwardPrefetchCount),g=1;g<=p;g+=1)h-g>=0&&this.m_slidesToPrefetch.push({slideIndex:h-g});if(d.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&this.m_slideshowCore.prefetchWindowRange&&(this.m_slideshowCore.prefetchWindowRange.last=h+this.m_forwardPrerenderCount,this.m_slideshowCore.prefetchWindowRange.first=Math.max(h-this.m_backwardPrerenderCount,0)),!this.m_isPrefetching){e.next=19;break}return u.ULS.sendTraceTag(508355611,u.LogCategory.msoulscat_Wac_PptSlideshow,u.TraceLevel.Warning,"PrefetchAddon::prefetchSlides - return as already prefetch in progress. Current queue size :".concat(this.m_slidesToPrefetch.length)),e.abrupt("return");case 19:this.m_isPrefetching=!0,v={source:r};case 21:if(!(this.m_slidesToPrefetch.length>0&&t===this.m_symbol)){e.next=29;break}return y=!1,void 0!==this.m_slidesToPrefetch[0].slideIndex&&(this.m_slidesToPrefetch[0].slideIndex>h&&this.m_slidesToPrefetch[0].slideIndex-h<=this.m_forwardPrerenderCount||this.m_slidesToPrefetch[0].slideIndex<h&&h-this.m_slidesToPrefetch[0].slideIndex<=this.m_backwardPrerenderCount)&&(y=!0),e.next=26,this.m_slideshowCore.prefetchSlide(this.m_slidesToPrefetch[0],y,v);case 26:this.m_slidesToPrefetch.shift(),e.next=21;break;case 29:this.m_isPrefetching=!1;case 30:case"end":return e.stop()}}),e,this)}))),function(t,r,i,n,a){return e.apply(this,arguments)})}]);var e}();t.PrefetchAddon=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideAdvanceAddon=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(34),c=r(3),u=function(){return(0,s.default)((function e(t,r){var i=this;(0,o.default)(this,e),this.c_noEventScheduled=-1,this.m_clickTimeEvents=[],this.m_slideLocationsAutoAdvanced=[],c.ULS.setLogger(r),this.m_slideshowCore=t,this.m_autoAdvanceEvent=this.c_noEventScheduled;for(var n=0;n<this.m_clickTimeEvents.length;n+=1)this.m_clickTimeEvents[n]=this.c_noEventScheduled;this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("exitFromEndOfShow",(function(){c.ULS.sendTraceTag(590730571,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"SlideAdvanceAddon:onAutoAdvanceTimer SlideLocations that used AutoAdvance:".concat(JSON.stringify(i.m_slideLocationsAutoAdvanced))),i.m_slideLocationsAutoAdvanced=[],i.m_autoAdvanceEvent=i.c_noEventScheduled;for(var e=0;e<i.m_clickTimeEvents.length;e+=1)i.m_clickTimeEvents[e]=i.c_noEventScheduled;i.m_prevSlideLocation=void 0,i.m_currentSlideLocation=void 0})),this.m_slideshowCore.events.on("stopAutoAdvance",(function(){i.cancelPendingAutoAdvance(),i.cancelPendingClickTimes()}))}),[{key:"onSlideLocationChanged",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_prevSlideLocation=this.m_currentSlideLocation,this.m_currentSlideLocation=this.m_slideshowCore.getSlideLocation(),this.m_currentSlideLocation){e.next=5;break}return c.ULS.sendTraceTag(590899074,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Warning,"SlideAdvanceAddon: undefined slide location in onSlideLocationChanged."),e.abrupt("return");case 5:if(this.cancelPendingAutoAdvance(),this.cancelPendingClickTimes(),!(this.m_prevSlideLocation&&this.m_currentSlideLocation.slideIndex<this.m_prevSlideLocation.slideIndex)){e.next=10;break}if(!t.actionContext||t.actionContext.navigationType===l.NavigationType.GoTo||t.actionContext.navigationType===l.NavigationType.ClickTarget){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.m_slideshowCore.getSlideShowTimings(this.m_currentSlideLocation);case 12:(r=e.sent)&&r.autoAdv&&(i=1e3*r.autoAdvTime,this.scheduleAutoAdvance(i),r.clickTimes&&this.scheduleClickTimes(r.clickTimes));case 14:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"scheduleAutoAdvance",value:function(e){this.cancelPendingAutoAdvance(),this.m_autoAdvanceEvent=window.setTimeout(this.onAutoAdvanceTimer.bind(this),e)}},{key:"scheduleClickTimes",value:function(e){this.cancelPendingClickTimes();for(var t=0,r=0;r<e.length;r+=1)t+=e[r],this.m_clickTimeEvents[r]=window.setTimeout(this.onClickTimer.bind(this),t)}},{key:"cancelPendingAutoAdvance",value:function(){this.m_autoAdvanceEvent!==this.c_noEventScheduled&&(window.clearTimeout(this.m_autoAdvanceEvent),this.m_autoAdvanceEvent=this.c_noEventScheduled)}},{key:"cancelPendingClickTimes",value:function(){for(var e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]!==this.c_noEventScheduled&&(window.clearTimeout(this.m_clickTimeEvents[e]),this.m_clickTimeEvents[e]=this.c_noEventScheduled)}},{key:"onAutoAdvanceTimer",value:function(){c.ULS.sendTraceTag(590899075,c.LogCategory.msoulscat_Wac_PptSlideshow,c.TraceLevel.Info,"SlideAdvanceAddon:onAutoAdvanceTimer Calling nextSlide from ".concat(JSON.stringify(this.m_currentSlideLocation))),this.m_slideLocationsAutoAdvanced.push(this.m_currentSlideLocation),this.m_slideshowCore.nextSlide(!1)}},{key:"onClickTimer",value:function(){this.m_slideshowCore.nextStep("0_anim",l.SlideshowActionSource.AutoAdvance)}}]);var e}();t.SlideAdvanceAddon=u},function(e,t,r){"use strict";var i,n=r(0)(r(15));!function(a,o,s,l){var c,u=["","webkit","Moz","MS","ms","o"],d=o.createElement("div"),h=Math.round,f=Math.abs,m=Date.now;function p(e,t,r){return setTimeout(b(e,r),t)}function g(e,t,r){return!!Array.isArray(e)&&(v(e,r[t],r),!0)}function v(e,t,r){var i;if(e)if(e.forEach)e.forEach(t,r);else if(void 0!==e.length)for(i=0;i<e.length;)t.call(r,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i,e)}function y(e,t,r){var i="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",n=a.console&&(a.console.warn||a.console.log);return n&&n.call(a.console,i,r),e.apply(this,arguments)}}c="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}:Object.assign;var _=y((function(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;)(!r||r&&void 0===e[i[n]])&&(e[i[n]]=t[i[n]]),n++;return e}),"extend","Use `assign`."),S=y((function(e,t){return _(e,t,!0)}),"merge","Use `assign`.");function T(e,t,r){var i,n=t.prototype;(i=e.prototype=Object.create(n)).constructor=e,i._super=n,r&&c(i,r)}function b(e,t){return function(){return e.apply(t,arguments)}}function C(e,t){return"function"==(0,n.default)(e)?e.apply(t&&t[0]||void 0,t):e}function w(e,t){return void 0===e?t:e}function P(e,t,r){v(x(t),(function(t){e.addEventListener(t,r,!1)}))}function I(e,t,r){v(x(t),(function(t){e.removeEventListener(t,r,!1)}))}function k(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function E(e,t){return e.indexOf(t)>-1}function x(e){return e.trim().split(/\s+/g)}function L(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var i=0;i<e.length;){if(r&&e[i][r]==t||!r&&e[i]===t)return i;i++}return-1}function A(e){return Array.prototype.slice.call(e,0)}function M(e,t,r){for(var i=[],n=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];L(n,o)<0&&i.push(e[a]),n[a]=o,a++}return r&&(i=t?i.sort((function(e,r){return e[t]>r[t]})):i.sort()),i}function R(e,t){for(var r,i,n=t[0].toUpperCase()+t.slice(1),a=0;a<u.length;){if((i=(r=u[a])?r+n:t)in e)return i;a++}}var O=1;function D(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||a}var F="ontouchstart"in a,B=void 0!==R(a,"PointerEvent"),N=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),V=["x","y"],U=["clientX","clientY"];function W(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){C(e.options.enable,[e])&&r.handler(t)},this.init()}function G(e,t,r){var i=r.pointers.length,n=r.changedPointers.length,a=1&t&&i-n==0,o=12&t&&i-n==0;r.isFirst=!!a,r.isFinal=!!o,a&&(e.session={}),r.eventType=t,function(e,t){var r=e.session,i=t.pointers,n=i.length;r.firstInput||(r.firstInput=H(t)),n>1&&!r.firstMultiple?r.firstMultiple=H(t):1===n&&(r.firstMultiple=!1);var a=r.firstInput,o=r.firstMultiple,s=o?o.center:a.center,l=t.center=j(i);t.timeStamp=m(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=X(s,l),t.distance=Z(s,l),function(e,t){var r=t.center,i=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:r.x,y:r.y}),t.deltaX=n.x+(r.x-i.x),t.deltaY=n.y+(r.y-i.y)}(r,t),t.offsetDirection=q(t.deltaX,t.deltaY);var c,u,d=z(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=f(d.x)>f(d.y)?d.x:d.y,t.scale=o?(c=o.pointers,Z((u=i)[0],u[1],U)/Z(c[0],c[1],U)):1,t.rotation=o?function(e,t){return X(t[1],t[0],U)+X(e[1],e[0],U)}(o.pointers,i):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,function(e,t){var r,i,n,a,o=e.lastInterval||t,s=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(s>25||void 0===o.velocity)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,u=z(s,l,c);i=u.x,n=u.y,r=f(u.x)>f(u.y)?u.x:u.y,a=q(l,c),e.lastInterval=t}else r=o.velocity,i=o.velocityX,n=o.velocityY,a=o.direction;t.velocity=r,t.velocityX=i,t.velocityY=n,t.direction=a}(r,t);var h=e.element;k(t.srcEvent.target,h)&&(h=t.srcEvent.target),t.target=h}(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function H(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:h(e.pointers[r].clientX),clientY:h(e.pointers[r].clientY)},r++;return{timeStamp:m(),pointers:t,center:j(t),deltaX:e.deltaX,deltaY:e.deltaY}}function j(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var r=0,i=0,n=0;n<t;)r+=e[n].clientX,i+=e[n].clientY,n++;return{x:h(r/t),y:h(i/t)}}function z(e,t,r){return{x:t/e||0,y:r/e||0}}function q(e,t){return e===t?1:f(e)>=f(t)?e<0?2:4:t<0?8:16}function Z(e,t,r){r||(r=V);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return Math.sqrt(i*i+n*n)}function X(e,t,r){r||(r=V);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return 180*Math.atan2(n,i)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(D(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(D(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4};function J(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,W.apply(this,arguments)}T(J,W,{handler:function(e){var t=Y[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var K={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:"touch",3:"pen",4:"mouse",5:"kinect"},$="pointerdown",ee="pointermove pointerup pointercancel";function te(){this.evEl=$,this.evWin=ee,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}a.MSPointerEvent&&!a.PointerEvent&&($="MSPointerDown",ee="MSPointerMove MSPointerUp MSPointerCancel"),T(te,W,{handler:function(e){var t=this.store,r=!1,i=e.type.toLowerCase().replace("ms",""),n=K[i],a=Q[e.pointerType]||e.pointerType,o="touch"==a,s=L(t,e.pointerId,"pointerId");1&n&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&n&&(r=!0),s<0||(t[s]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),r&&t.splice(s,1))}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ie(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,W.apply(this,arguments)}function ne(e,t){var r=A(e.touches),i=A(e.changedTouches);return 12&t&&(r=M(r.concat(i),"identifier",!0)),[r,i]}T(ie,W,{handler:function(e){var t=re[e.type];if(1===t&&(this.started=!0),this.started){var r=ne.call(this,e,t);12&t&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}}});var ae={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function oe(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},W.apply(this,arguments)}function se(e,t){var r=A(e.touches),i=this.targetIds;if(3&t&&1===r.length)return i[r[0].identifier]=!0,[r,r];var n,a,o=A(e.changedTouches),s=[],l=this.target;if(a=r.filter((function(e){return k(e.target,l)})),1===t)for(n=0;n<a.length;)i[a[n].identifier]=!0,n++;for(n=0;n<o.length;)i[o[n].identifier]&&s.push(o[n]),12&t&&delete i[o[n].identifier],n++;return s.length?[M(a.concat(s),"identifier",!0),s]:void 0}function le(){W.apply(this,arguments);var e=b(this.handler,this);this.touch=new oe(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ce(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ue.call(this,t)):12&e&&ue.call(this,t)}function ue(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var i=this.lastTouches;setTimeout((function(){var e=i.indexOf(r);e>-1&&i.splice(e,1)}),2500)}}function de(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],a=Math.abs(t-n.x),o=Math.abs(r-n.y);if(a<=25&&o<=25)return!0}return!1}T(oe,W,{handler:function(e){var t=ae[e.type],r=se.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}}),T(le,W,{handler:function(e,t,r){var i="touch"==r.pointerType,n="mouse"==r.pointerType;if(!(n&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(i)ce.call(this,t,r);else if(n&&de.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=R(d.style,"touchAction"),fe=void 0!==he,me=function(){if(!fe)return!1;var e={},t=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){e[r]=!t||a.CSS.supports("touch-action",r)})),e}();function pe(e,t){this.manager=e,this.set(t)}function ge(e){this.options=c({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ve(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ye(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function _e(e,t){var r=t.manager;return r?r.get(e):e}function Se(){ge.apply(this,arguments)}function Te(){Se.apply(this,arguments),this.pX=null,this.pY=null}function be(){Se.apply(this,arguments)}function Ce(){ge.apply(this,arguments),this._timer=null,this._input=null}function we(){Se.apply(this,arguments)}function Pe(){Se.apply(this,arguments)}function Ie(){ge.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ke(e,t){return(t=t||{}).recognizers=w(t.recognizers,ke.defaults.preset),new Ee(e,t)}function Ee(e,t){var r;this.options=c({},ke.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((r=this).options.inputClass||(B?te:N?oe:F?le:J))(r,G),this.touchAction=new pe(this,this.options.touchAction),xe(this,!0),v(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function xe(e,t){var r,i=e.element;i.style&&(v(e.options.cssProps,(function(n,a){r=R(i.style,a),t?(e.oldCssProps[r]=i.style[r],i.style[r]=n):i.style[r]=e.oldCssProps[r]||""})),t||(e.oldCssProps={}))}pe.prototype={set:function(e){"compute"==e&&(e=this.compute()),fe&&this.manager.element.style&&me[e]&&(this.manager.element.style[he]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,(function(t){C(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(E(e,"none"))return"none";var t=E(e,"pan-x"),r=E(e,"pan-y");return t&&r?"none":t||r?t?"pan-x":"pan-y":E(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,n=E(i,"none")&&!me.none,a=E(i,"pan-y")&&!me["pan-y"],o=E(i,"pan-x")&&!me["pan-x"];if(n){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}if(!o||!a)return n||a&&6&r||o&&24&r?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},ge.prototype={defaults:{},set:function(e){return c(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=_e(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=_e(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===L(t,e=_e(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=_e(e,this);var t=L(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,r=this.state;function i(r){t.manager.emit(r,e)}r<8&&i(t.options.event+ve(r)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),r>=8&&i(t.options.event+ve(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=c({},e);if(!C(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},T(Se,ge,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,i=6&t,n=this.attrTest(e);return i&&(8&r||!n)?16|t:i||n?4&r?8|t:2&t?4|t:2:32}}),T(Te,Se,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,r=!0,i=e.distance,n=e.direction,a=e.deltaX,o=e.deltaY;return n&t.direction||(6&t.direction?(n=0===a?1:a<0?2:4,r=a!=this.pX,i=Math.abs(e.deltaX)):(n=0===o?1:o<0?8:16,r=o!=this.pY,i=Math.abs(e.deltaY))),e.direction=n,r&&i>t.threshold&&n&t.direction},attrTest:function(e){return Se.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ye(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),T(be,Se,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),T(Ce,ge,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!i||!r||12&e.eventType&&!n)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}}),T(we,Se,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),T(Pe,Se,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return 30&r?t=e.overallVelocity:6&r?t=e.overallVelocityX:24&r&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ye(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),T(Ie,ge,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&n&&r){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ke.VERSION="2.0.7",ke.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[we,{enable:!1}],[be,{enable:!1},["rotate"]],[Pe,{direction:6}],[Te,{direction:6},["swipe"]],[Ie],[Ie,{event:"doubletap",taps:2},["tap"]],[Ce]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ee.prototype={set:function(e){return c(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var r;this.touchAction.preventDefaults(e);var i=this.recognizers,n=t.curRecognizer;(!n||n&&8&n.state)&&(n=t.curRecognizer=null);for(var a=0;a<i.length;)r=i[a],2===t.stopped||n&&r!=n&&!r.canRecognizeWith(n)?r.reset():r.recognize(e),!n&&14&r.state&&(n=t.curRecognizer=r),a++}},get:function(e){if(e instanceof ge)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=L(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var r=this.handlers;return v(x(e),(function(e){r[e]=r[e]||[],r[e].push(t)})),this}},off:function(e,t){if(void 0!==e){var r=this.handlers;return v(x(e),(function(e){t?r[e]&&r[e].splice(L(r[e],t),1):delete r[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var r=o.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](t),i++}},destroy:function(){this.element&&xe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(ke,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ee,Input:W,TouchAction:pe,TouchInput:oe,MouseInput:J,PointerEventInput:te,TouchMouseInput:le,SingleTouchInput:ie,Recognizer:ge,AttrRecognizer:Se,Tap:Ie,Pan:Te,Swipe:Pe,Pinch:be,Rotate:we,Press:Ce,on:P,off:I,each:v,merge:S,extend:_,assign:c,inherit:T,bindFn:b,prefixed:R}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ke,void 0===(i=function(){return ke}.call(t,r,t,e))||(e.exports=i)}(window,document)},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setupGlobals_PodsProxy=function(e){e.logger&&g.ULS.setLogger(e.logger),e.settings&&_.Settings.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&p.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=w)},t.PodsProxy=t.exposed=void 0;var n,a=i(r(6)),o=i(r(18)),s=i(r(19)),l=i(r(5)),c=i(r(7)),u=i(r(1)),d=i(r(2)),h=r(187),f=r(188),m=r(208),p=r(11),g=r(3),v=r(26),y=r(425),_=r(4);function S(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return T(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w={};t.exposed=w;var P=function(){function e(t,r,i,n,a,o,s){var l=this;if((0,u.default)(this,e),this.events=new v.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new m.MultipartParser,g.ULS.setLogger(n),g.ULS.sendTraceTag(508420489,g.LogCategory.msoulscat_Wac_PptSession,t&&r&&r.DownloadUrl&&i&&r.DocID?g.TraceLevel.Info:g.TraceLevel.Warning,"PodsProxy::constructor - podsUrl:".concat(t,", fileExtension:").concat(i,", docId:").concat(r.DocID,"}")),g.ULS.sendTraceTag(508420488,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::constructor - presentUrl:".concat(a,"}")),this.m_podsUrl=t,this.m_presentUrl=a,this.m_settings=s||{timeout:3e4,throwHttpErrors:!0},p.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),o&&o.forEach((function(e,t){l.m_requestHeaders.append(t,e)})),this.m_getPresInfoRequest={Source:r,FileExtension:i||"pptx"},this.m_getItemsRequest={Source:r,FileExtension:i||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),s&&s.perfTimingMonitorEnabled)try{var c=new Set;this.m_presentUrl&&p.ChangeGate.isChangeGateEnabled("PodsProxy.logPFDPerfTiming")&&(c.add("".concat(this.m_presentUrl,"/items")),c.add("".concat(this.m_presentUrl,"/ping"))),c.add("getitems.ashx"),c.add("getmedia.ashx"),c.add("remoteuls.ashx"),c.add("podhandler.ashx"),c.add("remotetelemetry.ashx"),new PerformanceObserver((function(t){return e.logPerformanceEntries(t,c)})).observe({entryTypes:["resource"]})}catch(e){g.ULS.sendTraceTag(508420487,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:PerformanceObserver failed with exception ".concat(e))}}return(0,d.default)(e,[{key:"getSlideOrderAsync",value:(D=(0,c.default)(a.default.mark((function e(){var t,r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPresInfoAsync("getSlideOrderAsync");case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,i={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:r.SlideOrder},e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"getSlideInfosAsync",value:(O=(0,c.default)(a.default.mark((function e(t){var r,i,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.RenderOptions&&(this.m_getPresInfoRequest.SlideRanges=[{IDs:t.SlideLocations.map((function(e){return e.slideId})),RenderOptions:t.RenderOptions}]),this.m_getPresInfoRequest.ClientWidth=t.ClientWidth?t.ClientWidth:this.m_getPresInfoRequest.ClientWidth,this.m_getPresInfoRequest.ClientHeight=t.ClientHeight?t.ClientHeight:this.m_getPresInfoRequest.ClientHeight,this.m_getPresInfoRequest.DevicePixelRatio=t.DevicePixelRatio?t.DevicePixelRatio:this.m_getPresInfoRequest.DevicePixelRatio,this.m_getPresInfoRequest.IsHighContrast=t.IsHighContrast?t.IsHighContrast:this.m_getPresInfoRequest.IsHighContrast,this.m_getPresInfoRequest.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:this.m_getPresInfoRequest.ClientColorSettings,this.m_getPresInfoRequest.MinClientWidth=t.MinClientWidth?t.MinClientWidth:this.m_getPresInfoRequest.MinClientWidth,this.m_getPresInfoRequest.MinClientHeight=t.MinClientHeight?t.MinClientHeight:this.m_getPresInfoRequest.MinClientHeight,this.m_getPresInfoRequest.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:this.m_getPresInfoRequest.MaxClientWidth,this.m_getPresInfoRequest.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:this.m_getPresInfoRequest.MaxClientHeight,e.next=12,this.getPresInfoAsync("getSlideInfosAsync");case 12:return r=e.sent,e.next=15,r.json();case 15:return i=e.sent,n={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:i.Slides},e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"getItemsSlideOrderAsync",value:(R=(0,c.default)(a.default.mark((function e(){var t,r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.m_itemsList=new Array,this.m_itemsList.push({Id:f.GetRequestItemIds.PresinfoslimSlideOrder,AcceptTypes:[f.ItemType.JsonType]}),this.m_getItemsRequest.Items=this.m_itemsList,e.next=5,this.getItemsAsync("getItemsSlideOrderAsync");case 5:return t=e.sent,r={},e.next=9,this.createSlideIdResponse(this.parseMultipartResponseAsync(t,r));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"getItemsPresInfoAsync",value:(M=(0,c.default)(a.default.mark((function t(r){var i,n,o,s,l,c;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:f.GetRequestItemIds.PresInfoMetaData,AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(h.PodsProxyConstants.CallerCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(h.PodsProxyConstants.XCorrelationId,r.CorrelationId||""),i=C(C(C({},r.RequestInfo),this.m_settings.sessionInfo),{},{CorrelationId:r.CorrelationId}),this.m_requestHeaders.set(h.PodsProxyConstants.RequestInfo,JSON.stringify(i)),n=this.objectDictionaryToRequestIdString(i),this.m_requestHeaders.set(h.PodsProxyConstants.clientRequestIdHeader,n),this.m_requestHeaders.set(h.PodsProxyConstants.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),this.m_requestHeaders.set(h.PodsProxyConstants.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),o={action:"getItemsPresInfoAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(o),t.next=21,this.getItemsAsync("getItemsPresInfoAsync");case 21:return s=t.sent,o[h.PodsProxyConstants.server].end=e.performanceNowTrimmed(),s&&s.response&&s.response.headers&&(o[h.PodsProxyConstants.contentLength]=s.response.headers.get(h.PodsProxyConstants.ContentLength)),e.logPerf(o),o[h.PodsProxyConstants.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},l=this.setTimeoutForParsingResponse(o),t.next=29,this.createPresInfoResponse(this.parseMultipartResponseAsync(s,o));case 29:return c=t.sent,clearTimeout(l),o[h.PodsProxyConstants.parser].end=e.performanceNowTrimmed(),o[h.PodsProxyConstants.usedOutputCache]=!!c.usedOutputCache&&"true"===c.usedOutputCache.trim().toLowerCase(),o[h.PodsProxyConstants.itemUsedOutputCacheMap]=!!c.itemUsedOutputCacheMap&&Array.from(c.itemUsedOutputCacheMap.entries()),e.logPerf(o),c.metadata=this.generateReportPerfDictionary(o),t.abrupt("return",c);case 37:case"end":return t.stop()}}),t,this)}))),function(e){return M.apply(this,arguments)})},{key:"getItemsPresInfoAndSlideInfosAsync",value:(A=(0,c.default)(a.default.mark((function t(r,i,n){var o,s,l,c,u,d,m,p,v,y,_,T,b,w,P,I;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o={action:"getItemsPresInfoAndSlideInfoAsync"},s=null,t.prev=2,this.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:f.GetRequestItemIds.PresInfoMetaData,AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_imageOptions.InputProperties.ClientWidth=i.ClientWidth?i.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=i.ClientHeight?i.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=i.IsHighContrast?i.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ClientColorSettings=i.ClientColorSettings?i.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=i.MinClientWidth?i.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=i.MinClientHeight?i.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=i.MaxClientWidth?i.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=i.MaxClientHeight?i.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=i.TranslateLanguage?i.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,l=0;l<i.SlideLocations.length;l+=1)i.GetSlideImage?this.m_itemsList.push({Id:i.SlideLocations[l].slideId?f.GetRequestItemIds.slideInfoSid+i.SlideLocations[l].slideId.sid.toString():f.GetRequestItemIds.slideInfoIndex+i.SlideLocations[l].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):i.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:i.ClientWidth?i.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:i.ClientHeight?i.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:i.IsHighContrast?i.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:i.ColorMode?i.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:i.ClientColorSettings?i.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=i.TranslateLanguage?i.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:i.LocaleName?i.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(i.Filters),this.m_itemsList.push({Id:i.SlideLocations[l].slideId?f.GetRequestItemIds.slideInfoSid+i.SlideLocations[l].slideId.sid.toString():f.GetRequestItemIds.slideInfoIndex+i.SlideLocations[l].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=i.TranslateLanguage?i.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:i.LocaleName?i.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==i.GetSlideAccessibilityModelData&&i.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:i.SlideLocations[l].slideId?f.GetRequestItemIds.slideAccessibilityModelSid+i.SlideLocations[l].slideId.sid.toString():f.GetRequestItemIds.slideAccessibilityModelIndex+i.SlideLocations[l].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),i.GetSlideNotes&&this.m_itemsList.push({Id:i.SlideLocations[l].slideId?f.GetRequestItemIds.slideNotesSid+i.SlideLocations[l].slideId.sid.toString():f.GetRequestItemIds.slideCommentsIndex+i.SlideLocations[l].slideIndex.toString(),AcceptTypes:[f.ItemType.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),i.GetSlideComments&&this.m_itemsList.push({Id:i.SlideLocations[l].slideId?f.GetRequestItemIds.slideCommentsSid+i.SlideLocations[l].slideId.sid.toString():f.GetRequestItemIds.slideCommentsIndex+i.SlideLocations[l].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:i.CommentOptions});return this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(h.PodsProxyConstants.CallerCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(h.PodsProxyConstants.XCorrelationId,r.CorrelationId||""),c=C(C(C({},r.RequestInfo),this.m_settings.sessionInfo),{},{CorrelationId:r.CorrelationId}),this.m_requestHeaders.set(h.PodsProxyConstants.RequestInfo,JSON.stringify(c)),u=this.objectDictionaryToRequestIdString(c),this.m_requestHeaders.set(h.PodsProxyConstants.clientRequestIdHeader,u),this.m_requestHeaders.set(h.PodsProxyConstants.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),this.m_requestHeaders.set(h.PodsProxyConstants.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),o.correlationId=r.CorrelationId,o[h.PodsProxyConstants.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(o),this.events.emit("requestStageChanged",{requestType:h.PodsProxyRequestType.getItemsPresInfoAndSlideInfoAsync,stageInfo:h.PodsProxyRequestStageType.GetItemsCall}),t.next=36,this.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:n&&n.overrideGetItemsTimeoutMs});case 36:if(d=t.sent,!this.m_settings.shouldUpdateNewFileUrlFromSnap||d.errorCode!==f.ErrorCode.ServerErrorFileDownloadResourceInconsistent){t.next=40;break}return m={presInfo:void 0,slideInfo:[],responseErrorCode:f.ErrorCode.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:d.errorCategory,responseIsIntentional:d.isIntentional,itemErrorCodeMap:void 0},t.abrupt("return",m);case 40:if(o[h.PodsProxyConstants.server].end=e.performanceNowTrimmed(),d&&d.response&&d.response.headers&&(o[h.PodsProxyConstants.contentLength]=d.response.headers.get(h.PodsProxyConstants.ContentLength),o[h.PodsProxyConstants.ContenEncoding]=d.response.headers.get(h.PodsProxyConstants.ContenEncoding),o[h.PodsProxyConstants.TransferEncoding]=d.response.headers.get(h.PodsProxyConstants.TransferEncoding),p=d.response.headers.keys())){v=[],y=S(p);try{for(y.s();!(_=y.n()).done;)T=_.value,v.push(T)}catch(e){y.e(e)}finally{y.f()}o[h.PodsProxyConstants.ResponseHeaders]=v}return e.logPerf(o),o[h.PodsProxyConstants.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},s=this.setTimeoutForParsingResponse(o),t.next=47,this.parseMultipartResponseAsync(d,o,{shouldTimeoutResponseStreamDownload:n&&n.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:n&&n.overrideDownloadTimeoutMs,requestType:h.PodsProxyRequestType.getItemsPresInfoAndSlideInfoAsync});case 47:if(!(b=t.sent)||b.responseErrorCode!==f.ErrorCode.ErrorDownloadResponseStreamTimeout){t.next=51;break}return w={presInfo:void 0,slideInfo:[],responseErrorCode:f.ErrorCode.ErrorDownloadResponseStreamTimeout,responseErrorCategory:f.ErrorCategory.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0},t.abrupt("return",w);case 51:return P=this.createPresInfoAndSlideInfoResponse(b,o),null!==s&&(clearTimeout(s),s=null),o[h.PodsProxyConstants.parser].end=e.performanceNowTrimmed(),o[h.PodsProxyConstants.usedOutputCache]=!!P.usedOutputCache&&"true"===P.usedOutputCache.trim().toLowerCase(),o[h.PodsProxyConstants.itemUsedOutputCacheMap]=!!P.itemUsedOutputCacheMap&&Array.from(P.itemUsedOutputCacheMap.entries()),o[h.PodsProxyConstants.podsProxyCallSuceeded]=!0,e.logPerf(o),P.metadata=this.generateReportPerfDictionary(o),t.abrupt("return",P);case 62:return t.prev=62,t.t0=t.catch(2),g.ULS.sendTraceTag(508420486,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: ".concat(t.t0)),o[h.PodsProxyConstants.podsProxyCallSuceeded]=!1,e.logPerf(o),null!==s&&(clearTimeout(s),s=null),I={presInfo:void 0,slideInfo:[],responseErrorCode:f.ErrorCode.ErrorRESERVEDItemFailed,responseErrorCategory:f.ErrorCategory.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0},t.abrupt("return",I);case 70:case"end":return t.stop()}}),t,this,[[2,62]])}))),function(e,t,r){return A.apply(this,arguments)})},{key:"getItemsSlideInfosAsync",value:(L=(0,c.default)(a.default.mark((function t(r){var i,n,o,s,l,c,u,d,m,p,v;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i={action:"getItemsSlideInfosAsync"},t.prev=1,this.m_imageOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=null!=r.IsHighContrast?r.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ColorMode=null!=r.ColorMode?r.ColorMode:this.m_imageInputProperties.ColorMode,this.m_imageOptions.InputProperties.ClientColorSettings=null!=r.ClientColorSettings?r.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=r.MinClientWidth?r.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=r.MinClientHeight?r.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=r.MaxClientWidth?r.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=r.MaxClientHeight?r.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=r.TranslateLanguage?r.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,this.m_itemsList=new Array,n=0;n<r.SlideLocations.length;n+=1)r.GetSlideImage?this.m_itemsList.push({Id:r.SlideLocations[n].slideId?f.GetRequestItemIds.slideInfoSid+r.SlideLocations[n].slideId.sid.toString():f.GetRequestItemIds.slideInfoIndex+r.SlideLocations[n].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):r.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(r.Filters),r.SkipGetSlideInfo||this.m_itemsList.push({Id:r.SlideLocations[n].slideId?f.GetRequestItemIds.slideInfoSid+r.SlideLocations[n].slideId.sid.toString():f.GetRequestItemIds.slideInfoIndex+r.SlideLocations[n].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:r.LocaleName?r.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==r.GetSlideAccessibilityModelData&&r.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:r.SlideLocations[n].slideId?f.GetRequestItemIds.slideAccessibilityModelSid+r.SlideLocations[n].slideId.sid.toString():f.GetRequestItemIds.slideAccessibilityModelIndex+r.SlideLocations[n].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),r.GetSlideNotes&&this.m_itemsList.push({Id:r.SlideLocations[n].slideId?f.GetRequestItemIds.slideNotesSid+r.SlideLocations[n].slideId.sid.toString():f.GetRequestItemIds.slideCommentsIndex+r.SlideLocations[n].slideIndex.toString(),AcceptTypes:[f.ItemType.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),r.GetSlideComments&&this.m_itemsList.push({Id:r.SlideLocations[n].slideId?f.GetRequestItemIds.slideCommentsSid+r.SlideLocations[n].slideId.sid.toString():f.GetRequestItemIds.slideCommentsIndex+r.SlideLocations[n].slideIndex.toString(),AcceptTypes:[f.ItemType.JsonType],Options:r.CommentOptions});if(0!==this.m_itemsList.length){t.next=18;break}return g.ULS.sendTraceTag(508420485,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),o={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRequestFailed,responseErrorCategory:f.ErrorCategory.BadRequest,responseIsIntentional:!1,slideInfo:[]},t.abrupt("return",o);case 18:return this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(h.PodsProxyConstants.CallerCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(h.PodsProxyConstants.XCorrelationId,r.CorrelationId||""),s=C(C(C({},r.RequestInfo),this.m_settings.sessionInfo),{},{CorrelationId:r.CorrelationId}),this.m_requestHeaders.set(h.PodsProxyConstants.RequestInfo,JSON.stringify(s)),l=this.objectDictionaryToRequestIdString(s),this.m_requestHeaders.set(h.PodsProxyConstants.clientRequestIdHeader,l),this.m_requestHeaders.set(h.PodsProxyConstants.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),this.m_requestHeaders.set(h.PodsProxyConstants.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),(c={action:"getItemsSlideInfosAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}}).correlationId=r.CorrelationId,c[h.PodsProxyConstants.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(c),t.next=33,this.getItemsAsync("getItemsSlideInfosAsync");case 33:if(u=t.sent,!this.m_settings.shouldUpdateNewFileUrlFromSnap||u.errorCode!==f.ErrorCode.ServerErrorFileDownloadResourceInconsistent){t.next=37;break}return d={slideInfo:[],responseErrorCode:f.ErrorCode.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:u.errorCategory,responseIsIntentional:!!u.headers.get(h.PodsProxyConstants.IsIntentional)&&u.headers.get(h.PodsProxyConstants.IsIntentional),itemErrorCodeMap:void 0},t.abrupt("return",d);case 37:return c[h.PodsProxyConstants.server].end=e.performanceNowTrimmed(),u&&u.response&&u.response.headers&&(c[h.PodsProxyConstants.contentLength]=u.response.headers.get(h.PodsProxyConstants.ContentLength)),c[h.PodsProxyConstants.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(c),m=this.setTimeoutForParsingResponse(c),t.next=44,this.createSlideInfoResponse(this.parseMultipartResponseAsync(u,c),c);case 44:return p=t.sent,clearTimeout(m),c[h.PodsProxyConstants.parser].end=e.performanceNowTrimmed(),c[h.PodsProxyConstants.usedOutputCache]=!!p.usedOutputCache&&"true"===p.usedOutputCache.trim().toLowerCase(),c[h.PodsProxyConstants.itemUsedOutputCacheMap]=!!p.itemUsedOutputCacheMap&&Array.from(p.itemUsedOutputCacheMap.entries()),c[h.PodsProxyConstants.podsProxyCallSuceeded]=!0,e.logPerf(c),p.metadata=this.generateReportPerfDictionary(c),t.abrupt("return",p);case 55:return t.prev=55,t.t0=t.catch(1),g.ULS.sendTraceTag(508420484,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: ".concat(t.t0)),i[h.PodsProxyConstants.podsProxyCallSuceeded]=!1,e.logPerf(i),v={slideInfo:[],responseErrorCode:f.ErrorCode.ErrorRESERVEDItemFailed,responseErrorCategory:f.ErrorCategory.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0},t.abrupt("return",v);case 62:case"end":return t.stop()}}),t,this,[[1,55]])}))),function(e){return L.apply(this,arguments)})},{key:"getItemsResourceAsync",value:(x=(0,c.default)(a.default.mark((function t(r){var i,n,o,s,l,c,u,d,m;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.m_slideResourceOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:this.m_slideResourceInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:this.m_slideResourceInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:this.m_slideResourceInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:this.m_slideResourceInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:this.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:this.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:this.m_slideResourceInputProperties.LocaleName},this.m_slideResourceOptions.Filters.EnableClustering=void 0!==r.EnableClustering&&r.EnableClustering,this.m_itemsList=new Array,i=S(r.ResourceParams),t.prev=4,i.s();case 6:if((n=i.n()).done){t.next=22;break}o=n.value,this.m_slideResourceOptions.InputProperties.ResourceId=o.Id,s=String(o.Name.match("[^.]+$")),l="",t.t0=s,t.next="jpg"===t.t0?14:"png"===t.t0?16:18;break;case 14:return l=f.ItemType.ImageJpg,t.abrupt("break",19);case 16:return l=f.ItemType.ImagePng,t.abrupt("break",19);case 18:case 19:this.m_itemsList.push({Id:o.Name,AcceptTypes:l?[l]:e.s_supportedImageType,Options:JSON.stringify(this.m_slideResourceOptions)});case 20:t.next=6;break;case 22:t.next=27;break;case 24:t.prev=24,t.t1=t.catch(4),i.e(t.t1);case 27:return t.prev=27,i.f(),t.finish(27);case 30:return this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(h.PodsProxyConstants.CallerCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(h.PodsProxyConstants.XCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(h.PodsProxyConstants.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),c={action:"getItemsResourceAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(c),t.next=38,this.getItemsAsync("getItemsResourceAsync");case 38:return u=t.sent,c[h.PodsProxyConstants.server].end=e.performanceNowTrimmed(),u&&u.response&&u.response.headers&&(c[h.PodsProxyConstants.contentLength]=u.response.headers.get(h.PodsProxyConstants.ContentLength)),c[h.PodsProxyConstants.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(c),d=this.setTimeoutForParsingResponse(c),t.next=46,this.createSlideInfoResponse(this.parseMultipartResponseAsync(u,c),c);case 46:return m=t.sent,clearTimeout(d),c[h.PodsProxyConstants.parser].end=e.performanceNowTrimmed(),c[h.PodsProxyConstants.usedOutputCache]=!!m.usedOutputCache&&"true"===m.usedOutputCache.trim().toLowerCase(),c[h.PodsProxyConstants.itemUsedOutputCacheMap]=!!m.itemUsedOutputCacheMap&&Array.from(m.itemUsedOutputCacheMap.entries()),e.logPerf(c),m.metadata=this.generateReportPerfDictionary(c),t.abrupt("return",m);case 54:case"end":return t.stop()}}),t,this,[[4,24,27,30]])}))),function(e){return x.apply(this,arguments)})},{key:"getItemsSlideOrderAndSlidesInfoIndexAsync",value:(E=(0,c.default)(a.default.mark((function t(r,i,n){var o,s,l,c,u,d=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.m_getItemsRequest.Items.push({Id:f.GetRequestItemIds.PresinfoslimSlideOrder,AcceptTypes:[f.ItemType.JsonType],Options:JSON.stringify(n)}),o=JSON.stringify(i),r&&r.forEach((function(e){d.m_getItemsRequest.Items.push({Id:"".concat(f.GetRequestItemIds.slideInfoIndex).concat(e),AcceptTypes:[f.ItemType.ImagePng,f.ItemType.ImageJpg],Options:o})})),s={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(s),t.next=7,this.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync");case 7:return l=t.sent,s[h.PodsProxyConstants.server].end=e.performanceNowTrimmed(),s[h.PodsProxyConstants.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},l&&l.response&&l.response.headers&&(s[h.PodsProxyConstants.contentLength]=l.response.headers.get(h.PodsProxyConstants.ContentLength)),e.logPerf(s),c=this.setTimeoutForParsingResponse(s),t.next=15,this.createSlideOrderAndSlidesInfoIndexResponse(this.parseMultipartResponseAsync(l,s));case 15:return u=t.sent,clearTimeout(c),s[h.PodsProxyConstants.parser].end=e.performanceNowTrimmed(),s[h.PodsProxyConstants.usedOutputCache]=!!u.usedOutputCache&&"true"===u.usedOutputCache.trim().toLowerCase(),s[h.PodsProxyConstants.itemUsedOutputCacheMap]=!!u.itemUsedOutputCacheMap&&Array.from(u.itemUsedOutputCacheMap.entries()),e.logPerf(s),u.metadata=this.generateReportPerfDictionary(s),t.abrupt("return",u);case 23:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return E.apply(this,arguments)})},{key:"getPresInfoAsync",value:(k=(0,c.default)(a.default.mark((function e(t){var r,i,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.ULS.sendTraceTag(508420483,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::getPresInfoAsync - Function:".concat(t,", requestCorrelation:").concat(this.m_requestHeaders.get(h.PodsProxyConstants.CallerCorrelationId))),r=new AbortController,i=setTimeout((function(){return r.abort()}),3e4),e.next=5,fetch("".concat(this.m_podsUrl,"/presinfo.ashx"),{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getPresInfoRequest),signal:r.signal}).catch(function(){var e=(0,c.default)(a.default.mark((function e(r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw g.ULS.sendTraceTag(508420482,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getPresInfo - Function: ".concat(t,", Error: ").concat(r)),r;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return n=e.sent,clearTimeout(i),g.ULS.sendTraceTag(508420481,g.LogCategory.msoulscat_Wac_PptSession,n.ok?g.TraceLevel.Info:g.TraceLevel.Error,"PodsProxy::getPresInfo - Function: ".concat(t,", Status:").concat(n.status,", StatusText: ").concat(n.statusText,", CorrelationId: ").concat(n.headers.get(h.PodsProxyConstants.XCorrelationId))),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"logGetItemFailureServerHeaders",value:(I=(0,c.default)(a.default.mark((function e(t,r,i,n){var o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o={functionName:t,requestCorrelation:r,usePresentFrontDoor:i}).headerCorrelationId=n&&n.headers?n.headers.get(h.PodsProxyConstants.XCorrelationId):h.PodsProxyConstants.unknown,o.headerErrorCode=n&&n.headers?n.headers.get(h.PodsProxyConstants.ErrorCode):h.PodsProxyConstants.unknown,o.xHeaderErrorCode=n&&n.headers?n.headers.get(h.PodsProxyConstants.XErrorCode):h.PodsProxyConstants.unknown,o.headerErrorCategory=n&&n.headers?n.headers.get(h.PodsProxyConstants.ErrorCategory):h.PodsProxyConstants.unknown,o.headerErrorIntentional=!(!n||!n.headers)&&n.headers.get(h.PodsProxyConstants.IsIntentional),o.status=n&&n.status?n.status:h.PodsProxyConstants.unknown,g.ULS.sendTraceTag(506852878,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:logGetItemFailureServerHeaders - ".concat(JSON.stringify(o)));case 8:case"end":return e.stop()}}),e)}))),function(e,t,r,i){return I.apply(this,arguments)})},{key:"getItemsAsync",value:(P=(0,c.default)(a.default.mark((function t(r,i){var n,o,s,l,u,d,m,p,v,y,S=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.m_requestHeaders.get(h.PodsProxyConstants.CallerCorrelationId),g.ULS.sendTraceTag(508420480,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::getItemsAsync - Function:".concat(r,", requestCorrelation:").concat(n)),o={errorCode:f.ErrorCode.ErrorRESERVEDSuccess},s=o,l="getItemsPresInfoAndSlideInfoAsync"===r&&this.m_settings.shouldUseBootRequestTimeout&&this.m_settings.bootRequestTimeout?this.m_settings.bootRequestTimeout:this.m_settings.timeout,i&&i.overrideGetItemsTimeoutMs&&(l=i.overrideGetItemsTimeoutMs),this.m_requestHeaders.set(h.PodsProxyConstants.dateHeader,(new Date).toISOString()),this.m_requestHeaders.set(h.PodsProxyConstants.clientTimeoutHeader,l.toString()),this.m_requestHeaders.set(h.PodsProxyConstants.callId,this.m_settings.callId||"empty"),u=!1,d="".concat(this.m_podsUrl,"/getitems.ashx"),(this.m_settings.pptoPresentFrontDoorEnabled||_.Settings.readBooleanOrDefault("enableUsePresentFrontdoor",!1))&&(this.m_presentUrl?(d="".concat(this.m_presentUrl,"/items"),u=!0):g.ULS.sendTraceTag(508420451,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }")),m=this.m_getItemsRequest.Items.map((function(e){return e.Id})),e.s_events.emit("networkCall",{url:d,itemIds:m}),p=new AbortController,v=setTimeout((function(){return p.abort()}),l),t.next=18,fetch(d,{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getItemsRequest),signal:p.signal}).catch(function(){var t=(0,c.default)(a.default.mark((function t(i){var s,l,c,d,m,p,v,y;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=i.response&&i.response.headers?i.response.headers.get(h.PodsProxyConstants.XCorrelationId):h.PodsProxyConstants.unknown,l=i.response&&i.response.headers?i.response.headers.get(h.PodsProxyConstants.ErrorCode):h.PodsProxyConstants.unknown,c=i.response&&i.response.headers?i.response.headers.get(h.PodsProxyConstants.XErrorCode):h.PodsProxyConstants.unknown,d=i.response&&i.response.headers?i.response.headers.get(h.PodsProxyConstants.ErrorCategory):h.PodsProxyConstants.unknown,m=!(!i.response||!i.response.headers)&&i.response.headers.get(h.PodsProxyConstants.IsIntentional),p=i.response&&i.response.status?i.response.status:h.PodsProxyConstants.unknown,(v=i.toString()).length>0&&("."===v.slice(-1)||""===v.slice(-1))&&(v=v.slice(0,-1)),(y=S.getMappedError(v))?o.errorCode=y:"HTTPError"===i.name&&p!==h.PodsProxyConstants.unknown&&500!==p&&S.m_errorMap.has(p)?o.errorCode=S.m_errorMap.get(p):"TimeoutError"===i.name?o.errorCode=f.ErrorCode.ErrorRequestTimeout:o.errorCode=e.convertServerError(l,S.m_settings.enableServerSpecificErrorCode),S.m_settings.shouldUpdateNewFileUrlFromSnap&&o.errorCode===f.ErrorCode.ServerErrorFileDownloadResourceInconsistent&&(o.newSnapUrl=e.getFieldFromReponseHeader(i.response,h.PodsProxyConstants.newSnapUrlHeader)),o.errorCategory=d&&""!==d.trim()&&d!==h.PodsProxyConstants.unknown?d:f.ErrorCategory.Transient,o.isIntentional=m!==h.PodsProxyConstants.unknown&&m,g.ULS.sendTraceTag(595687001,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItems - Function:".concat(r,", Error:").concat(i,", ErrorName:").concat(i.name,", Status:").concat(i.status,", HeaderCorrelationId:").concat(s,", HeaderErrorCode:").concat(l,", HeaderErrorCategory:").concat(d,", result.isIntentional:").concat(o.isIntentional,", result.errorCode:").concat(o.errorCode,", requestCorrelation:").concat(n,", status:").concat(p,", xErrorCode:").concat(c,", usePresentFrontDoor:").concat(u)),t.abrupt("return",o);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 18:if(s=t.sent,g.ULS.sendTraceTag(506852877,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: ".concat(_.Settings.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1))),!_.Settings.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)||!s||!1!==s.ok){t.next=23;break}return t.next=23,this.logGetItemFailureServerHeaders(r,n,u,s);case 23:if(clearTimeout(v),o.response=s,t.prev=25,!this.m_settings.shouldUpdateNewFileUrlFromSnap||o.errorCode!==f.ErrorCode.ServerErrorFileDownloadResourceInconsistent&&!o.newSnapUrl){t.next=34;break}if(g.ULS.sendTraceTag(508420449,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),!o.newSnapUrl){t.next=33;break}return o.errorCode===f.ErrorCode.ErrorRESERVEDSuccess&&g.ULS.sendTraceTag(508420448,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:got new snap url without errorcode"),g.ULS.sendTraceTag(508420447,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",o.newSnapUrl),t.abrupt("return",o);case 33:g.ULS.sendTraceTag(508420446,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response");case 34:t.next=39;break;case 36:t.prev=36,t.t0=t.catch(25),g.ULS.sendTraceTag(508420445,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent");case 39:return 200!==s.status&&o.errorCode===f.ErrorCode.ErrorRESERVEDSuccess&&(s.headers&&s.headers.get(h.PodsProxyConstants.ErrorCode)?(o[h.PodsProxyConstants.errorCode]=e.convertServerError(s.headers.get(h.PodsProxyConstants.ErrorCode),this.m_settings.enableServerSpecificErrorCode),o[h.PodsProxyConstants.errorCategory]=s.headers.get(h.PodsProxyConstants.ErrorCategory)?s.headers.get(h.PodsProxyConstants.ErrorCategory):f.ErrorCategory.BadRequest,o[h.PodsProxyConstants.IsIntentional]=!!s.headers.get(h.PodsProxyConstants.IsIntentional)&&s.headers.get(h.PodsProxyConstants.IsIntentional)):(s.status!==h.PodsProxyConstants.unknown&&this.m_errorMap.has(s.status)?o[h.PodsProxyConstants.errorCode]=this.m_errorMap.get(s.status):o[h.PodsProxyConstants.errorCode]=f.ErrorCode.ErrorRequestFailed,o[h.PodsProxyConstants.errorCategory]=f.ErrorCategory.Transient,o[h.PodsProxyConstants.IsIntentional]=!1)),y={functionName:r,status:s.status,statusText:s.statusText,headerCorrelation:s.headers?s.headers.get(h.PodsProxyConstants.XCorrelationId):"",headerErrorCode:s.headers?s.headers.get(h.PodsProxyConstants.ErrorCode):"",headerErrorCategory:s.headers?s.headers.get(h.PodsProxyConstants.ErrorCategory):"",headerErrorIntentional:!!s.headers&&s.headers.get(h.PodsProxyConstants.IsIntentional),requestCorrelation:n,resultErrorCode:o.errorCode,resultErrorCategory:o.errorCategory,resultIsIntentional:o.IsIntentional},g.ULS.sendTraceTag(595687002,g.LogCategory.msoulscat_Wac_PptSession,s.ok?g.TraceLevel.Info:g.TraceLevel.Error,JSON.stringify(y)),t.abrupt("return",o);case 43:case"end":return t.stop()}}),t,this,[[25,36]])}))),function(e,t){return P.apply(this,arguments)})},{key:"getSessionUtcAsync",value:(w=(0,c.default)(a.default.mark((function e(){var t,r,i,n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=-1,r=new AbortController,i=setTimeout((function(){return r.abort()}),2500),e.next=5,fetch("".concat(this.m_podsUrl,"/podhandler.ashx?action=GetSessionUTC&format=jsms"),{headers:new Headers,method:"GET",signal:r.signal}).catch(function(){var e=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.ULS.sendTraceTag(508420444,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getSessionUtcAsync - Error: ".concat(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(n=e.sent,clearTimeout(i),e.prev=7,!n){e.next=17;break}return e.t0=parseInt,e.next=12,n.text();case 12:e.t1=e.sent,t=(0,e.t0)(e.t1,10),g.ULS.sendTraceTag(508420443,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::getSessionUtcAsync: ".concat(t)),e.next=18;break;case 17:g.ULS.sendTraceTag(508420442,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getSessionUtcAsync - Null response.");case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(7),g.ULS.sendTraceTag(508420441,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::getSessionUtcAsync - error parsing response. ".concat(e.t2));case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,this,[[7,20]])}))),function(){return w.apply(this,arguments)})},{key:"updateDocSource",value:function(e){g.ULS.sendTraceTag(508420440,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:g.ULS.sendTraceTag(508420439,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:g.ULS.sendTraceTag(508420438,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}},{key:"generateSnapDownloadUrlAsync",value:(b=(0,c.default)(a.default.mark((function e(t,r){var i,n,o,s,l,u,d;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g.ULS.sendTraceTag(508420437,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ".concat(t.ID,".")),(i=new Headers).append(h.PodsProxyConstants.ContentType,"application/json; charset=utf-8"),i.append(h.PodsProxyConstants.CallerCorrelationId,t.ID),r&&r.forEach((function(e,t){i.append(t,e)})),n="".concat(this.m_podsUrl,"/SnapUrlHandler.ashx"),o=new AbortController,s=setTimeout((function(){return o.abort()}),this.m_settings.timeout),e.next=11,fetch(n,{headers:i,method:"POST",body:JSON.stringify(t),signal:o.signal}).catch(function(){var e=(0,c.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.ULS.sendTraceTag(508420436,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : ".concat(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:if(l=e.sent,clearTimeout(s),u="",!l){e.next=20;break}return e.next=17,l.json();case 17:d=e.sent,g.ULS.sendTraceTag(508420435,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:".concat(d.FSuccess,", ErrorCode:").concat(d.ErrorCode)),d.FSuccess?u=d.SnapUrl:g.ULS.sendTraceTag(508420434,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : ".concat(d.ErrorCode));case 20:return e.abrupt("return",u);case 23:return e.prev=23,e.t0=e.catch(0),g.ULS.sendTraceTag(508420433,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: ".concat(e.t0)),e.abrupt("return","");case 27:case"end":return e.stop()}}),e,this,[[0,23]])}))),function(e,t){return b.apply(this,arguments)})},{key:"setErrorMap",value:function(){for(var e=["cancelled","cancelado","","Abgebrochen","","","annul","","avbruten","","annullato","zrueno","poniteno","geannuleerd","","avbrutt","annulleret","",""," hu","Kumottu","dibatalkan","vazgeildi","anulat","anulowane","","visszavonva"],t=0;t<e.length;t+=1)this.m_errorMap.set(e[t],f.ErrorCode.ErrorRequestCanceled);for(var r=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexin de red se perdi","","La connexion rseau a t perdue","  ","","","   ","","Ntverksanslutningen frlorades","A conexo de rede foi perdida","A balants kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione  stata persa","A ligao  rede foi interrompida","Mistet nettverksforbindelsen","La conexin de red se ha perdido",""," mt kt ni mng","Kehilangan jaringan koneksi","   ","","  ","Verkkoyhteys katkesi","Netvrksforbindelsen gik tabt","Bylo ztraceno pipojen k sti","Poczenie sieciowe zostao utracone","A conexo  internet parece estar desativada","The Internet connection appears to be offline","La conexin a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de reea a fost pierdut","","  ","NetworkError when attempting to fetch resource","","No se ha podido establecer conexin con el servidor","Tidak dapat terhubung ke server","","No se pudo establecer conexin con el servidor","A hlzati kapcsolat megszakadt"],i=0;i<r.length;i+=1)this.m_errorMap.set(r[i],f.ErrorCode.ErrorConnectionLost);for(var n=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operacin. El software caus la anulacin de la conexin","Khng th hon tt tc v. Phn mm  khin kt ni b hy b","  .       ","   .    ","The operation couldnt be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","Lopration na pas pu sachever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operacin. El software caus la anulacin de la conexin","A operao no pde ser concluda. O software provocou o cancelamento da conexo","No se ha podido completar la operacin. El software ha causado la anulacin de la conexin","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","","",""," ","","Postupak se nije mogao dovriti. Softver je uzrokovao prekid veze","tgrden kunde inte slutfras. Program orsakade avbrott i anslutningen","lem tamamlanamad. Yazlm balantnn kesilmesine neden oldu","   .   "],a=0;a<n.length;a+=1)this.m_errorMap.set(n[a],f.ErrorCode.ErrorSoftwareConnectionAbort);for(var o=["The request timed out","","La requte a expir","","Se agot el tiempo de espera","Esgotou-se o tempo limite da solicitao",""],s=0;s<o.length;s+=1)this.m_errorMap.set(o[s],f.ErrorCode.ErrorRequestTimeout);for(var l=["cannot parse response","impossible danalyser la rponse",""],c=0;c<l.length;c+=1)this.m_errorMap.set(l[c],f.ErrorCode.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",f.ErrorCode.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",f.ErrorCode.ErrorFailedToFetch),this.m_errorMap.set(404,f.ErrorCode.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,f.ErrorCode.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,f.ErrorCode.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,f.ErrorCode.ErrorRequestFailedGatewayTimeout)}},{key:"getMappedError",value:function(t){var r=t;return(r=e.trimErrorName(r,["TypeError:","Loading failed:"])).indexOf("Bylo ztraceno")>=0?f.ErrorCode.ErrorConnectionLost:r.indexOf("AbortError:")>=0?f.ErrorCode.ErrorRequestAbort:this.m_errorMap.get(r)}},{key:"parseMultipartResponseAsync",value:(T=(0,c.default)(a.default.mark((function t(r,i,n){var o,l,u,d,m,v,S,T,b,C,w,P,I,k,E,x,L,A,M,R,O,D,F,B,N,V,U,W,G,H,j,z,q,Z,X,Y,J,K,Q,$,ee,te=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o={},l={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0},u={slideOrder:[],slideAllInfo:[]},i[h.PodsProxyConstants.firstResponseCheck]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},!(r.response&&r.response.body&&r.response.headers&&r.response.headers.get(h.PodsProxyConstants.ContentType))){t.next=104;break}d=r.response,m="",t.prev=7,i[h.PodsProxyConstants.fetchBoundary]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},m=this.m_multipartParser.fetchBoundary(d.headers.get(h.PodsProxyConstants.ContentType)),i[h.PodsProxyConstants.fetchBoundary].end=e.performanceNowTrimmed(),t.next=23;break;case 13:return t.prev=13,t.t0=t.catch(7),v=d.headers.get(h.PodsProxyConstants.ErrorCode),S=d.headers.get(h.PodsProxyConstants.ErrorCategory),T=!!r[h.PodsProxyConstants.IsIntentional]&&r[h.PodsProxyConstants.IsIntentional],b=d.headers.get(h.PodsProxyConstants.XCorrelationId),g.ULS.sendTraceTag(508420432,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ".concat(d.headers.get(h.PodsProxyConstants.ContentType),", ErrorCode:").concat(v,", ErrorCategory:").concat(S,", IsIntentional:").concat(T," , Correlation:").concat(b,", Exception:").concat(t.t0)),l.responseErrorCode=v||f.ErrorCode.ErrorRequestFailed,l.responseErrorCategory=S||f.ErrorCategory.BadRequest,t.abrupt("return",l);case 23:if(C=e.performanceNowTrimmed(),i[h.PodsProxyConstants.downloadResponse]={start:C,end:C},g.ULS.sendTraceTag(508420431,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::parseMultipartResponse - download response stream start: ".concat(C)),n&&n.requestType===h.PodsProxyRequestType.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:n.requestType,stageInfo:h.PodsProxyRequestStageType.DownloadResponseStream}),w=!1,P=void 0,I=null,E=d.headers?d.headers.get(h.PodsProxyConstants.ContentLength):-1,x=-1,g.ULS.sendTraceTag(508420430,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: ".concat(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)),!this.m_settings.parsingWhileDownloadingEnabled){t.next=61;break}return L=!1,A=!1,M=function(t){L=!0,A=t;var r={receivedDataLength:x,responseContentLength:E,duration:e.performanceNowTrimmed()-C,downloadFailed:A};g.ULS.sendTraceTag(508420429,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(r)));var a=e.performanceNowTrimmed();g.ULS.sendTraceTag(508420428,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(a,", duration: ").concat(a-C)),i[h.PodsProxyConstants.downloadResponse].end=a,i[h.PodsProxyConstants.downloadResponse].length=x,!w&&n&&n.requestType===h.PodsProxyRequestType.getItemsPresInfoAndSlideInfoAsync&&te.events.emit("requestStageChanged",{requestType:n.requestType,stageInfo:h.PodsProxyRequestStageType.ParseMultipartResponse})},x=0,R=d.body,O=R.tee(),D=(0,s.default)(O,2),F=D[0],B=D[1],N=new Promise(function(){var e=(0,c.default)(a.default.mark((function e(t){var r,i,n,o,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=_.Settings.readNumberOrDefault("hackMaxBytes",-1),i=F.getReader();case 3:return e.next=6,i.read();case 6:if(n=e.sent,o=n.done,s=n.value,!o){e.next=13;break}return M(!1),t(),e.abrupt("break",19);case 13:if(!s){e.next=17;break}if(x+=s.length,!(r>0&&x>r)){e.next=17;break}throw"hackMaxBytes hit";case 17:e.next=3;break;case 19:e.next=26;break;case 21:e.prev=21,e.t0=e.catch(0),g.ULS.sendTraceTag(508420427,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::measuringDownloadPromise - exception ".concat(e.t0,".")),M(!0),t();case 26:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t){return e.apply(this,arguments)}}()),n&&n.shouldTimeoutResponseStreamDownload&&(U=n&&n.overrideDownloadTimeoutMs?n.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,V=window.setTimeout((function(){L||(w=!0,g.ULS.sendTraceTag(508420426,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),g.ULS.sendTraceTag(508420425,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),F.cancel(),B.cancel())}),U)),W=new y.PartParser(this.m_settings,o,i,l),G=this.m_multipartParser.processMultipartBinaryResponse(B.getReader(),m,(function(e){W.parsePart(e)})),t.next=46,Promise.all([N,G]);case 46:if(!A){t.next=50;break}return p.ChangeGate.isChangeGateEnabled("retryOnNetworkFailure")&&(l.responseErrorCode=f.ErrorCode.ErrorRequestFailed,l.responseErrorCategory=f.ErrorCategory.Transient),l.data=void 0,t.abrupt("return",l);case 50:if(n&&n.shouldTimeoutResponseStreamDownload&&(clearTimeout(V),g.ULS.sendTraceTag(508420424,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:w,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:x,responseContentLength:E})))),!w){t.next=58;break}if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&E>0&&x>0&&E===x)){t.next=56;break}g.ULS.sendTraceTag(508420423,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),t.next=58;break;case 56:return l.responseErrorCode=f.ErrorCode.ErrorDownloadResponseStreamTimeout,t.abrupt("return",l);case 58:u=W.parsedResponse,t.next=102;break;case 61:if(!n||!n.shouldTimeoutResponseStreamDownload){t.next=74;break}return H=n&&n.overrideDownloadTimeoutMs?n.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,j="downloadResponseStreamTimeout",q=new Promise((function(e){P=setTimeout((function(){g.ULS.sendTraceTag(508420422,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),z&&(g.ULS.sendTraceTag(508420421,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),z.cancel()),e(j)}),H)})),z=d.body.getReader(),(I=this.readResponseStream(z,E)).then((function(t){var r={receivedDataLength:x=t&&t.length||-1,responseContentLength:E,duration:e.performanceNowTrimmed()-C};g.ULS.sendTraceTag(508420420,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(r)))})),t.next=70,Promise.race([I,q]);case 70:(k=t.sent)===j?w=!0:void 0!==P&&clearTimeout(P),t.next=81;break;case 74:return t.t1=Uint8Array,t.next=77,d.arrayBuffer();case 77:t.t2=t.sent,k=new t.t1(t.t2),(Z=_.Settings.readNumberOrDefault("hackMaxBytes",-1))>0&&k.length>Z&&(k=k.slice(0,Z));case 81:if(n&&n.shouldTimeoutResponseStreamDownload&&g.ULS.sendTraceTag(508420419,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:w,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:x,responseContentLength:E}))),!w){t.next=92;break}if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&I&&E>0&&x>0&&E===x)){t.next=90;break}return g.ULS.sendTraceTag(508420418,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),t.next=87,I;case 87:k=t.sent,t.next=92;break;case 90:return l.responseErrorCode=f.ErrorCode.ErrorDownloadResponseStreamTimeout,t.abrupt("return",l);case 92:return X=e.performanceNowTrimmed(),g.ULS.sendTraceTag(508420417,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(X,", duration: ").concat(X-C)),Y=k,i[h.PodsProxyConstants.downloadResponse].end=X,Y&&Y.length&&(i[h.PodsProxyConstants.downloadResponse].length=Y.length),n&&n.requestType===h.PodsProxyRequestType.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:n.requestType,stageInfo:h.PodsProxyRequestStageType.ParseMultipartResponse}),J=new y.PartParser(this.m_settings,o,i,l),t.next=101,this.m_multipartParser.processMultipartBinaryResponse(Y,m,(function(e){J.parsePart(e)}));case 101:u=J.parsedResponse;case 102:t.next=110;break;case 104:K=r.hasOwnProperty(h.PodsProxyConstants.errorCode)&&r[h.PodsProxyConstants.errorCode]!==f.ErrorCode.ErrorRESERVEDSuccess?r[h.PodsProxyConstants.errorCode]:f.ErrorCode.ErrorRequestFailed,Q=r[h.PodsProxyConstants.errorCategory]?r[h.PodsProxyConstants.errorCategory]:f.ErrorCategory.BadRequest,$=!!r[h.PodsProxyConstants.IsIntentional]&&r[h.PodsProxyConstants.IsIntentional],l.responseErrorCode=K,l.responseErrorCategory=Q,g.ULS.sendTraceTag(508420416,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::parseMultipartResponse - responseErrorCode:".concat(K,", responseErrorCategory:").concat(Q,", IsIntentional:").concat($));case 110:for(ee in i[h.PodsProxyConstants.firstResponseCheck].end=e.performanceNowTrimmed(),l.responseErrorCode!==f.ErrorCode.ErrorRESERVEDSuccess&&l.responseErrorCategory===f.ErrorCategory.ErrorRESERVEDSuccess&&(l.responseErrorCategory=f.ErrorCategory.BadRequest,g.ULS.sendTraceTag(508420387,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:".concat(l.responseErrorCode))),o)u.slideAllInfo.push({ID:o[ee].ID,SlideImageData:o[ee].SlideImageData,SlideShowInfo:o[ee].SlideShowInfo,Title:o[ee].Title,NoteHtml:o[ee].NoteHtml,Comments:o[ee].Comments,HasAnimation:o[ee].HasAnimation,Hidden:o[ee].Hidden,HasTransition:o[ee].HasTransition,ResourceData:o[ee].ResourceData,AccessibilityModel:o[ee].AccessibilityModel,MediaUrls:o[ee].MediaUrls});if(t.prev=113,!_.Settings.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)||!(l.itemErrorCodeMap&&Object.values(l.itemErrorCodeMap).includes(f.ErrorCode.ServerErrorFileDownloadResourceInconsistent)||l.newSnapUrl)){t.next=121;break}if(!l.newSnapUrl){t.next=120;break}return 0===l.itemErrorCodeMap.size&&g.ULS.sendTraceTag(508420386,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:got new snap url without errorcode"),g.ULS.sendTraceTag(508420385,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",l.newSnapUrl),t.abrupt("return",l);case 120:g.ULS.sendTraceTag(508420384,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response");case 121:t.next=126;break;case 123:t.prev=123,t.t3=t.catch(113),g.ULS.sendTraceTag(508420383,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent");case 126:return l.data=u,t.abrupt("return",l);case 128:case"end":return t.stop()}}),t,this,[[7,13],[113,123]])}))),function(e,t,r){return T.apply(this,arguments)})},{key:"readResponseStream",value:(l=(0,c.default)(a.default.mark((function e(t,r){var i,n,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Uint8Array(0),e.prev=1,e.next=4,t.read();case 4:n=e.sent;case 5:if(n.done){e.next=20;break}if(i=new Uint8Array([].concat((0,o.default)(i),(0,o.default)(n.value))),!((s=_.Settings.readNumberOrDefault("hackMaxBytes",-1))>0&&i.length>s)){e.next=11;break}throw i=i.slice(0,s),"hackMaxBytes hit";case 11:if(!(r>0&&i.length===r)){e.next=15;break}if(g.ULS.sendTraceTag(508420382,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"PodsProxy::readResponseStream - received length reached content length: ".concat(r)),!this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength){e.next=15;break}return e.abrupt("break",20);case 15:return e.next=17,t.read();case 17:n=e.sent,e.next=5;break;case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(1),g.ULS.sendTraceTag(508420381,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Error,"PodsProxy::readResponseStream - exception ".concat(e.t0,".")),e.abrupt("return",new Uint8Array(0));case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,this,[[1,22]])}))),function(e,t){return l.apply(this,arguments)})},{key:"generateReportPerfDictionary",value:function(e){var t={};return e[h.PodsProxyConstants.action]&&(t[h.PodsProxyConstants.action]=e[h.PodsProxyConstants.action]),e[h.PodsProxyConstants.correlationId]&&(t[h.PodsProxyConstants.correlationId]=e[h.PodsProxyConstants.correlationId]),e[h.PodsProxyConstants.server]&&(t[h.PodsProxyConstants.server]=e[h.PodsProxyConstants.server]),e[h.PodsProxyConstants.parser]&&(t[h.PodsProxyConstants.parser]=e[h.PodsProxyConstants.parser]),e[h.PodsProxyConstants.downloadResponse]&&(t[h.PodsProxyConstants.downloadResponse]=e[h.PodsProxyConstants.downloadResponse]),e[h.PodsProxyConstants.usedOutputCache]&&(t[h.PodsProxyConstants.usedOutputCache]=e[h.PodsProxyConstants.usedOutputCache]),e[h.PodsProxyConstants.contentLength]&&(t[h.PodsProxyConstants.contentLength]=e[h.PodsProxyConstants.contentLength]),t}},{key:"createPresInfoAndSlideInfoResponse",value:function(t,r){var i=(f.ErrorCode.ErrorRESERVEDSuccess,f.ErrorCategory.ErrorRESERVEDSuccess);return r[h.PodsProxyConstants.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},i={itemErrorCodeMap:t.itemErrorCodeMap,itemErrorCategoryMap:t.itemErrorCategoryMap,responseErrorCode:t.responseErrorCode,responseErrorCategory:t.responseErrorCategory,responseIsIntentional:!1,presInfo:t.data&&t.data.slideAllInfo&&t.data.slideAllInfo.length>0?t.data.slideAllInfo[0]:void 0,slideInfo:t.data&&t.data.slideAllInfo?t.data.slideAllInfo.slice(1):[],usedOutputCache:t.usedOutputCache,itemUsedOutputCacheMap:t.itemUsedOutputCacheMap},r[h.PodsProxyConstants.createResponse].end=e.performanceNowTrimmed(),i}},{key:"createSlideInfoResponse",value:(n=(0,c.default)(a.default.mark((function t(r,i){var n;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]},i[h.PodsProxyConstants.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},t.next=4,r.then((function(e){n={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}));case 4:return i[h.PodsProxyConstants.createResponse].end=e.performanceNowTrimmed(),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"createSlideIdResponse",value:(i=(0,c.default)(a.default.mark((function e(t){var r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]},e.next=3,t.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"createPresInfoResponse",value:(r=(0,c.default)(a.default.mark((function e(t){var r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0},e.next=3,t.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"createSlideOrderAndSlidesInfoIndexResponse",value:(t=(0,c.default)(a.default.mark((function e(t){var r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:f.ErrorCategory.ErrorRESERVEDSuccess,responseErrorCode:f.ErrorCode.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},e.next=3,t.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"setTimeoutForParsingResponse",value:function(e){return window.setTimeout((function(){g.ULS.sendTraceTag(508420380,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Warning,"Parsing didn't finish in the time. ".concat(JSON.stringify(e)))}),this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}},{key:"objectDictionaryToRequestIdString",value:function(e){var t="";for(var r in e)e[r]&&(t="".concat(t).concat(r,"=").concat(e[r],";"));return t}}],[{key:"getFieldFromReponseHeader",value:function(e,t){return e.headers?e.headers.get(t):h.PodsProxyConstants.unknown}},{key:"trimErrorName",value:function(e,t){for(var r=e,i=0;i<t.length;i+=1)r.lastIndexOf(t[i])>=0&&(r=r.substring(r.lastIndexOf(t[i])+t[i].length));return r?r.trim():""}},{key:"convertServerError",value:function(e,t){return t&&e&&""!==e.trim()&&e!==h.PodsProxyConstants.unknown?"Server".concat(e):f.ErrorCode.ErrorRequestFailed}},{key:"logPerf",value:function(e){}},{key:"ensureISlideInfoFilters",value:function(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}},{key:"logPerformanceEntries",value:function(e,t){var r,i={},n=S(e.getEntriesByType("resource"));try{for(n.s();!(r=n.n()).done;){var a=r.value;if("fetch"===a.initiatorType){var o,s=!1,l=S(t);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(a.name.indexOf(c)>0||a.name.startsWith(c)){s=!0;break}}}catch(e){l.e(e)}finally{l.f()}if(s){if(i.name=a.name,i.dateTime=performance.now(),p.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){var u=new URL(a.name);i.hostname=u.hostname,i.pathname=u.pathname}i.start=a.startTime,i.redirectStart=a.redirectStart,i.redirectEnd=a.redirectEnd,i.domainLookupStart=a.domainLookupStart,i.domainLookupEnd=a.domainLookupEnd,i.tcpHandshakeStart=a.connectStart,i.tcpHandshakeEnd=a.connectEnd,i.secureConnectionStart=a.secureConnectionStart,i.responseStart=a.responseStart,i.responseEnd=a.responseEnd,i.fetchStart=a.fetchStart,i.requestStart=a.requestStart,"decodedBodySize"in a&&(i.decodedBodySize=a.decodedBodySize),"encodedBodySize"in a&&(i.encodedBodySize=a.encodedBodySize),"transferSize"in a&&(i.transferSize=a.transferSize),Object.keys(i).length>0&&g.ULS.sendTraceTag(572379986,g.LogCategory.msoulscat_Wac_PptSession,g.TraceLevel.Info,"".concat(JSON.stringify(i)))}}}}catch(e){n.e(e)}finally{n.f()}}}]);var t,r,i,n,l,T,b,w,P,I,k,E,x,L,A,M,R,O,D}();t.PodsProxy=P,(n=P).s_events=new v.EventEmitter,n.s_supportedImageType=[f.ItemType.ImagePng,f.ItemType.ImageJpg]},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MultipartParser=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2));function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var u=function(){return(0,s.default)((function e(){(0,o.default)(this,e)}),[{key:"processMultipartResponse",value:(t=(0,a.default)(n.default.mark((function e(t,r,i){var a,o,s=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw"multipartContentBuffer is empty";case 2:try{a=new TextDecoder("utf-8").decode(t),this.parseMultipart(a,r).forEach((function(e){var t=s.parseResponsePart(e);i(t)}))}catch(e){o={Err:new Error(e)},i(o)}case 3:case"end":return e.stop()}}),e,this)}))),function(e,r,i){return t.apply(this,arguments)})},{key:"fetchBoundary",value:function(e){var t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}},{key:"processMultipartBinaryResponse",value:(e=(0,a.default)(n.default.mark((function e(t,r,i){var a,o,s,c,u,d,h,f,m,p,g,v,y,_,S,T,b,C,w,P,I;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw"multipartContentBufferOrStream is empty";case 2:a="",o=void 0,s=0,c=[],u=null,h=t instanceof Uint8Array,e.prev=8;case 9:if(!h){e.next=14;break}d=t,e.next=22;break;case 14:return e.next=16,t.read();case 16:if(f=e.sent,m=f.done,p=f.value,!m){e.next=21;break}return e.abrupt("break",28);case 21:d=p;case 22:g=l(d);try{for(g.s();!(v=g.n()).done;)y=v.value,_=10===y||13===y,S=10===y&&13===u,T=10===u&&13===y,c.push(y),_||(a+=String.fromCharCode(y)),0===s&&S?"--".concat(r)===a&&(s=1,a="",c=[]):1===s&&T?(o=new Uint8Array(c),s=2,a="",c=[]):2===s&&S?(s=3,a="",c=[]):3===s&&(a.length>r.length+4&&(a=""),"--".concat(r)===a&&(b=c.length-a.length,C=c.slice(0,b-1),s=1,w=this.processHeader(o),P={Headers:w,Body:new Uint8Array(C)},i(P),a="",o=void 0,c=[]),S&&(a="")),u=y}catch(e){g.e(e)}finally{g.f()}if(!h){e.next=26;break}return e.abrupt("break",28);case 26:e.next=9;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(8),I={Err:new Error(e.t0)},i(I);case 34:case"end":return e.stop()}}),e,this,[[8,30]])}))),function(t,r,i){return e.apply(this,arguments)})},{key:"parseMultipart",value:function(e,t){var r="--".concat(t);return e.split(r).map((function(e){return e.trim()})).filter((function(e){return""!==e&&"--"!==e}))}},{key:"parseResponsePart",value:function(e){var t=this.parseResponseHeaderFromPart(e).split("\n"),r=new Map;t.forEach((function(e){var t=e.split(": ");2===t.length&&r.set(t[0],t[1])}));var i=this.parseResponseBodyFromPart(e),n=(new TextEncoder).encode(i);return{Headers:r,Body:n}}},{key:"parseResponseBodyFromPart",value:function(e){var t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}},{key:"parseResponseHeaderFromPart",value:function(e){var t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}},{key:"processHeader",value:function(e){var t=new Map;if(e){for(var r="",i=0;i<e.byteLength;i+=1)r+=String.fromCharCode(e[i]);r.split("\n").forEach((function(e){var r=e.split(": ");2===r.length&&t.set(r[0],r[1])}))}return t}}]);var e,t}();t.MultipartParser=u},function(e,t,r){},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PartParser=void 0;var n=i(r(19)),a=i(r(1)),o=i(r(2)),s=r(3),l=r(11),c=r(78);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var h=function(){function e(t,r,i,n){(0,a.default)(this,e),this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=t,this.m_responses=r,this.m_perfDictionary=i,this.m_parsedBasedResponse=n}return(0,o.default)(e,[{key:"parsePart",value:function(t){if(t&&t.Headers){this.m_perfDictionary[c.PodsProxyConstants.parserCallback]?(this.m_perfDictionary[c.PodsProxyConstants.parserCallback].callCounter=this.m_perfDictionary[c.PodsProxyConstants.parserCallback].callCounter+1,this.m_perfDictionary[c.PodsProxyConstants.parserCallback].lastCallStart=c.PodsProxy.performanceNowTrimmed()):this.m_perfDictionary[c.PodsProxyConstants.parserCallback]={lastCallStart:c.PodsProxy.performanceNowTrimmed(),lastCallEnd:c.PodsProxy.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};var r=t.Headers.get(c.PodsProxyConstants.ContentDisposition),i=t.Headers.get(c.PodsProxyConstants.ContentType);this.m_parsedBasedResponse.usedOutputCache=t.Headers.get(c.PodsProxyConstants.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=t.Headers.get(c.PodsProxyConstants.Xnewsnapurl);var a=t.Headers.get(c.PodsProxyConstants.ErrorCode)||c.ErrorCode.ErrorRESERVEDSuccess,o=t.Headers.get(c.PodsProxyConstants.ErrorCategory)||c.ErrorCategory.ErrorRESERVEDSuccess,d=t.Headers.get(c.PodsProxyConstants.XusedOutputCache);if(r){var h,f=r.indexOf("pres%2fSlideMetadatasldIdx")>0;try{h=decodeURIComponent(r.substring(r.indexOf("name=")+5).trim())}catch(e){s.ULS.sendTraceTag(595641600,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(e))}if(h){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(h,a),this.m_parsedBasedResponse.itemErrorCategoryMap.set(h,o),d&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(h,d),a&&a.trim().toLowerCase()===c.ErrorCode.ErrorRESERVEDSuccess.toLowerCase())if(r.indexOf("presinfo%2fslimSlideOrder")>0){var m,p=u(JSON.parse(new TextDecoder("utf-8").decode(t.Body)));try{for(p.s();!(m=p.n()).done;){var g=m.value;this.parsedResponse.slideOrder.push({sid:g,cid:0})}}catch(e){p.e(e)}finally{p.f()}}else if(r.indexOf("presinfo%2fmetadata")>0){var v,y=JSON.parse(new TextDecoder("utf-8").decode(t.Body)),_=[],S=[],T=u(y.SidSlideOrder);try{for(T.s();!(v=T.n()).done;){var b=v.value;_.push({sid:b,cid:0})}}catch(e){T.e(e)}finally{T.f()}if(y.SidHiddenSlides){var C,w=u(y.SidHiddenSlides);try{for(w.s();!(C=w.n()).done;){var P=C.value;S.push({sid:P,cid:0})}}catch(e){w.e(e)}finally{w.f()}}var I={Item:null};y.SlideShowProperties.Item||(I={Item:null}),y.SlideShowProperties.Item.s?I={Item:{sid:y.SlideShowProperties.Item.s}}:y.SlideShowProperties.Item.st&&(I={Item:{start:y.SlideShowProperties.Item.st,end:y.SlideShowProperties.Item.end}});var k={SlideOrder:_,HiddenSlideOrder:S,SlideEmuWidth:y.SlideEmuWidth,SlideEmuHeight:y.SlideEmuHeight,ViewScalingFactor:y.ViewScalingFactor,SlideShowProperties:I,Sections:y.Sections};this.parsedResponse.slideAllInfo.push(k)}else if((r.indexOf("pres%2fsldSid")>0||r.indexOf("pres%2fsldIdx")>0)&&i&&e.getSupportedImageType(i)){for(var E=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),x="",L=0;L<t.Body.length;L+=1)x+=String.fromCharCode(t.Body[L]);var A="data:".concat(e.getSupportedImageType(i),";base64, ").concat(btoa(x));this.m_perfDictionary[c.PodsProxyConstants.parserCallback].slidesHaveImages.push(E),this.m_responses[E]||(this.m_responses[E]={ID:{sid:E,cid:0}}),this.m_responses[E].SlideImageData=A}else if((r.indexOf("pres%2fsldSid")>0||r.indexOf("pres%2fsldIdx")>0)&&i&&-1!==i.indexOf("application/json")){var M=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),R=JSON.parse(new TextDecoder("utf-8").decode(t.Body));l.ChangeGate.isChangeGateEnabled("PodsProxy.getItemsMediaResourceMapping")&&R.mediaUrls?(this.m_responses[M]||(this.m_responses[M]={ID:{sid:R.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[M].SlideShowInfo=R.slideShowInfo,this.m_responses[M].MediaUrls=R.mediaUrls):(this.m_responses[M]||(this.m_responses[M]={ID:{sid:R.sld[0].id,cid:0}}),this.m_responses[M].SlideShowInfo=R)}else if(r.indexOf("pres%2fNotesSldSid")>0||r.indexOf("pres%2fNotesSldIdx")>0){var O=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),D=new TextDecoder("utf-8").decode(t.Body);this.m_responses[O]||(this.m_responses[O]={ID:{sid:O,cid:0}}),this.m_responses[O].NoteHtml=D}else if(r.indexOf("pres%2fCommentsSldSid")>0||r.indexOf("pres%2fCommentsSldIdx")>0){var F=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),B=JSON.parse(new TextDecoder("utf-8").decode(t.Body));this.m_responses[F]||(this.m_responses[F]={ID:{sid:F,cid:0}}),this.m_responses[F].Comments=B}else if(r.indexOf("pres%2fSlideMetadataSldSid")>0||f){var N=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),V=JSON.parse(new TextDecoder("utf-8").decode(t.Body));this.m_responses[N]||(this.m_responses[N]={ID:V.ID}),this.m_responses[N].Title=V.Title,this.m_responses[N].HasAnimation=V.HasAnimation,this.m_responses[N].Hidden=V.Hidden,this.m_responses[N].HasTransition=V.HasTransition}else if(r.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||r.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){var U=e.getSlideKeyFromHeader(r,r.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),W=JSON.parse(new TextDecoder("utf-8").decode(t.Body));this.m_responses[U]||(this.m_responses[U]={ID:W.ID}),this.m_responses[U].AccessibilityModel=W.AccessibilityModel}else if(r.indexOf("Res%2fSldSid")>0&&i&&e.getSupportedImageType(i)){var G=e.extractStringInBetweenStrings(r,"Res%2fSldSid","%2f"),H=e.extractStringInBetweenStrings(r,"filename=","\r");if(G&&H){var j,z,q={sid:+G,cid:0},Z=e.getSupportedImageType(i);if(t.Body)if(this.m_settings.allowImagesAsBinary)j={Id:H,Base64:"",Binary:t.Body,MimeType:Z,ByteCount:t.Body.length};else{for(var X="",Y=0;Y<t.Body.length;Y+=1)X+=String.fromCharCode(t.Body[Y]);var J="data:".concat(Z,";base64,").concat(btoa(X));j={Id:H,Base64:J,MimeType:Z,ByteCount:J.length}}else s.ULS.sendTraceTag(508420494,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"PodsProxy::parseMultipartResponse - Body is undefined. slideId:".concat(G,", resourceId:").concat(H)),j={Id:H,Base64:"",MimeType:Z,ByteCount:0};this.m_perfDictionary[c.PodsProxyConstants.parserCallback].slidesHaveImageResources.push(q.sid);for(var K=0,Q=Object.entries(this.m_responses);K<Q.length;K++){var $=(0,n.default)(Q[K],2)[1];$.ID&&$.ID.sid===q.sid&&(z=$)}z?z.ResourceData?z.ResourceData.push(j):z.ResourceData=[j]:this.m_responses[q.sid]={ID:q,ResourceData:[j]}}else s.ULS.sendTraceTag(595628568,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:".concat(G,", resourceId:").concat(H)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorCode.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorCode.ErrorItemNameNotValid}else t.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(t.Headers.get("x-ms-content-id"),a),this.m_parsedBasedResponse.itemErrorCategoryMap.set(t.Headers.get("x-ms-content-id"),o)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorCode.ErrorContentDispositionHeaderNotValid;this.m_perfDictionary[c.PodsProxyConstants.parserCallback].lastCallEnd=c.PodsProxy.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorCode.ErrorResponseNotValid;t.Err&&(this.m_parsedBasedResponse.responseErrorCode=c.ErrorCode.ErrorResponseNotValid,s.ULS.sendTraceTag(595687003,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(t.Err)))}}],[{key:"getSupportedImageType",value:function(e){return c.PodsProxy.s_supportedImageType.find((function(t){return-1!==e.indexOf(t)}))||""}},{key:"getSlideKeyFromHeader",value:function(e,t){var r=new RegExp(".*".concat(t,"(.*)"));if(!e)return s.ULS.sendTraceTag(508420493,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;var i=r.exec(e);return null!=i&&i.length>=2?+i[1]:(s.ULS.sendTraceTag(508420492,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Error,"PodsProxy::getSlideLocationFromHeader - regex result is null header:".concat(e,", itemId: ").concat(t)),-1)}},{key:"extractStringInBetweenStrings",value:function(e,t,r){var i=e.indexOf(t)+t.length,n=r?e.indexOf(r,i):-1;return-1===n?e.substring(i):e.substring(i,n)}}])}();t.PartParser=h},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShowInkAddon=void 0;var n=i(r(1)),a=i(r(2)),o=r(189),s=r(3),l=r(196),c=(0,a.default)((function e(t,r,i,a,l){var c=this;(0,n.default)(this,e),this.m_defaultLaserColor="#E3182D",this.inkAddonCore=new o.SlideShowInkAddonCore(t,r,i,a,this.initInk.bind(this),this.slideChanged.bind(this),(function(){return!0})),l&&l.telemetryLogger&&(this.telemetryLogger=l.telemetryLogger),window.addEventListener("pointerover",(function e(t){"pen"===t.pointerType&&(window.removeEventListener("pointerover",e),c.inkAddonCore.m_inkCanvas||(c.inkAddonCore.metricHelper.boot(o.InkBootSource.Pen),c.startDownloadingInkJs(c.inkAddonCore.onDownloadCompleted),s.ULS.sendTraceTag(593827279,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: Ink initialization triggered by pointerover.")))}))}),[{key:"onInkManagerActivity",value:function(e){switch(e.item){case"Init":this.inkAddonCore.m_inkCanvas||(this.inkAddonCore.metricHelper.boot(o.InkBootSource.Menu),this.startDownloadingInkJs(this.inkAddonCore.onDownloadCompleted),s.ULS.sendTraceTag(593827280,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: Ink initialization triggered by ink button."));break;case"Pen":this.selectPen(e.color);break;case"Highlighter":this.selectHighlighter(e.color);break;case"Eraser":this.inkAddonCore.selectEraser();break;case"None":this.inkAddonCore.selectNone();break;case"EraseAll":this.inkAddonCore.eraseAll();break;case"SetColor":this.setColor(e.color);break;case"Laser":this.selectLaser()}}},{key:"setColor",value:function(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.setColor(e),s.ULS.sendTraceTag(593827281,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: setColor called with color: ".concat(e)))}},{key:"selectPen",value:function(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectPen(),s.ULS.sendTraceTag(593827282,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: selectPen called with color: ".concat(e)))}},{key:"selectHighlighter",value:function(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectHighlighter(),s.ULS.sendTraceTag(593827283,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: selectHighlighter called with color: ".concat(e)))}},{key:"selectLaser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.m_defaultLaserColor;this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setLaserColor(e),this.inkAddonCore.m_inkCanvas.selectLaser(),s.ULS.sendTraceTag(520229444,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: selectLaser called"))}},{key:"startDownloadingInkJs",value:function(e){var t=this;if(null!=window.slideshowink)return s.ULS.sendTraceTag(593827286,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: slideshowink.js is loaded to the window, no download needed."),this.inkAddonCore.updateDimensions(),void this.initInk();this.inkAddonCore.isInkJsDownloading||(s.ULS.sendTraceTag(593827287,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: Start downloading slideshowink.js"),this.inkAddonCore.isInkJsDownloading=!0,this.inkAddonCore.loadInkJsCallback().then((function(){e()})).catch((function(e){t.inkAddonCore.onDownloadFailed(e)})))}},{key:"resetInkCanvas",value:function(){return this.inkAddonCore.resetInkCanvas()}},{key:"initInk",value:function(){if(!this.inkAddonCore.m_inkCanvas){try{slideshowink.inkCanvasFactoryGlobal.setLogger(new o.InkLogger),this.telemetryLogger&&slideshowink.inkCanvasFactoryGlobal.setActivityLogger(new l.InkActivityLogger({telemetryLogger:this.telemetryLogger}));var e=slideshowink.inkCanvasFactoryGlobal.createSlideShowInkCanvasSmoothed(this.inkAddonCore.inkContainer,this.inkAddonCore.parent);this.inkAddonCore.isShowingBlankSlide||e.start(),this.inkAddonCore.m_inkCanvas=e}catch(e){s.ULS.sendTraceTag(593827290,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"SlideShowInkAddon: inkCanvas initialization error: ".concat(JSON.stringify(e)))}s.ULS.sendTraceTag(593827291,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: inkCanvas initialized."),this.inkAddonCore.registerAppEventListeners();var t=this.inkAddonCore.slideshowCore.getSlideLocation();t&&this.slideChanged(t),this.inkAddonCore.updateInkCanvasDimensions(),window.removeEventListener("pointerdown",this.inkAddonCore.onPointerDown),s.ULS.sendTraceTag(593827292,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"SlideShowInkAddon: inkCanvas initialization from: ".concat(this.inkAddonCore.metricHelper.getSource().toString()," in time: ").concat(this.inkAddonCore.metricHelper.timeDiff()," with lost stroke count: ").concat(this.inkAddonCore.metricHelper.getLostStrokeCount()))}}},{key:"slideChanged",value:function(e){this.inkAddonCore.m_inkCanvas&&this.inkAddonCore.m_inkCanvas.slideChanged(e.slideIndex)}}]);t.SlideShowInkAddon=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInkCanvasContainerDiv=function(){var e=document.createElement("div");return e.className="SlideShowCoreInkCanvasContainer",e.style.position="absolute",e.style.pointerEvents="none",e.style.zIndex="10",e.style.overflow="hidden",e}},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateViewingAddon=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(3),c=r(198),u=r(82),d=r(192),h=r(121),f=r(199),m=r(193),p=r(4),g=function(){return(0,s.default)((function e(t,r,i,s,d,f,p,g,v,y,_){var S=this;(0,o.default)(this,e),this.m_privateViewingEnabled=!1,this.m_isUserPrivatelyZooming=!1,l.ULS.setLogger(s),this.m_slideshowCore=t,this.m_slideShowAppEvents=r,this.m_slideshowRole=i,this.m_slideShowUIEvents=v,this.m_globalAppStateManager=y,f&&g||l.ULS.sendTraceTag(556017049,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"PrivateViewingAddon - No initial slide location given"),this.m_localState=m.SyncUtil.toSyncState({slideId:p,slideIndex:g},f),this.m_globalState=_||this.m_localState;var T={goToSyncState:this.goToSyncState.bind(this),isInPrivateViewingChanged:this.isInPrivateViewingChanged.bind(this,h.PrivateViewingEnterSource.SyncStateManager),isInPrivateViewing:this.isInPrivateViewing.bind(this),hadPreviousUserInput:this.hadPreviousUserInput.bind(this),getGlobalState:this.getGlobalState.bind(this),areSyncStatesEqual:m.SyncUtil.areSyncStatesEqual.bind(this)};this.m_clockSkewCalculator=d,this.m_privateViewingManager=new c.PrivateViewingManager,this.m_privateViewingManager.init({loggableFeatureName:"PPT_SSApp"},T,s),this.registerSlideShowUIEvents(),this.m_slideShowAppEvents.on("slideLocationChanged",(function(){S.localStateChanged("slideLocationChanged")})),this.m_slideShowAppEvents.on("animationStateChanged",(function(){S.localStateChanged("animationStateChanged")})),this.m_slideShowAppEvents.on("requestPrivateViewingChanged",(function(e){S.m_privateViewingEnabled&&S.isInPrivateViewingChanged(e.source,e.isInPrivateViewing)})),this.m_slideShowAppEvents.on("globalStateChanged",function(){var e=(0,a.default)(n.default.mark((function e(t){var r,i,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return l.ULS.sendTraceTag(554958872,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PrivateViewingAddon - globalStateChanged called but wasn't passed in any args"),e.abrupt("return");case 3:if(S.m_slideshowRole===u.SlideShowRole.Presenter){e.next=15;break}if(r=t[0],i=2===t.length?t[1]:void 0,a=m.SyncUtil.toSyncState(r,i),S.m_globalState=a,!S.m_privateViewingEnabled){e.next=14;break}return e.next=11,S.m_privateViewingManager.globalStateChanged(S.m_globalState);case 11:S.m_slideShowUIEvents&&r.slideIndex&&S.m_slideShowUIEvents.emit("presenterSlideStateChanged",r.slideIndex),e.next=15;break;case 14:l.ULS.sendTraceTag(537536651,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PrivateViewingAddon - private viewing is not enabled");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.m_slideShowAppEvents.on("returnToPresenter",(function(){S.returnToPresenter()})),this.m_slideShowAppEvents.on("isUserPrivatelyZooming",(function(e){S.m_isUserPrivatelyZooming=e}))}),[{key:"getGlobalState",value:function(){return this.m_globalState}},{key:"localStateChanged",value:function(e){var t=this.m_slideshowCore.getSlideLocation(),r=this.m_slideshowCore.getAnimationState(!0);if(t){r||l.ULS.sendTraceTag(555874514,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PrivateViewingAddon - No animationState was returned from getAnimationState but recieved event animationStateChanged");var i=m.SyncUtil.toSyncState(t,r);this.m_slideshowRole===u.SlideShowRole.Presenter?this.m_globalState=i:(this.m_privateViewingEnabled||this.m_slideshowRole===u.SlideShowRole.PrivateViewing)&&(this.m_localState&&"slideLocationChanged"===e&&t.slideIndex===m.SyncUtil.syncStateToSlideLocation(this.m_localState).slideIndex?l.ULS.sendTraceTag(554206281,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PrivateViewingAddon - slideLocationChanged event fired even when slideIndex not changed; slideIndex: ".concat(t.slideIndex,";")):this.m_privateViewingManager.localStateChanged(i,e)),this.m_localState=i,this.saveLocalStateToAppStateManager()}else l.ULS.sendTraceTag(556102994,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PrivateViewingAddon - No slideLocation was returned from getSlideLocation but recieved event slideLocationChanged")}},{key:"returnToPresenter",value:function(){if(this.m_localState){if(d.AppSessionTeamsLoggingHelper.trackTeamsPVMetrics({action:"returnToPresenter",slideIndex:m.SyncUtil.syncStateToSlideLocation(this.m_globalState).slideIndex},this.m_clockSkewCalculator.sessionUTC),p.Settings.readBooleanOrDefault("allowUserToPrivatelyZoom",!1)&&!this.isInPrivateViewing()&&this.m_isUserPrivatelyZooming)return;this.m_privateViewingManager.returnToPresenter(this.m_localState)}else l.ULS.sendTraceTag(553784714,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PrivateViewingAddon - returnToPresenter called with undefined m_localState.")}},{key:"onPrivateViewingToggled",value:function(e){this.m_privateViewingEnabled!==e?(this.m_privateViewingEnabled=e,l.ULS.sendTraceTag(537536652,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"PrivateViewingAddon - private viewing toggled to ".concat(e?"enabled":"disabled")),e||this.m_slideshowRole!==u.SlideShowRole.PrivateViewing||this.returnToPresenter()):l.ULS.sendTraceTag(545337759,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PrivateViewingAddon - private viewing toggle value did not change. It is still ".concat(e?"enabled":"disabled"))}},{key:"goToSyncState",value:(e=(0,a.default)(n.default.mark((function e(t){var r,i,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_slideshowRole!==u.SlideShowRole.Presenter){e.next=3;break}return l.ULS.sendTraceTag(556102995,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Warning,"PrivateViewingAddon - gotoSyncState was called by a presenter. SyncState = ".concat(JSON.stringify(t),".")),e.abrupt("return");case 3:return r=m.SyncUtil.syncStateToSlideLocation(t),i={animationState:m.SyncUtil.syncStateToAnimationState(t),fForceRetry:!0},e.next=7,this.m_slideshowCore.gotoSlide(r,i);case 7:(a=e.sent)&&a.fSucceeded?(this.m_localState=t,this.syncMediaStates(r.slideId,r.slideIndex),l.ULS.sendTraceTag(554055433,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"PrivateViewingAddon - gotoSlide succeeded. SyncState = ".concat(JSON.stringify(t),"."))):l.ULS.sendTraceTag(554771489,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Error,"PrivateViewingAddon - gotoSlide failed with error ".concat(a.error,". SyncState = ").concat(JSON.stringify(t),"."));case 9:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"hadPreviousUserInput",value:function(e){var t=!0;return"slideLocationChanged"!==e&&"animationStateChanged"!==e||(t=d.AppSessionTeamsLoggingHelper.hadPreviousUserInput(this.m_clockSkewCalculator.sessionUTC),l.ULS.sendTraceTag(554055434,l.LogCategory.msoulscat_Wac_PptSlideshow,l.TraceLevel.Info,"PrivateViewingAddon - hadPreviousUserInput: ".concat(t,"."))),t}},{key:"isInPrivateViewing",value:function(){return this.m_slideshowRole===u.SlideShowRole.PrivateViewing}},{key:"isPresenting",value:function(){return this.m_slideshowRole===u.SlideShowRole.Presenter}},{key:"isInPrivateViewingChanged",value:function(e,t){var r=!1,i=this.m_slideshowRole;if(this.m_slideshowRole===u.SlideShowRole.Attendee&&t)this.m_slideShowAppEvents.emit("roleChanged",u.SlideShowRole.PrivateViewing),this.m_slideShowAppEvents.emit("roleChangedOutbound",u.SlideShowRole.PrivateViewing),r=!0,d.AppSessionTeamsLoggingHelper.trackTeamsPVMetrics({action:"enterPrivateViewing",source:e},this.m_clockSkewCalculator.sessionUTC);else if(this.m_slideshowRole===u.SlideShowRole.PrivateViewing&&!t){this.m_slideShowAppEvents.emit("roleChanged",u.SlideShowRole.Attendee),this.m_slideShowAppEvents.emit("roleChangedOutbound",u.SlideShowRole.Attendee);var n=this.m_slideshowCore.getSlideLocation();n&&n.slideId&&this.syncMediaStates(n.slideId,n.slideIndex),r=!0,d.AppSessionTeamsLoggingHelper.trackTeamsPVMetrics({action:"leavePrivateViewing"},this.m_clockSkewCalculator.sessionUTC)}l.ULS.sendTraceTag(556910745,l.LogCategory.msoulscat_Wac_PptSlideshow,r?l.TraceLevel.Info:l.TraceLevel.Error,"PrivateViewingAddon - privateViewingChangedTo: ".concat(t?"true":"false",". Successful: ").concat(r?"true":"false",". Role before was: ").concat(i,". Source: ").concat(e))}},{key:"syncMediaStates",value:function(e,t){this.m_slideShowAppEvents.emit("returnToPresenterUpdateAllMedia",{slideId:e,slideIndex:t})}},{key:"registerSlideShowUIEvents",value:function(){var e=this;this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.on("setPrivateViewingToggle",(function(t){e.onPrivateViewingToggled(t)})),this.m_slideShowUIEvents.on("privateViewingToggled",(function(t){e.onPrivateViewingToggled(t)})),this.m_slideShowUIEvents.on("roleChanged",(function(t){t===u.SlideShowRole.Presenter&&(e.m_privateViewingManager.resetPrivateViewingManager(),e.m_slideshowRole===u.SlideShowRole.PrivateViewing&&d.AppSessionTeamsLoggingHelper.trackTeamsPVMetrics({action:"leavePrivateViewing"},e.m_clockSkewCalculator.sessionUTC)),e.m_slideshowRole=t,e.saveLocalStateToAppStateManager()})))}},{key:"saveLocalStateToAppStateManager",value:function(){if(this.m_localState){var e={role:this.m_slideshowRole,currentSyncState:m.SyncUtil.syncStateToSlideLocation(this.m_localState),currentAnimationState:m.SyncUtil.syncStateToAnimationState(this.m_localState),globalSyncState:m.SyncUtil.syncStateToSlideLocation(this.m_globalState),globalAnimationState:m.SyncUtil.syncStateToAnimationState(this.m_globalState)};this.m_globalAppStateManager&&this.m_globalAppStateManager.updateGlobalState(f.PPTLiveAppComponent.PrivateViewingAddon,e)}}},{key:"slideShowUIEvents",get:function(){return this.m_slideShowUIEvents},set:function(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}}]);var e}();t.PrivateViewingAddon=g},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateViewingManager=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=i(r(5)),c=r(3),u=r(26),d=function(){return(0,s.default)((function e(){(0,o.default)(this,e),(0,l.default)(this,"m_loggableFeatureName",""),(0,l.default)(this,"m_syncStateManager",void 0),(0,l.default)(this,"m_logger",void 0),(0,l.default)(this,"m_events",new u.EventEmitter),(0,l.default)(this,"m_pendingSyncStateChangeRequests",[]),(0,l.default)(this,"m_attemptingToExitPrivateViewing",!1)}),[{key:"on",value:function(e,t){return this.m_events.on(e,t),this}},{key:"init",value:function(e,t,r){this.m_loggableFeatureName=e.loggableFeatureName||"",this.m_syncStateManager=t,this.m_logger=r,this.m_attemptingToExitPrivateViewing=!1,console.log(c.ULS,c.ULS.setLogger),c.ULS.setLogger(this.m_logger),c.ULS.sendTraceTag(507004830,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: initialized for feature:".concat(this.m_loggableFeatureName,"."))}},{key:"localStateChanged",value:function(e,t){var r=this;if(!this.m_syncStateManager)throw c.ULS.sendTraceTag(507004829,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");var i=this.m_syncStateManager.getGlobalState();this.m_syncStateManager.isInPrivateViewing()&&this.m_attemptingToExitPrivateViewing?this.m_syncStateManager.areSyncStatesEqual(e,i,!0)?(c.ULS.sendTraceTag(507004828,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: localStateChanged exit private viewing. newState: ".concat(JSON.stringify(e),". globalState: ").concat(JSON.stringify(i))),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1)):c.ULS.sendTraceTag(507004827,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Warning,"PrivateViewingManager: trying to exit private viewing to the wrong syncState. newState: ".concat(JSON.stringify(e),". globalState: ").concat(JSON.stringify(i))):this.m_pendingSyncStateChangeRequests.some((function(t){var i;return null===(i=r.m_syncStateManager)||void 0===i?void 0:i.areSyncStatesEqual(t,e,!0)}))?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex((function(t){var i;return null===(i=r.m_syncStateManager)||void 0===i?void 0:i.areSyncStatesEqual(t,e,!0)}))+1),c.ULS.sendTraceTag(507004826,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: localStateChanged found request in array. newState: ".concat(JSON.stringify(e),". globalState: ").concat(JSON.stringify(i)))):this.m_syncStateManager.isInPrivateViewing()||this.m_syncStateManager.areSyncStatesEqual(i,e)||this.m_attemptingToExitPrivateViewing||(this.m_syncStateManager.hadPreviousUserInput(t)?(c.ULS.sendTraceTag(507004825,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: localStateChanged enter private viewing. newState: ".concat(JSON.stringify(e),". globalState: ").concat(JSON.stringify(i))),this.m_syncStateManager.isInPrivateViewingChanged(!0)):(c.ULS.sendTraceTag(507004824,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: localStateChanged unintentional private viewing. Trying to put user back in sync. newState: ".concat(JSON.stringify(e),". globalState: ").concat(JSON.stringify(i))),this.m_syncStateManager.goToSyncState(i)))}},{key:"globalStateChanged",value:(t=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_pendingSyncStateChangeRequests.push(t),this.m_syncStateManager){e.next=4;break}throw c.ULS.sendTraceTag(507004823,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");case 4:if(!this.m_syncStateManager.isInPrivateViewing()||!this.m_attemptingToExitPrivateViewing){e.next=8;break}return c.ULS.sendTraceTag(507004822,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: globalStateChanged while user is in private viewing and trying to exit private viewing. NewSyncState: ".concat(JSON.stringify(t))),e.next=8,this.m_syncStateManager.goToSyncState(t);case 8:c.ULS.sendTraceTag(507004821,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: globalStateChanged. NewSyncState: ".concat(JSON.stringify(t),". State requests: ").concat(JSON.stringify(this.m_pendingSyncStateChangeRequests)));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"resetPrivateViewingManager",value:function(){this.m_attemptingToExitPrivateViewing=!1,this.m_pendingSyncStateChangeRequests=[],c.ULS.sendTraceTag(507004820,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: reset PrivateViewingManager")}},{key:"returnToPresenter",value:(e=(0,a.default)(n.default.mark((function e(t){var r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.m_syncStateManager){e.next=3;break}throw c.ULS.sendTraceTag(507004819,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Error,"PrivateViewingManager.localStateChanged m_syncStateManager is null"),new Error("PrivateViewingManager.localStateChanged m_syncStateManager is null");case 3:if(this.m_syncStateManager.isInPrivateViewing()){e.next=6;break}return c.ULS.sendTraceTag(507004818,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Error,"PrivateViewingManager: tried to returnToPresenter but is not in private viewing"),e.abrupt("return");case 6:if(this.m_attemptingToExitPrivateViewing=!0,r=this.m_syncStateManager.getGlobalState(),!this.m_syncStateManager.areSyncStatesEqual(t,r)){e.next=14;break}c.ULS.sendTraceTag(507004817,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: returnToPresenter localState == globalState, so exit private viewing."),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1),e.next=17;break;case 14:return c.ULS.sendTraceTag(507004816,c.LogCategory.msoulscat_Wac_PptLive,c.TraceLevel.Info,"PrivateViewingManager: returnToPresenter navigating to ".concat(JSON.stringify(r))),e.next=17,this.m_syncStateManager.goToSyncState(r);case 17:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e,t}();t.PrivateViewingManager=d},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.PresenterSyncStateManager=void 0;var n=i(r(1)),a=i(r(2)),o=i(r(5)),s=r(3),l=(0,a.default)((function e(t,r,i){(0,n.default)(this,e),(0,o.default)(this,"m_logger",void 0),(0,o.default)(this,"m_loggableFeatureName",void 0),(0,o.default)(this,"m_pendingSyncStateChangeRequests",[]),(0,o.default)(this,"m_syncStateManager",void 0),this.m_logger=i,this.m_loggableFeatureName=t.loggableFeatureName||"",this.m_syncStateManager=r,s.ULS.setLogger(this.m_logger),s.ULS.sendTraceTag(507004834,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,"PresenterSyncStateManager: initialized for feature:".concat(this.m_loggableFeatureName,"."))}),[{key:"recordInboundSyncEvent",value:function(e){this.m_pendingSyncStateChangeRequests.push(e),s.ULS.sendTraceTag(507004833,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,"PresenterSyncStateManager: recordInboundSyncEvent. NewSyncState: ".concat(JSON.stringify(e),". State requests: ").concat(JSON.stringify(this.m_pendingSyncStateChangeRequests)))}},{key:"shouldBroadcastOutboundSyncEvent",value:function(e){var t=this;return this.m_pendingSyncStateChangeRequests.some((function(r){return t.m_syncStateManager.areSyncStatesEqual(r,e,!0)}))?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex((function(r){return t.m_syncStateManager.areSyncStatesEqual(r,e,!0)}))+1),s.ULS.sendTraceTag(507004832,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,"PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent FALSE. newSyncState: ".concat(JSON.stringify(e),". State requests: ").concat(JSON.stringify(this.m_pendingSyncStateChangeRequests))),!1):(s.ULS.sendTraceTag(507004831,s.LogCategory.msoulscat_Wac_PptLive,s.TraceLevel.Info,"PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent TRUE. newSyncState: ".concat(JSON.stringify(e),". State requests: ").concat(JSON.stringify(this.m_pendingSyncStateChangeRequests))),!0)}},{key:"resetPendingSyncEvents",value:function(){this.m_pendingSyncStateChangeRequests=[]}}]);t.PresenterSyncStateManager=l},function(e,t,r){var i=r(68),n=r(69),a=r(56).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,n.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,r,i){return 0===e?t&r|~t&i:2===e?t&r|t&i|r&i:t^r^i}i(l,n),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,a=0|this._c,s=0|this._d,l=0|this._e,d=0;d<16;++d)r[d]=e.readInt32BE(4*d);for(;d<80;++d)r[d]=r[d-3]^r[d-8]^r[d-14]^r[d-16];for(var h=0;h<80;++h){var f=~~(h/20),m=0|((t=i)<<5|t>>>27)+u(f,n,a,s)+l+r[h]+o[f];l=s,s=a,a=c(n),n=i,i=m}this._a=i+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,r){"use strict";(function(e){var i=r(435),n=r(436),a=r(437);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,r)}function c(e,t,r,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t),e}(e,t,r,i):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(t,r),n=(e=s(e,i)).write(t,r);return n!==i&&(e=e.slice(0,n)),e}(e,t,r):function(e,t){if(l.isBuffer(t)){var r=0|f(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):h(e,t);if("Buffer"===t.type&&a(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|f(t.length);e=s(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(e).length;default:if(i)return U(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return E(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function v(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:y(e,t,r,i,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,i,n){var a,o=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n){var u=-1;for(a=r;a<s;a++)if(c(e,a)===c(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===l)return u*o}else-1!==u&&(a-=a-u),u=-1}else for(r+l>s&&(r=s-l),a=r;a>=0;a--){for(var d=!0,h=0;h<l;h++)if(c(e,a+h)!==c(t,h)){d=!1;break}if(d)return a}return-1}function _(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[r+o]=s}return o}function S(e,t,r,i){return G(U(t,e.length-r),e,r,i)}function T(e,t,r,i){return G(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function b(e,t,r,i){return T(e,t,r,i)}function C(e,t,r,i){return G(W(t),e,r,i)}function w(e,t,r,i){return G(function(e,t){for(var r,i,n,a=[],o=0;o<e.length&&!((t-=2)<0);++o)i=(r=e.charCodeAt(o))>>8,n=r%256,a.push(n),a.push(i);return a}(t,e.length-r),e,r,i)}function P(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var a,o,s,l,c=e[n],u=null,d=c>239?4:c>223?3:c>191?2:1;if(n+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(a=e[n+1]))&&(l=(31&c)<<6|63&a)>127&&(u=l);break;case 3:a=e[n+1],o=e[n+2],128==(192&a)&&128==(192&o)&&(l=(15&c)<<12|(63&a)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=e[n+1],o=e[n+2],s=e[n+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}function k(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function E(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function x(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",a=t;a<r;++a)n+=V(e[a]);return n}function L(e,t,r){for(var i=e.slice(t,r),n="",a=0;a<i.length;a+=2)n+=String.fromCharCode(i[a]+256*i[a+1]);return n}function A(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,i,n,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function R(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,a=Math.min(e.length-r,2);n<a;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function O(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,a=Math.min(e.length-r,4);n<a;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function D(e,t,r,i,n,a){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,i,a){return a||D(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function B(e,t,r,i,a){return a||D(e,0,r,8),n.write(e,t,r,i,52,8),r+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return c(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,r){return function(e,t,r,i){return u(t),t<=0?s(e,t):void 0!==r?"string"==typeof i?s(e,t).fill(r,i):s(e,t).fill(r):s(e,t)}(null,e,t,r)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=l.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var o=e[r];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):p.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,i,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(n>>>=0)-(i>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(a,o),c=this.slice(i,n),u=e.slice(t,r),d=0;d<s;++d)if(c[d]!==u[d]){a=c[d],o=u[d];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},l.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":return T(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return C(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var r,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;r=new l(n,void 0);for(var a=0;a<n;++a)r[a]=this[a+e]}return r},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=t,n=1,a=this[e+--i];i>0&&(n*=256);)a+=this[e+--i]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,i){e=+e,t|=0,r|=0,i||M(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,a=0;for(this[t]=255&e;++a<r&&(n*=256);)this[t+a]=e/n&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,i){e=+e,t|=0,r|=0,i||M(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,a=1;for(this[t+n]=255&e;--n>=0&&(a*=256);)this[t+n]=e/a&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}var a=0,o=1,s=0;for(this[t]=255&e;++a<r&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}var a=r-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n,a=i-r;if(this===e&&r<t&&t<i)for(n=a-1;n>=0;--n)e[n+t]=this[n+r];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<a;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},l.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=l.isBuffer(e)?e:U(new l(e,i).toString()),s=o.length;for(a=0;a<r-t;++a)this[a+t]=o[a%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var r;t=t||1/0;for(var i=e.length,n=null,a=[],o=0;o<i;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function W(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}}).call(this,r(57))},function(e,t,r){"use strict";t.byteLength=function(e){var t=c(e),r=t[0],i=t[1];return 3*(r+i)/4-i},t.toByteArray=function(e){var t,r,i=c(e),o=i[0],s=i[1],l=new a(function(e,t,r){return 3*(t+r)/4-r}(0,o,s)),u=0,d=s>0?o-4:o;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,a=[],o=0,s=r-n;o<s;o+=16383)a.push(u(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),a.join("")};for(var i=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)i[s]=o[s],n[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var n,a,o=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(i[(a=n)>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,i,n){var a,o,s=8*n-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?n-1:0,h=r?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-u)-1,f>>=-u,u+=s;u>0;a=256*a+e[t+d],d+=h,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=i;u>0;o=256*o+e[t+d],d+=h,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),a-=c}return(f?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,r,i,n,a){var o,s,l,c=8*a-n-1,u=(1<<c)-1,d=u>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,m=i?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(s=0,o=u):o+d>=1?(s=(t*l-1)*Math.pow(2,n),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;e[r+f]=255&s,f+=m,s/=256,n-=8);for(o=o<<n|s,c+=n;c>0;e[r+f]=255&o,f+=m,o/=256,c-=8);e[r+f-m]|=128*p}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){var i=r(68),n=r(69),a=r(56).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,n.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function d(e,t,r,i){return 0===e?t&r|~t&i:2===e?t&r|t&i|r&i:t^r^i}i(l,n),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,r=this._w,i=0|this._a,n=0|this._b,a=0|this._c,s=0|this._d,l=0|this._e,h=0;h<16;++h)r[h]=e.readInt32BE(4*h);for(;h<80;++h)r[h]=(t=r[h-3]^r[h-8]^r[h-14]^r[h-16])<<1|t>>>31;for(var f=0;f<80;++f){var m=~~(f/20),p=c(i)+d(m,n,a,s)+l+r[f]+o[m]|0;l=s,s=a,a=u(n),n=i,i=p}this._a=i+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,r){var i=r(68),n=r(190),a=r(69),o=r(56).Buffer,s=new Array(64);function l(){this.init(),this._w=s,a.call(this,64,56)}i(l,n),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=o.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},function(e,t,r){var i=r(68),n=r(191),a=r(69),o=r(56).Buffer,s=new Array(160);function l(){this.init(),this._w=s,a.call(this,128,112)}i(l,n),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=o.allocUnsafe(48);function t(t,r,i){e.writeInt32BE(t,i),e.writeInt32BE(r,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageHelper=t.PPTLiveLocalStorageCaller=void 0;var n,a=i(r(1)),o=i(r(2)),s=r(3);t.PPTLiveLocalStorageCaller=n,function(e){e.PPTSharingResumeSlideShow="PPTSharingResumeSlideShowObject",e.PPTLiveGlobalAppState="PPTLiveGlobalAppStateObject"}(n||(t.PPTLiveLocalStorageCaller=n={}));var l=function(){function e(t){(0,a.default)(this,e),this.m_logger=t}return(0,o.default)(e,[{key:"clearEntryFromLocalStorage",value:function(e){try{localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){this.m_logger.sendTraceTag(507102941,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"LocalStorageHelper:clearEntryFromLocalStorage - error while trying to clear previous call state: ".concat(e))}}},{key:"writeToLocalStorage",value:function(e,t){try{this.m_logger.sendTraceTag(507102940,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LocalStorageHelper: Writing to localStorage for localStorageCaller: ".concat(e)),localStorage.setItem(e,JSON.stringify(t)),this.m_logger.sendTraceTag(507102939,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"LocalStorageHelper:Saved to local storage for : ".concat(e))}catch(e){this.m_logger.sendTraceTag(507102938,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"LocalStorageHelper: Error when saving State: ".concat(e))}}},{key:"readFromLocalStorage",value:function(e){try{var t=localStorage.getItem(e);if(t)return t}catch(e){this.m_logger.sendTraceTag(507102937,s.LogCategory.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"LocalStorageHelper: Error when reading from local storage: ".concat(e))}return""}}],[{key:"getCurrentInstance",value:function(t){return this.m_localStorageHelper||(this.m_localStorageHelper=new e(t)),this.m_localStorageHelper}}])}();t.LocalStorageHelper=l},function(e,t,r){"use strict";var i=r(0);Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserMediaStreamAccessor=void 0;var n=i(r(6)),a=i(r(7)),o=i(r(1)),s=i(r(2)),l=r(95);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var d=function(){return(0,s.default)((function e(){(0,o.default)(this,e)}),[{key:"startMediaCaptureAsync",value:(e=(0,a.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:t.deviceId,width:t.width,height:t.height,frameRate:t.frameRate},audio:!1});case 2:return this.mediaStream=e.sent,e.abrupt("return",this.streamInitializationStatus());case 4:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){if(this.mediaStream){var e,t=c(this.mediaStream.getTracks());try{for(t.s();!(e=t.n()).done;)e.value.stop()}catch(e){t.e(e)}finally{t.f()}this.mediaStream=void 0}}},{key:"stream",get:function(){return this.mediaStream}},{key:"pauseMediaCapture",value:function(){this.setMediaEnabled(!1)}},{key:"resumeMediaCapture",value:function(){this.setMediaEnabled(!0)}},{key:"setMediaEnabled",value:function(e){if(this.mediaStream){var t,r=c(this.mediaStream.getTracks());try{for(r.s();!(t=r.n()).done;)t.value.enabled=e}catch(e){r.e(e)}finally{r.f()}}}},{key:"streamInitializationStatus",value:function(){return this.mediaStream?0===this.mediaStream.getVideoTracks().length?l.MediaStreamError.ErrorNoVideoTracks:l.MediaStreamError.ErrorNone:l.MediaStreamError.ErrorStreamStartFailure}}]);var e}();t.BrowserMediaStreamAccessor=d}])}));
//# sourceMappingURL=SlideShowCore.js.map