var $jscomp={scope:{},getGlobal:function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(b,e){($jscomp.patches[b]=$jscomp.patches[b]||[]).push(e);for(var d=$jscomp.global,a=b.split("."),c=0;c<a.length-1&&d;c++)d=d[a[c]];a=a[a.length-1];d&&d[a]instanceof Function&&(d[a]=e(d[a]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var b=[],e=function(d){return function(a){b=[];a=d(a);for(var c=[],l=0,f=a.length;l<f;l++){var g;a:if(g=a[l],g.length<$jscomp.SYMBOL_PREFIX.length)g=!1;else{for(var h=0;h<$jscomp.SYMBOL_PREFIX.length;h++)if(g[h]!=$jscomp.SYMBOL_PREFIX[h]){g=!1;break a}g=!0}g?b.push(a[l]):c.push(a[l])}return c}};$jscomp.patch("Object.keys",e);$jscomp.patch("Object.getOwnPropertyNames",e);$jscomp.patch("Object.getOwnPropertySymbols",
function(d){return function(a){e.unused=Object.getOwnPropertyNames(a);b.push.apply(d(a));return b}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+b+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
function getLogger(b,e){var d=new bUlsCache(b,e);return{ULS:{trace:function(a,c,b){return traceTagImpl(d,0,a,c,b)},traceTag:function(a,c,b,f){return traceTagImpl(d,a,c,b,f)},flush:d.flush,flushOnClose:d.flushOnClose}}}function getExperimentLogger(b,e,d,a){var c=new bUlsCache(b,e);return c.configure(d,a),{ULS:{trace:function(a,b,g){return traceTagImpl(c,0,a,b,g)},traceTag:function(a,b,g,h){return traceTagImpl(c,a,b,g,h)},flush:c.flush,flushOnClose:c.flushOnClose}}}
function traceTagImpl(b,e,d,a,c){a>currentLevel||(e={timestamp:Date.now(),category:d,tag:e,level:a,type:logType.Trace,message:c},b.handleTrace(e))}function formatForUpload(b,e,d,a){b=b.map(function(c){return getLogEntryInWireFormat(c,a)});e=getLogBatchInWireFormat(a,b,e,d);return JSON.stringify(e)}function getLogEntryInWireFormat(b,e){var d={},a;return d.G=b.tag,d.T=b.timestamp-e,d.M=b.message,d.C=b.category,a=b.type*shiftFactory+b.level,d.D=a,d}
function getLogBatchInWireFormat(b,e,d,a){var c={};return c.T=b,c.L=e,c.S=d,c.I=a,c.V=1,c}function uploadLogs(b,e,d){if(""!==e){var a=new XMLHttpRequest;a.readyState!==XMLHttpRequest.UNSENT&&a.readyState!==XMLHttpRequest.DONE||(a.open("POST",e,d),a.send(b))}}var logLevel,ULS,currentLevel,bUlsCache,shiftFactory,logCategory,logType,PowerPointOnline;(function(b){b[b.Spam=200]="Spam";b[b.Verbose=100]="Verbose";b[b.Info=50]="Info";b[b.Warning=15]="Warning";b[b.Error=10]="Error"})(logLevel||(logLevel={}));
ULS={getLogger:getLogger,getExperimentLogger:getExperimentLogger};currentLevel=logLevel.Info;
bUlsCache=function(){function b(b,d){var a=this;this.uploadCadenceInMsSec=3E4;this.uploadTriggerSize=30;this.uploadId=0;this.logCache=[];this.timestampBase=Date.now();this.userSessionId="00000000-0000-0000-0000-000000000000";this.flushOnClose=function(){a.triggerUpload(!1,!1)};this.flush=function(){a.triggerUploadAsync()};this.triggerUploadAsync=function(){window.setTimeout(function(){return a.triggerUpload(!0,!0)},0)};this.triggerUpload=function(c,b){if(window.clearTimeout(a.timeoutId),0<a.logCache.length){a.uploadId+=
1;var f=formatForUpload(a.logCache,a.userSessionId,a.uploadId,a.timestampBase);uploadLogs(f,a.remoteUrlEndpoint,b);a.logCache=[];a.timestampBase=Date.now()}c&&(a.timeoutId=window.setTimeout(a.triggerUploadAsync,a.uploadCadenceInMsSec))};this.userSessionId=b;this.remoteUrlEndpoint=d+"?usid="+b;window.setTimeout(function(){return a.triggerUpload(!0,!0)},0)}return b.prototype.configure=function(b,d){this.uploadCadenceInMsSec=b;this.uploadTriggerSize=d},b.prototype.handleTrace=function(e){e.message.length>
b.messageMaxChars&&(e.message=e.message.substr(0,b.messageMaxChars-b.trimedMessage.length)+b.trimedMessage);this.logCache.push(e);(this.logCache.length>this.uploadTriggerSize||e.level===logLevel.Error)&&this.triggerUploadAsync()},b.messageMaxChars=3072,b.trimedMessage="... [Trimmed]",b}();shiftFactory=1E3;
(function(b){b[b.WordViewer=301]="WordViewer";b[b.WopiPendingApplication=379]="WopiPendingApplication";b[b.VisioApp=700]="VisioApp";b[b.PptNavigation=810]="PptNavigation";b[b.PptSession=817]="PptSession";b[b.PptVersionHistory=832]="PptVersionHistory";b[b.PptLive=833]="PptLive"})(logCategory||(logCategory={}));(function(b){b[b.Trace=0]="Trace";b[b.Assert=1]="Assert"})(logType||(logType={}));
(function(b){(function(b){var d=function(){function a(){}return a.prototype.trace=function(c,a,b){this.traceTag(0,c,a,b)},a.prototype.traceTag=function(c,a,b,g){switch(b){case logLevel.Verbose:c=console.debug;break;case logLevel.Info:c=console.log;break;case logLevel.Warning:case logLevel.Error:c=console.error;break;default:c=console.error}c(g)},a}();b.ConsoleSessionLogger=d;d=function(){function a(c,a){try{this.logger=ULS.getLogger(c,a+"RemoteUls.ashx")}catch(b){}}return a.prototype.trace=function(c,
a,b){null!=this.logger&&this.logger.ULS.trace(c,a,b)},a.prototype.traceTag=function(c,a,b,g){null!=this.logger&&this.logger.ULS.traceTag(c,a,b,g)},a.prototype.flush=function(){null!=this.logger&&this.logger.ULS.flush()},a.prototype.flushOnClose=function(){null!=this.logger&&this.logger.ULS.flushOnClose()},a}();b.UlsSessionLogger=d;d=function(){function a(){}return a.init=function(c){this.logger=c},a.trace=function(c,a,b){null!=this.logger&&this.logger.trace(c,a,b)},a.traceTag=function(c,a,b,g){null!=
this.logger&&this.logger.traceTag(c,a,b,g)},a}();b.SessionLogger=d})(b.Telemetry||(b.Telemetry={}))})(PowerPointOnline||(PowerPointOnline={}));"use strict";
var __assign=this&&this.__assign||function(){__assign=Object.assign||function(b){for(var e,d=1,a=arguments.length;d<a;d++){e=arguments[d];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(b[c]=e[c])}return b};return __assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(b,e,d,a){return new (d||(d=Promise))(function(c,l){function f(c){try{h(a.next(c))}catch(b){l(b)}}function g(c){try{h(a["throw"](c))}catch(b){l(b)}}function h(a){a.done?c(a.value):(new d(function(c){c(a.value)})).then(f,
g)}h((a=a.apply(b,e||[])).next())})},__generator=this&&this.__generator||function(b,e){function d(c){return function(b){return a([c,b])}}function a(a){if(l)throw new TypeError("Generator is already executing.");for(;c;)try{if(l=1,f&&(g=a[0]&2?f["return"]:a[0]?f["throw"]||((g=f["return"])&&g.call(f),0):f.next)&&!(g=g.call(f,a[1])).done)return g;if(f=0,g)a=[a[0]&2,g.value];switch(a[0]){case 0:case 1:g=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;f=a[1];a=[0];continue;case 7:a=
c.ops.pop();c.trys.pop();continue;default:if(!(g=c.trys,g=0<g.length&&g[g.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!g||a[1]>g[0]&&a[1]<g[3]))c.label=a[1];else if(6===a[0]&&c.label<g[1])c.label=g[1],g=a;else if(g&&c.label<g[2])c.label=g[2],c.ops.push(a);else{g[2]&&c.ops.pop();c.trys.pop();continue}}a=e.call(b,c)}catch(h){a=[6,h],f=0}finally{l=g=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],
ops:[]},l,f,g,h;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return h={next:d(0),"throw":d(1),"return":d(2)},"function"===typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},Microsoft;
(function(b){(function(b){(function(b){(function(a){var c=function(){function a(){}a.FindIndex=function(a,c){for(var b=0;b<a.length;b++)if(c(a[b]))return b;return-1};return a}();a.Utils=c})(b.PowerPoint||(b.PowerPoint={}))})(b.WebClient||(b.WebClient={}))})(b.Office||(b.Office={}))})(Microsoft||(Microsoft={}));
(function(b){(function(b){(function(b){(function(a){var c=function(){function a(){}a.format=function(a){for(var c=[],b=1;b<arguments.length;b++)c[b-1]=arguments[b];try{return a.replace(/{(\d+(.)?)}/g,function(a,b){return"undefined"!=c[b]&&null!=c[b]?c[b]:""})}catch(l){return""}};return a}();a.StringUtil=c})(b.PowerPoint||(b.PowerPoint={}))})(b.WebClient||(b.WebClient={}))})(b.Office||(b.Office={}))})(Microsoft||(Microsoft={}));var PowerPointVersionHistory;
(function(b){var e=function(){function b(){}b.DevicePixelRatio=function(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1};b.generateRandomHexChar=function(){try{var a=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(a),Math.floor(a[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(a),Math.floor(a[0]/16).toString(16)):Math.floor(16*
Math.random()).toString(16)}catch(c){return"0"}};b.randomValueHex=function(a){if(1>a)return"";for(var c="",l=0;l<a;l++)c+=b.generateRandomHexChar();return c};b.randomUUID=function(){return"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,b.generateRandomHexChar)};return b}();b.BrowserUtils=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){(function(b){var d=function(){function a(){}a.prototype.trace=function(a,b,f){this.traceTag(0,a,b,f)};a.prototype.traceTag=function(a,b,f,g){switch(f){case logLevel.Verbose:a=console.debug;break;case logLevel.Info:a=console.log;break;case logLevel.Warning:case logLevel.Error:a=console.error;break;default:a=console.error}a(g)};return a}();b.ConsoleSessionLogger=d;d=function(){function a(a,b){try{this.logger=ULS.getLogger(a,b+"RemoteUls.ashx")}catch(f){}}a.prototype.trace=function(a,b,
f){null!=this.logger&&this.logger.ULS.trace(a,b,f)};a.prototype.traceTag=function(a,b,f,g){null!=this.logger&&this.logger.ULS.traceTag(a,b,f,g)};a.prototype.flush=function(){null!=this.logger&&this.logger.ULS.flush()};a.prototype.flushOnClose=function(){null!=this.logger&&this.logger.ULS.flushOnClose()};return a}();b.UlsSessionLogger=d;d=function(){function a(){}a.init=function(a){this.logger=a};a.trace=function(a,b,f){null!=this.logger&&this.logger.trace(a,b,f)};a.traceTag=function(a,b,f,g){null!=
this.logger&&this.logger.traceTag(a,b,f,g)};return a}();b.SessionLogger=d})(b.VersionHistory||(b.VersionHistory={}))})(Microsoft||(Microsoft={}));
(function(b){(function(b){var d;(function(a){a.GetDownloadTokenStart="GetDownloadTokenStart";a.GetDownloadTokenEnd="GetDownloadTokenEnd";a.ShowVersionHistoryDialog="ShowVersionHistoryDialog";a.LoadTipVersionStart="LoadTipVersionStart";a.LoadTipVersionEnd="LoadTipVersionEnd";a.LoadVersionListStart="LoadVersionListStart";a.LoadVersionListEnd="LoadVersionListEnd";a.LoadVersionListRetry="LoadVersionListRetry";a.LoadVersionListFailure="LoadVersionListFailure";a.OnVersionSelectStart="OnVersionSelectStart";
a.OnVersionSelectEnd="OnVersionSelectEnd";a.OnVersionSelectFailure="OnVersionSelectFailure";a.LoadVersionHistoryList="LoadVersionHistoryList";a.LoadInitPresInfo="LoadInitPresInfo";a.CreateDocControllerWithSnap="CreateDocControllerWithSnap";a.CreateDocControllerWithVHS="CreateDocControllerWithVHS";a.DrawSlidePaneImage="DrawSlidePaneImage";a.DrawSlideNotes="DrawSlideNotes";a.DrawSlideContentEnd="DrawSlideContentEnd";a.VisibleThumbnails="VisibleThumbnails";a.NavigableSlides="NavigableSlides";a.SelectThumbnail=
"SelectThumbnail";a.SyncCorrelationId="SyncCorrelationId"})(d=b.PLTEventType||(b.PLTEventType={}));var a=function(){function a(){}Object.defineProperty(a,"appTelemetryDictionary",{set:function(b){a._appTelemetryDictionary=b},enumerable:!0,configurable:!0});a.addAppPLTEventToLog=function(b){a._appTelemetryDictionary[b]=Date.now().toString()};a.addDocPLTEventToLog=function(b,f,g){try{a.setValueForDocPLTEvent(b,f,Date.now().toString()),f===d.OnVersionSelectEnd?a.isPageLoadForFirstTime?a.isPageLoadForFirstTime&&
!a.isVersionLoadForFirstTime[b]&&a.flushPLTEventsToLog(b):a.flushPLTEventsToLog(b):f===d.DrawSlideContentEnd&&(null!=a.isVersionLoadForFirstTime[b]&&1==a.isVersionLoadForFirstTime[b]&&(a.isVersionLoadForFirstTime[b]=!1),g&&(this.docPLTEventDictionary[b][d.SyncCorrelationId]=g),a.flushPLTEventsToLog(b))}catch(h){}};a.setIsPageLoadForFirstTime=function(b){a.isPageLoadForFirstTime=b;a._appTelemetryDictionary.isPageLoadForFirstTime=b?"true":"false"};a.setIsVersionLoadForFirstTime=function(b,f){a.isVersionLoadForFirstTime[b]=
f;a.setValueForDocPLTEvent(b,"isVersionLoadForFirstTime",f?"true":"false")};a.setIsSlideImageLoadForFirstTime=function(b,f){a.isSlideImageLoadForFirstTime=f;a.setValueForDocPLTEvent(b,"isSlideImageLoadingFirstTime",f?"true":"false")};a.logEplapsedTime=function(a,c,g,h,k,d){b.SessionLogger.traceTag(39347465,logCategory.PptSession,c,a+" StartTime: "+g+", EndTime: "+h+", ElapsedTime: "+(h-g)+(d?", ServerTime: "+d:"")+(k?", SyncCorrelationId: "+k+".":"."))};a.setValueForDocPLTEvent=function(b,f,g){try{null==
a.docPLTEventDictionary[b]&&(a.docPLTEventDictionary[b]={}),a.docPLTEventDictionary[b][f]=g}catch(h){}};a.flushPLTEventsToLog=function(l){try{a.setValueForDocPLTEvent(l,"revisionID",l);var f=__assign({},a._appTelemetryDictionary,a.docPLTEventDictionary[l]),g=JSON.stringify(f);b.SessionLogger.traceTag(39658656,logCategory.PptSession,logLevel.Info,g);a._appTelemetryDictionary={};a.docPLTEventDictionary[l]={}}catch(h){}};a.isPageLoadForFirstTime=!1;a.isVersionLoadForFirstTime={};a.isSlideImageLoadForFirstTime=
!1;a._appTelemetryDictionary={};a.docPLTEventDictionary={};return a}();b.VersionHistoryLogHelper=a})(b.VersionHistory||(b.VersionHistory={}))})(Microsoft||(Microsoft={}));
(function(b){var e=function(){function b(){}b.prototype.fetchBoundary=function(a){a=a.split("boundary=");if(2===a.length)return a[1];throw"No Boundary";};b.prototype.processMultipartBinaryResponse=function(a,b,l){return __awaiter(this,void 0,void 0,function(){var f,g,h,k,d,e,m,n,r,u,t,y,v,z,w;return __generator(this,function(B){if(null===a||void 0===a)throw"multipartContentBuffer is empty";f="";g=void 0;h=0;k=[];try{for(d=0;d<a.length;d+=1)e=a[d],m=0<d?a[d-1]:null,n=10===e||13===e?!0:!1,r=10===e&&
13===m?!0:!1,u=10===m&&13===e?!0:!1,k.push(e),n||(f+=String.fromCharCode(e)),0===h&&r?"--"+b===f&&(h=1,f="",k=[]):1===h&&u?(g=new Uint8Array(k),h=2,f="",k=[]):2===h&&r?(h=3,f="",k=[]):3===h&&(f.length>b.length+4&&(f=""),"--"+b===f&&(t=k.length-f.length,y=k.slice(0,t-1),h=1,v=this.processHeader(g),z={Headers:v,Body:new Uint8Array(y)},l(z),f="",g=void 0,k=[]),r&&(f=""))}catch(A){w={Err:Error(A)},l(w)}return[2]})})};b.prototype.parseResponseBodyFromPart=function(a){a=a.split("\n\r\n");if(2===a.length)return a[1];
throw"No response Body";};b.prototype.parseResponseHeaderFromPart=function(a){a=a.split("\n\r\n");if(2===a.length)return a[0];throw"No response Headers";};b.prototype.processHeader=function(a){var b={};if(a){for(var l="",f=0;f<a.byteLength;f+=1)l+=String.fromCharCode(a[f]);l.split("\n").forEach(function(a){a=a.split(": ");2===a.length&&(b[a[0]]=a[1])})}return b};return b}();b.MultipartParser=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=function(){return function(b,a){this.SlideID=b;this.ImageData=a}}();b.ThumbnailItem=e;e=function(){return function(){this.SlideOrder=[];this.Slides=[]}}();b.PresentationInfo=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=function(){function b(){}b.PresInfoMetaData="presinfo/metadata";b.PresinfoslimSlideOrder="presinfo/slimSlideOrder";b.slideIndex="pres/sldIdx";b.slideSid="pres/sldSid";b.PresinfoSlideOrder="presinfo/SlideOrder";b.NotesSldIndex="pres/NotesSldIdx";b.NotesSldSid="pres/NotesSldSid";b.SlideMetadataSldIndex="pres/SlideMetadatasldIdx";b.SlideMetadataSldSid="pres/SlideMetadataSldSid";return b}();b.GetRequestItemIds=e;e=function(){function b(){}b.JsonType="application/json";b.ImagePng="image/png";
b.ImageJpg="image/jpg";b.PlainText="text/plain";return b}();b.ItemType=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){function e(a){a=a.slice(1).split("&");for(var b={},c=0;c<a.length;++c){var h=a[c].split("=");b[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return b}var d=Microsoft.VersionHistory.SessionLogger,a=function(){function a(b){this.url=b}a.prototype.GetVersions=function(a){var c=this;return new Promise(function(l,k){b.VersionListPane.GetVersionList(c.url,a,function(a){l({Versions:a})},function(){k("FAILED")})})};return a}();b.StartMockVersionHistoryPane=function(){return __awaiter(this,
void 0,void 0,function(){var l,f,g,h,k,p,q,m,n,r,u,t,y,v,z,w,B;return __generator(this,function(A){switch(A.label){case 0:return l=document.createElement("div"),l.id="VersionHistoryPaneRoot",document.body.appendChild(l),l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.style.width=PowerPointDocumentViewer.PixelToCss(document.documentElement.clientWidth),l.style.height=PowerPointDocumentViewer.PixelToCss(document.documentElement.clientHeight),f=document.createElement("div"),
f.id="ViewerContainer",l.appendChild(f),f.style.top="0px",f.style.height="100%",f.style.position="absolute",f.style.width=PowerPointDocumentViewer.PixelToCss(document.documentElement.clientWidth-300),window.addEventListener("resize",function(){f.style.width=PowerPointDocumentViewer.PixelToCss(document.documentElement.clientWidth-300)}),g={RenderServiceBase:"http://localhost:8080/",IsRtl:!1,DefaultSlideWidth:PowerPointDocumentViewer.DefaultSlideWidth,DefaultSlideHeight:PowerPointDocumentViewer.DefaultSlideHeight,
DefaultNotesHeight:PowerPointDocumentViewer.NotesHeightDefault,UserSessionId:"00000000-0000-0000-0000-000000000000",VersionViewerCssUrl:"",ProgressImageResourceUrl:"",UseConsoleSessionLogger:!0,IsHighContrast:!1,ClientColorSettings:"",ThumbnailShareOptimizationEnabled:!1,SlidePrefetchSettings:{SlidePrefetchChunkSize:1,SlidePrefetchAhead:3,SlidePrefetchBehind:1,SlidePrefetchEnabled:!1,SlidePrefetchDelay:2500},FileExtension:".pptx",SlideInformationLabel:"Slide {0} of {1}",NotesButtonLabel:"Notes",SynchronizerTimeout:3E5,
IsRootContainerPositionAbsolute:!1,IsCopySlidesEnabled:!0,SlidePaneLabel:"Slide Pane",ThumbnailPaneLabel:"Thumbnail Pane",NotesPaneLabel:"Notes Pane",StatusBarLabel:"Status Bar",Lcid:1033,EnableOverflowXOnSlideAndNotePane:!0,ThumbnailInfoLabel:"Slide {0}",IsModernCatchUpUxEnable:!0,IsRevisionTrackingFlyoutEnabled:!0,RevisionTrackingFlyoutContent:"Slide has unread changes"},h={animationDecoratorCallback:function(){return document.createElement("div")},notesIconDecoratorCallback:function(){return document.createElement("div")},
reportViewerErrorCallback:function(a){return!0},addToF6LoopCallback:function(a){return!0},copySlideCallback:function(a){return!0}},k=new b.AppVersionController(g,f,h),p=e(window.location.search),(q=p.versionsEndpoint)||(q="http://localhost:8082/versions.ashx"),(m=p.DocID)||(m="\\\\pptfiles1\\temp\\vh_repos\\versionhistory.pptx"),n=new c(l,300,m,k),n.OnSelectionChanged.Subscribe(function(a,b){var c=null;n.SelectedIndex<n.VersionInfos.length-1&&(c=n.VersionInfos[n.SelectedIndex+1]);k.onVersionSelected(n.VersionInfos[n.SelectedIndex],
c,{})}),r=new a(q),[4,r.GetVersions(m)];case 1:u=A.sent();if(!u.Versions)return[2];t=u.Versions.sort(function(a,b){return(new Date(b.Time)).getTime()-(new Date(a.Time)).getTime()});n.VersionInfos=t;n.SelectedIndex=0;y=k.getAppDataStore();v=0;for(z=t;v<z.length;v++)w=z[v],B=y.AddVersionInfoToStore(w),d.traceTag(39408206,logCategory.PptSession,logLevel.Info,"StartMockVersionHistoryPane Added Version to store fAdded:"+B+" version.RevisionID:"+w.RevisionID);return[2]}})})};var c=function(){function a(b,
c,l,k){this.versionDivs=[];this.selectedIndex=-1;this.OnSelectionChanged=new Util.TEvent;this.parent=b;this.versionsViewerController=k;this.rootElement=document.createElement("div");this.rootElement.id="VersionListPaneElement";this.parent.appendChild(this.rootElement);this.rootElement.style.right="0px";this.rootElement.style.position="absolute";this.rootElement.style.backgroundColor="#f1f1f1";this.rootElement.style.color="#ff0016";this.rootElement.style.width=PowerPointDocumentViewer.PixelToCss(c);
this.rootElement.style.height="100%";this.rootElement.style.display="flex";this.rootElement.style.flexDirection="column";this.docID=l}Object.defineProperty(a.prototype,"SelectedIndex",{get:function(){return this.selectedIndex},set:function(a){a!=this.selectedIndex&&(0<=this.selectedIndex&&(this.versionDivs[this.selectedIndex].style.backgroundColor="#00ff63"),this.selectedIndex=a,this.versionDivs[this.selectedIndex].style.backgroundColor="red",this.OnSelectionChanged.Signal(this,null))},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"VersionInfos",{get:function(){return this.versions},set:function(a){this.versions=a;this.LayoutVersionList()},enumerable:!0,configurable:!0});a.prototype.LayoutVersionList=function(){var a=this;if(this.versions)for(var b=function(b){l=document.createElement("button");l.style.backgroundColor="#00ff63";d=c.versions.length-b;l.textContent="version "+d;c.versionDivs.push(l);l.onclick=function(){a.SelectedIndex=b};c.rootElement.appendChild(l)},c=this,
l,d,e=0;e<this.versions.length;e++)b(e)};a.GetVersionList=function(b,c,h,k){var d=new XMLHttpRequest;b=b+"?DocID="+encodeURI(c);d.open("GET",b,!0);d.onreadystatechange=function(){return a.OnGetVersionListResponse(d,h,k)};d.send()};a.OnGetVersionListResponse=function(a,b,c){if(a.readyState==XMLHttpRequest.DONE)if(a=a.response,null!=a)try{var l=JSON.parse(a).Versions;b(l)}catch(d){c()}else c()};return a}();b.VersionListPane=c})(PowerPointVersionHistory||(PowerPointVersionHistory={}));var PowerPointDocumentViewer;
(function(b){var e=function(){return function(){}}();b.ViewerSettings=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){b.StatusBarHeight=23;b.MbContainerMinWidth=300;b.MbContainerMinHeight=200;b.StylePositionAbsolute="absolute";b.StylePositionRelative="relative";b.StyleVisible="visible";b.StyleHidden="hidden";b.StyleDisplayBlock="block";b.StyleDisplayNone="none";b.TabRowHeightPx=30;b.UnifiedHeaderHeightPx=50;b.LowerRibbonHeightMousePx=94;b.SingleLineRibbonHeight=77;b.ThumbnailPaneAreaWidth=238;b.DefaultThumbnailWidth=176;b.DefaultThumbnailHeight=132;b.ThumbnailOuterBorder=2;b.ThumbnailInnerBorder=1;b.ThumbnailPadding=
1;b.ThumbnailPanelEdgeToSlideEdge=33;b.ThumbnailTopEdgeToSlideEdge=20;b.ThumbnailVerticalSpacing=20;b.ThumbnailNumberEdgeToSlideEdge=8;b.EditNotesHeightPeek=32;b.EditNotesHeightHide=3;b.NotesHeightMaxPercent=.75;b.NotesHeightDefault=960;b.DefaultSlideWidth=1520;b.DefaultSlideHeight=855;b.PptEditingDefaultResolutionWidth=848;b.PptEditingDefaultResolutionHeight=477;b.c_minimumScaleFactor=.025;b.c_maximumScaleFactor=2;b.SlidePadding=10;b.ZeroPixel="0px";b.ProgressSpinnerHeight=24;b.ProgressSpinnerWidth=
24;b.DpiVertical=96;b.MasterUnitsPerInch=576})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){function e(a,b){var c=a.className;return null==c||""==c?!1:0<=c.split(" ").indexOf(b)}function d(c,f,g){c=a(c,f);return Math.min(Math.max(Math.min(c.width/g.width,c.height/g.height),b.c_minimumScaleFactor),b.c_maximumScaleFactor)}function a(a,c){var g=a.width-2*b.SlidePadding,h=a.height-2*b.SlidePadding,k=c.width/2,d=c.height/2,e=4*c.width,m=4*c.height,n=g,r=h;g<k?n=k:g>e&&(n=e);h<d?r=d:h>m&&(r=m);return{width:n,height:r,top:0,bottom:0,left:0,right:0}}function c(a,c,g){var h=c.width*
g;c=c.height*g;g=a.width-(h+2*b.SlidePadding);a=a.height-(c+2*b.SlidePadding);return{width:h,height:c,top:0<a?Math.floor(a/2):0,left:0<g?Math.floor(g/2):0,bottom:0,right:0}}b.CssToPixel=function(a){return null==a?0:Number(a.substr(0,a.length-2))};b.PixelToCss=function(a){return a+"px"};b.GetSrollBarWidth=function(){var a=document.createElement("div");a.style.visibility="hidden";a.style.overflow="scroll";a.style.width="100px";a.style.height="100px";a.style.position="absolute";document.documentElement.appendChild(a);
var b=a.offsetWidth-a.clientWidth-1;document.documentElement.removeChild(a);return b};b.AddCssClass=function(a,b){if(!e(a,b)){var c=a.className;a.className=null==c||""==c?b:c+" "+b}};b.RemoveCssClass=function(a,b){var c=" "+a.className+" ",h=c.indexOf(" "+b+" ");0<=h&&(a.className=(c.substring(0,h)+c.substring(h+b.length+1)).trim())};b.ContainsCssClass=e;b.GetBestSlideDimensions=function(a,b,g){b=d(a,b,g);return c(a,g,b)};b.GetBestSlideScale=d;b.CalculateAvailableSlideDimensions=a;b.GetBestSlideDimensionsForScale=
c;b.GetThumbnailDimensions=function(a,c){var g=b.DefaultThumbnailWidth,h=b.DefaultThumbnailHeight;if(null==a||null==c)return{width:g,height:h,top:0,bottom:0,left:0,right:0};var k=1*a/c;return k<1*g/h?{width:Math.round(h*k),height:h,top:0,bottom:0,left:0,right:0}:{width:g,height:Math.round(g/k),top:0,bottom:0,left:0,right:0}};b.GetThumbnailIndexFromItemId=function(a){return Number(a.substring(a.indexOf("sld")+3,a.indexOf("th")-1))};b.StringNullOrEmpty=function(a){return null==a||""==a};b.ConvertMasterUnitToPixel=
function(a){return Math.floor(a*b.DpiVertical)/b.MasterUnitsPerInch};b.IsFullThumbnailId=function(a){return-1!=a.indexOf("sid")&&-1!=a.indexOf("/cid")&&-1!=a.indexOf("/th")?!0:!1}})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,b,l){void 0===b&&(b=!1);void 0===l&&(l=!1);this.c_viewerNotesDefaultString="Click to add notes";var f="PowerPointDocumentViewerNotesPane"+Math.random();this.parent=a;this.rootElement=document.createElement("div");this.rootElement.id=f;this.rootElement.setAttribute("role","region");this.rootElement.setAttribute("aria-label",this.parent.notesPaneLabel);this.innerContainer=document.createElement("div");this.innerContainer.className="PowerPointDocumentViewerNotesPaneInnerContainer";
this.rootElement.appendChild(this.innerContainer);this.rootElement.className=b?"PowerPointDocumentViewerNotesPaneRtl":"PowerPointDocumentViewerNotesPane";l&&(this.rootElement.style.overflowX="scroll");this.rootElement.tabIndex=-1}Object.defineProperty(d.prototype,"NotesPaneId",{get:function(){return this.rootElement.id},enumerable:!0,configurable:!0});d.prototype.Layout=function(){this.rootElement.style.top=b.PixelToCss(b.CssToPixel(this.parent.SlidePane.RootElement.style.top)+b.CssToPixel(this.parent.SlidePane.RootElement.style.height)+
1);this.rootElement.style.width=this.parent.SlidePane.RootElement.style.width;this.rootElement.style.height=b.PixelToCss(this.parent.adjustNotesPaneHeight)};d.prototype.Show=function(){this.rootElement.style.display=b.StyleDisplayBlock;this.isVisible=!0};d.prototype.Hide=function(){this.rootElement.style.display=b.StyleDisplayNone;this.isVisible=!1};d.prototype.Toggle=function(){this.IsVisible?this.Hide():this.Show()};Object.defineProperty(d.prototype,"IsVisible",{get:function(){return this.isVisible},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Content",{set:function(a){a!=this.c_viewerNotesDefaultString&&(this.content=a,this.innerContainer.innerHTML=this.content)},enumerable:!0,configurable:!0});return d}();b.ViewerNotesPane=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,c,l){var f=this;this.c_viewerRootContainerClass="PowerPointDocViewerRootContainer";this.c_viewerRootContainerId="PowerPointDocViewerRootContainer"+Math.random();this.c_viewerRootContainerClassRtl="PowerPointDocViewerRootContainerRtl";this.rootElement=document.createElement("div");this.rootElement.id=this.c_viewerRootContainerId;this.rootElement.className=a.isRtl?this.c_viewerRootContainerClassRtl:this.c_viewerRootContainerClass;this.rootElement.style.position=
a.isRootContainerPositionAbsolute?"absolute":"static";this.parentElement=c;this.slideWidth=a.slideWidth;this.slideHeight=a.slideHeight;this.initialNotesPaneHeight=l;this.isCopySlidesEnabled=a.isCopySlidesEnabled;this.slidePaneLabel=a.slidePaneLabel;this.thumbnailPaneLabel=a.thumbnailPaneLabel;this.notesPaneLabel=a.notesPaneLabel;this.statusBarLabel=a.statusBarLabel;this.thumbnailInfoLabel=a.thumbnailInfoLabel;this.isModernCatchUpUxEnable=a.isModernCatchUpUxEnable;this.isRevisionTrackingFlyoutEnabled=
a.isRevisionTrackingFlyoutEnabled;this.revisionTrackingFlyoutContent=a.revisionTrackingFlyoutContent;this.thumbnailPane=new b.ViewerThumbnailPane(this,a.isRtl);this.slidePane=new b.ViewerSlidePane(a,this);this.notesPane=new b.ViewerNotesPane(this,a.isRtl,a.enableOverflowXOnSlideAndNotePane);this.viewerStatusBar=new b.ViewerStatusBar(this,a);this.rootElement.appendChild(this.thumbnailPane.rootElement);this.rootElement.appendChild(this.slidePane.rootElement);this.rootElement.appendChild(this.slidePane.OutlineViewElement);
this.rootElement.appendChild(this.notesPane.rootElement);this.rootElement.appendChild(this.viewerStatusBar.rootElement);this.parentElement.appendChild(this.rootElement);this.rootElement.style.display=b.StyleDisplayBlock;this.Layout();this.rootElement.addEventListener("focus",function(){f.thumbnailPane.rootElement.focus()})}Object.defineProperty(d.prototype,"ThumbnailPane",{get:function(){return this.thumbnailPane},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"SlidePane",{get:function(){return this.slidePane},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"NotesPane",{get:function(){return this.notesPane},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"StatusBar",{get:function(){return this.viewerStatusBar},enumerable:!0,configurable:!0});d.prototype.Hide=function(){this.rootElement.style.display=b.StyleDisplayNone};d.prototype.Show=function(){this.rootElement.style.display=b.StyleDisplayBlock;this.Layout();this.thumbnailPane.CalculateVisibleSlideRange()};d.prototype.UpdateSettings=
function(a,b){this.slideHeight=b;this.slideWidth=a;this.slidePane.slide.sldHeight=b;this.slidePane.slide.sldWidth=a};d.prototype.Layout=function(){this.rootElement.style.top=b.PixelToCss(0);this.rootElement.style.bottom=b.ZeroPixel;this.rootElement.style.left=b.ZeroPixel;this.rootElement.style.right=b.ZeroPixel;this.rootElement.style.width=b.PixelToCss(this.parentElement.clientWidth);this.rootElement.style.height=b.PixelToCss(this.parentElement.clientHeight);this.rootElement.style.minWidth=b.PixelToCss(b.MbContainerMinWidth);
this.rootElement.style.minHeight=b.PixelToCss(b.MbContainerMinHeight);this.thumbnailPane.Layout();this.adjustNotesPaneHeight=this.CalculateNotesPaneHeight();this.slidePane.Layout();this.notesPane.Layout();this.notesPane.Hide()};d.prototype.ToggleNotesPane=function(){this.notesPane.Toggle();this.viewerStatusBar.SetNotesButtonState(this.IsNotesVisible);this.adjustNotesPaneHeight=this.CalculateNotesPaneHeight();this.slidePane.Layout();this.notesPane.Layout()};Object.defineProperty(d.prototype,"IsNotesVisible",
{get:function(){return this.notesPane.IsVisible},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"NotesPaneContent",{set:function(a){this.notesPane.Content=a},enumerable:!0,configurable:!0});d.prototype.CalculateNotesPaneHeight=function(){if(!this.notesPane.IsVisible)return 0;var a=b.ConvertMasterUnitToPixel(this.initialNotesPaneHeight);return a==b.NotesHeightDefault?b.EditNotesHeightHide:a>b.CssToPixel(this.thumbnailPane.rootElement.style.height)*b.NotesHeightMaxPercent?b.EditNotesHeightHide:
a};return d}();b.ViewerRootContainer=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,b,l){this.c_viewerSlideViewClassName="PowerPointDocumentViewerSlideView";this.c_viewerImageId="PowerPointDocumentViewerSlideImage"+Math.random();this.rootElement=document.createElement("div");this.rootElement.className=this.c_viewerSlideViewClassName;this.slideImg=document.createElement("img");this.slideImg.id=this.c_viewerImageId;this.rootElement.appendChild(this.slideImg);this.parent=a;this.sldWidth=b;this.sldHeight=l}d.prototype.Layout=function(){this.rootElement.style.zIndex=
"100";this.rootElement.style.position=b.StylePositionAbsolute;var a=b.GetBestSlideDimensions({width:this.parent.rootElement.clientWidth,height:this.parent.rootElement.clientHeight,top:0,bottom:0,left:0,right:0},{width:b.PptEditingDefaultResolutionWidth,height:b.PptEditingDefaultResolutionHeight,top:0,bottom:0,left:0,right:0},{width:this.sldWidth,height:this.sldHeight,top:0,bottom:0,left:0,right:0});this.rootElement.style.top=b.PixelToCss(a.top);this.rootElement.style.left=b.PixelToCss(a.left);this.rootElement.style.width=
b.PixelToCss(a.width);this.rootElement.style.height=b.PixelToCss(a.height);this.slideImg.style.width="100%";this.slideImg.style.height="100%"};d.prototype.SetImage=function(a,b,l){this.sldWidth=b;this.sldHeight=l;this.Layout();this.slideImg.src=a;this.parent.HideProgress()};return d}();b.ViewerSlide=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,c){var l=this;this.c_viewerSlidePaneId="PowerPointDocumentViewerSlidePane"+Math.random();this.c_viewerSlidePaneClassName="PowerPointDocumentViewerSlidePane";this.c_viewerSlidePaneRtlClassName="PowerPointDocumentViewerSlidePaneRtl";this.c_progressIndicatorClassName="PowerPointDocumentViewerHTMLProgressIndicator";this.c_progressOverlayClassName="PowerPointDocumentViewerHtmlprogressOverlay";this.c_progressInnerDivClassName="PowerPointDocumentViewerHtmlprogressInner";
this.c_slideOutlineViewId="OutlineView"+Math.random();this.c_slideOutlineViewClass="VHAriaLiveRegion";this.progressTimer=-1;this.viewerSettings=a;this.parent=c;this.rootElement=document.createElement("div");this.rootElement.id=this.c_viewerSlidePaneId;this.rootElement.className=a.isRtl?this.c_viewerSlidePaneRtlClassName:this.c_viewerSlidePaneClassName;a.enableOverflowXOnSlideAndNotePane&&(this.rootElement.style.overflowX="scroll",this.rootElement.style.overflowY="hidden");this.rootElement.tabIndex=
-1;this.rootElement.setAttribute("role","img");this.rootElement.setAttribute("aria-describedby",this.c_slideOutlineViewId);this.rootElement.setAttribute("aria-label",this.parent.slidePaneLabel);this.rootElement.addEventListener("mousedown",function(){l.rootElement.classList.remove("PPTVHViewerElementSelected")});this.rootElement.addEventListener("blur",function(){l.rootElement.classList.remove("PPTVHViewerElementSelected")});this.slide=new b.ViewerSlide(this,a.slideWidth,a.slideHeight);this.rootElement.appendChild(this.slide.rootElement);
this.slideOutlineViewContainer=this.CreateSlideOutlineViewContainer()}Object.defineProperty(d.prototype,"SlidePaneId",{get:function(){return this.c_viewerSlidePaneId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"RootElement",{get:function(){return this.rootElement},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"OutlineViewElement",{get:function(){return this.slideOutlineViewContainer},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Slide",
{get:function(){return this.slide},enumerable:!0,configurable:!0});d.prototype.Layout=function(){this.rootElement.style.width=b.PixelToCss(b.CssToPixel(this.parent.rootElement.style.width)-b.CssToPixel(this.parent.ThumbnailPane.RootElement.style.width)-4);this.rootElement.style.height=b.PixelToCss(b.CssToPixel(this.parent.ThumbnailPane.RootElement.style.height)-this.parent.adjustNotesPaneHeight-5);this.rootElement.style.bottom=b.ZeroPixel;this.rootElement.style.top=this.parent.ThumbnailPane.RootElement.style.top;
this.slide.Layout();this.LayoutProgress()};d.prototype.DrawSlidePaneImage=function(a,b,l){this.slide.SetImage(a,b,l)};d.prototype.SetSlideOutlineView=function(a){this.slideOutlineViewContainer.innerHTML=a};d.prototype.ShowProgress=function(a){var b=this;this.HideProgress();this.progressTimer=window.setTimeout(function(){b.ShowProgressInternal()},Math.max(0,5E3+a.getTime()-(new Date).getTime()))};d.prototype.HideProgress=function(){this.ClearProgressTimer();null!=this.progressContainer&&(this.progressContainer.style.display=
b.StyleDisplayNone,this.progressContainer.style.opacity="0")};d.prototype.ConstructProgress=function(){this.progressContainer=document.createElement("div");this.progressContainer.className=this.c_progressIndicatorClassName;this.progressContainer.style.visibility=b.StyleHidden;this.progressContainer.style.display=b.StyleDisplayNone;this.progressOverlayDiv=document.createElement("div");this.progressOverlayDiv.className=this.c_progressOverlayClassName;this.progressInnerDiv=document.createElement("div");
this.progressInnerDiv.className=this.c_progressInnerDivClassName;this.progressSpinner=document.createElement("img");this.progressSpinner.src=this.viewerSettings.progressImageResourceUrl;this.progressSpinner.width=b.ProgressSpinnerWidth;this.progressSpinner.height=b.ProgressSpinnerHeight;this.progressInnerDiv.appendChild(this.progressSpinner);this.progressContainer.appendChild(this.progressOverlayDiv);this.progressContainer.appendChild(this.progressInnerDiv);this.rootElement.appendChild(this.progressContainer);
this.progressContainer.style.left=b.ZeroPixel;this.progressContainer.style.top=b.ZeroPixel;this.progressInnerDiv.style.position=b.StylePositionAbsolute;this.progressInnerDiv.style.direction="ltr"};d.prototype.LayoutProgress=function(){if(null!=this.progressInnerDiv){var a=this.progressInnerDiv.clientWidth;this.progressInnerDiv.style.top=b.PixelToCss(this.rootElement.clientHeight/2-this.progressInnerDiv.clientHeight/2);this.progressInnerDiv.style.left=b.PixelToCss(this.rootElement.clientWidth/2-a/
2)}};d.prototype.ShowProgressInternal=function(){null==this.progressContainer&&(this.ConstructProgress(),this.LayoutProgress());this.progressContainer.style.opacity="1.0";this.progressContainer.style.visibility=b.StyleVisible;this.progressContainer.style.display=b.StyleDisplayBlock};d.prototype.ClearProgressTimer=function(){-1!=this.progressTimer&&window.clearTimeout(this.progressTimer)};d.prototype.CreateSlideOutlineViewContainer=function(){var a=document.createElement("div");a.id=this.c_slideOutlineViewId;
a.className=this.c_slideOutlineViewClass;return a};return d}();b.ViewerSlidePane=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=Microsoft.Office.WebClient.PowerPoint.StringUtil,d=function(){function a(a,l){var f=this,g="PowerPointDocumentViewerStatusBar"+Math.random();this.parent=a;this.rootElement=document.createElement("div");this.rootElement.style.height=b.PixelToCss(b.StatusBarHeight);this.rootElement.id=g;this.rootElement.className="PowerPointDocumentViewerStatusBar";this.rootElement.tabIndex=-1;this.rootElement.setAttribute("role","region");this.rootElement.setAttribute("aria-label",this.parent.statusBarLabel);
this.slideInformationLabel=l.slideInformationLabel;this.notesButtonLabel=l.notesButtonLabel;this.rootElement.style.zIndex="102";this.statusBarRightContainer=document.createElement("div");this.statusBarLeftContainer=document.createElement("div");this.statusBarRightContainer.className="PowerPointDocumentViewerStatusBarRightContainer";this.statusBarLeftContainer.className="PowerPointDocumentViewerStatusBarLeftContainer";this.rootElement.appendChild(this.statusBarRightContainer);this.rootElement.appendChild(this.statusBarLeftContainer);
this.notesButtonElement=document.createElement("button");this.notesButtonElement.className="PowerPointDocumentViewerStatusBarNotesButton";this.notesButtonElement.id="PowerPointDocumentViewerStatusBarNotesButton"+Math.random();this.notesButtonElement.style.height=b.PixelToCss(b.StatusBarHeight);this.notesButtonElement.setAttribute("aria-pressed","false");this.notesButtonElement.onclick=function(a){a.preventDefault();a={viewerEventType:b.ViewerEventType.NotesButtonClicked,eventData:{}};b.ViewerEventManagerSingleton.GetSingleton().FireEvent(f,
a)};this.statusBarRightContainer.appendChild(this.notesButtonElement);this.notesButtonTextElement=document.createElement("span");this.notesButtonTextElement.className="PowerPointDocumentViewerStatusBarNotesButtonText";this.notesButtonTextElement.textContent=this.notesButtonLabel;this.notesButtonElement.appendChild(this.notesButtonTextElement);this.slideInfoElement=document.createElement("div");this.slideInfoElement.className="PowerPointDocumentViewerStatusBarSlideInfo";this.slideInfoSpanElement=document.createElement("span");
this.slideInfoElement.appendChild(this.slideInfoSpanElement);this.statusBarLeftContainer.appendChild(this.slideInfoElement)}Object.defineProperty(a.prototype,"NotesIconElement",{get:function(){return this.notesIconElement},set:function(a){null!=a&&(this.notesIconElement=a,this.notesIconElement.className+=" PowerPointDocumentViewerStatusBarNotesIcon",this.notesButtonElement.appendChild(this.notesIconElement))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"StatusBarNotesButtonId",
{get:function(){return this.notesButtonElement.id},enumerable:!0,configurable:!0});a.prototype.Layout=function(){this.rootElement.style.zIndex="102";this.rootElement.style.height=b.PixelToCss(b.StatusBarHeight-1)};a.prototype.DrawSlideInfo=function(a,b){var f=this.slideInformationLabel,f=e.format(f,(a+1).toString(),b.toString());this.slideInfoSpanElement.textContent=f};a.prototype.SetNotesButtonState=function(a){this.notesButtonElement.setAttribute("aria-pressed",String(a));a?this.notesButtonElement.classList.add("Selected"):
this.notesButtonElement.classList.remove("Selected")};return a}();b.ViewerStatusBar=d})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=Microsoft.Office.WebClient.PowerPoint.StringUtil,d=function(){function a(){}a.TryCreateDiffIcon=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.height="16px";a.style.width="16px";a.setAttribute("class","RevisionTrackingIconSVG");a.setAttribute("viewBox","0 0 16 16");a.style.backgroundColor="rgb(0, 130, 140)";var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",this.c_iconPathDAttribute);a.appendChild(b);return a};
a.TryCreateModernDiffIcon=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.height="10px";a.style.width="10px";a.setAttribute("class",this.c_modernRevisionTrackingIconSVGClassName);a.setAttribute("viewBox","0 0 10 10");var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",this.c_modernIconPathDAttribute);b.setAttribute("class",this.c_modernRevisionTrackingIconPathClassName);a.appendChild(b);return a};a.c_iconPathDAttribute="M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z";
a.c_modernIconPathDAttribute="M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0";a.c_modernRevisionTrackingIconSVGClassName="ModernRevisionTrackingIconSVG";a.c_modernRevisionTrackingIconPathClassName="ModernRevisionTrackingIconPath";return a}();b.DiffIcon=d;var a=function(){function a(b,c,g,h){void 0===h&&(h=!1);var k=this;this.c_viewerThumbnailContainerClassName="PowerPointDocumentViewerThumbnailContainer";this.c_viewerThumbnailContainerRtlClassName="PowerPointDocumentViewerThumbnailContainerRtl";this.c_viewerThumbnailOuterBorderClassName=
"PowerPointDocumentViewerThumbnailOuterBorder";this.c_viewerThumbnailOuterBorderRtlClassName="PowerPointDocumentViewerThumbnailOuterBorderRtl";this.c_viewerThumbnailImageContainerClassName="PowerPointDocumentViewerThumbnailImageContainer";this.c_viewerThumbnailSlideNumberClassName="PowerPointDocumentViewerThumbnailSlideNumber";this.c_viewerThumbnailSlideNumberRtlClassName="PowerPointDocumentViewerThumbnailSlideNumberRtl";this.c_viewerThumbnailSelectedClassName="PowerPointDocumentViewerThumbnailSelected";
this.c_viewerThumbnailDiffClassName="PowerPointDocumentViewerThumbnailDiff";this.c_viewerThumbnailHiddenClassName="PowerPointDocumentViewerThumbnailHidden";this.c_viewerThumbnailDiffIconContainerClassName="PowerPointDocumentViewerThumbnailDiffIconContainer";this.c_viewerThumbnailDiffIconContainerRtlClassName="PowerPointDocumentViewerThumbnailDiffIconContainerRtl";this.c_viewerThumbRtFlyoutContainerRtlClassName="PptDocumentViewerThumbRtFlyoutContainerRtl";this.c_viewerThumbRtFlyoutContainerClassName=
"PptDocumentViewerThumbRtFlyoutContainer";this.c_viewerThumbRtContainerClassName="PptDocumentViewerThumbRtContainer";this.c_viewerThumbRtContainerRtlClassName="PptDocumentViewerThumbRtContainerRtl";this.parent=b;this.isRtl=h;this.thumbnailContainer=document.createElement("div");this.thumbnailContainer.className=h?this.c_viewerThumbnailContainerRtlClassName:this.c_viewerThumbnailContainerClassName;this.thumbnailContainer.setAttribute("aria-describedby",b.AriaId);this.thumbnailContainer.setAttribute("role",
"listitem");this.thumbnailContainer.tabIndex=this.parent.tabIndexValue;this.thumbnailOuterBorder=document.createElement("div");this.thumbnailOuterBorder.className=h?this.c_viewerThumbnailOuterBorderRtlClassName:this.c_viewerThumbnailOuterBorderClassName;this.thumbnailImageContainer=document.createElement("div");this.thumbnailImageContainer.className=this.c_viewerThumbnailImageContainerClassName;this.thumInfoContainer=document.createElement("div");this.slideNumberEl=document.createElement("span");
this.slideNumberEl.className=h?this.c_viewerThumbnailSlideNumberRtlClassName:this.c_viewerThumbnailSlideNumberClassName;this.slideNumberEl.innerText=(c+1).toString();this.img=document.createElement("img");this.thumbnailImageContainer.appendChild(this.img);this.thumbnailOuterBorder.appendChild(this.thumbnailImageContainer);this.thumbnailOuterBorder.setAttribute("aria-hidden","true");this.thumInfoContainer.setAttribute("aria-hidden","true");this.thumInfoContainer.appendChild(this.slideNumberEl);this.thumbnailContainer.appendChild(this.thumInfoContainer);
this.thumbnailContainer.appendChild(this.thumbnailOuterBorder);this.index=c;this.thImgArea=g;this.isCopySlidesEnabled=this.parent.isCopySlidesEnabled;this.isModernCatchUpUxEnable=this.parent.isModernCatchUpUxEnable;this.isRevisionTrackingFlyoutEnabled=this.parent.isRevisionTrackingFlyoutEnabled;this.revisionTrackingFlyoutContent=this.parent.revisionTrackingFlyoutContent;this.thumbnailContainer.onclick=function(a){k.isCopySlidesEnabled?a.ctrlKey?k.parent.SelectThumbnails(k.index,!0):a.shiftKey?(k.parent.SelectThumbnailsInRange(Math.min(k.index,
k.parent.activeThumbnailIndex),Math.max(k.index,k.parent.activeThumbnailIndex)),k.parent.ScrollThumbnailIntoView(k.index)):k.parent.SelectThumbnail(k.index,!0):k.parent.SelectThumbnail(k.index,!0)};this.thumbnailContainer.oncontextmenu=function(){k.isCopySlidesEnabled&&-1==k.parent.activeThumbnailIndexes.indexOf(c)&&k.parent.SelectThumbnail(k.index,!0)}}a.prototype.Layout=function(){this.thImgArea=this.parent.thImgarea;this.thumbnailImageContainer.style.zIndex="1";this.thumInfoContainer.style.position=
b.StylePositionAbsolute;this.slideNumberEl.style.position=b.StylePositionAbsolute;this.slideNumberEl.style.display=b.StyleDisplayBlock;var a=2*b.ThumbnailOuterBorder+2*b.ThumbnailInnerBorder+2*b.ThumbnailPadding,c=b.ThumbnailPanelEdgeToSlideEdge+a+this.thImgArea.width,g=a+this.thImgArea.height;this.thumbnailContainer.style.width=b.PixelToCss(c);this.thumbnailContainer.style.height=b.PixelToCss(g);g=2*b.ThumbnailInnerBorder+2*b.ThumbnailPadding;c=g+this.thImgArea.width;g+=this.thImgArea.height;this.thumbnailOuterBorder.style.width=
b.PixelToCss(c);this.thumbnailOuterBorder.style.height=b.PixelToCss(g);this.thumbnailImageContainer.style.width=b.PixelToCss(this.thImgArea.width);this.thumbnailImageContainer.style.height=b.PixelToCss(this.thImgArea.height);this.thumbnailContainer.style.top=b.PixelToCss(this.parent.distanceBetweenThumbnails*this.index+b.ThumbnailTopEdgeToSlideEdge);this.isRtl?this.thumInfoContainer.style.left=b.PixelToCss(b.ThumbnailNumberEdgeToSlideEdge+a+this.thImgArea.width):this.thumInfoContainer.style.right=
b.PixelToCss(b.ThumbnailNumberEdgeToSlideEdge+a+this.thImgArea.width);this.img.style.position=b.StylePositionAbsolute;this.isRtl?this.img.style.right=b.PixelToCss(b.ThumbnailPadding):this.img.style.left=b.PixelToCss(b.ThumbnailPadding);this.img.style.top=b.PixelToCss(b.ThumbnailPadding);this.img.style.width="100%";this.img.style.height="100%"};a.prototype.SetHidden=function(){b.AddCssClass(this.thumbnailImageContainer,this.c_viewerThumbnailHiddenClassName);b.AddCssClass(this.slideNumberEl,this.c_viewerThumbnailHiddenClassName)};
a.prototype.ShowAnimationEffect=function(a,b){if(void 0!=b){var c=b(a);c.style.visibility="visible";this.thumInfoContainer.appendChild(c)}};a.prototype.SetSelected=function(a,c){a?(b.AddCssClass(this.thumbnailImageContainer,this.c_viewerThumbnailSelectedClassName),b.AddCssClass(this.slideNumberEl,this.c_viewerThumbnailSelectedClassName),this.thumbnailContainer.setAttribute("aria-selected","true")):(b.RemoveCssClass(this.thumbnailImageContainer,this.c_viewerThumbnailSelectedClassName),b.RemoveCssClass(this.slideNumberEl,
this.c_viewerThumbnailSelectedClassName),this.thumbnailContainer.setAttribute("aria-selected","false"));c&&this.thumbnailContainer.focus()};a.prototype.SetAccessibilityAttributes=function(a){this.img.title=a;this.thumbnailContainer.setAttribute("aria-posinset",(this.index+1).toString());this.thumbnailContainer.setAttribute("aria-setsize",this.parent.thumbnails.length.toString());if(this.parent&&this.parent.parent){var b=this.parent.parent.thumbnailInfoLabel,b=e.format(b,a);this.thumbnailContainer.setAttribute("aria-label",
b)}};a.prototype.SetImage=function(a){this.img.src=a;this.FImageSet=!0};a.prototype.TryCreateDiffBackgroundDiv=function(){var a=document.createElement("div");a.style.width=b.PixelToCss(this.isRtl?this.thumbnailOuterBorder.getBoundingClientRect().right:this.thumbnailOuterBorder.offsetLeft+this.thumbnailOuterBorder.offsetWidth);this.isRtl?a.style.right=b.PixelToCss(Math.min(this.thumbnailOuterBorder.getBoundingClientRect().right,-7)-2):a.style.left=b.PixelToCss(Math.min(this.thumbnailImageContainer.offsetLeft,
-7)-2);a.style.height=b.PixelToCss(6+Math.abs(this.thumbnailOuterBorder.offsetTop)+this.thumbnailOuterBorder.offsetHeight);a.style.top=b.PixelToCss(this.thumbnailOuterBorder.offsetTop-2);a.className=this.c_viewerThumbnailDiffClassName;return a};a.prototype.CreateFlyout=function(){var a=document.createElement("span");a.innerText=this.revisionTrackingFlyoutContent;return a};a.prototype.ShowDiffbackground=function(){var a=this;this.isModernCatchUpUxEnable?(this.isRevisionTrackingFlyoutEnabled&&(null==
this.revisionTrackingContainer&&(this.revisionTrackingContainer=document.createElement("div"),this.revisionTrackingContainer.className=this.isRtl?this.c_viewerThumbRtContainerRtlClassName:this.c_viewerThumbRtContainerClassName),null==this.revisionTrackingFlyoutContainer&&(this.revisionTrackingFlyoutContainer=document.createElement("div")),null==this.revisionTrackingFlyout&&(this.revisionTrackingFlyout=this.CreateFlyout()),this.revisionTrackingFlyoutContainer.appendChild(this.revisionTrackingFlyout),
this.revisionTrackingFlyoutContainer.className=this.isRtl?this.c_viewerThumbRtFlyoutContainerRtlClassName:this.c_viewerThumbRtFlyoutContainerClassName,this.revisionTrackingFlyoutContainer.style.visibility=b.StyleHidden),null==this.revisionTrackingIconContainer&&(this.revisionTrackingIconContainer=document.createElement("div"),this.isRevisionTrackingFlyoutEnabled&&(this.revisionTrackingIconContainer.addEventListener("mouseover",function(){a.revisionTrackingFlyoutContainer.style.visibility=b.StyleVisible}),
this.revisionTrackingIconContainer.addEventListener("mouseout",function(){a.revisionTrackingFlyoutContainer.style.visibility=b.StyleHidden}))),null==this.revisionTrackingIcon&&(this.revisionTrackingIcon=d.TryCreateModernDiffIcon()),this.revisionTrackingIconContainer.className=this.isRtl?this.c_viewerThumbnailDiffIconContainerRtlClassName:this.c_viewerThumbnailDiffIconContainerClassName,this.revisionTrackingIconContainer.appendChild(this.revisionTrackingIcon),this.revisionTrackingIconContainer.style.visibility=
b.StyleVisible,this.isRevisionTrackingFlyoutEnabled?(this.revisionTrackingContainer.appendChild(this.revisionTrackingIconContainer),this.revisionTrackingContainer.appendChild(this.revisionTrackingFlyoutContainer),this.thumInfoContainer.appendChild(this.revisionTrackingContainer)):this.thumInfoContainer.appendChild(this.revisionTrackingIconContainer)):(null==this.thumbDiffBackgroundEl&&(this.thumbDiffBackgroundEl=this.TryCreateDiffBackgroundDiv(),this.revisionTrackingIcon=d.TryCreateDiffIcon(),this.revisionTrackingIcon.style.position=
"absolute",this.revisionTrackingIcon.style.bottom=b.PixelToCss(3),this.isRtl?this.revisionTrackingIcon.style.right=b.PixelToCss(3):this.revisionTrackingIcon.style.left=b.PixelToCss(3),this.thumbDiffBackgroundEl.appendChild(this.revisionTrackingIcon),this.thumInfoContainer.appendChild(this.thumbDiffBackgroundEl)),this.thumbDiffBackgroundEl.style.visibility=b.StyleVisible)};return a}();b.ViewerThumbnail=a})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,c){void 0===c&&(c=!1);var d=this;this.c_viewerThumbnailPaneId="PowerPointDocumentViewerThumbnailPane"+Math.random();this.c_viewerThumbnailPaneClassName="PowerPointDocumentViewerThumbnailPane";this.c_viewerThumbnailPaneRtlClassName="PowerPointDocumentViewerThumbnailPaneRtl";this.c_ariaLiveRegionId="application_AssertiveNotifier"+Math.random();this.c_ariaLiveRegionClass="VHAriaLiveRegion";this.thumbnails=[];this.activeThumbnailIndex=-1;this.activeThumbnailIndexes=
[];this.visibleSlideRange=new b.SlideRange(0,0);this.OnSelectedThumbnailIndexChanged=new Util.TEvent;this.OnVisibleSlideRangeChanged=new Util.TEvent;this.OnCopyThumbnails=new Util.TEvent;this.parent=a;this.isRtl=c;this.rootElement=document.createElement("div");this.rootElement.id=this.c_viewerThumbnailPaneId;this.rootElement.tabIndex=-1;this.rootElement.className=c?this.c_viewerThumbnailPaneRtlClassName:this.c_viewerThumbnailPaneClassName;this.tabIndexValue=0;this.thImgarea=b.GetThumbnailDimensions(this.parent.slideWidth,
this.parent.slideHeight);this.distanceBetweenThumbnails=this.thImgarea.height+b.ThumbnailVerticalSpacing;this.rootElement.addEventListener("keydown",function(a){d.ProcessKeyboardInput(a)});this.rootElement.addEventListener("scroll",function(a){d.ProcesScroll(a,!1)});this.rootElement.addEventListener("contextmenu",function(a){d.ProcessContextMenu(a)});this.rootElement.setAttribute("role","list");this.rootElement.setAttribute("aria-label",this.parent.thumbnailPaneLabel);this.rootElement.addEventListener("mousedown",
function(){d.rootElement.classList.remove("PPTVHViewerElementSelected")});this.rootElement.addEventListener("blur",function(){d.rootElement.classList.remove("PPTVHViewerElementSelected")});this.ariaLiveRegion=document.createElement("div");this.ariaLiveRegion.className=this.c_ariaLiveRegionClass;this.ariaLiveRegion.id=this.c_ariaLiveRegionId;this.rootElement.appendChild(this.ariaLiveRegion);this.isCopySlidesEnabled=this.parent.isCopySlidesEnabled;this.isModernCatchUpUxEnable=this.parent.isModernCatchUpUxEnable;
this.isRevisionTrackingFlyoutEnabled=this.parent.isRevisionTrackingFlyoutEnabled;this.revisionTrackingFlyoutContent=this.parent.revisionTrackingFlyoutContent}Object.defineProperty(d.prototype,"ThumbnailPaneId",{get:function(){return this.rootElement.id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"AriaId",{get:function(){return this.c_ariaLiveRegionId},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"RootElement",{get:function(){return this.rootElement},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"Thumbnails",{get:function(){return this.thumbnails},enumerable:!0,configurable:!0});d.prototype.SetAriaLive=function(a){this.ariaLiveRegion.textContent=a};Object.defineProperty(d.prototype,"SelectedThumbnailIndex",{get:function(){return this.activeThumbnailIndex},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"SelectedThumbnailIndexes",{get:function(){return this.activeThumbnailIndexes},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"VisibleSlideRange",{get:function(){return this.visibleSlideRange},set:function(a){if(a.m_firstSlideIndex!=this.visibleSlideRange.m_firstSlideIndex||a.m_numSlides!=this.visibleSlideRange.m_numSlides)this.visibleSlideRange=a,this.OnVisibleSlideRangeChanged.Signal(this,null)},enumerable:!0,configurable:!0});d.prototype.Layout=function(){this.thImgarea=b.GetThumbnailDimensions(this.parent.slideWidth,this.parent.slideHeight);this.distanceBetweenThumbnails=this.thImgarea.height+b.ThumbnailVerticalSpacing;
this.rootElement.style.top=b.ZeroPixel;var a=b.GetSrollBarWidth();this.rootElement.style.width=b.PixelToCss(b.ThumbnailPaneAreaWidth+1+a-1);this.rootElement.style.height=b.PixelToCss(b.CssToPixel(this.parent.rootElement.style.height)-b.CssToPixel(this.rootElement.style.top)-b.StatusBarHeight-1);this.rootElement.style.visibility=b.StyleVisible;this.thumbnails.forEach(function(a){return a.Layout()})};d.prototype.AddThumbnail=function(a){a=new b.ViewerThumbnail(this,a,this.thImgarea,this.isRtl);this.rootElement.appendChild(a.thumbnailContainer);
a.Layout();this.thumbnails.push(a)};d.prototype.SelectThumbnail=function(a,b){this.SetSelectedThumbnailIndex(a,b)};d.prototype.SelectThumbnails=function(a,b){this.SetSelectedThumbnailIndexes(a,b)};d.prototype.SetSelectedThumbnailIndex=function(a,b){if(this.isCopySlidesEnabled){if(this.activeThumbnailIndex==a&&1==this.activeThumbnailIndexes.length)return;for(var d=0;d<this.activeThumbnailIndexes.length;d++)this.thumbnails[this.activeThumbnailIndexes[d]].SetSelected(!1,!1);this.activeThumbnailIndexes.splice(0,
this.activeThumbnailIndexes.length);this.activeThumbnailIndexes.push(a)}else{if(this.activeThumbnailIndex==a)return;0<=this.activeThumbnailIndex&&this.thumbnails[this.activeThumbnailIndex].SetSelected(!1,b)}this.thumbnails[a].SetSelected(!0,b);this.ScrollThumbnailIntoView(a);this.activeThumbnailIndex=a;this.OnSelectedThumbnailIndexChanged.Signal(this,null)};d.prototype.SetSelectedThumbnailIndexes=function(a,b){if(this.activeThumbnailIndex!=a||1!=this.activeThumbnailIndexes.length){var d=this.activeThumbnailIndexes.indexOf(a);
-1!=d?(this.activeThumbnailIndexes.splice(d,1),this.thumbnails[a].SetSelected(!1,!1),this.activeThumbnailIndex==a&&(this.activeThumbnailIndex=this.activeThumbnailIndexes[this.activeThumbnailIndexes.length-1],this.OnSelectedThumbnailIndexChanged.Signal(this,null))):(this.thumbnails[a].SetSelected(!0,b),this.ScrollThumbnailIntoView(a),this.activeThumbnailIndex=a,this.activeThumbnailIndexes.push(a),this.OnSelectedThumbnailIndexChanged.Signal(this,null))}};d.prototype.SelectThumbnailsInRange=function(a,
b){for(var d=[],f=a;f<=b;f++)d.push(f);this.SetThumbnailCollection(d)};d.prototype.CopyThumbnails=function(){this.OnCopyThumbnails.Signal(this,null)};d.prototype.ScrollThumbnailIntoView=function(a){var c=this.rootElement.scrollTop,d=this.rootElement.offsetHeight;a=this.distanceBetweenThumbnails*a+b.ThumbnailTopEdgeToSlideEdge;var f=this.thImgarea.height+b.ThumbnailVerticalSpacing;a<c?this.rootElement.scrollTop=a:(d+=c,a=f+a,a>d&&(this.rootElement.scrollTop=c+(a-d)))};d.prototype.ProcessKeyboardInput=
function(a){var b;if(!a.shiftKey)switch(a.key){case "Down":case "PageDown":case "ArrowDown":b=this.activeThumbnailIndex+1;b<this.thumbnails.length&&this.SelectThumbnail(b,!0);a.stopPropagation();a.preventDefault();break;case "Up":case "PageUp":case "ArrowUp":b=this.activeThumbnailIndex-1;0<=b&&this.SelectThumbnail(b,!0);a.stopPropagation();a.preventDefault();break;case "End":b=this.thumbnails.length-1;b!=this.activeThumbnailIndex&&this.SelectThumbnail(b,!0);break;case "Home":b=0;b!=this.activeThumbnailIndex&&
this.SelectThumbnail(b,!0);break;case "Tab":b=this.activeThumbnailIndex+1;b<this.thumbnails.length?this.SelectThumbnail(b,!0):this.SelectThumbnail(0,!0);a.stopPropagation();a.preventDefault();break;case "c":case "C":this.isCopySlidesEnabled&&a.ctrlKey&&(this.CopyThumbnails(),a.stopPropagation(),a.preventDefault());break;case "a":case "A":this.isCopySlidesEnabled&&a.ctrlKey&&(this.SelectThumbnailsInRange(0,this.Thumbnails.length-1),this.ScrollThumbnailIntoView(this.Thumbnails.length-1),a.stopPropagation(),
a.preventDefault())}else if(a.shiftKey)switch(a.key){case "Down":case "ArrowDown":case "Up":case "ArrowUp":case "End":case "Home":this.isCopySlidesEnabled&&(this.HandleUpDownMultiSelectThumbnails(a),a.stopPropagation(),a.preventDefault());break;case "PageDown":case "PageUp":this.isCopySlidesEnabled&&(this.HandlePageUpPageDownMultiSelectThumbnails(a),a.stopPropagation(),a.preventDefault());break;case "Tab":b=this.activeThumbnailIndex-1,0<=b?this.SelectThumbnail(b,!0):this.SelectThumbnail(this.thumbnails.length-
1,!0),a.stopPropagation(),a.preventDefault()}};d.prototype.ProcessContextMenu=function(a){-1==this.activeThumbnailIndex&&this.SuppressContextMenu(a)};d.prototype.SuppressContextMenu=function(a){a.stopPropagation();a.preventDefault();return!1};d.prototype.HandleUpDownMultiSelectThumbnails=function(a){var b=this.SelectedThumbnailIndexes.slice();b.sort(function(a,b){return a-b});var d=b[0],f=b[b.length-1],g=this.Thumbnails.length,h=this.activeThumbnailIndex,k=h,e=h,q=!0;if(!(1>=g)){switch(a.key){case "Down":case "ArrowDown":1==
b.length?e=h<g-1?h+1:h:h==d&&f<g-1?e=f+1:h==d&&f==g-1?q=!1:k=d+1;break;case "Up":case "ArrowUp":1==b.length?k=0<=h-1?h-1:h:h==d?e=0<=f-1?f-1:f:0==d?q=!1:k=d-1;break;case "End":e=g-1;break;case "Home":k=0}q&&(this.SelectThumbnailsInRange(k,e),this.ScrollThumbnailIntoView(k==h?e:k))}};d.prototype.HandlePageUpPageDownMultiSelectThumbnails=function(a){var b=this.SelectedThumbnailIndexes.slice();b.sort(function(a,b){return a-b});var d=b[0],f=b[b.length-1],g=this.Thumbnails.length,h=this.activeThumbnailIndex,
k=-1;if(!(1>=g)){switch(a.key){case "PageDown":if(h==g-1)break;k=h+1;1<b.length&&h==d&&this.AreContinuousThumbnails(b)&&this.RemoveThumbnailFromCollection(h);break;case "PageUp":if(0==h)break;k=h-1;1<b.length&&h==f&&this.AreContinuousThumbnails(b)&&this.RemoveThumbnailFromCollection(h);break;case "c":case "C":this.isCopySlidesEnabled&&a.ctrlKey&&(this.CopyThumbnails(),a.stopPropagation(),a.preventDefault())}-1!=k&&(this.activeThumbnailIndex=k,this.AddThumbnailToCollection(k),this.ScrollThumbnailIntoView(k),
this.OnSelectedThumbnailIndexChanged.Signal(this,null))}};d.prototype.SetThumbnailCollection=function(a){for(var b=[],d=this.activeThumbnailIndexes.slice(),f=0;f<a.length;f++){var g=d.indexOf(a[f],0);-1!=g&&d.splice(g,1)}for(f=0;f<a.length;f++)g=this.activeThumbnailIndexes.indexOf(a[f],0),-1==g&&(b.push(a[f]),this.activeThumbnailIndexes.push(a[f]));for(f=0;f<d.length;f++)g=this.activeThumbnailIndexes.indexOf(d[f],0),-1!=g&&this.activeThumbnailIndexes.splice(g,1);for(f=0;f<d.length;f++)this.thumbnails[d[f]].SetSelected(!1,
!1);for(f=0;f<b.length;f++)this.thumbnails[b[f]].SetSelected(!0,!0)};d.prototype.AreContinuousThumbnails=function(a){if(0==a.length)return!1;for(var b=0;b<a.length-1;b++)if(1!=a[b+1]-a[b])return!1;return!0};d.prototype.AddThumbnailToCollection=function(a){-1==this.activeThumbnailIndexes.indexOf(a,0)&&(this.activeThumbnailIndexes.push(a),this.thumbnails[a].SetSelected(!0,!0))};d.prototype.RemoveThumbnailFromCollection=function(a){var b=this.activeThumbnailIndexes.indexOf(a,0);-1!=b&&(this.activeThumbnailIndexes.splice(b,
1),this.thumbnails[a].SetSelected(!1,!1))};d.prototype.CalculateVisibleSlideRange=function(){try{var a=new b.SlideRange(0,0);if(0<this.thumbnails.length)var c=Math.floor(Math.max(this.rootElement.scrollTop-b.ThumbnailTopEdgeToSlideEdge,0)/this.distanceBetweenThumbnails),c=Math.min(this.thumbnails.length-1,c),a=new b.SlideRange(c,Math.min(this.thumbnails.length-1,c+(Math.floor(Math.max(this.rootElement.offsetHeight-b.ThumbnailTopEdgeToSlideEdge,0)/this.distanceBetweenThumbnails)+1))-c+1);this.VisibleSlideRange=
a}catch(d){}};d.prototype.ProcesScroll=function(a,b){this.CalculateVisibleSlideRange()};return d}();b.ViewerThumbnailPane=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function b(a,c){this.m_firstSlideIndex=a;this.m_numSlides=c}b.FromFirstLastIndexes=function(a,c){return c<a?b.Empty:new b(a,c-a+1)};b.Equals=function(a,b){return 0>=a.m_numSlides&&0>=b.m_numSlides?!0:a.m_firstSlideIndex==b.m_firstSlideIndex&&a.m_numSlides==b.m_numSlides};b.prototype.ExtendLeft=function(a){return 0==this.m_numSlides?b.Empty:b.FromFirstLastIndexes(Math.max(0,this.m_firstSlideIndex-a),this.LastSlideIndex)};b.prototype.ExtendRight=function(a,c){return 0==
this.m_numSlides?b.Empty:(new b(this.m_firstSlideIndex,this.m_numSlides+a)).ClipToMaxItemCount(c)};Object.defineProperty(b.prototype,"Indexes",{get:function(){for(var a=Array(this.m_numSlides),b=this.m_firstSlideIndex,d=0;d<a.length;++d)a[d]=b++;return a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"LastSlideIndex",{get:function(){return this.m_firstSlideIndex+this.m_numSlides-1},enumerable:!0,configurable:!0});b.prototype.ClipToMaxItemCount=function(a){if(0>=a||0>=this.m_numSlides)return b.Empty;
--a;return this.LastSlideIndex>a?new b(this.m_firstSlideIndex,this.m_numSlides-(this.LastSlideIndex-a)):this};b.Empty=new b(0,0);return b}();b.SlideRange=e})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){(function(a){a.NotesButtonClicked="NotesButtonClicked";a.RootContainerResized="RootContainerResized";a.SelectThumbnailEvent="SelectThumbnailEvent";a.VisibleThumbnailsRangeChanged="VisibleThumbnailsRangeChanged"})(b.ViewerEventType||(b.ViewerEventType={}));var e=function(){return function(){}}();b.ViewerEventArgs=e;e=function(){function a(){}a.GetSingleton=function(){null==this.m_viewerEventManager&&(this.m_viewerEventManager=new d);return this.m_viewerEventManager};return a}();b.ViewerEventManagerSingleton=
e;var d=function(){function a(){this.OnViewerEvent=new Util.TEvent}a.prototype.FireEvent=function(a,b){try{this.OnViewerEvent.Signal(a,b)}catch(d){}};a.prototype.RegisterEventHandler=function(a){try{this.OnViewerEvent.Subscribe(a.bind(this))}catch(b){}};return a}();b.ViewerEventManager=d})(PowerPointDocumentViewer||(PowerPointDocumentViewer={}));
(function(b){var e=function(){function d(a,b){this.parentElement=a;this.appBootSettings=b;this.appVersionRootElement=document.createElement("div");this.initVersionViewerRootElement()}d.prototype.switchParentViewContainer=function(a){null!=a&&(null!=this.parentElement&&(this.parentElement.removeChild(this.appVersionRootElement),this.unregisterWindowResizeHandler()),this.parentElement=a,this.parentElement.appendChild(this.appVersionRootElement),this.registerWindowResizeHandler())};Object.defineProperty(d.prototype,
"versionViewerRootElement",{get:function(){return this.appVersionRootElement},enumerable:!0,configurable:!0});d.prototype.initVersionViewerRootElement=function(){if(null!=this.appBootSettings&&""!==this.appBootSettings.VersionViewerCssUrl){var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.href=this.appBootSettings.VersionViewerCssUrl;this.appVersionRootElement.appendChild(a)}a="PowerPointVersionViewerRootContainer"+b.BrowserUtils.randomValueHex(10);this.appVersionRootElement.id=
a;this.appVersionRootElement.className="PowerPointVersionViewerRootContainer";this.appVersionRootElement.style.width="100%";this.appVersionRootElement.style.height="100%";this.appVersionRootElement.style.position=PowerPointDocumentViewer.StylePositionRelative;null!=this.parentElement&&(this.parentElement.appendChild(this.appVersionRootElement),this.registerWindowResizeHandler())};d.prototype.registerWindowResizeHandler=function(){window.addEventListener("resize",this.onContainerResized)};d.prototype.unregisterWindowResizeHandler=
function(){window.removeEventListener("resize",this.onContainerResized)};d.prototype.onContainerResized=function(){var a={viewerEventType:PowerPointDocumentViewer.ViewerEventType.RootContainerResized,eventData:{}};PowerPointDocumentViewer.ViewerEventManagerSingleton.GetSingleton().FireEvent(this,a)};return d}();b.VersionViewerRootContainerImpl=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=Microsoft.VersionHistory.ConsoleSessionLogger,a=Microsoft.VersionHistory.UlsSessionLogger,c=Microsoft.VersionHistory.VersionHistoryLogHelper,l=Microsoft.VersionHistory.PLTEventType,f=function(){function g(c,g,f){this.m_docControllers={};this.versionDelayedActionsTimer=0;this.m_settings=c;c=this.m_settings.UseConsoleSessionLogger?new d:new a(this.m_settings.UserSessionId,this.m_settings.RenderServiceBase);e.init(c);this.parentElement=g;this.m_dataStore=
new b.DataStore;this.versionViewerRootContainer=new b.VersionViewerRootContainerImpl(this.parentElement,this.m_settings);this.appCallbackBag=f;b.DocProxy.Init(this.m_settings)}g.prototype.getAppDataStore=function(){return this.m_dataStore};g.prototype.onVersionSelected=function(a,g,d){try{c.appTelemetryDictionary=d;c.addDocPLTEventToLog(a.RevisionID,l.OnVersionSelectStart,"");var f=this.m_docControllers[a.RevisionID];f&&f.GetDocumentState().VersionInfo.DownloadUrl!==a.DownloadUrl&&f.AdjustVersionInfo(a);
if(this.m_selectedRevisionID==a.RevisionID){c.addDocPLTEventToLog(this.m_selectedRevisionID,l.OnVersionSelectEnd,"");this.m_docControllers[this.m_selectedRevisionID].LayoutView();return}e.traceTag(39347460,logCategory.PptSession,logLevel.Info,"onVersionSelected: RevisionID: "+a.RevisionID+", CurrentTime: "+Date.now()+".");var m=this.m_docControllers[this.m_selectedRevisionID];if(null==f){var n=new b.PresentationInfo;this.m_dataStore.AddPresentationInfoToStore(a.RevisionID,n);this.m_dataStore.AddVersionInfoToStore(a);
f=new b.DocController(this.m_settings,n,this.appCallbackBag,a,this.versionViewerRootContainer.versionViewerRootElement,this.m_dataStore);this.m_docControllers[a.RevisionID]=f;c.setIsVersionLoadForFirstTime(a.RevisionID,!0)}d=null;n=-1;null!=m&&(d=m.GetDocumentState().GetSelectedThumbnail(),n=m.GetDocumentState().GetSelectedThumbnailIndex());null!=m&&m.Hide();this.m_selectedRevisionID=a.RevisionID;f.Show(d,n);if(null==g){c.addDocPLTEventToLog(this.m_selectedRevisionID,l.OnVersionSelectEnd,"");return}this.tryGetDocDiff(a,
g)}catch(r){e.traceTag(39658655,logCategory.PptSession,logLevel.Error,"onVersionSelected exception: RevisionID: "+a.RevisionID+", e: "+r),c.addDocPLTEventToLog(this.m_selectedRevisionID,l.OnVersionSelectFailure,"")}c.addDocPLTEventToLog(this.m_selectedRevisionID,l.OnVersionSelectEnd,"")};g.prototype.diff=function(a,b){e.traceTag(40477913,logCategory.PptSession,logLevel.Info,"AppVersionController - diff: RevisionID[N]: "+a.RevisionID+", RevisionID[N-1]: "+b.RevisionID);this.tryGetDocDiff(a,b)};g.prototype.switchParentViewContainer=
function(a){try{this.parentElement=a,this.versionViewerRootContainer.switchParentViewContainer(a),this.m_docControllers[this.m_selectedRevisionID].LayoutView()}catch(b){e.traceTag(39982535,logCategory.PptSession,logLevel.Error,"AppVersionController - Exception in switchParentViewContainer: "+b)}};g.prototype.onCopySlides=function(){this.m_docControllers[this.m_selectedRevisionID].CopySlides()};g.prototype.tryGetDocDiff=function(a,g){var d=this;if(null!=g&&null!==a.DownloadUrl&&""!==a.DownloadUrl&&
null!==g.DownloadUrl&&""!==g.DownloadUrl){if(null==this.m_dataStore.GetDocDiff(a.RevisionID,g.RevisionID)){var f={DocID:"",RevisionID:a.RevisionID,DownloadUrl:a.DownloadUrl,ETag:"",FileLengthHint:0,CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1},l={DocID:"",RevisionID:g.RevisionID,DownloadUrl:g.DownloadUrl,ETag:"",FileLengthHint:0,CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1},n=Date.now();b.DocProxy.GetDocDiff(f,l,function(a,
g,k){try{var h=Date.now();c.logEplapsedTime("GetDocDiff request succeeded.",logLevel.Info,n,h,"","");d.onGetDocDiffSuccess(a,g,k)}catch(f){d.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderDiff),e.traceTag(40125908,logCategory.PptSession,logLevel.Error,"GetDocDiff - Exception in onSuccess: "+f)}},function(){d.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderDiff);try{var a=Date.now();c.logEplapsedTime("GetDocDiff request failed.",logLevel.Error,n,a,"","")}catch(g){e.traceTag(39982534,
logCategory.PptSession,logLevel.Error,"GetDocDiff - Exception in onFail: "+g)}})}}else e.traceTag(40477914,logCategory.PptSession,logLevel.Info,"GetDocDiff - either the download url in baseVersionInfo or selectedVersionInfo is null or empty.")};g.prototype.onGetDocDiffSuccess=function(a,b,c){this.m_dataStore.AddDocDiff(a,b,c);a=this.m_docControllers[a];null!=a&&a.SetDocDiff(c)};g.prototype.reportErrorToApp=function(a){null!=this.appCallbackBag.reportViewerErrorCallback&&this.appCallbackBag.reportViewerErrorCallback(a)};
return g}();b.AppVersionController=f})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=function(){return function(){}}();b.AppBootSettings=e;e=function(){return function(){}}();b.AppCallbackBag=e;e=function(){return function(){}}();b.SlidePrefetchSettings=e;(function(b){b[b.None=0]="None";b[b.VHFailedToRenderThumbnails=100]="VHFailedToRenderThumbnails";b[b.VHFailedToRenderSlide=101]="VHFailedToRenderSlide";b[b.VHFailedToRenderNotes=102]="VHFailedToRenderNotes";b[b.VHFailedToRenderDiff=103]="VHFailedToRenderDiff";b[b.VHFailedToShowAnimaitonIcon=104]="VHFailedToShowAnimaitonIcon";
b[b.VHFailedToShowHiddenEffect=105]="VHFailedToShowHiddenEffect";b[b.VHFailedToRenderInitPresInfo=106]="VHFailedToRenderInitPresInfo";b[b.VHFailedToRenderNavigableSlides=107]="VHFailedToRenderNavigableSlides";b[b.VHSynchronizerTimeOut=108]="VHSynchronizerTimeOut"})(b.VersionViewerErrorCode||(b.VersionViewerErrorCode={}))})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}a["default"]=function(){return function(a,b){return a===b}};return a}();b.EqualUtil=a;a=function(){function a(b,c){this.m_items=[];this.m_compare=b;c&&this.unionWith(c)}a.prototype.contains=function(a){var b=this;return this.m_items.some(function(c){return b.m_compare(a,c)})};a.prototype.add=function(a){if(this.contains(a))return!1;this.m_items.push(a);return!0};a.prototype.unionWith=function(a){for(var b=0;b<a.length;b++)this.add(a[b])};
a.prototype.remove=function(a){for(var b=0;b<this.m_items.length;b++)if(this.m_compare(this.m_items[b],a))return this.m_items.splice(b,1),!0;return!1};Object.defineProperty(a.prototype,"count",{get:function(){return this.m_items.length},enumerable:!0,configurable:!0});a.prototype.intersectWith=function(a){for(var b=this,c=[],d=function(d){a.some(function(a){return b.m_compare(a,d)})&&c.push(d)},k=0,e=this.m_items;k<e.length;k++)d(e[k]);this.m_items=c};a.prototype.exceptWith=function(a){for(var b=
0;b<a.length;b++)this.remove(a[b])};Object.defineProperty(a.prototype,"values",{get:function(){return this.m_items.map(function(a){return a})},enumerable:!0,configurable:!0});return a}();b.ArraySet=a})(b.Collections||(b.Collections={}))})(b.Office||(b.Office={}))})(Microsoft||(Microsoft={}));
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=function(){function a(){this.m_versions=[];this.m_presentations={};this.m_docDiffs={}}Object.defineProperty(a.prototype,"VersionInfos",{get:function(){return this.m_versions},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Versions",{get:function(){return this.m_versions},enumerable:!0,configurable:!0});a.prototype.GetVersionInfoFromStore=function(a){for(var b=0;b<this.m_versions.length;b++)if(this.m_versions[b].RevisionID==
a)return this.m_versions[b];return null};a.prototype.GetPresentationInfoFromStore=function(a){return this.m_presentations[a]};a.prototype.AddVersionInfoToStore=function(a){e.traceTag(39408203,logCategory.PptSession,logLevel.Info,"DataStore::AddVersionInfoToStore RevisionId:"+a.RevisionID+" Time:"+a.Time);if(this.m_versions.some(function(b){return b.RevisionID==a.RevisionID}))return!1;try{this.m_versions.push(a)}catch(b){return!1}return!0};a.prototype.AddPresentationInfoToStore=function(a,b){if(null==
b||null!=this.m_presentations[a])return!1;this.m_presentations[a]=b;return!0};a.prototype.AddDocDiff=function(a,b,d){if(null==d)return!1;a=a+"-"+b;if(null!=this.m_docDiffs[a])return!1;this.m_docDiffs[a]=d;return!0};a.prototype.GetDocDiff=function(a,b){return this.m_docDiffs[a+"-"+b]};return a}();b.DataStore=d})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=Microsoft.VersionHistory.VersionHistoryLogHelper,a=Microsoft.VersionHistory.PLTEventType,c=Microsoft.Office.WebClient.PowerPoint.Utils,l=function(){function f(c,h,k,f,l,m){var n=this;this.m_docVersionInfo=f;this.m_presInfo=h;this.m_documentState=new b.DocumentState;this.m_parentElement=l;this.m_documentState.m_lastHideDocTime=-1;this.m_documentState.m_lastShowDocTime=Date.now();this.m_documentState.m_visibleThumbnailRange=new PowerPointDocumentViewer.SlideRange(0,
0);this.m_documentState.m_selectedThumbnail={sid:0,cid:0};this.m_documentState.m_displayedSlide={sid:0,cid:0};this.m_documentState.m_clientHeight=this.m_parentElement.clientHeight;this.m_documentState.m_clientWidth=this.m_parentElement.clientWidth;this.m_documentState.m_presInfo=h;this.m_documentState.m_versionInfo=f;this.appCallbackBag=k;this.m_versionDelayedActionDelay=c.SlidePrefetchSettings.SlidePrefetchDelay;h=0<c.DefaultSlideWidth?c.DefaultSlideWidth:PowerPointDocumentViewer.DefaultSlideWidth;
k=0<c.DefaultSlideHeight?c.DefaultSlideHeight:PowerPointDocumentViewer.DefaultSlideHeight;this.m_docContainer=new PowerPointDocumentViewer.ViewerRootContainer({progressImageResourceUrl:c.ProgressImageResourceUrl,slideInformationLabel:c.SlideInformationLabel,notesButtonLabel:c.NotesButtonLabel,slideHeight:this.m_presInfo.PresSettings?this.m_presInfo.PresSettings.SlideHeight:k,slideWidth:this.m_presInfo.PresSettings?this.m_presInfo.PresSettings.SlideWidth:h,isRtl:c.IsRtl,isRootContainerPositionAbsolute:c.IsRootContainerPositionAbsolute,
isCopySlidesEnabled:c.IsCopySlidesEnabled,slidePaneLabel:c.SlidePaneLabel,thumbnailPaneLabel:c.ThumbnailPaneLabel,notesPaneLabel:c.NotesPaneLabel,statusBarLabel:c.StatusBarLabel,enableOverflowXOnSlideAndNotePane:c.EnableOverflowXOnSlideAndNotePane,thumbnailInfoLabel:c.ThumbnailInfoLabel,isModernCatchUpUxEnable:c.IsModernCatchUpUxEnable,isRevisionTrackingFlyoutEnabled:c.IsRevisionTrackingFlyoutEnabled,revisionTrackingFlyoutContent:c.RevisionTrackingFlyoutContent},this.m_parentElement,0<c.DefaultNotesHeight?
c.DefaultNotesHeight:PowerPointDocumentViewer.NotesHeightDefault);this.m_docVersionInfo.DownloadUrl&&-1!==this.m_docVersionInfo.DownloadUrl.indexOf("downloads.ashx")?d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.CreateDocControllerWithVHS,""):d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.CreateDocControllerWithSnap,"");null!=this.appCallbackBag.notesIconDecoratorCallback&&(this.m_docContainer.viewerStatusBar.NotesIconElement=this.appCallbackBag.notesIconDecoratorCallback());
null!=this.appCallbackBag.addToF6LoopCallback&&(this.appCallbackBag.addToF6LoopCallback(this.m_docContainer.ThumbnailPane.ThumbnailPaneId),this.appCallbackBag.addToF6LoopCallback(this.m_docContainer.SlidePane.SlidePaneId),this.appCallbackBag.addToF6LoopCallback(this.m_docContainer.StatusBar.StatusBarNotesButtonId),this.appCallbackBag.addToF6LoopCallback(this.m_docContainer.NotesPane.NotesPaneId));h=this.m_docContainer.ThumbnailPane;h.OnSelectedThumbnailIndexChanged.Subscribe(function(a,b){e.traceTag(40649678,
logCategory.PptSession,logLevel.Verbose,"DocController::constructor OnSelectedThumbnailIndexChanged SelectedThumbnailIndex:"+a.SelectedThumbnailIndex);var c={viewerEventType:PowerPointDocumentViewer.ViewerEventType.SelectThumbnailEvent,eventData:{index:a.SelectedThumbnailIndex}};PowerPointDocumentViewer.ViewerEventManagerSingleton.GetSingleton().FireEvent(a,c)});h.OnVisibleSlideRangeChanged.Subscribe(function(a,b){e.traceTag(39383062,logCategory.PptSession,logLevel.Verbose,"DocController::constructor OnVisibleSlideRangeChanged FirstSlideIndex:"+
a.VisibleSlideRange.m_firstSlideIndex+" NumSlides:"+a.VisibleSlideRange.m_numSlides);var c={viewerEventType:PowerPointDocumentViewer.ViewerEventType.VisibleThumbnailsRangeChanged,eventData:{slideRange:a.VisibleSlideRange}};PowerPointDocumentViewer.ViewerEventManagerSingleton.GetSingleton().FireEvent(a,c)});h.OnCopyThumbnails.Subscribe(function(a,b){e.traceTag(592061154,logCategory.PptSession,logLevel.Info,"DocController - OnCopyThumbnails NumberOfSlides:"+a.SelectedThumbnailIndexes.length);n.copySlidesHelper(a)});
this.m_documentState.m_clientColorSettings=c.ClientColorSettings;this.m_documentState.m_isInHighContrastMode=c.IsHighContrast;this.m_synchronizer=new b.Synchronizer(c,this.m_docVersionInfo,this.m_documentState,m,h,this.appCallbackBag.reportViewerErrorCallback);this.m_synchronizer.SetOnPresentationInfoFetchStartCallback(this.OnPresentationInfoFetchStartCallback.bind(this));this.m_synchronizer.SetOnPresentationInfoFetchedcallback(this.OnPresentationInfoFetchedcallback.bind(this));PowerPointDocumentViewer.ViewerEventManagerSingleton.GetSingleton().RegisterEventHandler(this.HandleReceivedViewerEvent.bind(this))}
f.prototype.AdjustVersionInfo=function(a){this.m_docVersionInfo=a};f.prototype.Show=function(a,b){var c=this;try{this.m_documentState.m_defaultSelectedThumbnail=a;this.m_documentState.m_defaultSelectedThumbnailIndex=b;this.m_documentState.m_clientHeight=this.m_parentElement.clientHeight;this.m_documentState.m_clientWidth=this.m_parentElement.clientWidth;this.m_documentState.m_lastShowDocTime=Date.now();this.m_docContainer.Show();this.m_versionDelayedActionTimer=setTimeout(function(){c.ToggleDelayedVersionActions(!0)},
this.m_versionDelayedActionDelay);var d=this.FindThumbnailIndexByID(this.m_documentState.m_defaultSelectedThumbnail,this.m_documentState.m_defaultSelectedThumbnailIndex);-1!=d&&(this.m_documentState.m_selectedThumbnail=this.m_documentState.m_presInfo.SlideOrder[d],this.m_docContainer.ThumbnailPane.SelectThumbnail(d,!1),this.m_docContainer.ThumbnailPane.ScrollThumbnailIntoView(d));this.m_synchronizer.StartSynchronize();this.UpdateAriaLive(this.m_documentState.m_selectedThumbnailIndex)}catch(f){e.traceTag(39986133,
logCategory.PptSession,logLevel.Error,"DocController - exception in Show: "+f)}};f.prototype.CopySlides=function(){var a=this.m_docContainer.ThumbnailPane;e.traceTag(591687905,logCategory.PptSession,logLevel.Info,"DocController - CopySlides NumberOfSlides:"+a.SelectedThumbnailIndexes.length);this.copySlidesHelper(a)};f.prototype.ToggleDelayedVersionActions=function(a){this.m_documentState.m_versionNavigableSlidePrefetchIsEnabled=a};f.prototype.LayoutView=function(){this.m_docContainer.Layout()};f.prototype.Hide=
function(){try{clearTimeout(this.m_versionDelayedActionTimer),this.ToggleDelayedVersionActions(!1),this.m_synchronizer.StopSynchronize(),this.m_documentState.m_lastHideDocTime=Date.now(),this.m_docContainer.Hide()}catch(a){e.traceTag(39986134,logCategory.PptSession,logLevel.Error,"DocController - exception in Hide: "+a)}};f.prototype.GetDocumentState=function(){return this.m_documentState};f.prototype.SetDocDiff=function(a){try{null!=a&&(this.m_diffResult=a,this.ShowDocDiff())}catch(b){e.traceTag(39986135,
logCategory.PptSession,logLevel.Error,"DocController - exception in SetDocDiff: "+b)}};f.prototype.ShowDocDiff=function(){if(null!=this.m_presInfo&&null!=this.m_diffResult&&!(0<this.m_documentState.m_lastShowDocDiffTime)){var a=this.m_diffResult.ModifiedSlides;if(!(null==a||0>=a.length)){var b=this.m_presInfo.SlideOrder;if(!(null==b||0>=b.length)){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(a[c].ID.cid==b[d].cid&&a[c].ID.sid==b[d].sid){this.m_docContainer.ThumbnailPane.Thumbnails[d].ShowDiffbackground();
break}this.m_documentState.m_lastShowDocDiffTime=Date.now()}}}};f.prototype.DrawSlideContent=function(c,h,k,f,l){try{this.DrawSlidePaneImage(c,k)}catch(m){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderSlide),e.traceTag(39706819,logCategory.PptSession,logLevel.Error,"Exception in DrawSlideContent: "+m+"slideID: cid = "+k.cid+", sid = "+k.sid)}try{d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.DrawSlideNotes,""),this.m_docContainer.NotesPaneContent=h}catch(m){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderNotes),
e.traceTag(40125909,logCategory.PptSession,logLevel.Error,"Exception in DrawSlideContent: "+m+"slideID: cid = "+k.cid+", sid = "+k.sid)}try{this.m_docContainer.SlidePane.SetSlideOutlineView(l)}catch(m){e.traceTag(42791623,logCategory.PptSession,logLevel.Error,"Exception in DrawSlideContent: "+m+"slideID: cid = "+k.cid+", sid = "+k.sid)}d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.DrawSlideContentEnd,f)};f.prototype.DrawSlidePaneImage=function(b,c){e.traceTag(39347461,logCategory.PptSession,
logLevel.Verbose,"DrawSlidePaneImage: sid: "+c.sid+", cid: "+c.cid+", RevisionID: "+this.m_docVersionInfo.RevisionID+".");null==b?e.traceTag(39347462,logCategory.PptSession,logLevel.Error,"DrawSlidePaneImage: no image data for slide. sid: "+c.sid+", cid: "+c.cid+", RevisionID: "+this.m_docVersionInfo.RevisionID+"."):(this.m_docContainer.SlidePane.HideProgress(),this.m_documentState.m_displayedSlide=c,d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.DrawSlidePaneImage,""),this.m_docContainer.SlidePane.Slide.SetImage(b,
this.m_docContainer.slideWidth,this.m_docContainer.slideHeight))};f.prototype.AddAccessibilityTagToThumbnail=function(a,b){this.m_docContainer.ThumbnailPane.Thumbnails[a].SetAccessibilityAttributes(b)};f.prototype.FindThumbnailIndexByID=function(a,b){if(null!=a&&-1!=b&&0<this.m_presInfo.SlideOrder.length){var c=this.m_documentState.m_presInfo.SlideOrder.map(function(a){return a.cid}).indexOf(a.cid);return-1!=c?c:b>this.m_documentState.m_presInfo.SlideOrder.length-1?this.m_documentState.m_presInfo.SlideOrder.length-
1:b}return-1};f.prototype.UpdateAriaLive=function(a){try{var b=this.GetSlideInfoFromCache(this.m_presInfo.SlideOrder[a]),c="Slide "+(a+1)+": ";if(null!=b){void 0!=b.Title&&(c+=b.Title);if(b.HasAnimation||b.HasTransition)c+=", has animation, or transition";b.Hidden&&(c+=", slide is hidden");null!=this.m_diffResult&&0<this.m_diffResult.ModifiedSlides.filter(function(a){return a.ID.cid==b.ID.cid}).length&&(c+=", slide is changed")}this.m_docContainer.ThumbnailPane.SetAriaLive(c)}catch(d){e.traceTag(39687118,
logCategory.PptSession,logLevel.Error,"Exception in UpdateAriaLive: "+d+"index: "+a)}};f.prototype.OnSelectThumbnail=function(b){try{var c=this.m_documentState.m_presInfo;if(0>b||b>c.SlideOrder.length)e.traceTag(39347463,logCategory.PptSession,logLevel.Error,"OnSelectThumbnail: invalid index. index: "+b);else{d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.SelectThumbnail,"");var k=c.SlideOrder[b];this.m_documentState.m_selectedThumbnail=k;this.m_documentState.m_selectedThumbnailIndex=b;
this.UpdateAriaLive(b);this.m_docContainer.NotesPaneContent="";e.traceTag(39347464,logCategory.PptSession,logLevel.Verbose,"OnSelectThumbnail: index: "+b+", sid: "+k.sid+", cid: "+k.cid+".");this.m_docContainer.viewerStatusBar.DrawSlideInfo(b,this.m_presInfo.SlideOrder.length);var f=this.GetSlideImageFromCache(k),l=this.GetSlideNotesFromCache(k),m=this.GetSlideOutlineFromCache(k);null!=f?this.DrawSlideContent(f,l,k,"",m):this.m_synchronizer.StartSynchronize()}}catch(n){e.traceTag(39687119,logCategory.PptSession,
logLevel.Error,"Exception in OnSelectThumbnail: "+n+"index: "+b)}};f.prototype.GetSlideInfoFromCache=function(a){var b=this.m_presInfo.Slides.filter(function(b){return b.ID.cid==a.cid&&b.ID.sid==a.sid});return 0<b.length?b[0]:null};f.prototype.GetSlideImageFromCache=function(a){var b=this.m_presInfo.Slides.filter(function(b){return b.ID.cid==a.cid&&b.ID.sid==a.sid});return 0<b.length?b[0].SlideImageData:null};f.prototype.GetSlideNotesFromCache=function(a){var b=this.m_presInfo.Slides.filter(function(b){return b.ID.cid==
a.cid&&b.ID.sid==a.sid});return 0<b.length?b[0].NotesHtml:""};f.prototype.GetSlideOutlineFromCache=function(a){var b=this.m_presInfo.Slides.filter(function(b){return b.ID.cid==a.cid&&b.ID.sid==a.sid});return 0<b.length?b[0].OutlineHtml:""};f.prototype.OnVisibleThumbnailsRangeChanged=function(a){if(this.m_documentState.m_visibleThumbnailRange.m_firstSlideIndex!=a.m_firstSlideIndex||this.m_documentState.m_visibleThumbnailRange.m_numSlides!=a.m_numSlides)this.m_documentState.m_visibleThumbnailRange=
a,this.m_synchronizer.StartSynchronize()};f.prototype.OnPresentationInfoFetchStartCallback=function(){this.m_docContainer.SlidePane.ShowProgress(new Date)};f.prototype.OnPresentationInfoFetchedcallback=function(a,b){try{a.SlideOrder&&0!=a.SlideOrder.length&&this.UpdateSlideOrderWithFetchedInfo(a),this.UpdateSlidesWithFetchedInfo(a,b)}catch(c){e.traceTag(39986136,logCategory.PptSession,logLevel.Error,"DocController - exception in OnPresentationInfoFetchedcallback: "+c)}};f.prototype.UpdateSlideOrderWithFetchedInfo=
function(a){var b=this.m_documentState.m_presInfo;if(0==b.SlideOrder.length&&0!=a.SlideOrder.length){b.SlideOrder=a.SlideOrder;for(var c=0;c<b.SlideOrder.length;c++)this.DrawPlaceHolderOnThumbnailPane(c);c=this.FindThumbnailIndexByID(this.m_documentState.m_defaultSelectedThumbnail,this.m_documentState.m_defaultSelectedThumbnailIndex);0>c&&(c=0);this.m_documentState.m_selectedThumbnail=a.SlideOrder[c];b.PresSettings=a.PresSettings?a.PresSettings:{SlideWidth:PowerPointDocumentViewer.DefaultSlideWidth,
SlideHeight:PowerPointDocumentViewer.DefaultSlideHeight};this.m_docContainer.ThumbnailPane.SelectThumbnail(c,!1);this.m_docContainer.ThumbnailPane.ScrollThumbnailIntoView(c);this.m_docContainer.UpdateSettings(b.PresSettings.SlideWidth,b.PresSettings.SlideHeight);this.m_docContainer.Layout();this.ShowDocDiff()}0==this.m_documentState.m_visibleThumbnailRange.m_firstSlideIndex&&0==this.m_documentState.m_visibleThumbnailRange.m_numSlides&&this.m_docContainer.ThumbnailPane.CalculateVisibleSlideRange()};
f.prototype.UpdateSlidesWithFetchedInfo=function(a,b){for(var d=this.m_documentState.m_presInfo,f=0,e=a.Slides;f<e.length;f++){for(var l=e[f],n=null,r=0;r<d.Slides.length;r++)d.Slides[r].ID.sid==l.ID.sid&&(n=d.Slides[r]);r=!1;null==n&&(n=l,d.Slides.push(n),r=!0);null==l.ThumbImageData||!r&&null!=n.ThumbImageData||(n.ThumbImageData=l.ThumbImageData,this.DrawImageOnThumbnailPane(n,d.SlideOrder));var u=c.FindIndex(d.SlideOrder,function(a){return a.cid==n.ID.cid&&a.sid==n.ID.sid});null==l.SlideImageData||
!r&&null!=n.SlideImageData||(n.SlideImageData=l.SlideImageData);null==l.Title||!r&&null!=n.Title||(n.Title=l.Title,0<=u&&this.AddAccessibilityTagToThumbnail(u,n.Title));null==l.Hidden||!r&&null!=n.Hidden||(n.Hidden=l.Hidden,n.Hidden&&0<=u&&this.m_docContainer.ThumbnailPane.Thumbnails[u].SetHidden());null!=l.HasAnimation||!r&&null!=n.HasAnimation||(n.HasAnimation=l.HasAnimation);null!=l.HasTransition||!r&&null!=n.HasTransition||(n.HasTransition=l.HasTransition);(n.HasTransition||n.HasAnimation)&&0<=
u&&this.m_docContainer.ThumbnailPane.Thumbnails[u].ShowAnimationEffect(!1,this.appCallbackBag.animationDecoratorCallback);""===l.NotesHtml||n.NotesHtml||(n.NotesHtml=l.NotesHtml);""===l.OutlineHtml||n.OutlineHtml||(n.OutlineHtml=l.OutlineHtml);null!=n.SlideImageData&&n.ID.sid==this.m_documentState.m_selectedThumbnail.sid&&this.DrawSlideContent(n.SlideImageData,null!=n.NotesHtml?n.NotesHtml:"",l.ID,b,null!=n.OutlineHtml?n.OutlineHtml:"")}};f.prototype.HandleReceivedViewerEvent=function(a,b){try{null!=
b&&null!=a&&(b.viewerEventType===PowerPointDocumentViewer.ViewerEventType.SelectThumbnailEvent?a.c_viewerThumbnailPaneId===this.m_docContainer.ThumbnailPane.ThumbnailPaneId&&this.OnSelectThumbnail(b.eventData.index):b.viewerEventType===PowerPointDocumentViewer.ViewerEventType.VisibleThumbnailsRangeChanged?a.c_viewerThumbnailPaneId===this.m_docContainer.ThumbnailPane.ThumbnailPaneId&&this.OnVisibleThumbnailsRangeChanged(b.eventData.slideRange):b.viewerEventType===PowerPointDocumentViewer.ViewerEventType.RootContainerResized?
this.m_documentState.IsDocInDisplay()&&(this.m_documentState.m_clientHeight=this.m_parentElement.clientHeight,this.m_documentState.m_clientWidth=this.m_parentElement.clientWidth,this.m_docContainer.Layout(),this.m_docContainer.ThumbnailPane.CalculateVisibleSlideRange()):b.viewerEventType===PowerPointDocumentViewer.ViewerEventType.NotesButtonClicked&&this.m_documentState.IsDocInDisplay()&&(this.m_docContainer.ToggleNotesPane(),e.traceTag(39706820,logCategory.PptSession,logLevel.Info,"Notes button toggled. IsNotesVisible = "+
this.m_docContainer.IsNotesVisible)))}catch(c){e.traceTag(39687120,logCategory.PptSession,logLevel.Error,"Exception in HandleReceivedViewerEvent: "+c+"event: "+(null!=b?b.viewerEventType:""))}};f.prototype.DrawPlaceHolderOnThumbnailPane=function(a){try{this.m_docContainer.ThumbnailPane.AddThumbnail(a)}catch(b){e.traceTag(39986137,logCategory.PptSession,logLevel.Error,"DocController - exception in DrawPlaceHolderOnThumbnailPane: "+b)}};f.prototype.DrawImageOnThumbnailPane=function(a,b){f.DrawImageOnThumbnailPane(a,
b,this.m_docContainer.ThumbnailPane,this.appCallbackBag.reportViewerErrorCallback)};f.DrawImageOnThumbnailPane=function(a,c,d,f){try{if(null!=a.ThumbImageData)for(var l=0;l<c.length;l++)c[l].sid===a.ID.sid&&c[l].cid===a.ID.cid&&d.Thumbnails[l].SetImage(a.ThumbImageData)}catch(m){null!=f&&f(b.VersionViewerErrorCode.VHFailedToRenderThumbnails),e.traceTag(39654358,logCategory.PptSession,logLevel.Error,"DocController::DrawImageOnThumbnailPane - exception: "+m)}};f.prototype.reportErrorToApp=function(a){null!=
this.appCallbackBag.reportViewerErrorCallback&&this.appCallbackBag.reportViewerErrorCallback(a)};f.prototype.copySlidesHelper=function(a){for(var b=[],c=0;c<a.SelectedThumbnailIndexes.length;c++)b.push(this.m_documentState.m_presInfo.SlideOrder[a.SelectedThumbnailIndexes[c]]);(c=this.m_docVersionInfo.DownloadUrl)?0==b.length?e.traceTag(591663698,logCategory.PptSession,logLevel.Error,"DocController::copySlidesHelper SlideIds are empty"):(this.appCallbackBag.copySlideCallback({Source:{DocID:this.m_docVersionInfo.DocID?
this.m_docVersionInfo.DocID:"",RevisionID:this.m_docVersionInfo.RevisionID,DownloadUrl:c,ETag:"",FileLengthHint:this.m_docVersionInfo.FileLengthHint?this.m_docVersionInfo.FileLengthHint:0,CentralDirectoryLengthHint:this.m_docVersionInfo.CentralDirectoryLengthHint?this.m_docVersionInfo.CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:this.m_docVersionInfo.SupportsMultiRangeRequests?this.m_docVersionInfo.SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1},SlideIds:b}),a.Thumbnails.length>=
a.SelectedThumbnailIndex+1&&a.Thumbnails[a.SelectedThumbnailIndex].thumbnailContainer.focus()):e.traceTag(591663699,logCategory.PptSession,logLevel.Error,"DocController::copySlidesHelper donwload url is null.")};return f}();b.DocController=l})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=function(){function b(){this.m_lastShowDocDiffTime=this.m_lastHideDocTime=this.m_lastShowDocTime=-1;this.m_clientHeight=this.m_clientWidth=this.m_selectedThumbnailIndex=0;this.m_isInHighContrastMode=!1;this.m_clientColorSettings="#ffffff_#000000_#ffff00";this.m_versionNavigableSlidePrefetchIsEnabled=!1}b.prototype.GetIsInHighContrastMode=function(){return this.m_isInHighContrastMode};b.prototype.GetClientColorSettings=function(){return this.m_clientColorSettings};b.prototype.GetSelectedThumbnail=
function(){return this.m_selectedThumbnail};b.prototype.GetSelectedThumbnailIndex=function(){return this.m_selectedThumbnailIndex};b.prototype.GetVersionNavigableSlidePrefetchIsEnabled=function(){return this.m_versionNavigableSlidePrefetchIsEnabled};b.prototype.GetDisplayedSlide=function(){return this.m_displayedSlide};b.prototype.GetClientWidth=function(){return this.m_clientWidth};b.prototype.GetClientHeight=function(){return this.m_clientHeight};b.prototype.IsDocInDisplay=function(){return 0<this.m_lastShowDocTime&&
this.m_lastShowDocTime>this.m_lastHideDocTime};Object.defineProperty(b.prototype,"SlideIDs",{get:function(){return this.m_presInfo.SlideOrder},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"SlideInfos",{get:function(){return this.m_presInfo.Slides},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"VersionInfo",{get:function(){return this.m_versionInfo},enumerable:!0,configurable:!0});return b}();b.DocumentState=e})(PowerPointVersionHistory||(PowerPointVersionHistory=
{}));
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=function(){function a(){}a.Init=function(a){try{this.appBootSettings=a,this.requestUrl=this.appBootSettings.RenderServiceBase+"PresInfo.ashx",this.docDiffUrl=this.appBootSettings.RenderServiceBase+"diff.ashx",this.getItemsRequestUrl=this.appBootSettings.RenderServiceBase+"getitems.ashx"}catch(b){e.traceTag(39986138,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in Init: "+b)}};a.GetDocDiff=function(c,d,f,g){var h={Rev:c,Base:d};
try{var k=new XMLHttpRequest;k.open("POST",this.docDiffUrl,!0);this.AddCommonHeadersToRequest(k,b.BrowserUtils.randomUUID());var p=JSON.stringify(h);k.onreadystatechange=function(){return a.OnGetDocDiffResponse(k,c.RevisionID,d.RevisionID,f,g)};k.send(p)}catch(q){e.traceTag(39986139,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in GetDocDiff: "+q),g()}};a.OnGetDocDiffResponse=function(a,b,d,g,h){try{if(a.readyState==XMLHttpRequest.DONE){var k=a.response;if(200!==a.status)e.traceTag(41219970,
logCategory.PptSession,logLevel.Error,"DocProxy - status code not OK: "+a.statusText),h();else if(null!==k&&""!==k)try{var p=JSON.parse(k);g(b,d,p)}catch(q){e.traceTag(39986140,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in GetPresentationInfo when parsing response: "+q+" response length:"+k.toString().length+" responseData: "+k.toString()),h()}else e.traceTag(39986141,logCategory.PptSession,logLevel.Warning,"DocProxy - responseData is null or empty in OnGetDocDiffResponse."),h()}}catch(q){e.traceTag(39986142,
logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetDocDiffResponse: "+q)}};a.GetPresentationInfo=function(b,d,f,g){try{if(".pptx"==b.FileExtension){e.traceTag(42821504,logCategory.PptSession,logLevel.Info,"DocProxy - parsing GetPresentationInfo getting items using GetItems End point");var h=new XMLHttpRequest;h.open("POST",a.getItemsRequestUrl,!0);h.responseType="arraybuffer";this.AddCommonHeadersToRequest(h,g);this.AddGetItemsCommonHeadersToRequest(h,g);var k=a.ConstructGetItemsRequestFromGetPresInfoRequest(b);
h.onreadystatechange=function(){return a.OnGetItemsPresentationResponse(h,b,d,f)};h.send(k)}else{var p=new XMLHttpRequest;p.open("POST",a.requestUrl,!0);this.AddCommonHeadersToRequest(p,g);var q=JSON.stringify(b);p.onreadystatechange=function(){return a.OnGetPresentationResponse(p,d,f)};p.send(q)}}catch(m){e.traceTag(39986143,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in GetPresentationInfo: "+m),f()}};a.ConstructGetItemsRequestFromGetPresInfoRequest=function(c){var d=[],f={InputProperties:{ClientColorSettings:c.ClientColorSettings,
ClientHeight:c.ClientHeight,ClientWidth:c.ClientWidth,IsHighContrast:c.IsHighContrast,MaxClientHeight:c.ClientHeight+50,MaxClientWidth:c.ClientWidth+50,MinClientHeight:0<c.ClientHeight-50?c.ClientHeight-50:c.ClientHeight,MinClientWidth:0<c.ClientWidth-50?c.ClientWidth-50:c.ClientWidth}},e={InputProperties:{ClientColorSettings:c.ClientColorSettings,ClientHeight:c.DevicePixelRatio&&0<c.DevicePixelRatio?Math.round(132*c.DevicePixelRatio):132,ClientWidth:c.DevicePixelRatio&&0<c.DevicePixelRatio?Math.round(176*
c.DevicePixelRatio):176,IsHighContrast:c.IsHighContrast}},h={Lcid:a.appBootSettings.Lcid};if(null!=c.SlideRanges)for(var k=0;k<c.SlideRanges.length;k++){var p=c.SlideRanges[k];if(0<p.MaxCount){var q;for(q=p.StartIndex;q<p.MaxCount+p.StartIndex;q++){if(p.RenderOptions.RenderSlides){var m={Id:b.GetRequestItemIds.slideIndex+q,AcceptTypes:[],Options:""};m.AcceptTypes.push(b.ItemType.ImagePng);var n={IsIncludePlaceHolder:!0};f.EditOptions=n;m.Options=JSON.stringify(f);d.push(m);m={Id:b.GetRequestItemIds.NotesSldIndex+
q,Options:"",AcceptTypes:[]};m.AcceptTypes.push(b.ItemType.PlainText);d.push(m)}p.RenderOptions.RenderThumbs&&(m={Id:b.GetRequestItemIds.slideIndex+q,AcceptTypes:[],Options:""},m.AcceptTypes.push(b.ItemType.ImageJpg),m.Id=b.GetRequestItemIds.slideIndex+q,n={IsIncludePlaceHolder:!1},e.EditOptions=n,m.Options=JSON.stringify(e),d.push(m));m={Id:b.GetRequestItemIds.SlideMetadataSldIndex+q,AcceptTypes:[],Options:""};h&&null!=h.Lcid&&(m.Options=JSON.stringify(h));m.AcceptTypes=[];m.AcceptTypes.push(b.ItemType.JsonType);
d.push(m)}}if(p.IDs)for(k=0;k<p.IDs.length;k++)p.RenderOptions.RenderSlides&&(m={Id:b.GetRequestItemIds.slideSid+p.IDs[k].sid,AcceptTypes:[],Options:""},m.AcceptTypes.push(b.ItemType.ImagePng),n={IsIncludePlaceHolder:!0},m.Id=b.GetRequestItemIds.slideSid+p.IDs[k].sid,f.EditOptions=n,m.Options=JSON.stringify(f),d.push(m),m={Id:b.GetRequestItemIds.NotesSldSid+p.IDs[k].sid,Options:"",AcceptTypes:[]},m.AcceptTypes.push(b.ItemType.PlainText),d.push(m)),p.RenderOptions.RenderThumbs&&(m={Id:b.GetRequestItemIds.slideSid+
p.IDs[k].sid,AcceptTypes:[],Options:""},m.AcceptTypes.push(b.ItemType.ImageJpg),n={IsIncludePlaceHolder:!1},e.EditOptions=n,m.Options=JSON.stringify(e),d.push(m)),m={Id:b.GetRequestItemIds.SlideMetadataSldSid+p.IDs[k].sid,AcceptTypes:[],Options:""},h&&null!=h.Lcid&&(m.Options=JSON.stringify(h)),m.AcceptTypes=[],m.AcceptTypes.push(b.ItemType.JsonType),d.push(m)}c.NeedsSlideOrder&&(m={Id:b.GetRequestItemIds.PresinfoSlideOrder,AcceptTypes:[],Options:""},m.AcceptTypes.push(b.ItemType.JsonType),d.push(m));
f={Id:b.GetRequestItemIds.PresInfoMetaData,AcceptTypes:[],Options:JSON.stringify({InputProperties:{ClientWidth:c.ClientWidth,ClientHeight:c.ClientHeight,IsHighContrast:c.IsHighContrast,ClientColorSettings:c.ClientColorSettings}})};f.AcceptTypes.push(b.ItemType.JsonType);d.push(f);c={Source:c.Source,FileExtension:c.FileExtension,Items:d};c.Source.DocID=c.Source.DocID;c.Source.SupportsTailRangeRequest=!0;c.Source.CentralDirectoryLengthHint=c.Source.CentralDirectoryLengthHint;c.Source.SupportsMultiRangeRequests=
c.Source.SupportsMultiRangeRequests;c.Source.FileLengthHint=c.Source.FileLengthHint;return JSON.stringify(c)};a.GetDownloadUrlParams=function(a){for(var b={},d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)a=d[e].split("="),b.set(a[0],a[1]);return b};a.OnGetItemsPresentationResponse=function(b,d,f,g){try{if(b.readyState==XMLHttpRequest.DONE&&null!=b.response)try{a.parseMultipartResponse(b,d).then(function(a){var d=b.getResponseHeader("Duration");f(a,d)})["catch"](function(a){e.traceTag(42821505,
logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetItemsPresentationResponse when parsing response: "+a);g()})}catch(h){e.traceTag(42821506,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetItemsPresentationResponse when parsing response: "+h),g()}}catch(h){e.traceTag(42821507,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetItemsPresentationResponse: "+h)}};a.parseMultipartResponse=function(c,d){return __awaiter(this,void 0,void 0,function(){var f,
g,h,k,p,q,m,n,r,u,t,y,v,z,w,B,A,C=this;return __generator(this,function(x){switch(x.label){case 0:f="pres%2fSlideMetadatasldIdx";g="pres%2fSlideMetadataSldSid";h="pres%2fNotesSldIdx";k="pres%2fNotesSldSid";p="pres%2fsldSid";q="pres%2fsldIdx";m="presinfo%2fSlideOrder";n="presinfo%2fmetadata";r=c.response;u={SlideOrder:[],Slides:[],PresSettings:{SlideHeight:0,SlideWidth:0}};t=a.InitializeSlideInfoList(d);y=!1;e.traceTag(42821508,logCategory.PptSession,logLevel.Info,"DocProxy - parsing parseMultipartResponse start");
if(!r||!c.getResponseHeader("content-type"))return[3,3];v=new b.MultipartParser;w=(z=v).processMultipartBinaryResponse;B=Uint8Array.bind;return[4,r];case 1:return[4,w.apply(z,[new (B.apply(Uint8Array,[void 0,x.sent()])),v.fetchBoundary(c.getResponseHeader("content-type")),function(b){return __awaiter(C,void 0,void 0,function(){var c,d,e,l,r,v,w,z,x,B,A;return __generator(this,function(C){if(b&&b.Headers)if(c=b.Headers["Content-Disposition"],d=b.Headers.ErrorCode,e=b.Headers["Content-Type"],d&&0>d.indexOf("ErrorRESERVEDSuccess"))y=
!0;else if(c&&0<c.indexOf(n))l=JSON.parse(a.DecodeUTF8String(b.Body)),u.PresSettings.SlideHeight=l.SlideHeight,u.PresSettings.SlideWidth=l.SlideWidth;else if(c&&0<c.indexOf(m))for(r=JSON.parse(a.DecodeUTF8String(b.Body)),v=0,w=r;v<w.length;v++)z=w[v],u.SlideOrder.push({sid:z.sid,cid:z.cid});else if(c&&0<c.indexOf(f))a.UpdateSlideMetaData(t,b,c,".*"+f+"(.*)","SldIdx");else if(c&&0<c.indexOf(g))a.UpdateSlideMetaData(t,b,c,".*"+g+"(.*)","SldSid");else if(c&&0<c.indexOf(h)){if(x=a.GetItemIdFromHeader(c,
".*"+h+"(.*)"),B=a.DecodeUTF8String(b.Body),A=t["SldIdx"+x])A.NotesHtml=B}else if(c&&0<c.indexOf(k)){if(x=a.GetItemIdFromHeader(c,".*"+k+"(.*)"),B=a.DecodeUTF8String(b.Body),A=t["SldSid"+x])A.NotesHtml=B}else c&&0<c.indexOf(p)?a.UpdateSlideOrThumbnailImage(t,b,e,c,".*"+p+"(.*)","SldSid"):c&&0<c.indexOf(q)&&a.UpdateSlideOrThumbnailImage(t,b,e,c,".*"+q+"(.*)","SldIdx");return[2]})})}])];case 2:x.sent(),x.label=3;case 3:for(A in t)u.Slides.push(t[A]);if(y)throw"GetItem Request Failed for one of the item";
e.traceTag(42821509,logCategory.PptSession,logLevel.Info,"DocProxy - parsing parseMultipartResponse end");return[2,u]}})})};a.DecodeUTF8String=function(a){if(a){if("undefined"===typeof TextEncoder){var b,d,e,h,k,p;b="";e=a.length;for(d=0;d<e;)switch(h=a[d++],h>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(h);break;case 12:case 13:k=a[d++];b+=String.fromCharCode((h&31)<<6|k&63);break;case 14:k=a[d++],p=a[d++],b+=String.fromCharCode((h&15)<<12|(k&63)<<6|(p&63)<<
0)}return b}return(new TextDecoder("utf-8")).decode(a)}return""};a.UpdateSlideOrThumbnailImage=function(b,d,f,e,h,k){e=a.GetItemIdFromHeader(e,h);if(b=b[k+e]){k="";for(e=0;e<d.Body.length;e+=1)k+=String.fromCharCode(d.Body[e]);f&&0<=f.indexOf("image/png")?(d="data:image/png;base64, "+btoa(k),b.SlideImageData=d):f&&0<=f.indexOf("image/jpg")&&(d="data:image/jpg;base64, "+btoa(k),b.ThumbImageData=d)}};a.UpdateSlideMetaData=function(b,d,f,e,h){f=a.GetItemIdFromHeader(f,e);d=JSON.parse(a.DecodeUTF8String(d.Body));
b=b[h+f];d&&b&&(b.ID=d.ID,b.Title=d.Title,b.Hidden=d.Hidden,b.HasTransition=d.HasTransition,b.HasAnimation=d.HasAnimation,b.OutlineHtml=d.OutlineHtml)};a.InitializeSlideInfoList=function(a){var b={};if(null!=a.SlideRanges)for(var d=0;d<a.SlideRanges.length;d++){var e=a.SlideRanges[d];if(0<e.MaxCount){var h;for(h=e.StartIndex;h<e.MaxCount+e.StartIndex;h++){var k=JSON.parse('{"ID":{"sid":null,"cid":null},"ThumbImageData":null,"SlideImageData":null,"Title":null,"NotesHtml":null,"OutlineHtml":null,"HasAnimation":false,"Hidden":false,"HasTransition":false}');
b["SldIdx"+h]=k}}if(e.IDs)for(d=0;d<e.IDs.length;d++)k=JSON.parse('{"ID":{"sid":null,"cid":null},"ThumbImageData":null,"SlideImageData":null,"Title":null,"NotesHtml":null,"OutlineHtml":null,"HasAnimation":false,"Hidden":false,"HasTransition":false}'),b["SldSid"+e.IDs[d].sid]=k}return b};a.GetItemIdFromHeader=function(a,b){var d=new RegExp(b);if(a){d=d.exec(a);if(null!=d&&2<=d.length)return d[1];console.log("GetItemIdFromHeader - header is null")}return""};a.OnGetPresentationResponse=function(a,b,
d){try{if(a.readyState==XMLHttpRequest.DONE){var g=a.response;if(null!=g)try{var h=JSON.parse(g),k=a.getResponseHeader("Duration");b(h,k)}catch(p){e.traceTag(39986144,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetPresentationResponse when parsing response: "+p),d()}else e.traceTag(39986145,logCategory.PptSession,logLevel.Error,"DocProxy - responseData is null in OnGetPresentationResponse."),d()}}catch(p){e.traceTag(39986146,logCategory.PptSession,logLevel.Error,"DocProxy - Exception in OnGetPresentationResponse: "+
p)}};a.AddCommonHeadersToRequest=function(b,d){b.setRequestHeader("X-CorrelationId",d);b.setRequestHeader("X-WacNoAuth","1");null!=a.appBootSettings.UserSessionId&&""!==a.appBootSettings.UserSessionId&&b.setRequestHeader("X-UserSessionId",a.appBootSettings.UserSessionId)};a.AddGetItemsCommonHeadersToRequest=function(b,d){b.setRequestHeader("CallerCorrelationId",d);null!=a.appBootSettings.UserSessionId&&""!==a.appBootSettings.UserSessionId&&b.setRequestHeader("CallerSessionId",a.appBootSettings.UserSessionId);
b.setRequestHeader("Client","VersionViewer")};return a}();b.DocProxy=d})(PowerPointVersionHistory||(PowerPointVersionHistory={}));var Util;(function(b){var e=function(){function b(){this.subs=[]}b.prototype.Signal=function(a,b){this.subs.forEach(function(d){d(a,b)})};b.prototype.Subscribe=function(a){this.subs.push(a)};b.prototype.Unsubscribe=function(a){a=this.subs.indexOf(a);return-1!=a?(this.subs.splice(a,1),!0):!1};return b}();b.TEvent=e})(Util||(Util={}));
(function(b){var e=function(){function b(){this.m_slideFetchEntries=[];this.m_fetchExpirationThreshold=1E4}b.SlideFetchEntryExpired=function(a,b){return Date.now()-a.StartTime>=b};b.prototype.InvalidateExpiredEntries=function(){var a=this;this.m_slideFetchEntries=this.m_slideFetchEntries.filter(function(c){return!b.SlideFetchEntryExpired(c,a.m_fetchExpirationThreshold)})};b.prototype.AddFetchEntry=function(a){this.m_slideFetchEntries.push({SlideID:a,StartTime:Date.now()})};b.prototype.SlideInFetchHistory=
function(a){var c=this;return this.m_slideFetchEntries.some(function(e){return e.SlideID.sid!=a.sid||e.SlideID.cid!=a.cid?!1:!b.SlideFetchEntryExpired(e,c.m_fetchExpirationThreshold)})};return b}();b.SlideFetchHistory=e})(PowerPointVersionHistory||(PowerPointVersionHistory={}));var Collections=Microsoft.Office.Collections;
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=Microsoft.VersionHistory.VersionHistoryLogHelper,a=Microsoft.VersionHistory.PLTEventType,c=Microsoft.Office.WebClient.PowerPoint.Utils,l;(function(a){a.InitialPresInfo="InitialPresInfo";a.VisibleThumbnails="VisibleThumbnails";a.DisplayedSlide="DisplayedSlide";a.NavigableSlides="NavigableSlides"})(l||(l={}));var f=function(){return function(){this.requestEndTime=this.requestStartTime=-1;this.syncServerTime=""}}(),g=function(){function h(a,
c,d,e,f,h){this.m_docSyncTimerInterval=1E3;this.m_recentThumbnailFetchHistory=new b.RecentFetchesHistory(1E4);this.m_recentSlideFetchHistory=new b.RecentFetchesHistory(25E3);this.m_lastSyncStartTime=Date.now();this.m_initialSyncEndTime=this.m_initialSyncStartTime=this.m_lastSyncStopTime=-1;this.m_slideSyncCorrelationId=b.BrowserUtils.randomUUID();this.m_slideFetchHistory=new b.SlideFetchHistory;this.m_slidePrefetchBehind=this.m_slidePrefetchChunkSize=1;this.m_slidePrefetchAhead=3;this.m_docVersionInfo=
c;this.m_documentStateReader=d;this.m_dataStore=e;this.m_thumbnailPane=f;this.appBootSettings=a;this.reportViewerErrorCallback=h;this.m_syncTimeoutInterval=+a.SynchronizerTimeout?+a.SynchronizerTimeout:3E5;this.m_slidePrefetchChunkSize=+a.SlidePrefetchSettings.SlidePrefetchChunkSize;this.m_slidePrefetchAhead=+a.SlidePrefetchSettings.SlidePrefetchAhead;this.m_slidePrefetchBehind=+a.SlidePrefetchSettings.SlidePrefetchBehind}h.prototype.AdjustVersionInfo=function(a){this.m_docVersionInfo=a};h.prototype.SetOnPresentationInfoFetchStartCallback=
function(a){this.m_onPresentationInfoFetchStartCallback=a};h.prototype.GetOnPresentationInfoFetchedcallback=function(){return this.m_onPresentationInfoFetchedcallback};h.prototype.SetOnPresentationInfoFetchedcallback=function(a){this.m_onPresentationInfoFetchedcallback=a};h.prototype.StartSynchronize=function(){var a=this;try{this.m_lastSyncStartTime=Date.now(),0<this.m_synchronizerTimer||(this.m_synchronizerTimer=setTimeout(function(){return a.Synchronize()},0))}catch(b){e.traceTag(39986147,logCategory.PptSession,
logLevel.Error,"Synchronizer - exception in StartSynchronize: "+b)}};h.prototype.StopSynchronize=function(){try{this.m_lastSyncStopTime=Date.now(),this.ResetSynchronizeTimer()}catch(a){e.traceTag(39986176,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in StopSynchronize: "+a)}};h.prototype.ResetSynchronizeTimer=function(){0<this.m_synchronizerTimer&&(clearTimeout(this.m_synchronizerTimer),this.m_synchronizerTimer=-1)};h.prototype.Synchronize=function(){var a=this;this.m_lastSyncStartTime<
this.m_lastSyncStopTime?this.ResetSynchronizeTimer():(this.m_synchronizerTimer=setTimeout(function(){return a.Synchronize()},this.m_docSyncTimerInterval),this.SynchronizeImpl())};Object.defineProperty(h.prototype,"ShouldSynchronize",{get:function(){return this.m_lastSyncStartTime>this.m_lastSyncStopTime&&this.m_documentStateReader.IsDocInDisplay()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"InitialPresInfoFetched",{get:function(){return 0<this.m_initialSyncStartTime&&this.m_initialSyncEndTime>
this.m_initialSyncStartTime},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"DisplayedSlideMatchSelectedThumbnail",{get:function(){try{var a=this.m_documentStateReader.GetDisplayedSlide(),b=this.m_documentStateReader.GetSelectedThumbnail();return null!=a?b.cid==a.cid&&b.sid==a.sid:!1}catch(c){e.traceTag(39986177,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in get DisplayedSlideMatchSelectedThumbnail: "+c)}return!1},enumerable:!0,configurable:!0});h.prototype.SynchronizeImpl=
function(){this.ShouldSynchronize&&(this.SynchronizeInitialPresInfo(),this.SynchronizeVisibleThumbnails(),this.SynchronizeDisplayedSlide(),this.m_documentStateReader.GetVersionNavigableSlidePrefetchIsEnabled()&&this.appBootSettings.SlidePrefetchSettings.SlidePrefetchEnabled&&this.SynchronizeNavigableSlides())};h.prototype.SynchronizeNavigableSlides=function(){var c=this;try{var g=this.GetUnSyncedNavigableSlides(this.m_thumbnailPane.VisibleSlideRange,this.m_documentStateReader.SlideIDs,this.m_documentStateReader.SlideInfos,
this.m_documentStateReader.GetSelectedThumbnailIndex());if(0!=g.count){var q={StartIndex:0,MaxCount:0,IDs:g.values,RenderOptions:{RenderThumbs:!1,RenderSlides:!0}},m=this.m_docVersionInfo.DownloadUrl;if(m)if(this.m_lastSyncStartTime+this.m_syncTimeoutInterval<Date.now())this.ResetSynchronizeTimer(),this.reportErrorToApp(b.VersionViewerErrorCode.VHSynchronizerTimeOut),e.traceTag(40958039,logCategory.PptVersionHistory,logLevel.Error,"Synchronizer - SynchronizeNavigableSlides timed out");else{var n=
{SlideRanges:[q],Source:{DocID:this.m_docVersionInfo.DocID?this.m_docVersionInfo.DocID:"",RevisionID:this.m_docVersionInfo.RevisionID,DownloadUrl:m,ETag:"",FileLengthHint:this.m_docVersionInfo.FileLengthHint?this.m_docVersionInfo.FileLengthHint:0,CentralDirectoryLengthHint:this.m_docVersionInfo.CentralDirectoryLengthHint?this.m_docVersionInfo.CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:this.m_docVersionInfo.SupportsMultiRangeRequests?this.m_docVersionInfo.SupportsMultiRangeRequests:!1,
SupportsTailRangeRequest:!1},ClientWidth:this.m_documentStateReader.GetClientWidth(),ClientHeight:this.m_documentStateReader.GetClientHeight(),DevicePixelRatio:b.BrowserUtils.DevicePixelRatio(),IsHighContrast:this.m_documentStateReader.GetIsInHighContrastMode(),ClientColorSettings:this.m_documentStateReader.GetClientColorSettings(),FileExtension:this.appBootSettings.FileExtension,NeedsSlideOrder:!this.m_documentStateReader.SlideIDs.length};this.m_documentStateReader.GetIsInHighContrastMode()&&(n.IsHighContrast=
this.m_documentStateReader.GetIsInHighContrastMode(),n.ClientColorSettings=this.m_documentStateReader.GetClientColorSettings());if(q.IDs){var r=this.m_recentSlideFetchHistory.GetEntriesSet(),u=new Collections.ArraySet(h.SlideIdEquals,q.IDs);u.exceptWith(r.values);e.traceTag(40958040,logCategory.PptSession,logLevel.Info,"SynchronizeNavigableSlides rangeSpec.IDs.length:"+q.IDs.length+" newSlideIDs.Length:"+u.count);if(u.count)for(var g=function(h){q.IDs=u.values.slice(h,h+t.m_slidePrefetchChunkSize);
var g=new f;g.operationType=l.NavigableSlides;g.requestStartTime=Date.now();g.slideSyncCorrelationId=t.m_slideSyncCorrelationId;d.addDocPLTEventToLog(t.m_docVersionInfo.RevisionID,a.NavigableSlides,"");b.DocProxy.GetPresentationInfo(n,function(a,b){try{g.syncServerTime=b?b:"",c.logSucceededSyncRequestWithEndTime(g),c.m_onPresentationInfoFetchedcallback(a,g.slideSyncCorrelationId)}catch(d){e.traceTag(40958041,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeNavigableSlides onSuccess callback: "+
d)}},function(){c.OnSynchronizeNavigableSlidesFailed()},g.slideSyncCorrelationId);h={Start:g.requestStartTime,SlideIDs:q.IDs?q.IDs:null,Range:0<q.MaxCount?{Offset:q.StartIndex,Length:q.MaxCount}:null,ID:b.BrowserUtils.randomUUID()};t.m_recentSlideFetchHistory.Add(h)},t=this,m=0;m<u.count;m+=this.m_slidePrefetchChunkSize)g(m);else this.m_recentSlideFetchHistory.Add(new b.FetchEntry)}}else this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderNavigableSlides),e.traceTag(40958038,logCategory.PptSession,
logLevel.Error,"Synchronizer - donwload url is null in SynchronizeNavigableSlides.")}}catch(y){e.traceTag(40958042,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeNavigableSlides: "+y)}};h.prototype.SynchronizeInitialPresInfo=function(){var c=this;try{if(!(this.InitialPresInfoFetched||0<this.m_initialSyncStartTime)&&this.m_docVersionInfo)if(this.m_initialSyncStartTime=Date.now(),this.m_docVersionInfo.DownloadUrl)if(this.m_lastSyncStartTime+this.m_syncTimeoutInterval<
Date.now())this.ResetSynchronizeTimer(),this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderInitPresInfo),e.traceTag(40490334,logCategory.PptVersionHistory,logLevel.Error,"Synchronizer - SynchronizeInitialPresInfo timed out");else{var h={SlideRanges:[{IDs:[],StartIndex:0,MaxCount:1,RenderOptions:{RenderThumbs:!0,RenderSlides:!0}}],Source:{DocID:this.m_docVersionInfo.DocID?this.m_docVersionInfo.DocID:"",RevisionID:this.m_docVersionInfo.RevisionID,DownloadUrl:this.m_docVersionInfo.DownloadUrl,
ETag:"",FileLengthHint:this.m_docVersionInfo.FileLengthHint?this.m_docVersionInfo.FileLengthHint:0,CentralDirectoryLengthHint:this.m_docVersionInfo.CentralDirectoryLengthHint?this.m_docVersionInfo.CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:this.m_docVersionInfo.SupportsMultiRangeRequests?this.m_docVersionInfo.SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1},ClientWidth:this.m_documentStateReader.GetClientWidth(),ClientHeight:this.m_documentStateReader.GetClientHeight(),DevicePixelRatio:b.BrowserUtils.DevicePixelRatio(),
FileExtension:this.appBootSettings.FileExtension,NeedsSlideOrder:!0,ClientColorSettings:"",IsHighContrast:!1};this.m_documentStateReader.GetIsInHighContrastMode()&&(h.IsHighContrast=this.m_documentStateReader.GetIsInHighContrastMode(),h.ClientColorSettings=this.m_documentStateReader.GetClientColorSettings());var g=new f;g.operationType=l.InitialPresInfo;g.requestStartTime=Date.now();g.slideSyncCorrelationId=this.m_slideSyncCorrelationId;this.m_onPresentationInfoFetchStartCallback();d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,
a.LoadInitPresInfo,g.slideSyncCorrelationId);b.DocProxy.GetPresentationInfo(h,function(a,b){try{g.syncServerTime=b?b:"",c.logSucceededSyncRequestWithEndTime(g),c.m_onPresentationInfoFetchedcallback(a,"")}catch(d){e.traceTag(39986178,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeInitialPresInfo onSuccess callback: "+d)}},function(){c.OnSynchronizeInitialPresInfoFailed()},g.slideSyncCorrelationId);this.m_slideSyncCorrelationId=b.BrowserUtils.randomUUID()}else this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderInitPresInfo),
e.traceTag(40125910,logCategory.PptSession,logLevel.Error,"Synchronizer - donwload url is null in SynchronizeInitialPresInfo.")}catch(m){e.traceTag(39986180,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeInitialPresInfo: "+m)}};h.SlideIdEquals=function(a,b){return a.sid==b.sid&&a.cid==b.cid};h.prototype.GetUnSyncedNavigableSlides=function(a,b,c,d){var f=new Collections.ArraySet(h.SlideIdEquals),g=d-this.m_slidePrefetchBehind>=a.m_firstSlideIndex?d-this.m_slidePrefetchBehind:
a.m_firstSlideIndex;a=d+this.m_slidePrefetchAhead<a.LastSlideIndex?d+this.m_slidePrefetchAhead:a.LastSlideIndex;try{for(;g<=a;g++)if(b[g].cid)for(d=0;d<c.length;d++)if(b[g].cid===c[d].ID.cid){c[d].SlideImageData||f.add(b[g]);break}}catch(l){e.traceTag(40958043,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in GetUnSyncedVisibleSlides: "+l)}return f};h.GetUnSyncedVisibleThumbnails=function(a,b,c){c=c.Thumbnails;var d=new Collections.ArraySet(h.SlideIdEquals);try{for(var f=a.m_firstSlideIndex;f<=
a.LastSlideIndex;f++)c[f].FImageSet||d.add(b[f])}catch(g){e.traceTag(39986181,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in GetUnSyncedVisibleThumbnails: "+g)}return d};h.GetBorrowableSlideInfo=function(a,b,c,d){try{for(;b<a.length-1;b++){var f=d.GetDocDiff(a[b+1].RevisionID,a[b].RevisionID);if(!f)break;if(f.ModifiedSlides.some(function(a){return h.SlideIdEquals(a.ID,c)}))break;var g=d.GetPresentationInfoFromStore(a[b+1].RevisionID);if(!g)break;var l=g.Slides.filter(function(a){return h.SlideIdEquals(a.ID,
c)&&null!=a.ThumbImageData});if(0<l.length)return l[0]}}catch(t){e.traceTag(39986182,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in GetBorrowableSlideInfo: "+t)}return null};h.prototype.SynchronizeVisibleThumbnails=function(){var g=this;try{var p=h.GetUnSyncedVisibleThumbnails(this.m_thumbnailPane.VisibleSlideRange,this.m_documentStateReader.SlideIDs,this.m_thumbnailPane);if(0!=p.count){var q=this.m_docVersionInfo.DownloadUrl;if(q)if(this.m_lastSyncStartTime+this.m_syncTimeoutInterval<
Date.now())this.ResetSynchronizeTimer(),this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderThumbnails),e.traceTag(40490335,logCategory.PptVersionHistory,logLevel.Error,"Synchronizer - SynchronizeVisibleThumbnails timed out");else{var m={StartIndex:0,MaxCount:0,IDs:p.values,RenderOptions:{RenderThumbs:!0,RenderSlides:!1}};if(this.appBootSettings.ThumbnailShareOptimizationEnabled){var n=this.m_dataStore.VersionInfos.sort(function(a,b){return(new Date(a.Time)).getTime()-(new Date(b.Time)).getTime()});
e.traceTag(39408204,logCategory.PptSession,logLevel.Info,"Synchronizer::SynchronizeVisibleThumbnails versionsInfos.length:"+n.length);var r=c.FindIndex(n,function(a){return a.RevisionID==g.m_docVersionInfo.RevisionID}),u=this.m_dataStore.GetPresentationInfoFromStore(n[r].RevisionID);if(0<=r&&u){for(var t=new Collections.ArraySet(h.SlideIdEquals),y=0,v=p.values;y<v.length;y++){var z=v[y],w=h.GetBorrowableSlideInfo(n,r,z,this.m_dataStore);e.traceTag(39658649,logCategory.PptSession,logLevel.Info,"Synchronizer::SynchronizeVisibleThumbnails unsyncedID:"+
b.RecentFetchesHistory.SlideToString(z)+" cached:"+!!w);w&&(b.DocController.DrawImageOnThumbnailPane(w,u.SlideOrder,this.m_thumbnailPane),t.add(w.ID))}p.exceptWith(t.values);m.IDs=p.values}}var B={SlideRanges:[m],Source:{DocID:this.m_docVersionInfo.DocID?this.m_docVersionInfo.DocID:"",RevisionID:this.m_docVersionInfo.RevisionID,DownloadUrl:q,ETag:"",FileLengthHint:this.m_docVersionInfo.FileLengthHint?this.m_docVersionInfo.FileLengthHint:0,CentralDirectoryLengthHint:this.m_docVersionInfo.CentralDirectoryLengthHint?
this.m_docVersionInfo.CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:this.m_docVersionInfo.SupportsMultiRangeRequests?this.m_docVersionInfo.SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1},ClientWidth:this.m_documentStateReader.GetClientWidth(),ClientHeight:this.m_documentStateReader.GetClientHeight(),DevicePixelRatio:b.BrowserUtils.DevicePixelRatio(),IsHighContrast:this.m_documentStateReader.GetIsInHighContrastMode(),ClientColorSettings:this.m_documentStateReader.GetClientColorSettings(),
FileExtension:this.appBootSettings.FileExtension,NeedsSlideOrder:!this.m_documentStateReader.SlideIDs.length};if(m.IDs){var A=this.m_recentThumbnailFetchHistory.GetEntriesSet(),C=new Collections.ArraySet(h.SlideIdEquals,m.IDs);C.exceptWith(A.values);e.traceTag(39383063,logCategory.PptSession,logLevel.Info,"SynchronizeVisibleThumbnails rangespec.IDs.length:"+m.IDs.length+" newSlideIDs.Length:"+C.count);C.count<m.IDs.length&&(e.traceTag(39383064,logCategory.PptSession,logLevel.Info,"SynchronizeVisibleThumbnails trimmed thumbs"),
m.IDs=C.values);if(C.count){var x=new f;x.operationType=l.VisibleThumbnails;x.requestStartTime=Date.now();x.slideSyncCorrelationId=this.m_slideSyncCorrelationId;d.addDocPLTEventToLog(this.m_docVersionInfo.RevisionID,a.VisibleThumbnails,"");b.DocProxy.GetPresentationInfo(B,function(a,b){try{x.syncServerTime=b?b:"",g.logSucceededSyncRequestWithEndTime(x),g.m_onPresentationInfoFetchedcallback(a,x.slideSyncCorrelationId)}catch(c){e.traceTag(39986184,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeVisibleThumbnails onSuccess callback: "+
c)}},function(){g.OnSynchronizeVisibleThumbnailsFailed()},x.slideSyncCorrelationId);var D={Start:x.requestStartTime,SlideIDs:m.IDs?m.IDs:null,Range:0<m.MaxCount?{Offset:m.StartIndex,Length:m.MaxCount}:null,ID:b.BrowserUtils.randomUUID()};this.m_recentThumbnailFetchHistory.Add(D)}else this.m_recentThumbnailFetchHistory.Add(new b.FetchEntry)}}else this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderThumbnails),e.traceTag(40125911,logCategory.PptSession,logLevel.Error,"Synchronizer - donwload url is null in SynchronizeVisibleThumbnails.")}}catch(E){e.traceTag(39986186,
logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeVisibleThumbnails: "+E)}};h.prototype.SynchronizeDisplayedSlide=function(){var a=this;try{if(!this.DisplayedSlideMatchSelectedThumbnail){var c=this.m_documentStateReader.GetSelectedThumbnailIndex(),d=this.m_documentStateReader.GetSelectedThumbnail(),g=this.m_documentStateReader.SlideInfos.filter(function(a){return d.cid===a.ID.cid&&d.sid===a.ID.sid}),h=g.length?g[0]:null;if(!h||!h.SlideImageData)if(this.m_recentSlideFetchHistory.GetEntriesSet().contains(d))this.m_recentSlideFetchHistory.Add(new b.FetchEntry);
else{var c={StartIndex:c,MaxCount:1,IDs:[],RenderOptions:{RenderThumbs:!1,RenderSlides:!0}},r=this.m_docVersionInfo.DownloadUrl;if(r)if(this.m_lastSyncStartTime+this.m_syncTimeoutInterval<Date.now())this.ResetSynchronizeTimer(),this.reportErrorToApp(b.VersionViewerErrorCode.VHSynchronizerTimeOut),e.traceTag(40490336,logCategory.PptVersionHistory,logLevel.Error,"Synchronizer - SynchronizeDisplayedSlide timed out");else{var u={ClientWidth:this.m_documentStateReader.GetClientWidth(),ClientHeight:this.m_documentStateReader.GetClientHeight(),
DevicePixelRatio:b.BrowserUtils.DevicePixelRatio(),FileExtension:this.appBootSettings.FileExtension,NeedsSlideOrder:!this.m_documentStateReader.SlideIDs.length,SlideRanges:[c],ClientColorSettings:"",IsHighContrast:!1,Source:{DocID:this.m_docVersionInfo.DocID?this.m_docVersionInfo.DocID:"",RevisionID:this.m_docVersionInfo.RevisionID,DownloadUrl:r,ETag:"",FileLengthHint:this.m_docVersionInfo.FileLengthHint?this.m_docVersionInfo.FileLengthHint:0,CentralDirectoryLengthHint:this.m_docVersionInfo.CentralDirectoryLengthHint?
this.m_docVersionInfo.CentralDirectoryLengthHint:0,SupportsMultiRangeRequests:this.m_docVersionInfo.SupportsMultiRangeRequests?this.m_docVersionInfo.SupportsMultiRangeRequests:!1,SupportsTailRangeRequest:!1}};this.m_documentStateReader.GetIsInHighContrastMode()&&(u.IsHighContrast=this.m_documentStateReader.GetIsInHighContrastMode(),u.ClientColorSettings=this.m_documentStateReader.GetClientColorSettings());var t=new f;t.operationType=l.DisplayedSlide;t.requestStartTime=Date.now();t.slideSyncCorrelationId=
this.m_slideSyncCorrelationId;this.m_onPresentationInfoFetchStartCallback();b.DocProxy.GetPresentationInfo(u,function(b,c){try{t.syncServerTime=c?c:"",a.logSucceededSyncRequestWithEndTime(t),a.m_onPresentationInfoFetchedcallback(b,t.slideSyncCorrelationId)}catch(d){e.traceTag(39986188,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeDisplayedSlide onSuccess callback: "+d)}},function(){try{a.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderSlide),a.OnSynchronizeDisplayedSlideFailed()}catch(c){e.traceTag(39986189,
logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeDisplayedSlide onFailed callback: "+c)}},t.slideSyncCorrelationId);this.m_slideSyncCorrelationId=b.BrowserUtils.randomUUID();var y={Start:t.requestStartTime,SlideIDs:[d],Range:0<c.MaxCount?{Offset:c.StartIndex,Length:c.MaxCount}:null,ID:b.BrowserUtils.randomUUID()};this.m_recentSlideFetchHistory.Add(y)}else this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderSlide),e.traceTag(40125912,logCategory.PptSession,logLevel.Error,
"Synchronizer - donwload url is null in SynchronizeDisplayedSlide.")}}}catch(v){e.traceTag(39986190,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeDisplayedSlide: "+v)}};h.prototype.OnSynchronizeInitialPresInfoFailed=function(){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderInitPresInfo);try{this.m_initialSyncEndTime=Date.now();var a=new f;a.operationType=l.InitialPresInfo;this.logFailedSyncRequestWithEndTime(a)}catch(c){e.traceTag(40125913,logCategory.PptSession,
logLevel.Error,"Synchronizer - exception in SynchronizeInitialPresInfo onFailed callback: "+c)}};h.prototype.OnSynchronizeVisibleThumbnailsFailed=function(){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderThumbnails);try{var a=new f;a.operationType=l.VisibleThumbnails;this.logFailedSyncRequestWithEndTime(a)}catch(c){e.traceTag(40125914,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeVisibleThumbnails onFailed callback: "+c)}};h.prototype.OnSynchronizeDisplayedSlideFailed=
function(){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderSlide);try{var a=new f;a.operationType=l.DisplayedSlide;this.logFailedSyncRequestWithEndTime(a)}catch(c){e.traceTag(40125915,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeDisplayedSlide onFailed callback: "+c)}};h.prototype.OnSynchronizeNavigableSlidesFailed=function(){this.reportErrorToApp(b.VersionViewerErrorCode.VHFailedToRenderSlide);try{var a=new f;a.operationType=l.NavigableSlides;this.logFailedSyncRequestWithEndTime(a)}catch(c){e.traceTag(40958044,
logCategory.PptSession,logLevel.Error,"Synchronizer - exception in SynchronizeNavigableSlides onFailed callback: "+c)}};h.prototype.logSucceededSyncRequestWithEndTime=function(a){var b=Date.now();a.requestEndTime=b;d.logEplapsedTime("SyncOperation::"+a.operationType+" succeeded.",logLevel.Info,a.requestStartTime,b,a.operationType===l.DisplayedSlide?a.slideSyncCorrelationId:"",a.syncServerTime)};h.prototype.logFailedSyncRequestWithEndTime=function(a){try{var b=Date.now();a.requestEndTime=b;d.logEplapsedTime("SyncOperation::"+
a.operationType+" failed.",logLevel.Error,a.requestStartTime,b,"","")}catch(c){e.traceTag(39986191,logCategory.PptSession,logLevel.Error,"Synchronizer - exception in logFailedSyncRequestWithEndTime: "+c)}};h.prototype.reportErrorToApp=function(a){null!=this.reportViewerErrorCallback&&this.reportViewerErrorCallback(a)};return h}();b.Synchronizer=g})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
(function(b){var e=Microsoft.VersionHistory.SessionLogger,d=function(){return function(){}}();b.Range=d;d=function(){return function(){}}();b.FetchEntry=d;d=function(){function a(a){this.entries=[];this.entriesSet=new Collections.ArraySet(b.Synchronizer.SlideIdEquals);this.m_maxRetentionMilliseconds=a}a.prototype.ExpireEntries=function(){var a=this,b=new Date;this.entries=this.entries.filter(function(d){return b.getTime()-d.Start<a.m_maxRetentionMilliseconds})};a.SlideToString=function(a){return"SlideID["+
a.sid+","+a.cid+"]"};a.prototype.Add=function(b){var d=null;b.SlideIDs&&(d=b.SlideIDs.map(function(b){return a.SlideToString(b)}).join(", "));var f=null;b.Range&&(f="Range[Offset:"+b.Range.Offset+" Length:"+b.Range.Length+"]");e.traceTag(39383065,logCategory.PptSession,logLevel.Info,"RecentFetchesHistory::Add FetchEntry ID:"+b.ID+" Range:"+f+" Requested:"+d);this.ExpireEntries();if(this.entries.some(function(a){return a.ID==b.ID}))throw Error("Duplicate ID");this.entries.push(b);this.UpdateEntriesSet()};
a.prototype.GetEntries=function(){return this.entries};a.prototype.GetEntriesSet=function(){return this.entriesSet};a.prototype.UpdateEntriesSet=function(){var a=this;this.entriesSet=new Collections.ArraySet(b.Synchronizer.SlideIdEquals);this.entries.forEach(function(b){a.entriesSet.unionWith(b.SlideIDs||[])})};return a}();b.RecentFetchesHistory=d})(PowerPointVersionHistory||(PowerPointVersionHistory={}));
