var video=function(e){var t={};function i(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=6)}([,function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";(function(e,i){/*! @vimeo/player v2.18.0 | (c) 2022 Vimeo | MIT License | https://github.com/vimeo/player.js */
function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=void 0!==e&&"[object global]"==={}.toString.call(e);function o(e,t){return 0===e.indexOf(t.toLowerCase())?e:"".concat(t.toLowerCase()).concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}function n(e){return Boolean(e&&1===e.nodeType&&"nodeName"in e&&e.ownerDocument&&e.ownerDocument.defaultView)}function l(e){return!isNaN(parseFloat(e))&&isFinite(e)&&Math.floor(e)==e}function d(e){return/^(https?:)?\/\/((player|www)\.)?vimeo\.com(?=$|\/)/.test(e)}function h(e){return/^https:\/\/player\.vimeo\.com\/video\/\d+/.test(e)}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,i=e.url,a=t||i;if(!a)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(l(a))return"https://vimeo.com/".concat(a);if(d(a))return a.replace("http:","https:");if(t)throw new TypeError("“".concat(t,"” is not a valid video id."));throw new TypeError("“".concat(a,"” is not a vimeo.com url."))}var u=void 0!==Array.prototype.indexOf,p="undefined"!=typeof window&&void 0!==window.postMessage;if(!(s||u&&p))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};
/*!
 * weakmap-polyfill v2.0.4 - ECMAScript6 WeakMap polyfill
 * https://github.com/polygonplanet/weakmap-polyfill
 * Copyright (c) 2015-2021 polygonplanet <polygon.planet.aqua@gmail.com>
 * @license MIT
 */
!function(e){if(!e.WeakMap){var t=Object.prototype.hasOwnProperty,i=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),a=function(e,t,a){i?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:a}):e[t]=a};e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(a(this,"_id",s("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function i(e,i){if(!r(e)||!t.call(e,"_id"))throw new TypeError(i+" method called on incompatible receiver "+typeof e)}function s(e){return e+"_"+o()+"."+o()}function o(){return Math.random().toString().substring(2)}return a(e.prototype,"delete",(function(e){if(i(this,"delete"),!r(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)&&(delete e[this._id],!0)})),a(e.prototype,"get",(function(e){if(i(this,"get"),r(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}})),a(e.prototype,"has",(function(e){if(i(this,"has"),!r(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)})),a(e.prototype,"set",(function(e,t){if(i(this,"set"),!r(e))throw new TypeError("Invalid value used as weak map key");var s=e[this._id];return s&&s[0]===e?(s[1]=t,this):(a(e,this._id,[e,t]),this)})),a(e,"_polyfill",!0),e}()}function r(e){return Object(e)===e}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:m);var y=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){
/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
var t,a,r;r=function(){var e,t,a,r=Object.prototype.toString,s=void 0!==i?function(e){return i(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,t,i,a){return Object.defineProperty(e,t,{value:i,writable:!0,configurable:!1!==a})}}catch(t){e=function(e,t,i){return e[t]=i,e}}function o(e,i){a.add(e,i),t||(t=s(a.drain))}function n(e){var t,i=typeof e;return null==e||"object"!=i&&"function"!=i||(t=e.then),"function"==typeof t&&t}function l(){for(var e=0;e<this.chain.length;e++)d(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function d(e,t,i){var a,r;try{!1===t?i.reject(e.msg):(a=!0===t?e.msg:t.call(void 0,e.msg))===i.promise?i.reject(TypeError("Promise-chain cycle")):(r=n(a))?r.call(a,i.resolve,i.reject):i.resolve(a)}catch(e){i.reject(e)}}function h(e){var t,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(t=n(e))?o((function(){var a=new p(i);try{t.call(e,(function(){h.apply(a,arguments)}),(function(){c.apply(a,arguments)}))}catch(e){c.call(a,e)}})):(i.msg=e,i.state=1,i.chain.length>0&&o(l,i))}catch(e){c.call(new p(i),e)}}}function c(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,t.chain.length>0&&o(l,t))}function u(e,t,i,a){for(var r=0;r<t.length;r++)!function(r){e.resolve(t[r]).then((function(e){i(r,e)}),a)}(r)}function p(e){this.def=e,this.triggered=!1}function m(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function y(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var t=new m(this);this.then=function(e,i){var a={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return a.promise=new this.constructor((function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");a.resolve=e,a.reject=t})),t.chain.push(a),0!==t.state&&o(l,t),a.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,(function(e){h.call(t,e)}),(function(e){c.call(t,e)}))}catch(e){c.call(t,e)}}a=function(){var e,i,a;function r(e,t){this.fn=e,this.self=t,this.next=void 0}return{add:function(t,s){a=new r(t,s),i?i.next=a:e=a,i=a,a=void 0},drain:function(){var a=e;for(e=i=t=void 0;a;)a.fn.call(a.self),a=a.next}}}();var v=e({},"constructor",y,!1);return y.prototype=v,e(v,"__NPO__",0,!1),e(y,"resolve",(function(e){return e&&"object"==typeof e&&1===e.__NPO__?e:new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");t(e)}))})),e(y,"reject",(function(e){return new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");i(e)}))})),e(y,"all",(function(e){var t=this;return"[object Array]"!=r.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t((function(i,a){if("function"!=typeof i||"function"!=typeof a)throw TypeError("Not a function");var r=e.length,s=Array(r),o=0;u(t,e,(function(e,t){s[e]=t,++o===r&&i(s)}),a)}))})),e(y,"race",(function(e){var t=this;return"[object Array]"!=r.call(e)?t.reject(TypeError("Not an array")):new t((function(i,a){if("function"!=typeof i||"function"!=typeof a)throw TypeError("Not a function");u(t,e,(function(e,t){i(t)}),a)}))})),y},(a=m)[t="Promise"]=a[t]||r(),e.exports&&(e.exports=a[t])})),v=new WeakMap;function f(e,t,i){var a=v.get(e.element)||{};t in a||(a[t]=[]),a[t].push(i),v.set(e.element,a)}function g(e,t){return(v.get(e.element)||{})[t]||[]}function b(e,t,i){var a=v.get(e.element)||{};if(!a[t])return!0;if(!i)return a[t]=[],v.set(e.element,a),!0;var r=a[t].indexOf(i);return-1!==r&&a[t].splice(r,1),v.set(e.element,a),a[t]&&0===a[t].length}function k(e,t){var i=v.get(e);v.set(t,i),v.delete(e)}function T(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.warn(e),{}}return e}function P(e,t,i){if(e.element.contentWindow&&e.element.contentWindow.postMessage){var a={method:t};void 0!==i&&(a.value=i);var r=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));r>=8&&r<10&&(a=JSON.stringify(a)),e.element.contentWindow.postMessage(a,e.origin)}}function w(e,t){var i,a=[];if((t=T(t)).event){if("error"===t.event)g(e,t.data.method).forEach((function(i){var a=new Error(t.data.message);a.name=t.data.name,i.reject(a),b(e,t.data.method,i)}));a=g(e,"event:".concat(t.event)),i=t.data}else if(t.method){var r=function(e,t){var i=g(e,t);if(i.length<1)return!1;var a=i.shift();return b(e,t,a),a}(e,t.method);r&&(a.push(r),i=t.value)}a.forEach((function(t){try{if("function"==typeof t)return void t.call(e,i);t.resolve(i)}catch(e){}}))}var E=["autopause","autoplay","background","byline","color","controls","dnt","height","id","interactive_params","keyboard","loop","maxheight","maxwidth","muted","playsinline","portrait","responsive","speed","texttrack","title","transparent","url","width"];function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E.reduce((function(t,i){var a=e.getAttribute("data-vimeo-".concat(i));return(a||""===a)&&(t[i]=""===a?1:a),t}),t)}function C(e,t){var i=e.html;if(!t)throw new TypeError("An element must be provided");if(null!==t.getAttribute("data-vimeo-initialized"))return t.querySelector("iframe");var a=document.createElement("div");return a.innerHTML=i,t.appendChild(a.firstChild),t.setAttribute("data-vimeo-initialized","true"),t.querySelector("iframe")}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return new Promise((function(a,r){if(!d(e))throw new TypeError("“".concat(e,"” is not a vimeo.com url."));var s="https://vimeo.com/api/oembed.json?url=".concat(encodeURIComponent(e));for(var o in t)t.hasOwnProperty(o)&&(s+="&".concat(o,"=").concat(encodeURIComponent(t[o])));var n="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;n.open("GET",s,!0),n.onload=function(){if(404!==n.status)if(403!==n.status)try{var t=JSON.parse(n.responseText);if(403===t.domain_status_code)return C(t,i),void r(new Error("“".concat(e,"” is not embeddable.")));a(t)}catch(e){r(e)}else r(new Error("“".concat(e,"” is not embeddable.")));else r(new Error("“".concat(e,"” was not found.")))},n.onerror=function(){var e=n.status?" (".concat(n.status,")"):"";r(new Error("There was an error fetching the embed code from Vimeo".concat(e,".")))},n.send()}))}var M=new WeakMap,D=new WeakMap,F={},V=function(){function e(t){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,e),window.jQuery&&t instanceof jQuery&&(t.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),t=t[0]),"undefined"!=typeof document&&"string"==typeof t&&(t=document.getElementById(t)),!n(t))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==t.nodeName){var s=t.querySelector("iframe");s&&(t=s)}if("IFRAME"===t.nodeName&&!d(t.getAttribute("src")||""))throw new Error("The player element passed isn’t a Vimeo embed.");if(M.has(t))return M.get(t);this._window=t.ownerDocument.defaultView,this.element=t,this.origin="*";var o=new y((function(e,a){if(i._onMessage=function(t){if(d(t.origin)&&i.element.contentWindow===t.source){"*"===i.origin&&(i.origin=t.origin);var r=T(t.data);if(r&&"error"===r.event&&r.data&&"ready"===r.data.method){var s=new Error(r.data.message);return s.name=r.data.name,void a(s)}var o=r&&"ready"===r.event,n=r&&"ping"===r.method;if(o||n)return i.element.setAttribute("data-ready","true"),void e();w(i,r)}},i._window.addEventListener("message",i._onMessage),"IFRAME"!==i.element.nodeName){var s=S(t,r);I(c(s),s,t).then((function(e){var a=C(e,t);return i.element=a,i._originalElement=t,k(t,a),M.set(i.element,i),e})).catch(a)}}));if(D.set(this,o),M.set(this.element,this),"IFRAME"===this.element.nodeName&&P(this,"ping"),F.isEnabled){var l=function(){return F.exit()};this.fullscreenchangeHandler=function(){F.isFullscreen?f(i,"event:exitFullscreen",l):b(i,"event:exitFullscreen",l),i.ready().then((function(){P(i,"fullscreenchange",F.isFullscreen)}))},F.on("fullscreenchange",this.fullscreenchangeHandler)}return this}var t,i,s;return t=e,(i=[{key:"callMethod",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new y((function(a,r){return t.ready().then((function(){f(t,e,{resolve:a,reject:r}),P(t,e,i)})).catch(r)}))}},{key:"get",value:function(e){var t=this;return new y((function(i,a){return e=o(e,"get"),t.ready().then((function(){f(t,e,{resolve:i,reject:a}),P(t,e)})).catch(a)}))}},{key:"set",value:function(e,t){var i=this;return new y((function(a,r){if(e=o(e,"set"),null==t)throw new TypeError("There must be a value to set.");return i.ready().then((function(){f(i,e,{resolve:a,reject:r}),P(i,e,t)})).catch(r)}))}},{key:"on",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===g(this,"event:".concat(e)).length&&this.callMethod("addEventListener",e).catch((function(){})),f(this,"event:".concat(e),t)}},{key:"off",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(t&&"function"!=typeof t)throw new TypeError("The callback must be a function.");b(this,"event:".concat(e),t)&&this.callMethod("removeEventListener",e).catch((function(e){}))}},{key:"loadVideo",value:function(e){return this.callMethod("loadVideo",e)}},{key:"ready",value:function(){var e=D.get(this)||new y((function(e,t){t(new Error("Unknown player. Probably unloaded."))}));return y.resolve(e)}},{key:"addCuePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.callMethod("addCuePoint",{time:e,data:t})}},{key:"removeCuePoint",value:function(e){return this.callMethod("removeCuePoint",e)}},{key:"enableTextTrack",value:function(e,t){if(!e)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:e,kind:t})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return F.isEnabled?F.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return F.isEnabled?F.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return F.isEnabled?y.resolve(F.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var e=this;return new y((function(t){if(D.delete(e),M.delete(e.element),e._originalElement&&(M.delete(e._originalElement),e._originalElement.removeAttribute("data-vimeo-initialized")),e.element&&"IFRAME"===e.element.nodeName&&e.element.parentNode&&(e.element.parentNode.parentNode&&e._originalElement&&e._originalElement!==e.element.parentNode?e.element.parentNode.parentNode.removeChild(e.element.parentNode):e.element.parentNode.removeChild(e.element)),e.element&&"DIV"===e.element.nodeName&&e.element.parentNode){e.element.removeAttribute("data-vimeo-initialized");var i=e.element.querySelector("iframe");i&&i.parentNode&&(i.parentNode.parentNode&&e._originalElement&&e._originalElement!==i.parentNode?i.parentNode.parentNode.removeChild(i.parentNode):i.parentNode.removeChild(i))}e._window.removeEventListener("message",e._onMessage),F.isEnabled&&F.off("fullscreenchange",e.fullscreenchangeHandler),t()}))}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(e){return this.set("autopause",e)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(e){return this.set("cameraProps",e)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"setColor",value:function(e){return this.set("color",e)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(e){return this.set("currentTime",e)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(e){return this.set("loop",e)}},{key:"setMuted",value:function(e){return this.set("muted",e)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(e){return this.set("playbackRate",e)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(e){return this.set("quality",e)}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(e){return this.set("volume",e)}}])&&r(t.prototype,i),s&&r(t,s),e}();s||(F=function(){var e=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,a=t.length,r={};i<a;i++)if((e=t[i])&&e[1]in document){for(i=0;i<e.length;i++)r[t[0][i]]=e[i];return r}return!1}(),t={fullscreenchange:e.fullscreenchange,fullscreenerror:e.fullscreenerror},i={request:function(t){return new Promise((function(a,r){var s=function e(){i.off("fullscreenchange",e),a()};i.on("fullscreenchange",s);var o=(t=t||document.documentElement)[e.requestFullscreen]();o instanceof Promise&&o.then(s).catch(r)}))},exit:function(){return new Promise((function(t,a){if(i.isFullscreen){var r=function e(){i.off("fullscreenchange",e),t()};i.on("fullscreenchange",r);var s=document[e.exitFullscreen]();s instanceof Promise&&s.then(r).catch(a)}else t()}))},on:function(e,i){var a=t[e];a&&document.addEventListener(a,i)},off:function(e,i){var a=t[e];a&&document.removeEventListener(a,i)}};return Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),i}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=[].slice.call(e.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),i=function(e){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(e))};t.forEach((function(e){try{if(null!==e.getAttribute("data-vimeo-defer"))return;var t=S(e);I(c(t),t,e).then((function(t){return C(t,e)})).catch(i)}catch(e){i(e)}}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var t=function(t){if(d(t.origin)&&t.data&&"spacechange"===t.data.event)for(var i=e.querySelectorAll("iframe"),a=0;a<i.length;a++)if(i[a].contentWindow===t.source){i[a].parentElement.style.paddingBottom="".concat(t.data.data[0].bottom,"px");break}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var t=function(t){if(d(t.origin)){var i=T(t.data);if(i&&"ready"===i.event)for(var a=e.querySelectorAll("iframe"),r=0;r<a.length;r++){var s=a[r],o=s.contentWindow===t.source;if(h(s.src)&&o)new V(s).callMethod("appendVideoMetadata",window.location.href)}}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var t=function(e){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(e))},i=function(i){if(d(i.origin)){var a=T(i.data);if(a&&"ready"===a.event)for(var r=e.querySelectorAll("iframe"),s=0;s<r.length;s++){var o=r[s],n=o.contentWindow===i.source;h(o.src)&&n&&function(){var e=new V(o);e.getVideoId().then((function(t){var i=new RegExp("[?&]vimeo_t_".concat(t,"=([^&#]*)")).exec(window.location.href);if(i&&i[1]){var a=decodeURI(i[1]);e.setCurrentTime(a)}})).catch(t)}()}}};window.addEventListener("message",i)}}()),t.a=V}).call(this,i(1),i(3).setImmediate)},function(e,t,i){(function(e){var a=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new s(r.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new s(r.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(4),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(1))},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var a,r,s,o,n,l=1,d={},h=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){m(e.data)},a=function(e){s.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,a=function(e){var t=c.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):a=function(e){setTimeout(m,0,e)}:(o="setImmediate$"+Math.random()+"$",n=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&m(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),a=function(t){e.postMessage(o+t,"*")}),u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var r={callback:e,args:t};return d[l]=r,a(l),l++},u.clearImmediate=p}function p(e){delete d[e]}function m(e){if(h)setTimeout(m,0,e);else{var t=d[e];if(t){h=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(void 0,i)}}(t)}finally{p(e),h=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i(1),i(5))},function(e,t){var i,a,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function n(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var l,d=[],h=!1,c=-1;function u(){h&&l&&(h=!1,l.length?d=l.concat(d):c=-1,d.length&&p())}function p(){if(!h){var e=n(u);h=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length}l=null,h=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new m(e,t)),1!==d.length||h||n(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t),i.d(t,"videoManagerFactoryGlobal",(function(){return G}));let a={info(e,t){},warn(e,t){},error(e,t){}};function r(e,t,i,a){return new(i||(i=Promise))((function(r,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function n(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,n)}l((a=a.apply(e,t||[])).next())}))}Object.create;Object.create;const s="Inserted URL is either not a valid video or can't be embedded",o={YouTube:["https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist|v|embed)/.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist)\\?.*","https://youtu\\.be/.*","https://youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/shorts.*"],Vimeo:["https://(\\w+\\.)?(player\\.)?vimeo\\.com/.*"],Flip:["https://(\\w+\\.)?flipgrid\\.com/s/.*","https://(\\w+\\.)?flip\\.com/s/.*","https://(\\w+\\.)?shorts\\.flipgrid\\.com/watch/.*","https://(\\w+\\.)?shorts\\.flip\\.com/watch/.*"],StreamClassic:["https://(\\w+\\.)?microsoftstream\\.com/embed/video/.*","https://(\\w+\\.)?microsoftstream\\.com/video/.*"],Ted:["https://embed\\.ted\\.com/talks/.*","https://www\\.ted\\.com/talks/.*","https://www\\.ted\\.com/index\\.php/talks/.*\\.html.*"],SlideShare:["https://(\\w+\\.)?slideshare\\.net/.*"]};function n(e,t){Object.assign(e.style,t)}function l(e){n(e,{zIndex:"6",pointerEvents:"all",position:"absolute",objectFit:"fill",height:"100%",width:"100%"})}var d;function h(e,t){for(const[i,a]of Object.entries(t))e.setAttribute(i,a)}!function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.GIF=2]="GIF",e[e.StreamClassic=3]="StreamClassic",e[e.YouTube=4]="YouTube",e[e.Vimeo=5]="Vimeo",e[e.Flip=6]="Flip",e[e.Ted=7]="Ted",e[e.Stream2=8]="Stream2",e[e.SlideShare=9]="SlideShare",e[e.Other=10]="Other"}(d||(d={}));class c{constructor(e,t,i,a){this.player=e,this.playbackTracker=i,this.onMediaEventCallback=a,this.playbackTracker.setIsMuted(this.player.muted),this.playbackTracker.setVolume(this.player.volume),this.registerEventListeners(t)}registerEventListeners(e){this.player.addEventListener("loadstart",()=>{this.playbackTracker.onLoadStart(),this.sendEvent(0)}),this.player.addEventListener("loadedmetadata",()=>{this.playbackTracker.onLoadedMetadata(),this.playbackTracker.setDuration(Math.round(1e3*this.player.duration)),this.player instanceof HTMLVideoElement&&this.playbackTracker.setSrcDimensions(this.player.videoWidth,this.player.videoHeight),this.sendEvent(1)}),this.player.addEventListener("loadeddata",()=>{this.sendEvent(2)}),this.player.addEventListener("canplay",()=>{this.playbackTracker.onCanPlay(),this.sendEvent(3)}),this.player.addEventListener("canplaythrough",()=>{this.playbackTracker.onCanPlayThrough()}),this.player.addEventListener("play",()=>{this.playbackTracker.onPlay(),this.sendEvent(4)}),this.player.addEventListener("playing",()=>{this.playbackTracker.onPlaying(),this.sendEvent(5)}),this.player.addEventListener("pause",()=>{this.playbackTracker.onPause(),this.sendEvent(6)}),this.player.addEventListener("seeked",()=>{this.sendEvent(7)}),this.player.addEventListener("seeking",()=>{this.sendEvent(8)}),e&&this.player.addEventListener("timeupdate",()=>{this.sendEvent(9)}),this.player.addEventListener("volumechange",()=>{this.playbackTracker.onVolumeChanged(this.player.volume),this.playbackTracker.setIsMuted(this.player.muted),this.sendEvent(10)}),this.player.addEventListener("stalled",()=>{this.playbackTracker.onStalled(),this.sendEvent(8)}),this.player.addEventListener("ended",()=>{this.playbackTracker.onEnded(),this.sendEvent(11)}),this.player.addEventListener("error",()=>{const e="Local media error."+(this.player.error?` Code: ${this.player.error.code}, message: ${this.player.error.message}`:"");this.playbackTracker.onError(e),this.sendEvent(12)})}getPlaybackData(){return this.playbackTracker.getPlaybackData()}cleanup(){this.playbackTracker.cleanup()}sendEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}}class u{constructor(e,t,i,r,s,o,n,l,d){this.isDesignerElement=i,this.mediaProperties=r,this.player=this.createLocalPlayer(e,t,i,r.mediaType,s,o,d),void 0!==n?(this.eventHandler=new c(this.player,this.mediaProperties.trimEndSec>0,n,l),n.setTimeOfCreation()):a.info(507573786,"Local: playbackTracker is undefined")}play(){return r(this,void 0,void 0,(function*(){try{yield this.player.play()}catch(e){a.error(541882e3,`Local.play: Failed to play local video. ${e instanceof DOMException?e.name:""} ${e instanceof DOMException?e.message:""}`)}a.info(520378572,"Local.play: this.player.paused: "+this.player.paused)}))}pause(){this.player.pause()}setVisible(){this.isDesignerElement&&(this.player.loop=!0),this.player.style.visibility="visible",this.setFocus()}setHidden(){this.isDesignerElement&&(this.player.loop=!1,this.player.autoplay=!1),this.player.style.pointerEvents="none",this.player.style.visibility="hidden"}stop(){this.player.pause(),this.player.currentTime=0}togglePause(){return r(this,void 0,void 0,(function*(){if(a.info(520378573,"Local.togglePause: Before toggle, this.player.paused: "+this.player.paused),this.player.paused)try{yield this.play()}catch(e){a.info(541882001,"Error local video play while toggle pause")}else this.pause();a.info(520378574,"Local.togglePause: After toggle, this.player.paused: "+this.player.paused)}))}isPaused(){return this.player.paused}getPlayer(){return this.player}setSource(e){this.player.src=e}getCurrentTime(){return this.player.currentTime}getDuration(){return this.player.duration}seekTo(e){this.player.currentTime=e}ensureMediaClient(){}cleanUpMediaClient(){void 0!==this.eventHandler&&void 0!==this.eventHandler.cleanup&&this.eventHandler.cleanup()}setMute(){this.player.muted=!0}setUnMute(){this.player.muted=!1}isMuted(){return this.player.muted}setVolume(e){this.player.volume=e}getVolume(){return this.player.volume}getPlaybackData(){if(void 0!==this.eventHandler&&void 0!==this.eventHandler.getPlaybackData)return this.eventHandler.getPlaybackData()}setFocus(){void 0!==this.player&&this.player.focus()}seekToTrimStartIfNeeded(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&(this.player.currentTime<this.mediaProperties.trimStartSec||this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec)&&(this.player.currentTime=this.mediaProperties.trimStartSec)}onTimeUpdate(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec&&this.player.pause()}isTrimValid(){return void 0!==this.mediaProperties.durationSec&&(this.mediaProperties.trimStartSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimEndSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec+this.mediaProperties.trimEndSec<this.mediaProperties.durationSec)}setTrim(e){void 0===e||isNaN(e.duration)||(this.mediaProperties.durationSec=e.duration,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec-this.mediaProperties.trimEndSec,this.isTrimValid()?(e.addEventListener("timeupdate",()=>{this.onTimeUpdate()}),e.addEventListener("play",()=>{this.seekToTrimStartIfNeeded()})):(this.mediaProperties.trimStartSec=0,this.mediaProperties.trimEndSec=0,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec))}createLocalPlayer(e,t,i,a,r,s,o){const c=a===d.Audio?document.createElement("audio"):document.createElement("video");return void 0!==e&&e.appendChild(c),c.style.visibility=i||r||s?"hidden":"visible",c.style.pointerEvents=r||s?"none":"all",this.setProperties(c),void 0!==this.mediaProperties.attributes?h(c,this.mediaProperties.attributes):h(c,{disablePictureInPicture:"true",controlsList:"nodownload nofullscreen noremoteplayback"}),void 0!==this.mediaProperties.styles?n(c,this.mediaProperties.styles):l(c),i?(c.loop=!0,c.muted=!0,c.addEventListener("canplay",()=>{c.style.visibility="visible"},{once:!0})):this.setFocus(),(this.mediaProperties.trimStartSec>0||this.mediaProperties.trimEndSec>0)&&c.addEventListener("loadedmetadata",()=>{this.setTrim(c)},{once:!0}),null!=o&&o.forEach(e=>{const t=document.createElement("track"),i=e.lang&&""!==e.lang?e.lang:"unknown";t.setAttribute("kind","captions"),t.setAttribute("label",e.label),t.setAttribute("src",decodeURIComponent(e.src)),t.setAttribute("srclang",i),c.appendChild(t)}),c.src=t,c}setProperties(e){e.autoplay=void 0===this.mediaProperties.autoPlay||this.mediaProperties.autoPlay,e.controls=void 0===this.mediaProperties.controls||this.mediaProperties.controls,void 0!==this.mediaProperties.elementId&&(e.id=this.mediaProperties.elementId),void 0!==this.mediaProperties.crossOrigin&&(e.crossOrigin=this.mediaProperties.crossOrigin),void 0!==this.mediaProperties.zIndex&&(e.style.zIndex=this.mediaProperties.zIndex),void 0!==this.mediaProperties.preload&&(e.preload=this.mediaProperties.preload),e instanceof HTMLVideoElement&&(void 0!==this.mediaProperties.playsInline&&(e.playsInline=this.mediaProperties.playsInline),void 0!==this.mediaProperties.width&&(e.width=this.mediaProperties.width),void 0!==this.mediaProperties.height&&(e.height=this.mediaProperties.height))}}let p={getBoolean:e=>!1,getNumber(e){},getString(e){}};class m{constructor(e,t,i){this.playButton=t,this.parent=e,this.appSettings=i}setPlayButtonVisible(){this.isPlayButtonBiggerThanParent()||(this.playButton.style.display="block",this.playButton.style.pointerEvents="visible")}setPlayButtonHidden(){this.playButton.style.display="none"}updatePlayButtonVisibility(){this.isPlayButtonBiggerThanParent()?this.setPlayButtonHidden():(this.playButton.style.display="block",this.playButton.style.pointerEvents="visible")}onSelectPlayButton(){if(void 0===this.shapeOverlayElement&&this.findShapeSelectionOverlay(),void 0!==this.shapeOverlayElement){let e=0,t=0;!0!==this.appSettings.playButtonHoverOverlayEnabled&&!p.getBoolean("PlayButtonHoverOverlayEnabled")||!0!==this.appSettings.playButtonIconUpdateEnabled&&!p.getBoolean("PlayButtonIconUpdateEnabled")?(e=parseFloat(this.parent.style.left)+parseFloat(this.parent.style.width)/2-28.3,t=parseFloat(this.parent.style.top)+parseFloat(this.parent.style.height)/2-28.3):(e=parseFloat(this.parent.style.left)+parseFloat(this.parent.style.width)/2-48,t=parseFloat(this.parent.style.top)+parseFloat(this.parent.style.height)/2-48),this.playButton.style.top=t+"px",this.playButton.style.left=e+"px",this.shapeOverlayElement.appendChild(this.playButton)}}onDeSelectPlayButton(){!0!==this.appSettings.playButtonHoverOverlayEnabled&&!p.getBoolean("PlayButtonHoverOverlayEnabled")||!0!==this.appSettings.playButtonIconUpdateEnabled&&!p.getBoolean("PlayButtonIconUpdateEnabled")?(this.playButton.style.top="calc(50% - 28.3px)",this.playButton.style.left="calc(50% - 28.3px)"):(this.playButton.style.top="calc(50% - 48px)",this.playButton.style.left="calc(50% - 48px)"),this.parent.appendChild(this.playButton)}findShapeSelectionOverlay(){null!==this.parent.parentElement&&void 0!==this.parent.parentElement.getElementsByClassName("ShapeSelectionOverlay")[0]?this.shapeOverlayElement=this.parent.parentElement.getElementsByClassName("ShapeSelectionOverlay")[0]:this.shapeOverlayElement=void 0}isPlayButtonBiggerThanParent(){return 56.6>parseFloat(this.parent.style.width)||56.6>parseFloat(this.parent.style.height)}}function y(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}class v extends Error{constructor(e,t){super(t),this.statusCode=e}}function f(e,t){if(void 0===e.apiBaseUrl)throw new Error("Hubble API base URL is undefined");const i=new URL(e.apiBaseUrl);if(i.pathname=t,void 0!==e.app){const t=function(e){if(void 0!==e)switch(e){case"Word":return"0";case"Excel":return"1";case"Teams":case"PowerPoint":return"3";case"Outlook":return"5";case"OneNote":return"8";case"Publisher":return"10";case"Visio":return"12";case"SharePoint":return"1001";default:return}}(e.app);void 0!==t&&i.searchParams.set("app",t)}return void 0!==e.appPlatform&&i.searchParams.set("platform",e.appPlatform),i}function g(e){const t=new Headers;return void 0!==e.correlationId&&t.set("X-CorrelationId",e.correlationId),void 0!==e.acceptLanguage&&t.set("Accept-Language",e.acceptLanguage),void 0!==e.aadToken&&t.set("Authorization",e.aadToken),t.set("Content-Type","application/json; charset=utf-8"),t}function b(e){for(const[t,i]of Object.entries(o))for(const a of i){if(new RegExp(a).test(e))return t}a.error(512271065,"Error getting provider name from URL (scheme not found in ONLINE_PROVIDER_URL_SCHEMES)")}var k,T=new Uint8Array(16);function P(){if(!k&&!(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(T)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var E=function(e){return"string"==typeof e&&w.test(e)},S=[],C=0;C<256;++C)S.push((C+256).toString(16).substr(1));var I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]).toLowerCase();if(!E(i))throw TypeError("Stringified UUID is invalid");return i};var M=function(e,t,i){var a=(e=e||{}).random||(e.rng||P)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=a[r];return t}return I(a)};class D{constructor(e,t){this.totalPlayingTime=0,this.providerName="Other",this.correlationId=M(),this.isPlaying=!1,this.isFirstReady=!0,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.creationTime=Date.now(),this.appSettings=e,this.onVetoCallback=t,void 0!==this.appSettings.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=this.appSettings.SlowPlayVetoThreshold),void 0!==this.appSettings.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=this.appSettings.NotYetPlayedVetoThreshold)}onReady(){this.logEvent("ready"),this.isFirstReady&&(this.isFirstReady=!1,this.timeToInteractivity=Date.now(),this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0)}onPlay(){this.logEvent("play"),this.lastPlayTime=Date.now(),void 0===this.timeToFirstPlay&&(this.timeToFirstPlay=Date.now()),this.lastPlayingTime=void 0}onPlaying(){if(this.logEvent("playing"),void 0===this.timeToFirstPlaying&&(this.timeToFirstPlaying=Date.now(),void 0!==this.timeToFirstPlayIntent)){this.clearVideoNotPlayedTimeout();const e=this.timeToFirstPlaying-this.timeToFirstPlayIntent;e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow",`Video played after ${e} ms`)}this.isPlaying=!0,this.setTimeSincePlay(),this.calculateBufferingTime(),this.lastPlayTime=void 0,void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.setTimeSincePlay(),this.lastPlayTime=void 0,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.playedUntilEnd=!0,this.calculatePlayingTime()}onSeeking(){this.logEvent("seeking"),this.setTimeSinceSeek(),this.lastSeekTime=Date.now()}onSeeked(){this.logEvent("seeked"),this.setTimeSinceSeek(),this.lastSeekTime=void 0}onVolumeChanged(e){this.logEvent("volumeChanged"),this.volume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.isMuted=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onInit(){void 0===this.timeToInit&&(this.timeToInit=Date.now())}onHubbleTokenSet(){void 0===this.timeToHubbleToken&&(this.timeToHubbleToken=Date.now())}onOEmbedResponse(){void 0===this.timeToOEmbedResponse&&(this.timeToOEmbedResponse=Date.now())}onNavigatedToEmbedPage(){void 0===this.timeToNavigatedToEmbedPage&&(this.timeToNavigatedToEmbedPage=Date.now())}onPostMessagingInitialized(){void 0===this.timeToPostMessagingInitialized&&(this.timeToPostMessagingInitialized=Date.now())}onODSPVideoLoad(e){void 0===this.timeToODSPVideoLoadStart&&(this.timeToODSPVideoLoadStart=Date.now()-e)}onError(e,t=!1){this.logEvent("error");const i="Stream2"===this.providerName?"Stream2":"Online";let r=i+"VideoError";this.isPlaying?r=i+"VideoErrorWhilePlaying":void 0!==this.timeToFirstPlaying?r=i+"VideoErrorAfterPlaying":"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?r="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(r="Stream2VideoRedemptionStormError"));const s=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");a.error(508843611,"Online video raised error: "+JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:r,message:s,provider:this.providerName,correlationId:this.correlationId}));const o=t?1:3;(void 0===this.error||o<=this.error.severity)&&(this.error={severity:o,name:r,message:s,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===this.timeToFirstPlayIntent&&void 0===this.timeToInteractivity||this.sendVeto(i+"MediaPlaybackFailure",this.error.name,this.error.message))}onPlayCommand(){if(void 0===this.timeToFirstPlaying&&void 0===this.timeToFirstPlayIntent){if(this.timeToFirstPlayIntent=Date.now(),void 0!==this.error&&1===this.error.severity){const e="Stream2"===this.providerName?"Stream2":"Online";return void this.sendVeto(e+"MediaPlaybackFailure",this.error.name,this.error.message)}if("Other"===this.providerName||"Ted"===this.providerName||"SlideShare"===this.providerName)return;this.videoNotYetPlayedTimeout=window.setTimeout(()=>{this.videoNotYetPlayedTimeout=void 0,void 0===this.timeToFirstPlaying&&this.onSlowPerfError("VideoNotYetPlayed",`Video hasn't played after ${this.notYetPlayedVetoThreshold} ms`)},this.notYetPlayedVetoThreshold)}}onPauseCommand(){void 0===this.timeToFirstPlaying&&void 0!==this.timeToFirstPlayIntent&&(this.timeToFirstPlayIntent=void 0,this.clearVideoNotPlayedTimeout())}onStopCommand(){void 0===this.timeToFirstPlaying&&void 0!==this.timeToFirstPlayIntent&&(this.timeToFirstPlayIntent=void 0,this.clearVideoNotPlayedTimeout())}setCreationTime(){this.creationTime=Date.now()}setProviderName(e){this.providerName=e}setDuration(e){this.duration=e}setVolume(e){this.volume=e}setMute(e){this.isMuted=e}cleanup(){this.timeToInit=void 0,this.timeToHubbleToken=void 0,this.timeToOEmbedResponse=void 0,this.timeToNavigatedToEmbedPage=void 0,this.timeToPostMessagingInitialized=void 0,this.timeToODSPVideoLoadStart=void 0,this.timeToInteractivity=void 0,this.timeToFirstPlayIntent=void 0,this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0,this.lastBufferTime=void 0,this.lastSeekTime=void 0,this.lastPlayTime=void 0,this.lastPlayingTime=void 0,this.totalPlayingTime=0,this.totalBufferingTime=void 0,this.maxTimeSincePlay=void 0,this.maxTimeSinceSeek=void 0,this.playedUntilEnd=void 0,this.volume=void 0,this.isMuted=void 0,this.isPlaying=!1,this.isFirstReady=!0,this.error=void 0,this.wasVetoLogged=void 0,this.correlationId=M(),this.clearVideoNotPlayedTimeout()}getCorrelationId(){return this.correlationId}getPerfData(){var e,t,i;return this.calculatePlayingTime(),this.calculateBufferingTime(),{correlationId:this.correlationId,creationTime:this.creationTime,providerName:this.providerName,timeToInit:this.timeToInit,timeToHubbleToken:this.timeToHubbleToken,timeToOEmbedResponse:this.timeToOEmbedResponse,timeToNavigatedToEmbedPage:this.timeToNavigatedToEmbedPage,timeToPostMessagingInitialized:this.timeToPostMessagingInitialized,timeToODSPVideoLoadStart:this.timeToODSPVideoLoadStart,timeToInteractivity:this.timeToInteractivity,timeToFirstPlayIntent:this.timeToFirstPlayIntent,timeToFirstPlay:this.timeToFirstPlay,timeToFirstPlaying:this.timeToFirstPlaying,timeToError:null===(e=this.error)||void 0===e?void 0:e.timestamp,lastBufferTime:this.lastBufferTime,lastSeekTime:this.lastSeekTime,lastPlayTime:this.lastPlayTime,lastPlayingTime:this.lastPlayingTime,totalPlayingTime:this.totalPlayingTime,totalBufferingTime:this.totalBufferingTime,maxTimeSincePlay:this.maxTimeSincePlay,maxTimeSinceSeek:this.maxTimeSinceSeek,currentTimeSincePlay:this.setTimeSincePlay(),currentTimeSinceSeek:this.setTimeSinceSeek(),duration:this.duration,wasPlayedUntilEnd:this.playedUntilEnd,lastVolume:this.volume,lastMuteState:this.isMuted,isPlaying:this.isPlaying,errorName:null===(t=this.error)||void 0===t?void 0:t.name,errorMessage:null===(i=this.error)||void 0===i?void 0:i.message,wasVetoLogged:this.wasVetoLogged}}onSlowPerfError(e,t){const i="Stream2"===this.providerName?"Stream2":"Online",r=i+e;a.error(508699337,"Online video slow perf: "+JSON.stringify({name:r,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId}));(void 0===this.error||2<=this.error.severity)&&(this.error={name:r,severity:2,message:t,timestamp:Date.now()}),this.sendVeto(i+"MediaPerfSlow",r,t)}clearVideoNotPlayedTimeout(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}setTimeSincePlay(){if(void 0===this.lastPlayTime)return;const e=Date.now()-this.lastPlayTime;return this.maxTimeSincePlay=void 0!==this.maxTimeSincePlay?Math.max(this.maxTimeSincePlay,e):e,e}setTimeSinceSeek(){if(void 0===this.lastSeekTime)return;const e=Date.now()-this.lastSeekTime;return this.maxTimeSinceSeek=void 0!==this.maxTimeSinceSeek?Math.max(this.maxTimeSinceSeek,e):e,e}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.totalBufferingTime&&(this.totalBufferingTime=0),this.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;this.totalPlayingTime+=e,this.lastPlayingTime=void 0}}sendVeto(e,t,i){this.wasVetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback(e,t,i,this.correlationId)}logEvent(e){a.info(527983830,"Online video emitted event: "+JSON.stringify({event:e,provider:this.providerName,correlationId:this.correlationId}))}}class F{constructor(e,t,i,a,r){this.providerName="",this.mediaId="",this.vetoLogged=!1,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.appSettings=e,this.correlationId=t,void 0!==i&&(this.providerName=i),void 0!==a&&(this.mediaId=a),this.onVetoCallback=r,void 0!==e.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=e.SlowPlayVetoThreshold),void 0!==e.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=e.NotYetPlayedVetoThreshold)}get wasVetoLogged(){return this.vetoLogged}getError(){return this.error}setError(e){this.error=e}setProviderName(e){this.providerName=e}setLoggableId(e){this.mediaId=e}onError(e,t,i,r,s,o){const n=this.getPrefix();let l=n+"VideoError";i?l=n+"VideoErrorWhilePlaying":void 0!==r?l=n+"VideoErrorAfterPlaying":"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?l="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(l="Stream2VideoRedemptionStormError"));const d=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");a.error(508671629,"Media raised error: "+JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:l,message:d,provider:this.providerName,correlationId:this.correlationId}));const h=t?1:3;(void 0===this.error||h<=this.error.severity)&&(this.error={severity:h,name:l,message:d,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===s&&void 0===o||this.sendVeto(n+"MediaPlaybackFailure",this.error.name,this.error.message))}hasCriticalError(){return void 0!==this.error&&1===this.error.severity}logPlaybackFailure(){if(void 0!==this.error&&1===this.error.severity){const e=this.getPrefix();this.sendVeto(e+"MediaPlaybackFailure",this.error.name,this.error.message)}}logIfSlowPlaybackStart(e){this.clearVideoNotPlayedTimeout(),e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow",`Video played after ${e} ms`)}setVideoNotPlayedTimeout(e){this.videoNotYetPlayedTimeout=window.setTimeout(()=>{this.videoNotYetPlayedTimeout=void 0,void 0===e()&&this.onSlowPerfError("VideoNotYetPlayed",`Video hasn't played after ${this.notYetPlayedVetoThreshold} ms`)},this.notYetPlayedVetoThreshold)}clearVideoNotPlayedTimeout(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}cleanup(){this.clearVideoNotPlayedTimeout(),this.error=void 0,this.vetoLogged=!1}onSlowPerfError(e,t){const i=this.getPrefix(),r=i+e;a.error(508671628,"Media slow perf: "+JSON.stringify({name:r,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId}));(void 0===this.error||2<=this.error.severity)&&(this.error={name:r,severity:2,message:t,timestamp:Date.now()}),this.sendVeto(i+"MediaPerfSlow",r,t)}getPrefix(){return"Local"===this.providerName?"Local":"Stream2"===this.providerName?"Stream2":"Online"}sendVeto(e,t,i){this.vetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback({vetoName:e,errorName:t,details:i,correlationId:this.correlationId,mediaId:this.mediaId,providerName:this.providerName})}}class V{constructor(e,t,i,a,r){this.isPlaying=!1;const s=M();this.baseData={requestGuid:s,providerName:t,loggableMediaId:i,mediaType:a},this.vetoHandler=new F(e,s,t,i,r)}setLoggableId(e){this.baseData.loggableMediaId=e,this.vetoHandler.setLoggableId(e)}setProviderName(e){this.baseData.providerName=e,this.vetoHandler.setProviderName(e)}setMediaType(e){this.baseData.mediaType=e}setTimeOfCreation(){this.baseData.timeOfCreation=Date.now()}setUiHostType(e){this.baseData.uiHostType=e}setFlights(e){this.baseData.flights=e}onLoadStart(){this.logEvent("loadstart"),void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now(),this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onCanPlay(){this.logEvent("canplay"),void 0===this.baseData.timeOfCanPlay&&(this.baseData.timeOfCanPlay=Date.now(),this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onSourceSet(){this.logEvent("sourceset"),void 0===this.baseData.timeOfSourceSet&&(this.baseData.timeOfSourceSet=Date.now())}onPlayRequested(){this.logEvent("playrequested"),void 0===this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=Date.now())}onPlay(){this.logEvent("play"),void 0===this.baseData.timeOfPlay&&(this.baseData.timeOfPlay=Date.now(),this.baseData.timeOfPlaying=void 0),this.lastPlayingTime=void 0}onPlaying(){this.logEvent("playing"),void 0===this.baseData.timeOfPlaying&&(this.baseData.timeOfPlaying=Date.now(),void 0!==this.baseData.timeOfPlayRequest&&this.vetoHandler.logIfSlowPlaybackStart(this.baseData.timeOfPlaying-this.baseData.timeOfPlayRequest)),this.isPlaying=!0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPlayCommand(e=!0){if(this.logEvent("playcommand"),void 0===this.baseData.timeOfPlaying&&void 0===this.baseData.timeOfPlayRequest){if(this.baseData.timeOfPlayRequest=Date.now(),this.vetoHandler.hasCriticalError())return void this.vetoHandler.logPlaybackFailure();if(e){const e=()=>this.baseData.timeOfPlaying;this.vetoHandler.setVideoNotPlayedTimeout(e)}}}onStopCommand(){this.logEvent("stopcommand"),void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.baseData.wasPlayedUntilEnd=!0,this.calculatePlayingTime()}onVolumeChanged(e){this.logEvent("volumeChanged"),this.baseData.lastVolume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.baseData.lastMuteState=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onError(e,t=!1){this.logEvent("error"),this.vetoHandler.onError(e,t,this.isPlaying,this.baseData.timeOfPlaying,this.baseData.timeOfPlayRequest,this.baseData.timeOfCanPlay)}cleanup(){this.baseData.timeOfCreation=void 0,this.baseData.timeOfSourceSet=void 0,this.baseData.timeOfLoadStart=void 0,this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlayRequest=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0,this.baseData.timeOfError=void 0,this.baseData.totalPlayingTime=0,this.baseData.totalBufferingTime=0,this.baseData.lastVolume=void 0,this.baseData.lastMuteState=void 0,this.baseData.wasPlayedUntilEnd=void 0,this.baseData.errorName=void 0,this.baseData.errorMessage=void 0,this.baseData.wasVetoLogged=void 0,this.isPlaying=!1,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.vetoHandler.cleanup(),this.baseData.requestGuid=M()}getPlaybackData(){const e=this.vetoHandler.getError();return this.baseData.errorName=null==e?void 0:e.name,this.baseData.errorMessage=null==e?void 0:e.message,this.baseData.timeOfError=null==e?void 0:e.timestamp,this.baseData.wasVetoLogged=this.vetoHandler.wasVetoLogged,this.calculatePlayingTime(),this.calculateBufferingTime(),this.baseData}setViewDimensions(e,t){this.baseData.viewWidth=e,this.baseData.viewHeight=t}setMediaId(e){this.baseData.loggableMediaId=e}setDuration(e){this.baseData.duration=e}setVolume(e){this.baseData.lastVolume=e}setIsMuted(e){this.baseData.lastMuteState=e}logEvent(e){a.info(508704415,"Media emitted event: "+JSON.stringify({event:e,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid}))}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.baseData.totalBufferingTime&&(this.baseData.totalBufferingTime=0),this.baseData.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;void 0===this.baseData.totalPlayingTime&&(this.baseData.totalPlayingTime=0),this.baseData.totalPlayingTime+=e,this.lastPlayingTime=void 0}}}class A extends V{constructor(e,t,i,a){super(e,t,i,t,a),this.onlineData={}}getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.onlineData)}onHubbleTokenSet(){void 0===this.onlineData.timeOfHubbleToken&&(this.onlineData.timeOfHubbleToken=Date.now())}onOEmbedResponse(){void 0===this.onlineData.timeOfOEmbedResponse&&(this.onlineData.timeOfOEmbedResponse=Date.now())}onNavigatedToEmbedPage(){void 0===this.onlineData.timeOfNavigatedToEmbedPage&&(this.onlineData.timeOfNavigatedToEmbedPage=Date.now())}onPostMessagingInitialized(){void 0===this.onlineData.timeOfPostMessagingInitialized&&(this.onlineData.timeOfPostMessagingInitialized=Date.now())}onODSPVideoLoad(e){void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now()-e)}onVideoElementStopPlaying(){const e=this.baseData.lastVolume,t=this.baseData.lastMuteState,i=this.vetoHandler.getError();this.cleanup(),void 0!==e&&this.setVolume(e),void 0!==t&&this.setIsMuted(t),void 0!==i&&this.vetoHandler.setError(i)}onPlayCommand(){const e="Other"!==this.baseData.providerName&&"Ted"!==this.baseData.providerName&&"SlideShare"!==this.baseData.providerName;super.onPlayCommand(e)}onPauseCommand(){void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}cleanup(){this.onlineData.timeOfHubbleToken=void 0,this.onlineData.timeOfOEmbedResponse=void 0,this.onlineData.timeOfPostMessagingInitialized=void 0,super.cleanup()}}class O extends V{constructor(e,t,i,a){super(e,"Local",t,i,a),this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.useLoadedMetadataAsInteractivityEvent=!1,this.localData={},this.useLoadedMetadataAsInteractivityEvent=p.getBoolean("useLoadedMetadataAsInteractivityEvent")}onLoadStart(){void 0===this.baseData.timeOfLoadStart&&(this.localData.timeOfLoadedMetadata=void 0,this.localData.timeOfCanPlayThrough=void 0),super.onLoadStart()}onLoadedMetadata(){void 0===this.localData.timeOfLoadedMetadata&&(this.localData.timeOfLoadedMetadata=Date.now(),this.useLoadedMetadataAsInteractivityEvent?this.baseData.timeOfCanPlay=this.localData.timeOfLoadedMetadata:this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onCanPlay(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||super.onCanPlay()),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||a.error(508695704,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: "+this.baseData.loggableMediaId))}onCanPlayThrough(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||super.onCanPlay()),this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.localData.timeOfCanPlayThrough=Date.now(),this.isFirstCanPlay&&a.error(508704418,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: "+this.baseData.loggableMediaId))}onPlay(){this.checkPlayerNotReady("play"),super.onPlay(),this.isFirstPlay&&(this.isFirstPlay=!1,this.isFirstCanPlay&&a.error(508704417,"No 'canplay' event was triggered before triggering the 'play' event on media: "+this.baseData.loggableMediaId))}onPlaying(){this.checkPlayerNotReady("playing"),super.onPlaying(),this.isFirstPlay&&a.error(507540381,"No 'play' event was triggered before triggering the 'playing' event on media: "+this.baseData.loggableMediaId)}onStalled(){this.isPlaying&&(void 0===this.localData.numberOfStalls?this.localData.numberOfStalls=1:this.localData.numberOfStalls+=1)}cleanup(){this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,super.cleanup()}getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.localData)}setSrcDimensions(e,t){this.localData.sourceVideoWidth=e,this.localData.sourceVideoHeight=t}setMediaExtension(e){this.localData.mediaExtension=e}setContentType(e){this.localData.contentType=e}setMediaLength(e){this.localData.mediaLength=e}setRetriesLeft(e){this.localData.retriesLeft=e}setIsUsingPlaybackControls(){this.localData.isUsingPlaybackControls=!0}checkPlayerNotReady(e){void 0===this.baseData.timeOfCanPlay&&a.info(507540380,"Event emitted before media became interactive: "+JSON.stringify({event:e,media:this.baseData.loggableMediaId,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid}))}}class R{constructor(e,t,i,r,s,o,n,l,d,h,c){if(this.playbackStarted=!1,this.appSettings=n,this.isNativeVideo=r,this.isDesignerElement=s,this.parent=e,this.url=t,this.trackList=[],this.videoToolTip=i,this.videoLibraryCallback=o,this.playButton=this.createPlayButton(c),this.playButtonHandler=new m(this.parent,this.playButton,this.appSettings),this.onTokenRequestCallback=d,this.createOnlineClient=l,a.info(541882006,"Video Element Count"),this.isDesignerElement&&this.startPlaying(!1),void 0!==(null==h?void 0:h.tracksInfo)&&null!==(null==h?void 0:h.tracksInfo)&&(this.trackList=h.tracksInfo.trackList),this.isNativeVideo)this.mediaType="Local",this.localClientPlaybackTracker=new O(this.appSettings,"","Video",e=>{this.onClientMediaVeto(e)});else{const e=b(this.url);this.mediaType=void 0!==e?e:"Stream2",this.onlineClientPerfTracker=new D(this.appSettings,(e,t,i,a)=>this.onClientVeto(e,t,i,a)),!0===n.useNewOnlineTelemetry&&(this.onlineClientPlaybackTracker=new A(this.appSettings,e,void 0,e=>{this.onClientMediaVeto(e)}))}!0===n.preLoadLocalVideo&&this.preLoadLocalVideo()}preLoadLocalVideo(){void 0===this.client&&this.createClient(this.url,!1)}preLoadLocalVideoClient(e,t){this.url=t,void 0!==(null==e?void 0:e.tracksInfo)&&null!==(null==e?void 0:e.tracksInfo)&&(this.trackList=e.tracksInfo.trackList),void 0===this.client&&this.createClient(this.url,!1)}setPlayButtonHidden(){void 0!==this.playButtonHandler&&this.playButtonHandler.setPlayButtonHidden()}updatePlayButtonVisibility(){this.playbackStarted||void 0===this.playButtonHandler||this.playButtonHandler.updatePlayButtonVisibility()}setPlayButtonVisible(){this.playbackStarted||void 0===this.playButtonHandler||this.playButtonHandler.setPlayButtonVisible()}activate(e,t,i){var r;return this.isNativeVideo&&""===this.url?(this.setPlayButtonHidden(),this.playbackStarted=!0,this.videoLibraryCallback.fetchLocalVideoSrc(e,t,i),!1):(void 0===this.client?this.createClient(this.url,e):(!this.playbackStarted||void 0!==this.client.isPaused&&null!==(r=this.client.isPaused())&&void 0!==r&&r)&&(this.client.setVisible(),e&&this.client.play(),this.setDefaultStyles(),e&&this.videoLibraryCallback.onPlaybackStarted()),void 0!==this.client&&(this.playbackStarted=!0),a.info(541882007,"Video Play Count"),this.setPlayButtonHidden(),!0)}startPlaying(e){return this.activate(!0,!1,void 0!==e&&e)}stopPlaying(){void 0!==this.client&&this.playbackStarted&&(this.isNativeVideo||void 0===this.onlineClientPerfTracker||(a.info(509384070,"OnlineVideoPlayback Summary: "+JSON.stringify(this.onlineClientPerfTracker.getPerfData())),this.onlineClientPerfTracker.onStopCommand()),this.isNativeVideo||void 0===this.onlineClientPlaybackTracker||(a.info(508360775,"OnlineVideoPlayback Summary: "+JSON.stringify(this.onlineClientPlaybackTracker.getPlaybackData())),this.onlineClientPlaybackTracker.onStopCommand()),this.isNativeVideo&&void 0!==this.localClientPlaybackTracker&&(a.info(508118040,"LocalMediaPlayback Summary: "+JSON.stringify(this.localClientPlaybackTracker.getPlaybackData())),this.localClientPlaybackTracker.onStopCommand()),this.client.setHidden(),this.client.stop()),this.playbackStarted=!1}hasPlaybackStarted(){return this.playbackStarted}hasClient(){return void 0!==this.client}setLocalVideoSrc(e,t){this.appSettings.preLoadLocalVideo=!1,this.appSettings.preLoadLocalVideoClient=!1,this.url=e,(this.videoLibraryCallback.isSelected()||this.isDesignerElement)&&this.activate(void 0===t||t,!1,!1)}setLocalVideoAndCaptionsSrc(e,t){null!=e&&(void 0!==e.tracksInfo&&null!==e.tracksInfo&&(this.trackList=e.tracksInfo.trackList),this.setLocalVideoSrc(e.src,t))}onSelectPlayButton(){void 0!==this.playButtonHandler&&this.playButtonHandler.onSelectPlayButton()}onDeSelectPlayButton(){void 0!==this.playButtonHandler&&this.playButtonHandler.onDeSelectPlayButton()}dispose(){null!==this.playButton&&void 0!==this.playButton&&null!==this.playButton.parentNode&&void 0!==this.playButton.parentNode&&this.playButton.parentNode.removeChild(this.playButton)}setDefaultStyles(){if(void 0!==this.client){const e=this.client.getPlayer();void 0!==e&&l(e)}}createClient(e,t){if(this.isNativeVideo)try{this.client=new u(this.parent,e,this.isDesignerElement,void 0!==this.videoLibraryCallback?void 0!==(i=this.videoLibraryCallback.getMediaProperties())?{trimStartSec:void 0!==i.trimStartSec?i.trimStartSec:0,trimEndSec:void 0!==i.trimEndSec?i.trimEndSec:0,volume:void 0!==i.volume?i.volume:.8,mute:void 0!==i.mute&&i.mute,repeat:void 0!==i.repeat&&i.repeat,rewind:void 0!==i.rewind&&i.rewind,playAcrossSlides:void 0!==i.playAcrossSlides&&i.playAcrossSlides,hideDuringShow:void 0!==i.hideDuringShow&&i.hideDuringShow,startOption:void 0!==i.startOption?i.startOption:"NYI",elementId:void 0!==i.elementId?i.elementId:"",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:void 0,mediaType:void 0,contentType:void 0,autoPlay:void 0===i.autoPlay||i.autoPlay,preload:i.preload,playsInline:void 0,crossOrigin:void 0,useCustomControls:void 0,controls:void 0===i.controls||i.controls,handleTimeUpdate:void 0,zIndex:void 0,height:void 0,width:void 0,styles:void 0,attributes:void 0}:{trimStartSec:0,trimEndSec:0,volume:.8,mute:!1,repeat:!1,rewind:!1,playAcrossSlides:!1,hideDuringShow:!1,startOption:"NYI",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:void 0,elementId:void 0,mediaType:void 0,contentType:void 0,autoPlay:!1,preload:void 0,playsInline:!1,crossOrigin:"anonymous",controls:!0,useCustomControls:!1,handleTimeUpdate:!1,zIndex:"6",height:void 0,width:void 0,styles:void 0,attributes:void 0}:{trimStartSec:0,trimEndSec:0,volume:.8,mute:!1,repeat:!1,rewind:!1,playAcrossSlides:!1,hideDuringShow:!1,startOption:"NYI",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:void 0,elementId:void 0,mediaType:void 0,contentType:void 0,autoPlay:!1,preload:void 0,playsInline:!1,crossOrigin:"anonymous",controls:!0,useCustomControls:!1,handleTimeUpdate:!1,zIndex:"6",height:void 0,width:void 0,styles:void 0,attributes:void 0},this.appSettings.preLoadLocalVideo,this.appSettings.preLoadLocalVideoClient,this.localClientPlaybackTracker,void 0,this.trackList),t&&(this.client.play(),this.videoLibraryCallback.onPlaybackStarted()),this.appSettings.preLoadLocalVideoClient||(this.playbackStarted=!0)}catch(e){return a.info(541882008,"Error creating local video client: "+e.message),void(void 0!==this.localClientPlaybackTracker&&this.localClientPlaybackTracker.onError("Error creating local video client: "+e.message,!0))}else try{if(void 0===this.createOnlineClient)throw new Error("Non native video not supported.");this.client=this.createOnlineClient(e,this.parent,this.appSettings,void 0,this.onlineClientPerfTracker,this.onlineClientPlaybackTracker,()=>this.onClientReady(),void 0,this.onTokenRequestCallback)}catch(e){return void 0!==this.onlineClientPerfTracker&&this.onlineClientPerfTracker.onError("Error creating online video client: "+e.message,!0),void(void 0!==this.onlineClientPlaybackTracker&&this.onlineClientPlaybackTracker.onError("Error creating online video client: "+e.message,!0))}var i;const r=this.client.getPlayer();void 0!==r&&r.setAttribute("title",this.videoToolTip),a.info(541882009,"Success VideoManager")}onClientReady(){void 0!==this.client&&this.client.play()}onClientVeto(e,t,i,r){a.error(509202786,"Veto raised for video: "+JSON.stringify({vetoName:e,errorName:t,details:i,correlationId:r,mediaType:this.mediaType}))}onClientMediaVeto(e){a.error(508360774,"Veto raised for video: "+JSON.stringify({vetoName:e.vetoName,errorName:e.errorName,details:e.details,correlationId:e.correlationId,mediaType:this.mediaType}))}playButtonOnClick(e){void 0!==e&&(e.stopImmediatePropagation(),e.preventDefault()),void 0!==this.onlineClientPerfTracker&&this.onlineClientPerfTracker.onPlayCommand(),void 0!==this.onlineClientPlaybackTracker&&this.onlineClientPlaybackTracker.onPlayCommand(),void 0!==this.localClientPlaybackTracker&&this.localClientPlaybackTracker.onPlayCommand(),this.videoLibraryCallback.selectShape(),this.startPlaying(!1)}createPlayButton(e){let t;return t=!0===this.appSettings.playButtonHoverOverlayEnabled||p.getBoolean("PlayButtonHoverOverlayEnabled")?function(e,t){const i=y("svg");!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?i.setAttribute("viewBox","-48 -48 96 96"):i.setAttribute("viewBox","-30 -30 60 60"),i.setAttribute("role","button"),i.setAttribute("aria-label",null!=t?t:"Play"),!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?n(i,{height:"96px",width:"96px",position:"absolute",zIndex:"6",top:"calc(50% - 48px)",left:"calc(50% - 48px)",cursor:"pointer",pointerEvents:"all"}):n(i,{height:"60px",width:"60px",position:"absolute",zIndex:"6",top:"calc(50% - 30px)",left:"calc(50% - 30px)",cursor:"pointer",pointerEvents:"all"}),i.setAttribute("fill","none");const a=document.createElementNS("http://www.w3.org/2000/svg","g");a.setAttribute("filter","url(#filter0_b_4190_2652)");const r=y("circle");r.setAttribute("id","circle1"),r.setAttribute("cx","0"),r.setAttribute("cy","0"),!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?r.setAttribute("r","40"):r.setAttribute("r","28.3"),r.setAttribute("fill","black"),r.setAttribute("fill-opacity","0.42");const s=y("circle");s.setAttribute("id","circle2"),s.setAttribute("cx","0"),s.setAttribute("cy","0"),!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?s.setAttribute("r","39.5"):s.setAttribute("r","27.5"),s.setAttribute("stroke","white"),s.setAttribute("stroke-opacity","0.42");const o=y("path");!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?o.setAttribute("d","M8 11.2761C8 8.0368 11.4656 5.97709 14.3109 7.52531L37.7709 20.2903C40.743 21.9075 40.743 26.1745 37.7709 27.7918L14.3109 40.5568C11.4656 42.1049 8 40.0452 8 36.806V11.2761Z"):o.setAttribute("d","M5.6 7.85427C5.6 5.62576 8.02512 4.21299 9.99663 5.26774L26.43963 14.20121C28.1361 15.29325 28.1361 17.64875 26.43963 18.74079L9.99663 27.67426C8.02512 28.72901 5.6 27.31624 5.6 25.08773V7.85427Z"),o.setAttribute("fill","white"),!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?o.setAttribute("transform","translate(-20, -24)"):o.setAttribute("transform","translate(-15, -16.5)"),a.appendChild(r),a.appendChild(s),a.appendChild(o);const l=document.createElementNS("http://www.w3.org/2000/svg","defs"),d=document.createElementNS("http://www.w3.org/2000/svg","filter");d.setAttribute("id","filter0_b_4190_2652"),!0===e.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?(d.setAttribute("x","-48"),d.setAttribute("y","-48"),d.setAttribute("width","96"),d.setAttribute("height","96")):(d.setAttribute("x","-30"),d.setAttribute("y","-30"),d.setAttribute("width","60"),d.setAttribute("height","60")),d.setAttribute("filterUnits","userSpaceOnUse"),d.setAttribute("color-interpolation-filters","sRGB");const h=y("feFlood");h.setAttribute("flood-opacity","0"),h.setAttribute("result","BackgroundImageFix");const c=y("feGaussianBlur");c.setAttribute("in","BackgroundImageFix"),c.setAttribute("stdDeviation","2");const u=y("feComposite");u.setAttribute("in2","SourceAlpha"),u.setAttribute("operator","in"),u.setAttribute("result","effect1_backgroundBlur_4204_2652");const m=y("feBlend");return m.setAttribute("mode","normal"),m.setAttribute("in","SourceGraphic"),m.setAttribute("in2","effect1_backgroundBlur_4204_2652"),m.setAttribute("result","shape"),d.appendChild(h),d.appendChild(c),d.appendChild(u),d.appendChild(m),l.appendChild(d),i.appendChild(a),i.appendChild(l),i}(this.appSettings,e):function(e){const t=y("svg");t.setAttribute("viewBox","-1 -1 2 2"),t.setAttribute("role","button"),t.setAttribute("aria-label",null!=e?e:"Play"),n(t,{height:"56.6px",width:"56.6px",position:"absolute",zIndex:"6",top:"calc(50% - 28.3px)",left:"calc(50% - 28.3px)",cursor:"pointer",pointerEvents:"all"});const i=y("circle");i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","1"),i.setAttribute("fill","#404040");const a=y("path");return a.setAttribute("d","M.5 0 L-.25 -.5 L-.25 .5 Z"),a.setAttribute("fill","none"),a.setAttribute("stroke","white"),a.setAttribute("stroke-width",".05"),a.setAttribute("opacity",".5"),t.appendChild(i),t.appendChild(a),t}(e),t.addEventListener("click",e=>this.playButtonOnClick(e),!1),this.isDesignerElement&&t.setAttribute("visibility","hidden"),(!0===this.appSettings.playButtonHoverOverlayEnabled||p.getBoolean("PlayButtonHoverOverlayEnabled"))&&function(e,t,i){const a=e.querySelector(".overlay");a&&e.removeChild(a),0===e.offsetWidth&&n(e,{width:"100%"}),0===e.offsetHeight&&n(e,{height:"100%"});const r=document.createElement("div");r.className="overlay",r.style.display="none",r.setAttribute("aria-hidden","true");const s=t.querySelector("g");s.addEventListener("mouseover",()=>{const a=t.getElementById("circle1"),s=t.getElementById("circle2");a.style.transition="r 0.2s ease, fill 0.2s ease, opacity 0.2s ease",a.setAttribute("cx","0"),a.setAttribute("cy","0"),!0===i.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?a.setAttribute("r","48"):a.setAttribute("r","30"),a.setAttribute("fill","black"),a.setAttribute("fill-opacity","0.42"),s.style.transition="r 0.2s ease, fill 0.2s ease, opacity 0.2s ease",s.setAttribute("cx","0"),s.setAttribute("cy","0"),!0===i.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?s.setAttribute("r","47.5"):s.setAttribute("r","29.5"),s.setAttribute("stroke","white"),s.setAttribute("stroke-opacity","0.42"),r.style.position="absolute",r.style.width=e.offsetWidth+"px",r.style.height=e.offsetHeight+"px",r.style.backgroundColor="rgba(0, 0, 0, 0.4)",r.style.zIndex="5",r.style.display="block"}),s.addEventListener("mouseleave",()=>{const e=t.getElementById("circle1"),a=t.getElementById("circle2");e.style.transition="r 0.2s ease, fill 0.2s ease, opacity 0.2s ease",e.setAttribute("cx","0"),e.setAttribute("cy","0"),!0===i.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?e.setAttribute("r","40"):e.setAttribute("r","28.3"),e.setAttribute("fill","black"),e.setAttribute("fill-opacity","0.42"),a.style.transition="r 0.2s ease, fill 0.2s ease, opacity 0.2s ease",a.setAttribute("cx","0"),a.setAttribute("cy","0"),!0===i.playButtonIconUpdateEnabled||p.getBoolean("PlayButtonIconUpdateEnabled")?a.setAttribute("r","39.5"):a.setAttribute("r","27.5"),a.setAttribute("stroke","white"),a.setAttribute("stroke-opacity","0.42"),r.style.display="none"}),e.appendChild(r)}(this.parent,t,this.appSettings),this.parent.appendChild(t),t}}class L{constructor(e,t,i,a){var r,s;this.url=e,this.iFrame=document.createElement("iframe"),this.perfTracker=i,this.playbackTracker=a,this.iFrame.src=e,this.iFrame.setAttribute("frameBorder","0"),this.iFrame.setAttribute("allow","autoplay"),l(this.iFrame),null===(r=this.perfTracker)||void 0===r||r.onInit(),null===(s=this.playbackTracker)||void 0===s||s.onSourceSet(),this.iFrame.addEventListener("load",()=>{null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}),t.appendChild(this.iFrame)}play(){""===this.iFrame.src&&(this.iFrame.src=this.url),this.setFocus()}pause(){}stop(){this.iFrame.src=""}togglePause(){}setVisible(){this.iFrame.style.visibility="visible"}setHidden(){this.iFrame.style.visibility="hidden"}getPlayer(){return this.iFrame}getCurrentTime(){}getDuration(){}getPerfData(){return void 0!==this.perfTracker?this.perfTracker.getPerfData():void 0}getPlaybackData(){return void 0!==this.playbackTracker?this.playbackTracker.getPlaybackData():void 0}seekTo(e){}ensureMediaClient(){var e,t,i,a;null===(e=this.perfTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.cleanup(),null===(i=this.perfTracker)||void 0===i||i.onInit(),null===(a=this.playbackTracker)||void 0===a||a.onSourceSet()}cleanUpMediaClient(){var e,t;null===(e=this.perfTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.cleanup()}setFocus(){null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}}class N{constructor(e,t,i,a,r,s){this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.onMessage=e=>{e.origin===this.url.origin&&void 0!==this.flipIFrame&&this.flipIFrame.contentWindow===e.source&&(this.handlePlayerEvent(e),void 0!==this.perfTracker&&this.capturePlayerPerf(e),void 0!==this.playbackTracker&&this.capturePlaybackTelemetry(e))},this.url=new URL(e),this.parent=t,this.perfTracker=i,this.playbackTracker=a,this.onReadyCallback=r,this.onMediaEventCallback=s,this.url.searchParams.set("options","messaging");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Flip video client: "+e.message,!0)}}play(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-play",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}pause(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-pause",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}stop(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-stop",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}togglePause(){this.paused?this.play():this.pause()}setVisible(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="visible")}setHidden(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="hidden")}getPlayer(){return this.flipIFrame}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}seekTo(e){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const t=this.getMessage("fg-wvp-seek",{time:e});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}isPaused(){return this.paused}cleanUpMediaClient(){void 0!==this.flipIFrame&&this.flipIFrame.remove(),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.flipIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.flipIFrame=document.createElement("iframe"),this.flipIFrame.src=this.url.toString(),this.setProperties(this.flipIFrame),this.parent.append(this.flipIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),l(e),e.style.border="0px",this.setVisible())}handlePlayerEvent(e){switch(e.data.name){case"fg-wvp-onReady":case"fg-wvp-onInitialReady":if(this.isFirstReady){if(this.isFirstReady=!1,void 0===this.duration&&void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-getDuration",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}void 0!==this.onReadyCallback&&this.onReadyCallback()}break;case"fg-wvp-onPlay":this.paused=!1,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1);break;case"fg-wvp-onPause":this.paused=!0,(void 0===this.duration||this.currentTime<this.duration)&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0);break;case"fg-wvp-onSeek":void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"fg-wvp-onTimeUpdate":this.currentTime=e.data.data.currentTime;break;case"fg-wvp-onBuffering":break;case"fg-wvp-onEnded":this.paused=!0,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6);break;case"fg-wvp-onError":a.error(508895832,"Flipgrid player entered error state "+e.data.data.error);break;case"fg-wvp-getDurationResult":this.duration=e.data.data.duration;break;case"fg-wvp-getCurrentTimeResult":this.currentTime=e.data.data.currentTime}}capturePlayerPerf(e){const t=e.data.name;if(void 0!==this.perfTracker)switch(t){case"fg-wvp-onReady":this.perfTracker.onReady(),void 0!==this.duration&&this.perfTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.perfTracker.onPlaying();break;case"fg-wvp-onPause":this.perfTracker.onPause();break;case"fg-wvp-onSeek":this.perfTracker.onSeeked();break;case"fg-wvp-onEnded":this.perfTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.perfTracker.onError(t,!0)}}capturePlaybackTelemetry(e){const t=e.data.name;if(void 0!==this.playbackTracker)switch(t){case"fg-wvp-onReady":this.playbackTracker.onCanPlay(),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.playbackTracker.onPlaying();break;case"fg-wvp-onPause":this.playbackTracker.onPause();break;case"fg-wvp-onSeek":break;case"fg-wvp-onEnded":this.playbackTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.playbackTracker.onError(t,!0)}}getMessage(e,t){return{name:e,data:t}}}class x{constructor(e,t,i,r,s,o,n,l){this.paused=!0,this.currentTime=0,this.streamAuthFailed=!1,this.onMessage=e=>{var t,i,r,s,o,n;if(this.url.origin===e.origin&&void 0!==this.streamIFrame&&this.streamIFrame.contentWindow===e.source)switch(e.data.name){case"initializestreamconnection":a.info(508895829,"StreamAuth: Received handshake request");let l=!1;if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;if(null!==t){const i=e.data;i.result=!0,t.postMessage(i,e.origin),l=!0}}l||a.info(508895828,"StreamAuth: Received handshake request, but unable to reply");break;case"getstreamtoken":this.handleTokenRequest(e);break;case"signinevent":if(!this.streamAuthFailed){"signinfailed"===(null===(t=e.data.eventData)||void 0===t?void 0:t.eventname)&&(null===(i=this.perfTracker)||void 0===i||i.onError("Authentication Error - User failed to authenticate",!0),null===(r=this.playbackTracker)||void 0===r||r.onError("Authentication Error - User failed to authenticate",!0),this.streamAuthFailed=!0)}break;case"loaddata":const d=null===(s=e.data.eventData)||void 0===s?void 0:s.responsecode;"200"!==d&&(null===(o=this.perfTracker)||void 0===o||o.onError("Load Error - Video responded with status code "+d,!0),null===(n=this.playbackTracker)||void 0===n||n.onError("Load Error - Video responded with status code "+d,!0));break;case"playerevent":this.handlePlayerEvent(e),this.trackPlayerPerf(e),this.trackPlaybackTelemetry(e)}},this.url=new URL(e),this.parent=t,this.perfTracker=r,this.playbackTracker=s,this.onReadyCallback=o,this.onMediaEventCallback=n,this.onTokenRequestCallback=l,void 0!==i.App&&this.url.searchParams.set("app",i.App),void 0!==i.AppPlatform&&this.url.searchParams.set("appPlatform",i.AppPlatform),void 0!==i.AppCorrelation&&this.url.searchParams.set("appCorrelation",i.AppCorrelation),this.url.searchParams.set("thinEmbed","true");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream Classic video client: "+e.message,!0)}}play(){const e=this.getMessage("playerfunction","play");this.sendMessage(e)}pause(){const e=this.getMessage("playerfunction","pause");this.sendMessage(e)}stop(){this.pause(),this.seekTo(0)}togglePause(){this.paused?this.play():this.pause()}getPlayer(){return this.streamIFrame}isPaused(){return this.paused}getCurrentTime(){return this.currentTime}getDuration(){}seekTo(e){const t=this.getMessage("playerfunction","setplaytime",e.toString());this.sendMessage(t)}setVisible(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="visible")}setHidden(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="hidden")}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.streamIFrame&&this.streamIFrame.remove(),this.paused=!0,this.currentTime=0,this.streamIFrame=void 0,this.streamAuthFailed=!1,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}postAuthToken(e){if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;null!==t&&void 0!==this.streamAuthContext?(void 0===this.streamAuthContext.messageObj.eventData&&(this.streamAuthContext.messageObj.eventData={}),this.streamAuthContext.messageObj.eventData.token=e,this.streamAuthContext.messageObj.result=!0,t.postMessage(this.streamAuthContext.messageObj,this.streamAuthContext.origin),a.info(508895831,"StreamAuth: Posted Aad Token back to Stream Player")):a.error(508895830,"StreamAuth: Got a Stream iframe but unable to get ContentWindow or cached Context")}}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.streamIFrame=document.createElement("iframe"),this.streamIFrame.src=this.url.toString(),this.setProperties(this.streamIFrame),this.parent.append(this.streamIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),l(e),e.style.border="0px",this.setVisible())}handleTokenRequest(e){var t,i,r;if(this.streamAuthFailed)return;if(void 0===this.onTokenRequestCallback)return this.streamAuthFailed=!0,null===(t=this.perfTracker)||void 0===t||t.onError("Authentication Error - onTokenRequestCallback is undefined",!0),void(null===(i=this.playbackTracker)||void 0===i||i.onError("Authentication Error - onTokenRequestCallback is undefined",!0));a.info(508895827,"StreamAuth: Requesting AAD token from Host");const s=e.data,o=e.origin;this.streamAuthContext={messageObj:s,origin:o},this.onTokenRequestCallback(null===(r=s.eventData)||void 0===r?void 0:r.resourceId)}handlePlayerEvent(e){var t,i,r,s;const o=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname;if(void 0!==this.onMediaEventCallback){switch(o){case"play":this.onMediaEventCallback(1);break;case"playing":this.paused=!1,this.onMediaEventCallback(1);break;case"pause":this.paused=!0,this.onMediaEventCallback(0);break;case"ready":void 0!==this.onReadyCallback&&this.onReadyCallback();break;case"timeupdate":{const t=this.currentTime;this.currentTime=null===(i=e.data.eventData)||void 0===i?void 0:i.time,void 0!==this.currentTime&&Math.abs(this.currentTime-t)>=1&&this.onMediaEventCallback(3);break}case"error":a.error(538039177,`Stream media error: ${null===(r=e.data.eventData)||void 0===r?void 0:r.errorcode}, message: ${null===(s=e.data.eventData)||void 0===s?void 0:s.message}`)}a.info(508895824,"Stream Media Event: "+o)}}trackPlayerPerf(e){var t,i;if(void 0!==this.perfTracker){const a=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,r=null===(i=e.data.eventData)||void 0===i?void 0:i.message;switch(a){case"play":this.perfTracker.onPlay();break;case"playing":this.perfTracker.onPlaying();break;case"pause":this.perfTracker.onPause();break;case"ready":this.perfTracker.onReady();break;case"error":void 0!==r&&this.perfTracker.onError(r,!0)}}}trackPlaybackTelemetry(e){var t,i;if(void 0!==this.playbackTracker){const a=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,r=null===(i=e.data.eventData)||void 0===i?void 0:i.message;switch(a){case"play":this.playbackTracker.onPlay();break;case"playing":this.playbackTracker.onPlaying();break;case"pause":this.playbackTracker.onPause();break;case"ready":this.playbackTracker.onCanPlay();break;case"error":void 0!==r&&this.playbackTracker.onError(r,!0)}}}getMessage(e,t,i){return void 0!==i?{name:e,methodData:{methodname:t,data:i},eventData:{}}:{name:e,methodData:{methodname:t},eventData:{}}}sendMessage(e){void 0!==this.streamIFrame&&null!==this.streamIFrame.contentWindow&&(a.info(528623694,`sendMessage: Calling postMessage with: msg = ${JSON.stringify(e)}, target = ${this.streamIFrame.src}`),this.streamIFrame.contentWindow.postMessage(e,this.streamIFrame.src))}}class B{constructor(e,t){this._name=e,this._guid=t}get name(){return this._name}get guid(){return this._guid}}B.graph=new B("Graph","00000003-0000-0000-c000-000000000000"),B.hubble=new B("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d"),B.all=[B.graph,B.hubble];class U{constructor(){this.cache=new Map,this.timeValid=33e5}get timeout(){return this.timeValid}updateSettings(e){void 0!==e.TokenCacheTimeout?this.timeValid=e.TokenCacheTimeout:this.timeValid=33e5}update(e,t){0!==t.length?this.cache.set(e,[Date.now(),t]):a.error(509167387,"Error: Empty token")}find(e){if(!this.cache.has(e))return;const[t,i]=this.cache.get(e);return Date.now()>t+this.timeValid?void 0:i}}class q{constructor(){this.clients=new Map}add(e,t){const i=this.clients.get(e);void 0!==i?i.has(t)?a.error(509171084,"Error: Client already exists"):i.add(t):this.clients.set(e,new Set([t]))}has(e,t){const i=this.clients.get(e);return void 0!==i&&i.has(t)}remove(e,t){const i=this.clients.get(e);return void 0===i?(a.error(509171083,"Error: AppId does not exist"),!1):i.delete(t)?0===i.size:(a.error(509171082,"Error: Client does not exist"),!1)}getClients(e){const t=this.clients.get(e);if(void 0===t)return a.error(509171081,"Error: AppId does not exist"),[];if(0===t.size)return a.error(509171080,"Error: Clients do not exist"),[];const i=Array.from(t);return t.clear(),i}getPendingAppId(){for(const[e,t]of this.clients)if(0!==t.size)return e}}class H{constructor(){this.waitBeforeRetry=3e3,this.maxRetries=3,this.startTime=0,this.retries=0}get timeout(){return this.waitBeforeRetry}get maxRetryCount(){return this.maxRetries}get elapsedTime(){return Date.now()-this.startTime}get numberOfRetries(){return this.retries}get willRetry(){return this.numberOfRetries<=this.maxRetryCount}get currentAppId(){return this.appId}get isPending(){return void 0!==this.tokenRequestTimeout}updateSettings(e,t){void 0!==e.MaxAADTokenWaitingTime?this.waitBeforeRetry=e.MaxAADTokenWaitingTime:this.waitBeforeRetry=3e3,void 0!==e.MaxAADTokenRequestRetries?this.maxRetries=e.MaxAADTokenRequestRetries:this.maxRetries=3,void 0!==t?this.tokenRequestCallback=t:a.error(509166869,"Error: No token request callback")}start(e){void 0!==this.tokenRequestCallback?void 0===this.currentAppId?this.isPending?a.error(509171090,"Error: Request is already pending"):(this.startTime=Date.now(),this.retries=0,this.appId=e,this.tryRequest()):a.error(509166861,"Error: AppId already set"):a.error(509166818,"Error: No token request callback")}completeOrCancel(e){if(void 0===this.currentAppId)return void a.error(509166860,"Error: AppId is not set");if(!this.isPending)return void a.error(509171089,"Error: Request is not pending");clearTimeout(this.tokenRequestTimeout),this.tokenRequestTimeout=void 0;const t={tokenLength:e,isCompleted:void 0!==e,tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};a.info(509194645,JSON.stringify(t)),this.appId=void 0}tryRequest(){if(void 0===this.tokenRequestCallback)return void a.error(509171088,"Error: No token request callback");if(void 0===this.currentAppId)return void a.error(509171087,"Error: AppId is not set");if(this.isPending)return void a.error(509171086,"Error: Request is already pending");if(!this.willRetry)return void a.error(508700001,"Error: Request will not be retried");const e={tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};a.info(509166817,JSON.stringify(e)),this.tokenRequestTimeout=window.setTimeout(()=>{this.tokenRequestTimeout=void 0,this.retries+=1,this.tryRequest()},this.timeout),this.tokenRequestCallback(this.currentAppId.guid)}}class _{constructor(e,t,i,r,s,o,n,l){this.paused=!0,this.currentTime=0,this.oEmbedRequestRetried=!1,this.navigatedToEmbedUrl=!1,this.initPostMessageCommunication=e=>{var t,i,r,s;const o=(null===(t=this.embedURL)||void 0===t?void 0:t.origin)===e.origin,n=this.channelId===e.data.channelId;if(o&&n&&"initialize"===e.data.type)try{e.data.replyTo.onmessage=e=>this.onMessage(e),e.data.replyTo.postMessage({type:"activate"}),this.messagePort=e.data.replyTo,null===(r=this.playerPerf)||void 0===r||r.onPostMessagingInitialized(),null===(s=this.playbackTracker)||void 0===s||s.onPostMessagingInitialized()}catch(e){void 0!==this.playerPerf&&this.playerPerf.onError(`Post Messaging Error - Error initializing communication channel (${e.message})`,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Post Messaging Error - Error initializing communication channel (${e.message})`,!0)}else a.warn(508371414,"Message failed source verification: "+JSON.stringify({isOriginMatching:o,isChannelMatching:n,messageType:e.data.type,correlationId:null===(i=this.playerPerf)||void 0===i?void 0:i.getCorrelationId()}))},this.videoUrl=e,this.appSettings=i,this.parentElement=t,this.playerPerf=r,this.playbackTracker=s,this.onReadyCallback=o,this.onMediaEventCallback=n,_.tokenRequestor.updateSettings(i,l);try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream 2.0 video client: "+e.message,!0)}}static setAADTokenForWaitingClients(e){_.tokenRequestor.setAADToken(e)}play(){this.postMessage({command:"one-player-play"})}pause(){this.postMessage({command:"one-player-pause"})}stop(){this.postMessage({command:"one-player-stop"})}seekTo(e){this.postMessage({command:"one-player-seek",position:e})}togglePause(){this.paused?this.play():this.pause()}setMute(){!0!==this.muted&&this.postMessage({command:"one-player-mute"})}setUnMute(){!1!==this.muted&&this.postMessage({command:"one-player-unmute"})}setVolume(e){const t=Math.min(Math.max(e,0),1);this.postMessage({command:"one-player-set-volume",volumeLevel:t})}getVolume(){return this.volume}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){_.tokenRequestor.cancelAllIfPending(this),void 0!==this.oEmbedRequestRetryTimeout&&window.clearTimeout(this.oEmbedRequestRetryTimeout),void 0!==this.stream2iFrame&&this.stream2iFrame.remove(),void 0!==this.errorMessageDiv&&this.errorMessageDiv.remove(),this.paused=!0,this.currentTime=0,this.muted=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.messagePort=void 0,this.stream2iFrame=void 0,this.oEmbedResponseTimeStamp=void 0,this.oEmbedRequestRetried=!1,this.oEmbedRequestRetryTimeout=void 0,this.channelId=void 0,this.navigatedToEmbedUrl=!1,this.embedURL=void 0,this.errorMessageDiv=void 0,window.removeEventListener("message",this.initPostMessageCommunication),void 0!==this.playerPerf&&this.playerPerf.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}isPaused(){return this.paused}isMuted(){return this.muted}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}setVisible(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="visible"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="visible")}setHidden(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="hidden"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="hidden")}getPlayer(){return this.stream2iFrame}getPerfData(){if(void 0!==this.playerPerf)return this.playerPerf.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}onTokenSet(e,t){switch(e){case B.hubble:this.onHubbleTokenSet(t);break;default:a.error(509194507,"Unknown appId: "+e.name)}}showErrorMessage(e){this.errorMessageDiv=document.createElement("div"),this.errorMessageDiv.style.backgroundColor="black",this.errorMessageDiv.style.justifyContent="center",this.errorMessageDiv.style.alignItems="center",this.errorMessageDiv.style.color="white",this.errorMessageDiv.style.fontSize="10",this.errorMessageDiv.style.borderRadius="5",this.errorMessageDiv.style.display="flex",this.errorMessageDiv.style.textAlign="center",this.errorMessageDiv.textContent=e,l(this.errorMessageDiv),this.parentElement.append(this.errorMessageDiv)}onHubbleTokenSet(e){var t,i;null===(t=this.playerPerf)||void 0===t||t.onHubbleTokenSet(),null===(i=this.playbackTracker)||void 0===i||i.onHubbleTokenSet(),this.initOnePlayer(e)}postMessage(e){var t;null===(t=this.messagePort)||void 0===t||t.postMessage({type:"command",id:0,data:e})}onMessage(e){const t=e.data.type;"notification"===t?this.handleNotificationMessage(e.data):"result"===t?this.handleResultMessage(e.data):"command"===t?this.handleCommandMessage(e.data):"acknowledge"===t||a.warn(509219079,`Received unrecognized postmessage (type: ${t})`)}handleCommandMessage(e){if("getToken"===e.data.command){a.warn(508924038,`Received unexpected getToken request from OnePlayer (type: ${e.data.tokenType})`);const t={type:"result",id:e.id,data:{result:"error",isExpected:!0,error:{code:"",message:"Token request not supported"}}};void 0!==this.messagePort&&this.messagePort.postMessage(t)}}handleResultMessage(e){if("error"!==e.data.result)void 0!==e.data.durationInSeconds?(this.duration=e.data.durationInSeconds,void 0!==this.playerPerf&&this.playerPerf.setDuration(this.duration),void 0!==this.playbackTracker&&this.playbackTracker.setDuration(this.duration)):void 0!==e.data.volume?(this.volume=e.data.volume,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playerPerf&&this.playerPerf.setVolume(this.volume),void 0!==this.playbackTracker&&this.playbackTracker.setVolume(this.volume)):void 0!==e.data.isMute?(this.muted=e.data.isMute,void 0!==this.playerPerf&&this.playerPerf.setMute(this.muted),void 0!==this.playbackTracker&&this.playbackTracker.setIsMuted(this.muted)):a.warn(509215635,`Unrecognized result type received (type: ${e.data.result})`);else{const t=e.data;a.error(509437569,`OnePlayer Error - Result: ${t.error.code} (${t.error.message})`)}}handleNotificationMessage(e){var t,i;switch(e.data.notification){case"one-player-player-ready":e.data.isReady&&this.onReady(e.data.ttlMs);break;case"one-player-play-state":const r=e.data.playState;this.onPlayStateChanged(r);break;case"one-player-current-time":const s=this.currentTime;this.currentTime=e.data.currentTime,Math.abs(this.currentTime-s)>2&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3),void 0!==this.playerPerf&&this.playerPerf.onSeeked());break;case"one-player-muted":if(this.muted=e.data.isMuted,!this.muted){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.022))}void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onMuteChanged(this.muted),void 0!==this.playbackTracker&&this.playbackTracker.onMuteChanged(this.muted);break;case"one-player-volume":this.volume=e.data.volume,0===this.volume?this.setMute():this.lastNonZeroVolume=this.volume,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onVolumeChanged(this.volume),void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume);break;case"error":case"one-player-fatal-playback-error":null===(t=this.playerPerf)||void 0===t||t.onError("OnePlayer Error - Notification: "+JSON.stringify(e.data),!0),null===(i=this.playbackTracker)||void 0===i||i.onError("OnePlayer Error - Notification: "+JSON.stringify(e.data),!0);break;default:a.warn(509437568,`Unrecognized notification type received (type: ${e.data.notification})`)}}onReady(e){this.postMessage({command:"one-player-get-duration"}),this.postMessage({command:"one-player-get-volume"}),this.postMessage({command:"one-player-get-mute"}),void 0!==this.playerPerf&&void 0!==e&&this.playerPerf.onODSPVideoLoad(e),void 0!==this.playbackTracker&&void 0!==e&&this.playbackTracker.onODSPVideoLoad(e),void 0!==this.playerPerf&&this.playerPerf.onReady(),void 0!==this.playbackTracker&&this.playbackTracker.onCanPlay(),void 0!==this.onReadyCallback&&this.onReadyCallback()}onPlayStateChanged(e){this.paused="Playing"!==e,"Playing"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1),void 0!==this.playerPerf&&this.playerPerf.onPlaying(),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()):"Paused"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0),void 0!==this.playerPerf&&this.playerPerf.onPause(),void 0!==this.playbackTracker&&this.playbackTracker.onPause()):"Ended"===e&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6),void 0!==this.playerPerf&&this.playerPerf.onEnded(),void 0!==this.playbackTracker&&this.playbackTracker.onEnded())}init(){var e,t;this.stream2iFrame=document.createElement("iframe"),this.setProperties(this.stream2iFrame),null===(e=this.playerPerf)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),_.tokenRequestor.request(B.hubble,this)}initOnePlayer(e){this.initOEmbedIFrame(e).then(()=>{void 0!==this.messagePort&&a.info(508432459,"Cross-window communication channel is already initialized")}).catch(e=>{void 0!==this.playerPerf&&this.playerPerf.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e.message})`),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e.message})`)})}initOEmbedIFrame(e){var t,i,a,o;return r(this,void 0,void 0,(function*(){let n;try{n=yield function(e,t){return r(this,void 0,void 0,(function*(){const i=f(t,"/mediasvc/api/media/oembed"),a=g(t);i.searchParams.set("url",e);const r=yield fetch(i.toString(),{method:"GET",headers:a}),s=yield r.json();if(!r.ok){let e="status: "+r.status;throw void 0!==s.Error&&void 0!==s.Error.Message&&(e+=", message: "+s.Error.Message),new v(r.status,e)}return s}))}(this.videoUrl,{aadToken:e,apiBaseUrl:this.appSettings.HubbleVideoEndpoint,app:this.appSettings.App,appPlatform:this.appSettings.AppPlatform,correlationId:void 0!==this.playerPerf?this.playerPerf.getCorrelationId():this.appSettings.AppCorrelation,acceptLanguage:this.appSettings.AcceptLanguage})}catch(r){if(p.getBoolean("retryOEmbedRequestIf429")&&!this.oEmbedRequestRetried){const a=r.message;if(a.indexOf("status: 429")>-1){const r=a.match(/Retry-After:\s*(\d+)/),s=null!==r&&2===r.length?parseFloat(r[1]):void 0;let o=11.5;if(void 0!==p.getNumber("retryOEmbedRequestIf429Threshold")&&(o=p.getNumber("retryOEmbedRequestIf429Threshold")),void 0!==s&&s<=o)return this.oEmbedRequestRetried=!0,this.oEmbedRequestRetryTimeout=window.setTimeout(()=>this.initOnePlayer(e),1e3*s),null===(t=this.playerPerf)||void 0===t||t.onError(`OEmbed Request Error - status: 429 (will retry request in ${s}s)`),void(null===(i=this.playbackTracker)||void 0===i||i.onError(`OEmbed Request Error - status: 429 (will retry request in ${s}s)`))}}let n=s;return void 0!==this.appSettings.LocalizedHubble404ErrorMessage&&(n=this.appSettings.LocalizedHubble404ErrorMessage),r instanceof v&&(n=this.getErrorMessage(r.statusCode)),this.showErrorMessage(n),null===(a=this.playerPerf)||void 0===a||a.onError("OEmbed Request Error - "+r.message,!0),void(null===(o=this.playbackTracker)||void 0===o||o.onError("OEmbed Request Error - "+r.message,!0))}void 0!==this.playerPerf&&this.playerPerf.onOEmbedResponse(),void 0!==this.playbackTracker&&this.playbackTracker.onOEmbedResponse(),this.setOEmbedURL(n)}))}setOEmbedURL(e){if(void 0===e.embed_url)return void 0!==this.playerPerf&&this.playerPerf.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void 0!==this.playbackTracker&&this.playbackTracker.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void this.showErrorMessage(s);this.oEmbedResponseTimeStamp=Date.now(),this.embedURL=new URL(e.embed_url);const t=this.embedURL.searchParams.get("access_token");if(void 0!==this.stream2iFrame&&null!==t){this.embedURL.searchParams.delete("access_token"),this.embedURL.searchParams.set("auth","readwrite");const e="PowerPointLive"===this.appSettings.hostView;e&&this.embedURL.searchParams.set("forceMeta","1"),this.channelId=M(),this.embedURL.searchParams.set("origin",new URL(location.href).origin),this.embedURL.searchParams.set("channelId",this.channelId),this.embedURL.searchParams.set("embed",JSON.stringify({hp:"Web",hv:this.appSettings.hostView,hc:this.appSettings.hostComponent,ha:this.appSettings.App,hsi:void 0!==this.playerPerf?this.playerPerf.getCorrelationId():this.appSettings.AppCorrelation,af:!1,disableHybrid:e,ol:this.appSettings.AcceptLanguage}));const i=new URL(this.videoUrl).searchParams.get("nav");null!==i&&this.embedURL.searchParams.set("nav",i),this.stream2iFrame.setAttribute("allow","autoplay "+this.embedURL.origin),this.stream2iFrame.addEventListener("load",()=>this.onStream2iFrameLoad(t)),this.parentElement.append(this.stream2iFrame)}}onStream2iFrameLoad(e){var t,i,a;if(p.getBoolean("navigateToEmbedIfIFrameIsBlank")){if(!this.stream2iFrame||"about:blank"!==(null===(t=this.stream2iFrame.contentDocument)||void 0===t?void 0:t.location.href))return}else if(this.navigatedToEmbedUrl)return;void 0===this.oEmbedResponseTimeStamp||Date.now()-this.oEmbedResponseTimeStamp>=24e4?this.ensureMediaClient():void 0!==this.embedURL&&void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&(window.addEventListener("message",this.initPostMessageCommunication),this.navigateToEmbedUrl(this.stream2iFrame.contentWindow,this.embedURL,e),this.navigatedToEmbedUrl=!0,null===(i=this.playerPerf)||void 0===i||i.onNavigatedToEmbedPage(),null===(a=this.playbackTracker)||void 0===a||a.onNavigatedToEmbedPage())}getErrorMessage(e){return 400===e?void 0!==this.appSettings.LocalizedHubble400ErrorMessage?this.appSettings.LocalizedHubble400ErrorMessage:"Inserted URL is not from a currently supported video provider":404===e?void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:s:403===e?void 0!==this.appSettings.LocalizedHubble403ErrorMessage?this.appSettings.LocalizedHubble403ErrorMessage:"This video could not be played because it either was not found or you do not have access to it.":500===e||503===e||429===e?void 0!==this.appSettings.LocalizedHubble500ErrorMessage?this.appSettings.LocalizedHubble500ErrorMessage:"The online video service failed, please try again":void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:s}navigateToEmbedUrl(e,t,i){const a=e.document.createElement("form");a.setAttribute("action",t.toString()),a.setAttribute("method","POST");const r=e.document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","access_token"),r.setAttribute("value",i),a.appendChild(r),e.document.body.appendChild(a),a.submit()}setProperties(e){e.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms allow-top-navigation-by-user-activation allow-downloads"),l(e),e.style.border="0px",this.setVisible()}}_.tokenRequestor=new class{constructor(){this.cache=new U,this.clients=new q,this.requestWithRetry=new H}updateSettings(e,t){this.cache.updateSettings(e),this.requestWithRetry.updateSettings(e,t)}request(e,t){const i=this.cache.find(e);void 0===i?(this.clients.add(e,t),this.requestWithRetry.isPending||this.requestWithRetry.start(e)):t.onTokenSet(e,i)}cancelAllIfPending(e){for(const t of B.all)this.cancelIfPending(t,e);this.requestWithRetry.isPending||this.startPendingRequest()}setAADToken(e){const t=this.requestWithRetry.currentAppId;if(void 0===t)return void a.error(509166815,"Error: AppId is not set");if(0===e.length)return void a.error(509171016,"Error: Got empty token");this.cache.update(t,e),this.requestWithRetry.completeOrCancel(e.length);const i=this.clients.getClients(t);for(const a of i)a.onTokenSet(t,e);this.startPendingRequest()}startPendingRequest(){const e=this.clients.getPendingAppId();void 0!==e&&this.requestWithRetry.start(e)}cancelIfPending(e,t){this.clients.has(e,t)&&this.clients.remove(e,t)&&e===this.requestWithRetry.currentAppId&&this.requestWithRetry.completeOrCancel(void 0)}};var z=i(2);class W{constructor(e,t,i,a,r,s){this.url=e,this.parent=t,this.perfTracker=i,this.playbackTracker=a,this.onReadyCallback=r,this.onMediaEventCallback=s;try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Vimeo video client: "+e.message,!0)}}play(){void 0!==this.player&&this.player.play().catch(e=>{a.error(508572036,`Vimeo error while playing video (error: ${e.message})`)})}pause(){void 0!==this.player&&this.player.pause().catch(e=>{a.error(508572035,`Vimeo error while pausing video (error: ${e.message})`)})}stop(){void 0!==this.player&&(this.pause(),this.seekTo(0))}togglePause(){void 0!==this.player&&void 0!==this.paused&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="visible"),void 0!==this.backDrop&&(this.backDrop.style.visibility="visible")}setHidden(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="hidden"),void 0!==this.backDrop&&(this.backDrop.style.visibility="hidden")}getPlayer(){return this.vimeoIframe}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}isPaused(){return this.paused}seekTo(e){void 0!==this.player&&this.player.setCurrentTime(e).catch(e=>{a.error(508572034,`Vimeo error while setting current time (error: ${e.message})`)})}setVolume(e){void 0!==this.player&&this.player.setVolume(e).catch(e=>{a.error(508572033,`Vimeo error while setting video volume (error: ${e.message})`)})}setMute(){void 0!==this.player&&this.player.setMuted(!0).catch(e=>{a.error(508572032,`Vimeo error while setting muted true (error: ${e.message})`)})}setUnMute(){if(void 0!==this.player){if(0===this.volume){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.25))}this.player.setMuted(!1).catch(e=>{a.error(508572003,`Vimeo error while setting muted false (error: ${e.message})`)})}}getVolume(){return this.volume}isMuted(){return this.muted}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.vimeoIframe&&this.vimeoIframe.remove(),void 0!==this.backDrop&&this.backDrop.remove(),this.paused=void 0,this.player=void 0,this.currentTime=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.muted=void 0,this.vimeoIframe=void 0,this.backDrop=void 0,void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.backDrop=document.createElement("div"),this.backDrop.style.backgroundColor="black",this.setProperties(this.backDrop),this.parent.append(this.backDrop),this.vimeoIframe=document.createElement("iframe"),this.vimeoIframe.src=this.url,this.vimeoIframe.setAttribute("allow","autoplay"),this.setProperties(this.vimeoIframe),this.parent.append(this.vimeoIframe),this.player=new z.a(this.vimeoIframe,{controls:!0,responsive:!1}),this.player.ready().then(()=>r(this,void 0,void 0,(function*(){if(void 0!==this.player){this.registerOnStateChange();try{this.paused=yield this.player.getPaused(),this.currentTime=yield this.player.getCurrentTime(),this.duration=yield this.player.getDuration(),this.volume=yield this.player.getVolume(),this.muted=yield this.player.getMuted()}catch(e){a.error(509354830,`Vimeo error while getting video info on player ready (error: ${e.message})`)}this.paused=!0,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.perfTracker&&(this.perfTracker.onReady(),void 0!==this.volume&&this.perfTracker.setVolume(this.volume),void 0!==this.muted&&this.perfTracker.setMute(this.muted),void 0!==this.duration&&this.perfTracker.setDuration(this.duration)),void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),void 0!==this.volume&&this.playbackTracker.setVolume(this.volume),void 0!==this.muted&&this.playbackTracker.setIsMuted(this.muted),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration)),void 0!==this.onReadyCallback&&this.onReadyCallback(),void 0!==this.player.setAutopause&&this.player.setAutopause(!1).catch(e=>{a.error(508572002,`Vimeo error while setting video autopause (error: ${e.message})`)})}}))).catch(e=>{void 0!==this.perfTracker&&this.perfTracker.onError(`Error loading Vimeo player (error: ${e.message})`,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Error loading Vimeo player (error: ${e.message})`,!0)})}registerOnStateChange(){void 0!==this.player&&(this.player.on("play",e=>{this.paused=!1,this.onStateChange(1,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPlay(),void 0!==this.playbackTracker&&this.playbackTracker.onPlay()}),this.player.on("pause",e=>{this.paused=!0,Math.abs(e.seconds-e.duration)>.1&&this.onStateChange(0,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPause(),void 0!==this.playbackTracker&&this.playbackTracker.onPause()}),this.player.on("seeked",e=>{this.onStateChange(3,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onSeeked()}),this.player.on("volumechange",e=>r(this,void 0,void 0,(function*(){const t=this.volume,i=this.muted;this.volume=e.volume,void 0!==this.player&&(this.muted=yield this.player.getMuted()),0!==this.volume&&(this.lastNonZeroVolume=this.volume);const a=t!==this.volume,r=i!==this.muted;(a||r)&&this.onStateChange(4),a&&void 0!==this.perfTracker&&this.perfTracker.onVolumeChanged(this.volume),a&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),r&&void 0!==this.perfTracker&&void 0!==this.muted&&this.perfTracker.onMuteChanged(this.muted),r&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted)}))),this.player.on("playing",()=>{void 0!==this.perfTracker&&this.perfTracker.onPlaying(),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()}),this.player.on("seeking",()=>{void 0!==this.perfTracker&&this.perfTracker.onSeeking()}),this.player.on("ended",e=>{this.paused=!0,this.onStateChange(6,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onEnded(),void 0!==this.playbackTracker&&this.playbackTracker.onEnded()}),this.player.on("error",e=>{if(void 0!==this.perfTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.perfTracker.onError(t)}if(void 0!==this.playbackTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.playbackTracker.onError(t)}}),this.player.on("timeupdate",e=>{this.currentTime=e.seconds}))}onStateChange(e,t){void 0!==t&&(this.currentTime=t),void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){null!==e&&(l(e),e.style.border="0px",this.setVisible())}}function j(){return!!document.head.querySelector('script[src="https://www.youtube.com/iframe_api"]')}function Y(){const e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src="https://www.youtube.com/iframe_api",document.head.appendChild(e)}class ${constructor(e,t,i,a,r,s,o,n){this.paused=!0,this.url=new URL(e),this.parent=t,this.perfTracker=i,this.playbackTracker=a,this.mediaSizeInfo=r,this.onReadyCallback=s,this.onMediaEventCallback=o,this.appSettings=null!=n?n:{};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating YouTube video client: "+e.message,!0)}}play(){void 0!==this.player&&void 0!==this.player.playVideo&&this.player.playVideo()}getVolume(){if(void 0!==this.player&&void 0!==this.player.getVolume)return this.player.getVolume()}pause(){void 0!==this.player&&void 0!==this.player.pauseVideo&&this.player.pauseVideo()}getPlayer(){return this.youTubeIFrame}stop(){void 0!==this.player&&void 0!==this.player.stopVideo&&this.player.stopVideo()}togglePause(){void 0!==this.player&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="visible")}setHidden(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="hidden")}getCurrentTime(){if(void 0!==this.player&&void 0!==this.player.getCurrentTime)return this.player.getCurrentTime();a.warn(508895497,"Attempted to getCurrentTime www.youtube.com but undefined player")}getDuration(){if(void 0!==this.player&&void 0!==this.player.getDuration)return this.player.getDuration()}seekTo(e){void 0!==this.player?this.shouldSeekOnlineMedia(e)&&void 0!==this.player.seekTo&&this.player.seekTo(e,!0):a.warn(508895496,"Attempted to seek www.youtube.com but undefined player")}setMute(){void 0!==this.player&&void 0!==this.player.mute&&this.player.mute()}setUnMute(){void 0!==this.player&&void 0!==this.player.unMute&&this.player.unMute()}isMuted(){if(void 0!==this.player&&void 0!==this.player.isMuted)return this.player.isMuted()}setVolume(e){void 0!==this.player&&void 0!==this.player.setVolume&&this.player.setVolume(e)}isPaused(){return this.paused}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.youTubeIFrame&&this.youTubeIFrame.remove(),void 0!==this.pollPlayerVol&&clearInterval(this.pollPlayerVol),this.paused=!0,this.player=void 0,this.muted=void 0,this.volume=void 0,this.youTubeIFrame=void 0,this.pollPlayerVol=void 0,void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t,i;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.url.searchParams.set("enablejsapi","1"),this.youTubeIFrame=document.createElement("iframe"),this.youTubeIFrame.src=this.url.toString(),this.youTubeIFrame.id="gfx-video-youtube-"+M(),this.setProperties(this.youTubeIFrame),this.parent.append(this.youTubeIFrame),void 0!==this.mediaSizeInfo&&this.mediaSizeInfo.fEnableCropping&&this.handlePartiallyOffSlideLinkedMedia(this.mediaSizeInfo),!0===this.appSettings.fixAutoPlayEnabled?(a.warn(507576588,`YouTube script loaded: ${j()} IFrameAPI Ready: ${null!==(i=window.isYouTubeIFrameAPIReady)&&void 0!==i&&i}`),j()&&!0===window.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(a.warn(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),$.clientsWaitingForIFrameAPI.push(this),window.onYouTubeIframeAPIReady=()=>{window.isYouTubeIFrameAPIReady=!0;for(const e of $.clientsWaitingForIFrameAPI)e.initYouTubePlayer();$.clientsWaitingForIFrameAPI=[]},j()||Y())):(j()||(window.onYouTubeIframeAPIReady=()=>{$.isYouTubeIFrameAPIReady=!0;for(const e of $.clientsWaitingForIFrameAPI)e.initYouTubePlayer();$.clientsWaitingForIFrameAPI=[]},Y()),$.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(a.info(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),$.clientsWaitingForIFrameAPI.push(this)))}initYouTubePlayer(){void 0!==this.youTubeIFrame&&(document.body.contains(this.youTubeIFrame)?this.player=new YT.Player(this.youTubeIFrame.id,{events:{onReady:e=>{this.onPlayerReady(e)},onError:e=>{void 0!==this.perfTracker&&this.perfTracker.onError("YouTube player entered error state "+e.data,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError("YouTube player entered error state "+e.data,!0)}}}):this.youTubeIFrame.onload=()=>{this.initYouTubePlayer()})}shouldSeekOnlineMedia(e){if(void 0!==this.player){const t=this.getCurrentTime();if(void 0!==t&&Math.abs(e-t)>=1)return!0}return!1}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;e.mediaPosition.x<0&&(t=e.mediaPosition.x,this.parent.style.left="0px",this.parent.style.width=e.mediaSize.x+e.mediaPosition.x+"px"),e.mediaPosition.y<0&&(i=e.mediaPosition.y,this.parent.style.top="0px",this.parent.style.height=e.mediaSize.y+e.mediaPosition.y+"px"),e.mediaPosition.x+e.mediaSize.x>e.slideSize.x&&(e.mediaPosition.x<=0?this.parent.style.width=e.slideSize.x+"px":this.parent.style.width=e.slideSize.x-e.mediaPosition.x+"px"),e.mediaPosition.y+e.mediaSize.y>e.slideSize.y&&(e.mediaPosition.y<=0?this.parent.style.height=e.slideSize.y+"px":this.parent.style.height=e.slideSize.y-e.mediaPosition.y+"px"),this.parent.style.overflow="hidden",void 0!==this.youTubeIFrame?(this.youTubeIFrame.style.width=e.mediaSize.x+"px",this.youTubeIFrame.style.height=e.mediaSize.y+"px",this.youTubeIFrame.style.position="relative",this.youTubeIFrame.style.left=t+"px",this.youTubeIFrame.style.top=i+"px"):a.warn(541881949,"Attempted to adjust iframe bounds but iframe is null")}onPlayerReady(e){this.onVolumeChangeHandler(),this.pollPlayerVol=setInterval(()=>this.onVolumeChangeHandler(),500),void 0!==this.player&&void 0!==this.perfTracker&&(this.perfTracker.onReady(),this.perfTracker.setVolume(this.player.getVolume()),this.perfTracker.setMute(this.player.isMuted()),this.perfTracker.setDuration(this.player.getDuration())),void 0!==this.player&&void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),this.playbackTracker.setVolume(this.player.getVolume()),this.playbackTracker.setIsMuted(this.player.isMuted()),this.playbackTracker.setDuration(this.player.getDuration())),e.target.addEventListener("onStateChange",e=>{this.onStateChange(e),this.capturePlayerPerf(e),this.capturePlaybackTelemetry(e)}),void 0!==this.onReadyCallback&&this.onReadyCallback()}onVolumeChangeHandler(){if(void 0===this.player)return;const e=this.player.isMuted(),t=this.player.getVolume(),i=void 0===this.muted||void 0===this.volume,a=this.muted!==e,r=this.volume!==t;this.muted=e,this.volume=t,i||((a||r)&&this.sendMediaEvent(4),r&&void 0!==this.perfTracker&&this.perfTracker.onVolumeChanged(this.volume),a&&void 0!==this.perfTracker&&void 0!==this.muted&&this.perfTracker.onMuteChanged(this.muted),r&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),a&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted))}onStateChange(e){switch(e.data){case-1:break;case 0:this.paused=!0,this.sendMediaEvent(6);break;case 1:this.paused=!1,this.sendMediaEvent(1);break;case 2:this.paused=!0,this.sendMediaEvent(0);break;case 3:this.sendMediaEvent(3);break;case 5:break;default:a.info(508895495,"Unexpected Youtube Media Event: "+e.data)}}capturePlayerPerf(e){if(void 0!==this.perfTracker)switch(e.data){case 0:this.perfTracker.onEnded();break;case 1:this.perfTracker.onPlaying();break;case 2:this.perfTracker.onPause();break;case 3:this.perfTracker.onBuffering()}}capturePlaybackTelemetry(e){if(void 0!==this.playbackTracker)switch(e.data){case 0:this.playbackTracker.onEnded();break;case 1:this.playbackTracker.onPlaying();break;case 2:this.playbackTracker.onPause();break;case 3:this.playbackTracker.onBuffering()}}sendMediaEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){e.style.zIndex="6",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="all",e.style.position="absolute",e.style.objectFit="fill",e.style.border="0px",e.setAttribute("allow","autoplay"),this.setVisible()}}function J(e,t,i,r,s,o,n,l,d){if(!function(e){try{return void 0!==new URL(e)}catch(e){return!1}}(e))throw new Error("Attempted to create an online video client with an invalid URL");if("https:"!==new URL(e).protocol)throw new Error("Attempted to create an online video client with an unsafe URL");null==s||s.setCreationTime(),null==o||o.setTimeOfCreation();let h=b(e);return!0===i.IsStream2Enabled&&void 0===h&&(h="Stream2"),void 0!==s&&void 0!==h&&s.setProviderName(h),void 0!==o&&void 0!==h&&o.setProviderName(h),"YouTube"===h?new $(e,t,s,o,r,n,l,i):"Vimeo"===h?new W(e,t,s,o,n,l):"Flip"===h?new N(e,t,s,o,n,l):"StreamClassic"===h?new x(e,t,i,s,o,n,l,d):"Ted"===h||"SlideShare"===h?new L(e,t,s,o):"Stream2"===h?new _(e,t,i,s,o,n,l,d):(a.warn(512271066,"Creating Default client for unidentified provider URL"),new L(e,t,s,o))}$.isYouTubeIFrameAPIReady=j(),$.clientsWaitingForIFrameAPI=[];const G=new class{createVideoManager(e,t,i,a,r,s,o,n){return new R(e,t,i,a,r,s,o,J,n)}setLogger(e){!function(e){a=e}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(e)}setAADTokenForWaitingClients(e){_.setAADTokenForWaitingClients(e)}}}]);
//# sourceMappingURL=video.js.map