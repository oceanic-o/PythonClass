!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ir-plugin-ski",[],e):"object"==typeof exports?exports["ir-plugin-ski"]=e():t["ir-plugin-ski"]=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=409)}([function(t,e,r){var n=r(4),i=r(8),o=r(15),u=r(12),a=r(20),s=function(t,e,r){var c,f,l,d,p=t&s.F,h=t&s.G,v=t&s.S,g=t&s.P,y=t&s.B,I=h?n:v?n[e]||(n[e]={}):(n[e]||{}).prototype,E=h?i:i[e]||(i[e]={}),_=E.prototype||(E.prototype={});h&&(r=e);for(c in r)f=!p&&I&&void 0!==I[c],l=(f?I:r)[c],d=y&&f?a(l,n):g&&"function"==typeof l?a(Function.call,l):l,I&&u(I,c,l,t&s.U),E[c]!=l&&o(E,c,d),g&&_[c]!=l&&(_[c]=l)};n.core=i,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(158);e.MessageType=n.MessageType;var i=r(157);e.LoggingLevel=i.LoggingLevel;var o=r(159);e.ProviderErrorType=o.ProviderErrorType;var u=r(160);e.ProviderResultStatus=u.ProviderResultStatus;var a=r(162);e.SamplingPolicy=a.SamplingPolicy;var s=r(161);e.DesignerSlideProviderIdentifier=s.DesignerSlideProviderIdentifier,e.MakeItVisualProviderIdentifier=s.MakeItVisualProviderIdentifier,e.DesignerTextToSmartArtProviderIdentifier=s.DesignerTextToSmartArtProviderIdentifier,e.HubbleProviderIdentifier=s.HubbleProviderIdentifier,e.TapProviderIdentifier=s.TapProviderIdentifier,e.DictionaryProviderIdentifier=s.DictionaryProviderIdentifier,e.ImagesProviderIdentifier=s.ImagesProviderIdentifier,e.InsightsProviderIdentifier=s.InsightsProviderIdentifier},function(t,e,r){var n=r(5);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(63)("wks"),i=r(38),o=r(4).Symbol,u="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=n},function(t,e,r){var n=r(23),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e){var r=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},function(t,e,r){t.exports=!r(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(2),i=r(113),o=r(28),u=Object.defineProperty;e.f=r(9)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return u(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(25);t.exports=function(t){return Object(n(t))}},function(t,e,r){var n=r(4),i=r(15),o=r(14),u=r(38)("src"),a=r(209),s=(""+a).split("toString");r(8).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,r,a){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",e)),t[e]!==r&&(c&&(o(r,u)||i(r,u,t[e]?""+t[e]:s.join(String(e)))),t===n?t[e]=r:a?t[e]?t[e]=r:i(t,e,r):(delete t[e],i(t,e,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[u]||a.call(this)})},function(t,e,r){var n=r(0),i=r(3),o=r(25),u=/"/g,a=function(t,e,r,n){var i=String(o(t)),a="<"+e;return""!==r&&(a+=" "+r+'="'+String(n).replace(u,"&quot;")+'"'),a+">"+i+"</"+e+">"};t.exports=function(t,e){var r={};r[t]=e(a),n(n.P+n.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",r)}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(10),i=r(36);t.exports=r(9)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var n=r(50),i=r(25);t.exports=function(t){return n(i(t))}},function(t,e,r){"use strict";var n=r(3);t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){var n=r(20),i=r(50),o=r(11),u=r(7),a=r(109);t.exports=function(t,e){var r=1==t,s=2==t,c=3==t,f=4==t,l=6==t,d=5==t||l,p=e||a;return function(e,a,h){for(var v,g,y=o(e),I=i(y),E=n(a,h,3),_=u(I.length),P=0,S=r?p(e,_):s?p(e,0):void 0;_>P;P++)if((d||P in I)&&(v=I[P],g=E(v,P,y),t))if(r)S[P]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return P;case 2:S.push(v)}else if(f)return!1;return l?-1:c||f?f:S}}},function(t,e,r){var n=r(18);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var n=r(51),i=r(36),o=r(16),u=r(28),a=r(14),s=r(113),c=Object.getOwnPropertyDescriptor;e.f=r(9)?c:function(t,e){if(t=o(t),e=u(e,!0),s)try{return c(t,e)}catch(t){}if(a(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,r){var n=r(0),i=r(8),o=r(3);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],u={};u[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",u)}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){"use strict";if(r(9)){var n=r(31),i=r(4),o=r(3),u=r(0),a=r(64),s=r(95),c=r(20),f=r(41),l=r(36),d=r(15),p=r(43),h=r(23),v=r(7),g=r(132),y=r(37),I=r(28),E=r(14),_=r(49),P=r(5),S=r(11),A=r(82),T=r(32),m=r(34),b=r(33).f,x=r(97),C=r(38),R=r(6),O=r(19),D=r(54),w=r(52),M=r(98),F=r(42),N=r(60),j=r(44),L=r(75),k=r(107),U=r(10),G=r(21),B=U.f,H=G.f,V=i.RangeError,W=i.TypeError,Q=i.Uint8Array,q=Array.prototype,Y=s.ArrayBuffer,X=s.DataView,K=O(0),Z=O(2),J=O(3),z=O(4),$=O(5),tt=O(6),et=D(!0),rt=D(!1),nt=M.values,it=M.keys,ot=M.entries,ut=q.lastIndexOf,at=q.reduce,st=q.reduceRight,ct=q.join,ft=q.sort,lt=q.slice,dt=q.toString,pt=q.toLocaleString,ht=R("iterator"),vt=R("toStringTag"),gt=C("typed_constructor"),yt=C("def_constructor"),It=a.CONSTR,Et=a.TYPED,_t=a.VIEW,Pt=O(1,function(t,e){return bt(w(t,t[yt]),e)}),St=o(function(){return 1===new Q(new Uint16Array([1]).buffer)[0]}),At=!!Q&&!!Q.prototype.set&&o(function(){new Q(1).set({})}),Tt=function(t,e){var r=h(t);if(r<0||r%e)throw V("Wrong offset!");return r},mt=function(t){if(P(t)&&Et in t)return t;throw W(t+" is not a typed array!")},bt=function(t,e){if(!(P(t)&&gt in t))throw W("It is not a typed array constructor!");return new t(e)},xt=function(t,e){return Ct(w(t,t[yt]),e)},Ct=function(t,e){for(var r=0,n=e.length,i=bt(t,n);n>r;)i[r]=e[r++];return i},Rt=function(t,e,r){B(t,e,{get:function(){return this._d[r]}})},Ot=function(t){var e,r,n,i,o,u,a=S(t),s=arguments.length,f=s>1?arguments[1]:void 0,l=void 0!==f,d=x(a);if(void 0!=d&&!A(d)){for(u=d.call(a),n=[],e=0;!(o=u.next()).done;e++)n.push(o.value);a=n}for(l&&s>2&&(f=c(f,arguments[2],2)),e=0,r=v(a.length),i=bt(this,r);r>e;e++)i[e]=l?f(a[e],e):a[e];return i},Dt=function(){for(var t=0,e=arguments.length,r=bt(this,e);e>t;)r[t]=arguments[t++];return r},wt=!!Q&&o(function(){pt.call(new Q(1))}),Mt=function(){return pt.apply(wt?lt.call(mt(this)):mt(this),arguments)},Ft={copyWithin:function(t,e){return k.call(mt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return z(mt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return L.apply(mt(this),arguments)},filter:function(t){return xt(this,Z(mt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(mt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(mt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){K(mt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(mt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(mt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(mt(this),arguments)},lastIndexOf:function(t){return ut.apply(mt(this),arguments)},map:function(t){return Pt(mt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return at.apply(mt(this),arguments)},reduceRight:function(t){return st.apply(mt(this),arguments)},reverse:function(){for(var t,e=this,r=mt(e).length,n=Math.floor(r/2),i=0;i<n;)t=e[i],e[i++]=e[--r],e[r]=t;return e},some:function(t){return J(mt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ft.call(mt(this),t)},subarray:function(t,e){var r=mt(this),n=r.length,i=y(t,n);return new(w(r,r[yt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,v((void 0===e?n:y(e,n))-i))}},Nt=function(t,e){return xt(this,lt.call(mt(this),t,e))},jt=function(t){mt(this);var e=Tt(arguments[1],1),r=this.length,n=S(t),i=v(n.length),o=0;if(i+e>r)throw V("Wrong length!");for(;o<i;)this[e+o]=n[o++]},Lt={entries:function(){return ot.call(mt(this))},keys:function(){return it.call(mt(this))},values:function(){return nt.call(mt(this))}},kt=function(t,e){return P(t)&&t[Et]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ut=function(t,e){return kt(t,e=I(e,!0))?l(2,t[e]):H(t,e)},Gt=function(t,e,r){return!(kt(t,e=I(e,!0))&&P(r)&&E(r,"value"))||E(r,"get")||E(r,"set")||r.configurable||E(r,"writable")&&!r.writable||E(r,"enumerable")&&!r.enumerable?B(t,e,r):(t[e]=r.value,t)};It||(G.f=Ut,U.f=Gt),u(u.S+u.F*!It,"Object",{getOwnPropertyDescriptor:Ut,defineProperty:Gt}),o(function(){dt.call({})})&&(dt=pt=function(){return ct.call(this)});var Bt=p({},Ft);p(Bt,Lt),d(Bt,ht,Lt.values),p(Bt,{slice:Nt,set:jt,constructor:function(){},toString:dt,toLocaleString:Mt}),Rt(Bt,"buffer","b"),Rt(Bt,"byteOffset","o"),Rt(Bt,"byteLength","l"),Rt(Bt,"length","e"),B(Bt,vt,{get:function(){return this[Et]}}),t.exports=function(t,e,r,s){s=!!s;var c=t+(s?"Clamped":"")+"Array",l="get"+t,p="set"+t,h=i[c],y=h||{},I=h&&m(h),E=!h||!a.ABV,S={},A=h&&h.prototype,x=function(t,r){var n=t._d;return n.v[l](r*e+n.o,St)},C=function(t,r,n){var i=t._d;s&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[p](r*e+i.o,n,St)},R=function(t,e){B(t,e,{get:function(){return x(this,e)},set:function(t){return C(this,e,t)},enumerable:!0})};E?(h=r(function(t,r,n,i){f(t,h,c,"_d");var o,u,a,s,l=0,p=0;if(P(r)){if(!(r instanceof Y||"ArrayBuffer"==(s=_(r))||"SharedArrayBuffer"==s))return Et in r?Ct(h,r):Ot.call(h,r);o=r,p=Tt(n,e);var y=r.byteLength;if(void 0===i){if(y%e)throw V("Wrong length!");if((u=y-p)<0)throw V("Wrong length!")}else if((u=v(i)*e)+p>y)throw V("Wrong length!");a=u/e}else a=g(r),u=a*e,o=new Y(u);for(d(t,"_d",{b:o,o:p,l:u,e:a,v:new X(o)});l<a;)R(t,l++)}),A=h.prototype=T(Bt),d(A,"constructor",h)):o(function(){h(1)})&&o(function(){new h(-1)})&&N(function(t){new h,new h(null),new h(1.5),new h(t)},!0)||(h=r(function(t,r,n,i){f(t,h,c);var o;return P(r)?r instanceof Y||"ArrayBuffer"==(o=_(r))||"SharedArrayBuffer"==o?void 0!==i?new y(r,Tt(n,e),i):void 0!==n?new y(r,Tt(n,e)):new y(r):Et in r?Ct(h,r):Ot.call(h,r):new y(g(r))}),K(I!==Function.prototype?b(y).concat(b(I)):b(y),function(t){t in h||d(h,t,y[t])}),h.prototype=A,n||(A.constructor=h));var O=A[ht],D=!!O&&("values"==O.name||void 0==O.name),w=Lt.values;d(h,gt,!0),d(A,Et,c),d(A,_t,!0),d(A,yt,h),(s?new h(1)[vt]==c:vt in A)||B(A,vt,{get:function(){return c}}),S[c]=h,u(u.G+u.W+u.F*(h!=y),S),u(u.S,c,{BYTES_PER_ELEMENT:e}),u(u.S+u.F*o(function(){y.of.call(h,1)}),c,{from:Ot,of:Dt}),"BYTES_PER_ELEMENT"in A||d(A,"BYTES_PER_ELEMENT",e),u(u.P,c,Ft),j(c),u(u.P+u.F*At,c,{set:jt}),u(u.P+u.F*!D,c,Lt),n||A.toString==dt||(A.toString=dt),u(u.P+u.F*o(function(){new h(1).slice()}),c,{slice:Nt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new h([1,2]).toLocaleString()})||!o(function(){A.toLocaleString.call([1,2])})),c,{toLocaleString:Mt}),F[c]=D?O:w,n||D||d(A,ht,w)}}else t.exports=function(){}},function(t,e,r){var n=r(38)("meta"),i=r(5),o=r(14),u=r(10).f,a=0,s=Object.isExtensible||function(){return!0},c=!r(3)(function(){return s(Object.preventExtensions({}))}),f=function(t){u(t,n,{value:{i:"O"+ ++a,w:{}}})},l=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!s(t))return"F";if(!e)return"E";f(t)}return t[n].i},d=function(t,e){if(!o(t,n)){if(!s(t))return!0;if(!e)return!1;f(t)}return t[n].w},p=function(t){return c&&h.NEED&&s(t)&&!o(t,n)&&f(t),t},h=t.exports={KEY:n,NEED:!1,fastKey:l,getWeak:d,onFreeze:p}},function(t,e,r){var n=r(5);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(68));var n=r(153);e.InfraredConnector=n.InfraredConnector;var i=r(154);e.InsightsMessageHandlerBase=i.InsightsMessageHandlerBase;var o=r(155);e.TapMessageHandlerBase=o.TapMessageHandlerBase;var u=r(101);e.ULSCat=u.ULSCat,e.ULSTraceLevel=u.ULSTraceLevel;var a=r(156);e.ULSLogger=a.ULSLogger},function(t,e,r){var n=r(6)("unscopables"),i=Array.prototype;void 0==i[n]&&r(15)(i,n,{}),t.exports=function(t){i[n][t]=!0}},function(t,e){t.exports=!1},function(t,e,r){var n=r(2),i=r(122),o=r(78),u=r(89)("IE_PROTO"),a=function(){},s=function(){var t,e=r(77)("iframe"),n=o.length;for(e.style.display="none",r(80).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),s=t.F;n--;)delete s.prototype[o[n]];return s()};t.exports=Object.create||function(t,e){var r;return null!==t?(a.prototype=n(t),r=new a,a.prototype=null,r[u]=t):r=s(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(124),i=r(78).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){var n=r(14),i=r(11),o=r(89)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,r){var n=r(124),i=r(78);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(23),i=Math.max,o=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):o(t,e)}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){var n=r(5);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.ChangePaneState=0]="ChangePaneState",t[t.Search=1]="Search"}(e.IdeasActionType||(e.IdeasActionType={}))},function(t,e){t.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,e){t.exports={}},function(t,e,r){var n=r(12);t.exports=function(t,e,r){for(var i in e)n(t,i,e[i],r);return t}},function(t,e,r){"use strict";var n=r(4),i=r(10),o=r(9),u=r(6)("species");t.exports=function(t){var e=n[t];o&&e&&!e[u]&&i.f(e,u,{configurable:!0,get:function(){return this}})}},function(t,e,r){var n=r(10).f,i=r(14),o=r(6)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){var n=r(0),i=r(25),o=r(3),u=r(93),a="["+u+"]",s="​",c=RegExp("^"+a+a+"*"),f=RegExp(a+a+"*$"),l=function(t,e,r){var i={},a=o(function(){return!!u[t]()||s[t]()!=s}),c=i[t]=a?e(d):u[t];r&&(i[r]=c),n(n.P+n.F*a,"String",i)},d=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(f,"")),t};t.exports=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.InsightsProviderIdentifier=n.InsightsProviderIdentifier;var i=r(144);e.SatoriSupportedLanguages=i.SatoriSupportedLanguages;var o=r(395);e.InsightsAdditionalInfo=o.InsightsAdditionalInfo;var u=r(145);e.InsightsEntityGroup=u.InsightsEntityGroup;var a=r(396);e.InsightsProvider=a.InsightsProvider},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(397);e.ProviderUtils=n.ProviderUtils},function(t,e,r){var n=r(24),i=r(6)("toStringTag"),o="Arguments"==n(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(e=Object(t),i))?r:o?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,r){var n=r(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){var n=r(2),i=r(18),o=r(6)("species");t.exports=function(t,e){var r,u=n(t).constructor;return void 0===u||void 0==(r=n(u)[o])?e:i(r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.TapProviderIdentifier=n.TapProviderIdentifier;var i=r(140);e.TAP_OFFICE_PLATFORM=i.TAP_OFFICE_PLATFORM,e.TAP_OFFICE_SCENARIO=i.TAP_OFFICE_SCENARIO,e.TAP_HEADER_NAME_OFFICE_PLATFORM=i.TAP_HEADER_NAME_OFFICE_PLATFORM,e.TAP_HEADER_NAME_OFFICE_SCENARIO=i.TAP_HEADER_NAME_OFFICE_SCENARIO,e.TAP_TOKEN_END_POINT=i.TAP_TOKEN_END_POINT;var o=r(383);e.TapAdditionalInfo=o.TapAdditionalInfo;var u=r(141);e.TapEntityGroup=u.TapEntityGroup;var a=r(384);e.TapQFProvider=a.TapQFProvider,e.TapQFAndOLSProvider=a.TapQFAndOLSProvider,e.TapOLSProvider=a.TapOLSProvider,e.TapSPProvider=a.TapSPProvider,e.TapZeroTermQFProvider=a.TapZeroTermQFProvider,e.TapZeroTermQFAndOLSProvider=a.TapZeroTermQFAndOLSProvider,e.TapZeroTermOLSProvider=a.TapZeroTermOLSProvider,e.TapZeroTermSPProvider=a.TapZeroTermSPProvider},function(t,e,r){var n=r(16),i=r(7),o=r(37);t.exports=function(t){return function(e,r,u){var a,s=n(e),c=i(s.length),f=o(u,c);if(t&&r!=r){for(;c>f;)if((a=s[f++])!=a)return!0}else for(;c>f;f++)if((t||f in s)&&s[f]===r)return t||f||0;return!t&&-1}}},function(t,e,r){"use strict";var n=r(4),i=r(0),o=r(12),u=r(43),a=r(27),s=r(58),c=r(41),f=r(5),l=r(3),d=r(60),p=r(45),h=r(81);t.exports=function(t,e,r,v,g,y){var I=n[t],E=I,_=g?"set":"add",P=E&&E.prototype,S={},A=function(t){var e=P[t];o(P,t,"delete"==t?function(t){return!(y&&!f(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!f(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!f(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,r){return e.call(this,0===t?0:t,r),this})};if("function"==typeof E&&(y||P.forEach&&!l(function(){(new E).entries().next()}))){var T=new E,m=T[_](y?{}:-0,1)!=T,b=l(function(){T.has(1)}),x=d(function(t){new E(t)}),C=!y&&l(function(){for(var t=new E,e=5;e--;)t[_](e,e);return!t.has(-0)});x||(E=e(function(e,r){c(e,E,t);var n=h(new I,e,E);return void 0!=r&&s(r,g,n[_],n),n}),E.prototype=P,P.constructor=E),(b||C)&&(A("delete"),A("has"),g&&A("get")),(C||m)&&A(_),y&&P.clear&&delete P.clear}else E=v.getConstructor(e,t,g,_),u(E.prototype,r),a.NEED=!0;return p(E,t),S[t]=E,i(i.G+i.W+i.F*(E!=I),S),y||v.setStrong(E,t,g),E}},function(t,e,r){"use strict";r(135);var n=r(12),i=r(15),o=r(3),u=r(25),a=r(6),s=r(87),c=a("species"),f=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),l=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();t.exports=function(t,e,r){var d=a(t),p=!o(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),h=p?!o(function(){var e=!1,r=/a/;return r.exec=function(){return e=!0,null},"split"===t&&(r.constructor={},r.constructor[c]=function(){return r}),r[d](""),!e}):void 0;if(!p||!h||"replace"===t&&!f||"split"===t&&!l){var v=/./[d],g=r(u,d,""[t],function(t,e,r,n,i){return e.exec===s?p&&!i?{done:!0,value:v.call(e,r,n)}:{done:!0,value:t.call(r,e,n)}:{done:!1}}),y=g[0],I=g[1];n(String.prototype,t,y),i(RegExp.prototype,d,2==e?function(t,e){return I.call(t,this,e)}:function(t){return I.call(t,this)})}}},function(t,e,r){"use strict";var n=r(2);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,r){var n=r(20),i=r(116),o=r(82),u=r(2),a=r(7),s=r(97),c={},f={},e=t.exports=function(t,e,r,l,d){var p,h,v,g,y=d?function(){return t}:s(t),I=n(r,l,e?2:1),E=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(p=a(t.length);p>E;E++)if((g=e?I(u(h=t[E])[0],h[1]):I(t[E]))===c||g===f)return g}else for(v=y.call(t);!(h=v.next()).done;)if((g=i(v,I,h.value,e))===c||g===f)return g};e.BREAK=c,e.RETURN=f},function(t,e,r){var n=r(24);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(6)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],u=o[n]();u.next=function(){return{done:r=!0}},o[n]=function(){return u},t(o)}catch(t){}return r}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){"use strict";var n=r(49),i=RegExp.prototype.exec;t.exports=function(t,e){var r=t.exec;if("function"==typeof r){var o=r.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,r){var n=r(8),i=r(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(31)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){for(var n,i=r(4),o=r(15),u=r(38),a=u("typed_array"),s=u("view"),c=!(!i.ArrayBuffer||!i.DataView),f=c,l=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(n=i[d[l++]])?(o(n.prototype,a,!0),o(n.prototype,s,!0)):f=!1;t.exports={ABV:c,CONSTR:f,TYPED:a,VIEW:s}},function(t,e,r){var n=r(4),i=n.navigator;t.exports=i&&i.userAgent||""},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.DictionaryProviderIdentifier=n.DictionaryProviderIdentifier;var i=r(389);e.DictionaryAdditionalInfo=i.DictionaryAdditionalInfo;var o=r(142);e.DictionaryEntityGroup=o.DictionaryEntityGroup;var u=r(391);e.DictionaryProvider=u.DictionaryProvider},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.ImagesProviderIdentifier=n.ImagesProviderIdentifier;var i=r(392);e.ImagesAdditionalInfo=i.ImagesAdditionalInfo;var o=r(143);e.ImagesEntityGroup=o.ImagesEntityGroup;var u=r(394);e.ImagesProvider=u.ImagesProvider},function(t,e,r){"use strict";function n(t){return t?{message:t.message,stack:t.stack}:null}Object.defineProperty(e,"__esModule",{value:!0}),e.GetErrorObject=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(164);e.Logger=n.Logger},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.SessionStart=0]="SessionStart",t[t.SessionEnd=1]="SessionEnd",t[t.Apply=2]="Apply",t[t.Preview=3]="Preview",t[t.BlurPreview=4]="BlurPreview",t[t.DrillIn=5]="DrillIn",t[t.Search=6]="Search",t[t.Render=7]="Render"}(e.TrackedActionType||(e.TrackedActionType={}))},function(t,e,r){t.exports=!r(105)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){"use strict";var n=r(90)(!0);t.exports=function(t,e,r){return e+(r?n(t,e).length:1)}},function(t,e,r){"use strict";var n=r(11),i=r(37),o=r(7);t.exports=function(t){for(var e=n(this),r=o(e.length),u=arguments.length,a=i(u>1?arguments[1]:void 0,r),s=u>2?arguments[2]:void 0,c=void 0===s?r:i(s,r);c>a;)e[a++]=t;return e}},function(t,e,r){"use strict";var n=r(10),i=r(36);t.exports=function(t,e,r){e in t?n.f(t,e,i(0,r)):t[e]=r}},function(t,e,r){var n=r(5),i=r(4).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var n=r(6)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,r){var n=r(4).document;t.exports=n&&n.documentElement},function(t,e,r){var n=r(5),i=r(88).set;t.exports=function(t,e,r){var o,u=e.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&n(o)&&i&&i(t,o),t}},function(t,e,r){var n=r(42),i=r(6)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[i]===t)}},function(t,e,r){var n=r(5),i=r(24),o=r(6)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,r){"use strict";var n=r(31),i=r(0),o=r(12),u=r(15),a=r(42),s=r(117),c=r(45),f=r(34),l=r(6)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,r,h,v,g,y){s(r,e,h);var I,E,_,P=function(t){if(!d&&t in m)return m[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},S=e+" Iterator",A="values"==v,T=!1,m=t.prototype,b=m[l]||m["@@iterator"]||v&&m[v],x=b||P(v),C=v?A?P("entries"):x:void 0,R="Array"==e?m.entries||b:b;if(R&&(_=f(R.call(new t)))!==Object.prototype&&_.next&&(c(_,S,!0),n||"function"==typeof _[l]||u(_,l,p)),A&&b&&"values"!==b.name&&(T=!0,x=function(){return b.call(this)}),n&&!y||!d&&!T&&m[l]||u(m,l,x),a[e]=x,a[S]=p,v)if(I={values:A?x:P("values"),keys:g?x:P("keys"),entries:C},y)for(E in I)E in m||o(m,E,I[E]);else i(i.P+i.F*(d||T),e,I);return I}},function(t,e){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,r){"use strict";var n=r(57),i=RegExp.prototype.exec,o=String.prototype.replace,u=i,a=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),s=void 0!==/()??/.exec("")[1];(a||s)&&(u=function(t){var e,r,u,c,f=this;return s&&(r=new RegExp("^"+f.source+"$(?!\\s)",n.call(f))),a&&(e=f.lastIndex),u=i.call(f,t),a&&u&&(f.lastIndex=f.global?u.index+u[0].length:e),s&&u&&u.length>1&&o.call(u[0],r,function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(u[c]=void 0)}),u}),t.exports=u},function(t,e,r){var n=r(5),i=r(2),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=r(20)(Function.call,r(21).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e,r){var n=r(63)("keys"),i=r(38);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,r){var n=r(23),i=r(25);t.exports=function(t){return function(e,r){var o,u,a=String(i(e)),s=n(r),c=a.length;return s<0||s>=c?t?"":void 0:(o=a.charCodeAt(s),o<55296||o>56319||s+1===c||(u=a.charCodeAt(s+1))<56320||u>57343?t?a.charAt(s):o:t?a.slice(s,s+2):u-56320+(o-55296<<10)+65536)}}},function(t,e,r){var n=r(83),i=r(25);t.exports=function(t,e,r){if(n(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,e,r){"use strict";var n=r(23),i=r(25);t.exports=function(t){var e=String(i(this)),r="",o=n(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(r+=e);return r}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,r){var n,i,o,u=r(20),a=r(114),s=r(80),c=r(77),f=r(4),l=f.process,d=f.setImmediate,p=f.clearImmediate,h=f.MessageChannel,v=f.Dispatch,g=0,y={},I=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},E=function(t){I.call(t.data)};d&&p||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return y[++g]=function(){a("function"==typeof t?t:Function(t),e)},n(g),g},p=function(t){delete y[t]},"process"==r(24)(l)?n=function(t){l.nextTick(u(I,t,1))}:v&&v.now?n=function(t){v.now(u(I,t,1))}:h?(i=new h,o=i.port2,i.port1.onmessage=E,n=u(o.postMessage,o,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(n=function(t){f.postMessage(t+"","*")},f.addEventListener("message",E,!1)):n="onreadystatechange"in c("script")?function(t){s.appendChild(c("script")).onreadystatechange=function(){s.removeChild(this),I.call(t)}}:function(t){setTimeout(u(I,t,1),0)}),t.exports={set:d,clear:p}},function(t,e,r){"use strict";function n(t,e,r){var n,i,o,u=new Array(r),a=8*r-e-1,s=(1<<a)-1,c=s>>1,f=23===e?k(2,-24)-k(2,-77):0,l=0,d=t<0||0===t&&1/t<0?1:0;for(t=L(t),t!=t||t===N?(i=t!=t?1:0,n=s):(n=U(G(t)/B),t*(o=k(2,-n))<1&&(n--,o*=2),t+=n+c>=1?f/o:f*k(2,1-c),t*o>=2&&(n++,o/=2),n+c>=s?(i=0,n=s):n+c>=1?(i=(t*o-1)*k(2,e),n+=c):(i=t*k(2,c-1)*k(2,e),n=0));e>=8;u[l++]=255&i,i/=256,e-=8);for(n=n<<e|i,a+=e;a>0;u[l++]=255&n,n/=256,a-=8);return u[--l]|=128*d,u}function i(t,e,r){var n,i=8*r-e-1,o=(1<<i)-1,u=o>>1,a=i-7,s=r-1,c=t[s--],f=127&c;for(c>>=7;a>0;f=256*f+t[s],s--,a-=8);for(n=f&(1<<-a)-1,f>>=-a,a+=e;a>0;n=256*n+t[s],s--,a-=8);if(0===f)f=1-u;else{if(f===o)return n?NaN:c?-N:N;n+=k(2,e),f-=u}return(c?-1:1)*n*k(2,f-e)}function o(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function u(t){return[255&t]}function a(t){return[255&t,t>>8&255]}function s(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function c(t){return n(t,52,8)}function f(t){return n(t,23,4)}function l(t,e,r){b(t[R],e,{get:function(){return this[r]}})}function d(t,e,r,n){var i=+r,o=T(i);if(o+e>t[V])throw F(O);var u=t[H]._b,a=o+t[W],s=u.slice(a,a+e);return n?s:s.reverse()}function p(t,e,r,n,i,o){var u=+r,a=T(u);if(a+e>t[V])throw F(O);for(var s=t[H]._b,c=a+t[W],f=n(+i),l=0;l<e;l++)s[c+l]=f[o?l:e-l-1]}var h=r(4),v=r(9),g=r(31),y=r(64),I=r(15),E=r(43),_=r(3),P=r(41),S=r(23),A=r(7),T=r(132),m=r(33).f,b=r(10).f,x=r(75),C=r(45),R="prototype",O="Wrong index!",D=h.ArrayBuffer,w=h.DataView,M=h.Math,F=h.RangeError,N=h.Infinity,j=D,L=M.abs,k=M.pow,U=M.floor,G=M.log,B=M.LN2,H=v?"_b":"buffer",V=v?"_l":"byteLength",W=v?"_o":"byteOffset";if(y.ABV){if(!_(function(){D(1)})||!_(function(){new D(-1)})||_(function(){return new D,new D(1.5),new D(NaN),"ArrayBuffer"!=D.name})){D=function(t){return P(this,D),new j(T(t))};for(var Q,q=D[R]=j[R],Y=m(j),X=0;Y.length>X;)(Q=Y[X++])in D||I(D,Q,j[Q]);g||(q.constructor=D)}var K=new w(new D(2)),Z=w[R].setInt8;K.setInt8(0,2147483648),K.setInt8(1,2147483649),!K.getInt8(0)&&K.getInt8(1)||E(w[R],{setInt8:function(t,e){Z.call(this,t,e<<24>>24)},setUint8:function(t,e){Z.call(this,t,e<<24>>24)}},!0)}else D=function(t){P(this,D,"ArrayBuffer");var e=T(t);this._b=x.call(new Array(e),0),this[V]=e},w=function(t,e,r){P(this,w,"DataView"),P(t,D,"DataView");var n=t[V],i=S(e);if(i<0||i>n)throw F("Wrong offset!");if(r=void 0===r?n-i:A(r),i+r>n)throw F("Wrong length!");this[H]=t,this[W]=i,this[V]=r},v&&(l(D,"byteLength","_l"),l(w,"buffer","_b"),l(w,"byteLength","_l"),l(w,"byteOffset","_o")),E(w[R],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var e=d(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=d(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return o(d(this,4,t,arguments[1]))},getUint32:function(t){return o(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return i(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return i(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){p(this,1,t,u,e)},setUint8:function(t,e){p(this,1,t,u,e)},setInt16:function(t,e){p(this,2,t,a,e,arguments[2])},setUint16:function(t,e){p(this,2,t,a,e,arguments[2])},setInt32:function(t,e){p(this,4,t,s,e,arguments[2])},setUint32:function(t,e){p(this,4,t,s,e,arguments[2])},setFloat32:function(t,e){p(this,4,t,f,e,arguments[2])},setFloat64:function(t,e){p(this,8,t,c,e,arguments[2])}});C(D,"ArrayBuffer"),C(w,"DataView"),I(w[R],y.VIEW,!0),e.ArrayBuffer=D,e.DataView=w},function(t,e,r){e.f=r(6)},function(t,e,r){var n=r(49),i=r(6)("iterator"),o=r(42);t.exports=r(8).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[n(t)]}},function(t,e,r){"use strict";var n=r(30),i=r(118),o=r(42),u=r(16);t.exports=r(84)(Array,"Array",function(t,e){this._t=u(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,r):"values"==e?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.Internal=0]="Internal",t[t.External=1]="External"}(e.ProviderProxyType||(e.ProviderProxyType={}))},function(t,e,r){var n=r(406),i=r(407),o=i;o.v1=n,o.v4=i,t.exports=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.error=10]="error",t[t.warning=15]="warning",t[t.info=50]="info",t[t.verbose=100]="verbose",t[t.spam=200]="spam"}(e.ULSTraceLevel||(e.ULSTraceLevel={}));!function(t){t[t.msoulscat_Wac_Infrared=398]="msoulscat_Wac_Infrared"}(e.ULSCat||(e.ULSCat={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(163);e.IdeasRanker=n.IdeasRanker},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.None=0]="None",t[t.Offer=1]="Offer",t[t.See=2]="See",t[t.Try=3]="Try",t[t.Keep=4]="Keep"}(e.ActionEngagement||(e.ActionEngagement={}))},function(t,e){var r=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){var n=r(24);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},function(t,e,r){"use strict";var n=r(11),i=r(37),o=r(7);t.exports=[].copyWithin||function(t,e){var r=n(this),u=o(r.length),a=i(t,u),s=i(e,u),c=arguments.length>2?arguments[2]:void 0,f=Math.min((void 0===c?u:i(c,u))-s,u-a),l=1;for(s<a&&a<s+f&&(l=-1,s+=f-1,a+=f-1);f-- >0;)s in r?r[a]=r[s]:delete r[a],a+=l,s+=l;return r}},function(t,e,r){var n=r(18),i=r(11),o=r(50),u=r(7);t.exports=function(t,e,r,a,s){n(e);var c=i(t),f=o(c),l=u(c.length),d=s?l-1:0,p=s?-1:1;if(r<2)for(;;){if(d in f){a=f[d],d+=p;break}if(d+=p,s?d<0:l<=d)throw TypeError("Reduce of empty array with no initial value")}for(;s?d>=0:l>d;d+=p)d in f&&(a=e(a,f[d],d,c));return a}},function(t,e,r){var n=r(204);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,r){"use strict";var n=r(18),i=r(5),o=r(114),u=[].slice,a={},s=function(t,e,r){if(!(e in a)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";a[e]=Function("F,a","return new F("+n.join(",")+")")}return a[e](t,r)};t.exports=Function.bind||function(t){var e=n(this),r=u.call(arguments,1),a=function(){var n=r.concat(u.call(arguments));return this instanceof a?s(e,n.length,n):o(e,n,t)};return i(e.prototype)&&(a.prototype=e.prototype),a}},function(t,e,r){"use strict";var n=r(10).f,i=r(32),o=r(43),u=r(20),a=r(41),s=r(58),c=r(84),f=r(118),l=r(44),d=r(9),p=r(27).fastKey,h=r(39),v=d?"_s":"size",g=function(t,e){var r,n=p(e);if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,c){var f=t(function(t,n){a(t,f,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=n&&s(n,r,t[c],t)});return o(f.prototype,{clear:function(){for(var t=h(this,e),r=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var r=h(this,e),n=g(r,t);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[v]--}return!!n},forEach:function(t){h(this,e);for(var r,n=u(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!g(h(this,e),t)}}),d&&n(f.prototype,"size",{get:function(){return h(this,e)[v]}}),f},def:function(t,e,r){var n,i,o=g(t,e);return o?o.v=r:(t._l=o={i:i=p(e,!0),k:e,v:r,p:n=t._l,n:void 0,r:!1},t._f||(t._f=o),n&&(n.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:g,setStrong:function(t,e,r){c(t,e,function(t,r){this._t=h(t,e),this._k=r,this._l=void 0},function(){for(var t=this,e=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==e?f(0,r.k):"values"==e?f(0,r.v):f(0,[r.k,r.v]):(t._t=void 0,f(1))},r?"entries":"values",!r,!0),l(e)}}},function(t,e,r){"use strict";var n=r(43),i=r(27).getWeak,o=r(2),u=r(5),a=r(41),s=r(58),c=r(19),f=r(14),l=r(39),d=c(5),p=c(6),h=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},y=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var r=y(this,t);r?r[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,r,o){var c=t(function(t,n){a(t,c,e,"_i"),t._t=e,t._i=h++,t._l=void 0,void 0!=n&&s(n,r,t[o],t)});return n(c.prototype,{delete:function(t){if(!u(t))return!1;var r=i(t);return!0===r?v(l(this,e)).delete(t):r&&f(r,this._i)&&delete r[this._i]},has:function(t){if(!u(t))return!1;var r=i(t);return!0===r?v(l(this,e)).has(t):r&&f(r,this._i)}}),c},def:function(t,e,r){var n=i(o(e),!0);return!0===n?v(t).set(e,r):n[t._i]=r,t},ufstore:v}},function(t,e,r){t.exports=!r(9)&&!r(3)(function(){return 7!=Object.defineProperty(r(77)("div"),"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var n=r(5),i=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&i(t)===t}},function(t,e,r){var n=r(2);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,r){"use strict";var n=r(32),i=r(36),o=r(45),u={};r(15)(u,r(6)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(u,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,r){"use strict";function n(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=i(e),this.reject=i(r)}var i=r(18);t.exports.f=function(t){return new n(t)}},function(t,e,r){"use strict";var n=r(9),i=r(35),o=r(61),u=r(51),a=r(11),s=r(50),c=Object.assign;t.exports=!c||r(3)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[r]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var r=a(t),c=arguments.length,f=1,l=o.f,d=u.f;c>f;)for(var p,h=s(arguments[f++]),v=l?i(h).concat(l(h)):i(h),g=v.length,y=0;g>y;)p=v[y++],n&&!d.call(h,p)||(r[p]=h[p]);return r}:c},function(t,e,r){var n=r(10),i=r(2),o=r(35);t.exports=r(9)?Object.defineProperties:function(t,e){i(t);for(var r,u=o(e),a=u.length,s=0;a>s;)n.f(t,r=u[s++],e[r]);return t}},function(t,e,r){var n=r(16),i=r(33).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?a(t):i(n(t))}},function(t,e,r){var n=r(14),i=r(16),o=r(54)(!1),u=r(89)("IE_PROTO");t.exports=function(t,e){var r,a=i(t),s=0,c=[];for(r in a)r!=u&&n(a,r)&&c.push(r);for(;e.length>s;)n(a,r=e[s++])&&(~o(c,r)||c.push(r));return c}},function(t,e,r){var n=r(9),i=r(35),o=r(16),u=r(51).f;t.exports=function(t){return function(e){for(var r,a=o(e),s=i(a),c=s.length,f=0,l=[];c>f;)r=s[f++],n&&!u.call(a,r)||l.push(t?[r,a[r]]:a[r]);return l}}},function(t,e,r){var n=r(33),i=r(61),o=r(2),u=r(4).Reflect;t.exports=u&&u.ownKeys||function(t){var e=n.f(o(t)),r=i.f;return r?e.concat(r(t)):e}},function(t,e,r){var n=r(4).parseFloat,i=r(46).trim;t.exports=1/n(r(93)+"-0")!=-1/0?function(t){var e=i(String(t),3),r=n(e);return 0===r&&"-"==e.charAt(0)?-0:r}:n},function(t,e,r){var n=r(4).parseInt,i=r(46).trim,o=r(93),u=/^[-+]?0[xX]/;t.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(t,e){var r=i(String(t),3);return n(r,e>>>0||(u.test(r)?16:10))}:n},function(t,e,r){var n=r(2),i=r(5),o=r(120);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var r=o.f(t);return(0,r.resolve)(e),r.promise}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,r){var n=r(7),i=r(92),o=r(25);t.exports=function(t,e,r,u){var a=String(o(t)),s=a.length,c=void 0===r?" ":String(r),f=n(e);if(f<=s||""==c)return a;var l=f-s,d=i.call(c,Math.ceil(l/c.length));return d.length>l&&(d=d.slice(0,l)),u?d+a:a+d}},function(t,e,r){var n=r(23),i=r(7);t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length!");return r}},function(t,e,r){var n=r(4),i=r(8),o=r(31),u=r(96),a=r(10).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:u.f(t)})}},function(t,e,r){"use strict";var n,i,o,u,a=r(31),s=r(4),c=r(20),f=r(49),l=r(0),d=r(5),p=r(18),h=r(41),v=r(58),g=r(52),y=r(94).set,I=r(211)(),E=r(120),_=r(212),P=r(65),S=r(129),A=s.TypeError,T=s.process,m=T&&T.versions,b=m&&m.v8||"",x=s.Promise,C="process"==f(T),R=function(){},O=i=E.f,D=!!function(){try{var t=x.resolve(1),e=(t.constructor={})[r(6)("species")]=function(t){t(R,R)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(R)instanceof e&&0!==b.indexOf("6.6")&&-1===P.indexOf("Chrome/66")}catch(t){}}(),w=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},M=function(t,e){if(!t._n){t._n=!0;var r=t._c;I(function(){for(var n=t._v,i=1==t._s,o=0;r.length>o;)!function(e){var r,o,u,a=i?e.ok:e.fail,s=e.resolve,c=e.reject,f=e.domain;try{a?(i||(2==t._h&&j(t),t._h=1),!0===a?r=n:(f&&f.enter(),r=a(n),f&&(f.exit(),u=!0)),r===e.promise?c(A("Promise-chain cycle")):(o=w(r))?o.call(r,s,c):s(r)):c(n)}catch(t){f&&!u&&f.exit(),c(t)}}(r[o++]);t._c=[],t._n=!1,e&&!t._h&&F(t)})}},F=function(t){y.call(s,function(){var e,r,n,i=t._v,o=N(t);if(o&&(e=_(function(){C?T.emit("unhandledRejection",i,t):(r=s.onunhandledrejection)?r({promise:t,reason:i}):(n=s.console)&&n.error&&n.error("Unhandled promise rejection",i)}),t._h=C||N(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},j=function(t){y.call(s,function(){var e;C?T.emit("rejectionHandled",t):(e=s.onrejectionhandled)&&e({promise:t,reason:t._v})})},L=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),M(e,!0))},k=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw A("Promise can't be resolved itself");(e=w(t))?I(function(){var n={_w:r,_d:!1};try{e.call(t,c(k,n,1),c(L,n,1))}catch(t){L.call(n,t)}}):(r._v=t,r._s=1,M(r,!1))}catch(t){L.call({_w:r,_d:!1},t)}}};D||(x=function(t){h(this,x,"Promise","_h"),p(t),n.call(this);try{t(c(k,this,1),c(L,this,1))}catch(t){L.call(this,t)}},n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(43)(x.prototype,{then:function(t,e){var r=O(g(this,x));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=C?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&M(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=c(k,t,1),this.reject=c(L,t,1)},E.f=O=function(t){return t===x||t===u?new o(t):i(t)}),l(l.G+l.W+l.F*!D,{Promise:x}),r(45)(x,"Promise"),r(44)("Promise"),u=r(8).Promise,l(l.S+l.F*!D,"Promise",{reject:function(t){var e=O(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(a||!D),"Promise",{resolve:function(t){return S(a&&this===u?x:this,t)}}),l(l.S+l.F*!(D&&r(60)(function(t){x.all(t).catch(R)})),"Promise",{all:function(t){var e=this,r=O(e),n=r.resolve,i=r.reject,o=_(function(){var r=[],o=0,u=1;v(t,!1,function(t){var a=o++,s=!1;r.push(void 0),u++,e.resolve(t).then(function(t){s||(s=!0,r[a]=t,--u||n(r))},i)}),--u||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=O(e),n=r.reject,i=_(function(){v(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(t,e,r){"use strict";var n=r(87);r(0)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},function(t,e,r){r(9)&&"g"!=/./g.flags&&r(10).f(RegExp.prototype,"flags",{configurable:!0,get:r(57)})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(t,e){this.providerId=n.HubbleProviderIdentifier.HUBBLE_PROVIDER_ID,this.groupTypeId=t,this.data=e}return t}();e.HubbleEntityGroup=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.HubbleProviderIdentifier=n.HubbleProviderIdentifier;var i=r(368);e.HubbleAdditionalInfo=i.HubbleAdditionalInfo;var o=r(137);e.HubbleEntityGroup=o.HubbleEntityGroup;var u=r(370);e.HubbleProvider=u.HubbleProvider},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(t,e){this.providerId=n.MakeItVisualProviderIdentifier.MAKE_IT_VISUAL_PROVIDER_ID,this.groupTypeId=n.MakeItVisualProviderIdentifier.MAKE_IT_VISUAL_KEYWORDS_ID,this.notificationConfidence=-1,this.confidence=-1,this.shouldRaiseNotification=!1;var r=[];t&&t.length>0&&(r=r.concat(t.map(function(t){return{keyword:t.Name,imageData:""}}))),e&&e.length>0&&(r=r.concat(e.map(function(t){return{keyword:t.Text,imageData:""}}))),this.data={correlationId:"",suggestions:r}}return t}();e.MakeItVisualEntityGroup=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TAP_TOKEN_END_POINT="https://shredder-us.osi.office.net/",e.API_TAP_URI="ShredderService/api/search/search",e.TAP_REQUEST_HEADERS={"Content-Type":"application/json"},e.TAP_OFFICE_PLATFORM="PptOnline",e.TAP_OFFICE_SCENARIO="Ideas",e.TAP_PROVIDER_QF_TIMEOUT=5e3,e.TAP_PROVIDER_OLS_TIMEOUT=1e4,e.TAP_PROVIDER_SP_TIMEOUT=6e4,e.TAP_HEADER_NAME_AUTHORIZATION="Authorization",e.TAP_HEADER_NAME_FLIGHTS="Flights",e.TAP_HEADER_NAME_SESSIONID="X-SessionId",e.TAP_HEADER_NAME_CORRELATIONID="X-CorrelationId",e.TAP_HEADER_NAME_SEARCHCORRELATIONID="X-SearchCorrelationId",e.TAP_HEADER_NAME_OFFICE_PLATFORM="X-Office-Platform",e.TAP_HEADER_NAME_OFFICE_SCENARIO="X-Scenario"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r){this.providerId=t,this.groupTypeId=e,this.data=r}return t}();e.TapEntityGroup=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(t,e){this.providerId=n.DictionaryProviderIdentifier.DICTIONARY_PROVIDER_ID,this.groupTypeId=t,this.data=e}return t}();e.DictionaryEntityGroup=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(t,e){this.providerId=n.ImagesProviderIdentifier.IMAGES_PROVIDER_ID,this.groupTypeId=t,this.data=e}return t}();e.ImagesEntityGroup=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_INSIGHTS_URL="https://uci.officeapps.live.com/OfficeInsights/Insights/V2",e.INSIGHTS_REQUEST_HEADERS={Accept:"application/json, text/javascript; q=0.01","Content-Type":"application/json; charset=UTF-8"},e.INSIGHTS_PROVIDER_TIMEOUT=5e3,e.INSIGHTS_HEADER_NAME_CLIENTTYPE="X-ClientType",e.INSIGHTS_HEADER_NAME_CORRELATIONID="X-CorrelationId",e.INSIGHTS_HEADER_NAME_USERSESSIONID="X-UserSessionId",e.INSIGHTS_HEADER_NAME_CLIENTUSERAGENT="X-ClientUserAgent",e.INSIGHTS_HEADER_NAME_INSTANID="X-Inst-ANID",e.INSIGHTS_HEADER_NAME_CLIENTIP="X-ClientIP",e.SatoriSupportedLanguages=["en-us"]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(t,e,r){this.providerId=n.InsightsProviderIdentifier.INSIGHTS_PROVIDER_ID,this.groupTypeId=t,this.rank=e,this.data=r}return t}();e.InsightsEntityGroup=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_PROVIDER_TIMEOUT=5e3,e.ARIA_TENANT_INFO={tenantName:"Insights",ariaTenantToken:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487",nexusTenantToken:1757}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(146));var n=r(399);e.IntelligenceHub=n.default;var i=r(400);e.IntentClassifier=i.default;var o=r(404);e.ResultsCache=o.default},function(t,e){function r(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=r},function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(408);e.SmartLookupRanker=n.SmartLookupRanker},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(171),i=r(365);window.IdeasInfraredConnector=n.IdeasInfraredConnector,window.SmartLookupInfraredConnector=i.SmartLookupInfraredConnector},function(t,e,r){"use strict";(function(t){function n(){return t._babelPolyfill||"undefined"!=typeof window&&window._babelPolyfill?null:r(177)}Object.defineProperty(e,"__esModule",{value:!0}),e.idempotentBabelPolyfill=n,e.default=void 0;var i=n();e.default=i}).call(e,r(363))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(68),i=function(){function t(t,e,r){this.successfulEnterpriseUserInfoResponse={IsEnabled:!1,TenantRoot:"",IsGoLocal:!1,CountryCode:"US",ServiceEndpoint:"",IsEnterpriseEnabled:!0},this.failedEnterpriseUserInfoResponse={IsEnabled:!1,TenantRoot:"",IsGoLocal:!1,CountryCode:"US",ServiceEndpoint:"",IsEnterpriseEnabled:!1},this.logger=t,this.applicationProperties=e,this.authTokenProvider=r}return t.prototype.registerResultsCallback=function(t){try{this.intelligenceHub.setResultsUpdatedCallback(t)}catch(t){this.logger.error(595919075,"Exception while processing registerResultsCallback",n.GetErrorObject(t))}},t.prototype.postMessage=function(t){try{this.intentClassifier.onMessage(t)}catch(t){this.logger.error(595919104,"Exception while processing postMessage",n.GetErrorObject(t))}},t.prototype.getEnterpriseUserInfo=function(){var t=this;return new Promise(function(e){if(!(t.applicationProperties.shredderServiceEndpoint&&t.applicationProperties.shredderServiceEndpoint.length>0)){var r=t.authTokenProvider();r?r.then(function(r){e(r?t.successfulEnterpriseUserInfoResponse:{IsEnabled:!1,TenantRoot:"",IsGoLocal:!1,CountryCode:"US",ServiceEndpoint:"",IsEnterpriseEnabled:!1})}).catch(function(r){t.logger.error(595915552,"Exception while fetching token for enterprise user",n.GetErrorObject(r)),e(t.failedEnterpriseUserInfoResponse)}):e(t.failedEnterpriseUserInfoResponse)}else e(t.failedEnterpriseUserInfoResponse)})},t.prototype.clearProviderResult=function(t){this.intelligenceHub.clearResult(t)},t}();e.InfraredConnector=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.numberOfImages=40,this.parentalControl="yes",this.clientType="user"}return t.prototype.clearUciContext=function(t){t.imagesContext=void 0,t.insightsContext=void 0},t}();e.InsightsMessageHandlerBase=n},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function u(t){try{s(n.next(t))}catch(t){o(t)}}function a(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(u,a)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(o,r[1])).done)return u;switch(o=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){s.label=r[1];break}if(6===r[0]&&s.label<u[1]){s.label=u[1],u=r;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(r);break}u[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{i=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,u,a,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var o=r(68),u=function(){function t(t,e,r){this.tenantAndServiceEndpointUrl=null,this.maxRetry=5,this.delayms=5e3,this.applicationProperties=t,this.authTokenProvider=e,this.logger=r,t.shredderServiceEndpoint&&t.shredderServiceEndpoint.length>0&&(this.tenantAndServiceEndpointUrl=t.shredderServiceEndpoint+"ShredderService/api/aadgraph/gettenantdetails?activateTam=false&fetchTenantRoot=true"),this.setTenantRootAndServiceEndpoint()}return t.prototype.delay=function(t){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(function(){return e()},t)}).then(function(){})];case 1:return e.sent(),[2]}})})},t.prototype.setTenantRootAndServiceEndpoint=function(){return n(this,void 0,void 0,function(){var t,e,r,n=this;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),t=1,[4,this.delay(this.delayms).then(function(){})];case 1:i.sent(),i.label=2;case 2:return t<this.maxRetry?(t++,void 0!=this.shredderSharepointTenantRoot||void 0!=this.shredderServiceEndpoint?(this.logger.info(595903520,"TenantRoot And ServiceEndpoint are set in TapMessageHandlerBase constructor"),[3,5]):(e=this.getTenantAndServiceEndpointPromise(),e.then(function(t){t&&(t.tenantRoot&&(n.shredderSharepointTenantRoot=t.tenantRoot),t.serviceEndpoint&&(n.shredderServiceEndpoint=t.serviceEndpoint))}).catch(function(t){n.logger.error(595903555,"Exception while processing tenantRootAndServiceEndpoint in TapMessageHandlerBase constructor",o.GetErrorObject(t))}),void 0!=this.shredderSharepointTenantRoot||void 0!=this.shredderServiceEndpoint?[3,4]:[4,this.delay(this.delayms).then(function(){})])):[3,5];case 3:i.sent(),i.label=4;case 4:return[3,2];case 5:return[3,7];case 6:return r=i.sent(),this.logger.error(595903556,"Exception while processing tenantRootAndServiceEndpointPromise in TapMessageHandlerBase constructor",o.GetErrorObject(r)),[3,7];case 7:return[2]}})})},t.prototype.clearTapContext=function(t){t.tapContext=void 0},t.prototype.getShredderServiceEndpointPromise=function(){var t=this;return new Promise(function(e){var r=t.shredderServiceEndpoint;if(r)e(r);else{var n=t.getTenantAndServiceEndpointPromise();null==n?(t.logger.error(595919124,"getTenantAndServiceEndpointPromise returned null"),e(void 0)):n.then(function(t){e(t?t.serviceEndpoint:void 0)}).catch(function(r){t.logger.error(595903813,"Exception while processing getShredderServiceEndpointPromise",o.GetErrorObject(r)),e(void 0)})}})},t.prototype.getTenantPromise=function(){var t=this;return new Promise(function(e){var r=t.shredderSharepointTenantRoot;if(r)e(r);else{var n=t.getTenantAndServiceEndpointPromise();null==n?(t.logger.error(595919123,"getTenantAndServiceEndpointPromise returned null"),e(void 0)):n.then(function(t){e(t?t.tenantRoot:void 0)}).catch(function(r){t.logger.error(595903814,"Exception while processing getTenantPromise",o.GetErrorObject(r)),e(void 0)})}})},t.prototype.getTenantAndServiceEndpointPromise=function(){var t=this;return new Promise(function(e){try{null==t.tenantAndServiceEndpointUrl&&(t.logger.error(595919105,"invalid tenantAndServiceEndpointUrl"),e(void 0));var r=t.authTokenProvider();null==r?(t.logger.error(595919125,"Empty Token Promise"),e(void 0)):r.then(function(r){r?fetch(t.tenantAndServiceEndpointUrl,{method:"GET",headers:{Authorization:"Bearer "+r}}).then(function(r){r.ok?r.text().then(function(r){var n=JSON.parse(r);n&&n.SharepointTenantRoot&&n.ServiceEndpoint?(t.shredderSharepointTenantRoot=n.SharepointTenantRoot,t.shredderServiceEndpoint=n.ServiceEndpoint,e({tenantRoot:t.shredderSharepointTenantRoot,serviceEndpoint:t.shredderServiceEndpoint})):(t.logger.error(595903702,"Object return by shredder is undefined or empty"),e(void 0))}).catch(function(r){t.logger.error(595903952,"Exception while processing tenantAndServiceEndpoint response",o.GetErrorObject(r)),e(void 0)}):(t.logger.error(595903953,"TenantAndServiceEndpoint response is not ok"),e(void 0))}).catch(function(r){t.logger.error(595903827,"Exception while processing calling shredder service for fetching tenantRoot and ServiceEndpointUrl",o.GetErrorObject(r)),e(void 0)}):(t.logger.error(595903954,"Auth token is Null"),e(void 0))}).catch(function(r){t.logger.error(595903955,"Exception while processing authTokenPromise",o.GetErrorObject(r)),e(void 0)})}catch(r){t.logger.error(595919126,"Exception while processing getTenantandServiceEndpointPromise",o.GetErrorObject(r)),e(void 0)}})},t.prototype.getEnterpriseFeaturesEnabled=function(){return!!(void 0!=this.shredderServiceEndpoint&&this.shredderServiceEndpoint.length>0||this.applicationProperties.shredderServiceEndpoint&&this.applicationProperties.shredderServiceEndpoint.length>0)},t}();e.TapMessageHandlerBase=u},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),o=r(101),u=function(){function t(){}return t}();e.TenantInfo=u;var a=function(){function t(t,e){this.logFct=t,this.category=e}return t.prototype.logEvent=function(t,e,r,i,o,u){var a=JSON.stringify(n({message:i,eventName:t},u));this.logFct(e,this.category,this.loggingLevelToULSTraceLevel(r),"{0}",[a])},t.prototype.loggingLevelToULSTraceLevel=function(t){switch(t){case i.LoggingLevel.Debug:return o.ULSTraceLevel.verbose;case i.LoggingLevel.Info:return o.ULSTraceLevel.info;case i.LoggingLevel.Warn:return o.ULSTraceLevel.warning;case i.LoggingLevel.Error:return o.ULSTraceLevel.error}},t}();e.ULSLogger=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.Error=0]="Error",t[t.Warn=1]="Warn",t[t.Info=2]="Info",t[t.Debug=3]="Debug"}(e.LoggingLevel||(e.LoggingLevel={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t.DesignerSlideSuggestion="Designer.Slides",t.TextToSmartArtSuggestion="Designer.TextToSmartArt",t.PowerPointTextTileChanged="PowerPoint.TextTileChanged",t.SlideContentChange="PowerPoint.SlideContentChange",t.IdeasExecuteAction="Ideas.ExecuteAction"}(e.MessageType||(e.MessageType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t.NotSet="NotSet",t.Timeout="Timeout",t.NetworkError="NetworkError",t.ServiceError="ServiceError",t.ParsingError="ParsingError",t.AuthenticationError="AuthenticationError",t.UnhandledException="UnhandledException"}(e.ProviderErrorType||(e.ProviderErrorType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t.Invalid="Invalid",t.Success="Success",t.Error="Error",t.Pending="Pending",t.NoResult="NoResult"}(e.ProviderResultStatus||(e.ProviderResultStatus={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t.DESIGNER_SLIDE_PROVIDER_ID="Provider.Designer.Slide",t.SLIDE_SUGGESTION_ID="EntityGroup.Designer.Slide.Suggestion"}(e.DesignerSlideProviderIdentifier||(e.DesignerSlideProviderIdentifier={}));!function(t){t.MAKE_IT_VISUAL_PROVIDER_ID="Provider.UCI.MakeItVisual",t.MAKE_IT_VISUAL_KEYWORDS_ID="EntityGroup.UCI.MakeItVisual.Keywords"}(e.MakeItVisualProviderIdentifier||(e.MakeItVisualProviderIdentifier={}));!function(t){t.DESIGNER_TEXT_TO_SMARTART_PROVIDER_ID="Provider.Designer.TextToSmartArt",t.TEXT_TO_SMARTART_SUGGESTION_ID="EntityGroup.Designer.TextToSmartArt.Suggestion"}(e.DesignerTextToSmartArtProviderIdentifier||(e.DesignerTextToSmartArtProviderIdentifier={}));!function(t){t.HUBBLE_PROVIDER_ID="Provider.Hubble",t.HUBBLE_IMAGES_GROUP_ID="EntityGroup.Hubble.Images"}(e.HubbleProviderIdentifier||(e.HubbleProviderIdentifier={}));!function(t){t.TAP_SEARCH_QF_PROVIDER_ID="Provider.Tap.Search.QF",t.TAP_SEARCH_QF_AND_OLS_PROVIDER_ID="Provider.Tap.Search.QFAndOLS",t.TAP_SEARCH_OLS_PROVIDER_ID="Provider.Tap.Search.OLS",t.TAP_SEARCH_SP_PROVIDER_ID="Provider.Tap.Search.SP",t.TAP_SEARCH_ZERO_TERM_QF_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.QF",t.TAP_SEARCH_ZERO_TERM_QF_AND_OLS_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.QFAndOLS",t.TAP_SEARCH_ZERO_TERM_OLS_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.OLS",t.TAP_SEARCH_ZERO_TERM_SP_PROVIDER_ID="Provider.Tap.Search.ZeroTerm.SP",t.DOCUMENT_ID="EntityGroup.Tap.Document"}(e.TapProviderIdentifier||(e.TapProviderIdentifier={}));!function(t){t.DICTIONARY_PROVIDER_ID="Provider.UCI.Dictionary",t.DICTIONARY_WORDS_GROUP_ID="EntityGroup.UCI.Dictionary.Words"}(e.DictionaryProviderIdentifier||(e.DictionaryProviderIdentifier={}));!function(t){t.IMAGES_PROVIDER_ID="Provider.UCI.Images",t.IMAGES_ID="EntityGroup.UCI.Images.Images"}(e.ImagesProviderIdentifier||(e.ImagesProviderIdentifier={}));!function(t){t.INSIGHTS_PROVIDER_ID="Provider.UCI.Insights",t.BINGANSWER_COMPUTATION_ID="EntityGroup.UCI.Insights.BingAnswer.Computation",t.BINGANSWER_CURRENCY_ID="EntityGroup.UCI.Insights.BingAnswer.Currency",t.BINGANSWER_FACTS_ID="EntityGroup.UCI.Insights.BingAnswer.Facts",t.BINGANSWER_FINANCE_ID="EntityGroup.UCI.Insights.BingAnswer.Finance",t.BINGANSWER_NEWS_ID="EntityGroup.UCI.Insights.BingAnswer.News",t.BINGANSWER_WEATHER_ID="EntityGroup.UCI.Insights.BingAnswer.Weather",t.DICTIONARY_ID="EntityGroup.UCI.Insights.Dictionary",t.ENTITIES_ID="EntityGroup.UCI.Insights.Entities",t.IMAGES_ID="EntityGroup.UCI.Insights.Images",t.WEBRESULTS_ID="EntityGroup.UCI.Insights.WebResults",t.WIKIPEDIARESULTS_ID="EntityGroup.UCI.Insights.WikipediaResults"}(e.InsightsProviderIdentifier||(e.InsightsProviderIdentifier={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.NotSet=0]="NotSet",t[t.Measure=1]="Measure",t[t.Diagnostics=2]="Diagnostics",t[t.CriticalBusinessImpact=191]="CriticalBusinessImpact",t[t.CriticalCensus=192]="CriticalCensus",t[t.CriticalExperimentation=193]="CriticalExperimentation",t[t.CriticalUsage=194]="CriticalUsage"}(e.SamplingPolicy||(e.SamplingPolicy={}))},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),o=r(69),u=r(29),a=function(){function t(t,e){this.logger=t,this.configuration=e}return t.setup=function(e,r){return new t(new o.Logger([new u.ULSLogger(e,u.ULSCat.msoulscat_Wac_Infrared)]),r)},t.prototype.rank=function(e,r){var n=this.configuration?this.configuration.rankingOrder:t.defaultRankingOrder,i=r.rankedEntityGroups.slice();return i.sort(function(t,e){return(n[t.groupTypeId]||Number.MAX_VALUE)-(n[e.groupTypeId]||Number.MAX_VALUE)}),r.rankedEntityGroups=i,this.logger.info(595994307,"[IdeasRanker] RankedResults",{interactionId:e.interactionId,transactionId:e.transactionId,ranking:r.rankedEntityGroups.map(function(t){return t.groupTypeId})}),this.checkNotification(r.rankedEntityGroups),r},t.prototype.checkNotification=function(t){try{for(var e=n(t),r=e.next();!r.done;r=e.next()){var i=r.value;void 0!=i.shouldRaiseNotification&&(i.shouldRaiseNotification=i.notificationConfidence>0)}}catch(t){o={error:t}}finally{try{r&&!r.done&&(u=e.return)&&u.call(e)}finally{if(o)throw o.error}}var o,u},t.defaultRankingOrder=(s={},s[i.DesignerSlideProviderIdentifier.SLIDE_SUGGESTION_ID]=1,s[i.DesignerTextToSmartArtProviderIdentifier.TEXT_TO_SMARTART_SUGGESTION_ID]=2,s[i.MakeItVisualProviderIdentifier.MAKE_IT_VISUAL_KEYWORDS_ID]=3,s),t}();e.IdeasRanker=a;var s},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(165),o=r(1),u=function(){function t(t,e){void 0===e&&(e=!1),this.transports=[],e&&this.transports.push(new i.ConsoleLogger);try{for(var r=n(t),o=r.next();!o.done;o=r.next()){var u=o.value;this.transports.push(u)}}catch(t){a={error:t}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(a)throw a.error}}var a,s}return t.prototype.log=function(t,e,r,i){try{for(var u=n(this.transports),a=u.next();!a.done;a=u.next()){a.value.logEvent(null,t,e,r,o.SamplingPolicy.Measure,i)}}catch(t){s={error:t}}finally{try{a&&!a.done&&(c=u.return)&&c.call(u)}finally{if(s)throw s.error}}var s,c},t.prototype.info=function(t,e,r){try{for(var i=n(this.transports),u=i.next();!u.done;u=i.next()){u.value.logEvent(null,t,o.LoggingLevel.Info,e,o.SamplingPolicy.Measure,r)}}catch(t){a={error:t}}finally{try{u&&!u.done&&(s=i.return)&&s.call(i)}finally{if(a)throw a.error}}var a,s},t.prototype.warn=function(t,e,r){try{for(var i=n(this.transports),u=i.next();!u.done;u=i.next()){u.value.logEvent(null,t,o.LoggingLevel.Warn,e,o.SamplingPolicy.Measure,r)}}catch(t){a={error:t}}finally{try{u&&!u.done&&(s=i.return)&&s.call(i)}finally{if(a)throw a.error}}var a,s},t.prototype.error=function(t,e,r){try{for(var i=n(this.transports),u=i.next();!u.done;u=i.next()){u.value.logEvent(null,t,o.LoggingLevel.Error,e,o.SamplingPolicy.Diagnostics,r)}}catch(t){a={error:t}}finally{try{u&&!u.done&&(s=i.return)&&s.call(i)}finally{if(a)throw a.error}}var a,s},t.prototype.debug=function(t,e,r){try{for(var i=n(this.transports),u=i.next();!u.done;u=i.next()){u.value.logEvent(null,t,o.LoggingLevel.Debug,e,o.SamplingPolicy.Measure,r)}}catch(t){a={error:t}}finally{try{u&&!u.done&&(s=i.return)&&s.call(i)}finally{if(a)throw a.error}}var a,s},t.prototype.logEvent=function(t,e,r,i,o,u){try{for(var a=n(this.transports),s=a.next();!s.done;s=a.next()){s.value.logEvent(t,e,r,i,o,u)}}catch(t){c={error:t}}finally{try{s&&!s.done&&(f=a.return)&&f.call(a)}finally{if(c)throw c.error}}var c,f},t}();e.Logger=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(){}return t.prototype.log=function(t,e,r,i){switch(e){case n.LoggingLevel.Debug:this.debug(t,r,i);break;case n.LoggingLevel.Error:this.error(t,r,i);break;case n.LoggingLevel.Info:this.info(t,r,i);break;case n.LoggingLevel.Warn:this.warn(t,r,i);break;default:throw new Error("Invalid logging level")}},t.prototype.debug=function(t,e,r){console.log(this.formatOutput(null,t,e,r))},t.prototype.error=function(t,e,r){console.error(this.formatOutput(null,t,e,r))},t.prototype.warn=function(t,e,r){console.warn(this.formatOutput(null,t,e,r))},t.prototype.info=function(t,e,r){console.info(this.formatOutput(null,t,e,r))},t.prototype.logEvent=function(t,e,r,n,i,o){console.info(this.formatOutput(t,e,n,o))},t.prototype.formatOutput=function(t,e,r,n){var i={eventName:t,tagID:e,message:r,data:n};return JSON.stringify(i)},t}();e.ConsoleLogger=i},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1);!function(t){function e(t,e,r){var o=[];return e.forEach(function(e){o.push({providerId:t,groupTypeId:e.groupTypeId,notificationConfidence:-1,shouldRaiseNotification:!1,confidence:-1,data:e.data})}),{providerId:t,resultStatus:i.ProviderResultStatus.Success,entityGroups:o,additionalInfo:n({},r,{resultTimestamp:Date.now()})}}t.Create=e}(e.ExternalProviderResultFactory||(e.ExternalProviderResultFactory={}))},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=r(53),o=r(172),u=r(66),a=r(29),s=r(169),c=r(40),f=r(173),l=r(168),d=r(102),p=r(67),h=r(174),v=r(47),g=r(147),y=r(69),I=r(175),E=r(378),_=r(1),P=r(176),S=function(t){function e(e,r,n,a,c,y,_){var S=t.call(this,r,a,y)||this;return S.ideasPaneStateCallback=n,S.searchQueryHandler=_,S.ideasActionLogger=new s.IdeasActionLogger(c,S.logger,a.sessionId),S.intelligenceHub=new g.IntelligenceHub(new d.IdeasRanker(S.logger,e),S.logger,new g.ResultsCache(S.logger)),S.intelligenceHub.registerProvider(new E.MakeItVisualProvider(S.logger)),void 0==S.searchQueryHandler&&S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new v.InsightsProvider(S.logger))),S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new p.ImagesProvider(S.logger))),S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new u.DictionaryProvider(S.logger))),S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new i.TapQFProvider(S.logger))),S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new i.TapOLSProvider(S.logger))),S.intelligenceHub.registerProvider(new l.IdeasProviderWrapper(new i.TapSPProvider(S.logger))),S.intelligenceHub.registerProvider(new i.TapZeroTermQFProvider(S.logger)),S.intelligenceHub.registerProvider(new i.TapZeroTermOLSProvider(S.logger)),S.intelligenceHub.registerProvider(new i.TapZeroTermSPProvider(S.logger)),S.intentClassifier=new g.IntentClassifier(S.intelligenceHub,[new o.DesignerMessageHandler(S.intelligenceHub),new I.MakeItVisualMessageHandler(e.makeItVisualConfig),new f.IdeasMessageHandler,new h.InsightsMessageHandler(a),new P.TapMessageHandler(a,S.authTokenProvider,S.logger)],S.logger),S}return n(e,t),e.setup=function(t,r,n,i,o,u,s){if(!i)throw new Error("applicationProperties is undefined");return new e(t,new y.Logger([new a.ULSLogger(r,a.ULSCat.msoulscat_Wac_Infrared)]),n,i,o,u,s)},e.prototype.postMessage=function(t){try{this.intentClassifier.onMessage(t),this.searchQueryHandler&&this.searchQueryHandler(t),t.messageType===_.MessageType.IdeasExecuteAction&&this.executeIdeasAction(t.data)}catch(t){this.logger.error(595952522,"Exception while processing postMessage",a.GetErrorObject(t))}},e.prototype.getIdeasPaneVisibilityStatus=function(){return this.isIdeasPaneVisible},e.prototype.trackIdeasProviderAction=function(t,e,r){try{this.trackAction({ideasSessionId:0,cardTypeId:t,isProviderAction:!0,engagement:r,trackedActionType:e})}catch(t){this.logger.error(595952523,"Exception while processing trackIdeasProviderAction",a.GetErrorObject(t))}},e.prototype.trackAction=function(t){try{this.ideasActionLogger.logAction(t)}catch(t){this.logger.error(595952524,"Exception while processing trackAction",a.GetErrorObject(t))}},e.prototype.executeIdeasAction=function(t){if(!t)return void this.logger.error(595952525,"Ideas execute action requires data!");try{if(this.trackAction(t.trackedAction),t.actionType===c.IdeasActionType.ChangePaneState){var e=t.data;void 0!=e&&e!=this.isIdeasPaneVisible&&(e?this.intentClassifier.startUserInteractionSession():this.intentClassifier.endUserInteractionSession(),this.isIdeasPaneVisible=e,this.ideasPaneStateCallback(e))}}catch(t){this.logger.error(595952526,"Exception while processing executeIdeasAction",a.GetErrorObject(t))}},e.prototype.pushProviderResult=function(t){if(!t)return void this.logger.error(595952533,"Result is undefined or null");try{this.searchQueryHandler&&"Provider.UCI.Insights"==t.providerId?(t.entityGroups.forEach(function(t){t.data=JSON.parse(String(t.data))}),this.intelligenceHub.pushResult(t)):this.intelligenceHub.pushResult(t)}catch(t){this.logger.error(595952527,"Exception while processing pushProviderResult",a.GetErrorObject(t))}},e}(a.InfraredConnector);e.IdeasInfraredConnector=S},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.provider=t,this.configuration=this.provider.configuration}return Object.defineProperty(t.prototype,"providerId",{get:function(){return this.provider.providerId},enumerable:!0,configurable:!0}),t.prototype.shouldExecute=function(t){return this.provider.shouldExecute(t)},t.prototype.getContextHash=function(t){return this.provider.getContextHash?this.provider.getContextHash(t):void 0},t.prototype.getResults=function(t,e){var r=this;this.provider.getResults(t,function(t){var i={providerId:r.providerId,resultStatus:t.resultStatus,statusCode:t.statusCode,additionalInfo:t.additionalInfo,entityGroups:t.entityGroups?t.entityGroups.map(function(t){return n({},t,{notificationConfidence:-1,shouldRaiseNotification:!1,confidence:-1,data:t.data})}):void 0};e(i)})},t.prototype.getProviderRequest=function(t){return this.provider.getProviderRequest(t)},t.prototype.getProviderResults=function(t,e){return this.provider.getProviderResults(t,e)},t}();e.IdeasProviderWrapper=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(70),i=r(103),o=r(170),u=function(){function t(t,e,r){this.ideasActionTracker=t,this.logger=e,this.userSessionId=r,this.ideasDrillInTracker=new o.IdeasDrillInTracker}return t.prototype.logAction=function(t){var e=this.ideasDrillInTracker.augmentOrTrackAction(t);t.trackedActionType!==n.TrackedActionType.SessionStart&&t.trackedActionType!==n.TrackedActionType.SessionEnd&&t.engagement===i.ActionEngagement.None||(this.logScorecardDatapoint(e),this.logDashboardDatapoint(e))},t.prototype.logScorecardDatapoint=function(e){if(!(e.ideasSessionId<=0)){var r=e.isProviderAction?t.EXTERNAL_IDENTIFIER:t.INTERNAL_IDENTIFIER,o=e.cardTypeId+"."+r+"."+n.TrackedActionType[e.trackedActionType]+"."+i.ActionEngagement[e.engagement]+"."+this.getCardSlot(e);this.ideasActionTracker.trackAction(o)}},t.prototype.logDashboardDatapoint=function(t){this.logger.info(595966083,"Ideas tracked action.",{userSessionId:this.userSessionId,ideasSessionId:t.ideasSessionId,isProviderAction:t.isProviderAction,cardSlot:this.getCardSlot(t),cardTypeId:t.cardTypeId,actionType:n.TrackedActionType[t.trackedActionType],engagement:i.ActionEngagement[t.engagement],entryPoint:t.entryPoint,renderedResults:t.renderedResults})},t.prototype.getCardSlot=function(t){return t.renderedResults?t.renderedResults.indexOf(t.cardTypeId)+1:0},t.EXTERNAL_IDENTIFIER="External",t.INTERNAL_IDENTIFIER="Internal",t}();e.IdeasActionLogger=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(70),i=function(){function t(){this.trackedDrillInActions=[]}return t.prototype.augmentOrTrackAction=function(t){if(t.isProviderAction){var e=this.trackedDrillInActions.findIndex(function(e){return e.cardTypeId===t.cardTypeId});if(e>-1){var r=this.trackedDrillInActions[e];t.ideasSessionId=r.ideasSessionId,t.transactionId=r.transactionId,t.renderedResults=r.renderedResults}t.trackedActionType===n.TrackedActionType.SessionEnd&&e>-1&&this.trackedDrillInActions.splice(e,1)}else if(t.trackedActionType===n.TrackedActionType.DrillIn){var e=this.trackedDrillInActions.findIndex(function(e){return e.cardTypeId===t.cardTypeId});e>-1&&this.trackedDrillInActions.splice(e,1),this.trackedDrillInActions.push(t)}return t},t}();e.IdeasDrillInTracker=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(167);e.IdeasInfraredConnector=n.IdeasInfraredConnector;var i=r(102);e.IdeasRanker=i.IdeasRanker;var o=r(103);e.ActionEngagement=o.ActionEngagement;var u=r(40);e.IdeasActionType=u.IdeasActionType;var a=r(70);e.TrackedActionType=a.TrackedActionType;var s=r(1);e.DesignerSlideProviderIdentifier=s.DesignerSlideProviderIdentifier,e.DesignerTextToSmartArtProviderIdentifier=s.DesignerTextToSmartArtProviderIdentifier,e.MakeItVisualProviderIdentifier=s.MakeItVisualProviderIdentifier,e.TapProviderIdentifier=s.TapProviderIdentifier;var c=r(1);e.MessageType=c.MessageType,e.ProviderErrorType=c.ProviderErrorType,e.ProviderResultStatus=c.ProviderResultStatus;var f=r(47);e.InsightsAdditionalInfo=f.InsightsAdditionalInfo,e.InsightsProviderIdentifier=f.InsightsProviderIdentifier,e.InsightsEntityGroup=f.InsightsEntityGroup;var l=r(67);e.ImagesAdditionalInfo=l.ImagesAdditionalInfo,e.ImagesProviderIdentifier=l.ImagesProviderIdentifier,e.ImagesEntityGroup=l.ImagesEntityGroup;var d=r(66);e.DictionaryAdditionalInfo=d.DictionaryAdditionalInfo,e.DictionaryProviderIdentifier=d.DictionaryProviderIdentifier,e.DictionaryEntityGroup=d.DictionaryEntityGroup},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=r(166),o=function(){function t(t){this.intelligenceHub=t}return t.prototype.convertMessage=function(t,e){return t.messageType==n.MessageType.DesignerSlideSuggestion?this.handleDesignerSlideSuggestionUpdate(t.data):t.messageType==n.MessageType.TextToSmartArtSuggestion&&this.handleDesignerTextToSmartArtSuggestionUpdate(t.data),e},t.prototype.handleDesignerSlideSuggestionUpdate=function(t){t?this.intelligenceHub.pushResult(i.ExternalProviderResultFactory.Create(n.DesignerSlideProviderIdentifier.DESIGNER_SLIDE_PROVIDER_ID,[{groupTypeId:n.DesignerSlideProviderIdentifier.SLIDE_SUGGESTION_ID,data:t}])):this.intelligenceHub.clearResult(n.DesignerSlideProviderIdentifier.DESIGNER_SLIDE_PROVIDER_ID)},t.prototype.handleDesignerTextToSmartArtSuggestionUpdate=function(t){t?this.intelligenceHub.pushResult(i.ExternalProviderResultFactory.Create(n.DesignerTextToSmartArtProviderIdentifier.DESIGNER_TEXT_TO_SMARTART_PROVIDER_ID,[{groupTypeId:n.DesignerTextToSmartArtProviderIdentifier.TEXT_TO_SMARTART_SUGGESTION_ID,data:t}])):this.intelligenceHub.clearResult(n.DesignerTextToSmartArtProviderIdentifier.DESIGNER_TEXT_TO_SMARTART_PROVIDER_ID)},t}();e.DesignerMessageHandler=o},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(40),o=r(1),u=function(){function t(){}return t.prototype.convertMessage=function(t,e){var r=n({},e);switch(t.messageType){case o.MessageType.IdeasExecuteAction:var u=t.data;u.actionType===i.IdeasActionType.ChangePaneState&&this.handleIdeasPaneState(r,u.data)}return r},t.prototype.handleIdeasPaneState=function(t,e){t.paneOpen=!!e},t}();e.IdeasMessageHandler=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(29),u=r(40),a=r(47),s=r(1),c=function(t){function e(e){var r=t.call(this)||this;return r.applicationProperties=e,r}return n(e,t),e.prototype.convertMessage=function(t,e){var r=i({},e);switch(t.messageType){case s.MessageType.IdeasExecuteAction:var n=t.data;n.actionType===u.IdeasActionType.Search&&this.handleIdeasSearchProperties(r,n.data)}return r},e.prototype.handleIdeasSearchProperties=function(t,e){e?this.updateUciContext(t,e):this.clearUciContext(t)},e.prototype.updateUciContext=function(t,e){e&&(t.imagesContext={ImageSearchQuery:e.disambiguatedSearchTerm,License:e.imagesLicense,Offset:e.imagesOffset,Count:this.numberOfImages},t.insightsContext={QueryTimestamp:e.queryTimestamp,App:this.applicationProperties.appName+this.applicationProperties.appPlatform,Neighborhood:e.searchTerm,MentionStart:0,MentionLength:e.searchTerm.length,Market:this.applicationProperties.market,UiLanguage:this.applicationProperties.uiLanguage,ParentalControl:this.parentalControl,CallSatori:!!this.applicationProperties.uiLanguage&&a.SatoriSupportedLanguages.indexOf(this.applicationProperties.uiLanguage.toLowerCase())>-1,correlationId:t.interactionId,clientType:this.clientType,sessionId:this.applicationProperties.sessionId,RankWebResults:!1,TransactionId:t.transactionId})},e}(o.InsightsMessageHandlerBase);e.InsightsMessageHandler=c},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)u.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return u},u=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var a=r(40),s=r(1),c=120,f=0,l=function(){function t(t){this.wordTokenizer=/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]+/g,this.makeItVisualConfig=t,this.makeItVisualConfig||(this.makeItVisualConfig={resultTimeoutInSeconds:c,distanceThreshold:f})}return t.prototype.convertMessage=function(t,e){var r=n({},e);switch(t.messageType){case s.MessageType.PowerPointTextTileChanged:this.handlePowerPointTextTileChanged(r,t.data);break;case s.MessageType.IdeasExecuteAction:var i=t.data;i.actionType===a.IdeasActionType.ChangePaneState&&this.handleIdeasPaneState(r,i.data)}return r},t.prototype.handlePowerPointTextTileChanged=function(t,e){if(e){var r=new Set,n=[];try{for(var o=i(e.drawingElems),a=o.next();!a.done;a=o.next()){var s=a.value;try{for(var c=i(s.text.paragraphs),f=c.next();!f.done;f=c.next()){var l=f.value;n=u(n,[l.chars]);var d=l.chars.match(this.wordTokenizer)||[];r=new Set(u(d,r))}}catch(t){v={error:t}}finally{try{f&&!f.done&&(g=c.return)&&g.call(c)}finally{if(v)throw v.error}}}}catch(t){p={error:t}}finally{try{a&&!a.done&&(h=o.return)&&h.call(o)}finally{if(p)throw p.error}}if(this.shouldUpdateConfig(t,e,r))return this.addDefaultContextIfNeeded(t),t.makeItVisualContext.updateTimestamp=Date.now(),t.makeItVisualContext.slideId=e.mk.sId,t.makeItVisualContext.slideTokens=r,void(t.makeItVisualContext.paragraphs=n);var p,h,v,g}},t.prototype.shouldUpdateConfig=function(t,e,r){if(void 0==t.makeItVisualContext||e.mk.sId!=t.makeItVisualContext.slideId||Date.now()-1e3*this.makeItVisualConfig.resultTimeoutInSeconds>t.makeItVisualContext.updateTimestamp)return!0;var n=new Set(u(t.makeItVisualContext.slideTokens).filter(function(t){return r.has(t)}));return 1-n.size/(t.makeItVisualContext.slideTokens.size+r.size-n.size)>=this.makeItVisualConfig.distanceThreshold},t.prototype.handleIdeasPaneState=function(t,e){this.addDefaultContextIfNeeded(t),t.makeItVisualContext.canMakeCall=!!e},t.prototype.addDefaultContextIfNeeded=function(t){t.makeItVisualContext||(t.makeItVisualContext={canMakeCall:!1,updateTimestamp:0,slideTokens:new Set,slideId:0,paragraphs:[]})},t}();e.MakeItVisualMessageHandler=l},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(53),u=r(29),a=r(40),s=r(1),c=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return n(e,t),e.prototype.convertMessage=function(t,e){var r=i({},e),n=t.data;switch(t.messageType){case s.MessageType.IdeasExecuteAction:n.actionType===a.IdeasActionType.ChangePaneState?this.handleIdeasZeroTermSearchProperties(r,n.data):n.actionType===a.IdeasActionType.Search&&this.handleIdeasSearchProperties(r,n.data)}return r},e.prototype.handleIdeasSearchProperties=function(t,e){e?this.updateTapContext(t,e):this.clearTapContext(t)},e.prototype.updateTapContext=function(t,e){e&&(t.tapContext={tenant:this.shredderSharepointTenantRoot,tenantPromise:this.getTenantPromise(),lcid:this.applicationProperties.lcid,queryText:e.searchTerm,queryTimestamp:e.queryTimestamp,rowLimit:0,objectTypeFilter:"",isEchoScenario:!1,fetchTokenPromise:this.authTokenProvider(),enterpriseFeaturesEnabled:this.getEnterpriseFeaturesEnabled(),searchCorrelationId:t.interactionId,sessionId:this.applicationProperties.sessionId,correlationId:t.interactionId,serviceEndpoint:this.shredderServiceEndpoint,officePlatform:o.TAP_OFFICE_PLATFORM,officeScenario:o.TAP_OFFICE_SCENARIO,serviceEndpointPromise:this.getShredderServiceEndpointPromise()})},e.prototype.handleIdeasZeroTermSearchProperties=function(t,e){e&&1==e&&this.updateZeroTermSearchTapContext(t)},e.prototype.updateZeroTermSearchTapContext=function(t){t.tapContext={tenant:this.shredderSharepointTenantRoot,tenantPromise:this.getTenantPromise(),lcid:this.applicationProperties.lcid,queryText:"",queryTimestamp:(new Date).getTime(),rowLimit:0,objectTypeFilter:"",isEchoScenario:!1,fetchTokenPromise:this.authTokenProvider(),enterpriseFeaturesEnabled:this.getEnterpriseFeaturesEnabled(),searchCorrelationId:t.interactionId,sessionId:this.applicationProperties.sessionId,correlationId:t.interactionId,serviceEndpoint:this.shredderServiceEndpoint,officePlatform:o.TAP_OFFICE_PLATFORM,officeScenario:o.TAP_OFFICE_SCENARIO,serviceEndpointPromise:this.getShredderServiceEndpointPromise()}},e}(u.TapMessageHandlerBase);e.TapMessageHandler=c},function(t,e,r){"use strict";r(178);var n=function(t){return t&&t.__esModule?t:{default:t}}(r(191));n.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),n.default._babelPolyfill=!0},function(t,e,r){"use strict";r(179),r(181),r(180),r(187),r(186),r(189),r(188),r(190),r(183),r(184),r(182),r(185),r(361),r(362)},function(t,e,r){r(333),r(272),r(274),r(273),r(276),r(278),r(283),r(277),r(275),r(285),r(284),r(280),r(281),r(279),r(271),r(282),r(286),r(287),r(238),r(240),r(239),r(289),r(288),r(259),r(269),r(270),r(260),r(261),r(262),r(263),r(264),r(265),r(266),r(267),r(268),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(258),r(320),r(325),r(332),r(323),r(315),r(316),r(321),r(326),r(328),r(311),r(312),r(313),r(314),r(317),r(318),r(319),r(322),r(324),r(327),r(329),r(330),r(331),r(233),r(235),r(234),r(237),r(236),r(222),r(220),r(226),r(223),r(229),r(231),r(219),r(225),r(216),r(230),r(214),r(228),r(227),r(221),r(224),r(213),r(215),r(218),r(217),r(232),r(98),r(304),r(135),r(309),r(136),r(305),r(306),r(307),r(308),r(134),r(241),r(310),r(345),r(346),r(334),r(335),r(340),r(343),r(344),r(338),r(341),r(339),r(342),r(336),r(337),r(290),r(291),r(292),r(293),r(294),r(297),r(295),r(296),r(298),r(299),r(300),r(301),r(303),r(302),t.exports=r(8)},function(t,e,r){r(347),t.exports=r(8).Array.flatMap},function(t,e,r){r(348),t.exports=r(8).Array.includes},function(t,e,r){r(349),t.exports=r(8).Object.entries},function(t,e,r){r(350),t.exports=r(8).Object.getOwnPropertyDescriptors},function(t,e,r){r(351),t.exports=r(8).Object.values},function(t,e,r){"use strict";r(134),r(352),t.exports=r(8).Promise.finally},function(t,e,r){r(353),t.exports=r(8).String.padEnd},function(t,e,r){r(354),t.exports=r(8).String.padStart},function(t,e,r){r(356),t.exports=r(8).String.trimRight},function(t,e,r){r(355),t.exports=r(8).String.trimLeft},function(t,e,r){r(357),t.exports=r(96).f("asyncIterator")},function(t,e,r){r(203),t.exports=r(104).global},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){var n=r(73);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,r){var n=r(192);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var n=r(73),i=r(72).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){var n=r(72),i=r(104),o=r(194),u=r(198),a=r(197),s=function(t,e,r){var c,f,l,d=t&s.F,p=t&s.G,h=t&s.S,v=t&s.P,g=t&s.B,y=t&s.W,I=p?i:i[e]||(i[e]={}),E=I.prototype,_=p?n:h?n[e]:(n[e]||{}).prototype;p&&(r=e);for(c in r)(f=!d&&_&&void 0!==_[c])&&a(I,c)||(l=f?_[c]:r[c],I[c]=p&&"function"!=typeof _[c]?r[c]:g&&f?o(l,n):y&&_[c]==l?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):v&&"function"==typeof l?o(Function.call,l):l,v&&((I.virtual||(I.virtual={}))[c]=l,t&s.R&&E&&!E[c]&&u(E,c,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(200),i=r(201);t.exports=r(71)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){t.exports=!r(71)&&!r(105)(function(){return 7!=Object.defineProperty(r(195)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(193),i=r(199),o=r(202),u=Object.defineProperty;e.f=r(71)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return u(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(73);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(196);n(n.G,{global:r(72)})},function(t,e,r){var n=r(5),i=r(59),o=r(6)("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){"use strict";var n=r(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,u=function(t){return t>9?t:"0"+t};t.exports=n(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!n(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),r=t.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}:o},function(t,e,r){"use strict";var n=r(2),i=r(28);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(n(this),"number"!=t)}},function(t,e,r){var n=r(35),i=r(61),o=r(51);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var u,a=r(t),s=o.f,c=0;a.length>c;)s.call(t,u=a[c++])&&e.push(u);return e}},function(t,e,r){"use strict";function n(t,e,r,c,f,l,d,p){for(var h,v,g=f,y=0,I=!!d&&a(d,p,3);y<c;){if(y in r){if(h=I?I(r[y],y,e):r[y],v=!1,o(h)&&(v=h[s],v=void 0!==v?!!v:i(h)),v&&l>0)g=n(t,e,h,u(h.length),g,l-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=h}g++}y++}return g}var i=r(59),o=r(5),u=r(7),a=r(20),s=r(6)("isConcatSpreadable");t.exports=n},function(t,e,r){t.exports=r(63)("native-function-to-string",Function.toString)},function(t,e,r){var n=r(86),i=Math.pow,o=i(2,-52),u=i(2,-23),a=i(2,127)*(2-u),s=i(2,-126),c=function(t){return t+1/o-1/o};t.exports=Math.fround||function(t){var e,r,i=Math.abs(t),f=n(t);return i<s?f*c(i/s/u)*s*u:(e=(1+u/o)*i,r=e-(e-i),r>a||r!=r?f*(1/0):f*r)}},function(t,e,r){var n=r(4),i=r(94).set,o=n.MutationObserver||n.WebKitMutationObserver,u=n.process,a=n.Promise,s="process"==r(24)(u);t.exports=function(){var t,e,r,c=function(){var n,i;for(s&&(n=u.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(s)r=function(){u.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var f=a.resolve(void 0);r=function(){f.then(c)}}else r=function(){i.call(n,c)};else{var l=!0,d=document.createTextNode("");new o(c).observe(d,{characterData:!0}),r=function(){d.data=l=!l}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){var n=r(0);n(n.P,"Array",{copyWithin:r(107)}),r(30)("copyWithin")},function(t,e,r){"use strict";var n=r(0),i=r(19)(4);n(n.P+n.F*!r(17)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,r){var n=r(0);n(n.P,"Array",{fill:r(75)}),r(30)("fill")},function(t,e,r){"use strict";var n=r(0),i=r(19)(2);n(n.P+n.F*!r(17)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(19)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),n(n.P+n.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(30)(o)},function(t,e,r){"use strict";var n=r(0),i=r(19)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(30)("find")},function(t,e,r){"use strict";var n=r(0),i=r(19)(0),o=r(17)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(20),i=r(0),o=r(11),u=r(116),a=r(82),s=r(7),c=r(76),f=r(97);i(i.S+i.F*!r(60)(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,i,l,d=o(t),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,g=void 0!==v,y=0,I=f(d);if(g&&(v=n(v,h>2?arguments[2]:void 0,2)),void 0==I||p==Array&&a(I))for(e=s(d.length),r=new p(e);e>y;y++)c(r,y,g?v(d[y],y):d[y]);else for(l=I.call(d),r=new p;!(i=l.next()).done;y++)c(r,y,g?u(l,v,[i.value,y],!0):i.value);return r.length=y,r}})},function(t,e,r){"use strict";var n=r(0),i=r(54)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(u||!r(17)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,r){var n=r(0);n(n.S,"Array",{isArray:r(59)})},function(t,e,r){"use strict";var n=r(0),i=r(16),o=[].join;n(n.P+n.F*(r(50)!=Object||!r(17)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,r){"use strict";var n=r(0),i=r(16),o=r(23),u=r(7),a=[].lastIndexOf,s=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(s||!r(17)(a)),"Array",{lastIndexOf:function(t){if(s)return a.apply(this,arguments)||0;var e=i(this),r=u(e.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},function(t,e,r){"use strict";var n=r(0),i=r(19)(1);n(n.P+n.F*!r(17)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(76);n(n.S+n.F*r(3)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,r=new("function"==typeof this?this:Array)(e);e>t;)i(r,t,arguments[t++]);return r.length=e,r}})},function(t,e,r){"use strict";var n=r(0),i=r(108);n(n.P+n.F*!r(17)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,r){"use strict";var n=r(0),i=r(108);n(n.P+n.F*!r(17)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,r){"use strict";var n=r(0),i=r(80),o=r(24),u=r(37),a=r(7),s=[].slice;n(n.P+n.F*r(3)(function(){i&&s.call(i)}),"Array",{slice:function(t,e){var r=a(this.length),n=o(this);if(e=void 0===e?r:e,"Array"==n)return s.call(this,t,e);for(var i=u(t,r),c=u(e,r),f=a(c-i),l=new Array(f),d=0;d<f;d++)l[d]="String"==n?this.charAt(i+d):this[i+d];return l}})},function(t,e,r){"use strict";var n=r(0),i=r(19)(3);n(n.P+n.F*!r(17)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,r){"use strict";var n=r(0),i=r(18),o=r(11),u=r(3),a=[].sort,s=[1,2,3];n(n.P+n.F*(u(function(){s.sort(void 0)})||!u(function(){s.sort(null)})||!r(17)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),i(t))}})},function(t,e,r){r(44)("Array")},function(t,e,r){var n=r(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,r){var n=r(0),i=r(205);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,r){"use strict";var n=r(0),i=r(11),o=r(28);n(n.P+n.F*r(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),r=o(e);return"number"!=typeof r||isFinite(r)?e.toISOString():null}})},function(t,e,r){var n=r(6)("toPrimitive"),i=Date.prototype;n in i||r(15)(i,n,r(206))},function(t,e,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r(12)(n,"toString",function(){var t=o.call(this);return t===t?i.call(this):"Invalid Date"})},function(t,e,r){var n=r(0);n(n.P,"Function",{bind:r(110)})},function(t,e,r){"use strict";var n=r(5),i=r(34),o=r(6)("hasInstance"),u=Function.prototype;o in u||r(10).f(u,o,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,r){var n=r(10).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||r(9)&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,r){"use strict";var n=r(111),i=r(39);t.exports=r(55)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(i(this,"Map"),0===t?0:t,e)}},n,!0)},function(t,e,r){var n=r(0),i=r(119),o=Math.sqrt,u=Math.acosh;n(n.S+n.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,r){function n(t){return isFinite(t=+t)&&0!=t?t<0?-n(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(0),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:n})},function(t,e,r){var n=r(0),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,r){var n=r(0),i=r(86);n(n.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,r){var n=r(0);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,r){var n=r(0),i=Math.exp;n(n.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,r){var n=r(0),i=r(85);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,r){var n=r(0);n(n.S,"Math",{fround:r(210)})},function(t,e,r){var n=r(0),i=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var r,n,o=0,u=0,a=arguments.length,s=0;u<a;)r=i(arguments[u++]),s<r?(n=s/r,o=o*n*n+1,s=r):r>0?(n=r/s,o+=n*n):o+=r;return s===1/0?1/0:s*Math.sqrt(o)}})},function(t,e,r){var n=r(0),i=Math.imul;n(n.S+n.F*r(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var r=+t,n=+e,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}})},function(t,e,r){var n=r(0);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,r){var n=r(0);n(n.S,"Math",{log1p:r(119)})},function(t,e,r){var n=r(0);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,r){var n=r(0);n(n.S,"Math",{sign:r(86)})},function(t,e,r){var n=r(0),i=r(85),o=Math.exp;n(n.S+n.F*r(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,r){var n=r(0),i=r(85),o=Math.exp;n(n.S,"Math",{tanh:function(t){var e=i(t=+t),r=i(-t);return e==1/0?1:r==1/0?-1:(e-r)/(o(t)+o(-t))}})},function(t,e,r){var n=r(0);n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,r){"use strict";var n=r(4),i=r(14),o=r(24),u=r(81),a=r(28),s=r(3),c=r(33).f,f=r(21).f,l=r(10).f,d=r(46).trim,p=n.Number,h=p,v=p.prototype,g="Number"==o(r(32)(v)),y="trim"in String.prototype,I=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){e=y?e.trim():d(e,3);var r,n,i,o=e.charCodeAt(0);if(43===o||45===o){if(88===(r=e.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+e}for(var u,s=e.slice(2),c=0,f=s.length;c<f;c++)if((u=s.charCodeAt(c))<48||u>i)return NaN;return parseInt(s,n)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof p&&(g?s(function(){v.valueOf.call(r)}):"Number"!=o(r))?u(new h(I(e)),r,p):I(e)};for(var E,_=r(9)?c(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;_.length>P;P++)i(h,E=_[P])&&!i(p,E)&&l(p,E,f(h,E));p.prototype=v,v.constructor=p,r(12)(n,"Number",p)}},function(t,e,r){var n=r(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,r){var n=r(0),i=r(4).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,r){var n=r(0);n(n.S,"Number",{isInteger:r(115)})},function(t,e,r){var n=r(0);n(n.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,r){var n=r(0),i=r(115),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,r){var n=r(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,r){var n=r(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,r){var n=r(0),i=r(127);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,r){var n=r(0),i=r(128);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,r){"use strict";var n=r(0),i=r(23),o=r(106),u=r(92),a=1..toFixed,s=Math.floor,c=[0,0,0,0,0,0],f="Number.toFixed: incorrect invocation!",l=function(t,e){for(var r=-1,n=e;++r<6;)n+=t*c[r],c[r]=n%1e7,n=s(n/1e7)},d=function(t){for(var e=6,r=0;--e>=0;)r+=c[e],c[e]=s(r/t),r=r%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var r=String(c[t]);e=""===e?r:e+u.call("0",7-r.length)+r}return e},h=function(t,e,r){return 0===e?r:e%2==1?h(t,e-1,r*t):h(t*t,e/2,r)},v=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e};n(n.P+n.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(3)(function(){a.call({})})),"Number",{toFixed:function(t){var e,r,n,a,s=o(this,f),c=i(t),g="",y="0";if(c<0||c>20)throw RangeError(f);if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(g="-",s=-s),s>1e-21)if(e=v(s*h(2,69,1))-69,r=e<0?s*h(2,-e,1):s/h(2,e,1),r*=4503599627370496,(e=52-e)>0){for(l(0,r),n=c;n>=7;)l(1e7,0),n-=7;for(l(h(10,n,1),0),n=e-1;n>=23;)d(1<<23),n-=23;d(1<<n),l(1,1),d(2),y=p()}else l(0,r),l(1<<-e,0),y=p()+u.call("0",c);return c>0?(a=y.length,y=g+(a<=c?"0."+u.call("0",c-a)+y:y.slice(0,a-c)+"."+y.slice(a-c))):y=g+y,y}})},function(t,e,r){"use strict";var n=r(0),i=r(3),o=r(106),u=1..toPrecision;n(n.P+n.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(e):u.call(e,t)}})},function(t,e,r){var n=r(0);n(n.S+n.F,"Object",{assign:r(121)})},function(t,e,r){var n=r(0);n(n.S,"Object",{create:r(32)})},function(t,e,r){var n=r(0);n(n.S+n.F*!r(9),"Object",{defineProperties:r(122)})},function(t,e,r){var n=r(0);n(n.S+n.F*!r(9),"Object",{defineProperty:r(10).f})},function(t,e,r){var n=r(5),i=r(27).onFreeze;r(22)("freeze",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(16),i=r(21).f;r(22)("getOwnPropertyDescriptor",function(){return function(t,e){return i(n(t),e)}})},function(t,e,r){r(22)("getOwnPropertyNames",function(){return r(123).f})},function(t,e,r){var n=r(11),i=r(34);r(22)("getPrototypeOf",function(){return function(t){return i(n(t))}})},function(t,e,r){var n=r(5);r(22)("isExtensible",function(t){return function(e){return!!n(e)&&(!t||t(e))}})},function(t,e,r){var n=r(5);r(22)("isFrozen",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,r){var n=r(5);r(22)("isSealed",function(t){return function(e){return!n(e)||!!t&&t(e)}})},function(t,e,r){var n=r(0);n(n.S,"Object",{is:r(130)})},function(t,e,r){var n=r(11),i=r(35);r(22)("keys",function(){return function(t){return i(n(t))}})},function(t,e,r){var n=r(5),i=r(27).onFreeze;r(22)("preventExtensions",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(5),i=r(27).onFreeze;r(22)("seal",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){var n=r(0);n(n.S,"Object",{setPrototypeOf:r(88).set})},function(t,e,r){"use strict";var n=r(49),i={};i[r(6)("toStringTag")]="z",i+""!="[object z]"&&r(12)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(t,e,r){var n=r(0),i=r(127);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},function(t,e,r){var n=r(0),i=r(128);n(n.G+n.F*(parseInt!=i),{parseInt:i})},function(t,e,r){var n=r(0),i=r(18),o=r(2),u=(r(4).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!r(3)(function(){u(function(){})}),"Reflect",{apply:function(t,e,r){var n=i(t),s=o(r);return u?u(n,e,s):a.call(n,e,s)}})},function(t,e,r){var n=r(0),i=r(32),o=r(18),u=r(2),a=r(5),s=r(3),c=r(110),f=(r(4).Reflect||{}).construct,l=s(function(){function t(){}return!(f(function(){},[],t)instanceof t)}),d=!s(function(){f(function(){})});n(n.S+n.F*(l||d),"Reflect",{construct:function(t,e){o(t),u(e);var r=arguments.length<3?t:o(arguments[2]);if(d&&!l)return f(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(c.apply(t,n))}var s=r.prototype,p=i(a(s)?s:Object.prototype),h=Function.apply.call(t,p,e);return a(h)?h:p}})},function(t,e,r){var n=r(10),i=r(0),o=r(2),u=r(28);i(i.S+i.F*r(3)(function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,r){o(t),e=u(e,!0),o(r);try{return n.f(t,e,r),!0}catch(t){return!1}}})},function(t,e,r){var n=r(0),i=r(21).f,o=r(2);n(n.S,"Reflect",{deleteProperty:function(t,e){var r=i(o(t),e);return!(r&&!r.configurable)&&delete t[e]}})},function(t,e,r){"use strict";var n=r(0),i=r(2),o=function(t){this._t=i(t),this._i=0;var e,r=this._k=[];for(e in t)r.push(e)};r(117)(o,"Object",function(){var t,e=this,r=e._k;do{if(e._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[e._i++])in e._t));return{value:t,done:!1}}),n(n.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,r){var n=r(21),i=r(0),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(o(t),e)}})},function(t,e,r){var n=r(0),i=r(34),o=r(2);n(n.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,r){function n(t,e){var r,a,f=arguments.length<3?t:arguments[2];return c(t)===f?t[e]:(r=i.f(t,e))?u(r,"value")?r.value:void 0!==r.get?r.get.call(f):void 0:s(a=o(t))?n(a,e,f):void 0}var i=r(21),o=r(34),u=r(14),a=r(0),s=r(5),c=r(2);a(a.S,"Reflect",{get:n})},function(t,e,r){var n=r(0);n(n.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,r){var n=r(0),i=r(2),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,r){var n=r(0);n(n.S,"Reflect",{ownKeys:r(126)})},function(t,e,r){var n=r(0),i=r(2),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,r){var n=r(0),i=r(88);i&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,r){function n(t,e,r){var s,d,p=arguments.length<4?t:arguments[3],h=o.f(f(t),e);if(!h){if(l(d=u(t)))return n(d,e,r,p);h=c(0)}if(a(h,"value")){if(!1===h.writable||!l(p))return!1;if(s=o.f(p,e)){if(s.get||s.set||!1===s.writable)return!1;s.value=r,i.f(p,e,s)}else i.f(p,e,c(0,r));return!0}return void 0!==h.set&&(h.set.call(p,r),!0)}var i=r(10),o=r(21),u=r(34),a=r(14),s=r(0),c=r(36),f=r(2),l=r(5);s(s.S,"Reflect",{set:n})},function(t,e,r){var n=r(4),i=r(81),o=r(10).f,u=r(33).f,a=r(83),s=r(57),c=n.RegExp,f=c,l=c.prototype,d=/a/g,p=/a/g,h=new c(d)!==d;if(r(9)&&(!h||r(3)(function(){return p[r(6)("match")]=!1,c(d)!=d||c(p)==p||"/a/i"!=c(d,"i")}))){c=function(t,e){var r=this instanceof c,n=a(t),o=void 0===e;return!r&&n&&t.constructor===c&&o?t:i(h?new f(n&&!o?t.source:t,e):f((n=t instanceof c)?t.source:t,n&&o?s.call(t):e),r?this:l,c)};for(var v=u(f),g=0;v.length>g;)!function(t){t in c||o(c,t,{configurable:!0,get:function(){return f[t]},set:function(e){f[t]=e}})}(v[g++]);l.constructor=c,c.prototype=l,r(12)(n,"RegExp",c)}r(44)("RegExp")},function(t,e,r){"use strict";var n=r(2),i=r(7),o=r(74),u=r(62);r(56)("match",1,function(t,e,r,a){return[function(r){var n=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,n):new RegExp(r)[e](String(n))},function(t){var e=a(r,t,this);if(e.done)return e.value;var s=n(t),c=String(this);if(!s.global)return u(s,c);var f=s.unicode;s.lastIndex=0;for(var l,d=[],p=0;null!==(l=u(s,c));){var h=String(l[0]);d[p]=h,""===h&&(s.lastIndex=o(c,i(s.lastIndex),f)),p++}return 0===p?null:d}]})},function(t,e,r){"use strict";var n=r(2),i=r(11),o=r(7),u=r(23),a=r(74),s=r(62),c=Math.max,f=Math.min,l=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};r(56)("replace",2,function(t,e,r,v){function g(t,e,n,o,u,a){var s=n+t.length,c=o.length,f=p;return void 0!==u&&(u=i(u),f=d),r.call(a,f,function(r,i){var a;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(s);case"<":a=u[i.slice(1,-1)];break;default:var f=+i;if(0===f)return r;if(f>c){var d=l(f/10);return 0===d?r:d<=c?void 0===o[d-1]?i.charAt(1):o[d-1]+i.charAt(1):r}a=o[f-1]}return void 0===a?"":a})}return[function(n,i){var o=t(this),u=void 0==n?void 0:n[e];return void 0!==u?u.call(n,o,i):r.call(String(o),n,i)},function(t,e){var i=v(r,t,this,e);if(i.done)return i.value;var l=n(t),d=String(this),p="function"==typeof e;p||(e=String(e));var y=l.global;if(y){var I=l.unicode;l.lastIndex=0}for(var E=[];;){var _=s(l,d);if(null===_)break;if(E.push(_),!y)break;""===String(_[0])&&(l.lastIndex=a(d,o(l.lastIndex),I))}for(var P="",S=0,A=0;A<E.length;A++){_=E[A];for(var T=String(_[0]),m=c(f(u(_.index),d.length),0),b=[],x=1;x<_.length;x++)b.push(h(_[x]));var C=_.groups;if(p){var R=[T].concat(b,m,d);void 0!==C&&R.push(C);var O=String(e.apply(void 0,R))}else O=g(T,d,m,b,C,e);m>=S&&(P+=d.slice(S,m)+O,S=m+T.length)}return P+d.slice(S)}]})},function(t,e,r){"use strict";var n=r(2),i=r(130),o=r(62);r(56)("search",1,function(t,e,r,u){return[function(r){var n=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,n):new RegExp(r)[e](String(n))},function(t){var e=u(r,t,this);if(e.done)return e.value;var a=n(t),s=String(this),c=a.lastIndex;i(c,0)||(a.lastIndex=0);var f=o(a,s);return i(a.lastIndex,c)||(a.lastIndex=c),null===f?-1:f.index}]})},function(t,e,r){"use strict";var n=r(83),i=r(2),o=r(52),u=r(74),a=r(7),s=r(62),c=r(87),f=r(3),l=Math.min,d=[].push,p="length",h=!f(function(){RegExp(4294967295,"y")});r(56)("split",2,function(t,e,r,f){var v;return v="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[p]||2!="ab".split(/(?:ab)*/)[p]||4!=".".split(/(.?)(.?)/)[p]||".".split(/()()/)[p]>1||"".split(/.?/)[p]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!n(t))return r.call(i,t,e);for(var o,u,a,s=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),l=0,h=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,f+"g");(o=c.call(v,i))&&!((u=v.lastIndex)>l&&(s.push(i.slice(l,o.index)),o[p]>1&&o.index<i[p]&&d.apply(s,o.slice(1)),a=o[0][p],l=u,s[p]>=h));)v.lastIndex===o.index&&v.lastIndex++;return l===i[p]?!a&&v.test("")||s.push(""):s.push(i.slice(l)),s[p]>h?s.slice(0,h):s}:"0".split(void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:r.call(this,t,e)}:r,[function(r,n){var i=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,i,n):v.call(String(i),r,n)},function(t,e){var n=f(v,t,this,e,v!==r);if(n.done)return n.value;var c=i(t),d=String(this),p=o(c,RegExp),g=c.unicode,y=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(h?"y":"g"),I=new p(h?c:"^(?:"+c.source+")",y),E=void 0===e?4294967295:e>>>0;if(0===E)return[];if(0===d.length)return null===s(I,d)?[d]:[];for(var _=0,P=0,S=[];P<d.length;){I.lastIndex=h?P:0;var A,T=s(I,h?d:d.slice(P));if(null===T||(A=l(a(I.lastIndex+(h?0:P)),d.length))===_)P=u(d,P,g);else{if(S.push(d.slice(_,P)),S.length===E)return S;for(var m=1;m<=T.length-1;m++)if(S.push(T[m]),S.length===E)return S;P=_=A}}return S.push(d.slice(_)),S}]})},function(t,e,r){"use strict";r(136);var n=r(2),i=r(57),o=r(9),u=/./.toString,a=function(t){r(12)(RegExp.prototype,"toString",t,!0)};r(3)(function(){return"/a/b"!=u.call({source:"a",flags:"b"})})?a(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=u.name&&a(function(){return u.call(this)})},function(t,e,r){"use strict";var n=r(111),i=r(39);t.exports=r(55)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"Set"),t=0===t?0:t,t)}},n)},function(t,e,r){"use strict";r(13)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,r){"use strict";r(13)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,r){"use strict";r(13)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,r){"use strict";r(13)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,r){"use strict";var n=r(0),i=r(90)(!1);n(n.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,r){"use strict";var n=r(0),i=r(7),o=r(91),u="".endsWith;n(n.P+n.F*r(79)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=i(e.length),a=void 0===r?n:Math.min(i(r),n),s=String(t);return u?u.call(e,s,a):e.slice(a-s.length,a)===s}})},function(t,e,r){"use strict";r(13)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,r){"use strict";r(13)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,r){"use strict";r(13)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,r){var n=r(0),i=r(37),o=String.fromCharCode,u=String.fromCodePoint;n(n.S+n.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var e,r=[],n=arguments.length,u=0;n>u;){if(e=+arguments[u++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");r.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return r.join("")}})},function(t,e,r){"use strict";var n=r(0),i=r(91);n(n.P+n.F*r(79)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,r){"use strict";r(13)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,r){"use strict";var n=r(90)(!0);r(84)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){"use strict";r(13)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,r){var n=r(0),i=r(16),o=r(7);n(n.S,"String",{raw:function(t){for(var e=i(t.raw),r=o(e.length),n=arguments.length,u=[],a=0;r>a;)u.push(String(e[a++])),a<n&&u.push(String(arguments[a]));return u.join("")}})},function(t,e,r){var n=r(0);n(n.P,"String",{repeat:r(92)})},function(t,e,r){"use strict";r(13)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,r){"use strict";var n=r(0),i=r(7),o=r(91),u="".startsWith;n(n.P+n.F*r(79)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return u?u.call(e,n,r):e.slice(r,r+n.length)===n}})},function(t,e,r){"use strict";r(13)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,r){"use strict";r(13)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,r){"use strict";r(13)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,r){"use strict";r(46)("trim",function(t){return function(){return t(this,3)}})},function(t,e,r){"use strict";var n=r(4),i=r(14),o=r(9),u=r(0),a=r(12),s=r(27).KEY,c=r(3),f=r(63),l=r(45),d=r(38),p=r(6),h=r(96),v=r(133),g=r(207),y=r(59),I=r(2),E=r(5),_=r(11),P=r(16),S=r(28),A=r(36),T=r(32),m=r(123),b=r(21),x=r(61),C=r(10),R=r(35),O=b.f,D=C.f,w=m.f,M=n.Symbol,F=n.JSON,N=F&&F.stringify,j=p("_hidden"),L=p("toPrimitive"),k={}.propertyIsEnumerable,U=f("symbol-registry"),G=f("symbols"),B=f("op-symbols"),H=Object.prototype,V="function"==typeof M&&!!x.f,W=n.QObject,Q=!W||!W.prototype||!W.prototype.findChild,q=o&&c(function(){return 7!=T(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=O(H,e);n&&delete H[e],D(t,e,r),n&&t!==H&&D(H,e,n)}:D,Y=function(t){var e=G[t]=T(M.prototype);return e._k=t,e},X=V&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},K=function(t,e,r){return t===H&&K(B,e,r),I(t),e=S(e,!0),I(r),i(G,e)?(r.enumerable?(i(t,j)&&t[j][e]&&(t[j][e]=!1),r=T(r,{enumerable:A(0,!1)})):(i(t,j)||D(t,j,A(1,{})),t[j][e]=!0),q(t,e,r)):D(t,e,r)},Z=function(t,e){I(t);for(var r,n=g(e=P(e)),i=0,o=n.length;o>i;)K(t,r=n[i++],e[r]);return t},J=function(t,e){return void 0===e?T(t):Z(T(t),e)},z=function(t){var e=k.call(this,t=S(t,!0));return!(this===H&&i(G,t)&&!i(B,t))&&(!(e||!i(this,t)||!i(G,t)||i(this,j)&&this[j][t])||e)},$=function(t,e){if(t=P(t),e=S(e,!0),t!==H||!i(G,e)||i(B,e)){var r=O(t,e);return!r||!i(G,e)||i(t,j)&&t[j][e]||(r.enumerable=!0),r}},tt=function(t){for(var e,r=w(P(t)),n=[],o=0;r.length>o;)i(G,e=r[o++])||e==j||e==s||n.push(e);return n},et=function(t){for(var e,r=t===H,n=w(r?B:P(t)),o=[],u=0;n.length>u;)!i(G,e=n[u++])||r&&!i(H,e)||o.push(G[e]);return o};V||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===H&&e.call(B,r),i(this,j)&&i(this[j],t)&&(this[j][t]=!1),q(this,t,A(1,r))};return o&&Q&&q(H,t,{configurable:!0,set:e}),Y(t)},a(M.prototype,"toString",function(){return this._k}),b.f=$,C.f=K,r(33).f=m.f=tt,r(51).f=z,x.f=et,o&&!r(31)&&a(H,"propertyIsEnumerable",z,!0),h.f=function(t){return Y(p(t))}),u(u.G+u.W+u.F*!V,{Symbol:M});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;rt.length>nt;)p(rt[nt++]);for(var it=R(p.store),ot=0;it.length>ot;)v(it[ot++]);u(u.S+u.F*!V,"Symbol",{for:function(t){return i(U,t+="")?U[t]:U[t]=M(t)},keyFor:function(t){if(!X(t))throw TypeError(t+" is not a symbol!");for(var e in U)if(U[e]===t)return e},useSetter:function(){Q=!0},useSimple:function(){Q=!1}}),u(u.S+u.F*!V,"Object",{create:J,defineProperty:K,defineProperties:Z,getOwnPropertyDescriptor:$,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var ut=c(function(){x.f(1)});u(u.S+u.F*ut,"Object",{getOwnPropertySymbols:function(t){return x.f(_(t))}}),F&&u(u.S+u.F*(!V||c(function(){var t=M();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(E(e)||void 0!==t)&&!X(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!X(e))return e}),n[1]=e,N.apply(F,n)}}),M.prototype[L]||r(15)(M.prototype,L,M.prototype.valueOf),l(M,"Symbol"),l(Math,"Math",!0),l(n.JSON,"JSON",!0)},function(t,e,r){"use strict";var n=r(0),i=r(64),o=r(95),u=r(2),a=r(37),s=r(7),c=r(5),f=r(4).ArrayBuffer,l=r(52),d=o.ArrayBuffer,p=o.DataView,h=i.ABV&&f.isView,v=d.prototype.slice,g=i.VIEW;n(n.G+n.W+n.F*(f!==d),{ArrayBuffer:d}),n(n.S+n.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return h&&h(t)||c(t)&&g in t}}),n(n.P+n.U+n.F*r(3)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(u(this),t);for(var r=u(this).byteLength,n=a(t,r),i=a(void 0===e?r:e,r),o=new(l(this,d))(s(i-n)),c=new p(this),f=new p(o),h=0;n<i;)f.setUint8(h++,c.getUint8(n++));return o}}),r(44)("ArrayBuffer")},function(t,e,r){var n=r(0);n(n.G+n.W+n.F*!r(64).ABV,{DataView:r(95).DataView})},function(t,e,r){r(26)("Float32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Float64",8,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Int16",2,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Int32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Int8",1,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint16",2,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint32",4,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint8",1,function(t){return function(e,r,n){return t(this,e,r,n)}})},function(t,e,r){r(26)("Uint8",1,function(t){return function(e,r,n){return t(this,e,r,n)}},!0)},function(t,e,r){"use strict";var n,i=r(4),o=r(19)(0),u=r(12),a=r(27),s=r(121),c=r(112),f=r(5),l=r(39),d=r(39),p=!i.ActiveXObject&&"ActiveXObject"in i,h=a.getWeak,v=Object.isExtensible,g=c.ufstore,y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},I={get:function(t){if(f(t)){var e=h(t);return!0===e?g(l(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(l(this,"WeakMap"),t,e)}},E=t.exports=r(55)("WeakMap",y,I,c,!0,!0);d&&p&&(n=c.getConstructor(y,"WeakMap"),s(n.prototype,I),a.NEED=!0,o(["delete","has","get","set"],function(t){var e=E.prototype,r=e[t];u(e,t,function(e,i){if(f(e)&&!v(e)){this._f||(this._f=new n);var o=this._f[t](e,i);return"set"==t?this:o}return r.call(this,e,i)})}))},function(t,e,r){"use strict";var n=r(112),i=r(39);r(55)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"WeakSet"),t,!0)}},n,!1,!0)},function(t,e,r){"use strict";var n=r(0),i=r(208),o=r(11),u=r(7),a=r(18),s=r(109);n(n.P,"Array",{flatMap:function(t){var e,r,n=o(this);return a(t),e=u(n.length),r=s(n,0),i(r,n,n,e,0,1,t,arguments[1]),r}}),r(30)("flatMap")},function(t,e,r){"use strict";var n=r(0),i=r(54)(!0);n(n.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(30)("includes")},function(t,e,r){var n=r(0),i=r(125)(!0);n(n.S,"Object",{entries:function(t){return i(t)}})},function(t,e,r){var n=r(0),i=r(126),o=r(16),u=r(21),a=r(76);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,r,n=o(t),s=u.f,c=i(n),f={},l=0;c.length>l;)void 0!==(r=s(n,e=c[l++]))&&a(f,e,r);return f}})},function(t,e,r){var n=r(0),i=r(125)(!1);n(n.S,"Object",{values:function(t){return i(t)}})},function(t,e,r){"use strict";var n=r(0),i=r(8),o=r(4),u=r(52),a=r(129);n(n.P+n.R,"Promise",{finally:function(t){var e=u(this,i.Promise||o.Promise),r="function"==typeof t;return this.then(r?function(r){return a(e,t()).then(function(){return r})}:t,r?function(r){return a(e,t()).then(function(){throw r})}:t)}})},function(t,e,r){"use strict";var n=r(0),i=r(131),o=r(65),u=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*u,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,r){"use strict";var n=r(0),i=r(131),o=r(65),u=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*u,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,r){"use strict";r(46)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,r){"use strict";r(46)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,r){r(133)("asyncIterator")},function(t,e,r){for(var n=r(98),i=r(35),o=r(12),u=r(4),a=r(15),s=r(42),c=r(6),f=c("iterator"),l=c("toStringTag"),d=s.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=i(p),v=0;v<h.length;v++){var g,y=h[v],I=p[y],E=u[y],_=E&&E.prototype;if(_&&(_[f]||a(_,f,d),_[l]||a(_,l,y),s[y]=d,I))for(g in n)_[g]||o(_,g,n[g],!0)}},function(t,e,r){var n=r(0),i=r(94);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,r){var n=r(4),i=r(0),o=r(65),u=[].slice,a=/MSIE .\./.test(o),s=function(t){return function(e,r){var n=arguments.length>2,i=!!n&&u.call(arguments,2);return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,r)}};i(i.G+i.B+i.F*a,{setTimeout:s(n.setTimeout),setInterval:s(n.setInterval)})},function(t,e,r){r(360),r(359),r(358),t.exports=r(8)},function(t,e,r){var n=function(t){"use strict";function e(t,e,r,i){var o=e&&e.prototype instanceof n?e:n,u=Object.create(o.prototype),a=new d(i||[]);return u._invoke=s(t,r,a),u}function r(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function n(){}function i(){}function o(){}function u(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function a(t,e){function n(i,o,u,a){var s=r(t[i],t,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&y.call(f,"__await")?e.resolve(f.__await).then(function(t){n("next",t,u,a)},function(t){n("throw",t,u,a)}):e.resolve(f).then(function(t){c.value=t,u(c)},function(t){return n("throw",t,u,a)})}a(s.arg)}function i(t,r){function i(){return new e(function(e,i){n(t,r,e,i)})}return o=o?o.then(i,i):i()}var o;this._invoke=i}function s(t,e,n){var i=S;return function(o,u){if(i===T)throw new Error("Generator is already running");if(i===m){if("throw"===o)throw u;return h()}for(n.method=o,n.arg=u;;){var a=n.delegate;if(a){var s=c(a,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===S)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=T;var f=r(t,e,n);if("normal"===f.type){if(i=n.done?m:A,f.arg===b)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(i=m,n.method="throw",n.arg=f.arg)}}}function c(t,e){var n=t.iterator[e.method];if(n===v){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=v,c(t,e),"throw"===e.method))return b;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,b;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=v),e.delegate=null,b):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}function f(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function l(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(f,this),this.reset(!0)}function p(t){if(t){var e=t[E];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(y.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=v,e.done=!0,e};return n.next=n}}return{next:h}}function h(){return{value:v,done:!0}}var v,g=Object.prototype,y=g.hasOwnProperty,I="function"==typeof Symbol?Symbol:{},E=I.iterator||"@@iterator",_=I.asyncIterator||"@@asyncIterator",P=I.toStringTag||"@@toStringTag";t.wrap=e;var S="suspendedStart",A="suspendedYield",T="executing",m="completed",b={},x={};x[E]=function(){return this};var C=Object.getPrototypeOf,R=C&&C(C(p([])));R&&R!==g&&y.call(R,E)&&(x=R);var O=o.prototype=n.prototype=Object.create(x);return i.prototype=O.constructor=o,o.constructor=i,o[P]=i.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===i||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,o):(t.__proto__=o,P in t||(t[P]="GeneratorFunction")),t.prototype=Object.create(O),t},t.awrap=function(t){return{__await:t}},u(a.prototype),a.prototype[_]=function(){return this},t.AsyncIterator=a,t.async=function(r,n,i,o,u){void 0===u&&(u=Promise);var s=new a(e(r,n,i,o),u);return t.isGeneratorFunction(n)?s:s.next().then(function(t){return t.done?t.value:s.next()})},u(O),O[P]="Generator",O[E]=function(){return this},O.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(l),!t)for(var e in this)"t"===e.charAt(0)&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=v)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return o.type="throw",o.arg=t,r.next=e,n&&(r.method="next",r.arg=v),!!n}if(this.done)throw t;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var u=y.call(i,"catchLoc"),a=y.call(i,"finallyLoc");if(u&&a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&y.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),l(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;l(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:p(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=v),b}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=r(53),o=r(66),u=r(138),a=r(29),s=r(67),c=r(366),f=r(47),l=r(147),d=r(150),p=r(69),h=r(367),v=function(t){function e(e,r,n,a){var p=t.call(this,r,n,a)||this,v={shouldQueryMatchQfDocumentTitle:e.enableDocumentTitleExactMatch};p.intelligenceHub=new l.IntelligenceHub(new d.SmartLookupRanker(p.logger,v),p.logger),p.intentClassifier=new l.IntentClassifier(p.intelligenceHub,[new c.InsightsMessageHandler(n),new h.TapMessageHandler(n,a,p.logger)],p.logger);var g=[new f.InsightsProvider(p.logger),new i.TapQFProvider(p.logger),new o.DictionaryProvider(p.logger),new s.ImagesProvider(p.logger),e.useQFAndOLSProvider?new i.TapQFAndOLSProvider(p.logger):new i.TapOLSProvider(p.logger),new i.TapSPProvider(p.logger)];return e.enableHubble&&g.push(new u.HubbleProvider(p.logger)),g.forEach(function(t){return p.intelligenceHub.registerProvider(t)}),p}return n(e,t),e.setup=function(t,r,n,i){if(!n)throw new Error("applicationProperties is undefined");var o={};return o=t||{enableDocumentTitleExactMatch:!1,enableHubble:!1,useQFAndOLSProvider:!1},new e(o,new p.Logger([new a.ULSLogger(r,a.ULSCat.msoulscat_Wac_Infrared)]),n,i)},e.prototype.updateContext=function(t){this.intelligenceHub.updateContext(t)},e.prototype.startUserInteractionSession=function(t){this.intentClassifier.startUserInteractionSession(t)},e.prototype.endUserInteractionSession=function(){this.intentClassifier.endUserInteractionSession()},e.prototype.logUserAction=function(t){this.intentClassifier.logUserAction(t)},e}(a.InfraredConnector);e.SmartLookupInfraredConnector=v},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(364);e.SmartLookupInfraredConnector=n.SmartLookupInfraredConnector;var i=r(150);e.SmartLookupRanker=i.SmartLookupRanker;var o=r(1);e.ProviderErrorType=o.ProviderErrorType,e.ProviderResultStatus=o.ProviderResultStatus,e.SamplingPolicy=o.SamplingPolicy,e.LoggingLevel=o.LoggingLevel;var u=r(53);e.TapAdditionalInfo=u.TapAdditionalInfo,e.TapProviderIdentifier=u.TapProviderIdentifier,e.TapEntityGroup=u.TapEntityGroup,e.TAP_TOKEN_END_POINT=u.TAP_TOKEN_END_POINT;var a=r(138);e.HubbleAdditionalInfo=a.HubbleAdditionalInfo,e.HubbleProviderIdentifier=a.HubbleProviderIdentifier,e.HubbleEntityGroup=a.HubbleEntityGroup;var s=r(47);e.InsightsAdditionalInfo=s.InsightsAdditionalInfo,e.InsightsProviderIdentifier=s.InsightsProviderIdentifier,e.InsightsEntityGroup=s.InsightsEntityGroup;var c=r(67);e.ImagesAdditionalInfo=c.ImagesAdditionalInfo,e.ImagesProviderIdentifier=c.ImagesProviderIdentifier,e.ImagesEntityGroup=c.ImagesEntityGroup;var f=r(66);e.DictionaryAdditionalInfo=f.DictionaryAdditionalInfo,e.DictionaryProviderIdentifier=f.DictionaryProviderIdentifier,e.DictionaryEntityGroup=f.DictionaryEntityGroup},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(29),u=r(47),a=function(t){function e(e){var r=t.call(this)||this;return r.applicationProperties=e,r}return n(e,t),e.prototype.convertMessage=function(t,e){var r=i({},e);return this.handleSmartLookupExecuteAction(r,t.data),r},e.prototype.handleSmartLookupExecuteAction=function(t,e){e?this.updateUciContext(t,e):this.clearUciContext(t)},e.prototype.updateUciContext=function(t,e){e&&(t.imagesContext={ImageSearchQuery:"",License:"",Offset:0,Count:this.numberOfImages},t.insightsContext={QueryTimestamp:Date.now(),App:this.applicationProperties.appName+this.applicationProperties.appPlatform,Neighborhood:e.Selection.Neighborhood,MentionStart:e.Selection.MentionStart,MentionLength:e.Selection.MentionLength,Market:this.applicationProperties.market,UiLanguage:this.applicationProperties.uiLanguage,ParentalControl:this.parentalControl,CallSatori:!!this.applicationProperties.uiLanguage&&u.SatoriSupportedLanguages.indexOf(this.applicationProperties.uiLanguage.toLowerCase())>-1,correlationId:t.interactionId,clientType:this.clientType,sessionId:this.applicationProperties.sessionId,TransactionId:t.transactionId})},e}(o.InsightsMessageHandlerBase);e.InsightsMessageHandler=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(53),u=r(29),a=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return n(e,t),e.prototype.convertMessage=function(t,e){var r=i({},e);return this.handleSmartLookupSearch(r,t.data),r},e.prototype.handleSmartLookupSearch=function(t,e){e?this.updateTapContext(t,e):this.clearTapContext(t)},e.prototype.updateTapContext=function(t,e){(e||e.Selection)&&(t.tapContext={tenant:this.shredderSharepointTenantRoot,lcid:this.applicationProperties.lcid,queryText:e.Selection.Neighborhood,queryTimestamp:Date.now(),rowLimit:0,objectTypeFilter:"",isEchoScenario:!1,fetchTokenPromise:this.authTokenProvider(),enterpriseFeaturesEnabled:this.getEnterpriseFeaturesEnabled(),searchCorrelationId:t.interactionId,sessionId:this.applicationProperties.sessionId,correlationId:t.interactionId,serviceEndpoint:this.shredderServiceEndpoint,officePlatform:o.TAP_OFFICE_PLATFORM,officeScenario:o.TAP_OFFICE_SCENARIO,serviceEndpointPromise:this.getShredderServiceEndpointPromise()})},e}(u.TapMessageHandlerBase);e.TapMessageHandler=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.HubbleAdditionalInfo=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_HUBBLE_URL="https://hubble.officeapps.live.com/mediasvc/api/media/search",e.HUBBLE_REQUEST_HEADERS={"Content-Type":"application/json; charset=utf-8","Access-Control-Allow-Origin":"*"},e.ImagePartThumbnailCategory="Thumbnail",e.TextPartTitleCategory="Title"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(369),i=r(373),o=r(137),u=r(1),a=r(48),s=function(){function t(t){this.logger=t,this.providerId=u.HubbleProviderIdentifier.HUBBLE_PROVIDER_ID,this.configuration={}}return t.prototype.shouldExecute=function(t){var e=t;return void 0!=e.hubbleContext&&void 0!=e.hubbleContext.query},t.prototype.getContextHash=function(t){var e=t;return e.hubbleContext?e.hubbleContext.query+e.hubbleContext.queryTimestamp:void 0},t.prototype.getProviderRequest=function(t){var e=t,r="?"+i.stringify(e.hubbleContext);return{url:n.API_HUBBLE_URL+r,method:"GET",headers:n.HUBBLE_REQUEST_HEADERS}},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:u.ProviderResultStatus.Error,statusCode:e,error:{errorType:u.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:u.ProviderResultStatus.Success,additionalInfo:this.parseHubbleAdditionalInfo(t,e),entityGroups:this.parseEntityGroups(t)}},t.prototype.getResults=function(t,e){var r=this,n=this.getProviderRequest(t);a.ProviderUtils.fetchProviderResult(n.url,{method:n.method,headers:n.headers},t,this.logger,this.providerId,function(t,e){return{providerId:r.providerId,resultStatus:u.ProviderResultStatus.Success,additionalInfo:r.parseHubbleAdditionalInfo(t,e),entityGroups:r.parseEntityGroups(t)}}).then(function(t){e(t)})},t.prototype.parseHubbleAdditionalInfo=function(t,e){return{providerId:u.HubbleProviderIdentifier.HUBBLE_PROVIDER_ID,statusCode:e,resultTimestamp:Date.now(),hubbleError:t.Error,sharedImageParts:t.Result?t.Result.SharedImageParts:void 0,sharedTextParts:t.Result?t.Result.SharedTextParts:void 0,nextDescriptor:t.Result?t.Result.NextDescriptor:void 0,nextUrl:t.Result?t.Result.NextUrl:void 0,diagnostic:t.Diagnostic,status:t.Status}},t.prototype.parseEntityGroups=function(t){var e=[];return t.Result&&t.Result.PartGroups&&t.Result.PartGroups.length>0&&e.push(new o.HubbleEntityGroup(u.HubbleProviderIdentifier.HUBBLE_IMAGES_GROUP_ID,t.Result.PartGroups)),e},t}();e.HubbleProvider=s},function(t,e,r){"use strict";function n(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],n(r),n(i))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(u),r=1;r<e.length;r++)t=n(e,r).join(""),e=t.match(u);return t}}function o(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=a.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=i(r[0]);n!==r[0]&&(e[r[0]]=n)}r=a.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),u=0;u<o.length;u++){var s=o[u];t=t.replace(new RegExp(s,"g"),e[s])}return t}var u=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return o(t)}}},function(t,e,r){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,s=n(t),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var f in r)o.call(r,f)&&(s[f]=r[f]);if(i){a=i(r);for(var l=0;l<a.length;l++)u.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},function(t,e,r){"use strict";function n(t){switch(t.arrayFormat){case"index":return function(e,r,n){return null===r?[o(e,t),"[",n,"]"].join(""):[o(e,t),"[",o(n,t),"]=",o(r,t)].join("")};case"bracket":return function(e,r){return null===r?o(e,t):[o(e,t),"[]=",o(r,t)].join("")};default:return function(e,r){return null===r?o(e,t):[o(e,t),"=",o(r,t)].join("")}}}function i(t){var e;switch(t.arrayFormat){case"index":return function(t,r,n){if(e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),!e)return void(n[t]=r);void 0===n[t]&&(n[t]={}),n[t][e[1]]=r};case"bracket":return function(t,r,n){return e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0===n[t]?void(n[t]=[r]):void(n[t]=[].concat(n[t],r)):void(n[t]=r)};default:return function(t,e,r){if(void 0===r[t])return void(r[t]=e);r[t]=[].concat(r[t],e)}}}function o(t,e){return e.encode?e.strict?c(t):encodeURIComponent(t):t}function u(t){return Array.isArray(t)?t.sort():"object"==typeof t?u(Object.keys(t)).sort(function(t,e){return Number(t)-Number(e)}).map(function(e){return t[e]}):t}function a(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function s(t,e){e=f({arrayFormat:"none"},e);var r=i(e),n=Object.create(null);return"string"!=typeof t?n:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach(function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),o=e.length>0?e.join("="):void 0;o=void 0===o?null:l(o),r(l(i),o,n)}),Object.keys(n).sort().reduce(function(t,e){var r=n[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=u(r):t[e]=r,t},Object.create(null))):n}var c=r(374),f=r(372),l=r(371);e.extract=a,e.parse=s,e.stringify=function(t,e){e=f({encode:!0,strict:!0,arrayFormat:"none"},e),!1===e.sort&&(e.sort=function(){});var r=n(e);return t?Object.keys(t).sort(e.sort).map(function(n){var i=t[n];if(void 0===i)return"";if(null===i)return o(n,e);if(Array.isArray(i)){var u=[];return i.slice().forEach(function(t){void 0!==t&&u.push(r(n,t,u.length))}),u.join("&")}return o(n,e)+"="+o(i,e)}).filter(function(t){return t.length>0}).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:s(a(t),e)}}},function(t,e,r){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.MakeItVisualAdditionalInfo=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_MAKE_IT_VISUAL_URL="https://augmentation.osi.office.net/officeaugmentation/augmentation/v1",e.MAKE_IT_VISUAL_REQUEST_HEADERS={"Content-Type":"application/x-www-form-urlencoded"},e.MAKE_IT_VISUAL_PROVIDER_TIMEOUT=5e3,e.MAKE_IT_VISUAL_PROVIDER_MAX_TEXT_LENGTH=8e3,e.MakeItVisualDefaultQueryParams={App:"POWERPNT",ContentType:"Document",GetKeyPhrases:"true",GetSnippets:"false",GetEntities:"true"}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(376),o=r(381),u=r(139),a=r(1),s=r(48),c=function(){function t(t){this.logger=t,this.providerId=a.MakeItVisualProviderIdentifier.MAKE_IT_VISUAL_PROVIDER_ID,this.configuration={resultTimeout:i.MAKE_IT_VISUAL_PROVIDER_TIMEOUT}}return t.prototype.shouldExecute=function(t){return void 0!=t.makeItVisualContext&&void 0!=t.makeItVisualContext.canMakeCall&&void 0!=t.makeItVisualContext.updateTimestamp&&void 0!=t.makeItVisualContext.slideId&&void 0!=t.makeItVisualContext.slideTokens&&void 0!=t.makeItVisualContext.paragraphs&&t.makeItVisualContext.paragraphs.length>0},t.prototype.getContextHash=function(t){return t.makeItVisualContext.slideId+t.makeItVisualContext.updateTimestamp.toString()},t.prototype.getProviderRequest=function(t){var e=t,r=e.makeItVisualContext.paragraphs.join("\n").substring(0,i.MAKE_IT_VISUAL_PROVIDER_MAX_TEXT_LENGTH),u=n({},i.MakeItVisualDefaultQueryParams,{Text:r}),a=o.stringify(u),s=i.MAKE_IT_VISUAL_REQUEST_HEADERS;return{url:i.API_MAKE_IT_VISUAL_URL,method:"POST",headers:s,body:a}},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:a.ProviderResultStatus.Error,statusCode:e,error:{errorType:a.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:a.ProviderResultStatus.Success,statusCode:e,additionalInfo:this.getAdditionalInfo(),entityGroups:this.parseEntityGroups(t)}},t.prototype.getResults=function(t,e){var r=this,n=this.getProviderRequest(t);s.ProviderUtils.fetchProviderResult(n.url,{method:n.method,headers:n.headers,body:n.body},t,this.logger,this.providerId,function(t,e){return{providerId:r.providerId,resultStatus:a.ProviderResultStatus.Success,statusCode:e,additionalInfo:r.getAdditionalInfo(),entityGroups:r.parseEntityGroups(t)}}).then(function(t){e(t)})},t.prototype.getAdditionalInfo=function(){return{resultTimestamp:Date.now()}},t.prototype.parseEntityGroups=function(t){var e=[];return(t.KeyPhrases&&t.KeyPhrases.length>0||t.Entities&&t.Entities.length>0)&&e.push(new u.MakeItVisualEntityGroup(t.Entities,t.KeyPhrases)),e},t}();e.MakeItVisualProvider=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(375);e.MakeItVisualAdditionalInfo=n.MakeItVisualAdditionalInfo;var i=r(139);e.MakeItVisualEntityGroup=i.MakeItVisualEntityGroup;var o=r(377);e.MakeItVisualProvider=o.MakeItVisualProvider},function(t,e,r){"use strict";function n(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],n(r),n(i))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(u),r=1;r<e.length;r++)t=n(e,r).join(""),e=t.match(u);return t}}function o(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=a.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=i(r[0]);n!==r[0]&&(e[r[0]]=n)}r=a.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),u=0;u<o.length;u++){var s=o[u];t=t.replace(new RegExp(s,"g"),e[s])}return t}var u=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return o(t)}}},function(t,e,r){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,s=n(t),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var f in r)o.call(r,f)&&(s[f]=r[f]);if(i){a=i(r);for(var l=0;l<a.length;l++)u.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},function(t,e,r){"use strict";function n(t){switch(t.arrayFormat){case"index":return function(e,r,n){return null===r?[o(e,t),"[",n,"]"].join(""):[o(e,t),"[",o(n,t),"]=",o(r,t)].join("")};case"bracket":return function(e,r){return null===r?o(e,t):[o(e,t),"[]=",o(r,t)].join("")};default:return function(e,r){return null===r?o(e,t):[o(e,t),"=",o(r,t)].join("")}}}function i(t){var e;switch(t.arrayFormat){case"index":return function(t,r,n){if(e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),!e)return void(n[t]=r);void 0===n[t]&&(n[t]={}),n[t][e[1]]=r};case"bracket":return function(t,r,n){return e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0===n[t]?void(n[t]=[r]):void(n[t]=[].concat(n[t],r)):void(n[t]=r)};default:return function(t,e,r){if(void 0===r[t])return void(r[t]=e);r[t]=[].concat(r[t],e)}}}function o(t,e){return e.encode?e.strict?c(t):encodeURIComponent(t):t}function u(t){return Array.isArray(t)?t.sort():"object"==typeof t?u(Object.keys(t)).sort(function(t,e){return Number(t)-Number(e)}).map(function(e){return t[e]}):t}function a(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function s(t,e){e=f({arrayFormat:"none"},e);var r=i(e),n=Object.create(null);return"string"!=typeof t?n:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach(function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),o=e.length>0?e.join("="):void 0;o=void 0===o?null:l(o),r(l(i),o,n)}),Object.keys(n).sort().reduce(function(t,e){var r=n[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=u(r):t[e]=r,t},Object.create(null))):n}var c=r(382),f=r(380),l=r(379);e.extract=a,e.parse=s,e.stringify=function(t,e){e=f({encode:!0,strict:!0,arrayFormat:"none"},e),!1===e.sort&&(e.sort=function(){});var r=n(e);return t?Object.keys(t).sort(e.sort).map(function(n){var i=t[n];if(void 0===i)return"";if(null===i)return o(n,e);if(Array.isArray(i)){var u=[];return i.slice().forEach(function(t){void 0!==t&&u.push(r(n,t,u.length))}),u.join("&")}return o(n,e)+"="+o(i,e)}).filter(function(t){return t.length>0}).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:s(a(t),e)}}},function(t,e,r){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.TapAdditionalInfo=n},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(387),u=r(140),a=r(141),s=r(1),c=r(48),f=function(){function t(t,e,r,n){this.logger=e,this.configuration=r,this.flights=n,this.providerId=t}return t.prototype.shouldExecute=function(t){var e=t;return!!(t&&e.tapContext&&e.tapContext.queryText&&e.tapContext.fetchTokenPromise&&e.tapContext.enterpriseFeaturesEnabled)},t.prototype.getContextHash=function(t){var e=t;return e.tapContext?e.tapContext.queryText+e.tapContext.queryTimestamp:void 0},t.prototype.executeProvider=function(t,e){var r=this,n=t;null==n.tapContext.fetchTokenPromise&&e(this.getAuthenticationErrorResult("Empty Token Promise")),n.tapContext.fetchTokenPromise.then(function(i){if(i){n.tapContext.authToken=i;var o=r.getProviderRequest(t);c.ProviderUtils.fetchProviderResult(o.url,{method:o.method,headers:o.headers},t,r.logger,r.providerId,function(t,e){return{providerId:r.providerId,resultStatus:s.ProviderResultStatus.Success,statusCode:e,additionalInfo:r.parseTapAdditionalInfo(t),entityGroups:r.parseEntityGroups(t)}},r.configuration&&r.configuration.fetchOverride).then(function(t){e(t)})}else e(r.getAuthenticationErrorResult("Empty Token"))}).catch(function(t){e(r.getAuthenticationErrorResult(t))})},t.prototype.getProviderRequest=function(t){var e=t,r={tenant:e.tapContext.tenant,lcid:e.tapContext.lcid,querytext:e.tapContext.queryText,rowLimit:e.tapContext.rowLimit,objectTypeFilter:e.tapContext.objectTypeFilter,isEchoScenario:e.tapContext.isEchoScenario},n="?"+o.stringify(r);return{url:e.tapContext.serviceEndpoint+u.API_TAP_URI+n,method:"GET",headers:i({},u.TAP_REQUEST_HEADERS,(a={},a[u.TAP_HEADER_NAME_FLIGHTS]=this.flights,a[u.TAP_HEADER_NAME_SESSIONID]=e.tapContext.sessionId,a[u.TAP_HEADER_NAME_CORRELATIONID]=e.tapContext.correlationId,a[u.TAP_HEADER_NAME_SEARCHCORRELATIONID]=e.tapContext.searchCorrelationId,a[u.TAP_HEADER_NAME_OFFICE_PLATFORM]=e.tapContext.officePlatform?e.tapContext.officePlatform:"",a[u.TAP_HEADER_NAME_OFFICE_SCENARIO]=e.tapContext.officeScenario?e.tapContext.officeScenario:"",a[u.TAP_HEADER_NAME_AUTHORIZATION]="Bearer "+e.tapContext.authToken,a))};var a},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:s.ProviderResultStatus.Error,statusCode:e,error:{errorType:s.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:s.ProviderResultStatus.Success,statusCode:e,additionalInfo:this.parseTapAdditionalInfo(t),entityGroups:this.parseEntityGroups(t)}},t.prototype.getResults=function(t,e){var r=this,n=t;if(void 0==n.tapContext.tenant&&void 0==n.tapContext.serviceEndpoint)if(null!=n.tapContext.tenantPromise&&null!=n.tapContext.serviceEndpointPromise)try{Promise.all([n.tapContext.tenantPromise,n.tapContext.serviceEndpointPromise]).then(function(t){n.tapContext.tenant=t[0],n.tapContext.serviceEndpoint=t[1],null==t[0]||void 0==t[0]||null==t[1]||void 0==t[1]?(r.logger.error(595919120,"Empty Tenant and Endpoint"),e({providerId:r.providerId,resultStatus:s.ProviderResultStatus.Error,error:{errorType:s.ProviderErrorType.ServiceError}})):r.executeProvider(n,e)}).catch(function(t){r.logger.error(595932804,"Exception while processing TapProvider GetResults",{message:t.message,stack:t.stack}),e({providerId:r.providerId,resultStatus:s.ProviderResultStatus.Error,error:{errorType:s.ProviderErrorType.ServiceError,detail:t}})})}catch(t){this.logger.error(595919121,"Exception while processing getResults of TapProvider",t),e({providerId:this.providerId,resultStatus:s.ProviderResultStatus.Error,error:{errorType:s.ProviderErrorType.ServiceError,detail:t}})}else this.logger.error(595919122,"Empty Tenant and Endpoint"),e({providerId:this.providerId,resultStatus:s.ProviderResultStatus.Error,error:{errorType:s.ProviderErrorType.ServiceError}});else this.executeProvider(n,e)},t.prototype.parseTapAdditionalInfo=function(t){return{resultTimestamp:Date.now(),graphSearchPageImpression:t.GraphSearchPageImpression,searchPageImpression:t.SearchPageImpression,graphSearchCorrelationId:t.GraphSearchCorrelationId,searchCorrelationId:t.SearchCorrelationId,graphSearchSourceId:t.GraphSearchSourceId,searchSourceId:t.SearchSourceId,graphSearchQueryId:t.GraphSearchQueryId,searchQueryId:t.SearchQueryId,tracking:t.Tracking}},t.prototype.parseEntityGroups=function(t){var e=[];return t.Items&&t.Items.length>0&&e.push(new a.TapEntityGroup(this.providerId,s.TapProviderIdentifier.DOCUMENT_ID,t.Items)),e},t.prototype.getAuthenticationErrorResult=function(t){return{providerId:this.providerId,resultStatus:s.ProviderResultStatus.Error,error:{errorType:s.ProviderErrorType.AuthenticationError,detail:t}}},t}();e.TapProvider=f;var l=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_QF_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_QF_TIMEOUT},r),"QFSearch")||this}return n(e,t),e}(f);e.TapQFProvider=l;var d=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_QF_AND_OLS_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_OLS_TIMEOUT},r),"QFAndOlsSearch")||this}return n(e,t),e}(f);e.TapQFAndOLSProvider=d;var p=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_OLS_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_OLS_TIMEOUT},r),"OlsSearch")||this}return n(e,t),e}(f);e.TapOLSProvider=p;var h=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_SP_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_SP_TIMEOUT},r),"SPSearch")||this}return n(e,t),e}(f);e.TapSPProvider=h;var v=function(t){function e(e,r,n,i){return t.call(this,e,r,n,i)||this}return n(e,t),e.prototype.shouldExecute=function(t){var e=t;return!!(t&&e.tapContext&&e.tapContext.fetchTokenPromise&&e.tapContext.enterpriseFeaturesEnabled)},e.prototype.getContextHash=function(t){var e=t;return e.tapContext?e.tapContext.queryTimestamp.toString():void 0},e}(f);e.TapZeroTermProvider=v;var g=function(t){function e(e){return t.call(this,s.TapProviderIdentifier.TAP_SEARCH_ZERO_TERM_QF_PROVIDER_ID,e,{resultTimeout:u.TAP_PROVIDER_QF_TIMEOUT},"QFSearch")||this}return n(e,t),e}(v);e.TapZeroTermQFProvider=g;var y=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_ZERO_TERM_QF_AND_OLS_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_OLS_TIMEOUT},r),"QFAndOlsSearch")||this}return n(e,t),e}(v);e.TapZeroTermQFAndOLSProvider=y;var I=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_ZERO_TERM_OLS_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_OLS_TIMEOUT},r),"OlsSearch")||this}return n(e,t),e}(v);e.TapZeroTermOLSProvider=I;var E=function(t){function e(e,r){return void 0===r&&(r={}),t.call(this,s.TapProviderIdentifier.TAP_SEARCH_ZERO_TERM_SP_PROVIDER_ID,e,i({resultTimeout:u.TAP_PROVIDER_SP_TIMEOUT},r),"SPSearch")||this}return n(e,t),e}(v);e.TapZeroTermSPProvider=E},function(t,e,r){"use strict";function n(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],n(r),n(i))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(u),r=1;r<e.length;r++)t=n(e,r).join(""),e=t.match(u);return t}}function o(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=a.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=i(r[0]);n!==r[0]&&(e[r[0]]=n)}r=a.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),u=0;u<o.length;u++){var s=o[u];t=t.replace(new RegExp(s,"g"),e[s])}return t}var u=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return o(t)}}},function(t,e,r){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,s=n(t),c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var f in r)o.call(r,f)&&(s[f]=r[f]);if(i){a=i(r);for(var l=0;l<a.length;l++)u.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},function(t,e,r){"use strict";function n(t){switch(t.arrayFormat){case"index":return function(e,r,n){return null===r?[o(e,t),"[",n,"]"].join(""):[o(e,t),"[",o(n,t),"]=",o(r,t)].join("")};case"bracket":return function(e,r){return null===r?o(e,t):[o(e,t),"[]=",o(r,t)].join("")};default:return function(e,r){return null===r?o(e,t):[o(e,t),"=",o(r,t)].join("")}}}function i(t){var e;switch(t.arrayFormat){case"index":return function(t,r,n){if(e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),!e)return void(n[t]=r);void 0===n[t]&&(n[t]={}),n[t][e[1]]=r};case"bracket":return function(t,r,n){return e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0===n[t]?void(n[t]=[r]):void(n[t]=[].concat(n[t],r)):void(n[t]=r)};default:return function(t,e,r){if(void 0===r[t])return void(r[t]=e);r[t]=[].concat(r[t],e)}}}function o(t,e){return e.encode?e.strict?c(t):encodeURIComponent(t):t}function u(t){return Array.isArray(t)?t.sort():"object"==typeof t?u(Object.keys(t)).sort(function(t,e){return Number(t)-Number(e)}).map(function(e){return t[e]}):t}function a(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function s(t,e){e=f({arrayFormat:"none"},e);var r=i(e),n=Object.create(null);return"string"!=typeof t?n:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach(function(t){var e=t.replace(/\+/g," ").split("="),i=e.shift(),o=e.length>0?e.join("="):void 0;o=void 0===o?null:l(o),r(l(i),o,n)}),Object.keys(n).sort().reduce(function(t,e){var r=n[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=u(r):t[e]=r,t},Object.create(null))):n}var c=r(388),f=r(386),l=r(385);e.extract=a,e.parse=s,e.stringify=function(t,e){e=f({encode:!0,strict:!0,arrayFormat:"none"},e),!1===e.sort&&(e.sort=function(){});var r=n(e);return t?Object.keys(t).sort(e.sort).map(function(n){var i=t[n];if(void 0===i)return"";if(null===i)return o(n,e);if(Array.isArray(i)){var u=[];return i.slice().forEach(function(t){void 0!==t&&u.push(r(n,t,u.length))}),u.join("&")}return o(n,e)+"="+o(i,e)}).filter(function(t){return t.length>0}).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:s(a(t),e)}}},function(t,e,r){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.DictionaryAdditionalInfo=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_DICTIONARY_URL="https://uci.officeapps.live.com/OfficeInsights/Dictionary/V2",e.DICTIONARY_REQUEST_HEADERS={Accept:"application/json, text/javascript; q=0.01","Content-Type":"application/json; charset=UTF-8"},e.DICTIONARY_PROVIDER_TIMEOUT=5e3,e.DICTIONARY_HEADER_NAME_CLIENTTYPE="X-ClientType",e.DICTIONARY_HEADER_NAME_CORRELATIONID="X-CorrelationId",e.DICTIONARY_HEADER_NAME_USERSESSIONID="X-UserSessionId",e.DICTIONARY_HEADER_NAME_CLIENTUSERAGENT="X-ClientUserAgent",e.DICTIONARY_HEADER_NAME_INSTANID="X-Inst-ANID",e.DICTIONARY_HEADER_NAME_CLIENTIP="X-ClientIP"},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(390),o=r(142),u=r(1),a=r(48),s=function(){function t(t){this.logger=t,this.providerId=u.DictionaryProviderIdentifier.DICTIONARY_PROVIDER_ID,this.configuration={resultTimeout:i.DICTIONARY_PROVIDER_TIMEOUT}}return t.prototype.shouldExecute=function(t){var e=t;return void 0!=e.insightsContext&&void 0!=e.insightsContext.QueryTimestamp&&void 0!=e.insightsContext.sessionId&&void 0!=e.insightsContext.App&&void 0!=e.insightsContext.Neighborhood&&void 0!=e.insightsContext.MentionLength&&void 0!=e.insightsContext.MentionStart&&void 0!=e.insightsContext.Market&&void 0!=e.insightsContext.correlationId&&void 0!=e.insightsContext.UiLanguage&&void 0!=e.insightsContext.ParentalControl},t.prototype.getContextHash=function(t){var e=t;return e.insightsContext?e.insightsContext.Neighborhood+e.insightsContext.QueryTimestamp:void 0},t.prototype.getProviderRequest=function(t){var e=t,r=n({},i.DICTIONARY_REQUEST_HEADERS,(u={},u[i.DICTIONARY_HEADER_NAME_INSTANID]=e.insightsContext.instANID,u[i.DICTIONARY_HEADER_NAME_CLIENTTYPE]=e.insightsContext.clientType,u[i.DICTIONARY_HEADER_NAME_CORRELATIONID]=e.insightsContext.correlationId,u[i.DICTIONARY_HEADER_NAME_USERSESSIONID]=e.insightsContext.sessionId,u[i.DICTIONARY_HEADER_NAME_CLIENTUSERAGENT]=e.insightsContext.clientUserAgent,u[i.DICTIONARY_HEADER_NAME_CLIENTIP]=e.insightsContext.clientIP,u)),o={Neighborhood:e.insightsContext.Neighborhood,MentionStart:e.insightsContext.MentionStart,MentionLength:e.insightsContext.MentionLength,App:e.insightsContext.App,Market:e.insightsContext.Market,UiLanguage:e.insightsContext.UiLanguage,ParentalControl:e.insightsContext.ParentalControl};return{url:i.API_DICTIONARY_URL,method:"POST",headers:r,body:JSON.stringify(o)};var u},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:u.ProviderResultStatus.Error,statusCode:e,error:{errorType:u.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:u.ProviderResultStatus.Success,statusCode:e,additionalInfo:this.parseDictionaryAdditionalInfo(t.Dictionary),entityGroups:this.parseEntityGroups(t.Dictionary)}},t.prototype.getResults=function(t,e){var r=this,n=this.getProviderRequest(t);a.ProviderUtils.fetchProviderResult(n.url,{method:n.method,headers:n.headers,body:n.body},t,this.logger,this.providerId,function(t,e){return{providerId:r.providerId,resultStatus:u.ProviderResultStatus.Success,statusCode:e,additionalInfo:r.parseDictionaryAdditionalInfo(t.Dictionary),entityGroups:r.parseEntityGroups(t.Dictionary)}}).then(function(t){e(t)})},t.prototype.parseDictionaryAdditionalInfo=function(t){return{resultTimestamp:Date.now(),providers:t.Providers,formattedNotice:t.FormattedNotice}},t.prototype.parseEntityGroups=function(t){var e=[];return t.Words&&0!=t.Words.length&&e.push(new o.DictionaryEntityGroup(u.DictionaryProviderIdentifier.DICTIONARY_WORDS_GROUP_ID,t.Words)),e},t}();e.DictionaryProvider=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.ImagesAdditionalInfo=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API_IMAGES_URL="https://uci.officeapps.live.com/OfficeInsights/Images/V1",e.IMAGES_REQUEST_HEADERS={Accept:"application/json, text/javascript; q=0.01","Content-Type":"application/json; charset=UTF-8"},e.IMAGES_PROVIDER_TIMEOUT=5e3,e.IMAGES_HEADER_NAME_CLIENTTYPE="X-ClientType",e.IMAGES_HEADER_NAME_CORRELATIONID="X-CorrelationId",e.IMAGES_HEADER_NAME_USERSESSIONID="X-UserSessionId",e.IMAGES_HEADER_NAME_CLIENTUSERAGENT="X-ClientUserAgent",e.IMAGES_HEADER_NAME_INSTANID="X-Inst-ANID",e.IMAGES_HEADER_NAME_CLIENTIP="X-ClientIP"},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(393),o=r(143),u=r(1),a=r(48),s=function(){function t(t){this.logger=t,this.providerId=u.ImagesProviderIdentifier.IMAGES_PROVIDER_ID,this.configuration={resultTimeout:i.IMAGES_PROVIDER_TIMEOUT}}return t.prototype.shouldExecute=function(t){var e=t;return void 0!=e.insightsContext&&void 0!=e.imagesContext&&(void 0!=e.imagesContext.ImageSearchQuery||void 0!=e.insightsContext.Neighborhood)&&(void 0!=e.imagesContext.ImageSearchQuery||void 0!=e.insightsContext.MentionStart&&void 0!=e.insightsContext.MentionLength)&&void 0!=e.insightsContext.QueryTimestamp&&void 0!=e.insightsContext.correlationId&&void 0!=e.insightsContext.ParentalControl&&void 0!=e.insightsContext.UiLanguage&&void 0!=e.insightsContext.Market&&void 0!=e.insightsContext.App&&void 0!=e.insightsContext.correlationId&&void 0!=e.imagesContext.License&&void 0!=e.imagesContext.Offset&&void 0!=e.imagesContext.Count},t.prototype.getContextHash=function(t){var e=t;if(e.insightsContext&&e.imagesContext){return(e.imagesContext.ImageSearchQuery?e.imagesContext.ImageSearchQuery:e.insightsContext.Neighborhood)+e.insightsContext.QueryTimestamp+e.imagesContext.Offset+e.imagesContext.License}},t.prototype.getProviderRequest=function(t){var e=t,r=n({},i.IMAGES_REQUEST_HEADERS,(c={},c[i.IMAGES_HEADER_NAME_INSTANID]=e.insightsContext.instANID,c[i.IMAGES_HEADER_NAME_CLIENTTYPE]=e.insightsContext.clientType,c[i.IMAGES_HEADER_NAME_CORRELATIONID]=e.insightsContext.correlationId,c[i.IMAGES_HEADER_NAME_USERSESSIONID]=e.insightsContext.sessionId,c[i.IMAGES_HEADER_NAME_CLIENTUSERAGENT]=e.insightsContext.clientUserAgent,c[i.IMAGES_HEADER_NAME_CLIENTIP]=e.insightsContext.clientIP,c)),o=e.imagesContext.ImageSearchQuery?e.imagesContext.ImageSearchQuery:e.insightsContext.Neighborhood,u=e.imagesContext.ImageSearchQuery?0:e.insightsContext.MentionStart,a=e.imagesContext.ImageSearchQuery?e.imagesContext.ImageSearchQuery.length:e.insightsContext.MentionLength,s={Neighborhood:o,MentionStart:u,MentionLength:a,App:e.insightsContext.App,Market:e.insightsContext.Market,UiLanguage:e.insightsContext.UiLanguage,ParentalControl:e.insightsContext.ParentalControl,License:e.imagesContext.License,Offset:e.imagesContext.Offset,Count:e.imagesContext.Count};return{url:i.API_IMAGES_URL,method:"POST",headers:r,body:JSON.stringify(s)};var c},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:u.ProviderResultStatus.Error,statusCode:e,error:{errorType:u.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:u.ProviderResultStatus.Success,statusCode:e,additionalInfo:this.parseImagesAdditionalInfo(t),entityGroups:this.parseEntityGroups(t)}},t.prototype.getResults=function(t,e){var r=this,n=this.getProviderRequest(t);a.ProviderUtils.fetchProviderResult(n.url,{method:n.method,headers:n.headers,body:n.body},t,this.logger,this.providerId,function(t,e){return{providerId:r.providerId,resultStatus:u.ProviderResultStatus.Success,statusCode:e,additionalInfo:r.parseImagesAdditionalInfo(t),entityGroups:r.parseEntityGroups(t)}}).then(function(t){e(t)})},t.prototype.parseImagesAdditionalInfo=function(t){return{resultTimestamp:Date.now(),nextOffset:t.NextOffset}},t.prototype.parseEntityGroups=function(t){var e=[];return t.Images&&0!=t.Images.length&&e.push(new o.ImagesEntityGroup(u.ImagesProviderIdentifier.IMAGES_ID,t.Images)),e},t}();e.ImagesProvider=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t}();e.InsightsAdditionalInfo=n},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(144),u=r(145),a=r(1),s=r(48),c=function(){function t(){this.entityGroups=[],this.rank=0,this.rankedEntityGroups={}}return t}(),f=function(){function t(t){this.providerId=a.InsightsProviderIdentifier.INSIGHTS_PROVIDER_ID,this.configuration={resultTimeout:o.INSIGHTS_PROVIDER_TIMEOUT},this.logger=t}return t.prototype.shouldExecute=function(t){var e=t;return void 0!=e.insightsContext&&void 0!=e.insightsContext.QueryTimestamp&&void 0!=e.insightsContext.sessionId&&void 0!=e.insightsContext.App&&void 0!=e.insightsContext.Neighborhood&&void 0!=e.insightsContext.MentionLength&&void 0!=e.insightsContext.MentionStart&&void 0!=e.insightsContext.Market&&void 0!=e.insightsContext.correlationId&&void 0!=e.insightsContext.UiLanguage&&void 0!=e.insightsContext.ParentalControl},t.prototype.getContextHash=function(t){var e=t;return e.insightsContext?e.insightsContext.Neighborhood+e.insightsContext.QueryTimestamp:void 0},t.prototype.getProviderRequest=function(t){var e=t,r=n({},o.INSIGHTS_REQUEST_HEADERS,(u={},u[o.INSIGHTS_HEADER_NAME_INSTANID]=e.insightsContext.instANID,u[o.INSIGHTS_HEADER_NAME_CLIENTTYPE]=e.insightsContext.clientType,u[o.INSIGHTS_HEADER_NAME_CORRELATIONID]=e.insightsContext.correlationId,u[o.INSIGHTS_HEADER_NAME_USERSESSIONID]=e.insightsContext.sessionId,u[o.INSIGHTS_HEADER_NAME_CLIENTUSERAGENT]=e.insightsContext.clientUserAgent,u[o.INSIGHTS_HEADER_NAME_CLIENTIP]=e.insightsContext.clientIP,u)),i={Neighborhood:e.insightsContext.Neighborhood,MentionStart:e.insightsContext.MentionStart,MentionLength:e.insightsContext.MentionLength,App:e.insightsContext.App,Market:e.insightsContext.Market,UiLanguage:e.insightsContext.UiLanguage,ParentalControl:e.insightsContext.ParentalControl,CallSatori:!!e.insightsContext.CallSatori&&e.insightsContext.CallSatori,ConfidenceThreshold:e.insightsContext.ConfidenceThreshold,RankWebResults:e.insightsContext.RankWebResults,TransactionId:e.transactionId};return{url:o.API_INSIGHTS_URL,method:"POST",headers:r,body:JSON.stringify(i)};var u},t.prototype.getProviderResults=function(t,e){var r;try{var n=JSON.parse(t);r=this.parseResponse(n,e)}catch(t){r={providerId:this.providerId,resultStatus:a.ProviderResultStatus.Error,statusCode:e,error:{errorType:a.ProviderErrorType.ParsingError,detail:t.message}}}return r},t.prototype.parseResponse=function(t,e){return{providerId:this.providerId,resultStatus:a.ProviderResultStatus.Success,statusCode:e,additionalInfo:this.parseInsightsAdditionalInfo(t),entityGroups:this.parseEntityGroups({interactionId:"",transactionId:""},t)}},t.prototype.getResults=function(t,e){var r=this,n=this.getProviderRequest(t);s.ProviderUtils.fetchProviderResult(n.url,{method:n.method,headers:n.headers,body:n.body},t,this.logger,this.providerId,function(e,n){return{providerId:r.providerId,resultStatus:a.ProviderResultStatus.Success,statusCode:n,additionalInfo:r.parseInsightsAdditionalInfo(e),entityGroups:r.parseEntityGroups(t,e)}}).then(function(t){e(t)})},t.prototype.parseInsightsAdditionalInfo=function(t){return{resultTimestamp:Date.now(),beaconUrl:t.BeaconUrl,showImagesWithEntity:t.ShowImagesWithEntity,imageSearchQuery:t.ImageSearchQuery}},t.prototype.getBingAnswerTypeGroupId=function(t){switch(t){case"Computation":return a.InsightsProviderIdentifier.BINGANSWER_COMPUTATION_ID;case"Currency":return a.InsightsProviderIdentifier.BINGANSWER_CURRENCY_ID;case"Facts":return a.InsightsProviderIdentifier.BINGANSWER_FACTS_ID;case"Finance":return a.InsightsProviderIdentifier.BINGANSWER_FINANCE_ID;case"News":return a.InsightsProviderIdentifier.BINGANSWER_NEWS_ID;case"Weather":return a.InsightsProviderIdentifier.BINGANSWER_WEATHER_ID;default:return}},t.prototype.pushEntityGroup=function(t,e,r){t.rankedEntityGroups[e]||(t.entityGroups.push(new u.InsightsEntityGroup(e,t.rank++,r)),t.rankedEntityGroups[e]=!0)},t.prototype.pushBingAnswerType=function(t,e,r){var n=this.getBingAnswerTypeGroupId(r.AnswerType);n?this.pushEntityGroup(e,n,r):this.logger.error(595994308,"[InsightsProvider] Unsupported answer type in response",{interactionId:t.interactionId,transactionId:t.transactionId,answerType:r.AnswerType})},t.prototype.parseEntityGroups=function(t,e){var r=new c;if(e.BingRankingResults){var n=this;try{for(var o=i(e.BingRankingResults),u=o.next();!u.done;u=o.next()){var s=u.value;!function(i){switch(i){case"DictionaryWords":n.pushEntityGroup(r,a.InsightsProviderIdentifier.DICTIONARY_ID,e.Dictionary);break;case"Entities":e.Entities&&0!=e.Entities.length&&n.pushEntityGroup(r,a.InsightsProviderIdentifier.ENTITIES_ID,e.Entities);break;case"Images":n.pushEntityGroup(r,a.InsightsProviderIdentifier.IMAGES_ID,e.Images);break;case"WebPages":e.WebResults&&0!=e.WebResults.length&&n.pushEntityGroup(r,a.InsightsProviderIdentifier.WEBRESULTS_ID,e.WebResults);break;case"Computation":case"Currency":case"Facts":case"Finance":case"News":case"Weather":var o=e.BingAnswers.find(function(t){return t.AnswerType===i});o?n.pushBingAnswerType(t,r,o):n.logger.error(595994309,"[InsightsProvider] Ranked BingAnswer type not found in response",{interactionId:t.interactionId,transactionId:t.transactionId,answerType:i});break;default:n.logger.error(595994310,"[InsightsProvider] Unsupported rank label in response",{interactionId:t.interactionId,transactionId:t.transactionId,rankLabel:i})}}(s)}}catch(t){p={error:t}}finally{try{u&&!u.done&&(h=o.return)&&h.call(o)}finally{if(p)throw p.error}}}if(e.Dictionary&&(0!=e.Dictionary.Providers.length||0!=e.Dictionary.Words.length||e.Dictionary.FormattedNotice)&&this.pushEntityGroup(r,a.InsightsProviderIdentifier.DICTIONARY_ID,e.Dictionary),e.Entities&&0!=e.Entities.length&&this.pushEntityGroup(r,a.InsightsProviderIdentifier.ENTITIES_ID,e.Entities),e.Images&&0!=e.Images.length&&this.pushEntityGroup(r,a.InsightsProviderIdentifier.IMAGES_ID,e.Images),e.WebResults&&0!=e.WebResults.length&&this.pushEntityGroup(r,a.InsightsProviderIdentifier.WEBRESULTS_ID,e.WebResults),e.WikipediaResults&&0!=e.WikipediaResults.length&&this.pushEntityGroup(r,a.InsightsProviderIdentifier.WIKIPEDIARESULTS_ID,e.WikipediaResults),e.BingAnswers)try{for(var f=i(e.BingAnswers),l=f.next();!l.done;l=f.next()){var d=l.value;this.pushBingAnswerType(t,r,d)}}catch(t){v={error:t}}finally{try{l&&!l.done&&(g=f.return)&&g.call(f)}finally{if(v)throw v.error}}return r.entityGroups;var p,h,v,g},t}();e.InsightsProvider=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);!function(t){function e(t,e,i,o,u,a,s){return new Promise(function(c){var f=Date.now();(s||fetch)(t,e).then(function(t){t.ok?(o.info(595994567,"[FetchProviderResult] Service response: ok",{latency:Date.now()-f,providerId:u,interactionId:i.interactionId,transactionId:i.transactionId}),t.text().then(function(e){var i;try{var o=JSON.parse(e);i=a(o,t.status)}catch(e){i=r(u,{errorType:n.ProviderErrorType.ParsingError,detail:e.message},t)}c(i)})):(o.error(595994568,"[FetchProviderResult] Service response: error",{latency:Date.now()-f,providerId:u,interactionId:i.interactionId,transactionId:i.transactionId}),c(r(u,{errorType:n.ProviderErrorType.ServiceError},t)))}).catch(function(t){o.error(595994569,"[FetchProviderResult] Service response: network error",{latency:Date.now()-f,providerId:u,interactionId:i.interactionId,transactionId:i.transactionId}),c(r(u,{errorType:n.ProviderErrorType.NetworkError,detail:t.message}))})})}function r(t,e,r){return{providerId:t,resultStatus:n.ProviderResultStatus.Error,statusCode:r?r.status:void 0,error:e}}t.fetchProviderResult=e,t.getErrorProviderResult=r}(e.ProviderUtils||(e.ProviderUtils={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(99),i=r(1),o=function(){function t(t){this._invalidProvider="InvalidProvider",this._currentResult=t}return Object.defineProperty(t.prototype,"proxyType",{get:function(){return n.ProviderProxyType.External},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"providerId",{get:function(){return this._currentResult?this._currentResult.providerId:this._invalidProvider},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentResult",{get:function(){return this._currentResult},enumerable:!0,configurable:!0}),t.prototype.isResultPending=function(){return!!this._currentResult&&this._currentResult.resultStatus===i.ProviderResultStatus.Pending},t.prototype.isResultFulfilled=function(){return!!this._currentResult&&this._currentResult.resultStatus!==i.ProviderResultStatus.Pending},t.prototype.updateContext=function(t){return!1},t}();e.ExternalProviderProxy=o},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(100),o=r(398),u=r(401),a=r(99),s=r(1),c=r(405),f=function(){function t(t,e,r){this.providerProxies={},this.ranker=t,this.logger=e,this.cache=r}return t.prototype.registerProvider=function(t){var e=this;if(!t)return void this.logger.error(595952531,"Provider is undefined or null");this.logger.debug(595994263,"Provider registered",{providerId:t.providerId,configuration:t.configuration}),this.providerProxies[t.providerId]=new u.InternalProviderProxy(new c.SafeProviderAdapter(t,this.logger),function(t){return e.notifyResultsUpdated(t)},this.logger,this.cache)},t.prototype.setResultsUpdatedCallback=function(t){this.resultsUpdatedCallback=t},t.prototype.updateContext=function(t){return this.logger.info(595994264,"Context updated",{interactionId:t.interactionId,transactionId:t.transactionId}),this.latestContext=t,this.updateProviderResults(),t.transactionId},t.prototype.pushResult=function(t){if(!t)return void this.logger.error(595952532,"Parameter result is undefined in pushResult method");this.providerProxies[t.providerId]&&this.providerProxies[t.providerId].proxyType!=a.ProviderProxyType.External||(this.setLatestContext(),this.providerProxies[t.providerId]=new o.ExternalProviderProxy(t),this.notifyResultsUpdated())},t.prototype.clearResult=function(t){this.providerProxies[t]&&this.providerProxies[t].proxyType==a.ProviderProxyType.External&&(this.setLatestContext(),delete this.providerProxies[t],this.notifyResultsUpdated())},t.prototype.setLatestContext=function(){this.latestContext||(this.latestContext={interactionId:void 0,transactionId:void 0}),this.latestContext.transactionId=i()},t.prototype.updateProviderResults=function(){var t=!1;try{for(var e=n(Object.keys(this.providerProxies)),r=e.next();!r.done;r=e.next()){var i=r.value,o=this.providerProxies[i];this.logger.debug(595994265,"UpdateProviderResults start",{interactionId:this.latestContext.interactionId,transactionId:this.latestContext.transactionId,providerId:o.providerId}),o.updateContext(this.latestContext)&&(t=!0)}}catch(t){u={error:t}}finally{try{r&&!r.done&&(a=e.return)&&a.call(e)}finally{if(u)throw u.error}}t&&this.notifyResultsUpdated();var u,a},t.prototype.infraredResultFromCurrentProviderResults=function(){var t={},e=[];try{for(var r=n(Object.keys(this.providerProxies)),i=r.next();!i.done;i=r.next()){var o=i.value,u=this.providerProxies[o];if(u.isResultPending())t[o]={providerId:o,resultStatus:s.ProviderResultStatus.Pending};else if(u.isResultFulfilled()){var a=u.currentResult,c={providerId:o,resultStatus:a.resultStatus,statusCode:a.statusCode,error:a.error,additionalInfo:a.additionalInfo,entityGroups:a.entityGroups};a.resultStatus===s.ProviderResultStatus.Success&&a.entityGroups?e=e.concat(a.entityGroups):a.resultStatus===s.ProviderResultStatus.NoResult&&a.entityGroups&&(c.entityGroups=void 0),t[o]=c}}}catch(t){f={error:t}}finally{try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(f)throw f.error}}return{transactionId:this.latestContext.transactionId,providerStatuses:t,rankedEntityGroups:e};var f,l},t.prototype.rankResults=function(t,e){var r=e;try{r=this.ranker.rank(t,r)}catch(e){this.logger.error(595994304,"Unhandled ranker exception",{interactionId:t.interactionId,transactionId:t.transactionId,entityGroups:r.rankedEntityGroups.map(function(t){return t.groupTypeId}),error:e})}return r},t.prototype.notifyResultsUpdated=function(t){if(this.resultsUpdatedCallback){var e=this.infraredResultFromCurrentProviderResults();this.resultsUpdatedCallback(this.rankResults(this.latestContext,e))}},t}();e.default=f},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(100),o=r(1),u=function(){function t(t,e,r){this.intelligenceHub=t,this.messageHandlers=e,this.logger=r,this.currentContext={interactionId:i(),transactionId:void 0}}return t.prototype.onMessage=function(t){this.dispatchMessage(t)},t.prototype.startUserInteractionSession=function(t){var e=t||i();if(e!==this.currentContext.interactionId){var r=this.currentContext.interactionId;this.currentContext.interactionId=e,this.logger.info(595992966,"[IntentClassifier] User interaction session started",{previousInteractionId:r,interactionId:this.currentContext.interactionId})}},t.prototype.endUserInteractionSession=function(){if(this.currentContext.interactionId){var t=this.currentContext.interactionId;return this.currentContext.interactionId=i(),this.logger.info(595992772,"[IntentClassifier] User interaction session ended",{previousInteractionId:t,interactionId:this.currentContext.interactionId}),!0}return!1},t.prototype.logUserAction=function(t){this.logger.logEvent("UserAction",595992967,o.LoggingLevel.Info,"[IntentClassifier] User Action",o.SamplingPolicy.CriticalBusinessImpact,{interactionId:this.currentContext.interactionId,action:t})},t.prototype.dispatchMessage=function(t){var e=n({},this.currentContext,{transactionId:t.transactionId?t.transactionId:i()});this.messageHandlers.forEach(function(r){e=n({},e,r.convertMessage(t,e))}),this.currentContext=e,this.intelligenceHub.updateContext(this.currentContext)},t}();e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(100),i=r(99),o=r(1),u=r(402),a=function(){function t(t,e,r,n){this.provider=t,this.notifyResultUpdated=e,this.logger=r,this.cache=n}return Object.defineProperty(t.prototype,"proxyType",{get:function(){return i.ProviderProxyType.Internal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"providerId",{get:function(){return this.provider.providerId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentResult",{get:function(){return this.isResultFulfilled()?this.resultPromise.value():void 0},enumerable:!0,configurable:!0}),t.prototype.isResultPending=function(){return this.resultPromise&&this.resultPromise.isPending()},t.prototype.isResultFulfilled=function(){return this.resultPromise&&this.resultPromise.isFulfilled()},t.prototype.updateContext=function(t){var e=this,r=!1;if(this.provider.shouldExecute(t)){var i=this.provider.getContextHash(t);if(void 0===i||this.resultContextHash!==i){r=this.isResultFulfilled(),this.resultContextHash=i,this.resultPromise=new u.PromiseWrapper(this.fetchProviderResult(t,i));var o=n();this.updateId=o,this.resultPromise.promise.then(function(r){return e.processIncomingResult(t,r,i,o)})}}else r=this.isResultFulfilled(),this.resultContextHash=void 0,this.resultPromise=void 0;return r},t.prototype.fetchProviderResult=function(t,e){var r;return e&&this.cache&&this.provider.configuration.cacheResults&&(r=this.cache.getResult(this.provider.providerId,e)),r?Promise.resolve(r):this.provider.getResults(t)},t.prototype.processIncomingResult=function(t,e,r,n){return this.logResult(t,e),e.resultStatus===o.ProviderResultStatus.Success&&this.cacheProviderResult(e,r),this.updateId==n&&this.notifyResultUpdated(this.provider.providerId),e},t.prototype.cacheProviderResult=function(t,e){e&&this.cache&&this.provider.configuration.cacheResults&&this.cache.setResult(e,t)},t.prototype.logResult=function(t,e){e.resultStatus===o.ProviderResultStatus.Success?this.logger.info(595994261,"[ProviderProxy] Provider getResults success",{interactionId:t.interactionId,transactionId:t.transactionId,providerId:this.provider.providerId,statusCode:e.statusCode,latency:e.latency,entityGroupCount:e.entityGroups.length}):e.resultStatus===o.ProviderResultStatus.Error&&this.logger.error(595994262,"[ProviderProxy] Provider getResults error",{interactionId:t.interactionId,transactionId:t.transactionId,providerId:this.provider.providerId,statusCode:e.statusCode,latency:e.latency,error:e.error})},t}();e.InternalProviderProxy=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){var e=this;this.fulfilled=!1,this.pending=!0,this.promise=t,t.then(function(t){e.val=t,e.fulfilled=!0,e.pending=!1},function(t){e.pending=!1}).catch(function(){e.pending=!1})}return t.prototype.value=function(){return this.val},t.prototype.isFulfilled=function(){return this.fulfilled},t.prototype.isPending=function(){return this.pending},t}();e.PromiseWrapper=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.providerId=t.providerId,this.resultStatus=t.resultStatus,this.statusCode=t.statusCode,this.error=t.error,this.entityGroups=t.entityGroups,this.additionalInfo=t.additionalInfo,this.latency=e}return t}();e.ProviderResult=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.cache=new Map,this.logger=t}return t.prototype.setResult=function(t,e){this.cache.has(e.providerId)||this.cache.set(e.providerId,new Map),this.cache.get(e.providerId).set(t,{result:e,timestamp:new Date}),this.logger.debug(596125211,"[ResultsCache] Result successfully cached",{providerId:e.providerId,resultIndex:t})},t.prototype.getResult=function(t,e){if(this.cache.has(t)){var r=this.cache.get(t).get(e);return this.isResultValid(r)?r.result:(this.logger.debug(596125212,"[ResultsCache] Result is stale, removing from cached results",{providerId:t,resultIndex:e}),void this.cache.get(t).delete(e))}},t.prototype.isResultValid=function(t){if(t){var e=t.result;if(t.timestamp.getTime()+(e.additionalInfo.resultExpires||0)-Date.now()>0)return!0}return!1},t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(146),i=r(1),o=r(403),u=function(){function t(t,e){this.provider=t,this.logger=e}return Object.defineProperty(t.prototype,"providerId",{get:function(){return this.provider.providerId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"configuration",{get:function(){return this.provider.configuration},enumerable:!0,configurable:!0}),t.prototype.shouldExecute=function(t){try{return this.provider.shouldExecute(t)}catch(e){return this.logger.error(595994305,"[ExternalProviderAdapter] Unhandled exception in shouldExecute",{interactionId:t.interactionId,transactionId:t.transactionId,providerId:this.provider.providerId,error:{errorType:i.ProviderErrorType.UnhandledException,detail:JSON.stringify(e)}}),!1}},t.prototype.getContextHash=function(t){try{return this.provider.getContextHash?this.provider.getContextHash(t):void 0}catch(e){return void this.logger.error(595994306,"[ExternalProviderAdapter] Unhandled exception in getContextHash",{interactionId:t.interactionId,transactionId:t.transactionId,providerId:this.provider.providerId,error:{errorType:i.ProviderErrorType.UnhandledException,detail:JSON.stringify(e)}})}},t.prototype.getResults=function(t){return Promise.race([this.providerCall(t),this.providerTimeout(this.provider.configuration.resultTimeout||n.DEFAULT_PROVIDER_TIMEOUT)])},t.prototype.providerCall=function(t){var e=this,r=Date.now();return new Promise(function(n){e.provider.getResults(t,function(t){t.resultStatus!=i.ProviderResultStatus.Error||t.error||(t.error={errorType:i.ProviderErrorType.NotSet}),n(new o.ProviderResult(t,Date.now()-r))})}).catch(function(t){return new o.ProviderResult({providerId:e.providerId,resultStatus:i.ProviderResultStatus.Error,error:{errorType:i.ProviderErrorType.UnhandledException,detail:JSON.stringify(t)}},Date.now()-r)})},t.prototype.providerTimeout=function(t){var e=this;return new Promise(function(r){setTimeout(function(){r(new o.ProviderResult({providerId:e.providerId,resultStatus:i.ProviderResultStatus.Error,error:{errorType:i.ProviderErrorType.Timeout}},t))},t)})},t}();e.SafeProviderAdapter=u},function(t,e,r){function n(t,e,r){var n=e&&r||0,f=e||[];t=t||{};var l=t.node||i,d=void 0!==t.clockseq?t.clockseq:o;if(null==l||null==d){var p=u();null==l&&(l=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=o=16383&(p[6]<<8|p[7]))}var h=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:c+1,g=h-s+(v-c)/1e4;if(g<0&&void 0===t.clockseq&&(d=d+1&16383),(g<0||h>s)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=v,o=d,h+=122192928e5;var y=(1e4*(268435455&h)+v)%4294967296;f[n++]=y>>>24&255,f[n++]=y>>>16&255,f[n++]=y>>>8&255,f[n++]=255&y;var I=h/4294967296*1e4&268435455;f[n++]=I>>>8&255,f[n++]=255&I,f[n++]=I>>>24&15|16,f[n++]=I>>>16&255,f[n++]=d>>>8|128,f[n++]=255&d;for(var E=0;E<6;++E)f[n+E]=l[E];return e||a(f)}var i,o,u=r(149),a=r(148),s=0,c=0;t.exports=n},function(t,e,r){function n(t,e,r){var n=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var u=t.random||(t.rng||i)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,e)for(var a=0;a<16;++a)e[n+a]=u[a];return e||o(u)}var i=r(149),o=r(148);t.exports=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=function(){function t(e,r){this.logger=e,this.configuration=r,this.shouldMatchDocumentTitle=!1,this.shouldMatchDocumentTitle=this.configuration?this.configuration.shouldQueryMatchQfDocumentTitle:t.defaultShouldQueryMatchQfDocumentTitle}return t.prototype.rank=function(t,e){var r=this,i=e.rankedEntityGroups.slice();return i.sort(function(e,i){var o=r.getProviderRank(t,e),u=r.getProviderRank(t,i);return e.providerId==i.providerId&&e.providerId==n.InsightsProviderIdentifier.INSIGHTS_PROVIDER_ID?e.rank-i.rank:o-u}),e.rankedEntityGroups=i,this.logger.info(595994314,"[SmartLookupRanker] RankedResults",{interactionId:t.interactionId,transactionId:t.transactionId,queryMatchEnabled:this.shouldMatchDocumentTitle,ranking:e.rankedEntityGroups.map(function(t){return t.groupTypeId})}),e},t.prototype.getProviderRank=function(e,r){var i=this;if(r.providerId==n.TapProviderIdentifier.TAP_SEARCH_QF_PROVIDER_ID&&this.shouldMatchDocumentTitle){var o=r;if(o.groupTypeId==n.TapProviderIdentifier.DOCUMENT_ID){var u=e,a=void 0!=u&&void 0!=u.tapContext?u.tapContext.queryText.toLocaleLowerCase().split(t.separators).filter(function(t){return t}):void 0;if(!o.data.find(function(t){return i.isTextContainsSearchWords(t.Title.toLocaleLowerCase(),a)}))return this.logger.debug(595973526,"[SmartLookupRanker] Query match with Qf Document failed",{interactionId:e.interactionId,transactionId:e.transactionId}),Number.MAX_VALUE;this.logger.debug(595973527,"[SmartLookupRanker] Query match with Qf Document succeeded",{interactionId:e.interactionId,transactionId:e.transactionId})}}return t.providerRank[r.providerId]?t.providerRank[r.providerId]:Number.MAX_VALUE},t.prototype.isTextContainsSearchWords=function(e,r){if(void 0==r||void 0==e)return!1;var n=e.split(t.separators);return r.every(function(t){return void 0!=n.find(function(e){return e.indexOf(t)>=0})})},t.providerRank=(o={},o[n.TapProviderIdentifier.TAP_SEARCH_QF_PROVIDER_ID]=1,o[n.InsightsProviderIdentifier.INSIGHTS_PROVIDER_ID]=2,o),t.separators=/[\s]+/,t.defaultShouldQueryMatchQfDocumentTitle=!1,t}();e.SmartLookupRanker=i;var o},function(t,e,r){r(152),t.exports=r(151)}])});
//# sourceMappingURL=ir-plugin-ski.min.js.map