!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CoachActorPackage=t():e.CoachActorPackage=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=157)}([function(e,t,n){var r=n(4),i=n(11),a=n(22),o=n(18),s=n(27),c=function(e,t,n){var l,u,h,m,d=e&c.F,p=e&c.G,f=e&c.S,g=e&c.P,v=e&c.B,y=p?r:f?r[t]||(r[t]={}):(r[t]||{}).prototype,C=p?i:i[t]||(i[t]={}),S=C.prototype||(C.prototype={});for(l in p&&(n=t),n)h=((u=!d&&y&&void 0!==y[l])?y:n)[l],m=v&&u?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,y&&o(y,l,h,e&c.U),C[l]!=h&&a(C,l,m),g&&S[l]!=h&&(S[l]=h)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){e.exports=n(110)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(7);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(67)("wks"),i=n(42),a=n(4).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(29),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){function n(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var o=e.apply(t,r);function s(e){n(o,i,a,s,c,"next",e)}function c(e){n(o,i,a,s,c,"throw",e)}s(void 0)}))}}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,a,o,s;if(l(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,s=c,console&&console.warn&&console.warn(s)}return e}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=m.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)a(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return l(t),this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,a,o;if(l(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){var r=n(159),i=n(160),a=n(161),o=n(163);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()}},function(e,t,n){e.exports=!n(5)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(6),i=n(116),a=n(36),o=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(34);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(4),i=n(22),a=n(21),o=n(42)("src"),s=n(187),c=(""+s).split("toString");n(11).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var l="function"==typeof n;l&&(a(n,"name")||i(n,"name",t)),e[t]!==n&&(l&&(a(n,o)||i(n,o,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||s.call(this)}))},function(e,t,n){var r=n(0),i=n(5),a=n(34),o=/"/g,s=function(e,t,n,r){var i=String(a(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(o,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t,n){var r=n(171),i=n(172),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(15),i=n(41);e.exports=n(14)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(61),i=n(34);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(368),i=n(369),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t,n){"use strict";var r=n(5);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RehearsalErrorReason=t.RehearsalActorSettings=t.RehearsalFontIconValue=t.RehearsalTemplateName=t.RehearsalTemplate=void 0,function(e){e[e.None=0]="None",e[e.DetectedValueWithMessage=1]="DetectedValueWithMessage",e[e.GaugeWithMessage=2]="GaugeWithMessage",e[e.SingleMessage=3]="SingleMessage",e[e.IconWithMessage=4]="IconWithMessage",e[e.TemperaturePillWithMessage=5]="TemperaturePillWithMessage",e[e.FontIconWithMessage=6]="FontIconWithMessage",e[e.Pronunciation=7]="Pronunciation"}(t.RehearsalTemplate||(t.RehearsalTemplate={}));var r=function(){function e(){}return e.DetectedValueWithMessage="detectedvaluewithmessage",e.GaugeWithMessage="gaugewithmessage",e.SingleMessage="singlemessage",e.IconWithMessage="iconwithmessage",e.TemperaturePillWithMessage="temperaturepillwithmessage",e.FontIconWithMessage="fonticonwithmessage",e.Pronunciation="pronunciation",e}();t.RehearsalTemplateName=r;var i=function(){function e(){}return e.Occlusion="ms-Icon ms-Icon--WavingHand",e.Gaze="ms-Icon ms-Icon--RedEye",e.Audio="ms-Icon ms-Icon--Volume2",e}();t.RehearsalFontIconValue=i;var a=function(){function e(){}return e.RehearsalDashboardMinimizeTransition="all .5s linear",e.RehearsalDashboardMaximizeTransition="all .35s linear",e.RehearsalDashboardNoTransition="0ms",e.ListeningStateAriaLabel=PowerpointPresenterCoachStrings.CoachActorMicrophoneListeningStateAriaLabel,e.PausedStateAriaLabel=PowerpointPresenterCoachStrings.CoachActorMicrophonePausedStateAriaLabel,e.SlideNumberAriaLabel=PowerpointPresenterCoachStrings.CoachActorSlideNumberAriaLabel,e.RehearseWithCoachDashboardAriaLabel=PowerpointPresenterCoachStrings.CoachActorRehearseWithCoachDashboardAriaLabel,e.MicrophoneButtonAriaLabel=PowerpointPresenterCoachStrings.CoachActorMicrophoneButtonAriaLabel,e.PlayWordOutLoudButtonAriaLabel=PowerpointPresenterCoachStrings.RehearsalSummaryPronunciationTextToSpeechAriaText,e.GenericRealtimeLabel=PowerpointPresenterCoachStrings.WelcomeScreenLegacyGenericRealtimeLabel,e.RehearsalWelcomeScreenTitle=PowerpointPresenterCoachStrings.RehearsalWelcomeScreenTitle,e.RehearsalFirstRunWelcomeScreenText=PowerpointPresenterCoachStrings.RehearsalFirstRunWelcomeScreenText,e.RehearsalFirstRunWelcomeScreenMinimalText=PowerpointPresenterCoachStrings.RehearsalFirstRunWelcomeScreenMinimalText,e.RehearsalGenericWelcomeScreenText=PowerpointPresenterCoachStrings.RehearsalGenericWelcomeScreenText,e.RehearsalCountdownWelcomeScreenText=PowerpointPresenterCoachStrings.RehearsalCountdownWelcomeScreenText,e.RehearsalCountdownWelcomeScreenErrorText=PowerpointPresenterCoachStrings.RehearsalCountdownWelcomeScreenErrorText,e.RehearsalVisionCountdownWelcomeScreenErrorText=PowerpointPresenterCoachStrings.RehearsalVisionCountdownWelcomeScreenErrorText,e.RehearsalNoMicAccessLabel=PowerpointPresenterCoachStrings.RehearsalNoMicAccessLabel,e.RehearsalNoCameraAccessLabel=PowerpointPresenterCoachStrings.RehearsalNoCameraAccessLabel,e.RehearsalGetStartedButtonLabel=PowerpointPresenterCoachStrings.RehearsalGetStartedButtonLabel,e.RehearsalOnboardingLabel=PowerpointPresenterCoachStrings.RehearsalSummaryLegacyFeedbackButtonLabel,e.RehearsalShowRealtimeFeedbackLabel=PowerpointPresenterCoachStrings.RehearsalShowRealtimeFeedbackLabel,e.RehearsalWelcomeImageText=PowerpointPresenterCoachStrings.RehearsalWelcomeImageText,e.RehearsalWelcomePlainText=PowerpointPresenterCoachStrings.RehearsalLiveFeedbackRealtimeWelcomeLabel,e.ListeningText=PowerpointPresenterCoachStrings.ListeningText,e.PausedText=PowerpointPresenterCoachStrings.PausedText,e.CoachTitleText=PowerpointPresenterCoachStrings.CoachTitleText,e.FREValueofCoachTitle=PowerpointPresenterCoachStrings.FREValueOfCoachTitle,e.FREValueOfCoachText=PowerpointPresenterCoachStrings.FREValueOfCoachText,e.FREHowItWorksButtonLabel=PowerpointPresenterCoachStrings.FREHowItWorksButtonLabel,e.FREDismissButtonLabel=PowerpointPresenterCoachStrings.FREDismissButtonLabel,e.FREHowItWorksTitle=PowerpointPresenterCoachStrings.FREHowItWorksTitle,e.FREHowItWorksText=PowerpointPresenterCoachStrings.FREHowItWorksText,e.FRETryItButtonLabel=PowerpointPresenterCoachStrings.FRETryItButtonLabel,e.FRESetUpMicTitle=PowerpointPresenterCoachStrings.FRESetUpMicTitle,e.FRESetUpMicText=PowerpointPresenterCoachStrings.FRESetUpMicText,e.FRECountdownTitle=PowerpointPresenterCoachStrings.FRECountdownTitle,e.FRECountdownText=PowerpointPresenterCoachStrings.FRECountdownText,e.FRETooltipRealtimeFeedbackTitle=PowerpointPresenterCoachStrings.FRETooltipRealtimeFeedbackTitle,e.FRETooltipRealtimeFeedbackText1=PowerpointPresenterCoachStrings.FRETooltipRealtimeFeedbackText1,e.FRETooltipRealtimeFeedbackText2=PowerpointPresenterCoachStrings.FRETooltipRealtimeFeedbackText2,e.FRENoMicAccessTitle=PowerpointPresenterCoachStrings.FRENoMicAccessTitle,e.FRENoMicAccessText=PowerpointPresenterCoachStrings.FRENoMicAccessText,e.ColorRed="#b30921",e.ColorOrange="#f8a728",e.ColorGreen="#75d770",e.ColorWhite="#ffffff",e.ColorGrey="#B3B0AD",e.ColdTemperatureCode=0,e.JustRightTemperatureCode=1,e.HotTemperatureCode=2,e.UpdateTimerIntervalInMS=1e3,e.MaxedTimer="59:59",e.PriorityKey="priority",e.TimeoutInMSKey="timeoutInMS",e.RealtimeLabelKey="realtimeLabel",e.MessageKey="message",e.ImageFilenameKey="imageFilename",e.ImageUrlKey="imageUrl",e.GaugeRotationKey="gaugeRotation",e.FEnsureDisplayGaugeKey="fEnsureDisplayGauge",e.TemperatureCodeKey="temperatureCode",e.TemperatureColdLabelKey="coldLabel",e.TemperatureHotLabelKey="hotLabel",e.ResetRehearsalIntervalInMS=5e3,e.RehearsalDashboardResizingWaitTimeInMS=500,e.RehearsalDashboardWidth=210,e.RehearsalDashboardMinimizedHeight=38,e.RehearsalDashboardMaximizedHeight=176,e.RehearsalDashboardTrackerHeight=118,e.RehearsalDashboardFirstRunMaximizedHeight=384,e.RehearsalDashboardFirstRunWelcomeDivHeight=364,e.RehearsalDashboardPadding=13,e.RehearsalDashboardRealtimeFeedbackCheckboxAddedHeight=29,e.RehearsalInteractivePanelHeight=38,e.RehearsalListeningIconHeight=16,e.RehearsalListeningIconMarginTop=8,e.RehearsalListeningButtonHeight=30,e.RehearsalSVGNamespace="http://www.w3.org/2000/svg",e.FRehearsalAlreadyTriggeredDuringSession=!1,e.FRealtimeFeedbackEnabled=!0,e.RehearsalKeyboardFocusTabIndex=3,e.RehearsalContainerFocusTabIndex=0,e.RehearsalRealtimeCheckboxFocusTabIndex=0,e.OnboardingMessage=PowerpointPresenterCoachStrings.RehearsalLiveFeedbackOnboardingMessage,e.OnboardingFeatureName=PowerpointPresenterCoachStrings.OnboardingFeatureName,e.SlideTrackerTextFormat=function(e,t){return PowerpointPresenterCoachStrings.CoachActorSlideTrackerTextFormat.replace("{0}",e.toString()).replace("{1}",t.toString())},e.TTSHandlerString="TextToSpeechHandler.ashx?action=TextToSpeech&text=",e.RehearsalEnableNotificationsTooltip=PowerpointPresenterCoachStrings.RehearsalEnableNotificationsTooltip,e.RehearsalDisableNotificationsTooltip=PowerpointPresenterCoachStrings.RehearsalDisableNotificationsTooltip,e.RehearsalPauseTooltip=PowerpointPresenterCoachStrings.RehearsalPauseTooltip,e.RehearsalResumeTooltip=PowerpointPresenterCoachStrings.RehearsalResumeTooltip,e.RehearsalShowVideoTooltip="Start seeing your camera",e.RehearsalHideVideoTooltip="Stop seeing your camera",e.RehearsalHideWebcamClassname="hideWebcamFeed",e.RehearsalAlertSoundFile="rehearsalAlert.mp3",e}();t.RehearsalActorSettings=a,function(e){e[e.NoMicrophone=0]="NoMicrophone",e[e.NoCamera=1]="NoCamera"}(t.RehearsalErrorReason||(t.RehearsalErrorReason={}))},function(e,t,n){var r=n(28);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(62),i=n(41),a=n(23),o=n(36),s=n(21),c=n(116),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=a(e),t=o(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(0),i=n(11),a=n(5);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a((function(){n(1)})),"Object",o)}},function(e,t,n){var r=n(27),i=n(61),a=n(17),o=n(9),s=n(132);e.exports=function(e,t){var n=1==e,c=2==e,l=3==e,u=4==e,h=6==e,m=5==e||h,d=t||s;return function(t,s,p){for(var f,g,v=a(t),y=i(v),C=r(s,p,3),S=o(y.length),_=0,T=n?d(t,S):c?d(t,0):void 0;S>_;_++)if((m||_ in y)&&(g=C(f=y[_],_,v),e))if(n)T[_]=g;else if(g)switch(e){case 3:return!0;case 5:return f;case 6:return _;case 2:T.push(f)}else if(u)return!1;return h?-1:l||u?u:T}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";if(n(14)){var r=n(43),i=n(4),a=n(5),o=n(0),s=n(78),c=n(104),l=n(27),u=n(55),h=n(41),m=n(22),d=n(56),p=n(29),f=n(9),g=n(143),v=n(45),y=n(36),C=n(21),S=n(63),_=n(7),T=n(17),b=n(96),R=n(46),w=n(48),E=n(47).f,M=n(98),I=n(42),F=n(8),D=n(32),A=n(68),k=n(64),x=n(100),L=n(53),P=n(71),W=n(54),N=n(99),O=n(134),V=n(15),B=n(30),H=V.f,U=B.f,q=i.RangeError,j=i.TypeError,G=i.Uint8Array,z=Array.prototype,J=c.ArrayBuffer,X=c.DataView,Q=D(0),Y=D(2),K=D(3),Z=D(4),$=D(5),ee=D(6),te=A(!0),ne=A(!1),re=x.values,ie=x.keys,ae=x.entries,oe=z.lastIndexOf,se=z.reduce,ce=z.reduceRight,le=z.join,ue=z.sort,he=z.slice,me=z.toString,de=z.toLocaleString,pe=F("iterator"),fe=F("toStringTag"),ge=I("typed_constructor"),ve=I("def_constructor"),ye=s.CONSTR,Ce=s.TYPED,Se=s.VIEW,_e=D(1,(function(e,t){return Ee(k(e,e[ve]),t)})),Te=a((function(){return 1===new G(new Uint16Array([1]).buffer)[0]})),be=!!G&&!!G.prototype.set&&a((function(){new G(1).set({})})),Re=function(e,t){var n=p(e);if(n<0||n%t)throw q("Wrong offset!");return n},we=function(e){if(_(e)&&Ce in e)return e;throw j(e+" is not a typed array!")},Ee=function(e,t){if(!_(e)||!(ge in e))throw j("It is not a typed array constructor!");return new e(t)},Me=function(e,t){return Ie(k(e,e[ve]),t)},Ie=function(e,t){for(var n=0,r=t.length,i=Ee(e,r);r>n;)i[n]=t[n++];return i},Fe=function(e,t,n){H(e,t,{get:function(){return this._d[n]}})},De=function(e){var t,n,r,i,a,o,s=T(e),c=arguments.length,u=c>1?arguments[1]:void 0,h=void 0!==u,m=M(s);if(null!=m&&!b(m)){for(o=m.call(s),r=[],t=0;!(a=o.next()).done;t++)r.push(a.value);s=r}for(h&&c>2&&(u=l(u,arguments[2],2)),t=0,n=f(s.length),i=Ee(this,n);n>t;t++)i[t]=h?u(s[t],t):s[t];return i},Ae=function(){for(var e=0,t=arguments.length,n=Ee(this,t);t>e;)n[e]=arguments[e++];return n},ke=!!G&&a((function(){de.call(new G(1))})),xe=function(){return de.apply(ke?he.call(we(this)):we(this),arguments)},Le={copyWithin:function(e,t){return O.call(we(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return Z(we(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return N.apply(we(this),arguments)},filter:function(e){return Me(this,Y(we(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return $(we(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(we(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Q(we(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(we(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(we(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(we(this),arguments)},lastIndexOf:function(e){return oe.apply(we(this),arguments)},map:function(e){return _e(we(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(we(this),arguments)},reduceRight:function(e){return ce.apply(we(this),arguments)},reverse:function(){for(var e,t=we(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return K(we(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(we(this),e)},subarray:function(e,t){var n=we(this),r=n.length,i=v(e,r);return new(k(n,n[ve]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,f((void 0===t?r:v(t,r))-i))}},Pe=function(e,t){return Me(this,he.call(we(this),e,t))},We=function(e){we(this);var t=Re(arguments[1],1),n=this.length,r=T(e),i=f(r.length),a=0;if(i+t>n)throw q("Wrong length!");for(;a<i;)this[t+a]=r[a++]},Ne={entries:function(){return ae.call(we(this))},keys:function(){return ie.call(we(this))},values:function(){return re.call(we(this))}},Oe=function(e,t){return _(e)&&e[Ce]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Ve=function(e,t){return Oe(e,t=y(t,!0))?h(2,e[t]):U(e,t)},Be=function(e,t,n){return!(Oe(e,t=y(t,!0))&&_(n)&&C(n,"value"))||C(n,"get")||C(n,"set")||n.configurable||C(n,"writable")&&!n.writable||C(n,"enumerable")&&!n.enumerable?H(e,t,n):(e[t]=n.value,e)};ye||(B.f=Ve,V.f=Be),o(o.S+o.F*!ye,"Object",{getOwnPropertyDescriptor:Ve,defineProperty:Be}),a((function(){me.call({})}))&&(me=de=function(){return le.call(this)});var He=d({},Le);d(He,Ne),m(He,pe,Ne.values),d(He,{slice:Pe,set:We,constructor:function(){},toString:me,toLocaleString:xe}),Fe(He,"buffer","b"),Fe(He,"byteOffset","o"),Fe(He,"byteLength","l"),Fe(He,"length","e"),H(He,fe,{get:function(){return this[Ce]}}),e.exports=function(e,t,n,c){var l=e+((c=!!c)?"Clamped":"")+"Array",h="get"+e,d="set"+e,p=i[l],v=p||{},y=p&&w(p),C=!p||!s.ABV,T={},b=p&&p.prototype,M=function(e,n){H(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[h](n*t+r.o,Te)}(this,n)},set:function(e){return function(e,n,r){var i=e._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[d](n*t+i.o,r,Te)}(this,n,e)},enumerable:!0})};C?(p=n((function(e,n,r,i){u(e,p,l,"_d");var a,o,s,c,h=0,d=0;if(_(n)){if(!(n instanceof J||"ArrayBuffer"==(c=S(n))||"SharedArrayBuffer"==c))return Ce in n?Ie(p,n):De.call(p,n);a=n,d=Re(r,t);var v=n.byteLength;if(void 0===i){if(v%t)throw q("Wrong length!");if((o=v-d)<0)throw q("Wrong length!")}else if((o=f(i)*t)+d>v)throw q("Wrong length!");s=o/t}else s=g(n),a=new J(o=s*t);for(m(e,"_d",{b:a,o:d,l:o,e:s,v:new X(a)});h<s;)M(e,h++)})),b=p.prototype=R(He),m(b,"constructor",p)):a((function(){p(1)}))&&a((function(){new p(-1)}))&&P((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var a;return u(e,p,l),_(n)?n instanceof J||"ArrayBuffer"==(a=S(n))||"SharedArrayBuffer"==a?void 0!==i?new v(n,Re(r,t),i):void 0!==r?new v(n,Re(r,t)):new v(n):Ce in n?Ie(p,n):De.call(p,n):new v(g(n))})),Q(y!==Function.prototype?E(v).concat(E(y)):E(v),(function(e){e in p||m(p,e,v[e])})),p.prototype=b,r||(b.constructor=p));var I=b[pe],F=!!I&&("values"==I.name||null==I.name),D=Ne.values;m(p,ge,!0),m(b,Ce,l),m(b,Se,!0),m(b,ve,p),(c?new p(1)[fe]==l:fe in b)||H(b,fe,{get:function(){return l}}),T[l]=p,o(o.G+o.W+o.F*(p!=v),T),o(o.S,l,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*a((function(){v.of.call(p,1)})),l,{from:De,of:Ae}),"BYTES_PER_ELEMENT"in b||m(b,"BYTES_PER_ELEMENT",t),o(o.P,l,Le),W(l),o(o.P+o.F*be,l,{set:We}),o(o.P+o.F*!F,l,Ne),r||b.toString==me||(b.toString=me),o(o.P+o.F*a((function(){new p(1).slice()})),l,{slice:Pe}),o(o.P+o.F*(a((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!a((function(){b.toLocaleString.call([1,2])}))),l,{toLocaleString:xe}),L[l]=F?I:D,r||F||m(b,pe,D)}}else e.exports=function(){}},function(e,t,n){var r=n(7);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(42)("meta"),i=n(7),a=n(21),o=n(15).f,s=0,c=Object.isExtensible||function(){return!0},l=!n(5)((function(){return c(Object.preventExtensions({}))})),u=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[r].i},getWeak:function(e,t){if(!a(e,r)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[r].w},onFreeze:function(e){return l&&h.NEED&&c(e)&&!a(e,r)&&u(e),e}}},function(e,t,n){var r=n(164);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(165),i=n(166);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,a=r.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<a;c=r[++n])f(c)||!S(c)?o+=" "+c:o+=" "+s(c);return o},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var a,o={};function s(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&b(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return v(i)||(i=u(e,i,r)),i}var a=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):f(t)?e.stylize("null","null"):void 0}(e,n);if(a)return a;var o=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),T(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(n);if(0===o.length){if(b(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(C(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return h(n)}var l,S="",R=!1,w=["{","}"];return d(n)&&(R=!0,w=["[","]"]),b(n)&&(S=" [Function"+(n.name?": "+n.name:"")+"]"),C(n)&&(S=" "+RegExp.prototype.toString.call(n)),_(n)&&(S=" "+Date.prototype.toUTCString.call(n)),T(n)&&(S=" "+h(n)),0!==o.length||R&&0!=n.length?r<0?C(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=R?function(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)I(t,String(o))?a.push(m(e,t,n,r,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(m(e,t,n,r,i,!0))})),a}(e,n,r,s,o):o.map((function(t){return m(e,n,r,s,t,R)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,S,w)):w[0]+S+w[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function m(e,t,n,r,i,a){var o,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),I(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=f(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),y(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function f(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function C(e){return S(e)&&"[object RegExp]"===R(e)}function S(e){return"object"==typeof e&&null!==e}function _(e){return S(e)&&"[object Date]"===R(e)}function T(e){return S(e)&&("[object Error]"===R(e)||e instanceof Error)}function b(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function w(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(y(a)&&(a=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(a)){var r=e.pid;o[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else o[n]=function(){};return o[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=f,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=C,t.isObject=S,t.isDate=_,t.isError=T,t.isFunction=b,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(174);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),E[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",M(),t.format.apply(t,arguments))},t.inherits=n(175),t._extend=function(e,t){if(!t||!S(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var F="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(F&&e[F]){var t;if("function"!=typeof(t=e[F]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),F&&Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=F,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,n).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(D,t,o)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(114))},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(118),i=n(83);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(29),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(6),i=n(119),a=n(83),o=n(82)("IE_PROTO"),s=function(){},c=function(){var e,t=n(80)("iframe"),r=a.length;for(t.style.display="none",n(84).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[a[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(118),i=n(83).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(21),i=n(17),a=n(82)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var r=n(8)("unscopables"),i=Array.prototype;null==i[r]&&n(22)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){var r=n(7);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){var r=n(15).f,i=n(21),a=n(8)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(0),i=n(34),a=n(5),o=n(86),s="["+o+"]",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),u=function(e,t,n){var i={},s=a((function(){return!!o[e]()||"​"!="​"[e]()})),c=i[e]=s?t(h):o[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},h=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=u},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(4),i=n(15),a=n(14),o=n(8)("species");e.exports=function(e){var t=r[e];a&&t&&!t[o]&&i.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(18);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setInnerHtml=t.getLightOrDarkThemeClassName=t.FocusTrap=t.combinePath=t.updateTooltip=t.addTooltip=t.hideTooltips=t.mapToObjectHelper=void 0;var i=r(n(371)),a=n(65),o=n(60);function s(){i.default.hideAll({duration:0})}t.mapToObjectHelper=function e(t){var n={};return t.forEach((function(t,r){t instanceof Map?n[r]=e(t):n[r]=t})),n},t.hideTooltips=s,t.addTooltip=function(e,t,n,r,a){i.default(e,{arrow:!0,placement:"top",content:t,theme:a?"customFluentUI":"custom",appendTo:r,interactive:!0});var o=e._tippy;e.addEventListener("keydown",(function(e){e.ctrlKey&&(s(),e.stopPropagation())}),!1);var c=function(e){e.ctrlKey&&(s(),e.stopPropagation())};e.addEventListener("mouseover",(function(e){document.addEventListener("keydown",c)})),e.addEventListener("mouseout",(function(e){document.removeEventListener("keydown",c,!1)})),o.popper.style.zIndex=""+n},t.updateTooltip=function(e,t,n){var r=e._tippy;r&&(r.setContent(t),r.popper.style.zIndex=""+n)},t.combinePath=function(e,t){if(null===e||0===(null==e?void 0:e.length)||null===t||0===t.length)return(void 0).sendTraceTag(589095433,a.LogCategory.PptSession,o.TraceLevel.Error,"CoachUtils: CombinePath Empty baseUrl and/or path"),"";var n=e,r=t;return"/"===(null==e?void 0:e.slice(-1))&&(n=e.slice(0,-1)),"/"===t.slice(0,1)&&(r=t.substr(1)),n+"/"+r};var c=function(){function e(e){this.trapElements=[],this.focusIndex=-1,this.isEnabled=!0;var t=this.trapElements;e.forEach((function(e){var n=document.getElementById(e);null!==n&&t.push(n)}))}return e.prototype.focusForward=function(e){if(this.isEnabled&&0!==this.trapElements.length){this.focusIndex=e?(this.focusIndex+1)%this.trapElements.length:(this.focusIndex+this.trapElements.length-1)%this.trapElements.length;var t=this.trapElements[this.focusIndex];null!=t&&t!==document.activeElement&&t.focus()}},e.prototype.add=function(e){this.trapElements.push(e)},e.prototype.remove=function(e){var t=this.trapElements.indexOf(e);t>-1&&this.trapElements.splice(t,1)},e.prototype.enable=function(){this.isEnabled=!0},e.prototype.disable=function(){this.isEnabled=!1},e.prototype.isTrapEnabled=function(){return this.isEnabled},e}();function l(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}t.FocusTrap=c,t.getLightOrDarkThemeClassName=function(e){return window.matchMedia("@media screen and (-ms-high-contrast: active), (forced-colors: active)").matches?function(e){if(null===e)return!1;var t=function(e){if("rgb("===e.substring(0,4)){var t=e.indexOf("("),n=e.indexOf(","),r=e.lastIndexOf(","),i=e.indexOf(")");if(-1!==t&&-1!==n&&-1!==r&&n!==r&&-1!==i)return[parseInt(e.substring(t+1,n)),parseInt(e.substring(n+1,r)),parseInt(e.substring(r+1,i))]}return[255,255,255]}(window.getComputedStyle(e).getPropertyValue("background-color"));return function(e,t,n){return.2126*l(e/255)+.7152*l(t/255)+.0722*l(n/255)}(t[0],t[1],t[2])<.17913}(e)?"dark-theme":"light-theme":""},t.setInnerHtml=function(e,t){if(e&&(e.innerText="",t&&""!==t))try{var n=(new DOMParser).parseFromString(t,"text/html");if(n&&n.body)for(var r=n.body.childNodes,i=0;i<r.length;i+=1)e.appendChild(r[i].cloneNode(!0))}catch(e){(void 0).sendTraceTag(507545558,a.LogCategory.PptSession,o.TraceLevel.Error,"unable to parse HTML, "+e)}}},function(e,t,n){var r=n(173);function i(t,n,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}},i(t,n,a||t)}e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RehearsalState=t.RehearsalActorState=t.RehearsalNotificationState=t.RehearsalPlayState=t.CoachActorElement=t.ClientType=void 0,function(e){e.Web="Web",e.Win32="Win32"}(t.ClientType||(t.ClientType={})),function(e){e.GetStartedButton="GetStartedButton",e.ListeningButtonPlayPauseButton="ListeningButtonPlayPauseButton",e.ContainerElement="ContainerElement",e.ListeningElement="ListeningElement",e.PausedElement="PausedElement",e.NotificationButtonElement="NotificationButtonElement",e.WelcomeCheckboxElement="WelcomeCheckboxElement"}(t.CoachActorElement||(t.CoachActorElement={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped",e[e.ErrorStarting=4]="ErrorStarting"}(t.RehearsalPlayState||(t.RehearsalPlayState={})),function(e){e[e.ShowingNotification=0]="ShowingNotification",e[e.NotShowingNotification=1]="NotShowingNotification"}(t.RehearsalNotificationState||(t.RehearsalNotificationState={})),function(e){e[e.VisionActor=0]="VisionActor",e[e.AudioActor=1]="AudioActor",e[e.WelcomeActor=2]="WelcomeActor",e[e.ErrorActor=3]="ErrorActor"}(t.RehearsalActorState||(t.RehearsalActorState={}));t.RehearsalState=function(){}},function(e,t,n){"use strict";n.r(t),n.d(t,"ClientWebSocket",(function(){return C})),n.d(t,"ClientWebSocketFactory",(function(){return S})),n.d(t,"requestCustomEndpointHandler",(function(){return _e})),n.d(t,"LogCategory",(function(){return r})),n.d(t,"ISpeechMode",(function(){return i})),n.d(t,"ClientApp",(function(){return a})),n.d(t,"ClientType",(function(){return o})),n.d(t,"ISpeechError",(function(){return s})),n.d(t,"ISpeechRecognitionStoppedReason",(function(){return c})),n.d(t,"IEventName",(function(){return l})),n.d(t,"IMediaEventStatus",(function(){return u})),n.d(t,"QualityStatusCode",(function(){return h})),n.d(t,"WebSocketState",(function(){return m})),n.d(t,"ISessionTimerState",(function(){return d})),n.d(t,"SpeechClientFactory",(function(){return Te})),n.d(t,"TraceLevel",(function(){return y})),n.d(t,"MediaCaptureSource",(function(){return z})),n.d(t,"RealTimeFactorHandler",(function(){return ae})),n.d(t,"SpeechStatus",(function(){return ce})),n.d(t,"SpeechClient",(function(){return me})),n.d(t,"NetworkQualityStatus",(function(){return re})),n.d(t,"SpeechHealthManager",(function(){return le})),n.d(t,"TranscriptResultJson",(function(){return N})),n.d(t,"RehearsalResultJson",(function(){return O})),n.d(t,"QualityStatusJson",(function(){return V})),n.d(t,"SpeechSessionStartedJson",(function(){return B})),n.d(t,"ClientAudioMessage",(function(){return H})),n.d(t,"ClientRequestMessage",(function(){return U})),n.d(t,"deserializeSpeechResponseMessage",(function(){return q})),n.d(t,"TelemetryManager",(function(){return X})),n.d(t,"TelemetryFieldNames",(function(){return ge})),n.d(t,"TelemetryErrorFieldNames",(function(){return ve})),n.d(t,"TranscriberSettings",(function(){return Ce})),n.d(t,"FdConnectionState",(function(){return ye})),n.d(t,"Transcriber",(function(){return Se})),n.d(t,"WebcamClient",(function(){return $}));var r,i,a,o,s,c,l,u,h,m,d,p=n(1),f=n.n(p),g=n(2),v=n.n(g);!function(e){e[e.PptSession=817]="PptSession"}(r||(r={})),function(e){e.Subtitles="Subtitles",e.Rehearsal="Rehearsal",e.Dictation="Dictation",e.Live="Live",e.ReadAlong="ReadAlong",e.ConversationTranscription="ConversationTranscription"}(i||(i={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(a||(a={})),function(e){e.web="web",e.win32="win32",e.mac="mac",e.ios="ios",e.android="android"}(o||(o={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(s||(s={})),function(e){e.Normal="Normal",e.WaitForSpeechEndTimeout="WaitForSpeechEndTimeout"}(c||(c={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(l||(l={})),function(e){e.AudioDeviceConnected="AudioDeviceConnected",e.VideoSetupCompleted="VideoSetupCompleted"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(h||(h={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(m||(m={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped"}(d||(d={}));var y,C=function(){function e(t){var n=this;f()(this,e),this.closeHandler=null,this.messageHandler=null,this.openHandler=null,this.webSocket=new WebSocket(t),this.webSocket.binaryType="arraybuffer",this.webSocket.onclose=function(e){n.closeHandler&&n.closeHandler(e.code)},this.webSocket.onmessage=function(e){n.messageHandler&&n.messageHandler(e.data)},this.webSocket.onopen=function(){n.openHandler&&n.openHandler()}}return v()(e,[{key:"close",value:function(){this.webSocket.close()}},{key:"send",value:function(e){this.webSocket.send(e)}},{key:"onclose",get:function(){return this.closeHandler},set:function(e){this.closeHandler=e}},{key:"onmessage",get:function(){return this.messageHandler},set:function(e){this.messageHandler=e}},{key:"onopen",get:function(){return this.openHandler},set:function(e){this.openHandler=e}},{key:"readyState",get:function(){switch(this.webSocket.readyState){case WebSocket.OPEN:return m.Open;case WebSocket.CONNECTING:return m.Connecting;case WebSocket.CLOSING:return m.Closing;case WebSocket.CLOSED:default:return m.Closed}}}]),e}(),S=function(){function e(){f()(this,e)}return v()(e,[{key:"createWebSocket",value:function(e){return new C(e)}}]),e}(),_=n(3),T=n.n(_),b=n(10),R=n.n(b);!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(y||(y={}));var w=n(13),E=n.n(w),M=n(38),I=n.n(M),F=n(39),D=n.n(F),A=n(16),k=n.n(A),x=n(12);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t,n=Object.create(null),r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}function W(e){var t=new Map;if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.set(i,e[i])}return t}n(111);var N=function(){function e(t){f()(this,e),this.speechResultJson=JSON.parse(t),this.transcriptsMap=W(this.speechResultJson.transcripts),this.propertiesMap=W(this.speechResultJson.properties)}return v()(e,[{key:"correlationId",get:function(){return this.speechResultJson.correlationId}},{key:"status",get:function(){return this.speechResultJson.status}},{key:"sourceLanguage",get:function(){return this.speechResultJson.sourceLanguage}},{key:"transcripts",get:function(){return this.transcriptsMap}},{key:"properties",get:function(){return this.propertiesMap}},{key:"isAdapted",get:function(){return this.speechResultJson.isAdapted}},{key:"isFinal",get:function(){return this.speechResultJson.isFinal}},{key:"isPong",get:function(){return this.speechResultJson.isPongMessage}},{key:"transcriptErrorCode",get:function(){return this.speechResultJson.transcriptErrorCode}},{key:"messageErrorCode",get:function(){return this.speechResultJson.messageErrorCode}}]),e}(),O=function(){function e(t){f()(this,e),this.rehearsalResultJson=JSON.parse(t),this.featuresMap=function e(t){for(var n=new Map,r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];t[a]instanceof Object?n.set(a,e(t[a])):n.set(a,t[a])}return n}(this.rehearsalResultJson.features)}return v()(e,[{key:"correlationId",get:function(){return this.rehearsalResultJson.correlationId}},{key:"status",get:function(){return this.rehearsalResultJson.status}},{key:"sourceLanguage",get:function(){return this.rehearsalResultJson.sourceLanguage}},{key:"isFinal",get:function(){return this.rehearsalResultJson.isFinal}},{key:"currentSlideIndex",get:function(){return this.rehearsalResultJson.currentSlideIndex}},{key:"features",get:function(){return this.featuresMap}}]),e}(),V=function(){function e(t){f()(this,e),this.qualityStatusJson=JSON.parse(t)}return v()(e,[{key:"severity",get:function(){return this.qualityStatusJson.severity}},{key:"priority",get:function(){return this.qualityStatusJson.priority}},{key:"shortCode",get:function(){return this.qualityStatusJson.shortCode}},{key:"longCode",get:function(){return this.qualityStatusJson.longCode}},{key:"shortString",get:function(){return this.qualityStatusJson.shortString}},{key:"longString",get:function(){return this.qualityStatusJson.longString}}]),e}(),B=function(){function e(t){f()(this,e),this.speechSessionStartedJson=JSON.parse(t)}return v()(e,[{key:"speechSessionId",get:function(){return this.speechSessionStartedJson.speechSessionId}},{key:"transcriptionSignature",get:function(){return this.speechSessionStartedJson.transcriptionSignature}},{key:"speechSessionHostDataCenter",get:function(){return this.speechSessionStartedJson.speechSessionHostDataCenter}}]),e}(),H=function(){function e(){f()(this,e),this.settings=new Map}return v()(e,[{key:"setProperties",value:function(e){this.settings.set("properties",JSON.stringify(P(e)))}},{key:"setOperationMetadata",value:function(e,t){var n={clientSentTimeMS:e,clientSessionSentTimeMS:t};this.settings.set("operationMetadata",JSON.stringify(n))}},{key:"setClientMetaData",value:function(e){this.settings.set("clientMetadata",JSON.stringify(e))}},{key:"serializeBinary",value:function(){var e,t,n=(new TextEncoder).encode(JSON.stringify({correlationId:this.correlationId,sourceLanguage:this.sourceLanguage,settings:P(this.settings)})),r=new Uint8Array(4+n.byteLength+(null==this.audio?0:this.audio.byteLength));return r.set((e=n.byteLength,t=new ArrayBuffer(4),new DataView(t).setInt32(0,e,!1),new Uint8Array(t))),r.set(n,4),null!=this.audio&&r.set(this.audio,4+n.byteLength),r}}]),e}(),U=function(){function e(t,n){f()(this,e),this.type=t,this.message=n}return v()(e,[{key:"serializeBinary",value:function(){var e=(new TextEncoder).encode(JSON.stringify({type:this.type,message:this.message})),t=new Uint8Array(4+e.byteLength);return t.set(e,4),t}}],[{key:"fromMap",value:function(t){return new e("DictionaryMessage",JSON.stringify(P(t)))}}]),e}();function q(e,t){var n=JSON.parse((new TextDecoder).decode(e));"speechresultmixmessage"===n.messageType&&t.handleSpeechResultMessage(new N(n.message)),"rehearsalresultmixmessage"===n.messageType&&t.handleRehearsalResultMessage(new O(n.message)),"qualitystatusmixmessage"===n.messageType&&t.handleQualityStatusMessage(new V(n.message)),"speechsessionstartedmixmessage"===n.messageType&&t.handleSpeechSessionStartedMessage(new B(n.message))}var j,G=n(24),z=function(){function e(t,n){f()(this,e),this.mediaStream=null,this.messageLen=0,this.MAX_BUFFER_SIZE=4096,this.message=new Float32Array(4096),this.m_audioCaptureInProgress=!1,this.audioHandler=null,this.c_maxBufferSize=16384,this.speechProcessorScript=t,this.m_microphoneDeviceId=n}var t;return v()(e,[{key:"startAudioCapture",value:(t=R()(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null,t=!this.m_microphoneDeviceId||{deviceId:{exact:this.m_microphoneDeviceId}},this.m_audioCaptureInProgress=!0,e.next=5,navigator.mediaDevices.getUserMedia({audio:t,video:!1});case 5:if(this.mediaStream=e.sent,this.m_audioCaptureInProgress){e.next=9;break}return this.stopAudioCapture(),e.abrupt("return",s.ErrorAudioCaptureStalePermission);case 9:return e.abrupt("return",this.initializeAudioSession());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopAudioCapture",value:function(){this.m_audioCaptureInProgress=!1,this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.streamSource&&(this.scriptNode&&this.streamSource.disconnect(this.scriptNode),this.streamSource=null),this.scriptNode&&(this.scriptNode.onaudioprocess=null,this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode=null),this.speechProcessorScript&&this.m_workletNode&&(this.m_workletNode.disconnect(this.audioCtx.destination),this.m_workletNode=null)}},{key:"pauseAudioCapture",value:function(){this.setAudioEnabled(!1)}},{key:"resumeAudioCapture",value:function(){this.setAudioEnabled(!0)}},{key:"setAudioEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e}))}},{key:"initializeAudioSession",value:function(){var t=this;return this.audioCtx=e.createAudioContext(),this.audioCtx?(this.speechProcessorScript&&this.audioCtx.audioWorklet?this.audioCtx.audioWorklet.addModule(this.speechProcessorScript).then((function(){t.connectToMediaWithAudioWorklet()})).catch((function(){t.connectToMediaWithScriptProcessor()})):this.connectToMediaWithScriptProcessor(),s.ErrorNone):s.ErrorAudioSetupFailure}},{key:"connectToMediaWithAudioWorklet",value:function(){var t=this,n=new AudioWorkletNode(this.audioCtx,"speech-processor");n.port.onmessage=function(n){var r=n.data;if(t.messageLen===t.MAX_BUFFER_SIZE){if(t.audioHandler){var i=e.encodeWAVWithoutHeader(t.message);t.audioHandler(i,Object(G.v4)())}t.messageLen=0}t.message.set(r,t.messageLen),t.messageLen+=r.length};var r=this.audioCtx.createMediaStreamSource(this.mediaStream);r.connect(n),n.connect(this.audioCtx.destination),this.m_workletNode=n,this.streamSource=r}},{key:"connectToMediaWithScriptProcessor",value:function(){var t=this;this.streamSource=this.audioCtx.createMediaStreamSource(this.mediaStream);var n=Math.pow(2,Math.floor(Math.log(.2*this.audioCtx.sampleRate)/Math.log(2))),r=n<=this.c_maxBufferSize?n:this.c_maxBufferSize;this.scriptNode=this.audioCtx.createScriptProcessor(r,1,1),this.scriptNode.onaudioprocess=function(n){if(t.audioHandler){var r=e.encodeWAVWithoutHeader(n.inputBuffer.getChannelData(0));t.audioHandler(r,Object(G.v4)())}},this.streamSource.connect(this.scriptNode),this.scriptNode.connect(this.audioCtx.destination)}},{key:"sampleRate",get:function(){return this.audioCtx?this.audioCtx.sampleRate:null}},{key:"onaudioprocess",get:function(){return this.audioHandler},set:function(e){this.audioHandler=e}}],[{key:"createAudioContext",value:function(){var e;try{e=new AudioContext}catch(e){}if(!e)try{e=new window.webkitAudioContext}catch(e){}return e}},{key:"encodeWAVWithoutHeader",value:function(t){var n=new ArrayBuffer(2*t.length),r=new DataView(n);return e.floatTo16BitPCM(r,0,t),r}},{key:"floatTo16BitPCM",value:function(e,t,n){for(var r=t,i=0;i<n.length;i+=1,r+=2){var a=Math.max(-1,Math.min(1,n[i]));e.setInt16(r,a<0?32768*a:32767*a,!0)}}}]),e}();function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=function(){function e(t){f()(this,e),this.m_sessionTelemetry=new Map,this.m_fatalErrors=new Array,this.m_nonFatalErrors=new Array,j=t,this.recordSpeechSettings()}return v()(e,[{key:"publishSessionTelemetry",value:function(){j.sendTraceTag(595686043,r.PptSession,y.Info,JSON.stringify(function(e){var t,n=Object.create(null),r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}(this.m_sessionTelemetry)))}},{key:"recordSpeechSettings",value:function(){this.m_sessionTelemetry.set(ge.DataLoggingTimeInterval,Ce.DataLoggingIntervalMS),this.m_sessionTelemetry.set(ge.FEnableContentlogging,Ce.IsContentLoggingEnabled),this.m_sessionTelemetry.set(ge.RealTimeFactorLowerThreshold,Ce.RealTimeFactorLowerThreshold),this.m_sessionTelemetry.set(ge.RealTimeFactorUpperThreshold,Ce.RealTimeFactorUpperThreshold)}},{key:"recordSpeechClientConnectionStart",value:function(e){this.initialize(),this.m_sessionTelemetry.set(ge.TranscriptionStartTime,Date.now()),this.m_sessionTelemetry.set(ge.SpeechLanguage,e.sourceLanguage),this.m_sessionTelemetry.set(ge.TranslationLanguage,e.targetLanguages),this.m_sessionTelemetry.set(ge.SpeechMode,e.speechMode)}},{key:"recordSpeechRecognitionStart",value:function(){this.m_sessionTelemetry.set(ge.SpeechClientRecognitionStartTime,Date.now())}},{key:"recordSpeechClientConnectionEnd",value:function(e){this.m_sessionTelemetry.set(ge.TranscriptionEndTime,Date.now()),this.m_sessionTelemetry.has(ge.WebSocketOpenedTimestamp)||j.sendTraceTag(593253271,r.PptSession,y.Warning,"recordSpeechClientConnectionEnd: WebSocketOpenedTimestamp is null. TranscriberID:  ".concat(e));var t=Date.now(),n=t-this.m_sessionTelemetry.get(ge.WebSocketOpenedTimestamp);this.m_sessionTelemetry.set(ge.WebSocketClosedTimestamp,t),this.m_sessionTelemetry.set(ge.WebSocketConnectionDurationMS,n),this.m_sessionTelemetry.set(ge.FatalErrors,this.m_fatalErrors),this.m_sessionTelemetry.set(ge.NonFatalErrors,this.m_nonFatalErrors)}},{key:"recordWebSocketConnectionStart",value:function(e,t){var n;n=-1!==e.toLowerCase().indexOf(".edog")?"EDog":-1!==e.toLowerCase().indexOf(".live-int.")?"Int":"Production",this.m_sessionTelemetry.set(ge.TranscriberID,t),this.m_sessionTelemetry.set(ge.Endpoint,n),this.m_sessionTelemetry.set(ge.InitializeWebSocketStartTimeMS,Date.now())}},{key:"recordWebSocketCreation",value:function(){this.m_sessionTelemetry.set(ge.WebSocketCreateTimestamp,Date.now())}},{key:"recordWebSocketRetryCounts",value:function(e){this.m_sessionTelemetry.set(ge.WebSocketRetryAttempts,e)}},{key:"recordWebSocketConnectionOpen",value:function(){this.m_sessionTelemetry.set(ge.WebSocketOpenedTimestamp,Date.now())}},{key:"recordWebSocketConnectionEnd",value:function(){this.m_sessionTelemetry.set(ge.InitializeWebSocketEndTimeMS,Date.now())}},{key:"recordCustomEndpointStart",value:function(e){this.m_sessionTelemetry.set(ge.CustomEndpointRequestCorrelationID,e),this.m_sessionTelemetry.set(ge.RequestCustomEndpointStartTimeMS,Date.now())}},{key:"recordCustomEndpointEnd",value:function(e){this.m_sessionTelemetry.set(ge.WebSocketCustomEndpoint,e),this.m_sessionTelemetry.set(ge.RequestCustomEndpointEndTimeMS,Date.now())}},{key:"recordCustomEndpointError",value:function(){this.m_sessionTelemetry.set(ge.RequestCustomEndpointFailedEndTimeMS,Date.now())}},{key:"recordCustomEndpointTimeout",value:function(){this.m_sessionTelemetry.set(ge.RequestCustomEndpointTimedOutEndTimeMS,Date.now())}},{key:"recordFrontdoorRoundTripLatency",value:function(e){this.m_sessionTelemetry.set(ge.AverageFrontDoorRoundTripLatencyCount,e)}},{key:"recordNetworkQuality",value:function(e,t){this.m_sessionTelemetry.set(ge.TotalNetworkErrorMessageCount,e),this.m_sessionTelemetry.set(ge.TotalNetworkWarningMessageCount,t)}},{key:"recordInitialAudioMessage",value:function(){this.m_sessionTelemetry.has(ge.SendFirstMessageTime)||this.m_sessionTelemetry.set(ge.SendFirstMessageTime,Date.now())}},{key:"recordAudioStatistics",value:function(e,t){this.m_sessionTelemetry.set(ge.AudioFactorCalculationDurationMS,e),this.m_sessionTelemetry.set(ge.TotalAudioFactorOutsideOfThresholdCount,t)}},{key:"recordInitialMessageLatency",value:function(){if(!this.m_sessionTelemetry.has(ge.FirstMessageLatencyMS)&&this.m_sessionTelemetry.get(ge.SendFirstMessageTime)){var e=Date.now()-this.m_sessionTelemetry.get(ge.SendFirstMessageTime);this.m_sessionTelemetry.set(ge.FirstMessageLatencyMS,e)}}},{key:"recordPartialMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(ge.MaxPartialMessageLatencyMS,e),this.m_sessionTelemetry.set(ge.MinPartialMessageLatencyMS,t),this.m_sessionTelemetry.set(ge.TotalPartialMessagesCount,n),this.m_sessionTelemetry.set(ge.TotalHighLatencyPartialMessagesCount,r),this.m_sessionTelemetry.set(ge.TotalPartialMessageLatency,i)}},{key:"recordFinalMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(ge.MaxFinalMessageLatencyMS,e),this.m_sessionTelemetry.set(ge.MinFinalMessageLatencyMS,t),this.m_sessionTelemetry.set(ge.TotalFinalMessagesCount,n),this.m_sessionTelemetry.set(ge.TotalHighLatencyFinalMessagesCount,r),this.m_sessionTelemetry.set(ge.TotalFinalMessageLatency,i)}},{key:"recordMessageLatencyStats",value:function(e,t,n){this.m_sessionTelemetry.set(ge.TotalMessageCorrelationIDNotFoundCount,e),this.m_sessionTelemetry.set(ge.LatencyTableDeletedCount,t),this.m_sessionTelemetry.set(ge.TotalEntriesInLatencyTable,n)}},{key:"recordRealTimeReceiveFactorStats",value:function(e,t){this.m_sessionTelemetry.set(ge.TotalTranscriptOutsideOfThresholdCount,e),this.m_sessionTelemetry.set(ge.MessageLatencyCalculationTimeMS,t)}},{key:"recordSpeechClientError",value:function(e,t,n,i){var a={};a.ErrorName=e||"ErrorEmpty",a.ErrorReason=t,a.ClientTimestampMS=n;var o=i?this.m_fatalErrors:this.m_nonFatalErrors;o.length<10?o.push(a):j.sendTraceTag(593253272,r.PptSession,y.Warning,"Transcriber::recordSpeechClientError Will not append error to error list because the list contains too many errors ".concat(JSON.stringify(a)))}},{key:"recordWebsocketCloseError",value:function(e){this.m_sessionTelemetry.set(ve.WebSocketErrorCode,e)}},{key:"initialize",value:function(){this.m_fatalErrors=[],this.m_nonFatalErrors=[],this.m_sessionTelemetry.clear()}}]),e}(),Q=n(58),Y=n.n(Q),K=function(){function e(){f()(this,e),this.mediaStream=null,this.__isCapturing=!1}var t;return v()(e,[{key:"startMediaCapture",value:(t=R()(T.a.mark((function e(t,n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:{width:t,height:n,facingMode:"user"}});case 2:return this.mediaStream=e.sent,e.abrupt("return",this.initializeWebcamCapture());case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.isCapturing=!1}},{key:"pauseMediaCapture",value:function(){this.setMediaEnabled(!1)}},{key:"resumeMediaCapture",value:function(){this.setMediaEnabled(!0)}},{key:"setMediaEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e})),this.isCapturing=e}},{key:"initializeWebcamCapture",value:function(){if(!this.mediaStream)return s.ErrorWebcamSetupFailure;var e=this.mediaStream.getVideoTracks();return 0===e.length?s.ErrorWebcamNotFoundError:e.length>1?s.ErrorMultipleWebcamsFound:(this.isCapturing=!0,s.ErrorNone)}},{key:"isCapturing",set:function(e){e!==this.__isCapturing&&this.onCapturingContentChanged(e),this.__isCapturing=e}},{key:"stream",get:function(){return this.mediaStream}}]),e}();var Z=function e(){f()(this,e)};Z.defaultRequestedVideoHeight=322,Z.defaultRequestedVideoWidth=572;var $=function(e){I()(r,e);var t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return D()(this,n)}}(r);function r(e,t){var i;return f()(this,r),(i=n.call(this)).lastVideoWidth=-1,i.lastVideoHeight=-1,i.requestedVideoHeight=Z.defaultRequestedVideoHeight,i.requestedVideoWidth=Z.defaultRequestedVideoWidth,i.onWebcamFrame=null,i.processFeedHandler=null,e.requestedVideoWidth&&(i.requestedVideoWidth=e.requestedVideoWidth),e.requestedVideoHeight&&(i.requestedVideoHeight=e.requestedVideoHeight),i.videoView=e.videoView,i.workingCanvas=e.workingCanvas,i.webcamFrameWidth=e.webcamFrameWidth?e.webcamFrameWidth:500,i.delayBetweenCapturesMS=1e3/e.numFramesPerSecond,i.onWebcamFrame=t,i.workingCanvas&&(i.workingCanvas.width=i.webcamFrameWidth),i}return v()(r,[{key:"startMediaCapture",value:(t=R()(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y()(k()(r.prototype),"startMediaCapture",this).call(this,this.requestedVideoWidth,this.requestedVideoHeight);case 2:if((t=e.sent)===s.ErrorNone){e.next=5;break}return e.abrupt("return",t);case 5:return this.videoView.srcObject=this.stream,e.next=8,this.videoView.play();case 8:return e.abrupt("return",s.ErrorNone);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.videoView.pause(),this.videoView.srcObject=null,Y()(k()(r.prototype),"stopMediaCapture",this).call(this)}},{key:"tryCaptureFrame",value:function(){if(!this.videoView||!this.workingCanvas)return null;var e=this.workingCanvas.getContext("2d");if(!e)return null;if((this.videoView.videoHeight!==this.lastVideoHeight||this.videoView.videoWidth!==this.lastVideoWidth)&&this.videoView.videoWidth){var t=this.webcamFrameWidth/this.videoView.videoWidth;this.workingCanvas.height=t*this.videoView.videoHeight,this.lastVideoHeight=this.videoView.videoHeight,this.lastVideoWidth=this.videoView.videoWidth}return e.drawImage(this.videoView,0,0,this.workingCanvas.width,this.workingCanvas.height),this.workingCanvas.toDataURL("image/jpeg")}},{key:"tryProcessFeed",value:function(){if(this.onWebcamFrame){var e=this.tryCaptureFrame();e&&this.onWebcamFrame(e,Object(G.v4)())}}},{key:"onCapturingContentChanged",value:function(e){var t=this;this.onWebcamFrame&&(e?this.processFeedHandler=setInterval((function(){return t.tryProcessFeed()}),this.delayBetweenCapturesMS):this.processFeedHandler&&clearInterval(this.processFeedHandler))}}]),r}(K);function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te,ne,re,ie=function(){function e(){f()(this,e),this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted,this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted}return v()(e,[{key:"restart",value:function(e){this.timerState=e?d.Started:d.Paused,this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0}},{key:"resume",value:function(){this.timerState===d.Paused&&(this.timerState=d.Started,this.lastStartTimeInMS=Date.now())}},{key:"pause",value:function(){this.timerState===d.Started&&(this.timerState=d.Paused,this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS)}},{key:"stop",value:function(){this.timerState===d.Started&&(this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS),this.timerState=d.Stopped}},{key:"getElapsedSessionTimeInMS",value:function(){return this.timerState===d.Started?this.elapsedSessionTimeInMS+(Date.now()-this.lastStartTimeInMS):this.elapsedSessionTimeInMS}}]),e}(),ae=function(){function e(t,n){f()(this,e),this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_transcriberId="",this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_startTime=0,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0,this.m_intervalTranscript=Ce.DataLoggingIntervalMS,this.m_intervalAudio=Ce.DataLoggingIntervalMS,this.m_lastAudioLogUTC=Date.now(),this.m_lastTranscriptLogUTC=Date.now(),te=t,this.telemetryManager=n}return v()(e,[{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_startTime=Date.now()}},{key:"calculatePreAudioMetrics",value:function(e){this.m_currentSentAudioTimeUTC=Date.now();var t=Date.now()-e;this.m_prepAudioCount+=1,this.m_prepAudioSum+=t,this.m_minPrepAudio=Math.min(this.m_minPrepAudio,t),this.m_maxPrepAudio=Math.max(this.m_maxPrepAudio,t)}},{key:"calculateAndLogRealTimeSendFactorStats",value:function(e){try{var t=Date.now();if(this.m_totalAudioMessageCountInCurrentTimeInterval+=1,this.m_totalAudioMessageCountInPreviousTimeInterval>0&&this.m_lastSentAudioTimeUTC<Number.MAX_VALUE){var n=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval,i=Date.now()-this.m_lastSentAudioTimeUTC,a=n/(i>0?i:1);a>0&&this.calculateRealTimeSendFactorStats(e,a,i,n)}Date.now()-this.m_lastAudioLogUTC>Ce.DataLoggingIntervalMS&&this.logRealTimeSendStatsForEachInterval(),this.m_lastSentAudioTimeUTC=this.m_currentSentAudioTimeUTC;var o=Date.now()-t;this.m_audioFactorCalculationDuration+=o}catch(e){te.sendTraceTag(595716178,r.PptSession,y.Warning,"calculateAndLogRealTimeSendFactorStats: Calculating audio sending metrics threw an exception: ".concat(e,"\n             TranscriberID: ").concat(this.m_transcriberId))}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_startTime=0,this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0}},{key:"calculateRealTimeSendFactorStats",value:function(e,t,n,i){if(this.m_realTimeSendDataFactorCount+=1,this.m_realTimeSendDataFactorSum+=t,this.m_minRealTimeSendDataFactor=Math.min(this.m_minRealTimeSendDataFactor,t),this.m_maxRealTimeSendDataFactor=Math.max(this.m_maxRealTimeSendDataFactor,t),this.m_realTimeSendDataFactorCountInTimeInterval+=1,this.m_realTimeSendDataFactorSumInTimeInterval+=t,this.m_minRealTimeSendDataFactorInTimeInterval=Math.min(this.m_minRealTimeSendDataFactorInTimeInterval,t),this.m_maxRealTimeSendDataFactorInTimeInterval=Math.max(this.m_maxRealTimeSendDataFactorInTimeInterval,t),t<Ce.RealTimeFactorLowerThreshold||t>Ce.RealTimeFactorUpperThreshold){this.m_totalAudioFactorOutsideOfThresholdCount+=1;var a=0,o=0,s=0;this.m_realTimeSendDataFactorCount>0&&(a=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,o=this.m_minRealTimeSendDataFactor,s=this.m_maxRealTimeSendDataFactor),te.sendTraceTag(595716176,r.PptSession,y.Warning,JSON.stringify({MessageCorrelationID:e,SessionDurationInMS:Date.now()-this.m_startTime,RealTimeSendingDataFactor:t,AvgRealTimeSendingDataFactor:a,MinRealTimeSendingDataFactor:o,MaxRealTimeSendingDataFactor:s,AvgSendingDataDurationForInterval:i,RealTimeDurationForCurrentMessage:n,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeSendStatsForEachInterval",value:function(){var e=0,t=0,n=0;this.m_realTimeSendDataFactorCount>0&&(e=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,t=this.m_minRealTimeSendDataFactor,n=this.m_maxRealTimeSendDataFactor);var i=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(i=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval);var a=0,o=0,s=0;this.m_realTimeSendDataFactorCountInTimeInterval>0&&(a=1*this.m_realTimeSendDataFactorSumInTimeInterval/this.m_realTimeSendDataFactorCountInTimeInterval,o=this.m_minRealTimeSendDataFactorInTimeInterval,s=this.m_maxRealTimeSendDataFactorInTimeInterval);var c=0,l=0,u=0;this.m_prepAudioCount>0&&(c=this.m_prepAudioSum/this.m_prepAudioCount,l=this.m_minPrepAudio,u=this.m_maxPrepAudio),te.sendTraceTag(595716177,r.PptSession,y.Info,JSON.stringify({SessionDurationInMS:Date.now()-this.m_startTime,AvgRealTimeSendingDataFactor:e,MinRealTimeSendingDataFactor:t,MaxRealTimeSendingDataFactor:n,AvgRealTimeSendingDataFactorForInterval:a,MinRealTimeSendingDataFactorForInterval:o,MaxRealTimeSendingDataFactorForInterval:s,AvgPrepAudioForInterval:c,MinPrepAudioForInterval:l,MaxPrepAudioForInterval:u,AvgSendingDataDurationForInterval:i,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId})),this.m_totalAudioMessageCountInPreviousTimeInterval=this.m_totalAudioMessageCountInCurrentTimeInterval,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_lastAudioLogUTC=Date.now(),this.resetAudioIntervalStats()}},{key:"resetAudioIntervalStats",value:function(){this.m_startLogIntervalAudio<Number.MAX_VALUE&&(this.m_intervalAudio=Date.now()-this.m_startLogIntervalAudio),this.m_startLogIntervalAudio=Date.now()}},{key:"calculateAndLogRealTimeReceiveFactorStats",value:function(e,t,n,r,i){var a=Date.now()-e;this.m_messageLatencyCalculationTime+=a;var o=0,s=0,c=0;this.m_totalTranscriptMessageCountInCurrentTimeInterval+=1,this.m_totalTranscriptMessageCountInPreviousTimeInterval>0&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(o=(c=this.m_intervalTranscript/this.m_totalTranscriptMessageCountInPreviousTimeInterval)/((s=Date.now()-this.m_lastReceivedTranscriptTimeUTC)>0?s:1))>0&&this.calculateRealTimeReceiveFactorStats(t,n,r,i,o,c,s),Ce.IsLogEachTranscriptMessage||this.logRealTimeReceiveStatsForEachTranscript(t,n,r,i,c,o),Date.now()-this.m_lastTranscriptLogUTC>Ce.DataLoggingIntervalMS&&this.logRealTimeReceiveStatsForEachInterval(t,n,r,i),this.m_lastReceivedTranscriptTimeUTC=Date.now()}},{key:"calculateRealTimeReceiveFactorStats",value:function(e,t,n,i,a,o,s){if(this.m_realTimeReceiveDataFactorCount+=1,this.m_realTimeReceiveDataFactorSum+=a,this.m_minRealTimeReceiveDataFactor=Math.min(this.m_minRealTimeReceiveDataFactor,a),this.m_maxRealTimeReceiveDataFactor=Math.max(this.m_maxRealTimeReceiveDataFactor,a),this.m_realTimeReceiveDataFactorCountInTimeInterval+=1,this.m_realTimeReceiveDataFactorSumInTimeInterval+=a,this.m_minRealTimeReceiveDataFactorInTimeInterval=Math.min(this.m_minRealTimeReceiveDataFactorInTimeInterval,a),this.m_maxRealTimeReceiveDataFactorInTimeInterval=Math.max(this.m_maxRealTimeReceiveDataFactorInTimeInterval,a),!Ce.IsLogEachTranscriptMessage&&(a<Ce.RealTimeFactorLowerThreshold||a>Ce.RealTimeFactorUpperThreshold)){this.m_totalTranscriptFactorOutsideOfThresholdCount+=1;var c=0,l=0,u=0;this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,l=this.m_minRealTimeReceiveDataFactor,u=this.m_maxRealTimeReceiveDataFactor),te.sendTraceTag(595716104,r.PptSession,y.Warning,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:a,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:l,MaxRealTimeReceivingDataFactor:u,AvgReceivingDataDurationForInterval:o,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeReceiveStatsForEachTranscript",value:function(e,t,n,i,a,o){var s=0,c=0,l=0,u=0,h=0,m=0,d=0;0===this.m_totalTranscriptMessageCountInPreviousTimeInterval&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(s=Date.now()-this.m_lastReceivedTranscriptTimeUTC),this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,l=this.m_minRealTimeReceiveDataFactor,u=this.m_maxRealTimeReceiveDataFactor),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(h=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,m=this.m_minRealTimeReceiveDataFactorInTimeInterval,d=this.m_maxRealTimeReceiveDataFactorInTimeInterval),te.sendTraceTag(595716105,r.PptSession,y.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:o,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:l,MaxRealTimeReceivingDataFactor:u,AvgRealTimeReceivingDataFactorForInterval:h,MinRealTimeReceivingDataFactorForInterval:m,MaxRealTimeReceivingDataFactorForInterval:d,AvgReceivingDataDurationForInterval:a,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}},{key:"logRealTimeReceiveStatsForEachInterval",value:function(e,t,n,i){var a=0,o=0,s=0,c=0,l=0,u=0;if(!Ce.IsLogEachTranscriptMessage){this.m_realTimeReceiveDataFactorCount>0&&(a=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,o=this.m_minRealTimeReceiveDataFactor,s=this.m_maxRealTimeReceiveDataFactor);var h=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(h=this.m_intervalTranscript/this.m_totalAudioMessageCountInPreviousTimeInterval),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(c=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,l=this.m_minRealTimeReceiveDataFactorInTimeInterval,u=this.m_maxRealTimeReceiveDataFactorInTimeInterval),te.sendTraceTag(595716106,r.PptSession,y.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,AvgRealTimeReceivingDataFactor:a,MinRealTimeReceivingDataFactor:o,MaxRealTimeReceivingDataFactor:s,AvgRealTimeReceivingDataFactorForInterval:c,MinRealTimeReceivingDataFactorForInterval:l,MaxRealTimeReceivingDataFactorForInterval:u,AvgReceivingDataDurationForInterval:h,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}this.m_totalTranscriptMessageCountInPreviousTimeInterval=this.m_totalTranscriptMessageCountInCurrentTimeInterval,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_lastTranscriptLogUTC=Date.now(),this.resetTranscriptInterval()}},{key:"resetTranscriptInterval",value:function(){this.m_startLogIntervalTranscript<Number.MAX_VALUE&&(this.m_intervalTranscript=Date.now()-this.m_startLogIntervalTranscript),this.m_startLogIntervalTranscript=Date.now()}},{key:"onSessionEnd",value:function(){this.telemetryManager.recordAudioStatistics(this.m_audioFactorCalculationDuration,this.m_totalAudioFactorOutsideOfThresholdCount),this.telemetryManager.recordRealTimeReceiveFactorStats(this.m_totalTranscriptFactorOutsideOfThresholdCount,this.m_messageLatencyCalculationTime)}}]),e}(),oe=function e(){f()(this,e)};oe.HeartbeatInterval=5e3,oe.RoundtripLatencyWarnThreshold=500,oe.PongMessageReceieveMaxTimeout=oe.HeartbeatInterval+1e4,oe.NetworkPingPongWarningThresholdInMs=500,oe.NetworkPingPongErrorThresholdInMs=2e3,oe.NetworkPingPongMaxWarningCount=6,oe.NetworkPingPongMaxErrorCount=3,oe.NetworkQualityWarningPriority=10,oe.NetworkQualityErrorPriority=100,function(e){e[e.Normal=0]="Normal",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(re||(re={}));var se,ce,le=function(){function e(t,n){f()(this,e),this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.c_maxEntriesInLatencyTable=1200,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_pongMessageTimerId=0,this.m_isWaitingForPongResponse=!1,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0,this.events=new x.EventEmitter,ne=t,this.telemetryManager=n,this.m_realTimeFactorHandler=new ae(t,this.telemetryManager)}return v()(e,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_realTimeFactorHandler.startSession(e),this.m_pongMessageTimerId=setInterval(this.checkForPongResponse.bind(this),oe.PongMessageReceieveMaxTimeout)}},{key:"resetMessageLatency",value:function(){this.m_messageLatencyTable={}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0}},{key:"logRoundTripLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,RoundtripLatencyMS:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};ne.sendTraceTag(595716097,r.PptSession,y.Warning,JSON.stringify(n))}},{key:"logMessageLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,PartialMessageLatency:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};ne.sendTraceTag(595716097,r.PptSession,y.Warning,JSON.stringify(n))}},{key:"calculateMessageLatencyStats",value:function(e,t){t>=Ce.FragmentLatencyWarnThreshold?(this.m_countFragmentLatencyInWarnWindow=Math.min(Ce.FragmentLatencyWarnWindow,this.m_countFragmentLatencyInWarnWindow+1),t>=Ce.FragmentLatencyErrorThreshold?this.m_countFragmentLatencyInErrorWindow=Math.min(Ce.FragmentLatencyErrorWindow,this.m_countFragmentLatencyInErrorWindow+1):this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)):(this.m_countFragmentLatencyInWarnWindow=Math.max(0,this.m_countFragmentLatencyInWarnWindow-1),this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)),t>=Ce.FragmentLatencyWarnThreshold&&this.logMessageLatencyInfo(e,t)}},{key:"calculateRoundTripLatencyStats",value:function(e,t){t>=Ce.RoundtripLatencyWarnThreshold?(this.m_countRoundtripLatencyInWarnWindow=Math.min(Ce.FragmentLatencyWarnWindow,this.m_countRoundtripLatencyInWarnWindow+1),t>=Ce.RoundtripLatencyErrorThreshold?this.m_countRoundtripLatencyInErrorWindow=Math.min(Ce.FragmentLatencyErrorWindow,this.m_countRoundtripLatencyInErrorWindow+1):this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)):(this.m_countRoundtripLatencyInWarnWindow=Math.max(0,this.m_countRoundtripLatencyInWarnWindow-1),this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)),t>=Ce.RoundtripLatencyWarnThreshold&&this.logRoundTripLatencyInfo(e,t)}},{key:"calculateNetworkQualityStats",value:function(e,t,n){var i=this.m_currentHeartbeatSendInterval>=Ce.HeartbeatInterval+Ce.RoundtripLatencyWarnThreshold,a=this.m_currentHeartbeatLatency>=Ce.RoundtripLatencyWarnThreshold,o=!i&&a;this.m_countFragmentLatencyInErrorWindow>=Ce.FragmentLatencyErrorWindow||this.m_countRoundtripLatencyInErrorWindow>=Ce.FragmentLatencyErrorWindow?(this.m_inFragmentLatencyErrorStatus=!0,this.m_totalNetworkErrorMessageCount+=1):0===this.m_countFragmentLatencyInErrorWindow&&0===this.m_countRoundtripLatencyInErrorWindow&&(this.m_inFragmentLatencyErrorStatus=!1,this.m_gapNumberBetweenPingPongMessage=0),this.m_countFragmentLatencyInWarnWindow>=Ce.FragmentLatencyWarnWindow||this.m_countRoundtripLatencyInWarnWindow>=Ce.FragmentLatencyWarnWindow?(this.m_inFragmentLatencyWarnStatus=!0,this.m_totalNetworkWarningMessageCount+=1):0===this.m_countFragmentLatencyInWarnWindow&&0===this.m_countRoundtripLatencyInWarnWindow&&(this.m_inFragmentLatencyWarnStatus=!1);var s={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,PartialMessageLatency:t,RoundtripLatencyMS:n,MessageCorrelationID:e,TranscriberID:this.m_transcriberId,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,IsHighHeartbeatLatency:a,IsBrowserFreeze:i,IsNetworkIssue:o};this.m_inFragmentLatencyErrorStatus?ne.sendTraceTag(595716098,r.PptSession,y.Error,JSON.stringify(s)):this.m_inFragmentLatencyWarnStatus&&ne.sendTraceTag(595716099,r.PptSession,y.Error,JSON.stringify(s))}},{key:"onPingMessageSent",value:function(e){this.m_isWaitingForPongResponse=!0;var t=0!==this.m_heartbeatSendTime?this.m_heartbeatSendTime:Date.now(),n=Date.now(),i=n-t;this.m_heartbeatSendTime=n,this.m_currentHeartbeatSendInterval=i;var a={RealHeartbeatSendInterval:i,PreHeartbeatSendTime:t,CurHeartbeatSendTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};if(i>oe.HeartbeatInterval+oe.RoundtripLatencyWarnThreshold?ne.sendTraceTag(595716173,r.PptSession,y.Warning,JSON.stringify(a)):ne.sendTraceTag(595716174,r.PptSession,y.Info,JSON.stringify(a)),this.m_gapNumberBetweenPingPongMessage>=2){var o=Ce.NoInternetConnectionInMs;this.calculateRoundTripLatencyStats(e,o),this.calculateNetworkQualityStats(e,-1,o),ne.sendTraceTag(595716175,r.PptSession,y.Error,"Transcriber::startSpeechConnection Probably loss network connection: TranscriberID: ".concat(this.m_transcriberId," CorrelationID: ").concat(e)),this.telemetryManager.recordSpeechClientError(ve.LossInternetConnection,"gapNumberBetweenPingPongMessage :".concat(this.m_gapNumberBetweenPingPongMessage),Date.now(),!1)}this.m_gapNumberBetweenPingPongMessage+=1}},{key:"checkForPongResponse",value:function(){this.m_isWaitingForPongResponse&&this.updateNetworkQuality(re.Error)}},{key:"detectNetworkQuality",value:function(e){switch(e>=oe.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount<oe.NetworkPingPongMaxWarningCount?this.m_networkQualityWarningCount+=1:e<oe.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount>0&&(this.m_networkQualityWarningCount-=1),e>=oe.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount<oe.NetworkPingPongMaxErrorCount?this.m_networkQualityErrorCount+=1:e<oe.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount>0&&(this.m_networkQualityErrorCount-=1),this.m_currentNetworkQualityStatus){case re.Normal:this.m_networkQualityErrorCount===oe.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(re.Error):this.m_networkQualityWarningCount===oe.NetworkPingPongMaxWarningCount&&this.updateNetworkQuality(re.Warning);break;case re.Warning:this.m_networkQualityErrorCount===oe.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(re.Error):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(re.Normal);break;case re.Error:0===this.m_networkQualityErrorCount&&this.m_networkQualityWarningCount>0?this.updateNetworkQuality(re.Warning):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(re.Normal)}}},{key:"updateNetworkQuality",value:function(e){if(this.m_currentNetworkQualityStatus!==e){this.m_currentNetworkQualityStatus=e;var t=0,n=0;switch(e){case re.Normal:t=0,n=h.None;break;case re.Warning:t=oe.NetworkQualityWarningPriority,n=h.Warning_SlowConnection;break;case re.Error:t=oe.NetworkQualityErrorPriority,n=h.Error_SlowConnection}var r={severity:0,priority:t,shortCode:n,longCode:0,shortString:"",longString:""};this.events.emit("qualityStatusUpdate",r)}}},{key:"onPongMessageReceived",value:function(e){var t;this.m_isWaitingForPongResponse=!1,this.m_gapNumberBetweenPingPongMessage-=1;var n=Date.now();t=n-this.m_heartbeatSendTime,this.calculateFrontDoorRoundTripLatency(e),this.m_currentHeartbeatLatency=t;var i={RoundtripLatency:t,HeartbeatSendTime:this.m_heartbeatSendTime,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};t>Ce.RoundtripLatencyWarnThreshold?ne.sendTraceTag(595716113,r.PptSession,y.Warning,JSON.stringify(i)):ne.sendTraceTag(595716114,r.PptSession,y.Info,JSON.stringify(i)),this.calculateRoundTripLatencyStats(e,this.m_currentHeartbeatLatency),this.calculateNetworkQualityStats(e,-1,this.m_currentHeartbeatLatency)}},{key:"calculatePreMessageLatency",value:function(e){try{var t=Date.now();if(this.m_messageLatencyTable[e]=t,this.m_totalEntriesInLatencyTable+=1,this.m_totalEntriesInLatencyTable>this.c_maxEntriesInLatencyTable){for(var n in this.m_latencyTableDeletedCount+=1,this.m_messageLatencyTable)this.m_messageLatencyTable[n]<t-6e4&&(delete this.m_messageLatencyTable[n],this.m_totalEntriesInLatencyTable-=1);ne.sendTraceTag(595716171,r.PptSession,y.Info,"Transcriber::calculatePreMessageLatency Deleted all entries in the latency table older than 1 minute. Number of times entries in the latency table have surpassed allowed max: \n                ".concat(this.m_latencyTableDeletedCount," TranscriberID: ").concat(this.m_transcriberId))}}catch(e){ne.sendTraceTag(595716172,r.PptSession,y.Warning,"Transcriber::calculatePreMessageLatency Exception while calculating message latency ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePartialMessageLatency",value:function(e,t,n,i){var a=Date.now();if(this.m_totalPartialMessagesCount+=1,this.m_totalPartialMessageLatency+=n,this.m_maxPartialMessageLatency=Math.max(this.m_maxPartialMessageLatency,n),this.m_minPartialMessageLatency=Math.min(this.m_minPartialMessageLatency,n),n>Ce.MaxAllowedFragmentLatencyMS&&(this.m_totalHighLatencyPartialMessagesCount+=1,!Ce.IsLogEachTranscriptMessage)){var o=this.m_totalPartialMessageLatency/this.m_totalPartialMessagesCount;ne.sendTraceTag(595716101,r.PptSession,y.Warning,JSON.stringify({PartialMessageCount:this.m_totalPartialMessagesCount,PartialMessageLatency:n,MaxPartialMessageLatency:this.m_maxPartialMessageLatency,MinPartialMessageLatency:this.m_minPartialMessageLatency,AvePartialMessageLatency:o,TotalPartialMessageLatency:this.m_totalPartialMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:a,TotalHighLatencyPartialMessagesCount:this.m_totalHighLatencyPartialMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}this.calculateMessageLatencyStats(e,n),this.calculateRoundTripLatencyStats(e,t),this.calculateNetworkQualityStats(e,n,t)}},{key:"calculateFinalMessageLatency",value:function(e,t,n,i){var a=Date.now();if(this.m_totalFinalMessagesCount+=1,this.m_totalFinalMessageLatency+=n,this.m_maxFinalMessageLatency=Math.max(this.m_maxFinalMessageLatency,n),this.m_minFinalMessageLatency=Math.min(this.m_minFinalMessageLatency,n),n>Ce.MaxAllowedFinalFragmentLatencyMS&&(this.m_totalHighLatencyFinalMessagesCount+=1,!Ce.IsLogEachTranscriptMessage)){var o=this.m_totalFinalMessageLatency/this.m_totalFinalMessagesCount;ne.sendTraceTag(595716102,r.PptSession,y.Warning,JSON.stringify({FinalMessageCount:this.m_totalFinalMessagesCount,FinalMessageLatency:n,MaxFinalMessageLatency:this.m_maxFinalMessageLatency,MinFinalMessageLatency:this.m_minFinalMessageLatency,AveFinalMessageLatency:o,TotalFinalMessageLatency:this.m_totalFinalMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:a,TotalHighLatencyFinalMessagesCount:this.m_totalHighLatencyFinalMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}for(var s in this.m_messageLatencyTable)this.m_messageLatencyTable[s]<=i&&(delete this.m_messageLatencyTable[s],this.m_totalEntriesInLatencyTable-=1)}},{key:"calculatePostMessageLatency",value:function(e,t,n){try{var i=Date.now(),a=0,o=this.m_messageLatencyTable[t];o?(a=Date.now()-o,e?this.calculateFinalMessageLatency(t,n,a,o):this.calculatePartialMessageLatency(t,n,a,o)):(this.m_totalMessageCorrelationIDNotFoundCount+=1,ne.sendTraceTag(595716103,r.PptSession,y.Warning,"calculatePostMessageLatency: correlationID: ".concat(t," was not present in the correlationID table. Total messages with the correlation id not found ").concat(this.m_totalMessageCorrelationIDNotFoundCount,"\n          TranscriberID: ").concat(this.m_transcriberId," isFinalMessage: ").concat(e))),this.m_realTimeFactorHandler.calculateAndLogRealTimeReceiveFactorStats(i,t,a,n,e)}catch(e){ne.sendTraceTag(595716107,r.PptSession,y.Warning,"calculatePostMessageLatency:Calculating the message latency threw an exception: ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePreAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculatePreAudioMetrics(e)}},{key:"calculatePostAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculateAndLogRealTimeSendFactorStats(e)}},{key:"isNetworkError",value:function(){return!!this.m_inFragmentLatencyErrorStatus&&(ne.sendTraceTag(595716115,r.PptSession,y.Warning,"SpeechHealthManager: Temporary network error"),this.telemetryManager.recordSpeechClientError(ve.TemporaryDisableSubtitleDueNetworkError,"Network error with error windows : ".concat(this.m_countFragmentLatencyInErrorWindow),Date.now(),!1),!0)}},{key:"stopSession",value:function(){this.m_pongMessageTimerId&&(clearInterval(this.m_pongMessageTimerId),this.m_pongMessageTimerId=0),this.m_realTimeFactorHandler.onSessionEnd();var e=this.m_frontdoorTotalRoundTripLatency/this.m_frontdoorRoundTripLatencyCount;this.telemetryManager.recordFrontdoorRoundTripLatency(e),this.telemetryManager.recordNetworkQuality(this.m_totalNetworkErrorMessageCount,this.m_totalNetworkWarningMessageCount),this.telemetryManager.recordMessageLatencyStats(this.m_totalMessageCorrelationIDNotFoundCount,this.m_latencyTableDeletedCount,this.m_totalEntriesInLatencyTable),this.telemetryManager.recordPartialMessageLatency(this.m_maxPartialMessageLatency,this.m_minPartialMessageLatency,this.m_totalPartialMessagesCount,this.m_totalHighLatencyPartialMessagesCount,this.m_totalPartialMessageLatency),this.telemetryManager.recordFinalMessageLatency(this.m_maxFinalMessageLatency,this.m_minFinalMessageLatency,this.m_totalFinalMessagesCount,this.m_totalHighLatencyFinalMessagesCount,this.m_totalFinalMessageLatency)}},{key:"calculateFrontDoorRoundTripLatency",value:function(e){var t=this.m_messageLatencyTable[e];if(t){var n=Date.now(),i=n-t,a={RoundtripLatency:i,HeartbeatSendTime:t,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};ne.sendTraceTag(594032288,r.PptSession,y.Info,JSON.stringify(a)),this.m_frontdoorRoundTripLatencyCount+=1,this.m_frontdoorTotalRoundTripLatency+=i,this.detectNetworkQuality(i)}else ne.sendTraceTag(594346950,r.PptSession,y.Warning,"onPongMessageReceived: correlationID: ".concat(e," was not present in the correlationID table, TranscriberID: ").concat(this.m_transcriberId))}}]),e}();!function(e){e[e.SpeechRecognitionStarted=0]="SpeechRecognitionStarted",e[e.SpeechEnd=1]="SpeechEnd"}(ce||(ce={}));var ue=function e(){f()(this,e)};ue.ProcessVisionDataCommand="processVisionData",ue.HandleClientMetaData="handleClientMetaData";var he,me=function(){function e(t,n,r,i,a,o){var s=this;f()(this,e),this.speechRecognitionPaused=!1,this.telemetryManager={},this.webcamClient=null,this.speechHealthManager={},this.events=new x.EventEmitter,this.onText=function(e){if(s.speechClientObserver){var t=function(e){var t,n={},r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}(e.transcripts),n=s.getRecognitionResultMetadata(e.properties);e.isFinal?(s.speechClientObserver.onFinalText(e.transcripts,e.properties),s.speechClientObserver.onFinalRecognitionText&&s.speechClientObserver.onFinalRecognitionText(t,n),s.events.emit("FinalReceived")):(s.speechClientObserver.onFragmentText(e.transcripts,e.properties),s.speechClientObserver.onPartialRecognitionText&&s.speechClientObserver.onPartialRecognitionText(t,n))}},this.onErr=function(e){s.speechClientObserver&&s.speechClientObserver.onError(e)},this.onSpeechStatus=function(e,t){if(s.speechClientObserver)switch(e){case ce.SpeechRecognitionStarted:!s.speechRecognitionPaused&&s.speechClientObserver&&s.speechClientObserver.onSpeechRecognitionStarted&&(s.speechClientObserver.onSpeechRecognitionStarted(t),s.speechClientConfig.sendClientMetaDataOnSessionStart&&s.sendClientMetaData(t));break;case ce.SpeechEnd:s.speechClientObserver&&s.speechClientObserver.onSpeechEnd&&s.speechClientObserver.onSpeechEnd(),s.events.emit("SpeechEnd")}},this.onSpeechSessionStarted=function(e){s.speechClientObserver&&s.speechClientObserver.onSpeechSessionStarted&&s.speechClientObserver.onSpeechSessionStarted(e)},this.onAudioData=function(e){s.speechClientObserver&&s.speechClientObserver.onAudioData&&s.speechClientObserver.onAudioData(e)},this.onRehearsalUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:l.RehearsalDashboardUpdate,currentSlideIndex:e.currentSlideIndex,features:e.features};s.speechClientObserver.onEventUpdate(t)}e.isFinal&&s.events.emit("FinalReceived")},this.onQualityStatusUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:l.QualityStatusUpdate,severity:e.severity,priority:e.priority,shortCode:e.shortCode,longCode:e.longCode,shortString:e.shortString,longString:e.longString};s.speechClientObserver.onEventUpdate(t)}},this.onFrontDoorConnectionRetry=function(){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var e={eventName:l.ConnectionRetry};s.speechClientObserver.onEventUpdate(e)}},this.speechClientObserver=n,se=a,this.speechClientConfig=t,this.mediaSource=i||new z(this.speechClientConfig.speechProcessorScript,t.microphoneDeviceId),this.telemetryManager=new X(se),this.speechHealthManager=new le(se,this.telemetryManager),this.speechFrontDoorProxy=new Se(this.speechClientConfig,r,o||new S,se,this.telemetryManager,this.speechHealthManager),this.startWebcamCapture(),this.registerSpeechFrontDoorEvents()}var t,n;return v()(e,[{key:"startSpeechRecognition",value:(n=R()(T.a.mark((function e(t){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryManager.recordSpeechClientConnectionStart(this.speechClientConfig),this.speechRecognitionPaused=!1,e.next=4,this.tryInitializeUserMedia();case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:this.speechFrontDoorProxy.startConnection(this.mediaSource,t||!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"startWebcamCapture",value:function(){this.speechClientConfig.webcamConfig&&(this.webcamClient?se.sendTraceTag(593019980,r.PptSession,y.Warning,"SpeechClient::startWebcamCapture webcam already exists"):this.webcamClient=new $(this.speechClientConfig.webcamConfig,this.onWebcamFrame.bind(this)))}},{key:"stopWebcamCapture",value:function(){this.webcamClient&&(this.webcamClient.stopMediaCapture(),this.webcamClient=null)}},{key:"resumeWebcamCapture",value:function(){if(this.webcamClient)if(this.speechClientConfig.captureAudioPauseResumeRecordingState){this.webcamClient.startMediaCapture();var e={eventName:l.MediaEvent,mediaStatus:u.VideoSetupCompleted};this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(e)}else this.webcamClient.resumeMediaCapture()}},{key:"pauseWebcamCapture",value:function(){this.webcamClient&&(this.speechClientConfig.captureAudioPauseResumeRecordingState?this.webcamClient.stopMediaCapture():this.webcamClient.pauseMediaCapture())}},{key:"stopSpeechRecognition",value:function(){var e=this;if(this.speechClientConfig.handleEndOfAudioInSpeechClientStopRecognition){this.sendEndOfAudio();var t=new Promise((function(t,n){var r=e.speechClientConfig.handleEndOfAudioTimeoutInMS?e.speechClientConfig.handleEndOfAudioTimeoutInMS:1e4;setTimeout(t,r,c.WaitForSpeechEndTimeout)})),n=new Promise((function(t,n){e.events.on("SpeechEnd",t)}));Promise.race([t,n]).then((function(t){e.closeConnectionInternal(),e.speechClientObserver&&e.speechClientObserver.onSpeechRecognitionStopped&&(t?e.speechClientObserver.onSpeechRecognitionStopped(String(t)):e.speechClientObserver.onSpeechRecognitionStopped(c.Normal))}))}else this.mediaSource.stopAudioCapture(),this.closeConnectionInternal(),this.speechClientObserver&&this.speechClientObserver.onSpeechRecognitionStopped&&this.speechClientObserver.onSpeechRecognitionStopped(c.Normal)}},{key:"closeConnectionInternal",value:function(){this.speechFrontDoorProxy.stopConnection(),this.speechRecognitionPaused=!1}},{key:"sendEndOfAudio",value:function(){this.speechFrontDoorProxy.onSendEndOfAudio(),this.mediaSource.stopAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","endOfAudio"]]))}},{key:"pauseSpeechRecognition",value:function(){this.speechRecognitionPaused=!0,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.stopAudioCapture():this.mediaSource.pauseAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","pause"]])),this.speechFrontDoorProxy.pauseSpeechRecognition()}},{key:"resumeSpeechRecognition",value:function(){this.speechRecognitionPaused=!1,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.startAudioCapture():this.mediaSource.resumeAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","resume"]])),this.speechFrontDoorProxy.resumeSpeechRecognition()}},{key:"setCustomSetting",value:function(e,t){this.speechFrontDoorProxy.setCustomSetting(e,t)}},{key:"getCustomSetting",value:function(e){return this.speechFrontDoorProxy.getCustomSetting(e)}},{key:"enableVoiceStreaming",value:function(){this.speechFrontDoorProxy.enableVoiceStreaming()}},{key:"disableVoiceStreaming",value:function(){this.speechFrontDoorProxy.disableVoiceStreaming()}},{key:"sendDictionaryRequestMessage",value:function(e){this.sendClientRequestMessage(U.fromMap(e))}},{key:"sendGenericRequestMessage",value:function(e,t){this.sendClientRequestMessage(new U(e,t))}},{key:"sendClientRequestMessage",value:function(e){this.speechFrontDoorProxy.sendClientRequestMessage(e)}},{key:"getRecognitionResultMetadata",value:function(e){var t={};return e.size>0&&e.forEach((function(e,n){if(e)if("JsonResult"===n){var i=JSON.parse(e);t.id=i.Id,t.duration=i.Duration,t.offset=i.Offset,t.properties=JSON.parse(e)}else null===t.properties||void 0===t.properties?t.properties={key:e}:t.properties[n]=e;else se.sendTraceTag(592229530,r.PptSession,y.Info,"SpeechClient::getRecognitionResultMetadata value is null for key: ".concat(n," }"))})),t}},{key:"tryInitializeUserMedia",value:(t=R()(T.a.mark((function e(){var t,n,r,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mediaSource.startAudioCapture();case 3:if((t=e.sent)!==s.ErrorNone){e.next=9;break}n={eventName:l.MediaEvent,mediaStatus:u.AudioDeviceConnected},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(n),e.next=12;break;case 9:return this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,t,Date.now(),!1),this.onErr(t),e.abrupt("return",!1);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(0),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,"ErrorAudio".concat(e.t0.name),Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorAudio".concat(e.t0.name)),e.abrupt("return",!1);case 19:if(!this.webcamClient){e.next=39;break}return e.prev=20,e.next=23,this.webcamClient.startMediaCapture();case 23:if((r=e.sent)!==s.ErrorNone){e.next=29;break}i={eventName:l.MediaEvent,mediaStatus:u.VideoSetupCompleted},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(i),e.next=32;break;case 29:return this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,r,Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(r)),e.abrupt("return",!1);case 32:e.next=39;break;case 34:return e.prev=34,e.t1=e.catch(20),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,"ErrorVideo".concat(e.t1.name),Date.now(),!1),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(e.t1.name)),e.abrupt("return",!1);case 39:return e.abrupt("return",!0);case 40:case"end":return e.stop()}}),e,this,[[0,14],[20,34]])}))),function(){return t.apply(this,arguments)})},{key:"registerSpeechFrontDoorEvents",value:function(){var e=this;this.speechFrontDoorProxy.on("text",(function(t){e.onText(t)})),this.speechFrontDoorProxy.on("error",(function(t){e.onErr(t)})),this.speechFrontDoorProxy.on("speechStatus",(function(t,n){e.onSpeechStatus(t,n)})),this.speechFrontDoorProxy.on("speechSessionStarted",(function(t){e.onSpeechSessionStarted(t)})),this.speechFrontDoorProxy.on("audioData",(function(t){e.onAudioData(t)})),this.speechFrontDoorProxy.on("rehearsalUpdate",(function(t){e.onRehearsalUpdate(t)})),this.speechFrontDoorProxy.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)})),this.speechFrontDoorProxy.on("webSocketConnectionRetry",(function(){e.onFrontDoorConnectionRetry()})),this.speechHealthManager.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)}))}},{key:"sendClientMetaData",value:function(e){var t=new Map;t.set("command",ue.HandleClientMetaData),t.set("data",JSON.stringify(this.speechFrontDoorProxy.getClientMetaDataMap())),t.set("speechMode",this.speechClientConfig.speechMode),t.set("SessionId",e),this.sendDictionaryRequestMessage(t)}},{key:"onWebcamFrame",value:function(e,t){var n={clientSentTimeMS:Date.now(),clientSessionSentTimeMS:this.speechFrontDoorProxy.getElapsedSessionTimeInMS()},r=new Map;r.set("command",ue.ProcessVisionDataCommand),r.set("data",e),r.set("correlation",t||""),r.set("operationMetadata",JSON.stringify(n)),this.sendDictionaryRequestMessage(r)}}]),e}(),de=n(40);function pe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ge=function e(){f()(this,e)};ge.AudioFactorCalculationDurationMS="AudioFactorCalculationDurationMS",ge.BufferSize="BufferSize",ge.CustomEndpointEnabled="CustomEndpointEnabled",ge.CustomEndpointRequestCorrelationID="CustomEndpointRequestCorrelationID",ge.CurrentTimestampMS="CurrentTimestampMS",ge.DataLoggingTimeInterval="DataLoggingTimeInterval",ge.Endpoint="Endpoint",ge.FatalErrors="FatalErrors",ge.FirstMessageLatencyMS="FirstMessageLatencyMS",ge.InitializeWebSocketEndTimeMS="InitializeWebSocketEndTimeMS",ge.InitializeWebSocketStartTimeMS="InitializeWebSocketStartTimeMS",ge.LatencyTableDeletedCount="LatencyTableDeletedCount",ge.MaxFinalMessageLatencyMS="MaxFinalMessageLatencyMS",ge.MaxPartialMessageLatencyMS="MaxPartialMessageLatencyMS",ge.MessageLatencyCalculationTimeMS="MessageLatencyCalculationTimeMS",ge.MinFinalMessageLatencyMS="MinFinalMessageLatencyMS",ge.MinPartialMessageLatencyMS="MinPartialMessageLatencyMS",ge.NonFatalErrors="NonFatalErrors",ge.OnGetUserMediaSuccessEntryPoint="OnGetUserMediaSuccessEntryPoint",ge.RealTimeFactorLowerThreshold="RealTimeFactorLowerThreshold",ge.RealTimeFactorUpperThreshold="RealTimeFactorUpperThreshold",ge.RequestCustomEndpointEndTimeMS="RequestCustomEndpointEndTimeMS",ge.RequestCustomEndpointFailedEndTimeMS="RequestCustomEndpointFailedEndTimeMS",ge.RequestCustomEndpointStartTimeMS="RequestCustomEndpointStartTimeMS",ge.RequestCustomEndpointTimedOutEndTimeMS="RequestCustomEndpointTimedOutEndTimeMS",ge.SendFirstMessageTime="SendFirstMessageTime",ge.SpeechLanguage="SpeechLanguage",ge.TotalAudioFactorOutsideOfThresholdCount="TotalAudioFactorOutsideOfThresholdCount",ge.TotalEntriesInLatencyTable="TotalEntriesInLatencyTable",ge.TotalFinalMessagesCount="TotalFinalMessagesCount",ge.TotalFinalMessageLatency="TotalFinalMessageLatency",ge.TotalHighLatencyPartialMessagesCount="TotalHighLatencyPartialMessagesCount",ge.TotalHighLatencyFinalMessagesCount="TotalHighLatencyFinalMessagesCount",ge.TotalMessageCorrelationIDNotFoundCount="TotalMessageCorrelationIDNotFoundCount",ge.TotalNetworkErrorMessageCount="TotalNetworkErrorMessageCount",ge.TotalNetworkWarningMessageCount="TotalNetworkWarningMessageCount",ge.AverageFrontDoorRoundTripLatencyCount="AverageFrontDoorRoundTripLatencyCount",ge.TotalPartialMessageLatency="TotalPartialMessageLatency",ge.TotalPartialMessagesCount="TotalPartialMessagesCount",ge.TotalTranscriptOutsideOfThresholdCount="TotalTranscriptOutsideOfThresholdCount",ge.TranscriberID="TranscriberID",ge.TranscriptionEntryPointCalled="TranscriptionEntryPointCalled",ge.TranscriptionStartTime="TranscriptionStartTime",ge.TranscriptionEndTime="TranscriptionEndTime",ge.TranslationLanguage="TranslationLanguage",ge.WebSocketClosedTimestamp="WebSocketClosedTimestamp",ge.WebSocketConnectionDurationMS="WebSocketConnectionDurationMS",ge.WebSocketCreateTimestamp="WebSocketCreateTimestamp",ge.WebSocketCustomEndpoint="WebSocketCustomEndpoint",ge.WebSocketOpenedTimestamp="WebSocketOpenedTimestamp",ge.WebSocketRetryAttempts="WebSocketRetryAttempts",ge.WebSocketRetryReason="WebSocketRetryReason",ge.FEnableContentlogging="FEnableContentlogging",ge.SpeechMode="SpeechMode",ge.SpeechClientRecognitionStartTime="SpeechClientConnectionStartTime";var ve=function e(){f()(this,e)};ve.CustomEndpointClientError="CustomEndpointClientError",ve.CustomEndpointClientFailureReason="CustomEndpointClientFailureReason",ve.CustomEndpointServerError="CustomEndpointServerError",ve.CustomEndpointServerErrorCode="CustomEndpointServerErrorCode",ve.CustomEndpointServerFailureReason="CustomEndpointServerFailureReason",ve.ErrorStatus="ErrorStatus",ve.InvalidDocId="InvalidDocId",ve.MessageErrorCode="MessageErrorCode",ve.TranscriptErrorCode="TranscriptErrorCode",ve.WebSocketDisconnected="WebSocketDisconnected",ve.WebSocketErrorCode="WebSocketErrorCode",ve.WebSocketRetryConnectionFailed="WebSocketRetryConnectionFailed",ve.WebsocketConnectionFailure="WebsocketConnectionFailure",ve.InitializeAudioContextFailed="InitializeAudioContextFailed",ve.InitializeTranscriberSessionFailed="InitializeTranscriberSessionFailed",ve.GetUserMediaFailed="GetUserMediaFailed",ve.ReadSettingsFailed="ReadSettingsFailed",ve.DisplayQualityStatusException="DisplayQualityStatusException",ve.TemporaryDisableSubtitleDueNetworkError="TemporaryDisableSubtitleDueNetworkError",ve.LossInternetConnection="LossInternetConnection";var ye,Ce=function e(){f()(this,e)};Ce.MaxAllowedFragmentLatencyMS=5e3,Ce.MaxAllowedFinalFragmentLatencyMS=2e4,Ce.DefaultBufferSize=8192,Ce.DataLoggingIntervalMS=3e4,Ce.RealTimeFactorLowerThreshold=0,Ce.RealTimeFactorUpperThreshold=999,Ce.IsLogEachTranscriptMessage=!0,Ce.IsContentLoggingEnabled=!1,Ce.CustomEndpointRequestTimeoutInMs=5e3,Ce.HeartbeatInterval=5e3,Ce.RoundtripLatencyWarnThreshold=500,Ce.RoundtripLatencyErrorThreshold=2500,Ce.FragmentLatencyWarnThreshold=2e4,Ce.FragmentLatencyErrorThreshold=3e4,Ce.MaxAllowedRetryCountPerSession=15,Ce.FragmentLatencyWarnWindow=6,Ce.FragmentLatencyErrorWindow=3,Ce.NoInternetConnectionInMs=12e4,Ce.MessageType="mix",Ce.SpeechFDBase="wss://pptservicescast.officeapps.live.com/",function(e){e.NotStarted="NotStarted",e.InitialConnecting="InitialConnecting",e.InitialConnectionRetrying="InitialConnectionRetrying",e.InitialConnectionRetryingFailed="InitialConnectionRetryingFailed",e.ConnectionSuccessful="ConnectionSuccessful",e.ConnectionDropRetrying="ConnectionDropRetrying",e.ConnectionDropRetryingFailed="ConnectionDropRetryingFailed"}(ye||(ye={}));var Se=function(e){I()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return D()(this,n)}}(n);function n(e,r,i,a,o,s){var c;return f()(this,n),(c=t.call(this)).m_wsUri="",c.m_webSocketConnectionRetryAttempts=-1,c.m_webSocketTotalRetryCountInSession=-1,c.c_maxWebSocketRetryAttempts=5,c.c_websocketRetryInterval=5e3,c.m_wsTimer=0,c.m_sessionTimer=new ie,c.m_transcriberId="",c.m_isFirstWebSocketConnection=!0,c.m_roundLatencyTimerId=0,c.m_sendPingMessageFlag=!1,c.m_fSendClientMetadata=!0,c.m_endpointId=null,c.telemetryManager={},c.speechHealthManager={},c.webSocket=null,c.customSettingsMap=new Map,c.disableStreaming=!1,c.events=new x.EventEmitter,c.generatedUserSessionId=Object(G.v4)(),c.m_fSessionPaused=!1,c.m_fEndOfAudioSent=!1,c.m_fdConnectionState=ye.NotStarted,he=a,c.speechConfig=e,c.authProvider=r,c.webSocketFactory=i,c.telemetryManager=o,c.speechHealthManager=s,c}return v()(n,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"onSendEndOfAudio",value:function(){this.m_fEndOfAudioSent=!0}},{key:"setCustomSetting",value:function(e,t){this.customSettingsMap.set(e,t)}},{key:"getCustomSetting",value:function(e){return this.customSettingsMap.get(e)}},{key:"enableVoiceStreaming",value:function(){this.disableStreaming=!1,this.m_sessionTimer.resume(),he.sendTraceTag(595632129,r.PptSession,y.Info,"Voice streaming is enabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"disableVoiceStreaming",value:function(){this.disableStreaming=!0,this.m_sessionTimer.pause(),he.sendTraceTag(595632130,r.PptSession,y.Info,"Voice streaming is disabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"pauseSpeechRecognition",value:function(){this.speechHealthManager.resetMessageLatency(),this.m_fSessionPaused=!0,this.m_sessionTimer.pause()}},{key:"resumeSpeechRecognition",value:function(){this.m_fSessionPaused=!1,this.m_sessionTimer.resume()}},{key:"getElapsedSessionTimeInMS",value:function(){return this.m_sessionTimer.getElapsedSessionTimeInMS()}},{key:"startConnection",value:function(e,t){this.m_fdConnectionState=ye.InitialConnecting,this.telemetryManager.recordSpeechRecognitionStart(),this.initialize();var n=Object(G.v4)();he.sendTraceTag(595126293,r.PptSession,y.Info,"Start speech connection: TranscriberID: ".concat(n)),this.disableStreaming=t,this.disableStreaming&&he.sendTraceTag(595632131,r.PptSession,y.Info,"Voice streaming is disabled: TranscriberID: ".concat(n));var i=Ce.DefaultBufferSize;isNaN(i)||(Ce.DefaultBufferSize=i),this.speechConfig.documentDownloadConfig&&!this.speechConfig.requestServiceCustomEndpoint?(he.sendTraceTag(595716118,r.PptSession,y.Info,JSON.stringify({EnableCustomEndpoint:this.speechConfig.documentDownloadConfig||!1,TranscriberID:n})),this.configureCustomEndpointRequest(e,n)):this.startSpeechConnection(e,n),this.speechHealthManager.startSession(n),this.m_sessionTimer.restart(!this.disableStreaming)}},{key:"initialize",value:function(){this.m_webSocketConnectionRetryAttempts=-1,this.m_webSocketTotalRetryCountInSession=-1,clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_transcriberId="",this.m_isFirstWebSocketConnection=!0,this.m_sendPingMessageFlag=!1,this.m_endpointId=""}},{key:"stopConnection",value:function(){try{this.speechHealthManager.stopSession(),this.telemetryManager.recordSpeechClientConnectionEnd(this.m_transcriberId),this.telemetryManager.recordWebSocketRetryCounts(this.m_webSocketTotalRetryCountInSession),this.m_fdConnectionState!==ye.NotStarted&&this.m_fdConnectionState!==ye.ConnectionSuccessful&&this.telemetryManager.recordSpeechClientError(ve.WebsocketConnectionFailure,this.m_fdConnectionState,Date.now(),!0),this.telemetryManager.publishSessionTelemetry(),this.m_sessionTimer.stop(),this.m_fdConnectionState=ye.NotStarted}catch(e){he.sendTraceTag(595716045,r.PptSession,y.Info,"Transcriber::stopFrontdoorConnection threw an exception:".concat(e,"TranscriberID: ").concat(this.m_transcriberId))}this.closeWebSocket(),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.removeAllListeners()}},{key:"sendClientRequestMessage",value:function(e){if(this.webSocket)if(this.webSocket.readyState===m.Open)try{this.webSocket.send(e.serializeBinary())}catch(e){he.sendTraceTag(595711878,r.PptSession,y.Error,"sendClientRequestMessage threw an exception:".concat(e,". TranscriberID: ").concat(this.m_transcriberId))}else he.sendTraceTag(595711877,r.PptSession,y.Info,"Cannot send client request message because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else he.sendTraceTag(595711876,r.PptSession,y.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"logTranscriberErrorTelemetry",value:function(e){e[ge.TranscriberID]=this.m_transcriberId,e[ge.CurrentTimestampMS]=Date.now(),he.sendTraceTag(595716049,r.PptSession,y.Error,JSON.stringify(e))}},{key:"setTranscriptionResult",value:function(e){this.events.emit("text",e)}},{key:"setTranscriptionErrorText",value:function(e){this.events.emit("error",e)}},{key:"triggerSpeechStatusEvent",value:function(e){this.events.emit("speechStatus",e,this.m_transcriberId)}},{key:"triggerAudioDataEvent",value:function(e){this.events.emit("audioData",e)}},{key:"triggerRehearsalUpdate",value:function(e){var t=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(t,e.correlationId,-1),this.events.emit("rehearsalUpdate",e)}},{key:"triggerQualityStatusUpdate",value:function(e){this.events.emit("qualityStatusUpdate",e)}},{key:"triggerFrontdoorConnectionRetryEvent",value:function(){this.events.emit("webSocketConnectionRetry")}},{key:"triggerSpeechSessionStarted",value:function(e){this.events.emit("speechSessionStarted",e)}},{key:"processAudioChunk",value:function(e,t){if(!this.disableStreaming&&!this.m_fSessionPaused)if(this.webSocket)if(this.webSocket.readyState===m.Open){var n=Date.now(),i=new H;i.correlationId=t||Object(G.v4)(),this.speechHealthManager.calculatePreMessageLatency(i.correlationId),this.triggerAudioDataEvent(new Int16Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/2)));var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);i.audio=a,i.sourceLanguage=this.speechConfig.sourceLanguage,i.settings.set("targetLanguageList",this.speechConfig.targetLanguages);var o,s=pe(this.customSettingsMap);try{for(s.s();!(o=s.n()).done;){var c=E()(o.value,2),l=c[0],u=c[1];"clientMetadata"===l&&(this.m_fSendClientMetadata=!0),i.settings.set(l,u)}}catch(e){s.e(e)}finally{s.f()}this.speechConfig.documentDownloadConfig&&this.m_endpointId&&i.settings.set("endpointId",this.m_endpointId),this.m_fSendClientMetadata&&(this.m_fSendClientMetadata=!1,i.setClientMetaData(this.getClientMetaDataMap())),this.m_sendPingMessageFlag&&(i.settings.set("isPingMessage","true"),this.m_sendPingMessageFlag=!1,this.speechHealthManager.onPingMessageSent(i.correlationId)),this.speechConfig.properties&&i.setProperties(this.speechConfig.properties),i.setOperationMetadata(Date.now(),this.m_sessionTimer.getElapsedSessionTimeInMS());var h=i.serializeBinary();this.telemetryManager.recordInitialAudioMessage(),this.speechHealthManager.calculatePreAudioMessageStats(n),this.webSocket.send(h),this.speechHealthManager.calculatePostAudioMessageStats(i.correlationId)}else he.sendTraceTag(595716170,r.PptSession,y.Info,"Cannot send audio data because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else he.sendTraceTag(595716169,r.PptSession,y.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"enablePingMessage",value:function(){this.m_sendPingMessageFlag||(this.m_sendPingMessageFlag=!0)}},{key:"startSpeechConnection",value:function(e,t){this.m_transcriberId=t;var n=Object(G.v4)(),r=this.speechConfig.speechFDBase||Ce.SpeechFDBase,i=this.speechConfig.clientType||o.web,s="".concat(r,"SpeechHandler.ashx?action=Transcribe&client=").concat(i,"&session=").concat(this.m_transcriberId,"&message=").concat(Ce.MessageType,"&speechMode=").concat(this.speechConfig.speechMode,"&sampleRate=").concat(e.sampleRate,"&app=").concat(this.speechConfig.clientApp||a.PowerPoint,"&locale=").concat(this.speechConfig.sourceLanguage,"&contenttype=url&requestcorrelationid=").concat(n);if(this.speechConfig.scenarioName&&(s+="&scenarioName=".concat(this.speechConfig.scenarioName)),this.speechConfig.requestServiceCustomEndpoint&&(s+="&fCreateCustomEndpoint=".concat(this.speechConfig.requestServiceCustomEndpoint)),this.speechConfig.documentDownloadConfig){var c=this.sanitizeDocID(this.speechConfig.documentDownloadConfig.docId,t);s+="&PodSID=".concat(this.speechConfig.documentDownloadConfig.podsSessionId)+"&podurl=".concat(this.speechConfig.documentDownloadConfig.webServiceBase)+"&wacuserdatacluster=".concat(this.speechConfig.documentDownloadConfig.userDataCenterClusterId)+"&docid=".concat(c)}this.telemetryManager.recordWebSocketConnectionStart(r,t),this.m_wsUri=s,e.onaudioprocess=this.processAudioChunk.bind(this),this.openWebSocketConnection(),this.m_roundLatencyTimerId=0,this.m_sendPingMessageFlag=!1,this.telemetryManager.recordWebSocketConnectionEnd()}},{key:"sanitizeDocID",value:function(e,t){var n="";if(0===e.length)return n;var i=e.indexOf("access_token");return-1===i?he.sendTraceTag(573309463,r.PptSession,y.Warning,"Transcriber::startSpeechConnection access_token was not found in docID. TranscriberID: ".concat(t)):n=e.substring(0,i),n}},{key:"handleWebSocketOpenEvent",value:function(){this.m_fdConnectionState=ye.ConnectionSuccessful,this.m_roundLatencyTimerId=setInterval(this.enablePingMessage.bind(this),Ce.HeartbeatInterval),this.m_isFirstWebSocketConnection&&(this.telemetryManager.recordWebSocketConnectionOpen(),this.m_isFirstWebSocketConnection=!1),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_webSocketConnectionRetryAttempts=0,this.m_fSendClientMetadata=!0,this.triggerSpeechStatusEvent(ce.SpeechRecognitionStarted)}},{key:"handleRehearsalUpdate",value:function(e){this.triggerRehearsalUpdate(e)}},{key:"handleQualityStatusUpdate",value:function(e){this.triggerQualityStatusUpdate(e)}},{key:"handleTranscriptResultMessage",value:function(e){if(this.telemetryManager.recordInitialMessageLatency(),"success"===e.status){if(e.isPong)return void this.speechHealthManager.onPongMessageReceived(e.correlationId);var t=e.correlationId;this.setTranscriptionResult(e);var n=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(n,t,-1)}else if("speechEnd"===e.status)this.triggerSpeechStatusEvent(ce.SpeechEnd);else if("nomatch"===e.status||"notranslation"===e.status){var r=e.messageErrorCode;switch(null!=r&&""!==r||(r="ErrorUnknown"),e.transcriptErrorCode){case"NoMatchReason:NotRecognized":break;case"NoMatchReason:InitialBabbleTimeout":this.setTranscriptionErrorText("ErrorInitialBabbleTimeout");break;case"NoMatchReason:InitialSilenceTimeout":this.setTranscriptionErrorText("ErrorInitialSilenceTimeout");break;case"NoMatchReason:KeywordNotRecognized":break;default:this.handleOnMessageTranscriptionError(e)}}else this.handleOnMessageTranscriptionError(e)}},{key:"handleOnMessageTranscriptionError",value:function(e){try{null==e&&he.sendTraceTag(595716051,r.PptSession,y.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"\n           Response received from speech service was null."));var t=e.messageErrorCode;null!=t&&""!==t||(t="Unknown");var n=e.transcriptErrorCode;-1===["ErrorProtobufDeserializationFailure","ErrorInvalidSubscriptionFromConfig","ErrorInvalidRegionFromConfig","ErrorAddSessionFailure","ErrorInvalidMessage","ErrorCreateSpeechSessionBadRequest","ErrorWaitAudioTimeout","ErrorSpeechHandlerWebSocketFailure","ErrorSpeechRecognitionFailure","ErrorTranslationFailure","ErrorFailedToGetSupportedTextLanguages","ErrorCustomEndpointTimeout"].indexOf(t)?this.telemetryManager.recordSpeechClientError(t,"".concat(n,"_").concat(e.status),Date.now(),!1):this.telemetryManager.recordSpeechClientError(t,"",Date.now(),!0),this.setTranscriptionErrorText(t);var i={};i[ve.MessageErrorCode]=t,i[ve.TranscriptErrorCode]=n,i[ve.ErrorStatus]=e.status,this.logTranscriberErrorTelemetry(i)}catch(e){he.sendTraceTag(595716052,r.PptSession,y.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"Exception thrown: ").concat(e))}}},{key:"handleSpeechResultMessage",value:function(e){this.handleTranscriptResultMessage(e)}},{key:"handleSpeechSessionStartedMessage",value:function(e){this.triggerSpeechSessionStarted(e)}},{key:"handleRehearsalResultMessage",value:function(e){this.handleRehearsalUpdate(e)}},{key:"handleQualityStatusMessage",value:function(e){this.handleQualityStatusUpdate(e)}},{key:"handleWebSocketMessage",value:function(e){q(e,this)}},{key:"handleWebSocketCloseEvent",value:function(e){if(this.closeIntervalTimer(),1e3!==e){var t={};t[ve.WebSocketErrorCode]=e,t[ge.WebSocketRetryReason]="WebSocketDisconnected",this.logTranscriberErrorTelemetry(t),this.telemetryManager.recordWebsocketCloseError(e),this.retryWebSocketConnectionWrapper()}}},{key:"openWebSocketConnection",value:function(){this.m_webSocketTotalRetryCountInSession+=1,this.m_webSocketConnectionRetryAttempts+=1,this.m_isFirstWebSocketConnection&&0===this.m_webSocketTotalRetryCountInSession&&this.telemetryManager.recordWebSocketCreation(),this.webSocket&&(he.sendTraceTag(595716109,r.PptSession,y.Warning,"Transcriber::OpenWebSocketConnection Found existing web socket connection. Closing it and will open a new one. TranscriberID: ".concat(this.m_transcriberId)),this.closeWebSocket()),this.webSocket=this.webSocketFactory.createWebSocket(this.m_wsUri),{}[ge.WebSocketRetryReason]="WebSocketConnectionTimeout",this.retryWebSocketConnectionWrapper(),this.webSocket.onopen=this.handleWebSocketOpenEvent.bind(this),this.webSocket.onmessage=this.handleWebSocketMessage.bind(this),this.webSocket.onclose=this.handleWebSocketCloseEvent.bind(this)}},{key:"retryWebSocketConnection",value:function(){if(clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.speechHealthManager.resetMessageLatency(),!this.m_fEndOfAudioSent){if(!this.shouldRetryConnection())return clearTimeout(this.m_wsTimer),this.m_wsTimer=0,void this.closeWebSocket();he.sendTraceTag(595716056,r.PptSession,y.Info,"Transcriber::RetryWebSocketConnection - WebSocket retry attempt: ".concat(this.m_webSocketConnectionRetryAttempts,"\n        TranscriberID: ").concat(this.m_transcriberId)),this.closeWebSocket(),this.m_fdConnectionState=this.m_isFirstWebSocketConnection?ye.InitialConnectionRetrying:this.m_fdConnectionState=ye.ConnectionDropRetrying,this.triggerFrontdoorConnectionRetryEvent(),this.openWebSocketConnection()}}},{key:"retryWebSocketConnectionWrapper",value:function(){0===this.m_wsTimer&&(this.m_wsTimer=setTimeout(this.retryWebSocketConnection.bind(this),this.c_websocketRetryInterval))}},{key:"configureCustomEndpointRequest",value:function(e,t){var n=this;this.speechConfig.documentDownloadConfig&&_e({docId:this.speechConfig.documentDownloadConfig.docId,speechFrontDoorBase:this.speechConfig.speechFDBase||Ce.SpeechFDBase,podUrl:this.speechConfig.documentDownloadConfig.webServiceBase,podSessionId:this.speechConfig.documentDownloadConfig.podsSessionId,speechLanguage:this.speechConfig.sourceLanguage,isContentLoggingEnabled:Ce.IsContentLoggingEnabled,CustomEndpointRequestTimeoutInMs:Ce.CustomEndpointRequestTimeoutInMs,transcriberID:t,logger:he,telemetryManager:this.telemetryManager,userDataCenterClusterId:this.speechConfig.documentDownloadConfig.userDataCenterClusterId,userSessionId:this.speechConfig.userSessionId||this.generatedUserSessionId,speechMode:this.speechConfig.speechMode,clientApp:this.speechConfig.clientApp||a.PowerPoint}).then((function(r){n.m_endpointId=r.customEndpointID,""===n.m_transcriberId&&n.startSpeechConnection(e,t)})).catch((function(r){n.telemetryManager.recordSpeechClientError(r.recordErrorCode,r.recordErrorReason,Date.now(),!1),n.logTranscriberErrorTelemetry(r.errorInfo),""===n.m_transcriberId&&n.startSpeechConnection(e,t)}))}},{key:"getClientMetaDataMap",value:function(){var e,t=pe(this.customSettingsMap);try{for(t.s();!(e=t.n()).done;){var n=E()(e.value,2),r=n[0],i=n[1];if("clientMetadata"===r){Object(de.isNullOrUndefined)(this.speechConfig.clientMetaData)&&(this.speechConfig.clientMetaData=new Map);for(var o=JSON.parse(i),s=0,c=Object.keys(o);s<c.length;s++){var l=c[s];this.speechConfig.clientMetaData.set(l,o[l])}}}}catch(e){t.e(e)}finally{t.f()}var u=this.speechConfig.clientApp||a.PowerPoint,h={supportedResponseTypes:"speechresultmixmessage,qualitystatusmixmessage,rehearsalresultmixMessage,speechSessionStartedMixMessage",authorization:this.authProvider.accessToken};if(Object(de.isNullOrUndefined)(u)||(h.app=u),!Object(de.isNullOrUndefined)(this.speechConfig.clientMetaData)){var m,d=pe(this.speechConfig.clientMetaData);try{for(d.s();!(m=d.n()).done;){var p=E()(m.value,2),f=p[0],g=p[1];h[f]=g}}catch(e){d.e(e)}finally{d.f()}}return h}},{key:"closeIntervalTimer",value:function(){0!==this.m_roundLatencyTimerId&&(clearInterval(this.m_roundLatencyTimerId),this.m_roundLatencyTimerId=0)}},{key:"closeWebSocket",value:function(){this.webSocket&&(this.closeIntervalTimer(),this.webSocket.onclose=function(){},this.webSocket.close(),this.webSocket=null)}},{key:"shouldRetryConnection",value:function(){var e=!0,t="",n="";if(this.speechConfig.maxRetryCountsInSession&&this.m_webSocketTotalRetryCountInSession>=this.speechConfig.maxRetryCountsInSession?(t=s.ErrorMaxConnectionRetryFailureInSession,n="Client specified maximum retry counts in session reached",e=!1):this.m_webSocketConnectionRetryAttempts>=this.c_maxWebSocketRetryAttempts&&(t=s.ErrorConnectionRetryFailure,n="Maximum retry count reached in current window",e=!1),he.sendTraceTag(571770508,r.PptSession,y.Info,"WebSocket connection retry failed with error: ".concat(n," TranscriberID: ").concat(this.m_transcriberId)),!e){this.setTranscriptionErrorText(t),this.m_fdConnectionState=this.m_isFirstWebSocketConnection?ye.InitialConnectionRetryingFailed:this.m_fdConnectionState=ye.ConnectionDropRetryingFailed;var i={};return i[ve.WebSocketRetryConnectionFailed]="WebSocketRetryConnectionFailed",this.logTranscriberErrorTelemetry(i),!1}return!0}}]),n}(x.EventEmitter);function _e(e){var t={},n={};return new Promise(function(){var i=R()(T.a.mark((function i(a,o){var s,c,l,u,h,m,d;return T.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=e.logger,0!==e.docId.length){i.next=8;break}return n.recordErrorCode=ve.InvalidDocId,n.recordErrorReason="",t[ve.CustomEndpointClientFailureReason]="InvalidDocId",n.errorInfo=t,o(n),i.abrupt("return");case 8:c=e.docId,-1===(l=e.docId.indexOf("access_token"))?s.sendTraceTag(595716120,r.PptSession,y.Warning,"Transcriber::RequestCustomEndpoint access_token was not found in docID. TranscriberID: ".concat(e.transcriberID)):c=e.docId.substring(0,l),u=Object(G.v4)(),s.sendTraceTag(595716121,r.PptSession,y.Info,"Transcriber::RequestCustomEndpoint CorrelationID: ".concat(u," TranscriberID: ").concat(e.transcriberID)),h=(h=e.speechFrontDoorBase.replace("wss","https")).replace("ws","http"),m="".concat(h,"CustomEndpointHandler.ashx?action=GetOrCreateCustomEndpoint&podurl=").concat(e.podUrl,"&PODSID=").concat(e.podSessionId,"&docid=").concat(c,"&locale=").concat(e.speechLanguage,"&client=web&contenttype=url&fenablecontentlogging=").concat(e.isContentLoggingEnabled,"&correlationid=").concat(u,"&wacusersessionid=").concat(e.userSessionId,"&wacuserdatacluster=").concat(e.userDataCenterClusterId,"\n    &speechMode=").concat(e.speechMode,"&app=").concat(e.clientApp),d=new XMLHttpRequest,e.telemetryManager.recordCustomEndpointStart(u),d.open("POST",m,!0),d.timeout=e.CustomEndpointRequestTimeoutInMs,d.send(),d.onload=function(){s.sendTraceTag(595716160,r.PptSession,y.Info,"requestCustomEndpointHandler: OnLoad Transcriber ID: ".concat(e.transcriberID)),n.customEndpointID=d.getResponseHeader("X-EndpointID"),e.telemetryManager.recordCustomEndpointEnd(n.customEndpointID),a(n)},d.onerror=function(){s.sendTraceTag(595716161,r.PptSession,y.Info,"requestCustomEndpointHandler: OnError Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=ve.CustomEndpointServerError,n.recordErrorReason="".concat(d.getResponseHeader("X-ErrorCode")," ").concat(d.getResponseHeader("X-FailureReason")," ").concat(d.status),e.telemetryManager.recordCustomEndpointError();var t={};t[ve.CustomEndpointServerErrorCode]=d.getResponseHeader("X-ErrorCode"),t[ve.CustomEndpointServerFailureReason]=d.getResponseHeader("X-FailureReason"),n.errorInfo=t,o(n)},d.ontimeout=function(){s.sendTraceTag(595716162,r.PptSession,y.Info,"requestCustomEndpointHandler: OnTimeout Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=ve.CustomEndpointClientError,n.recordErrorReason="CustomEndpointRequestTimeout";var t={};t[ve.CustomEndpointClientFailureReason]="CustomEndpointRequestTimeout",n.errorInfo=t,e.telemetryManager.recordCustomEndpointTimeout(),o(n)};case 24:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}var Te=function(){function e(){f()(this,e)}return v()(e,[{key:"createSpeechClient",value:function(e,t,n,r,i,a){if(t)return new me(e,t,n,r,i,a)}}]),e}()},function(e,t,n){var r=n(33);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(33),i=n(8)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:a?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,n){var r=n(6),i=n(28),a=n(8)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||null==(n=r(o)[a])?t:i(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(158),i=function(){function e(){}return e.prototype.createCoachManager=function(e){return new r.CoachManager(e)},e}();t.CoachSessionFactory=i,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(79))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(11),i=n(4),a=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(43)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(23),i=n(9),a=n(45);e.exports=function(e){return function(t,n,o){var s,c=r(t),l=i(c.length),u=a(o,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(33);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(8)("iterator"),i=!1;try{var a=[7][r]();a.return=function(){i=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:n=!0}},a[r]=function(){return o},e(a)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(6);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(63),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var a=n.call(e,t);if("object"!=typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(136);var r=n(18),i=n(22),a=n(5),o=n(34),s=n(8),c=n(101),l=s("species"),u=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),h=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var m=s(e),d=!a((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),p=d?!a((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[l]=function(){return n}),n[m](""),!t})):void 0;if(!d||!p||"replace"===e&&!u||"split"===e&&!h){var f=/./[m],g=n(o,m,""[e],(function(e,t,n,r,i){return t.exec===c?d&&!i?{done:!0,value:f.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),v=g[0],y=g[1];r(String.prototype,e,v),i(RegExp.prototype,m,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},function(e,t,n){var r=n(27),i=n(131),a=n(96),o=n(6),s=n(9),c=n(98),l={},u={};(t=e.exports=function(e,t,n,h,m){var d,p,f,g,v=m?function(){return e}:c(e),y=r(n,h,t?2:1),C=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(d=s(e.length);d>C;C++)if((g=t?y(o(p=e[C])[0],p[1]):y(e[C]))===l||g===u)return g}else for(f=v.call(e);!(p=f.next()).done;)if((g=i(f,y,p.value,t))===l||g===u)return g}).BREAK=l,t.RETURN=u},function(e,t,n){var r=n(4).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(4),i=n(0),a=n(18),o=n(56),s=n(37),c=n(75),l=n(55),u=n(7),h=n(5),m=n(71),d=n(51),p=n(87);e.exports=function(e,t,n,f,g,v){var y=r[e],C=y,S=g?"set":"add",_=C&&C.prototype,T={},b=function(e){var t=_[e];a(_,e,"delete"==e||"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof C&&(v||_.forEach&&!h((function(){(new C).entries().next()})))){var R=new C,w=R[S](v?{}:-0,1)!=R,E=h((function(){R.has(1)})),M=m((function(e){new C(e)})),I=!v&&h((function(){for(var e=new C,t=5;t--;)e[S](t,t);return!e.has(-0)}));M||((C=t((function(t,n){l(t,C,e);var r=p(new y,t,C);return null!=n&&c(n,g,r[S],r),r}))).prototype=_,_.constructor=C),(E||I)&&(b("delete"),b("has"),g&&b("get")),(I||w)&&b(S),v&&_.clear&&delete _.clear}else C=f.getConstructor(t,e,g,S),o(C.prototype,n),s.NEED=!0;return d(C,e),T[e]=C,i(i.G+i.W+i.F*(C!=y),T),v||f.setStrong(C,e,g),C}},function(e,t,n){for(var r,i=n(4),a=n(22),o=n(42),s=o("typed_array"),c=o("view"),l=!(!i.ArrayBuffer||!i.DataView),u=l,h=0,m="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[m[h++]])?(a(r.prototype,s,!0),a(r.prototype,c,!0)):u=!1;e.exports={ABV:l,CONSTR:u,TYPED:s,VIEW:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PptSession=817]="PptSession"}(t.LogCategory||(t.LogCategory={})),function(e){e.Web="Web",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac"}(t.ClientType||(t.ClientType={})),function(e){e.Default="Rehearsal",e.ReadAlong="ReadAlong"}(t.CoachMode||(t.CoachMode={})),function(e){e.FillerWords="fillerWords",e.Originality="originality",e.WordsPerMinute="wordsPerMinute",e.SensitivePhrases="sensitivePhrases",e.CorrectedSensitivePhrases="correctedSensitivePhrases",e.Positivity="positivity",e.Monotone="monotone",e.Grammar="grammar",e.Occlusion="visionOcclusion",e.OcclusionGood="visionOcclusionGood",e.Gaze="visionGaze",e.GazeGood="visionGazeGood",e.DistanceGood="visionDistanceGood",e.DistanceTooClose="visionDistanceTooClose",e.DistanceTooFar="visionDistanceTooFar",e.Pronunciation="pronunciation",e.CrutchWords="crutchWords"}(t.CoachFeatures||(t.CoachFeatures={}));t.CoachSessionError=function(){};t.CoachSessionTranscriptRequestInfo=function(){};t.CorrectedISensitivePhrasesData=function(){this.phraseData={},this.correction=""};t.CorrectedSensitivePhraseData=function(){this.Phrase="",this.Count=0,this.Correction=""};t.CoachSessionTelemetry=function(){this.CreateDashboardTimeInMS=0,this.FDidSeeSuggestions=!1,this.FRehearsalDidStart=!1,this.NumberOfPauses=0,this.NumberOfSlidesWithOriginalitySuggestion=0,this.NumberOfSlidesRehearsed=0,this.RehearsalDurationInSeconds=0,this.AverageWPM=0,this.RehearsalEndTime=0,this.RehearsalId="",this.RehearsalStartTime=0,this.SuggestionCountsByName={},this.CrutchWordUsageCounts=[],this.CritiqueLatencyTelemetry={},this.FSpeechRecognitionStarted=!1,this.EntryPoint="",this.SourceLanguage="",this.FVisionEnabled=!1};var r=function(){function e(){}return e.DetectedValueWithMessage="detectedvaluewithmessage",e.GaugeWithMessage="gaugewithmessage",e.SingleMessage="singlemessage",e.IconWithMessage="iconwithmessage",e.TemperaturePillWithMessage="temperaturepillwithmessage",e.FontIconWithMessage="fonticonwithmessage",e}();t.RehearsalTemplateName=r},function(e,t,n){var r=n(7),i=n(4).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){t.f=n(8)},function(e,t,n){var r=n(67)("keys"),i=n(42);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(4).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(7),i=n(6),a=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(27)(Function.call,n(30).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(7),i=n(85).set;e.exports=function(e,t,n){var a,o=t.constructor;return o!==n&&"function"==typeof o&&(a=o.prototype)!==n.prototype&&r(a)&&i&&i(e,a),e}},function(e,t,n){"use strict";var r=n(29),i=n(34);e.exports=function(e){var t=String(i(this)),n="",a=r(e);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(29),i=n(34);e.exports=function(e){return function(t,n){var a,o,s=String(i(t)),c=r(n),l=s.length;return c<0||c>=l?e?"":void 0:(a=s.charCodeAt(c))<55296||a>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):a:e?s.slice(c,c+2):o-56320+(a-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(43),i=n(0),a=n(18),o=n(22),s=n(53),c=n(130),l=n(51),u=n(48),h=n(8)("iterator"),m=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,p,f,g,v){c(n,t,p);var y,C,S,_=function(e){if(!m&&e in w)return w[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",b="values"==f,R=!1,w=e.prototype,E=w[h]||w["@@iterator"]||f&&w[f],M=E||_(f),I=f?b?_("entries"):M:void 0,F="Array"==t&&w.entries||E;if(F&&(S=u(F.call(new e)))!==Object.prototype&&S.next&&(l(S,T,!0),r||"function"==typeof S[h]||o(S,h,d)),b&&E&&"values"!==E.name&&(R=!0,M=function(){return E.call(this)}),r&&!v||!m&&!R&&w[h]||o(w,h,M),s[t]=M,s[T]=d,f)if(y={values:b?M:_("values"),keys:g?M:_("keys"),entries:I},v)for(C in y)C in w||a(w,C,y[C]);else i(i.P+i.F*(m||R),t,y);return y}},function(e,t,n){var r=n(94),i=n(34);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(7),i=n(33),a=n(8)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(8)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(53),i=n(8)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[i]===e)}},function(e,t,n){"use strict";var r=n(15),i=n(41);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(63),i=n(8)("iterator"),a=n(53);e.exports=n(11).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||a[r(e)]}},function(e,t,n){"use strict";var r=n(17),i=n(45),a=n(9);e.exports=function(e){for(var t=r(this),n=a(t.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,l=void 0===c?n:i(c,n);l>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(49),i=n(135),a=n(53),o=n(23);e.exports=n(92)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,i,a=n(72),o=RegExp.prototype.exec,s=String.prototype.replace,c=o,l=(r=/a/,i=/b*/g,o.call(r,"a"),o.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),u=void 0!==/()??/.exec("")[1];(l||u)&&(c=function(e){var t,n,r,i,c=this;return u&&(n=new RegExp("^"+c.source+"$(?!\\s)",a.call(c))),l&&(t=c.lastIndex),r=o.call(c,e),l&&r&&(c.lastIndex=c.global?r.index+r[0].length:t),u&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";var r=n(91)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,i,a,o=n(27),s=n(124),c=n(84),l=n(80),u=n(4),h=u.process,m=u.setImmediate,d=u.clearImmediate,p=u.MessageChannel,f=u.Dispatch,g=0,v={},y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},C=function(e){y.call(e.data)};m&&d||(m=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},d=function(e){delete v[e]},"process"==n(33)(h)?r=function(e){h.nextTick(o(y,e,1))}:f&&f.now?r=function(e){f.now(o(y,e,1))}:p?(a=(i=new p).port2,i.port1.onmessage=C,r=o(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",C,!1)):r="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(o(y,e,1),0)}),e.exports={set:m,clear:d}},function(e,t,n){"use strict";var r=n(4),i=n(14),a=n(43),o=n(78),s=n(22),c=n(56),l=n(5),u=n(55),h=n(29),m=n(9),d=n(143),p=n(47).f,f=n(15).f,g=n(99),v=n(51),y=r.ArrayBuffer,C=r.DataView,S=r.Math,_=r.RangeError,T=r.Infinity,b=y,R=S.abs,w=S.pow,E=S.floor,M=S.log,I=S.LN2,F=i?"_b":"buffer",D=i?"_l":"byteLength",A=i?"_o":"byteOffset";function k(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,c=(1<<s)-1,l=c>>1,u=23===t?w(2,-24)-w(2,-77):0,h=0,m=e<0||0===e&&1/e<0?1:0;for((e=R(e))!=e||e===T?(i=e!=e?1:0,r=c):(r=E(M(e)/I),e*(a=w(2,-r))<1&&(r--,a*=2),(e+=r+l>=1?u/a:u*w(2,1-l))*a>=2&&(r++,a/=2),r+l>=c?(i=0,r=c):r+l>=1?(i=(e*a-1)*w(2,t),r+=l):(i=e*w(2,l-1)*w(2,t),r=0));t>=8;o[h++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[h++]=255&r,r/=256,s-=8);return o[--h]|=128*m,o}function x(e,t,n){var r,i=8*n-t-1,a=(1<<i)-1,o=a>>1,s=i-7,c=n-1,l=e[c--],u=127&l;for(l>>=7;s>0;u=256*u+e[c],c--,s-=8);for(r=u&(1<<-s)-1,u>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===u)u=1-o;else{if(u===a)return r?NaN:l?-T:T;r+=w(2,t),u-=o}return(l?-1:1)*r*w(2,u-t)}function L(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function P(e){return[255&e]}function W(e){return[255&e,e>>8&255]}function N(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function O(e){return k(e,52,8)}function V(e){return k(e,23,4)}function B(e,t,n){f(e.prototype,t,{get:function(){return this[n]}})}function H(e,t,n,r){var i=d(+n);if(i+t>e[D])throw _("Wrong index!");var a=e[F]._b,o=i+e[A],s=a.slice(o,o+t);return r?s:s.reverse()}function U(e,t,n,r,i,a){var o=d(+n);if(o+t>e[D])throw _("Wrong index!");for(var s=e[F]._b,c=o+e[A],l=r(+i),u=0;u<t;u++)s[c+u]=l[a?u:t-u-1]}if(o.ABV){if(!l((function(){y(1)}))||!l((function(){new y(-1)}))||l((function(){return new y,new y(1.5),new y(NaN),"ArrayBuffer"!=y.name}))){for(var q,j=(y=function(e){return u(this,y),new b(d(e))}).prototype=b.prototype,G=p(b),z=0;G.length>z;)(q=G[z++])in y||s(y,q,b[q]);a||(j.constructor=y)}var J=new C(new y(2)),X=C.prototype.setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||c(C.prototype,{setInt8:function(e,t){X.call(this,e,t<<24>>24)},setUint8:function(e,t){X.call(this,e,t<<24>>24)}},!0)}else y=function(e){u(this,y,"ArrayBuffer");var t=d(e);this._b=g.call(new Array(t),0),this[D]=t},C=function(e,t,n){u(this,C,"DataView"),u(e,y,"DataView");var r=e[D],i=h(t);if(i<0||i>r)throw _("Wrong offset!");if(i+(n=void 0===n?r-i:m(n))>r)throw _("Wrong length!");this[F]=e,this[A]=i,this[D]=n},i&&(B(y,"byteLength","_l"),B(C,"buffer","_b"),B(C,"byteLength","_l"),B(C,"byteOffset","_o")),c(C.prototype,{getInt8:function(e){return H(this,1,e)[0]<<24>>24},getUint8:function(e){return H(this,1,e)[0]},getInt16:function(e){var t=H(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=H(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return L(H(this,4,e,arguments[1]))},getUint32:function(e){return L(H(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return x(H(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return x(H(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){U(this,1,e,P,t)},setUint8:function(e,t){U(this,1,e,P,t)},setInt16:function(e,t){U(this,2,e,W,t,arguments[2])},setUint16:function(e,t){U(this,2,e,W,t,arguments[2])},setInt32:function(e,t){U(this,4,e,N,t,arguments[2])},setUint32:function(e,t){U(this,4,e,N,t,arguments[2])},setFloat32:function(e,t){U(this,4,e,V,t,arguments[2])},setFloat64:function(e,t){U(this,8,e,O,t,arguments[2])}});v(y,"ArrayBuffer"),v(C,"DataView"),s(C.prototype,o.VIEW,!0),t.ArrayBuffer=y,t.DataView=C},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(148)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldHandleSpecialFocus=t.shouldAnimateRehearsalContainer=t.getWelcomeScreenText=t.shouldShowMinimalWelcomeScreen=t.shouldShowPlaceHolderText=t.shouldEnableDragDrop=void 0;var r=n(59),i=n(26);t.shouldEnableDragDrop=function(e){switch(e){case r.ClientType.Web:return!0;case r.ClientType.Win32:return!1}return!0},t.shouldShowPlaceHolderText=function(e){switch(e){case r.ClientType.Web:return!1;case r.ClientType.Win32:return!0}return!1},t.shouldShowMinimalWelcomeScreen=function(e){switch(e){case r.ClientType.Web:return!1;case r.ClientType.Win32:return!0}return!1},t.getWelcomeScreenText=function(e){switch(e){case r.ClientType.Web:return i.RehearsalActorSettings.RehearsalFirstRunWelcomeScreenText;case r.ClientType.Win32:return i.RehearsalActorSettings.RehearsalFirstRunWelcomeScreenMinimalText}return i.RehearsalActorSettings.RehearsalFirstRunWelcomeScreenText},t.shouldAnimateRehearsalContainer=function(e){switch(e){case r.ClientType.Web:return!0;case r.ClientType.Win32:return!1}return!0},t.shouldHandleSpecialFocus=function(e){switch(e){case r.ClientType.Web:return!1;case r.ClientType.Win32:return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachDragDropPositionTracker=void 0;var r=function(){function e(e,t,n,r){this.isDragging=!1,this.initialX=0,this.initialY=0,this.offsetX=0,this.offsetY=0,this.dragDiv=e,this.prevTransition=t,this.dragDropContainer=n,this.elementsToAvoid=r}return e.prototype.handleEvent=function(e){switch(e.type){case"mousedown":case"touchstart":this.dragStart(e);break;case"mouseup":case"touchend":this.dragEnd(e);break;case"mousemove":case"touchmove":this.dragging(e)}},e.prototype.dragStart=function(e){for(var t=0;t<this.elementsToAvoid.length;t+=1){var n=this.elementsToAvoid[t];if(n&&n.contains(e.target))return}this.dragDiv.contains(e.target)&&(e.preventDefault(),e.stopPropagation(),this.isDragging=!0,"mousedown"===e.type?(this.initialX=e.clientX-this.offsetX,this.initialY=e.clientY-this.offsetY):"touchstart"===e.type&&(this.initialX=e.touches[0].clientX-this.offsetX,this.initialY=e.touches[0].clientY-this.offsetY),this.dragDropContainer.style.display="block")},e.prototype.dragging=function(t){this.isDragging&&(t.preventDefault(),t.stopPropagation(),"mousemove"===t.type?(this.offsetX=t.clientX-this.initialX,this.offsetY=t.clientY-this.initialY):"touchmove"===t.type&&(this.offsetX=t.touches[0].clientX-this.initialX,this.offsetY=t.touches[0].clientY-this.initialY),this.dragDiv.style.transition=e.RehearsalDashboardNoTransition,this.dragDiv.style.transform="translate("+this.offsetX+"px, "+this.offsetY+"px)")},e.prototype.dragEnd=function(e){this.isDragging&&(e.preventDefault(),e.stopPropagation(),this.isDragging=!1,this.dragDiv.style.transition=this.prevTransition,this.dragDropContainer.style.display="none")},e.prototype.addEventHandlers=function(){document.addEventListener("mousedown",this,!0),document.addEventListener("mouseup",this,!0),document.addEventListener("mousemove",this,!0),document.addEventListener("touchstart",this,!0),document.addEventListener("touchend",this,!0),document.addEventListener("touchmove",this,!0)},e.prototype.removeEventHandlers=function(){document.removeEventListener("mousedown",this,!0),document.removeEventListener("mouseup",this,!0),document.removeEventListener("mousemove",this,!0),document.removeEventListener("touchstart",this,!0),document.removeEventListener("touchend",this,!0),document.removeEventListener("touchmove",this,!0)},e.RehearsalDashboardNoTransition="0ms",e}();t.CoachDragDropPositionTracker=r},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof u?t:u,a=Object.create(i.prototype),o=new T(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=C(o,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function u(){}function h(){}function m(){}var d={};d[i]=function(){return this};var p=Object.getPrototypeOf,f=p&&p(p(b([])));f&&f!==t&&n.call(f,i)&&(d=f);var g=m.prototype=u.prototype=Object.create(d);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(i,a){function o(){return new t((function(r,o){!function r(i,a,o,s){var l=c(e[i],e,a);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(h).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}(i,a,r,o)}))}return r=r?r.then(o,o):o()}}function C(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function b(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:R}}function R(){return{value:void 0,done:!0}}return h.prototype=g.constructor=m,m.constructor=h,m[o]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[a]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new y(s(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},v(g),g[o]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=b,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){(function(e,t){!function(e){function n(){}function r(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1===a.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function i(e){for(var t=0,n=Math.min(65536,e.length+1),r=new Uint16Array(n),i=[],a=0;;){var o=t<e.length;if(!o||a>=n-1){if(i.push(String.fromCharCode.apply(null,r.subarray(0,a))),!o)return i.join("");e=e.subarray(t),a=t=0}if(0==(128&(o=e[t++])))r[a++]=o;else if(192==(224&o)){var s=63&e[t++];r[a++]=(31&o)<<6|s}else if(224==(240&o)){s=63&e[t++];var c=63&e[t++];r[a++]=(31&o)<<12|s<<6|c}else 240==(248&o)&&(65535<(o=(7&o)<<18|(s=63&e[t++])<<12|(c=63&e[t++])<<6|63&e[t++])&&(o-=65536,r[a++]=o>>>10&1023|55296,o=56320|1023&o),r[a++]=o)}}if(e.TextEncoder&&e.TextDecoder)return!1;var a=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),n.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var n=e.length,r=0,i=Math.max(32,n+(n>>>1)+7),a=new Uint8Array(i>>>3<<3);t<n;){var o=e.charCodeAt(t++);if(55296<=o&&56319>=o){if(t<n){var s=e.charCodeAt(t);56320==(64512&s)&&(++t,o=((1023&o)<<10)+(1023&s)+65536)}if(55296<=o&&56319>=o)continue}if(r+4>a.length&&(i+=8,i=(i*=1+t/e.length*2)>>>3<<3,(s=new Uint8Array(i)).set(a),a=s),0==(4294967168&o))a[r++]=o;else{if(0==(4294965248&o))a[r++]=o>>>6&31|192;else if(0==(4294901760&o))a[r++]=o>>>12&15|224,a[r++]=o>>>6&63|128;else{if(0!=(4292870144&o))continue;a[r++]=o>>>18&7|240,a[r++]=o>>>12&63|128,a[r++]=o>>>6&63|128}a[r++]=63&o|128}}return a.slice?a.slice(0,r):a.subarray(0,r)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1});var o=i;"function"==typeof t&&t.from?o=function(e){return t.from(e.buffer,e.byteOffset,e.byteLength).toString("utf-8")}:"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&(o=function(e){var t=URL.createObjectURL(new Blob([e],{type:"text/plain;charset=UTF-8"}));try{var n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n.responseText}catch(t){return i(e)}finally{URL.revokeObjectURL(t)}}),r.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return e=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),o(e)},e.TextEncoder=n,e.TextDecoder=r}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,n(66),n(167).Buffer)},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,l=[],u=!1,h=-1;function m(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=s(m);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(178),i=function(){function e(){this.m_sessionId="",this.m_startTime=-1,this.m_stopTime=-1,this.m_totalSessionTimeInMS=-1,this.m_paceOverTime=[],this.m_fillers={},this.m_sensitivePhrases={},this.m_originalityScores={},this.m_slidesRehearsed={},this.m_timestampedCritiques=[],this.m_monotoneOverTime=[],this.m_grammarCritiques=[],this.m_visionCritiqueFrames={},this.m_visionGazeCritiques=[],this.m_visionOcclusionCritiques=[],this.m_visionDistanceCritiques=[],this.m_sessionErrors=[]}return e.prototype.reset=function(){this.m_startTime=this.m_stopTime=this.m_totalSessionTimeInMS=-1,this.m_paceOverTime=[],this.m_fillers={},this.m_sensitivePhrases={},this.m_slidesRehearsed={},this.m_monotoneOverTime=[]},e.prototype.ensureIsStarted=function(){-1===this.m_startTime&&this.startCoachSummary()},e.prototype.startCoachSummary=function(){-1!==this.m_stopTime&&this.reset(),this.m_startTime=Date.now().valueOf()},e.prototype.stopCoachSummary=function(e){-1===this.m_stopTime&&(this.m_stopTime=Date.now().valueOf()),this.m_totalSessionTimeInMS=e},e.prototype.setSessionId=function(e){this.ensureIsStarted(),this.m_sessionId=e},e.prototype.addTimestampedCritique=function(e,t,n){this.m_timestampedCritiques.push({triggerTimestampMS:t,featureInfo:r.mapToObjectHelper(n),featureName:e})},e.prototype.addError=function(e){this.m_sessionErrors.push({error:e,timestamp:Date.now().valueOf()})},e.prototype.getTimeSpent=function(){if(this.m_totalSessionTimeInMS>=0)return Math.round(this.m_totalSessionTimeInMS/1e3);var e=Date.now().valueOf(),t=-1===this.m_startTime?e:this.m_startTime,n=-1===this.m_stopTime?e:this.m_stopTime;return t>n&&(t=n),Math.round((n-t)/1e3)},e.prototype.getNumSlidesRehearsed=function(){return Object.keys(this.m_slidesRehearsed).length},e.prototype.getPaceOverTime=function(){var e=[];return this.m_paceOverTime.forEach((function(t){e.push({pace:Math.round(t.pace),timePoint:Math.round(t.timePoint/1e3)})})),e},e.prototype.getFillers=function(){var e=this,t=[];return Object.keys(this.m_fillers).forEach((function(n){t.push({word:n,count:Number(e.m_fillers[n])})})),t.sort((function(e,t){return t.count-e.count})),t},e.prototype.getSortedSensitivePhrases=function(e){var t=this;void 0===e&&(e=!1);var n=[];return Object.keys(this.m_sensitivePhrases).forEach((function(r){n.push({phraseData:{phrase:r,count:Number(t.m_sensitivePhrases[r].count)},correction:e&&t.m_sensitivePhrases[r].correction||""})})),n.sort((function(e,t){return t.phraseData.count-e.phraseData.count})),n},e.prototype.getOriginalityProblemSlides=function(){var e=[];return Object.keys(this.m_originalityScores).forEach((function(t){return e.push(Number(t))})),e},e.prototype.getTimestampedCritiques=function(){return this.m_timestampedCritiques},e.prototype.getTraceRequestMetadata=function(){var e={};return e.ClientSessionId=this.m_sessionId,e},e.prototype.getEndOfSessionWarnings=function(e){var t=[];return 0===this.getAveragePace()&&t.push("ZeroWPMDetected"),this.getTimeSpent()<=10&&t.push("ShortSession"),e.FRehearsalDidStart||t.push("SessionDidNotConnect"),t},e.prototype.getSessionDiagnostics=function(e){return{endOfSessionWarnings:this.getEndOfSessionWarnings(e),sessionErrors:this.m_sessionErrors}},e.prototype.getThumbIndicesForSummary=function(){var e=[],t={};return Object.keys(this.m_originalityScores).forEach((function(e){return t[Number(e)]=!0})),this.m_grammarCritiques.forEach((function(e){return t[e.slideIndex]=!0})),Object.keys(t).forEach((function(t){return e.push(Number(t))})),e},e.prototype.getGrammar=function(){return this.m_grammarCritiques},e.MaxPaceTimePoints=64,e.MaxMonotoneTimePoints=1e4,e}();t.BaseCoachSummaryCollector=i},function(e,t,n){e.exports=!n(14)&&!n(5)((function(){return 7!=Object.defineProperty(n(80)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(4),i=n(11),a=n(43),o=n(81),s=n(15).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var r=n(21),i=n(23),a=n(68)(!1),o=n(82)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~a(l,n)||l.push(n));return l}},function(e,t,n){var r=n(15),i=n(6),a=n(44);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,c=0;s>c;)r.f(e,n=o[c++],t[n]);return e}},function(e,t,n){var r=n(23),i=n(47).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return o.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";var r=n(14),i=n(44),a=n(69),o=n(62),s=n(17),c=n(61),l=Object.assign;e.exports=!l||n(5)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,u=1,h=a.f,m=o.f;l>u;)for(var d,p=c(arguments[u++]),f=h?i(p).concat(h(p)):i(p),g=f.length,v=0;g>v;)d=f[v++],r&&!m.call(p,d)||(n[d]=p[d]);return n}:l},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(28),i=n(7),a=n(124),o=[].slice,s={},c=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?c(t,r.length,r):a(t,r,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(4).parseInt,i=n(52).trim,a=n(86),o=/^[-+]?0[xX]/;e.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(o.test(n)?16:10))}:r},function(e,t,n){var r=n(4).parseFloat,i=n(52).trim;e.exports=1/r(n(86)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(33);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(7),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){"use strict";var r=n(46),i=n(41),a=n(51),o={};n(22)(o,n(8)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(6);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,n){var r=n(277);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(28),i=n(17),a=n(61),o=n(9);e.exports=function(e,t,n,s,c){r(t);var l=i(e),u=a(l),h=o(l.length),m=c?h-1:0,d=c?-1:1;if(n<2)for(;;){if(m in u){s=u[m],m+=d;break}if(m+=d,c?m<0:h<=m)throw TypeError("Reduce of empty array with no initial value")}for(;c?m>=0:h>m;m+=d)m in u&&(s=t(s,u[m],m,l));return s}},function(e,t,n){"use strict";var r=n(17),i=n(45),a=n(9);e.exports=[].copyWithin||function(e,t){var n=r(this),o=a(n.length),s=i(e,o),c=i(t,o),l=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===l?o:i(l,o))-c,o-s),h=1;for(c<s&&s<c+u&&(h=-1,c+=u-1,s+=u-1);u-- >0;)c in n?n[s]=n[c]:delete n[s],s+=h,c+=h;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(101);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(14)&&"g"!=/./g.flags&&n(15).f(RegExp.prototype,"flags",{configurable:!0,get:n(72)})},function(e,t,n){"use strict";var r,i,a,o,s=n(43),c=n(4),l=n(27),u=n(63),h=n(0),m=n(7),d=n(28),p=n(55),f=n(75),g=n(64),v=n(103).set,y=n(297)(),C=n(139),S=n(298),_=n(76),T=n(140),b=c.TypeError,R=c.process,w=R&&R.versions,E=w&&w.v8||"",M=c.Promise,I="process"==u(R),F=function(){},D=i=C.f,A=!!function(){try{var e=M.resolve(1),t=(e.constructor={})[n(8)("species")]=function(e){e(F,F)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(F)instanceof t&&0!==E.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),k=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},x=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,a=0,o=function(t){var n,a,o,s=i?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{s?(i||(2==e._h&&W(e),e._h=1),!0===s?n=r:(u&&u.enter(),n=s(r),u&&(u.exit(),o=!0)),n===t.promise?l(b("Promise-chain cycle")):(a=k(n))?a.call(n,c,l):c(n)):l(r)}catch(e){u&&!o&&u.exit(),l(e)}};n.length>a;)o(n[a++]);e._c=[],e._n=!1,t&&!e._h&&L(e)}))}},L=function(e){v.call(c,(function(){var t,n,r,i=e._v,a=P(e);if(a&&(t=S((function(){I?R.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=I||P(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},P=function(e){return 1!==e._h&&0===(e._a||e._c).length},W=function(e){v.call(c,(function(){var t;I?R.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},N=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},O=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw b("Promise can't be resolved itself");(t=k(e))?y((function(){var r={_w:n,_d:!1};try{t.call(e,l(O,r,1),l(N,r,1))}catch(e){N.call(r,e)}})):(n._v=e,n._s=1,x(n,!1))}catch(e){N.call({_w:n,_d:!1},e)}}};A||(M=function(e){p(this,M,"Promise","_h"),d(e),r.call(this);try{e(l(O,this,1),l(N,this,1))}catch(e){N.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(56)(M.prototype,{then:function(e,t){var n=D(g(this,M));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=I?R.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&x(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new r;this.promise=e,this.resolve=l(O,e,1),this.reject=l(N,e,1)},C.f=D=function(e){return e===M||e===o?new a(e):i(e)}),h(h.G+h.W+h.F*!A,{Promise:M}),n(51)(M,"Promise"),n(54)("Promise"),o=n(11).Promise,h(h.S+h.F*!A,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!A),"Promise",{resolve:function(e){return T(s&&this===o?M:this,e)}}),h(h.S+h.F*!(A&&n(71)((function(e){M.all(e).catch(F)}))),"Promise",{all:function(e){var t=this,n=D(t),r=n.resolve,i=n.reject,a=S((function(){var n=[],a=0,o=1;f(e,!1,(function(e){var s=a++,c=!1;n.push(void 0),o++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--o||r(n))}),i)})),--o||r(n)}));return a.e&&i(a.v),n.promise},race:function(e){var t=this,n=D(t),r=n.reject,i=S((function(){f(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(28);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(6),i=n(7),a=n(139);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(15).f,i=n(46),a=n(56),o=n(27),s=n(55),c=n(75),l=n(92),u=n(135),h=n(54),m=n(14),d=n(37).fastKey,p=n(50),f=m?"_s":"size",g=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[f]=0,null!=r&&c(r,n,e[l],e)}));return a(u.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var n=p(this,t),r=g(n,e);if(r){var i=r.n,a=r.p;delete n._i[r.i],r.r=!0,a&&(a.n=i),i&&(i.p=a),n._f==r&&(n._f=i),n._l==r&&(n._l=a),n[f]--}return!!r},forEach:function(e){p(this,t);for(var n,r=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(p(this,t),e)}}),m&&r(u.prototype,"size",{get:function(){return p(this,t)[f]}}),u},def:function(e,t,n){var r,i,a=g(e,t);return a?a.v=n:(e._l=a={i:i=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[f]++,"F"!==i&&(e._i[i]=a)),e},getEntry:g,setStrong:function(e,t,n){l(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){"use strict";var r=n(56),i=n(37).getWeak,a=n(6),o=n(7),s=n(55),c=n(75),l=n(32),u=n(21),h=n(50),m=l(5),d=l(6),p=0,f=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},v=function(e,t){return m(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,a){var l=e((function(e,r){s(e,l,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&c(r,n,e[a],e)}));return r(l.prototype,{delete:function(e){if(!o(e))return!1;var n=i(e);return!0===n?f(h(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!o(e))return!1;var n=i(e);return!0===n?f(h(this,t)).has(e):n&&u(n,this._i)}}),l},def:function(e,t,n){var r=i(a(t),!0);return!0===r?f(e).set(t,n):r[e._i]=n,e},ufstore:f}},function(e,t,n){var r=n(29),i=n(9);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(47),i=n(69),a=n(6),o=n(4).Reflect;e.exports=o&&o.ownKeys||function(e){var t=r.f(a(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(9),i=n(88),a=n(34);e.exports=function(e,t,n,o){var s=String(a(e)),c=s.length,l=void 0===n?" ":String(n),u=r(t);if(u<=c||""==l)return s;var h=u-c,m=i.call(l,Math.ceil(h/l.length));return m.length>h&&(m=m.slice(0,h)),o?m+s:s+m}},function(e,t,n){var r=n(14),i=n(44),a=n(23),o=n(62).f;e.exports=function(e){return function(t){for(var n,s=a(t),c=i(s),l=c.length,u=0,h=[];l>u;)n=c[u++],r&&!o.call(s,n)||h.push(e?[n,s[n]]:s[n]);return h}}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoachAudioActor=t.RehearsalState=void 0;var a,o,s=n(59),c=n(12),l=n(65),u=n(60),h=n(26),m=n(152),d=n(108),p=n(57),f=n(153);!function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped",e[e.ErrorStarting=4]="ErrorStarting"}(o=t.RehearsalState||(t.RehearsalState={}));var g=function(){function e(e,t,n,r,i){this.events=new c.EventEmitter,this.m_disabledRealtimeFeatures={},this.m_rehearsalState=o.NotStarted,this.m_currentlyShownFeatureName="",this.m_rehearsalActiveTrackerDiv=null,this.m_rehearsalRealtimeLabelSpan=null,this.m_rehearsalFontIconWithMessageDiv=null,this.m_rehearsalFontIconWithMessageIcon=null,this.m_rehearsalFontIconWithMessageMessageSpan=null,this.m_rehearsalDetectedValueWithMessageDiv=null,this.m_rehearsalDetectedValueWithMessageValueSpan=null,this.m_rehearsalDetectedValueWithMessageMessageSpan=null,this.m_rehearsalPronunciationDiv=null,this.m_rehearsalPronunciationMessageSpan=null,this.m_rehearsalPronunciationValueSpan=null,this.m_rehearsalPronunciationPhonemeAudioIconDiv=null,this.m_rehearsalPronunciationPhonemeSpan=null,this.m_rehearsalPronunciationAudioIconSpan=null,this.m_rehearsalSingleMessageDiv=null,this.m_rehearsalSingleMessageSpan=null,this.m_rehearsalGaugeWithMessageDiv=null,this.m_rehearsalGaugeWithMessageLabel=null,this.m_rehearsalGaugeWithMessageTicker=null,this.m_rehearsalIconWithMessageDiv=null,this.m_rehearsalIconWithMessageMessageSpan=null,this.m_rehearsalIconWithMessageIcon=null,this.m_rehearsalIconWithMessageSVGContainer=null,this.m_rehearsalTemperaturePillWithMessageDiv=null,this.m_rehearsalTemperaturePillWithMessageMessageSpan=null,this.m_rehearsalTemperaturePillWithMessageColdLabel=null,this.m_rehearsalTemperaturePillWithMessageHotLabel=null,this.m_rehearsalTemperaturePillWithMessageIcon=null,this.m_rehearsalTemperaturePillWithMessageSVGContainer=null,this.m_customInteractiveButtons=[],this.m_rehearsalPlayButtonImage=null,this.m_rehearsalPlayButtonIcon=null,this.m_rehearsalPauseButtonIcon=null,this.m_rehearsalInteractivePanelDiv=null,this.m_rehearsalPresentationTimerDiv=null,this.m_rehearsalSlideTrackerDiv=null,this.m_rehearsalListeningButtonIcon=null,this.m_rehearsalListeningButton=null,this.m_rehearsalSlideProgressBarDiv=null,this.m_rehearsalSlideProgressBarParentDiv=null,this.m_rehearsalNotificationButton=null,this.m_rehearsalNotificationButtonImage=null,this.m_rehearsalNotificationsEnabledButtonIcon=null,this.m_rehearsalNotificationsDisabledButtonIcon=null,this.m_playPauseContainerDiv=null,this.m_rehearsalAlertAudio=null,this.m_rehearsalTopBarDiv=null,this.m_timerForClearingRehearsalDashboard=null,this.m_timerForShowActiveRehearsalTracker=null,this.m_rehearsalMaximizedHeight=0,this.m_rehearsalMinimizedHeight=0,this.m_rehearsalWidth=0,this.m_rehearsalSlideshowProgressMaxWidth=0,this.m_isShowingPlaceHolderText=!0,a=r,this.m_rehearsalMaximizedHeight=h.RehearsalActorSettings.RehearsalDashboardMaximizedHeight,this.m_rehearsalMinimizedHeight=h.RehearsalActorSettings.RehearsalDashboardMinimizedHeight,this.m_rehearsalWidth=h.RehearsalActorSettings.RehearsalDashboardWidth,this.m_rehearsalSlideshowProgressMaxWidth=this.m_rehearsalWidth+2*h.RehearsalActorSettings.RehearsalDashboardPadding,this.m_customInteractiveButtons=i,this.m_rehearsalState=o.NotStarted,this.m_coachActorConfig=e,this.m_document=this.m_coachActorConfig.rootContainer.ownerDocument||document,this.m_svgGenerator=new m.RehearsalSVGGenerator(this.m_document,r),this.m_rehearsalActorContainerDiv=this.createRehearsalDashboard(),this.m_currentlyShownFeatureName="",this.m_rehearsalRealtimeLabelSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerLabel-realtime"),this.m_rehearsalDetectedValueWithMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-detectedValueWithMessage"),this.m_rehearsalDetectedValueWithMessageValueSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-detectedValueWithMessage-value"),this.m_rehearsalDetectedValueWithMessageMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-detectedValueWithMessage-message"),this.m_rehearsalPronunciationDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-pronunciation"),this.m_rehearsalPronunciationMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-message"),this.m_rehearsalPronunciationValueSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-value"),this.m_rehearsalPronunciationPhonemeAudioIconDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-phonemeAudioIcon"),this.m_rehearsalPronunciationPhonemeSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-phoneme"),this.m_rehearsalPronunciationAudioIconSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-audioIcon"),this.m_rehearsalFontIconWithMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-fontIconWithMessage"),this.m_rehearsalFontIconWithMessageIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-fontIconWithMessageIcon"),this.m_rehearsalFontIconWithMessageMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-fontIconWithMessage-message"),this.m_rehearsalSingleMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-singleMessage"),this.m_rehearsalSingleMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-singleMessage-message"),this.m_rehearsalGaugeWithMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-gaugeWithMessage"),this.m_rehearsalGaugeWithMessageLabel=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-gaugeWithMessage-message"),this.m_rehearsalGaugeWithMessageTicker=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-gaugeTicker"),this.m_rehearsalIconWithMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-iconWithMessage"),this.m_rehearsalIconWithMessageMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-iconWithMessage-message"),this.m_rehearsalIconWithMessageIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-iconWithMessageIcon"),this.m_rehearsalIconWithMessageSVGContainer=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-iconWithMessageSVG"),this.m_rehearsalTemperaturePillWithMessageDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-temperaturePillWithMessage"),this.m_rehearsalTemperaturePillWithMessageMessageSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-temperaturePillWithMessage-message"),this.m_rehearsalTemperaturePillWithMessageColdLabel=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-temperaturePillColdLabel"),this.m_rehearsalTemperaturePillWithMessageHotLabel=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-temperaturePillHotLabel"),this.m_rehearsalTemperaturePillWithMessageIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-temperaturePillWithMessageIcon"),this.m_rehearsalTemperaturePillWithMessageSVGContainer=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-temperaturePillWithMessageSVG"),this.m_rehearsalInteractivePanelDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-interactivePanel"),this.m_rehearsalActiveTrackerDiv=null,this.m_rehearsalListeningButtonIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-listeningButtonIcon"),this.m_rehearsalPlayButtonImage=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-playButtonImage"),this.m_rehearsalPlayButtonIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-playButtonIcon"),this.m_rehearsalPauseButtonIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-pauseButtonIcon"),this.m_playPauseContainerDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-playPauseContainer"),this.m_rehearsalPresentationTimerDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-presentationTimer"),this.m_rehearsalSlideTrackerDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-slideCountTracker"),this.m_rehearsalListeningButton=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-listeningButton"),this.updateCoachSlideComponent(this.m_coachActorConfig.slideState.currentSlideIndex+1,this.m_coachActorConfig.slideState.totalSlideCount),this.m_rehearsalTopBarDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalDiv-topBar"),this.m_timerForClearingRehearsalDashboard=null,this.m_timerForShowActiveRehearsalTracker=null,this.m_rehearsalAlertAudio=new Audio,this.m_rehearsalAlertAudio.src=""+(this.m_coachActorConfig.imagesBaseFilePath+h.RehearsalActorSettings.RehearsalAlertSoundFile),null!==this.m_rehearsalActorContainerDiv&&this.m_rehearsalActorContainerDiv.appendChild(this.m_rehearsalAlertAudio),this.m_togglePauseCallback=t,this.m_toggleRealtimeFeedbackCallback=n,this.setDisabledRealtimeFeatureSet(),this.m_coachActorConfig.fUseCountdownWelcomeScreen&&this.makeCountdownUXAdjustments()}return e.prototype.on=function(e,t){return this.events.on(e,t),this},e.prototype.handleKeyDown=function(e){var t=this.m_document.getElementById("ppt-Rehearsal-listeningButton"),n=this.m_document.getElementById("ppt-Rehearsal-notificationButton"),r=this.m_coachActorConfig.fUseNewRealtimePanel?n:t;"Tab"!==e.key||e.shiftKey||e.target!==r?"Enter"===e.key&&e.target===t&&this.togglePause(e,!0):(e.stopImmediatePropagation(),e.preventDefault(),e.target.blur(),this.events.emit("CoachRelinquishControl"))},e.prototype.fSupportsCoachTemplate=function(e){if(null===e)return!1;switch(e.toLowerCase()){case h.RehearsalTemplateName.DetectedValueWithMessage:case h.RehearsalTemplateName.GaugeWithMessage:case h.RehearsalTemplateName.SingleMessage:case h.RehearsalTemplateName.IconWithMessage:case h.RehearsalTemplateName.TemperaturePillWithMessage:case h.RehearsalTemplateName.Pronunciation:return!0;default:return!1}},e.prototype.showCoachRealtimeUI=function(){this.m_rehearsalActorContainerDiv&&(this.m_rehearsalActorContainerDiv.style.display="block")},e.prototype.updateCoachSlideComponent=function(e,t){var n=h.RehearsalActorSettings.SlideTrackerTextFormat(e,t);this.m_coachActorConfig.fUseCountdownWelcomeScreen?(this.m_rehearsalSlideTrackerDiv&&(this.m_rehearsalSlideTrackerDiv.style.display="none"),this.m_rehearsalSlideProgressBarDiv&&this.m_rehearsalSlideProgressBarParentDiv&&(this.m_rehearsalSlideProgressBarDiv.style.width=this.getSlideProgressWidth(e,t)+"px",p.updateTooltip(this.m_rehearsalSlideProgressBarParentDiv,n,this.m_coachActorConfig.zIndex+1))):this.m_rehearsalSlideTrackerDiv&&(this.m_rehearsalSlideTrackerDiv.innerText=n)},e.prototype.getSlideProgressWidth=function(e,t){return(e<0?0:e>t?t:e)/t*this.m_rehearsalSlideshowProgressMaxWidth},e.prototype.updateTimer=function(e){null!=this.m_rehearsalPresentationTimerDiv&&(this.m_rehearsalPresentationTimerDiv.innerText=e)},e.prototype.getActorContainer=function(){return this.m_rehearsalActorContainerDiv},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.setDisabledRealtimeFeatureSet=function(){var e=this,t=this.m_coachActorConfig.disabledCoachRealtimeFeatures||"";this.m_disabledRealtimeFeatures={},t.split(",").forEach((function(t){t.length>0&&(e.m_disabledRealtimeFeatures[t.toLowerCase()]=!0)}))},e.prototype.fValidTemplate=function(e,t){return!(!e.has("featureTemplate")||!this.fSupportsCoachTemplate(e.get("featureTemplate"))||t in this.m_disabledRealtimeFeatures&&this.m_disabledRealtimeFeatures[t]||!e.has("templateInfo"))},e.prototype.getElementsToAvoidDraggingOn=function(){var e=[];return this.m_playPauseContainerDiv&&e.push(this.m_playPauseContainerDiv),this.m_rehearsalNotificationButton&&e.push(this.m_rehearsalNotificationButton),e},e.prototype.generateRealTimeLabel=function(e,t){var n=this.m_document.createElement("div");return n.id=t,n.style.fontSize="14px",n.style.fontWeight="600",n.style.lineHeight="1.43",n.style.color=h.RehearsalActorSettings.ColorWhite,n.style.position="relative",n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",n.style.width="95%",n.style.height="20px",n.style.display="inline-block",n.innerText=e,n},e.prototype.generateRehearsalTopBar=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalDiv-topBar",e.style.lineHeight="1.43",e.style.position="relative",e.style.width="100%",e.style.height="20px",e.style.display="none";var t=this.generateRealTimeLabel("Coach","ppt-RehearsalTrackerLabel-realtime");return e.appendChild(t),e},e.prototype.resetRehearsalDashboard=function(){if(null!==this.m_rehearsalActorContainerDiv&&this.m_rehearsalState===o.Started&&null!==this.m_rehearsalActiveTrackerDiv&&null!==this.m_rehearsalTopBarDiv){if(document.activeElement===document.querySelector("#ppt-RehearsalTrackerValue-pronunciation-audioButton"))return void this.restartTimerForClearingRehearsalDashboard();this.m_rehearsalTopBarDiv.style.display="none",this.m_rehearsalActiveTrackerDiv.style.display="none",this.m_rehearsalActiveTrackerDiv=null,this.m_timerForClearingRehearsalDashboard=null,d.shouldShowPlaceHolderText(this.m_coachActorConfig.clientType)?this.showPlaceHolderMessage(h.RehearsalActorSettings.ListeningText):(this.m_rehearsalActorContainerDiv.style.transition=h.RehearsalActorSettings.RehearsalDashboardMinimizeTransition,this.m_rehearsalActorContainerDiv.style.height=this.m_rehearsalMinimizedHeight+"px",null!==this.m_currentlyShownFeatureName&&(this.m_currentlyShownFeatureName=""))}},e.prototype.restartTimerForClearingRehearsalDashboard=function(){this.m_timerForClearingRehearsalDashboard&&clearTimeout(this.m_timerForClearingRehearsalDashboard),this.m_timerForClearingRehearsalDashboard=setTimeout(this.resetRehearsalDashboard.bind(this),h.RehearsalActorSettings.ResetRehearsalIntervalInMS)},e.prototype.setRealtimeFeedbackButton=function(e){this.m_rehearsalNotificationButton&&(this.m_coachActorConfig.fUseSVGResources&&this.m_rehearsalNotificationsEnabledButtonIcon&&this.m_rehearsalNotificationsDisabledButtonIcon?(this.m_rehearsalNotificationsEnabledButtonIcon.style.display=e?"inline-block":"none",this.m_rehearsalNotificationsDisabledButtonIcon.style.display=e?"none":"inline-block"):this.m_rehearsalNotificationButtonImage&&(this.m_rehearsalNotificationButtonImage.src=e?this.m_coachActorConfig.imagesBaseFilePath+"notificationsEnabledButton.svg":this.m_coachActorConfig.imagesBaseFilePath+"notificationsDisabledButton.svg"),this.m_rehearsalNotificationButton.setAttribute("aria-pressed",e?"true":"false"),p.updateTooltip(this.m_rehearsalNotificationButton,e?h.RehearsalActorSettings.RehearsalDisableNotificationsTooltip:h.RehearsalActorSettings.RehearsalEnableNotificationsTooltip,this.m_coachActorConfig.zIndex+1))},e.prototype.addTooltips=function(){this.m_coachActorConfig.fDontShowTooltips||(this.m_rehearsalListeningButton&&p.addTooltip(this.m_rehearsalListeningButton,h.RehearsalActorSettings.RehearsalPauseTooltip,this.m_coachActorConfig.zIndex+1,this.m_coachActorConfig.rootContainer,this.m_coachActorConfig.clientType===s.ClientType.Win32&&!!this.m_coachActorConfig.fUseFluentUIForWindows),this.m_rehearsalSlideProgressBarParentDiv&&p.addTooltip(this.m_rehearsalSlideProgressBarParentDiv,h.RehearsalActorSettings.SlideTrackerTextFormat(this.m_coachActorConfig.slideState.currentSlideIndex+1,this.m_coachActorConfig.slideState.totalSlideCount),this.m_coachActorConfig.zIndex+1,this.m_coachActorConfig.rootContainer,this.m_coachActorConfig.clientType===s.ClientType.Win32&&!!this.m_coachActorConfig.fUseFluentUIForWindows),this.m_rehearsalNotificationButton&&p.addTooltip(this.m_rehearsalNotificationButton,h.RehearsalActorSettings.RehearsalDisableNotificationsTooltip,this.m_coachActorConfig.zIndex+1,this.m_coachActorConfig.rootContainer,this.m_coachActorConfig.clientType===s.ClientType.Win32&&!!this.m_coachActorConfig.fUseFluentUIForWindows))},e.prototype.pauseSession=function(){null===this.m_rehearsalRealtimeLabelSpan||null===this.m_rehearsalListeningButtonIcon||null===this.m_rehearsalPauseButtonIcon||null===this.m_rehearsalListeningButton||null===this.m_rehearsalPlayButtonImage&&null===this.m_rehearsalPlayButtonIcon||(this.m_rehearsalState=o.Paused,this.m_rehearsalRealtimeLabelSpan.innerText=PowerpointPresenterCoachStrings.PausedText,this.m_coachActorConfig.fUseSVGResources&&null!==this.m_rehearsalPlayButtonIcon?this.m_rehearsalPlayButtonIcon.style.display="inline-block":null!==this.m_rehearsalPlayButtonImage&&(this.m_rehearsalPlayButtonImage.style.display="inline-block"),this.m_rehearsalListeningButtonIcon.style.display="none",this.m_rehearsalPauseButtonIcon.style.display="none",this.m_rehearsalListeningButton.classList.remove("listeningButtonState"),this.m_rehearsalListeningButton.classList.remove("pulse"),this.m_coachActorConfig.fUseSVGResources?this.m_rehearsalListeningButton.classList.add("pausedButtonSVGState"):this.m_rehearsalListeningButton.classList.add("pausedButtonState"),this.m_rehearsalListeningButton.setAttribute("aria-pressed","false"),p.updateTooltip(this.m_rehearsalListeningButton,h.RehearsalActorSettings.RehearsalResumeTooltip,this.m_coachActorConfig.zIndex+1),d.shouldShowPlaceHolderText(this.m_coachActorConfig.clientType)&&this.showPlaceHolderMessage(h.RehearsalActorSettings.PausedText))},e.prototype.resumeSession=function(){null===this.m_rehearsalRealtimeLabelSpan||null===this.m_rehearsalListeningButtonIcon||null===this.m_rehearsalPauseButtonIcon||null===this.m_rehearsalListeningButton||null===this.m_rehearsalPlayButtonImage&&null===this.m_rehearsalPlayButtonIcon||(this.m_rehearsalState=o.Started,this.m_rehearsalRealtimeLabelSpan.innerText=PowerpointPresenterCoachStrings.RehearsalAudioActorResumeSessionText,this.m_coachActorConfig.fUseSVGResources&&null!==this.m_rehearsalPlayButtonIcon?this.m_rehearsalPlayButtonIcon.style.display="none":null!==this.m_rehearsalPlayButtonImage&&(this.m_rehearsalPlayButtonImage.style.display="none"),this.m_rehearsalPauseButtonIcon.style.display="none",this.m_rehearsalListeningButtonIcon.style.display="inline-block",this.m_coachActorConfig.fUseSVGResources?this.m_rehearsalListeningButton.classList.remove("pausedButtonSVGState"):this.m_rehearsalListeningButton.classList.remove("pausedButtonState"),this.m_rehearsalListeningButton.classList.add("pulse"),this.m_rehearsalListeningButton.classList.add("listeningButtonState"),this.m_rehearsalListeningButton.setAttribute("aria-pressed","true"),p.updateTooltip(this.m_rehearsalListeningButton,h.RehearsalActorSettings.RehearsalPauseTooltip,this.m_coachActorConfig.zIndex+1),this.restartTimerForClearingRehearsalDashboard(),d.shouldShowPlaceHolderText(this.m_coachActorConfig.clientType)&&this.showPlaceHolderMessage(h.RehearsalActorSettings.ListeningText))},e.prototype.togglePause=function(e,t){t&&(e.preventDefault(),e.stopPropagation(),this.m_togglePauseCallback())},e.prototype.toggleRealtimeFeedback=function(e,t){t&&(e.preventDefault(),e.stopPropagation(),this.m_toggleRealtimeFeedbackCallback())},e.prototype.generatePlayButtonImage=function(){var e=this.m_document.createElement("img");return e.id="ppt-Rehearsal-playButtonImage",e.src=this.m_coachActorConfig.imagesBaseFilePath+"playButton.png",e.style.display="inline-block",e.style.height="12px",e.style.width="10px",e.style.textAlign="center",e.style.marginTop="3px",e.style.marginLeft="3px",e},e.prototype.listeningButtonMouseEnter=function(){this.m_rehearsalState===o.Started&&null!==this.m_rehearsalListeningButtonIcon&&null!==this.m_rehearsalPauseButtonIcon&&(this.m_rehearsalPauseButtonIcon.style.display="inline-block",this.m_rehearsalListeningButtonIcon.style.display="none")},e.prototype.listeningButtonMouseLeave=function(){this.m_rehearsalState===o.Started&&null!==this.m_rehearsalListeningButtonIcon&&null!==this.m_rehearsalPauseButtonIcon&&(this.m_rehearsalPauseButtonIcon.style.display="none",this.m_rehearsalListeningButtonIcon.style.display="inline-block")},e.prototype.generatePlayPauseButton=function(){var e=this,t=this.m_document.createElement("div");t.id="ppt-RehearsalTrackerDiv-playPauseContainer";var n=this.m_document.createElement("button");n.id="ppt-Rehearsal-listeningButton",n.style.height=h.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",n.style.width=h.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",n.style.borderRadius="50%",n.style.margin="auto",n.style.marginTop="4px",n.style.position="relative",n.setAttribute("aria-label",h.RehearsalActorSettings.MicrophoneButtonAriaLabel),n.setAttribute("aria-pressed","true"),n.onclick=function(t){e.togglePause(t,!0)},n.onkeypress=function(t){e.togglePause(t,"Enter"===t.key)},n.onmouseenter=this.listeningButtonMouseEnter.bind(this),n.onmouseleave=this.listeningButtonMouseLeave.bind(this),n.classList.add("pulse"),n.classList.add("listeningButtonState");var r=this.m_svgGenerator.getSVGForButtons("listeningButtonIcon"),i=this.m_svgGenerator.getSVGForButtons("pauseButtonIcon");if(i.style.display="none",this.m_coachActorConfig.fUseSVGResources){var a=this.m_svgGenerator.getSVGForButtons("playButtonIcon");a.style.display="none",n.appendChild(a)}else{var o=this.generatePlayButtonImage();o.style.display="none",n.appendChild(o)}return n.appendChild(r),n.appendChild(i),t.appendChild(n),t},e.prototype.generateNotificationToggle=function(e){var t=this,n=this.m_document.createElement("div");n.id="ppt-Rehearsal-notificationButtonContainer";var r=this.m_document.createElement("button");if(r.id="ppt-Rehearsal-notificationButton",this.m_coachActorConfig.clientType===s.ClientType.Win32&&this.m_coachActorConfig.fUseFluentUIForWindows&&(r.className+=" fluentUI"),r.onclick=function(e){t.toggleRealtimeFeedback(e,!0)},r.onkeypress=function(e){t.toggleRealtimeFeedback(e,"Enter"===e.key)},r.setAttribute("aria-label",h.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel),r.setAttribute("aria-pressed","true"),this.m_coachActorConfig.fUseSVGResources){var i=this.m_svgGenerator.getSVGForButtons("notificationsEnabledButtonIcon");i.id="ppt-Rehearsal-notificationsEnabledButtonIcon",r.appendChild(i);var a=this.m_svgGenerator.getSVGForButtons("notificationsDisabledButtonIcon");a.id="ppt-Rehearsal-notificationsDisabledButtonIcon",a.style.display="none",r.appendChild(a)}else{var o=this.m_document.createElement("img");o.id="ppt-Rehearsal-notificationButtonImage",o.src=this.m_coachActorConfig.imagesBaseFilePath+"notificationsEnabledButton.svg",r.appendChild(o)}return e.forEach((function(e){null==n||n.appendChild(e)})),n.appendChild(r),n},e.prototype.generatePresentationTimer=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-presentationTimer",e.style.height="100%",e.style.width="70px",e.style.fontSize="14px",e.style.display="inline-flex",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.style.color=h.RehearsalActorSettings.ColorWhite,e.style.lineHeight=h.RehearsalActorSettings.RehearsalInteractivePanelHeight+"px",e.innerText="00:00",e.style.verticalAlign="top",e},e.prototype.generateSlideCountTracker=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-slideCountTracker",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.innerText="",e.setAttribute("aria-label",h.RehearsalActorSettings.SlideNumberAriaLabel),e},e.prototype.generateRehearsalInteractivePanel=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-interactivePanel",e.style.position="absolute",e.style.bottom="8px",e.style.width=this.m_rehearsalWidth+"px",e.style.height=h.RehearsalActorSettings.RehearsalInteractivePanelHeight+"px",e.style.display="flex",e.style.justifyContent="space-between";var t=this.generatePresentationTimer(),n=this.generatePlayPauseButton(),r=this.generateSlideCountTracker();return e.appendChild(t),e.appendChild(n),e.appendChild(r),e},e.prototype.generateSlideshowProgressBar=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-slideshowProgressBarParent",e.classList.add("slideshowProgressBar"),e.style.width=this.m_rehearsalSlideshowProgressMaxWidth+"px",e.tabIndex=-1;var t=this.m_document.createElement("div");return t.id="ppt-RehearsalTrackerDiv-slideshowProgressBar",t.classList.add("slideshowProgressBar"),t.style.width=this.getSlideProgressWidth(this.m_coachActorConfig.slideState.currentSlideIndex+1,this.m_coachActorConfig.slideState.totalSlideCount)+"px",e.appendChild(t),e},e.prototype.generateTrackerDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.style.width="100%",t.style.display="none",t.style.height=h.RehearsalActorSettings.RehearsalDashboardTrackerHeight+"px",t.style.textAlign="center",t.style.position="relative",t},e.prototype.generateTrackerValueDiv=function(){var e=this.m_document.createElement("div");return e.style.height="auto",e.style.width="100%",e.style.position="absolute",e.style.textAlign="center",e.style.top="50%",e.style.transform="translateY(-50%)",e},e.prototype.generateGaugeTicker=function(){var e=this.m_document.createElement("div");e.className="gaugeTicker";var t=this.m_document.createElement("div");t.id="ppt-Rehearsal-gaugeTicker",t.className="gaugePointer",t.style.width="0",t.style.height="0",t.style.borderLeft="4px solid transparent",t.style.borderRight="4px solid transparent",t.style.borderBottom="30px solid #ffffff",t.style.transformOrigin="center 100% 0px",t.style.transform="rotate(-90deg)",t.style.transition="all .75s linear";var n=this.m_document.createElement("div");return n.className="gaugePivot",n.style.width="8px",n.style.height="8px",n.style.borderRadius="50%",n.style.backgroundColor=h.RehearsalActorSettings.ColorWhite,e.appendChild(t),e.appendChild(n),e},e.prototype.generateGauge=function(){var e=this.m_document.createElement("div");e.style.width="100%",e.setAttribute("aria-hidden","true");var t=this.m_document.createElement("div");t.className="gaugeContainer";var n=this.m_document.createElement("canvas");n.className="gaugeOuter";var r=n.getContext("2d");null!==r&&(r.lineWidth=12,r.strokeStyle="#ffffff",r.beginPath(),r.arc(150,150,75,Math.PI,0),r.stroke());var i=this.m_document.createElement("canvas");i.className="gaugeOuter";var a=i.getContext("2d");null!==a&&(a.lineWidth=12,a.strokeStyle="rgba( 140, 189, 24, 1)",a.beginPath(),a.arc(150,150,75,-.7*Math.PI,-.3*Math.PI),a.stroke()),i.style.zIndex="1";var o=this.generateGaugeTicker();return t.appendChild(n),t.appendChild(i),t.appendChild(o),e.appendChild(t),e},e.prototype.generateGaugeWithMessageTemplateDiv=function(){var e=this.generateTrackerValueDiv(),t=this.generateGauge(),n=this.m_document.createElement("div");return n.id="ppt-RehearsalTrackerValue-gaugeWithMessage-message",n.innerText="",n.style.height="28px",n.style.width="100%",n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",n.style.fontSize="14px",n.style.color=h.RehearsalActorSettings.ColorWhite,n.style.textAlign="center",e.appendChild(t),e.appendChild(n),e},e.prototype.generateDetectedValueDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.innerText="",t.style.height="auto",t.style.width="100%",t.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",t.style.fontSize="18px",t.style.fontWeight="600",t.style.lineHeight="1.2",t.style.marginBottom="4px",t.style.color=h.RehearsalActorSettings.ColorWhite,t.style.textAlign="center",t.style.alignItems="center",t.style.lineHeight="20px",t},e.prototype.generateIconDiv=function(e,t){var n=this.m_document.createElement("img");return n.id=e,n.src=t,n.style.height="auto",n.style.textAlign="center",n},e.prototype.generateMessageDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.style.height="auto",t.style.width="100%",t.style.textAlign="center",t.style.color=h.RehearsalActorSettings.ColorWhite,t.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",t.style.fontSize="14px",t.style.cursor="default",t.style.lineHeight="18px",t.style.alignItems="center",t.innerText="",t},e.prototype.generateDetectedValueWithMessageTemplateDiv=function(){var e=this.generateTrackerValueDiv(),t=this.generateDetectedValueDiv("ppt-RehearsalTrackerValue-detectedValueWithMessage-value"),n=this.generateMessageDiv("ppt-RehearsalTrackerValue-detectedValueWithMessage-message");return e.appendChild(t),e.appendChild(n),e},e.prototype.generatePronunciationMessageDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.style.height="auto",t.style.width="100%",t.style.textAlign="center",t.style.color=h.RehearsalActorSettings.ColorWhite,t.style.fontFamily="Segoe UI",t.style.fontSize="14px",t.style.cursor="default",t.style.lineHeight="34px",t.style.alignItems="center",t.innerText="",t},e.prototype.generateDetectedPronunciationValueDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.style.height="auto",t.style.width="100%",t.style.fontFamily="Segoe UI",t.style.fontSize="18px",t.style.fontWeight="600",t.style.lineHeight="1.2",t.style.marginBottom="4px",t.style.color=h.RehearsalActorSettings.ColorWhite,t.style.textAlign="center",t.style.alignItems="center",t.style.lineHeight="24px",t},e.prototype.generatePhonemeDiv=function(e){var t=this.m_document.createElement("div");return t.id=e,t.style.fontFamily="Segoe UI",t.style.color=h.RehearsalActorSettings.ColorGrey,t.style.marginRight="5px",t.setAttribute("aria-hidden","true"),t},e.prototype.getAudio=function(e,t){return r(this,void 0,void 0,(function(){var n,r,s,c,h,m;return i(this,(function(i){try{return"Enter"===e.key&&e.preventDefault(),this.m_rehearsalState!==o.Paused&&this.togglePause(e,!0),n=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerValue-pronunciation-value"),r=null==n?void 0:n.innerText,s=""+t+r,c=new AudioContext,h=c.createBufferSource(),m=new XMLHttpRequest,a.sendTraceTag(555077711,l.LogCategory.PptSession,u.TraceLevel.Info,"Pronunciation getAudio TTS request for word of length "+(null==r?void 0:r.length)),m.open("GET",s,!0),m.responseType="arraybuffer",m.onload=function(){if(m.readyState===m.DONE)if(200===m.status){var e=m.response;e&&c.decodeAudioData(e,(function(e){h.buffer=e,h.connect(c.destination),h.start(0)})).catch((function(e){a.sendTraceTag(589116162,l.LogCategory.PptSession,u.TraceLevel.Error,"PronunciationAudio Error: "+e)}))}else a.sendTraceTag(589095891,l.LogCategory.PptSession,u.TraceLevel.Error,"PronunciationAudio Error: Request not successful, error status "+m.status)},m.send(),[2,r]}catch(e){return a.sendTraceTag(589116163,l.LogCategory.PptSession,u.TraceLevel.Error,"PronunciationAudio Error: "+e),[2,null]}return[2]}))}))},e.prototype.generateAudioButtonIcon=function(){var e=this.m_document.createElement("i");return e.className=h.RehearsalFontIconValue.Audio,e.id="ppt-Rehearsal-audioButtonIcon",e.style.fontSize="16px",e.style.color="#CF6024",e.style.marginTop="2px",e.setAttribute("aria-hidden","true"),e},e.prototype.generateAudioButtonDiv=function(e){var t=this,n=this.m_document.createElement("button");n.id=e,n.style.border="none",n.style.backgroundColor="transparent",n.style.paddingRight="3px",n.style.paddingLeft="5px",n.setAttribute("focusable","true"),n.onclick=function(e){t.getAudio(e,p.combinePath(t.m_coachActorConfig.speechFDBase,h.RehearsalActorSettings.TTSHandlerString))},n.onkeypress=function(e){"Enter"===e.key&&t.getAudio(e,p.combinePath(t.m_coachActorConfig.speechFDBase,h.RehearsalActorSettings.TTSHandlerString))},n.tabIndex=h.RehearsalActorSettings.RehearsalContainerFocusTabIndex,n.setAttribute("aria-label",h.RehearsalActorSettings.PlayWordOutLoudButtonAriaLabel),n.onmouseover=function(){n.style.backgroundColor="#484644",n.style.color="#D67540"},n.onmouseleave=function(){n.style.backgroundColor="transparent",n.style.color="#CF6024"};var r=this.generateAudioButtonIcon();return n.appendChild(r),n},e.prototype.generatePhonemeWithAudioIconTemplateDiv=function(e){var t=this.m_document.createElement("div");t.id=e,t.style.marginTop="10px",t.style.display="flex",t.style.justifyContent="center";var n=this.generatePhonemeDiv("ppt-RehearsalTrackerValue-pronunciation-phoneme"),r=this.generateAudioButtonDiv("ppt-RehearsalTrackerValue-pronunciation-audioButton");return t.appendChild(n),t.appendChild(r),t},e.prototype.generatePronunciationTemplateDiv=function(){var e=this.generateTrackerValueDiv(),t=this.generatePronunciationMessageDiv("ppt-RehearsalTrackerValue-pronunciation-message"),n=this.generateDetectedPronunciationValueDiv("ppt-RehearsalTrackerValue-pronunciation-value"),r=this.generatePhonemeWithAudioIconTemplateDiv("ppt-RehearsalTrackerValue-pronunciation-phonemeAudioIcon"),i=this.generatePhonemeDiv("ppt-RehearsalTrackerValue-pronunciation-phoneme"),a=this.generateMessageDiv("ppt-RehearsalTrackerValue-pronunciation-audioIcon");return e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(a),e},e.prototype.generateSingleMessageTemplateDiv=function(){var e=this.generateTrackerValueDiv(),t=this.generateMessageDiv("ppt-RehearsalTrackerValue-singleMessage-message");return e.appendChild(t),e},e.prototype.generateIconWithMessageTemplateDiv=function(){var e=this.generateTrackerValueDiv();if(e.style.height="auto",this.m_coachActorConfig.fUseSVGResources){var t=this.m_document.createElement("div");t.appendChild(this.m_svgGenerator.getSVGForCritique("fillerIcon")),t.style.width="50px",t.style.height="auto",t.style.margin="4px",t.style.display="inline-block",t.id="ppt-Rehearsal-iconWithMessageSVG",t.setAttribute("aria-hidden","true"),e.appendChild(t)}else{var n=this.generateIconDiv("ppt-Rehearsal-iconWithMessageIcon",this.m_coachActorConfig.imagesBaseFilePath+"fillerIcon.png");n.style.width="50px",n.style.height="auto",n.style.marginBottom="4px",n.setAttribute("aria-hidden","true"),e.appendChild(n)}var r=this.generateMessageDiv("ppt-RehearsalTrackerValue-iconWithMessage-message");return e.appendChild(r),e},e.prototype.generateTemperaturePillColdLabel=function(){var e=this.m_document.createElement("div");return e.id="ppt-Rehearsal-temperaturePillColdLabel",e.style.height="100%",e.style.width="77px",e.style.fontSize="10px",e.style.textAlign="left",e.style.verticalAlign="top",e.style.display="inline-block",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.style.color=h.RehearsalActorSettings.ColorWhite,e.innerText=PowerpointPresenterCoachStrings.RehearsalSummaryPacingGaugeSlowLabel,e},e.prototype.generateTemperaturePillHotLabel=function(){var e=this.m_document.createElement("div");return e.id="ppt-Rehearsal-temperaturePillHotLabel",e.style.height="100%",e.style.width="77px",e.style.fontSize="10px",e.style.display="inline-block",e.style.textAlign="right",e.style.verticalAlign="top",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.style.color=h.RehearsalActorSettings.ColorWhite,e.innerText=PowerpointPresenterCoachStrings.RehearsalSummaryPacingGaugeFastLabel,e},e.prototype.generateTemperaturePillLabels=function(){var e=this.m_document.createElement("div");e.style.width="100%",e.style.height="auto",e.style.position="absolute";var t=this.generateTemperaturePillColdLabel(),n=this.generateTemperaturePillHotLabel();return e.appendChild(t),e.appendChild(n),e},e.prototype.generateTemperaturePill=function(){var e=this.m_document.createElement("div");if(e.style.height="auto",e.style.width="100%",e.style.position="absolute",e.style.textAlign="center",this.m_coachActorConfig.fUseSVGResources){var t=this.m_document.createElement("div");t.id="ppt-Rehearsal-temperaturePillWithMessageSVG",t.style.width="154px",t.style.marginTop="30px",t.style.display="inline-block",t.setAttribute("aria-hidden","true"),t.appendChild(this.m_svgGenerator.getSVGForCritique("temperaturePill_JustRight")),e.appendChild(t)}else{var n=this.generateIconDiv("ppt-Rehearsal-temperaturePillWithMessageIcon",this.m_coachActorConfig.imagesBaseFilePath+"temperaturePill_JustRight.png");n.style.width="154px",n.style.marginTop="30px",n.setAttribute("aria-hidden","true"),e.appendChild(n)}var r=this.generateTemperaturePillLabels();return e.appendChild(r),e},e.prototype.generateTemperaturePillWithMessageDiv=function(){var e=this.generateTrackerValueDiv();e.style.height="100%";var t=this.generateTemperaturePill(),n=this.generateMessageDiv("ppt-RehearsalTrackerValue-temperaturePillWithMessage-message");return n.style.position="absolute",n.style.bottom="20px",e.appendChild(t),e.appendChild(n),e},e.prototype.generateDetectedValueParentDiv=function(e){var t=this.m_document.createElement("div");return t.id=e+"-parent",t.style.display="inline-block",t.style.textAlign="center",t.style.width="100%",t.style.height=h.RehearsalActorSettings.RehearsalDashboardTrackerHeight+"px",t.style.position="relative",t},e.prototype.generateFontIconWithMessageTemplateDiv=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-fontIconWithMessageContainer";var t=this.m_document.createElement("i");t.id="ppt-RehearsalTrackerDiv-fontIconWithMessageIcon",t.setAttribute("aria-hidden","true");var n=this.generateMessageDiv("ppt-RehearsalTrackerValue-fontIconWithMessage-message");return e.appendChild(t),e.appendChild(n),e},e.prototype.generateRehearsalTrackerDiv=function(e){if(e===h.RehearsalTemplate.FontIconWithMessage){var t=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-fontIconWithMessage"),n=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-fontIconWithMessage"),r=this.generateFontIconWithMessageTemplateDiv();return n.appendChild(r),t.appendChild(n),t}if(e===h.RehearsalTemplate.DetectedValueWithMessage){var i=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-detectedValueWithMessage"),o=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-detectedValueWithMessage"),s=this.generateDetectedValueWithMessageTemplateDiv();return o.appendChild(s),i.appendChild(o),i}if(e===h.RehearsalTemplate.Pronunciation){var c=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-pronunciation"),m=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-pronunciation"),d=this.generatePronunciationTemplateDiv();return m.appendChild(d),c.appendChild(m),c}if(e===h.RehearsalTemplate.GaugeWithMessage){var p=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-gaugeWithMessage"),f=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-gaugeWithMessage"),g=this.generateGaugeWithMessageTemplateDiv();return f.appendChild(g),p.appendChild(f),p}if(e===h.RehearsalTemplate.SingleMessage){var v=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-singleMessage"),y=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-singleMessage"),C=this.generateSingleMessageTemplateDiv();return y.appendChild(C),v.appendChild(y),v}if(e===h.RehearsalTemplate.IconWithMessage){var S=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-iconWithMessage"),_=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-iconWithMessage"),T=this.generateIconWithMessageTemplateDiv();return _.appendChild(T),S.appendChild(_),S}if(e===h.RehearsalTemplate.TemperaturePillWithMessage){var b=this.generateTrackerDiv("ppt-RehearsalTrackerDiv-temperaturePillWithMessage"),R=this.generateDetectedValueParentDiv("ppt-RehearsalTrackerValue-temperaturePillWithMessage"),w=this.generateTemperaturePillWithMessageDiv();return R.appendChild(w),b.appendChild(R),b}return a.sendTraceTag(593794511,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::GenerateRehearsalTrackerDiv Unhandled RehearsalTracker: "+e),this.generateTrackerDiv("ppt-RehearsalTrackerDiv-unknownDiv")},e.prototype.fRehearsalDashboardIsMinimized=function(){return null!==this.m_rehearsalTopBarDiv&&"none"===this.m_rehearsalTopBarDiv.style.display&&null===this.m_timerForShowActiveRehearsalTracker},e.prototype.playRehearsalAlertSound=function(){null!==this.m_rehearsalAlertAudio&&this.m_rehearsalAlertAudio.play()},e.prototype.showActiveRehearsalTracker=function(){null!==this.m_rehearsalActiveTrackerDiv&&null!==this.m_rehearsalTopBarDiv&&(this.m_rehearsalTopBarDiv.style.display="block",this.m_rehearsalActiveTrackerDiv.style.display="block"),this.m_timerForShowActiveRehearsalTracker=null},e.prototype.showOnboardingExperience=function(){null===this.m_rehearsalIconWithMessageDiv||null===this.m_rehearsalIconWithMessageMessageSpan||null===this.m_rehearsalRealtimeLabelSpan||null===this.m_rehearsalIconWithMessageIcon&&null===this.m_rehearsalIconWithMessageSVGContainer||(this.m_rehearsalIconWithMessageMessageSpan.innerText=h.RehearsalActorSettings.OnboardingMessage,this.m_coachActorConfig.fUseSVGResources&&null!==this.m_rehearsalIconWithMessageSVGContainer?(this.m_rehearsalIconWithMessageSVGContainer.textContent="",this.m_rehearsalIconWithMessageSVGContainer.appendChild(this.m_svgGenerator.getSVGForCritique("fillerIcon"))):null!==this.m_rehearsalIconWithMessageIcon&&(this.m_rehearsalIconWithMessageIcon.src=this.m_coachActorConfig.imagesBaseFilePath+"fillerIcon.png"),this.m_rehearsalRealtimeLabelSpan.innerText=h.RehearsalActorSettings.RehearsalOnboardingLabel,this.displayActiveRehearsalTracker(this.m_rehearsalIconWithMessageDiv,h.RehearsalActorSettings.OnboardingFeatureName,!0),this.fireAriaAlert(this.m_rehearsalIconWithMessageDiv))},e.prototype.makeCountdownUXAdjustments=function(){this.m_rehearsalMaximizedHeight+=5,this.m_rehearsalMinimizedHeight+=5,this.m_rehearsalInteractivePanelDiv&&(this.m_rehearsalInteractivePanelDiv.style.bottom=h.RehearsalActorSettings.RehearsalDashboardPadding+"px");var e=this.generateSlideshowProgressBar();if(this.m_rehearsalActorContainerDiv&&(this.m_rehearsalActorContainerDiv.appendChild(e),this.m_rehearsalSlideProgressBarDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-slideshowProgressBar"),this.m_rehearsalSlideProgressBarParentDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-slideshowProgressBarParent"),this.m_rehearsalInteractivePanelDiv)){var t=this.generateNotificationToggle(this.m_customInteractiveButtons);this.m_rehearsalInteractivePanelDiv.appendChild(t),this.m_rehearsalNotificationButton=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-notificationButton"),this.m_rehearsalNotificationButtonImage=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-notificationButtonImage"),this.m_rehearsalNotificationsEnabledButtonIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-notificationsEnabledButtonIcon"),this.m_rehearsalNotificationsDisabledButtonIcon=this.m_rehearsalActorContainerDiv.querySelector("#ppt-Rehearsal-notificationsDisabledButtonIcon")}},e.prototype.createRehearsalDashboard=function(){if(this.m_rehearsalActorContainerDiv)return a.sendTraceTag(593794512,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::CreateRehearsalDashboard already created."),this.m_rehearsalActorContainerDiv;var e=Date.now(),t=this.m_document.createElement("div");t.id="ppt-RehearsalActorDiv-audioContainer";var n=this.m_document.createElement("div");n.id="ppt-RehearsalDiv-container";var r=this.generateRehearsalTopBar();n.appendChild(r);var i=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.FontIconWithMessage),o=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.DetectedValueWithMessage),s=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.GaugeWithMessage),c=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.SingleMessage),m=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.IconWithMessage),d=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.TemperaturePillWithMessage),p=this.generateRehearsalTrackerDiv(h.RehearsalTemplate.Pronunciation);n.appendChild(i),n.appendChild(o),n.appendChild(s),n.appendChild(c),n.appendChild(m),n.appendChild(d),n.appendChild(p);var f=this.generateRehearsalInteractivePanel();return t.appendChild(n),t.appendChild(f),this.m_coachDashboardCreationTime=Date.now()-e,t.addEventListener("contextmenu",this.disableContextMenu),t},e.prototype.startRealTimeTrackers=function(e,t){null!=this.m_rehearsalActorContainerDiv&&null!=this.m_rehearsalInteractivePanelDiv&&null!=this.m_rehearsalRealtimeLabelSpan&&null!=this.m_rehearsalTopBarDiv&&(this.m_rehearsalInteractivePanelDiv.style.display="flex",this.m_rehearsalActorContainerDiv.style.transition=h.RehearsalActorSettings.RehearsalDashboardMinimizeTransition,!e&&t?this.showOnboardingExperience():d.shouldShowPlaceHolderText(this.m_coachActorConfig.clientType)?this.showPlaceHolderMessage(h.RehearsalActorSettings.ListeningText):this.m_rehearsalActorContainerDiv.style.height=this.m_rehearsalMinimizedHeight+"px",this.m_rehearsalState=o.Started,this.addTooltips())},e.formatTimerNumber=function(e){return e<10?"0"+e:e},e.prototype.disableContextMenu=function(e){return e.preventDefault(),!1},e.prototype.showMessage=function(e,t,n){return this.generateRealtimeNotification(e,t),!0},e.prototype.shouldRefreshActiveRehearsalTracker=function(){return d.shouldShowPlaceHolderText(this.m_coachActorConfig.clientType)?this.m_isShowingPlaceHolderText:this.fRehearsalDashboardIsMinimized()},e.prototype.displayActiveRehearsalTracker=function(e,t,n,r){if(null!==this.m_rehearsalActorContainerDiv){var i=null==this.m_currentlyShownFeatureName||this.m_currentlyShownFeatureName!==t;null!=this.m_rehearsalActiveTrackerDiv&&(i&&(this.m_rehearsalActiveTrackerDiv.removeAttribute("aria-live"),this.m_rehearsalActiveTrackerDiv.removeAttribute("aria-role"),this.m_rehearsalActiveTrackerDiv.removeAttribute("role")),this.m_rehearsalActiveTrackerDiv.style.display="none"),this.m_rehearsalActiveTrackerDiv=e,this.m_rehearsalActorContainerDiv.style.transition=h.RehearsalActorSettings.RehearsalDashboardMaximizeTransition,this.m_rehearsalActorContainerDiv.style.height=this.m_rehearsalMaximizedHeight+"px",this.shouldRefreshActiveRehearsalTracker()?(this.m_timerForShowActiveRehearsalTracker&&clearTimeout(this.m_timerForShowActiveRehearsalTracker),this.m_timerForShowActiveRehearsalTracker=setTimeout(this.showActiveRehearsalTracker.bind(this),h.RehearsalActorSettings.RehearsalDashboardResizingWaitTimeInMS),r||this.playRehearsalAlertSound()):null!=this.m_rehearsalTopBarDiv&&null!=this.m_rehearsalActiveTrackerDiv&&null==this.m_timerForShowActiveRehearsalTracker&&(this.m_rehearsalTopBarDiv.style.display="block",this.m_rehearsalActiveTrackerDiv.style.display="block"),this.m_isShowingPlaceHolderText=r||!1,n?this.m_timerForClearingRehearsalDashboard&&clearTimeout(this.m_timerForClearingRehearsalDashboard):(this.restartTimerForClearingRehearsalDashboard(),i&&null!=this.m_rehearsalActiveTrackerDiv&&this.fireAriaAlert(this.m_rehearsalActiveTrackerDiv)),this.m_currentlyShownFeatureName=t}},e.prototype.showDetectedValueWithMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&null!=this.m_rehearsalDetectedValueWithMessageDiv&&null!=this.m_rehearsalDetectedValueWithMessageValueSpan&&null!=this.m_rehearsalDetectedValueWithMessageMessageSpan&&null!=this.m_rehearsalRealtimeLabelSpan){var r=String(n.get(h.RehearsalActorSettings.MessageKey)),i='"'+t+'"';p.setInnerHtml(this.m_rehearsalDetectedValueWithMessageValueSpan,i),p.setInnerHtml(this.m_rehearsalDetectedValueWithMessageMessageSpan,r);var a=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=a,this.displayActiveRehearsalTracker(this.m_rehearsalDetectedValueWithMessageDiv,e)}},e.prototype.showMessageWithMispronouncedWord=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&null!=this.m_rehearsalPronunciationDiv&&null!=this.m_rehearsalPronunciationMessageSpan&&null!=this.m_rehearsalPronunciationValueSpan&&null!=this.m_rehearsalRealtimeLabelSpan&&null!=this.m_rehearsalPronunciationPhonemeSpan&&null!=this.m_rehearsalPronunciationAudioIconSpan&&null!=this.m_rehearsalPronunciationPhonemeAudioIconDiv&&null!=this.m_coachActorConfig.speechFDBase){var r=JSON.parse(n.get("MispronouncedWordsKey"));if(r.length>0){for(var i=[],a=0;a<r[0].Phonemes.length;a+=1)i.push(r[0].Phonemes[a.toString()].Phoneme);var o=r[0].Syllables,s=String(n.get(h.RehearsalActorSettings.MessageKey)),c='"'+r[0].Word+'"';p.setInnerHtml(this.m_rehearsalPronunciationMessageSpan,s),p.setInnerHtml(this.m_rehearsalPronunciationValueSpan,c);var l=(null==o?void 0:o.length)>0?o:i.join(".");p.setInnerHtml(this.m_rehearsalPronunciationPhonemeSpan,l);var u=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=u,this.displayActiveRehearsalTracker(this.m_rehearsalPronunciationDiv,e)}}},e.prototype.showGaugeWithMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&n.has(h.RehearsalActorSettings.GaugeRotationKey)&&n.has(h.RehearsalActorSettings.FEnsureDisplayGaugeKey)&&null!=this.m_rehearsalGaugeWithMessageLabel&&null!=this.m_rehearsalGaugeWithMessageTicker&&null!=this.m_rehearsalGaugeWithMessageDiv&&null!=this.m_rehearsalRealtimeLabelSpan){var r=Number(n.get(h.RehearsalActorSettings.GaugeRotationKey));if(r>=0&&r<=1){var i=String(n.get(h.RehearsalActorSettings.MessageKey)),a=180*r-90;if(this.m_rehearsalGaugeWithMessageTicker.style.transform="rotate('"+String(a)+"'deg)'",this.m_rehearsalGaugeWithMessageLabel.innerText=i,"true"===String(n.get(h.RehearsalActorSettings.FEnsureDisplayGaugeKey)).toLowerCase()){var o=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=o,this.displayActiveRehearsalTracker(this.m_rehearsalGaugeWithMessageDiv,e)}}}},e.prototype.showSingleMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&null!=this.m_rehearsalSingleMessageDiv&&null!=this.m_rehearsalSingleMessageSpan&&null!=this.m_rehearsalRealtimeLabelSpan){var r=String(n.get(h.RehearsalActorSettings.MessageKey));p.setInnerHtml(this.m_rehearsalSingleMessageSpan,r);var i=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=i,this.displayActiveRehearsalTracker(this.m_rehearsalSingleMessageDiv,e)}},e.prototype.getLocalIconPathFromTemplate=function(e){if(e.has(h.RehearsalActorSettings.ImageFilenameKey)&&this.m_rehearsalIconWithMessageIcon){var t=String(e.get(h.RehearsalActorSettings.ImageFilenameKey)),n=f(t).name;switch(n){case"fillerIcon":return this.m_coachActorConfig.imagesBaseFilePath+"fillerIcon.png";case"monotoneIcon":return this.m_coachActorConfig.imagesBaseFilePath+"monotoneIcon.png";case"livelyIcon":return this.m_coachActorConfig.imagesBaseFilePath+"livelyIcon.png";case"positivityIcon":return this.m_coachActorConfig.imagesBaseFilePath+"positivityIcon.png";default:a.sendTraceTag(593794513,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::getLocalIconPathFromTemplate Unknown image filename: "+n+"; Defaulting to fillerIcon")}}return this.m_coachActorConfig.imagesBaseFilePath+"fillerIcon.png"},e.prototype.getSVGFromTemplate=function(e){if(e.has(h.RehearsalActorSettings.ImageFilenameKey)&&this.m_rehearsalIconWithMessageSVGContainer){var t=String(e.get(h.RehearsalActorSettings.ImageFilenameKey)),n=f(t).name;return this.m_svgGenerator.getSVGForCritique(n)}return this.m_svgGenerator.getSVGForCritique("fillerIcon")},e.prototype.getFontIconFromFeatureName=function(e){switch(e){case l.CoachFeatures.Gaze:return h.RehearsalFontIconValue.Gaze;case l.CoachFeatures.Occlusion:return h.RehearsalFontIconValue.Occlusion;default:return a.sendTraceTag(591736989,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::getFontIconFromName Unknown icon name: "+e+"; Returning empty string"),""}},e.prototype.showFontIconWithMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&null!=this.m_rehearsalFontIconWithMessageDiv&&null!=this.m_rehearsalFontIconWithMessageMessageSpan&&null!=this.m_rehearsalFontIconWithMessageIcon&&null!=this.m_rehearsalRealtimeLabelSpan){var r=String(n.get(h.RehearsalActorSettings.MessageKey));p.setInnerHtml(this.m_rehearsalFontIconWithMessageMessageSpan,r),this.m_rehearsalFontIconWithMessageIcon.className=this.getFontIconFromFeatureName(e);var i=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=i,this.displayActiveRehearsalTracker(this.m_rehearsalFontIconWithMessageDiv,e)}},e.prototype.showIconWithMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&null!=this.m_rehearsalIconWithMessageDiv&&null!=this.m_rehearsalIconWithMessageMessageSpan&&null!=this.m_rehearsalRealtimeLabelSpan&&(null!=this.m_rehearsalIconWithMessageIcon||null!=this.m_rehearsalIconWithMessageSVGContainer)){var r=String(n.get(h.RehearsalActorSettings.MessageKey));p.setInnerHtml(this.m_rehearsalIconWithMessageMessageSpan,r),this.m_coachActorConfig.fUseSVGResources&&null!=this.m_rehearsalIconWithMessageSVGContainer?(this.m_rehearsalIconWithMessageSVGContainer.textContent="",this.m_rehearsalIconWithMessageSVGContainer.appendChild(this.getSVGFromTemplate(n))):null!=this.m_rehearsalIconWithMessageIcon&&(n.has(h.RehearsalActorSettings.ImageUrlKey)?this.m_rehearsalIconWithMessageIcon.src=String(n.get(h.RehearsalActorSettings.ImageUrlKey)):this.m_rehearsalIconWithMessageIcon.src=this.getLocalIconPathFromTemplate(n));var i=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=i,this.displayActiveRehearsalTracker(this.m_rehearsalIconWithMessageDiv,e)}},e.prototype.showTemperaturePillWithMessage=function(e,t,n){if(null!=t&&t.length>0&&n.has(h.RehearsalActorSettings.MessageKey)&&n.has(h.RehearsalActorSettings.TemperatureCodeKey)&&n.has(h.RehearsalActorSettings.TemperatureColdLabelKey)&&n.has(h.RehearsalActorSettings.TemperatureHotLabelKey)&&n.has(h.RehearsalActorSettings.FEnsureDisplayGaugeKey)&&null!=this.m_rehearsalTemperaturePillWithMessageDiv&&null!=this.m_rehearsalTemperaturePillWithMessageMessageSpan&&null!=this.m_rehearsalTemperaturePillWithMessageColdLabel&&null!=this.m_rehearsalTemperaturePillWithMessageHotLabel&&null!=this.m_rehearsalRealtimeLabelSpan&&(null!=this.m_rehearsalTemperaturePillWithMessageIcon||null!=this.m_rehearsalTemperaturePillWithMessageSVGContainer)){var r=Number(n.get(h.RehearsalActorSettings.TemperatureCodeKey)),i=String(n.get(h.RehearsalActorSettings.TemperatureColdLabelKey)),o=String(n.get(h.RehearsalActorSettings.TemperatureHotLabelKey)),s=String(n.get(h.RehearsalActorSettings.MessageKey));switch(this.m_rehearsalTemperaturePillWithMessageColdLabel.innerText=i,this.m_rehearsalTemperaturePillWithMessageHotLabel.innerText=o,this.m_rehearsalTemperaturePillWithMessageMessageSpan.innerText=s,r){case h.RehearsalActorSettings.ColdTemperatureCode:this.m_coachActorConfig.fUseSVGResources&&this.m_rehearsalTemperaturePillWithMessageSVGContainer?(this.m_rehearsalTemperaturePillWithMessageSVGContainer.textContent="",this.m_rehearsalTemperaturePillWithMessageSVGContainer.appendChild(this.m_svgGenerator.getSVGForCritique("temperaturePill_Cold"))):null!=this.m_rehearsalTemperaturePillWithMessageIcon&&(this.m_rehearsalTemperaturePillWithMessageIcon.src=this.m_coachActorConfig.imagesBaseFilePath+"temperaturePill_Cold.png");break;case h.RehearsalActorSettings.JustRightTemperatureCode:this.m_coachActorConfig.fUseSVGResources&&this.m_rehearsalTemperaturePillWithMessageSVGContainer?(this.m_rehearsalTemperaturePillWithMessageSVGContainer.textContent="",this.m_rehearsalTemperaturePillWithMessageSVGContainer.appendChild(this.m_svgGenerator.getSVGForCritique("temperaturePill_JustRight"))):null!=this.m_rehearsalTemperaturePillWithMessageIcon&&(this.m_rehearsalTemperaturePillWithMessageIcon.src=this.m_coachActorConfig.imagesBaseFilePath+"temperaturePill_JustRight.png");break;case h.RehearsalActorSettings.HotTemperatureCode:this.m_coachActorConfig.fUseSVGResources&&this.m_rehearsalTemperaturePillWithMessageSVGContainer?(this.m_rehearsalTemperaturePillWithMessageSVGContainer.textContent="",this.m_rehearsalTemperaturePillWithMessageSVGContainer.appendChild(this.m_svgGenerator.getSVGForCritique("temperaturePill_Hot"))):null!=this.m_rehearsalTemperaturePillWithMessageIcon&&(this.m_rehearsalTemperaturePillWithMessageIcon.src=this.m_coachActorConfig.imagesBaseFilePath+"temperaturePill_Hot.png");break;default:return void a.sendTraceTag(593794514,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::ShowTemperaturePillWithMessage Unhandled code: "+r)}if("true"===String(n.get(h.RehearsalActorSettings.FEnsureDisplayGaugeKey)).toLowerCase()){var c=n.has(h.RehearsalActorSettings.RealtimeLabelKey)?n.get(h.RehearsalActorSettings.RealtimeLabelKey):h.RehearsalActorSettings.GenericRealtimeLabel;this.m_rehearsalRealtimeLabelSpan.innerText=c,this.displayActiveRehearsalTracker(this.m_rehearsalTemperaturePillWithMessageDiv,e)}}},e.prototype.generateRealtimeNotification=function(e,t){var n=t.get("featureTemplate"),r=t.get("featureValue"),i=t.get("templateInfo");switch(n.toLowerCase()){case h.RehearsalTemplateName.DetectedValueWithMessage:this.showDetectedValueWithMessage(e,r,i);break;case h.RehearsalTemplateName.GaugeWithMessage:this.showGaugeWithMessage(e,r,i);break;case h.RehearsalTemplateName.SingleMessage:this.showSingleMessage(e,r,i);break;case h.RehearsalTemplateName.IconWithMessage:this.showIconWithMessage(e,r,i);break;case h.RehearsalTemplateName.TemperaturePillWithMessage:this.showTemperaturePillWithMessage(e,r,i);break;case h.RehearsalTemplateName.FontIconWithMessage:this.showFontIconWithMessage(e,r,i);break;case h.RehearsalTemplateName.Pronunciation:this.showMessageWithMispronouncedWord(e,r,i);break;default:return void a.sendTraceTag(593794515,l.LogCategory.PptSession,u.TraceLevel.Error,"Rehearsal::GenerateRealtimeNotification Unhandled Template: "+n)}},e.prototype.fireTrackerAlert=function(){this.m_rehearsalActiveTrackerDiv&&this.fireAriaAlert(this.m_rehearsalActiveTrackerDiv)},e.prototype.fireAriaAlert=function(e,t){void 0===t&&(t="assertive");var n=e.style.display;e.style.display="none",e.removeAttribute("role"),e.removeAttribute("aria-role"),e.removeAttribute("aria-live"),e.setAttribute("role","alert"),e.setAttribute("aria-role","alert"),e.setAttribute("aria-live",t),e.style.display=n},e.prototype.showPlaceHolderMessage=function(e){this.m_rehearsalSingleMessageDiv&&this.m_rehearsalSingleMessageSpan&&this.m_rehearsalRealtimeLabelSpan&&(p.setInnerHtml(this.m_rehearsalSingleMessageSpan,e),this.m_rehearsalRealtimeLabelSpan.innerText=h.RehearsalActorSettings.CoachTitleText,this.displayActiveRehearsalTracker(this.m_rehearsalSingleMessageDiv,"",!0,!0))},e.prototype.showStatusNotification=function(e,t){t?null==this.m_rehearsalIconWithMessageDiv||null==this.m_rehearsalIconWithMessageMessageSpan||null==this.m_rehearsalRealtimeLabelSpan||null==this.m_rehearsalIconWithMessageIcon&&null==this.m_rehearsalIconWithMessageSVGContainer||(p.setInnerHtml(this.m_rehearsalIconWithMessageMessageSpan,e),this.m_coachActorConfig.fUseSVGResources&&null!=this.m_rehearsalIconWithMessageSVGContainer?(this.m_rehearsalIconWithMessageSVGContainer.textContent="",this.m_rehearsalIconWithMessageSVGContainer.appendChild(this.m_svgGenerator.getSVGForCritique(t))):null!=this.m_rehearsalIconWithMessageIcon&&(this.m_rehearsalIconWithMessageIcon.src=this.m_coachActorConfig.imagesBaseFilePath+t),this.m_rehearsalRealtimeLabelSpan.innerText=h.RehearsalActorSettings.CoachTitleText,this.displayActiveRehearsalTracker(this.m_rehearsalIconWithMessageDiv,"",!0,!0)):this.m_rehearsalSingleMessageDiv&&this.m_rehearsalSingleMessageSpan&&this.m_rehearsalRealtimeLabelSpan&&(p.setInnerHtml(this.m_rehearsalSingleMessageSpan,e),this.m_rehearsalRealtimeLabelSpan.innerText=h.RehearsalActorSettings.CoachTitleText,this.displayActiveRehearsalTracker(this.m_rehearsalSingleMessageDiv,"",!0,!0))},e}();t.CoachAudioActor=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RehearsalSVGGenerator=void 0;var r,i=n(26),a=n(60),o=n(65),s=n(57),c=function(){function e(e,t){this.m_document=e,r=t}return e.prototype.getSVGForCritique=function(e){switch(e){case"welcomeImage":return this.generateWelcomeImage();case"fillerIcon":return this.generateFillerImage();case"livelyIcon":return this.generateLivelyImage();case"monotoneIcon":return this.generateMonotoneImage();case"temperaturePill_Hot":return this.generateTemperaturePillHotImage();case"temperaturePill_JustRight":return this.generateTemperaturePillJustRightImage();case"temperaturePill_Cold":return this.generateTemperaturePillColdImage();case"positivityIcon":return this.generatePositiveImage();case"errorIcon":return this.generateErrorImage();case"warningIcon":return this.generateWarningImage();default:return r.sendTraceTag(559772296,o.LogCategory.PptSession,a.TraceLevel.Error,"Rehearsal::getSVGForCritiques Unknown image name: "+e+"; Defaulting to fillerIcon"),this.generateFillerImage()}},e.prototype.getSVGForButtons=function(e){switch(e){case"pauseButtonIcon":return this.generatePauseButtonIcon();case"listeningButtonIcon":return this.generateListeningButtonIcon();case"playButtonIcon":return this.generatePlayButtonIcon();case"notificationsEnabledButtonIcon":return this.generateNotificationsEnabledButtonIcon();case"notificationsDisabledButtonIcon":return this.generateNotificationsDisabledButtonIcon();default:return r.sendTraceTag(559740807,o.LogCategory.PptSession,a.TraceLevel.Error,"Rehearsal::getSVGForButtons Unknown icon name: "+e+"; Defaulting to empty SVG"),this.m_document.createElement("svg")}},e.prototype.generateWelcomeImage=function(){var e=this.m_document.createElement("div"),t='\n        <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="welcomeImageClass" viewBox="0 0 175 81">\n          <title>'+i.RehearsalActorSettings.RehearsalWelcomeImageText+'</title>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M23.0457 22.1431C18.6159 22.2909 16.4614 27.3431 17.1149 32.2474C17.6718 36.4864 21.9322 37.5954 22.0532 41.0457C22.1743 44.6684 17.696 47.9954 19.7535 51.7906C21.8111 55.5861 24.9581 54.7727 23.8204 60.786H29.4364C29.4364 60.786 27.9839 57.8782 29.1943 55.5121C30.4047 53.1462 33.6486 48.3899 30.9131 45.4816C28.1778 42.5735 28.8798 39.0987 29.6542 37.6694C30.4289 36.24 31.9541 33.3317 31.2036 28.9698C30.4289 24.6074 25.9022 22.0445 23.0457 22.1431Z" fill="url(#paint0_linear)"/>\n          <path class="fillEvenoddClass highlightFillClass" d="M23.8627 25.5192C24.1282 25.4434 24.4049 25.5971 24.4808 25.8627C25.3724 28.984 26.0323 34.3388 26.5165 40.097C27.002 45.8698 27.3141 52.0941 27.4996 56.981C27.5101 57.257 27.2949 57.4892 27.019 57.4996C26.743 57.5101 26.5108 57.2949 26.5004 57.019C26.3151 52.1401 26.0037 45.9325 25.5201 40.1808C25.0352 34.4145 24.3805 29.1522 23.5192 26.1373C23.4434 25.8718 23.5971 25.5951 23.8627 25.5192Z" fill="white"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M37.8819 39.1357C37.3432 42.091 33.3746 42.8241 33.2278 45.2238C33.0806 47.757 37.2206 50.1122 35.2853 52.7341C33.3501 55.356 30.4595 54.7784 31.4394 59L26.2463 58.9555C26.2463 58.9555 27.618 56.9335 26.5158 55.2671C25.4133 53.6007 22.4494 50.2454 25.0214 48.2459C27.5935 46.2458 26.9567 43.8019 26.2463 42.8019C25.5359 41.7798 24.1396 39.7357 24.8988 36.7137C25.6095 33.6696 29.8227 31.9143 32.4683 32.0032C36.5592 32.1365 38.519 35.7139 37.8819 39.1357Z" fill="#FDC9B5"/>\n          <path class="fillEvenoddClass highlightFillClass" d="M32.1625 37.5271C32.4236 37.6169 32.5626 37.9013 32.4729 38.1625C32.1068 39.2278 31.7948 40.93 31.5356 42.9185C31.2778 44.8962 31.0766 47.1213 30.9229 49.2123C30.7693 51.3024 30.6635 53.2539 30.596 54.6832C30.5623 55.3977 30.5382 55.9814 30.5226 56.3862C30.5148 56.5886 30.509 56.7463 30.5053 56.8533L30.5011 56.9749L30.4998 57.0154C30.4998 57.0155 30.4997 57.016 30 57C29.5003 56.984 29.5003 56.984 29.5003 56.9838L29.5017 56.9414L29.5059 56.8182C29.5097 56.7101 29.5155 56.5512 29.5233 56.3476C29.5391 55.9402 29.5633 55.3537 29.5972 54.6361C29.6648 53.201 29.7712 51.2403 29.9256 49.139C30.08 47.0385 30.2828 44.7929 30.544 42.7892C30.8038 40.7962 31.1255 39.0064 31.5271 37.8375C31.6169 37.5764 31.9013 37.4374 32.1625 37.5271ZM29.984 57.4998C29.708 57.4909 29.4914 57.2598 29.5003 56.9838L30 57L30.4998 57.0154C30.4909 57.2914 30.26 57.5086 29.984 57.4998Z" fill="white"/>\n          <path class="planterPathClass highlightOutlineClass" d="M21.9007 57C21.2882 57 20.8508 57.6794 21.0478 58.3586L23.6065 67.0879C23.9345 68.2453 24.8749 69 25.9247 69H31.0641C32.1138 69 33.0543 68.2201 33.3822 67.0879L35.941 58.3586C36.1597 57.7046 35.7442 57 35.1318 57H21.9007Z" fill="#EFEFEF"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M129 65H52V18.3236C52 17.0407 53.0431 16 54.3305 16H126.67C127.956 16 129 17.0407 129 18.3236V65Z" fill="url(#paint1_linear)"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M124 60H82.3226L94.7254 20H123C123.552 20 124 20.4477 124 21V60Z" fill="#E86E58"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M89.643 60H56.0002V21C56.0002 20.4477 56.4479 20 57.0002 20H97.6776L89.643 60Z" fill="#FDC9B5"/>\n          <path class="highlightFillAndOutlineClass" d="M78 28H61V30H78V28Z" fill="white" fill-opacity="0.6"/>\n          <path class="highlightFillAndOutlineClass" d="M81 36H61V38H81V36Z" fill="white" fill-opacity="0.6"/>\n          <path class="highlightFillAndOutlineClass" d="M84 44H61V46H84V44Z" fill="white" fill-opacity="0.6"/>\n          <path class="highlightFillAndOutlineClass" d="M80 51H61V53H80V51Z" fill="white" fill-opacity="0.6"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M129.798 69H47.2021C45.9863 69 45 67.9976 45 66.761V65H132V66.761C132 67.9976 131.014 69 129.798 69Z" fill="white"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M81 23C81 23.5523 81.4477 24 82 24H117C117.552 24 118 23.5523 118 23V1C118 0.447716 117.552 0 117 0H82C81.4477 0 81 0.447715 81 1V23Z" fill="white"/>\n          <path class="fillEvenoddClass inverseHighlightFillClass" d="M87 19C87 11.3053 93.0075 5 100.5 5C107.993 5 114 11.3054 114 19C114 19.5523 113.552 20 113 20C112.448 20 112 19.5523 112 19C112 12.3352 106.815 7 100.5 7C94.1853 7 89 12.3353 89 19C89 19.5523 88.5523 20 88 20C87.4477 20 87 19.5523 87 19Z" fill="#EDEBE9"/>\n          <path class="fillEvenoddClass inverseHighlightFillClass" d="M93.4598 7.00302C95.4285 5.73941 97.8654 5 100.49 5C103.124 5 105.569 5.74474 107.542 7.01673C108.006 7.31604 108.14 7.93494 107.84 8.39909C107.541 8.86323 106.922 8.99686 106.458 8.69755C104.817 7.63902 102.75 7 100.49 7C98.239 7 96.1787 7.63441 94.5402 8.68614C94.0754 8.98446 93.4568 8.84953 93.1584 8.38475C92.8601 7.91997 92.9951 7.30135 93.4598 7.00302Z" fill="#78D296"/>\n          <path class="fillEvenoddClass inverseHighlightFillClass" d="M101.165 18.1401L103.171 9.93635C103.228 9.70418 102.903 9.58603 102.797 9.80035L99.0601 17.3738L101.165 18.1401Z" fill="#78D296"/>\n          <path class="fillEvenoddClass inverseHighlightFillClass" d="M99.7252 18.8225C100.307 19.0341 100.952 18.7286 101.166 18.14C101.38 17.5515 101.082 16.9029 100.501 16.6913C99.9196 16.4796 99.2747 16.7852 99.0605 17.3737C98.8463 17.9623 99.1438 18.6109 99.7252 18.8225Z" fill="#78D296"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M108 45C108 45.5523 108.448 46 109 46H141C141.552 46 142 45.5523 142 45V33C142 32.4477 141.552 32 141 32H109C108.448 32 108 32.4477 108 33V45Z" fill="white"/>\n          <path class="fillEvenoddClass inverseHighlightFillClass" d="M116.356 34.5864L112.828 38.8048C112.769 38.8831 112.815 39.0173 112.912 39.047L114.744 39.7688C114.829 39.7949 114.879 39.9045 114.843 39.9865L113.423 43.2224C113.36 43.3657 113.542 43.5224 113.637 43.4067L117.275 38.9655C117.339 38.8874 117.291 38.7472 117.19 38.7189L115.217 38.1649C115.13 38.1404 115.079 38.0277 115.117 37.9445L116.572 34.7691C116.639 34.6237 116.449 34.4634 116.356 34.5864Z" fill="#78D296"/>\n          <path class="inverseHighlightFillClass" d="M137.5 36H120.5C120.224 36 120 36.2239 120 36.5C120 36.7761 120.224 37 120.5 37H137.5C137.776 37 138 36.7761 138 36.5C138 36.2239 137.776 36 137.5 36Z" fill="#E1DFDD"/>\n          <path class="inverseHighlightFillClass" d="M132.5 41H120.5C120.224 41 120 41.2239 120 41.5C120 41.7761 120.224 42 120.5 42H132.5C132.776 42 133 41.7761 133 41.5C133 41.2239 132.776 41 132.5 41Z" fill="#E1DFDD"/>\n          <path class="fillEvenoddClass highlightOutlineClass" d="M158.111 60C158.111 56.9741 160.537 54.5 163.556 54.5C166.574 54.5 169 56.9742 169 60C169 63.0258 166.574 65.5 163.556 65.5C160.537 65.5 158.111 63.0259 158.111 60ZM163.556 56.5C161.665 56.5 160.111 58.0553 160.111 60C160.111 61.9447 161.665 63.5 163.556 63.5C165.446 63.5 167 61.9448 167 60C167 58.0552 165.446 56.5 163.556 56.5Z" fill="#EFEFEF"/>\n          <path class="highlightOutlineClass" d="M162.556 51H149C148.448 51 148 51.4477 148 52V68C148 68.5523 148.448 69 149 69H162.556C163.108 69 163.556 68.5523 163.556 68V52C163.556 51.4477 163.108 51 162.556 51Z" fill="#EFEFEF"/>\n          <path class="highlightOutlineClass" d="M148 53.25H159.111V65.625H148V53.25Z" fill="#ED9583"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M156.567 35C156.567 35 152.466 39.0545 154.917 42.0161C157.369 44.9777 154.917 48 154.917 48C154.917 48 159.541 44.5762 157.229 42.0161C154.917 39.456 156.567 35 156.567 35Z" fill="white"/>\n          <path class="highlightOutlineClass" d="M36 73C36 71.8954 35.1046 71 34 71C32.8954 71 32 71.8954 32 73V79C32 80.1046 32.8954 81 34 81C35.1046 81 36 80.1046 36 79V73Z" fill="#D8D8D8"/>\n          <path class="highlightOutlineClass" d="M143 73C143 71.8954 142.105 71 141 71C139.895 71 139 71.8954 139 73V79C139 80.1046 139.895 81 141 81C142.105 81 143 80.1046 143 79V73Z" fill="#D8D8D8"/>\n          <path class="highlightOutlineClass" d="M173 69H2C0.89543 69 0 69.8954 0 71V72C0 73.1046 0.89543 74 2 74H173C174.105 74 175 73.1046 175 72V71C175 69.8954 174.105 69 173 69Z" fill="#9B9B9B"/>\n          <defs>\n            <linearGradient id="paint0_linear" x1="13.4632" y1="42.3782" x2="29.612" y2="45.7785" gradientUnits="userSpaceOnUse">\n            <stop stop-color="#FDC9B5"/>\n            <stop offset="1" stop-color="#ED9583"/>\n            </linearGradient>\n            <linearGradient id="paint1_linear" x1="52" y1="16" x2="52" y2="65" gradientUnits="userSpaceOnUse">\n            <stop stop-color="#F8F8F8"/>\n            <stop offset="1" stop-color="#EFEFEF"/>\n            </linearGradient>\n          </defs>\n        </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateFillerImage=function(){var e=this.m_document.createElement("div"),t='\n        <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="fillerImageClass" viewBox="0 0 56 44" >\n          <path fill="#FDC9B5" class="highlightOutlineClass" d="M55.6482 19.9025C55.6482 26.6569 54.0904 31.2408 48.9966 33.0444C47.9459 33.4162 47.1532 34.4101 46.8857 35.6254L48.5418 43.0436C48.5418 43.0436 41.7151 34.7017 32.6583 36.8272C13.5195 41.3184 -1.46995 31.6201 0.115079 19.9025C1.7773 7.65531 12.5448 0.291382 27.8858 0.291382C43.2184 0.291382 55.6482 7.51803 55.6482 19.9025"/>\n          <path fill="#E86E58" class="fillEvenoddClass highlightFillAndOutlineClass" d="M20.8815 19.6087C20.8815 20.9295 19.8192 22 18.5086 22C17.1981 22 16.1357 20.9295 16.1357 19.6087C16.1357 18.288 17.1981 17.2174 18.5086 17.2174C19.8192 17.2174 20.8815 18.288 20.8815 19.6087"/>\n          <path fill="#E86E58" class="fillEvenoddClass highlightFillAndOutlineClass" d="M30.3727 17.6957C30.3727 19.0165 29.3104 20.0871 27.9998 20.0871C26.6893 20.0871 25.627 19.0165 25.627 17.6957C25.627 16.375 26.6893 15.3044 27.9998 15.3044C29.3104 15.3044 30.3727 16.375 30.3727 17.6957"/>\n          <path fill="#E86E58" class="fillEvenoddClass highlightFillAndOutlineClass" d="M39.8649 19.6087C39.8649 20.9295 38.8026 22 37.492 22C36.1814 22 35.1191 20.9295 35.1191 19.6087C35.1191 18.288 36.1814 17.2174 37.492 17.2174C38.8026 17.2174 39.8649 18.288 39.8649 19.6087"/>\n        </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateLivelyImage=function(){var e=this.m_document.createElement("div"),t='\n        <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="livelyImageClass" viewBox="0 0 70 48">\n          <path class="highlightOutlineClass" stroke="#848484" stroke-linecap="round" d="M1 47.2397H69"/>\n          <path class="highlightOutlineClass" stroke="#848484" stroke-linecap="round" d="M1 37.2397H69"/>\n          <path class="highlightOutlineClass" stroke="#848484" stroke-linecap="round" d="M1 28.2397H69"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" fill="#ED9583" d="M55.7 41.7397C58.2957 41.7397 60.4 39.9488 60.4 37.7397C60.4 35.5305 58.2957 33.7397 55.7 33.7397C53.1043 33.7397 51 35.5305 51 37.7397C51 39.9488 53.1043 41.7397 55.7 41.7397Z"/>\n          <path class="highlightOutlineClass" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round" d="M64.9844 25.7363C64.9844 25.7363 65.155 23.9009 63.4603 22.0038C61.7656 20.1068 60.9152 20.3784 60 17.7397"/>\n          <rect class="highlightFillAndOutlineClass" fill="#ED9583" x="59" y="15.9131" width="1" height="22" rx="0.5"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" fill="#ED9583" d="M11.7 41.7397C14.2957 41.7397 16.4 39.9488 16.4 37.7397C16.4 35.5305 14.2957 33.7397 11.7 33.7397C9.10426 33.7397 7 35.5305 7 37.7397C7 39.9488 9.10426 41.7397 11.7 41.7397Z"/>\n          <path class="highlightOutlineClass" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round" d="M20.9844 25.7363C20.9844 25.7363 21.155 23.9009 19.4603 22.0038C17.7656 20.1068 16.9152 20.3784 16 17.7397"/>\n          <rect class="highlightFillAndOutlineClass" fill="#ED9583"x="15" y="15.9131" width="1" height="22" rx="0.5"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" fill="#ED9583" d="M33.7 36.7397C36.2957 36.7397 38.4 34.9488 38.4 32.7397C38.4 30.5305 36.2957 28.7397 33.7 28.7397C31.1043 28.7397 29 30.5305 29 32.7397C29 34.9488 31.1043 36.7397 33.7 36.7397Z"/>\n          <path class="fillEvenoddClass highlightFillAndOutlineClass" fill="#D8D8D8" d="M42.9844 20.7363C42.9844 20.7363 43.155 18.9009 41.4603 17.0038C39.7656 15.1068 38.9152 15.3784 38 12.7397"/>\n          <path class="highlightOutlineClass" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round" d="M42.9844 20.7363C42.9844 20.7363 43.155 18.9009 41.4603 17.0038C39.7656 15.1068 38.9152 15.3784 38 12.7397"/>\n          <rect class="highlightFillAndOutlineClass" fill="#ED9583" x="37" y="10.9131" width="1" height="22" rx="0.5"/>\n          <path class="highlightOutlineClass" d="M45.0247 13.3793L47.9791 13.9003" stroke="#FED402" stroke-width="1.4" stroke-linecap="round"/>\n          <path class="highlightOutlineClass" d="M28.2833 10.4273L31.2378 10.9483" stroke="#FED402" stroke-width="1.4" stroke-linecap="round"/>\n          <path class="highlightOutlineClass" d="M44.2758 8.13364L46.8739 6.63364" stroke="#FED402" stroke-width="1.4" stroke-linecap="round"/>\n          <path class="highlightOutlineClass" d="M31.8079 3.97716L33.7363 6.27529" stroke="#FED402" stroke-width="1.4" stroke-linecap="round"/>\n          <path class="highlightOutlineClass" d="M39.8675 2.31574L39.3465 5.27016" stroke="#FED402" stroke-width="1.4" stroke-linecap="round"/> \n        </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateMonotoneImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="monotoneImageClass" viewBox="0 0 70 48">\n        <path class="highlightOutlineClass" d="M1 47.5H69" stroke="#848484" stroke-linecap="round"/>\n        <path class="highlightOutlineClass" d="M1 37.5H69" stroke="#848484" stroke-linecap="round"/>\n        <path class="highlightOutlineClass" d="M1 28.5H69" stroke="#848484" stroke-linecap="round"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M55.7 42C58.2957 42 60.4 40.2091 60.4 38C60.4 35.7909 58.2957 34 55.7 34C53.1043 34 51 35.7909 51 38C51 40.2091 53.1043 42 55.7 42Z" fill="#ED9583"/>\n        <path class="highlightOutlineClass" d="M64.9844 25.9966C64.9844 25.9966 65.155 24.1612 63.4603 22.2641C61.7656 20.3671 60.9152 20.6388 60 18" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round"/>\n        <rect class="highlightFillAndOutlineClass" x="59" y="16" width="1" height="22" rx="0.5" fill="#ED9583"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M33.7 42C36.2957 42 38.4 40.2091 38.4 38C38.4 35.7909 36.2957 34 33.7 34C31.1043 34 29 35.7909 29 38C29 40.2091 31.1043 42 33.7 42Z" fill="#ED9583"/>\n        <path class="highlightOutlineClass" d="M42.9844 25.9966C42.9844 25.9966 43.155 24.1612 41.4603 22.2641C39.7656 20.3671 38.9152 20.6388 38 18" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round"/>\n        <rect class="highlightFillAndOutlineClass" x="37" y="16" width="1" height="22" rx="0.5" fill="#ED9583"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M11.7 42C14.2957 42 16.4 40.2091 16.4 38C16.4 35.7909 14.2957 34 11.7 34C9.10426 34 7 35.7909 7 38C7 40.2091 9.10426 42 11.7 42Z" fill="#ED9583"/>\n        <path class="highlightOutlineClass" d="M20.9844 25.9966C20.9844 25.9966 21.155 24.1612 19.4603 22.2641C17.7656 20.3671 16.9152 20.6388 16 18" stroke="#ED9583" stroke-width="1.4" stroke-linecap="round"/>\n        <rect class="highlightFillAndOutlineClass" x="15" y="16" width="1" height="22" rx="0.5" fill="#ED9583"/>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateTemperaturePillHotImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="temperaturePillHotImageClass" viewBox="0 0 154 10">\n        <path class="highlightFillAndOutlineClass" d="M104 0H150C152.209 0 154 1.79086 154 4V4C154 6.20914 152.209 8 150 8H104V0Z" fill="#C9301B" stroke="#C9301B" stroke-width="3"/>\n        <g style="mix-blend-mode:screen" opacity="0.34">\n          <rect class="highlightOutlineClass" x="50" width="50" height="8" fill="#8CBD18"/>\n        </g>\n        <g style="mix-blend-mode:screen" opacity="0.4">\n          <path class="highlightOutlineClass" d="M0 4C0 1.79086 1.79086 0 4 0H50V8H4C1.79086 8 0 6.20914 0 4V4Z" fill="#4F6BED"/>\n        </g>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateTemperaturePillJustRightImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="temperaturePillJustRightImageClass" viewBox="0 0 154 10"> \n        <g style="mix-blend-mode:screen" opacity="0.36">\n          <path class="highlightOutlineClass" d="M108 2H154C156.209 2 158 3.79086 158 6C158 8.20914 156.209 10 154 10H108V2Z" fill="#C9301B"/>\n        </g>\n        <rect class="highlightFillAndOutlineClass" x="54" y="2" width="50" height="8" fill="#8CBD18" stroke="#8CBD18" stroke-width="3"/>\n        <g style="mix-blend-mode:screen" opacity="0.4">\n          <path class="highlightOutlineClass" d="M0 6C0 3.79086 1.79086 2 4 2H50V10H4C1.79086 10 0 8.20914 0 6Z" fill="#4F6BED"/>\n        </g>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateTemperaturePillColdImage=function(){var e=this.m_document.createElement("div"),t=' \n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="temperaturePillColdImageClass" viewBox="0 0 156 10">\n        <g style="mix-blend-mode:screen" opacity="0.36">\n          <path class="highlightOutlineClass" d="M106 0H152C154.209 0 156 1.79086 156 4V4C156 6.20914 154.209 8 152 8H106V0Z" fill="#C9301B"/>\n        </g>\n        <g style="mix-blend-mode:screen" opacity="0.34">\n          <rect class="highlightOutlineClass" x="56" width="50" height="8" fill="#8CBD18"/>\n        </g>\n        <path class="highlightFillAndOutlineClass" d="M2 4C2 1.79086 3.79086 0 6 0H52V8H6C3.79086 8 2 6.20914 2 4V4Z" fill="#4F6BED" stroke="#4F6BED" stroke-width="3"/>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generatePositiveImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="positiveImageClass" viewBox="0 0 50 48">\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M33.7256 39.4384L30.7927 36.8166C30.0168 36.1231 29.9498 34.9319 30.6439 34.1566L35.6162 28.5931C36.3098 27.8178 37.5009 27.7507 38.2768 28.4448L41.2098 31.066C41.9856 31.7595 42.0521 32.9507 41.3586 33.7266L36.3856 39.2895C35.6927 40.0648 34.5009 40.1319 33.7256 39.4384" fill="white"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M30.0202 24.1014C31.0236 21.4528 30.9453 18.8415 29.7838 16.269C28.6133 13.675 26.7015 11.8774 24.0491 10.874C21.4175 9.86305 18.8026 9.9413 16.2057 11.1102C13.6082 12.279 11.8073 14.1882 10.8032 16.8375C9.81996 19.4765 9.91357 22.0933 11.0841 24.6872C12.2456 27.2597 14.1428 29.0518 16.775 30.0642C19.4274 31.0669 22.052 30.9838 24.6489 29.8149C27.2465 28.646 29.0362 26.7418 30.0202 24.1014Z" fill="url(#paint0_radial)"/>\n        <path class="inverseHighlightFillClass" d="M19.8265 11.5068C19.657 11.5131 19.5253 11.6578 19.5315 11.8294V11.8294L19.6942 15.8767L16.2101 16.0123L16.0942 12.7921C16.0874 12.6205 15.9366 12.49 15.7767 12.4928V12.4928C15.6067 12.4985 15.4749 12.6422 15.4806 12.8149V12.8149L15.5954 16.0368L12.3264 16.1628C12.157 16.1691 12.0241 16.3138 12.0309 16.4854V16.4854C12.0365 16.6575 12.1699 16.7886 12.3495 16.784V16.784L15.6196 16.6581L15.7587 20.2021L11.5237 20.3816C11.3542 20.3879 11.2219 20.5332 11.2298 20.7048V20.7048C11.2366 20.8763 11.3728 20.9824 11.549 21.0029V21.0029L15.7817 20.8228L15.9073 24.3257L12.7295 24.4545C12.5595 24.4614 12.4278 24.6062 12.4345 24.7777V24.7777C12.4413 24.9487 12.5758 25.0644 12.7531 25.0758V25.0758L15.9304 24.947L16.0531 28.1194C16.0593 28.2909 16.1899 28.4004 16.3717 28.4175V28.4175C16.5417 28.4106 16.6734 28.2664 16.6667 28.0949V28.0949L16.544 24.9225L20.0286 24.7863L20.1851 28.8529C20.1912 29.0205 20.3275 29.1516 20.4924 29.1516V29.1516H20.5042C20.6737 29.1442 20.8065 29 20.7987 28.8284V28.8284L20.6433 24.7629L24.1155 24.6312L24.2151 27.4748C24.2213 27.6452 24.3694 27.7632 24.5326 27.774V27.774C24.7021 27.7683 24.8349 27.6241 24.8287 27.4525V27.4525L24.7285 24.6079L27.626 24.4979C27.7949 24.4916 27.9266 24.3468 27.921 24.1758V24.1758C27.9142 24.0043 27.796 23.8857 27.6023 23.8766V23.8766L24.706 23.9866L24.5715 20.4569L28.583 20.287C28.7524 20.2796 28.8836 20.1343 28.8763 19.9627V19.9627C28.8695 19.7917 28.731 19.6498 28.5571 19.6652V19.6652L24.5473 19.835L24.406 16.3258L27.3456 16.2112C27.5162 16.205 27.6474 16.0608 27.6412 15.8892V15.8892C27.635 15.7171 27.4903 15.5928 27.3231 15.5905V15.5905L24.3823 15.704L24.2647 12.5458C24.2585 12.3731 24.1346 12.2517 23.946 12.246V12.246C23.7772 12.2523 23.6443 12.3971 23.6511 12.5686V12.5686L23.7687 15.7279L20.3089 15.8533L20.1451 11.8049C20.1389 11.6442 20.0128 11.5045 19.8574 11.5045V11.5045C19.8473 11.5045 19.8372 11.5057 19.8265 11.5068V11.5068ZM20.332 16.4751L23.7924 16.3492L23.9331 19.8595L20.4665 20.0026L20.332 16.4751ZM16.2332 16.6353L19.7184 16.4985L19.8529 20.0277L16.3723 20.1759L16.2332 16.6353ZM20.4896 20.6239L23.9567 20.4814L24.0918 24.01L20.6202 24.1411L20.4896 20.6239ZM16.3954 20.7971L19.876 20.6495L20.006 24.1639L16.5209 24.3007L16.3954 20.7971Z" fill="url(#paint1_linear)"/>\n        <path class="fillEvenoddClass highlightOutlineClass" d="M43.6374 46.7253C44.318 47.3335 44.9439 47.3188 45.5139 46.6812L49.1927 42.5659C49.7633 41.9276 49.708 41.3041 49.0274 40.6959L32.4074 25.8388C31.7268 25.2306 31.1009 25.2447 30.5309 25.8829L26.8521 29.9982C26.2815 30.6365 26.3368 31.26 27.0174 31.8682L43.6374 46.7253Z" fill="#FFD590"/>\n        <path class="fillEvenoddClass highlightOutlineClass" d="M24.9215 31.519L24.8604 31.4637C24.0839 30.7702 24.0174 29.579 24.711 28.8031L29.371 23.5896C30.0651 22.8131 31.2563 22.7467 32.0321 23.4402L32.0939 23.4955C32.8698 24.189 32.9363 25.3802 32.2427 26.1561L27.5821 31.3696C26.8886 32.1455 25.6974 32.2126 24.9215 31.519" fill="#FFE5B9"/>\n        <path class="fillEvenoddClass highlightOutlineClass" d="M30.3339 37.1409C29.4864 36.4009 29.4139 35.1312 30.1709 34.3035L35.5994 28.3723C36.357 27.5446 37.6577 27.4737 38.5045 28.2131L41.7062 31.0091C42.5536 31.7478 42.6262 33.0182 41.8691 33.8452L36.4407 39.7771C35.683 40.6041 34.3823 40.675 33.5355 39.9362L30.3339 37.1409Z" fill="#F7B548"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M11.8855 8.46392C11.8311 8.53818 11.7647 8.60408 11.6866 8.66033C11.2816 8.95337 10.7151 8.86216 10.4226 8.457L7.94672 5.03047C7.65353 4.62489 7.74602 4.05872 8.15047 3.76582C8.55605 3.47262 9.12192 3.56399 9.41496 3.969L11.8909 7.39553C12.1274 7.72373 12.1134 8.15559 11.8855 8.46392" fill="#FFE5B9"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M5.95651 16.4825C5.76384 16.743 5.43815 16.8912 5.09585 16.841L1.62952 16.332C1.13446 16.2594 0.791822 15.7989 0.864966 15.3037C0.937126 14.8093 1.39782 14.4673 1.89273 14.5393L5.35864 15.049C5.85386 15.1222 6.19562 15.5817 6.12305 16.0768C6.10106 16.2288 6.04189 16.3671 5.95651 16.4825" fill="#FFE5B9"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M7.45479 26.1596C7.37875 26.2622 7.27992 26.3502 7.15988 26.4158L4.05707 28.109C3.61706 28.3487 3.06714 28.1872 2.82759 27.7478C2.5882 27.3089 2.75017 26.7588 3.18904 26.5195L6.29242 24.8262C6.73172 24.5861 7.28164 24.7475 7.52119 25.1869C7.69564 25.5062 7.65764 25.8848 7.45479 26.1596" fill="#FFE5B9"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M22.5047 5.81814C22.3079 6.08586 21.9694 6.23381 21.6192 6.17235C21.1266 6.08632 20.7973 5.61671 20.8838 5.12341L21.5037 1.58901C21.5899 1.097 22.0593 0.767197 22.5521 0.853796C23.0448 0.940395 23.374 1.41001 23.2878 1.90202L22.668 5.43642C22.643 5.57953 22.5856 5.70877 22.5047 5.81814" fill="#FFE5B9"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M33.4566 7.5158C33.4247 7.56029 33.3876 7.60129 33.3463 7.64037L31.237 9.61171C30.8718 9.95317 30.2984 9.93385 29.9569 9.5686C29.6149 9.20351 29.6348 8.63 29.9995 8.28869L32.1086 6.31678C32.4739 5.97532 33.0472 5.99464 33.3887 6.35989C33.6918 6.68426 33.711 7.17178 33.4566 7.5158" fill="#FFE5B9"/>\n        <defs> \n          <radialGradient id="paint0_radial" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(17.893 13.0287) rotate(68.0455) scale(16.3739)">\n            <stop stop-color="#F7B548"/>\n            <stop offset="1" stop-color="#F26768"/>\n          </radialGradient>\n          <linearGradient id="paint1_linear" x1="6.25776" y1="16.7047" x2="16.6582" y2="34.3518" gradientUnits="userSpaceOnUse">\n            <stop stop-color="#FFD590"/>\n            <stop offset="1" stop-color="#F26768"/>\n          </linearGradient>\n        </defs>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateErrorImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="errorImageClass" viewBox="0 0 46 43">\n        <path class="highlightFillAndOutlineClass" d="M39.5831 17.9874L28.3746 29.2612C28.0688 29.5703 27.951 30.0189 28.0654 30.4383C28.1799 30.8578 28.5093 31.1844 28.9296 31.2953L44.3042 35.3601C44.7245 35.4707 45.1718 35.349 45.4781 35.0407C45.7843 34.7324 45.9031 34.2843 45.7898 33.8648L41.6237 18.5196C41.5082 18.1003 41.1778 17.7744 40.757 17.6647C40.3362 17.5549 39.8887 17.6779 39.5831 17.9874Z" fill="#605E5C"/>\n        <path class="highlightFillAndOutlineClass" d="M7.00279 5.18219L0.371699 19.6361C0.190455 20.0311 0.233457 20.4928 0.484538 20.8475C0.735619 21.2022 1.15672 21.3963 1.58952 21.3567L17.4245 19.8712C17.8578 19.831 18.2368 19.5628 18.4186 19.1674C18.6005 18.7721 18.5575 18.3097 18.306 17.9546L9.10215 4.98303C8.84995 4.62874 8.42795 4.43582 7.99501 4.47689C7.56206 4.51797 7.18387 4.78679 7.00279 5.18219Z" fill="#605E5C"/>\n        <path class="highlightFillAndOutlineClass" d="M19.687 7.2129L0.449933 35.7224C-0.0757814 36.5024 -0.145797 37.5035 0.266226 38.3491C0.678249 39.1946 1.50981 39.7565 2.44808 39.8231L36.7528 42.2294C37.6907 42.2937 38.5919 41.8535 39.1176 41.074C39.6433 40.2946 39.7138 39.2941 39.3027 38.4486L24.235 7.53939C23.8247 6.69276 22.9937 6.12956 22.0553 6.06219C21.1169 5.99483 20.214 6.43355 19.687 7.2129Z" fill="#F7B548"/>\n        <rect class="inverseHighlightFillClass" x="20.1621" y="14.3311" width="2.61195" height="15.9982" rx="1.30598" transform="rotate(4.01 20.1621 14.3311)" fill="white"/>\n        <path class="inverseHighlightFillClass" d="M20.1274 34.9651C20.9389 34.9651 21.5966 34.3073 21.5966 33.4958C21.5966 32.6844 20.9389 32.0266 20.1274 32.0266C19.316 32.0266 18.6582 32.6844 18.6582 33.4958C18.6582 34.3073 19.316 34.9651 20.1274 34.9651Z" fill="white"/>\n        <path class="highlightOutlineClass" d="M6.18993 18.7448C7.00136 18.7448 7.65915 18.087 7.65915 17.2756C7.65915 16.4642 7.00136 15.8064 6.18993 15.8064C5.3785 15.8064 4.7207 16.4642 4.7207 17.2756C4.7207 18.087 5.3785 18.7448 6.18993 18.7448Z" fill="#B3AFAB"/>\n        <rect class="highlightOutlineClass" x="43.4922" y="13.5449" width="2.61939" height="12.4421" rx="1.30969" transform="rotate(16.8087 43.4922 13.5449)" fill="#8A8886"/>\n        <path class="highlightOutlineClass" d="M40.1909 30.1262C41.0023 30.1262 41.6601 29.4684 41.6601 28.657C41.6601 27.8455 41.0023 27.1877 40.1909 27.1877C39.3795 27.1877 38.7217 27.8455 38.7217 28.657C38.7217 29.4684 39.3795 30.1262 40.1909 30.1262Z" fill="#8A8886"/>\n        <rect class="highlightOutlineClass" x="0.704102" y="2.69336" width="2.61195" height="12.4068" rx="1.30598" transform="rotate(-15.81 0.704102 2.69336)" fill="#8A8886"/>\n        <path class="highlightOutlineClass" d="M6.18993 18.7448C7.00136 18.7448 7.65915 18.087 7.65915 17.2756C7.65915 16.4642 7.00136 15.8064 6.18993 15.8064C5.3785 15.8064 4.7207 16.4642 4.7207 17.2756C4.7207 18.087 5.3785 18.7448 6.18993 18.7448Z" fill="#8A8886"/>\n        <path class="highlightFillAndOutlineClass" d="M25.1913 3.71279C24.9984 4.02811 25.05 4.43498 25.3153 4.69227C25.3596 4.73611 25.4089 4.77447 25.4623 4.80654C25.8393 5.03103 26.3268 4.90841 26.5527 4.53228L27.5714 2.82799C27.7752 2.48469 27.696 2.04379 27.3853 1.793L27.2972 1.73423C26.9193 1.51031 26.4315 1.63445 26.2067 2.01175L25.1913 3.71279Z" fill="#979593"/>\n        <path class="highlightFillAndOutlineClass" d="M28.3132 7.34027C28.4051 7.53142 28.5705 7.67717 28.7717 7.74424C28.9729 7.8113 29.1927 7.79395 29.3808 7.69615L31.0655 6.84726C31.457 6.64919 31.6147 6.17189 31.4182 5.77963C31.3669 5.67379 31.292 5.58109 31.1994 5.50864C31.1266 5.45293 31.0449 5.40988 30.9578 5.3813C30.7566 5.31273 30.536 5.32924 30.3473 5.42701L28.6625 6.2759C28.2715 6.47265 28.1137 6.94896 28.3099 7.34027H28.3132Z" fill="#979593"/>\n        <path class="highlightFillAndOutlineClass" d="M21.2057 3.00117C21.2681 3.43692 21.6708 3.74041 22.1068 3.68027C22.3165 3.65114 22.506 3.53974 22.6334 3.37067C22.7608 3.20159 22.8157 2.98876 22.7859 2.77915L22.4921 0.68306C22.4281 0.250079 22.028 -0.051079 21.5942 0.00721714C21.3848 0.035554 21.1953 0.146278 21.0678 0.314832C20.9404 0.483386 20.8854 0.69584 20.9151 0.905076L21.2057 3.00117Z" fill="#979593"/>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generateWarningImage=function(){var e=this.m_document.createElement("div"),t='\n      <svg xmlns="'+i.RehearsalActorSettings.RehearsalSVGNamespace+'" class="warningImageClass" viewBox="0 0 48 48\'>\n        <path class="fillEvenoddClass highlightFillClass" d="M46.3345 19.3871C46.0474 19.2838 45.7317 19.3013 45.4574 19.4357C45.1832 19.5701 44.973 19.8103 44.8736 20.1028L42.6006 26.7022L44.7655 27.4715L47.0357 20.8721C47.1365 20.5806 47.1193 20.2604 46.9878 19.9818C46.8563 19.7033 46.6212 19.4893 46.3345 19.3871Z" fill="#797673"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M32.8881 36.1891L10.4805 42.2306C10.2345 42.2973 9.97205 42.2634 9.75121 42.1363C9.53037 42.0091 9.36942 41.7993 9.30403 41.5533L0.0330801 7.24343C-0.104414 6.73203 0.199234 6.20614 0.711369 6.0687L23.1189 0.0332321C23.6302 -0.104258 24.1565 0.197352 24.2954 0.707502L33.5664 35.0144C33.6332 35.26 33.5993 35.5221 33.4719 35.7426C33.3446 35.9631 33.1345 36.1238 32.8881 36.1891Z" fill="#484644"/>\n        <path class="fillEvenoddClass inverseHighlightFillClass" d="M19.0692 17.6928L13.4594 19.1869C12.4782 19.4528 11.4312 19.3188 10.5492 18.8143C9.66727 18.3098 9.02267 17.4764 8.75753 16.4976L7.63376 12.356C7.08175 10.3182 8.28833 8.21947 10.3308 7.66469L15.9407 6.17063C16.9218 5.90553 17.9684 6.03994 18.8502 6.54428C19.7319 7.04862 20.3767 7.88159 20.6425 8.85994L21.7663 13.0104C22.3181 15.0475 21.1113 17.1454 19.0692 17.6988" fill="#797673"/>\n        <path class="fillEvenoddClass inverseHighlightFillClass" d="M23.2673 33.9822L17.6603 35.4891C15.6166 36.0388 13.5118 34.8373 12.9554 32.8035L11.8346 28.6466C11.5687 27.6696 11.7035 26.6274 12.2093 25.7493C12.7151 24.8713 13.5505 24.2293 14.5317 23.9645L20.1416 22.4725C22.1846 21.9229 24.2886 23.1247 24.8436 25.1582L25.9674 29.3031C26.5194 31.3382 25.3128 33.4341 23.2703 33.9881" fill="#797673"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M17.8827 13.8679C17.5814 13.9467 17.272 13.7711 17.1913 13.4756L15.9199 8.8508C15.8662 8.6606 15.92 8.45673 16.061 8.316C16.202 8.17527 16.4088 8.11906 16.6035 8.16853C16.7983 8.218 16.9513 8.36565 17.005 8.55585L18.2795 13.1895C18.319 13.3311 18.2993 13.4823 18.2248 13.6096C18.1503 13.737 18.0272 13.8299 17.8827 13.8679Z" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M12.4833 15.3777C12.1892 15.4537 11.8868 15.2864 11.8009 15.0002L10.5204 10.3614C10.4667 10.1707 10.5208 9.96637 10.6623 9.8254C10.8038 9.68443 11.0112 9.62822 11.2063 9.67795C11.4015 9.72768 11.5548 9.87578 11.6085 10.0665L12.8801 14.7053C12.9196 14.8469 12.8999 14.9981 12.8254 15.1254C12.7509 15.2527 12.6278 15.3456 12.4833 15.3836" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M16.1781 15.84C16.2434 16.0761 16.1598 16.3284 15.9667 16.4782C15.7735 16.6279 15.5093 16.6453 15.2984 16.5221C15.0875 16.3989 14.9718 16.1597 15.0059 15.9171C15.04 15.6744 15.217 15.4767 15.4536 15.4169C15.7725 15.3311 16.1006 15.5202 16.1877 15.84" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M16.6833 31.6783C16.5386 31.7173 16.3841 31.6979 16.254 31.6245C16.1238 31.5511 16.0289 31.4297 15.99 31.2872L14.7151 26.6414C14.6488 26.3515 14.8257 26.0615 15.1171 25.9824C15.4084 25.9033 15.7117 26.0629 15.8062 26.3451L17.0812 30.991C17.1208 31.1332 17.1011 31.2851 17.0264 31.413C16.9517 31.5409 16.8282 31.6343 16.6833 31.6724" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M22.079 30.1698C21.7796 30.2486 21.4719 30.0744 21.3913 29.7805L20.121 25.154C20.0673 24.9634 20.1213 24.7591 20.2627 24.6181C20.4041 24.4771 20.6113 24.4209 20.8063 24.4707C21.0013 24.5204 21.1544 24.6685 21.2081 24.8592L22.4814 29.4827C22.5616 29.7783 22.3829 30.0817 22.082 30.1609" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M20.3812 32.1485C20.4656 32.4704 20.2747 32.8003 19.9547 32.8856C19.6346 32.9708 19.3064 32.7791 19.2214 32.4572C19.1364 32.1354 19.3267 31.8052 19.6466 31.7194C19.8006 31.6771 19.9651 31.6988 20.1031 31.7794C20.2412 31.8601 20.3413 31.993 20.3812 32.1485Z" fill="#33312D"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M33.3462 13.7646L37.2212 10.291C37.2549 10.2644 37.3005 10.257 37.3413 10.2714C37.382 10.2859 37.412 10.3201 37.4204 10.3615L37.8761 12.0498C37.8828 12.0874 37.9079 12.1195 37.9433 12.1359C37.9786 12.1523 38.02 12.1509 38.0541 12.1322L40.9181 10.6763C40.9721 10.6462 41.0407 10.6609 41.0766 10.7104C41.1125 10.7599 41.104 10.8278 41.057 10.8674L36.9798 14.4617C36.946 14.4897 36.8994 14.4981 36.8577 14.4835C36.8159 14.4689 36.7853 14.4336 36.7776 14.3911L36.4758 12.5645C36.4699 12.5264 36.4452 12.4935 36.4097 12.4765C36.3741 12.4595 36.3323 12.4605 36.2977 12.4792L33.482 13.9675C33.4272 13.9999 33.3559 13.9848 33.3198 13.9331C33.2837 13.8815 33.2953 13.8114 33.3462 13.7734" fill="#8A8886"/>\n        <path class="fillEvenoddClass highlightFillAndOutlineClass" d="M30.9002 10.6796L31.3322 3.31567C31.3387 3.25503 31.3765 3.2025 31.4313 3.17773C31.4861 3.15295 31.5498 3.15966 31.5984 3.19534L33.7079 4.49185C33.7512 4.52326 33.8066 4.53199 33.8573 4.5154C33.908 4.49881 33.948 4.45886 33.9652 4.40762L35.3705 0.118007C35.3971 0.0356715 35.4799 -0.013554 35.5635 0.00329375C35.6471 0.0201415 35.7052 0.0977658 35.6989 0.184186L35.1782 7.85496C35.1743 7.91774 35.1368 7.97326 35.0806 7.99963C35.0244 8.02599 34.9586 8.01896 34.909 7.9813L32.8173 6.38398C32.7738 6.3513 32.7176 6.34183 32.666 6.3585C32.6145 6.37518 32.5739 6.41598 32.557 6.4682L31.2286 10.7488C31.2023 10.8323 31.1183 10.8821 31.0338 10.8643C30.9494 10.8465 30.8918 10.7669 30.9002 10.6796Z" fill="#8A8886"/>\n        <path class="highlightFillClass" d="M47.4011 28.5112L32.4112 23.2926C31.948 23.1369 31.4446 23.3782 31.278 23.836L29.4522 29.0814C27.9399 33.3895 29.9916 38.1333 34.174 39.9991C33.8742 41.038 32.9119 43.283 31.323 43.4681C30.0128 43.6144 29.3443 43.0233 28.4179 42.2023C27.2757 41.1903 25.8516 39.9304 23.2014 40.5394C19.4629 41.3962 18.3627 44.9967 18.2997 46.782C18.2876 47.0937 18.4006 47.3974 18.6138 47.626C18.827 47.8545 19.1229 47.9891 19.436 48H19.4779C20.1114 47.9988 20.6306 47.499 20.6531 46.8685C20.6531 46.8357 20.8 43.501 23.7291 42.8293C25.1951 42.4949 25.8576 43.077 26.856 43.9637C27.9172 44.9011 29.2334 46.0684 31.5838 45.8057C34.7616 45.4534 36.0808 41.8262 36.4285 40.6738C40.6319 41.3196 44.7006 38.8904 46.109 34.894L47.9498 29.6456C48.1097 29.1817 47.8651 28.6759 47.4011 28.5112Z" fill="#CA5010"/>\n        <path class="fillEvenoddClass highlightFillClass" d="M38.53 16.6689C37.9322 16.4574 37.2788 16.7776 37.0691 17.3848L34.7988 23.9853L36.9639 24.7547L39.2342 18.1542C39.3349 17.8623 39.3173 17.5417 39.1852 17.263C39.0531 16.9844 38.8174 16.7706 38.53 16.6689Z" fill="#797673"/>\n      </svg>';return s.setInnerHtml(e,t),e},e.prototype.generatePauseButtonIcon=function(){var e=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"svg");e.id="ppt-Rehearsal-pauseButtonIcon",e.setAttribute("class","pauseButtonIconClass"),e.setAttribute("focusable","false");var t=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"path");return t.setAttribute("d","M-3.8147e-06 13.6641V0.335938H2.66406V13.6641H-3.8147e-06ZM5.33593 0.335938H8V13.6641H5.33593V0.335938Z"),t.setAttribute("class","pauseButtonPathClass"),e.appendChild(t),e},e.prototype.generateListeningButtonIcon=function(){var e=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"svg");e.id="ppt-Rehearsal-listeningButtonIcon",e.setAttribute("class","listeningButtonIconClass"),e.setAttribute("focusable","false");var t=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"path");return t.setAttribute("d","M3.5 12C3.29166 12 3.09635 11.9609 2.91406 11.8828C2.73177 11.8047 2.57291 11.6979 2.4375 \n      11.5625C2.30208 11.4271 2.19531 11.2682 2.11718 11.0859C2.03906 10.9036 2 10.7083 2 10.5V1.5C2 1.29167 2.03906 \n      1.09635 2.11718 0.914062C2.19531 0.731771 2.30208 0.572917 2.4375 0.4375C2.57291 0.302083 2.73177 0.195312 \n      2.91406 0.117188C3.09635 0.0390625 3.29166 0 3.5 0H7.5C7.70833 0 7.90364 0.0390625 8.08593 0.117188C8.26823 \n      0.195312 8.42708 0.302083 8.5625 0.4375C8.69791 0.572917 8.80468 0.731771 8.88281 0.914062C8.96093 1.09635 9 \n      1.29167 9 1.5V10.5C9 10.7083 8.96093 10.9036 8.88281 11.0859C8.80468 11.2682 8.69791 11.4271 8.5625 11.5625C8.42708 \n      11.6979 8.26823 11.8047 8.08593 11.8828C7.90364 11.9609 7.70833 12 7.5 12H3.5ZM11 8V10.8281C11 11.2656 10.9167 \n      11.6771 10.75 12.0625C10.5833 12.4479 10.3568 12.7839 10.0703 13.0703C9.78385 13.3568 9.44791 13.5833 9.0625 \n      13.75C8.67708 13.9167 8.26562 14 7.82812 14H6V15H8V16H3V15H5V14H3.17187C2.73437 14 2.32291 13.9167 1.9375 \n      13.75C1.55208 13.5833 1.21614 13.3568 0.929684 13.0703C0.643225 12.7839 0.416663 12.4479 0.249996 12.0625C0.0833295 \n      11.6771 -3.8147e-06 11.2656 -3.8147e-06 10.8281V8H0.999996V10.8281C0.999996 11.125 1.05729 11.4062 1.17187 \n      11.6719C1.28645 11.9375 1.4401 12.1693 1.63281 12.3672C1.83073 12.5599 2.0625 12.7135 2.32812 12.8281C2.59375 \n      12.9427 2.875 13 3.17187 13H7.82812C8.125 13 8.40625 12.9427 8.67187 12.8281C8.9375 12.7135 9.16666 12.5599 \n      9.35937 12.3672C9.55729 12.1693 9.71354 11.9375 9.82812 11.6719C9.9427 11.4062 10 11.125 10 10.8281V8H11Z"),t.setAttribute("class","listeningButtonPathClass"),e.appendChild(t),e},e.prototype.generatePlayButtonIcon=function(){var e=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"svg");e.id="ppt-Rehearsal-playButtonIcon",e.setAttribute("class","playButtonIconClass"),e.setAttribute("viewBox","0 0 10 14"),e.setAttribute("focusable","false");var t=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"path");return t.setAttribute("d","M10 7L0 14V0L10 7Z"),t.setAttribute("fill","white"),t.setAttribute("class","playButtonIconPathClass"),e.appendChild(t),e},e.prototype.generateNotificationsEnabledButtonIcon=function(){var e=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"svg");e.setAttribute("class","notificationEnabledButtonIconClass"),e.setAttribute("viewBox","0 0 15 15");var t=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"path");return t.setAttribute("d","M13.25 11.3125V12.25H9.5C9.5 12.5088 9.45117 12.7529 9.35352 12.9824C9.25586 13.207 9.12158 13.4048 8.95068 13.5757C8.77979 13.7466 8.57959 13.8809 8.3501 13.9785C8.12549 14.0762 7.88379 14.125 7.625 14.125C7.36621 14.125 7.12207 14.0762 6.89258 13.9785C6.66797 13.8809 6.47021 13.7466 6.29932 13.5757C6.12842 13.4048 5.99414 13.207 5.89648 12.9824C5.79883 12.7529 5.75 12.5088 5.75 12.25H2V11.3125H2.9375V5.6875C2.9375 5.25781 2.99365 4.84277 3.10596 4.44238C3.21826 4.04199 3.37451 3.66846 3.57471 3.32178C3.77979 2.9751 4.02393 2.66016 4.30713 2.37695C4.59521 2.08887 4.9126 1.84473 5.25928 1.64453C5.60596 1.43945 5.97949 1.28076 6.37988 1.16846C6.78027 1.05615 7.19531 1 7.625 1C8.05469 1 8.46973 1.05615 8.87012 1.16846C9.27051 1.28076 9.64404 1.43945 9.99072 1.64453C10.3374 1.84473 10.6523 2.08887 10.9355 2.37695C11.2236 2.66016 11.4678 2.9751 11.668 3.32178C11.873 3.66846 12.0317 4.04199 12.144 4.44238C12.2563 4.84277 12.3125 5.25781 12.3125 5.6875V11.3125H13.25ZM11.375 11.3125V5.6875C11.375 5.16992 11.2749 4.68408 11.0747 4.22998C10.8794 3.77588 10.6108 3.38037 10.269 3.04346C9.93213 2.70166 9.53662 2.43311 9.08252 2.23779C8.62842 2.0376 8.14258 1.9375 7.625 1.9375C7.10742 1.9375 6.62158 2.0376 6.16748 2.23779C5.71338 2.43311 5.31543 2.70166 4.97363 3.04346C4.63672 3.38037 4.36816 3.77588 4.16797 4.22998C3.97266 4.68408 3.875 5.16992 3.875 5.6875V11.3125H11.375ZM7.625 13.1875C7.75684 13.1875 7.87891 13.1631 7.99121 13.1143C8.10352 13.0654 8.20117 12.9995 8.28418 12.9165C8.37207 12.8286 8.44043 12.7285 8.48926 12.6162C8.53809 12.5039 8.5625 12.3818 8.5625 12.25H6.6875C6.6875 12.3818 6.71191 12.5039 6.76074 12.6162C6.80957 12.7285 6.87549 12.8286 6.9585 12.9165C7.04639 12.9995 7.14648 13.0654 7.25879 13.1143C7.37109 13.1631 7.49316 13.1875 7.625 13.1875Z"),t.setAttribute("class","notificationButtonPathClass"),t.setAttribute("fill","white"),e.appendChild(t),e},e.prototype.generateNotificationsDisabledButtonIcon=function(){var e=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"svg");e.setAttribute("class","notificationDisabledButtonIconClass"),e.setAttribute("viewBox","0 0 15 15");var t=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"line");t.setAttribute("x1","1.13578"),t.setAttribute("y1","0.929161"),t.setAttribute("x2","14.5708"),t.setAttribute("y2","14.3542"),t.setAttribute("stroke","white"),t.setAttribute("class","notificationButtonLineClass"),e.appendChild(t);var n=this.m_document.createElementNS(i.RehearsalActorSettings.RehearsalSVGNamespace,"path");return n.setAttribute("d","M12.1875 10.2738V5.625C12.1875 5.19531 12.1313 4.78027 12.019 4.37988C11.9067 3.97949 11.748 3.60596 11.543 3.25928C11.3428 2.9126 11.0986 2.59766 10.8105 2.31445C10.5273 2.02637 10.2124 1.78223 9.86572 1.58203C9.51904 1.37695 9.14551 1.21826 8.74512 1.10596C8.34473 0.993652 7.92969 0.9375 7.5 0.9375C7.07031 0.9375 6.65527 0.993652 6.25488 1.10596C5.85449 1.21826 5.48096 1.37695 5.13428 1.58203C4.79684 1.77689 4.48716 2.01338 4.20523 2.29151L4.87176 2.95803C5.20834 2.62713 5.59858 2.36622 6.04248 2.17529C6.49658 1.9751 6.98242 1.875 7.5 1.875C8.01758 1.875 8.50342 1.9751 8.95752 2.17529C9.41162 2.37061 9.80713 2.63916 10.144 2.98096C10.4858 3.31787 10.7544 3.71338 10.9497 4.16748C11.1499 4.62158 11.25 5.10742 11.25 5.625V9.33627L12.1875 10.2738ZM4.25354 3.75402C4.1765 3.88598 4.10631 4.0238 4.04297 4.16748C3.84766 4.62158 3.75 5.10742 3.75 5.625V11.25H11.25V10.7505L12.687 12.1875H9.375C9.375 12.4463 9.32617 12.6904 9.22852 12.9199C9.13086 13.1445 8.99658 13.3423 8.82568 13.5132C8.65479 13.6841 8.45459 13.8184 8.2251 13.916C8.00049 14.0137 7.75879 14.0625 7.5 14.0625C7.24121 14.0625 6.99707 14.0137 6.76758 13.916C6.54297 13.8184 6.34521 13.6841 6.17432 13.5132C6.00342 13.3423 5.86914 13.1445 5.77148 12.9199C5.67383 12.6904 5.625 12.4463 5.625 12.1875H1.875V11.25H2.8125V5.625C2.8125 5.19531 2.86865 4.78027 2.98096 4.37988C3.09326 3.97949 3.24951 3.60596 3.44971 3.25928C3.48791 3.1947 3.52746 3.13123 3.56837 3.06886L4.25354 3.75402ZM7.86621 13.0518C7.75391 13.1006 7.63184 13.125 7.5 13.125C7.36816 13.125 7.24609 13.1006 7.13379 13.0518C7.02148 13.0029 6.92139 12.937 6.8335 12.854C6.75049 12.7661 6.68457 12.666 6.63574 12.5537C6.58691 12.4414 6.5625 12.3193 6.5625 12.1875H8.4375C8.4375 12.3193 8.41309 12.4414 8.36426 12.5537C8.31543 12.666 8.24707 12.7661 8.15918 12.854C8.07617 12.937 7.97852 13.0029 7.86621 13.0518Z"),n.setAttribute("fill-rule","evenodd"),n.setAttribute("clip-rule","evenodd"),n.setAttribute("fill","white"),n.setAttribute("class","notificationButtonPathClass"),e.appendChild(n),e},e}();t.RehearsalSVGGenerator=c},function(e,t,n){"use strict";(function(t){var n="win32"===t.platform,r=/^(((?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?[\\\/]?)(?:[^\\\/]*[\\\/])*)((\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))[\\\/]*$/,i={parse:function(e){if("string"!=typeof e)throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t,n=(t=e,r.exec(t).slice(1));if(!n||5!==n.length)throw new TypeError("Invalid path '"+e+"'");return{root:n[1],dir:n[0]===n[1]?n[0]:n[0].slice(0,-1),base:n[2],ext:n[4],name:n[3]}}},a=/^((\/?)(?:[^\/]*\/)*)((\.{1,2}|[^\/]+?|)(\.[^.\/]*|))[\/]*$/,o={parse:function(e){if("string"!=typeof e)throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t,n=(t=e,a.exec(t).slice(1));if(!n||5!==n.length)throw new TypeError("Invalid path '"+e+"'");return{root:n[1],dir:n[0].slice(0,-1),base:n[2],ext:n[4],name:n[3]}}};e.exports=n?i.parse:o.parse,e.exports.posix=o.parse,e.exports.win32=i.parse}).call(this,n(114))},function(e,t,n){"use strict";n.r(t),n.d(t,"ClientWebSocket",(function(){return C})),n.d(t,"ClientWebSocketFactory",(function(){return S})),n.d(t,"requestCustomEndpointHandler",(function(){return Se})),n.d(t,"LogCategory",(function(){return r})),n.d(t,"ISpeechMode",(function(){return i})),n.d(t,"ClientApp",(function(){return a})),n.d(t,"ClientType",(function(){return o})),n.d(t,"ISpeechError",(function(){return s})),n.d(t,"ISpeechRecognitionStoppedReason",(function(){return c})),n.d(t,"IEventName",(function(){return l})),n.d(t,"IMediaEventStatus",(function(){return u})),n.d(t,"QualityStatusCode",(function(){return h})),n.d(t,"WebSocketState",(function(){return m})),n.d(t,"ISessionTimerState",(function(){return d})),n.d(t,"SpeechClientFactory",(function(){return _e})),n.d(t,"TraceLevel",(function(){return y})),n.d(t,"MediaCaptureSource",(function(){return z})),n.d(t,"RealTimeFactorHandler",(function(){return ae})),n.d(t,"SpeechStatus",(function(){return ce})),n.d(t,"SpeechClient",(function(){return me})),n.d(t,"NetworkQualityStatus",(function(){return re})),n.d(t,"SpeechHealthManager",(function(){return le})),n.d(t,"TranscriptResultJson",(function(){return N})),n.d(t,"RehearsalResultJson",(function(){return O})),n.d(t,"QualityStatusJson",(function(){return V})),n.d(t,"SpeechSessionStartedJson",(function(){return B})),n.d(t,"ClientAudioMessage",(function(){return H})),n.d(t,"ClientRequestMessage",(function(){return U})),n.d(t,"deserializeSpeechResponseMessage",(function(){return q})),n.d(t,"TelemetryManager",(function(){return X})),n.d(t,"TelemetryFieldNames",(function(){return ge})),n.d(t,"TelemetryErrorFieldNames",(function(){return ve})),n.d(t,"TranscriberSettings",(function(){return ye})),n.d(t,"Transcriber",(function(){return Ce})),n.d(t,"WebcamClient",(function(){return $}));var r,i,a,o,s,c,l,u,h,m,d,p=n(1),f=n.n(p),g=n(2),v=n.n(g);!function(e){e[e.PptSession=817]="PptSession"}(r||(r={})),function(e){e.Subtitles="Subtitles",e.Rehearsal="Rehearsal",e.Dictation="Dictation",e.Live="Live",e.ReadAlong="ReadAlong",e.ConversationTranscription="ConversationTranscription"}(i||(i={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(a||(a={})),function(e){e.web="web",e.win32="win32",e.mac="mac",e.ios="ios",e.android="android"}(o||(o={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(s||(s={})),function(e){e.Normal="Normal",e.WaitForSpeechEndTimeout="WaitForSpeechEndTimeout"}(c||(c={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(l||(l={})),function(e){e.AudioDeviceConnected="AudioDeviceConnected",e.VideoSetupCompleted="VideoSetupCompleted"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(h||(h={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(m||(m={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped"}(d||(d={}));var y,C=function(){function e(t){var n=this;f()(this,e),this.closeHandler=null,this.messageHandler=null,this.openHandler=null,this.webSocket=new WebSocket(t),this.webSocket.binaryType="arraybuffer",this.webSocket.onclose=function(e){n.closeHandler&&n.closeHandler(e.code)},this.webSocket.onmessage=function(e){n.messageHandler&&n.messageHandler(e.data)},this.webSocket.onopen=function(){n.openHandler&&n.openHandler()}}return v()(e,[{key:"close",value:function(){this.webSocket.close()}},{key:"send",value:function(e){this.webSocket.send(e)}},{key:"onclose",get:function(){return this.closeHandler},set:function(e){this.closeHandler=e}},{key:"onmessage",get:function(){return this.messageHandler},set:function(e){this.messageHandler=e}},{key:"onopen",get:function(){return this.openHandler},set:function(e){this.openHandler=e}},{key:"readyState",get:function(){switch(this.webSocket.readyState){case WebSocket.OPEN:return m.Open;case WebSocket.CONNECTING:return m.Connecting;case WebSocket.CLOSING:return m.Closing;case WebSocket.CLOSED:default:return m.Closed}}}]),e}(),S=function(){function e(){f()(this,e)}return v()(e,[{key:"createWebSocket",value:function(e){return new C(e)}}]),e}(),_=n(3),T=n.n(_),b=n(10),R=n.n(b);!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(y||(y={}));var w=n(13),E=n.n(w),M=n(38),I=n.n(M),F=n(39),D=n.n(F),A=n(16),k=n.n(A),x=n(12);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t,n=Object.create(null),r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}function W(e){var t=new Map;if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.set(i,e[i])}return t}n(111);var N=function(){function e(t){f()(this,e),this.speechResultJson=JSON.parse(t),this.transcriptsMap=W(this.speechResultJson.transcripts),this.propertiesMap=W(this.speechResultJson.properties)}return v()(e,[{key:"correlationId",get:function(){return this.speechResultJson.correlationId}},{key:"status",get:function(){return this.speechResultJson.status}},{key:"sourceLanguage",get:function(){return this.speechResultJson.sourceLanguage}},{key:"transcripts",get:function(){return this.transcriptsMap}},{key:"properties",get:function(){return this.propertiesMap}},{key:"isAdapted",get:function(){return this.speechResultJson.isAdapted}},{key:"isFinal",get:function(){return this.speechResultJson.isFinal}},{key:"isPong",get:function(){return this.speechResultJson.isPongMessage}},{key:"transcriptErrorCode",get:function(){return this.speechResultJson.transcriptErrorCode}},{key:"messageErrorCode",get:function(){return this.speechResultJson.messageErrorCode}}]),e}(),O=function(){function e(t){f()(this,e),this.rehearsalResultJson=JSON.parse(t),this.featuresMap=function e(t){for(var n=new Map,r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];t[a]instanceof Object?n.set(a,e(t[a])):n.set(a,t[a])}return n}(this.rehearsalResultJson.features)}return v()(e,[{key:"correlationId",get:function(){return this.rehearsalResultJson.correlationId}},{key:"status",get:function(){return this.rehearsalResultJson.status}},{key:"sourceLanguage",get:function(){return this.rehearsalResultJson.sourceLanguage}},{key:"isFinal",get:function(){return this.rehearsalResultJson.isFinal}},{key:"currentSlideIndex",get:function(){return this.rehearsalResultJson.currentSlideIndex}},{key:"features",get:function(){return this.featuresMap}}]),e}(),V=function(){function e(t){f()(this,e),this.qualityStatusJson=JSON.parse(t)}return v()(e,[{key:"severity",get:function(){return this.qualityStatusJson.severity}},{key:"priority",get:function(){return this.qualityStatusJson.priority}},{key:"shortCode",get:function(){return this.qualityStatusJson.shortCode}},{key:"longCode",get:function(){return this.qualityStatusJson.longCode}},{key:"shortString",get:function(){return this.qualityStatusJson.shortString}},{key:"longString",get:function(){return this.qualityStatusJson.longString}}]),e}(),B=function(){function e(t){f()(this,e),this.speechSessionStartedJson=JSON.parse(t)}return v()(e,[{key:"speechSessionId",get:function(){return this.speechSessionStartedJson.speechSessionId}},{key:"transcriptionSignature",get:function(){return this.speechSessionStartedJson.transcriptionSignature}},{key:"speechSessionHostDataCenter",get:function(){return this.speechSessionStartedJson.speechSessionHostDataCenter}}]),e}(),H=function(){function e(){f()(this,e),this.settings=new Map}return v()(e,[{key:"setProperties",value:function(e){this.settings.set("properties",JSON.stringify(P(e)))}},{key:"setOperationMetadata",value:function(e,t){var n={clientSentTimeMS:e,clientSessionSentTimeMS:t};this.settings.set("operationMetadata",JSON.stringify(n))}},{key:"setClientMetaData",value:function(e){this.settings.set("clientMetadata",JSON.stringify(e))}},{key:"serializeBinary",value:function(){var e,t,n=(new TextEncoder).encode(JSON.stringify({correlationId:this.correlationId,sourceLanguage:this.sourceLanguage,settings:P(this.settings)})),r=new Uint8Array(4+n.byteLength+(null==this.audio?0:this.audio.byteLength));return r.set((e=n.byteLength,t=new ArrayBuffer(4),new DataView(t).setInt32(0,e,!1),new Uint8Array(t))),r.set(n,4),null!=this.audio&&r.set(this.audio,4+n.byteLength),r}}]),e}(),U=function(){function e(t,n){f()(this,e),this.type=t,this.message=n}return v()(e,[{key:"serializeBinary",value:function(){var e=(new TextEncoder).encode(JSON.stringify({type:this.type,message:this.message})),t=new Uint8Array(4+e.byteLength);return t.set(e,4),t}}],[{key:"fromMap",value:function(t){return new e("DictionaryMessage",JSON.stringify(P(t)))}}]),e}();function q(e,t){var n=JSON.parse((new TextDecoder).decode(e));"speechresultmixmessage"===n.messageType&&t.handleSpeechResultMessage(new N(n.message)),"rehearsalresultmixmessage"===n.messageType&&t.handleRehearsalResultMessage(new O(n.message)),"qualitystatusmixmessage"===n.messageType&&t.handleQualityStatusMessage(new V(n.message)),"speechsessionstartedmixmessage"===n.messageType&&t.handleSpeechSessionStartedMessage(new B(n.message))}var j,G=n(20),z=function(){function e(t,n){f()(this,e),this.mediaStream=null,this.messageLen=0,this.MAX_BUFFER_SIZE=4096,this.message=new Float32Array(4096),this.m_audioCaptureInProgress=!1,this.audioHandler=null,this.c_maxBufferSize=16384,this.speechProcessorScript=t,this.m_microphoneDeviceId=n}var t;return v()(e,[{key:"startAudioCapture",value:(t=R()(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null,t=!this.m_microphoneDeviceId||{deviceId:{exact:this.m_microphoneDeviceId}},this.m_audioCaptureInProgress=!0,e.next=5,navigator.mediaDevices.getUserMedia({audio:t,video:!1});case 5:if(this.mediaStream=e.sent,this.m_audioCaptureInProgress){e.next=9;break}return this.stopAudioCapture(),e.abrupt("return",s.ErrorAudioCaptureStalePermission);case 9:return e.abrupt("return",this.initializeAudioSession());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopAudioCapture",value:function(){this.m_audioCaptureInProgress=!1,this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.streamSource&&(this.scriptNode&&this.streamSource.disconnect(this.scriptNode),this.streamSource=null),this.scriptNode&&(this.scriptNode.onaudioprocess=null,this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode=null),this.speechProcessorScript&&this.m_workletNode&&(this.m_workletNode.disconnect(this.audioCtx.destination),this.m_workletNode=null)}},{key:"pauseAudioCapture",value:function(){this.setAudioEnabled(!1)}},{key:"resumeAudioCapture",value:function(){this.setAudioEnabled(!0)}},{key:"setAudioEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e}))}},{key:"initializeAudioSession",value:function(){var t=this;return this.audioCtx=e.createAudioContext(),this.audioCtx?(this.speechProcessorScript&&this.audioCtx.audioWorklet?this.audioCtx.audioWorklet.addModule(this.speechProcessorScript).then((function(){t.connectToMediaWithAudioWorklet()})).catch((function(){t.connectToMediaWithScriptProcessor()})):this.connectToMediaWithScriptProcessor(),s.ErrorNone):s.ErrorAudioSetupFailure}},{key:"connectToMediaWithAudioWorklet",value:function(){var t=this,n=new AudioWorkletNode(this.audioCtx,"speech-processor");n.port.onmessage=function(n){var r=n.data;if(t.messageLen===t.MAX_BUFFER_SIZE){if(t.audioHandler){var i=e.encodeWAVWithoutHeader(t.message);t.audioHandler(i,Object(G.v4)())}t.messageLen=0}t.message.set(r,t.messageLen),t.messageLen+=r.length};var r=this.audioCtx.createMediaStreamSource(this.mediaStream);r.connect(n),n.connect(this.audioCtx.destination),this.m_workletNode=n,this.streamSource=r}},{key:"connectToMediaWithScriptProcessor",value:function(){var t=this;this.streamSource=this.audioCtx.createMediaStreamSource(this.mediaStream);var n=Math.pow(2,Math.floor(Math.log(.2*this.audioCtx.sampleRate)/Math.log(2))),r=n<=this.c_maxBufferSize?n:this.c_maxBufferSize;this.scriptNode=this.audioCtx.createScriptProcessor(r,1,1),this.scriptNode.onaudioprocess=function(n){if(t.audioHandler){var r=e.encodeWAVWithoutHeader(n.inputBuffer.getChannelData(0));t.audioHandler(r,Object(G.v4)())}},this.streamSource.connect(this.scriptNode),this.scriptNode.connect(this.audioCtx.destination)}},{key:"sampleRate",get:function(){return this.audioCtx?this.audioCtx.sampleRate:null}},{key:"onaudioprocess",get:function(){return this.audioHandler},set:function(e){this.audioHandler=e}}],[{key:"createAudioContext",value:function(){var e;try{e=new AudioContext}catch(e){}if(!e)try{e=new window.webkitAudioContext}catch(e){}return e}},{key:"encodeWAVWithoutHeader",value:function(t){var n=new ArrayBuffer(2*t.length),r=new DataView(n);return e.floatTo16BitPCM(r,0,t),r}},{key:"floatTo16BitPCM",value:function(e,t,n){for(var r=t,i=0;i<n.length;i+=1,r+=2){var a=Math.max(-1,Math.min(1,n[i]));e.setInt16(r,a<0?32768*a:32767*a,!0)}}}]),e}();function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=function(){function e(t){f()(this,e),this.m_sessionTelemetry=new Map,this.m_fatalErrors=new Array,this.m_nonFatalErrors=new Array,j=t,this.recordSpeechSettings()}return v()(e,[{key:"publishSessionTelemetry",value:function(){j.sendTraceTag(595686043,r.PptSession,y.Info,JSON.stringify(function(e){var t,n=Object.create(null),r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}(this.m_sessionTelemetry)))}},{key:"recordSpeechSettings",value:function(){this.m_sessionTelemetry.set(ge.DataLoggingTimeInterval,ye.DataLoggingIntervalMS),this.m_sessionTelemetry.set(ge.FEnableContentlogging,ye.IsContentLoggingEnabled),this.m_sessionTelemetry.set(ge.RealTimeFactorLowerThreshold,ye.RealTimeFactorLowerThreshold),this.m_sessionTelemetry.set(ge.RealTimeFactorUpperThreshold,ye.RealTimeFactorUpperThreshold)}},{key:"recordSpeechClientConnectionStart",value:function(e){this.initialize(),this.m_sessionTelemetry.set(ge.TranscriptionStartTime,Date.now()),this.m_sessionTelemetry.set(ge.TranscriptionEntryPointCalled,Date.now()),this.m_sessionTelemetry.set(ge.SpeechLanguage,e.sourceLanguage),this.m_sessionTelemetry.set(ge.TranslationLanguage,e.targetLanguages),this.m_sessionTelemetry.set(ge.SpeechMode,e.speechMode),this.m_sessionTelemetry.set(ge.CustomEndpointEnabled,!!e.documentDownloadConfig)}},{key:"recordSpeechRecognitionStart",value:function(){this.m_sessionTelemetry.set(ge.SpeechClientRecognitionStartTime,Date.now())}},{key:"recordSpeechClientConnectionEnd",value:function(e){this.m_sessionTelemetry.set(ge.TranscriptionEndTime,Date.now()),this.m_sessionTelemetry.has(ge.WebSocketOpenedTimestamp)||j.sendTraceTag(593253271,r.PptSession,y.Warning,"recordSpeechClientConnectionEnd: WebSocketOpenedTimestamp is null. TranscriberID:  ".concat(e));var t=Date.now(),n=t-this.m_sessionTelemetry.get(ge.WebSocketOpenedTimestamp);this.m_sessionTelemetry.set(ge.WebSocketClosedTimestamp,t),this.m_sessionTelemetry.set(ge.WebSocketConnectionDurationMS,n),this.m_sessionTelemetry.set(ge.FatalErrors,this.m_fatalErrors),this.m_sessionTelemetry.set(ge.NonFatalErrors,this.m_nonFatalErrors)}},{key:"recordWebSocketConnectionStart",value:function(e,t){var n;n=-1!==e.toLowerCase().indexOf(".edog")?"EDog":-1!==e.toLowerCase().indexOf(".live-int.")?"Int":"Production",this.m_sessionTelemetry.set(ge.TranscriberID,t),this.m_sessionTelemetry.set(ge.Endpoint,n),this.m_sessionTelemetry.set(ge.InitializeWebSocketStartTimeMS,Date.now())}},{key:"recordWebSocketCreation",value:function(){this.m_sessionTelemetry.set(ge.WebSocketCreateTimestamp,Date.now())}},{key:"recordWebSocketRetryCounts",value:function(e){this.m_sessionTelemetry.set(ge.WebSocketRetryAttempts,e)}},{key:"recordWebSocketConnectionOpen",value:function(){this.m_sessionTelemetry.set(ge.WebSocketOpenedTimestamp,Date.now())}},{key:"recordWebSocketConnectionEnd",value:function(){this.m_sessionTelemetry.set(ge.InitializeWebSocketEndTimeMS,Date.now())}},{key:"recordCustomEndpointStart",value:function(e){this.m_sessionTelemetry.set(ge.CustomEndpointRequestCorrelationID,e),this.m_sessionTelemetry.set(ge.RequestCustomEndpointStartTimeMS,Date.now())}},{key:"recordCustomEndpointEnd",value:function(e){this.m_sessionTelemetry.set(ge.WebSocketCustomEndpoint,e),this.m_sessionTelemetry.set(ge.RequestCustomEndpointEndTimeMS,Date.now())}},{key:"recordCustomEndpointError",value:function(){this.m_sessionTelemetry.set(ge.RequestCustomEndpointFailedEndTimeMS,Date.now())}},{key:"recordCustomEndpointTimeout",value:function(){this.m_sessionTelemetry.set(ge.RequestCustomEndpointTimedOutEndTimeMS,Date.now())}},{key:"recordFrontdoorRoundTripLatency",value:function(e){this.m_sessionTelemetry.set(ge.AverageFrontDoorRoundTripLatencyCount,e)}},{key:"recordNetworkQuality",value:function(e,t){this.m_sessionTelemetry.set(ge.TotalNetworkErrorMessageCount,e),this.m_sessionTelemetry.set(ge.TotalNetworkWarningMessageCount,t)}},{key:"recordInitialAudioMessage",value:function(){this.m_sessionTelemetry.has(ge.SendFirstMessageTime)||this.m_sessionTelemetry.set(ge.SendFirstMessageTime,Date.now())}},{key:"recordAudioStatistics",value:function(e,t){this.m_sessionTelemetry.set(ge.AudioFactorCalculationDurationMS,e),this.m_sessionTelemetry.set(ge.TotalAudioFactorOutsideOfThresholdCount,t)}},{key:"recordInitialMessageLatency",value:function(){if(!this.m_sessionTelemetry.has(ge.FirstMessageLatencyMS)&&this.m_sessionTelemetry.get(ge.SendFirstMessageTime)){var e=Date.now()-this.m_sessionTelemetry.get(ge.SendFirstMessageTime);this.m_sessionTelemetry.set(ge.FirstMessageLatencyMS,e)}}},{key:"recordPartialMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(ge.MaxPartialMessageLatencyMS,e),this.m_sessionTelemetry.set(ge.MinPartialMessageLatencyMS,t),this.m_sessionTelemetry.set(ge.TotalPartialMessagesCount,n),this.m_sessionTelemetry.set(ge.TotalHighLatencyPartialMessagesCount,r),this.m_sessionTelemetry.set(ge.TotalPartialMessageLatency,i)}},{key:"recordFinalMessageLatency",value:function(e,t,n,r,i){this.m_sessionTelemetry.set(ge.MaxFinalMessageLatencyMS,e),this.m_sessionTelemetry.set(ge.MinFinalMessageLatencyMS,t),this.m_sessionTelemetry.set(ge.TotalFinalMessagesCount,n),this.m_sessionTelemetry.set(ge.TotalHighLatencyFinalMessagesCount,r),this.m_sessionTelemetry.set(ge.TotalFinalMessageLatency,i)}},{key:"recordMessageLatencyStats",value:function(e,t,n){this.m_sessionTelemetry.set(ge.TotalMessageCorrelationIDNotFoundCount,e),this.m_sessionTelemetry.set(ge.LatencyTableDeletedCount,t),this.m_sessionTelemetry.set(ge.TotalEntriesInLatencyTable,n)}},{key:"recordRealTimeReceiveFactorStats",value:function(e,t){this.m_sessionTelemetry.set(ge.TotalTranscriptOutsideOfThresholdCount,e),this.m_sessionTelemetry.set(ge.MessageLatencyCalculationTimeMS,t)}},{key:"recordSpeechClientError",value:function(e,t,n,i){var a={};a.ErrorName=e||"ErrorEmpty",a.ErrorReason=t,a.ClientTimestampMS=n;var o=i?this.m_fatalErrors:this.m_nonFatalErrors;o.length<10?o.push(a):j.sendTraceTag(593253272,r.PptSession,y.Warning,"Transcriber::recordSpeechClientError Will not append error to error list because the list contains too many errors ".concat(JSON.stringify(a)))}},{key:"recordWebsocketCloseError",value:function(e){1e3!==e&&this.m_sessionTelemetry.set(ve.WebSocketErrorCode,e)}},{key:"initialize",value:function(){this.m_fatalErrors=[],this.m_nonFatalErrors=[],this.m_sessionTelemetry.clear()}}]),e}(),Q=n(58),Y=n.n(Q),K=function(){function e(){f()(this,e),this.mediaStream=null,this.__isCapturing=!1}var t;return v()(e,[{key:"startMediaCapture",value:(t=R()(T.a.mark((function e(t,n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:{width:t,height:n,facingMode:"user"}});case 2:return this.mediaStream=e.sent,e.abrupt("return",this.initializeWebcamCapture());case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.mediaStream&&(this.mediaStream.getTracks().forEach((function(e){e.stop()})),this.mediaStream=null),this.isCapturing=!1}},{key:"pauseMediaCapture",value:function(){this.setMediaEnabled(!1)}},{key:"resumeMediaCapture",value:function(){this.setMediaEnabled(!0)}},{key:"setMediaEnabled",value:function(e){this.mediaStream&&this.mediaStream.getTracks().forEach((function(t){t.enabled=e})),this.isCapturing=e}},{key:"initializeWebcamCapture",value:function(){if(!this.mediaStream)return s.ErrorWebcamSetupFailure;var e=this.mediaStream.getVideoTracks();return 0===e.length?s.ErrorWebcamNotFoundError:e.length>1?s.ErrorMultipleWebcamsFound:(this.isCapturing=!0,s.ErrorNone)}},{key:"isCapturing",set:function(e){e!==this.__isCapturing&&this.onCapturingContentChanged(e),this.__isCapturing=e}},{key:"stream",get:function(){return this.mediaStream}}]),e}();var Z=function e(){f()(this,e)};Z.defaultRequestedVideoHeight=322,Z.defaultRequestedVideoWidth=572;var $=function(e){I()(r,e);var t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return D()(this,n)}}(r);function r(e,t){var i;return f()(this,r),(i=n.call(this)).lastVideoWidth=-1,i.lastVideoHeight=-1,i.requestedVideoHeight=Z.defaultRequestedVideoHeight,i.requestedVideoWidth=Z.defaultRequestedVideoWidth,i.onWebcamFrame=null,i.processFeedHandler=null,e.requestedVideoWidth&&(i.requestedVideoWidth=e.requestedVideoWidth),e.requestedVideoHeight&&(i.requestedVideoHeight=e.requestedVideoHeight),i.videoView=e.videoView,i.workingCanvas=e.workingCanvas,i.webcamFrameWidth=e.webcamFrameWidth?e.webcamFrameWidth:500,i.delayBetweenCapturesMS=1e3/e.numFramesPerSecond,i.onWebcamFrame=t,i.workingCanvas&&(i.workingCanvas.width=i.webcamFrameWidth),i}return v()(r,[{key:"startMediaCapture",value:(t=R()(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y()(k()(r.prototype),"startMediaCapture",this).call(this,this.requestedVideoWidth,this.requestedVideoHeight);case 2:if((t=e.sent)===s.ErrorNone){e.next=5;break}return e.abrupt("return",t);case 5:return this.videoView.srcObject=this.stream,this.videoView.play(),e.abrupt("return",s.ErrorNone);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stopMediaCapture",value:function(){this.videoView.pause(),this.videoView.srcObject=null,Y()(k()(r.prototype),"stopMediaCapture",this).call(this)}},{key:"tryCaptureFrame",value:function(){if(!this.videoView||!this.workingCanvas)return null;var e=this.workingCanvas.getContext("2d");if(!e)return null;if((this.videoView.videoHeight!==this.lastVideoHeight||this.videoView.videoWidth!==this.lastVideoWidth)&&this.videoView.videoWidth){var t=this.webcamFrameWidth/this.videoView.videoWidth;this.workingCanvas.height=t*this.videoView.videoHeight,this.lastVideoHeight=this.videoView.videoHeight,this.lastVideoWidth=this.videoView.videoWidth}return e.drawImage(this.videoView,0,0,this.workingCanvas.width,this.workingCanvas.height),this.workingCanvas.toDataURL("image/jpeg")}},{key:"tryProcessFeed",value:function(){if(this.onWebcamFrame){var e=this.tryCaptureFrame();e&&this.onWebcamFrame(e,Object(G.v4)())}}},{key:"onCapturingContentChanged",value:function(e){var t=this;this.onWebcamFrame&&(e?this.processFeedHandler=setInterval((function(){return t.tryProcessFeed()}),this.delayBetweenCapturesMS):this.processFeedHandler&&clearInterval(this.processFeedHandler))}}]),r}(K);function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te,ne,re,ie=function(){function e(){f()(this,e),this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted,this.elapsedSessionTimeInMS=0,this.timerState=d.NotStarted}return v()(e,[{key:"restart",value:function(e){this.timerState=e?d.Started:d.Paused,this.lastStartTimeInMS=Date.now(),this.elapsedSessionTimeInMS=0}},{key:"resume",value:function(){this.timerState===d.Paused&&(this.timerState=d.Started,this.lastStartTimeInMS=Date.now())}},{key:"pause",value:function(){this.timerState===d.Started&&(this.timerState=d.Paused,this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS)}},{key:"stop",value:function(){this.timerState===d.Started&&(this.elapsedSessionTimeInMS+=Date.now()-this.lastStartTimeInMS),this.timerState=d.Stopped}},{key:"getElapsedSessionTimeInMS",value:function(){return this.timerState===d.Started?this.elapsedSessionTimeInMS+(Date.now()-this.lastStartTimeInMS):this.elapsedSessionTimeInMS}}]),e}(),ae=function(){function e(t,n){f()(this,e),this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_transcriberId="",this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_startTime=0,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0,this.m_intervalTranscript=ye.DataLoggingIntervalMS,this.m_intervalAudio=ye.DataLoggingIntervalMS,this.m_lastAudioLogUTC=Date.now(),this.m_lastTranscriptLogUTC=Date.now(),te=t,this.telemetryManager=n}return v()(e,[{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_startTime=Date.now()}},{key:"calculatePreAudioMetrics",value:function(e){this.m_currentSentAudioTimeUTC=Date.now();var t=Date.now()-e;this.m_prepAudioCount+=1,this.m_prepAudioSum+=t,this.m_minPrepAudio=Math.min(this.m_minPrepAudio,t),this.m_maxPrepAudio=Math.max(this.m_maxPrepAudio,t)}},{key:"calculateAndLogRealTimeSendFactorStats",value:function(e){try{var t=Date.now();if(this.m_totalAudioMessageCountInCurrentTimeInterval+=1,this.m_totalAudioMessageCountInPreviousTimeInterval>0&&this.m_lastSentAudioTimeUTC<Number.MAX_VALUE){var n=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval,i=Date.now()-this.m_lastSentAudioTimeUTC,a=n/(i>0?i:1);a>0&&this.calculateRealTimeSendFactorStats(e,a,i,n)}Date.now()-this.m_lastAudioLogUTC>ye.DataLoggingIntervalMS&&this.logRealTimeSendStatsForEachInterval(),this.m_lastSentAudioTimeUTC=this.m_currentSentAudioTimeUTC;var o=Date.now()-t;this.m_audioFactorCalculationDuration+=o}catch(e){te.sendTraceTag(595716178,r.PptSession,y.Warning,"calculateAndLogRealTimeSendFactorStats: Calculating audio sending metrics threw an exception: ".concat(e,"\n             TranscriberID: ").concat(this.m_transcriberId))}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_startTime=0,this.m_startLogIntervalTranscript=Number.MAX_VALUE,this.m_intervalTranscript=Number.MAX_VALUE,this.m_messageLatencyCalculationTime=0,this.m_totalTranscriptMessageCountInPreviousTimeInterval=0,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_lastReceivedTranscriptTimeUTC=Number.MAX_VALUE,this.m_lastTranscriptLogUTC=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCount=0,this.m_realTimeReceiveDataFactorSum=0,this.m_minRealTimeReceiveDataFactor=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactor=Number.MIN_VALUE,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_totalTranscriptFactorOutsideOfThresholdCount=0,this.m_totalAudioMessageCountInPreviousTimeInterval=0,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_lastSentAudioTimeUTC=Number.MAX_VALUE,this.m_currentSentAudioTimeUTC=Number.MAX_VALUE,this.m_lastAudioLogUTC=Number.MIN_VALUE,this.m_realTimeSendDataFactorCount=0,this.m_realTimeSendDataFactorSum=0,this.m_minRealTimeSendDataFactor=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactor=Number.MIN_VALUE,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_intervalAudio=Number.MAX_VALUE,this.m_totalAudioFactorOutsideOfThresholdCount=0,this.m_startLogIntervalAudio=Number.MAX_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_audioFactorCalculationDuration=0}},{key:"calculateRealTimeSendFactorStats",value:function(e,t,n,i){if(this.m_realTimeSendDataFactorCount+=1,this.m_realTimeSendDataFactorSum+=t,this.m_minRealTimeSendDataFactor=Math.min(this.m_minRealTimeSendDataFactor,t),this.m_maxRealTimeSendDataFactor=Math.max(this.m_maxRealTimeSendDataFactor,t),this.m_realTimeSendDataFactorCountInTimeInterval+=1,this.m_realTimeSendDataFactorSumInTimeInterval+=t,this.m_minRealTimeSendDataFactorInTimeInterval=Math.min(this.m_minRealTimeSendDataFactorInTimeInterval,t),this.m_maxRealTimeSendDataFactorInTimeInterval=Math.max(this.m_maxRealTimeSendDataFactorInTimeInterval,t),t<ye.RealTimeFactorLowerThreshold||t>ye.RealTimeFactorUpperThreshold){this.m_totalAudioFactorOutsideOfThresholdCount+=1;var a=0,o=0,s=0;this.m_realTimeSendDataFactorCount>0&&(a=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,o=this.m_minRealTimeSendDataFactor,s=this.m_maxRealTimeSendDataFactor),te.sendTraceTag(595716176,r.PptSession,y.Warning,JSON.stringify({MessageCorrelationID:e,SessionDurationInMS:Date.now()-this.m_startTime,RealTimeSendingDataFactor:t,AvgRealTimeSendingDataFactor:a,MinRealTimeSendingDataFactor:o,MaxRealTimeSendingDataFactor:s,AvgSendingDataDurationForInterval:i,RealTimeDurationForCurrentMessage:n,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeSendStatsForEachInterval",value:function(){var e=0,t=0,n=0;this.m_realTimeSendDataFactorCount>0&&(e=1*this.m_realTimeSendDataFactorSum/this.m_realTimeSendDataFactorCount,t=this.m_minRealTimeSendDataFactor,n=this.m_maxRealTimeSendDataFactor);var i=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(i=this.m_intervalAudio/this.m_totalAudioMessageCountInPreviousTimeInterval);var a=0,o=0,s=0;this.m_realTimeSendDataFactorCountInTimeInterval>0&&(a=1*this.m_realTimeSendDataFactorSumInTimeInterval/this.m_realTimeSendDataFactorCountInTimeInterval,o=this.m_minRealTimeSendDataFactorInTimeInterval,s=this.m_maxRealTimeSendDataFactorInTimeInterval);var c=0,l=0,u=0;this.m_prepAudioCount>0&&(c=this.m_prepAudioSum/this.m_prepAudioCount,l=this.m_minPrepAudio,u=this.m_maxPrepAudio),te.sendTraceTag(595716177,r.PptSession,y.Info,JSON.stringify({SessionDurationInMS:Date.now()-this.m_startTime,AvgRealTimeSendingDataFactor:e,MinRealTimeSendingDataFactor:t,MaxRealTimeSendingDataFactor:n,AvgRealTimeSendingDataFactorForInterval:a,MinRealTimeSendingDataFactorForInterval:o,MaxRealTimeSendingDataFactorForInterval:s,AvgPrepAudioForInterval:c,MinPrepAudioForInterval:l,MaxPrepAudioForInterval:u,AvgSendingDataDurationForInterval:i,TotalAudioMessageCountInPreviousTimeInterval:this.m_totalAudioMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalAudio,TranscriberID:this.m_transcriberId})),this.m_totalAudioMessageCountInPreviousTimeInterval=this.m_totalAudioMessageCountInCurrentTimeInterval,this.m_totalAudioMessageCountInCurrentTimeInterval=0,this.m_realTimeSendDataFactorCountInTimeInterval=0,this.m_realTimeSendDataFactorSumInTimeInterval=0,this.m_minRealTimeSendDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeSendDataFactorInTimeInterval=Number.MIN_VALUE,this.m_prepAudioCount=0,this.m_prepAudioSum=0,this.m_minPrepAudio=Number.MAX_VALUE,this.m_maxPrepAudio=Number.MIN_VALUE,this.m_lastAudioLogUTC=Date.now(),this.resetAudioIntervalStats()}},{key:"resetAudioIntervalStats",value:function(){this.m_startLogIntervalAudio<Number.MAX_VALUE&&(this.m_intervalAudio=Date.now()-this.m_startLogIntervalAudio),this.m_startLogIntervalAudio=Date.now()}},{key:"calculateAndLogRealTimeReceiveFactorStats",value:function(e,t,n,r,i){var a=Date.now()-e;this.m_messageLatencyCalculationTime+=a;var o=0,s=0,c=0;this.m_totalTranscriptMessageCountInCurrentTimeInterval+=1,this.m_totalTranscriptMessageCountInPreviousTimeInterval>0&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(o=(c=this.m_intervalTranscript/this.m_totalTranscriptMessageCountInPreviousTimeInterval)/((s=Date.now()-this.m_lastReceivedTranscriptTimeUTC)>0?s:1))>0&&this.calculateRealTimeReceiveFactorStats(t,n,r,i,o,c,s),ye.IsLogEachTranscriptMessage||this.logRealTimeReceiveStatsForEachTranscript(t,n,r,i,c,o),Date.now()-this.m_lastTranscriptLogUTC>ye.DataLoggingIntervalMS&&this.logRealTimeReceiveStatsForEachInterval(t,n,r,i),this.m_lastReceivedTranscriptTimeUTC=Date.now()}},{key:"calculateRealTimeReceiveFactorStats",value:function(e,t,n,i,a,o,s){if(this.m_realTimeReceiveDataFactorCount+=1,this.m_realTimeReceiveDataFactorSum+=a,this.m_minRealTimeReceiveDataFactor=Math.min(this.m_minRealTimeReceiveDataFactor,a),this.m_maxRealTimeReceiveDataFactor=Math.max(this.m_maxRealTimeReceiveDataFactor,a),this.m_realTimeReceiveDataFactorCountInTimeInterval+=1,this.m_realTimeReceiveDataFactorSumInTimeInterval+=a,this.m_minRealTimeReceiveDataFactorInTimeInterval=Math.min(this.m_minRealTimeReceiveDataFactorInTimeInterval,a),this.m_maxRealTimeReceiveDataFactorInTimeInterval=Math.max(this.m_maxRealTimeReceiveDataFactorInTimeInterval,a),!ye.IsLogEachTranscriptMessage&&(a<ye.RealTimeFactorLowerThreshold||a>ye.RealTimeFactorUpperThreshold)){this.m_totalTranscriptFactorOutsideOfThresholdCount+=1;var c=0,l=0,u=0;this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,l=this.m_minRealTimeReceiveDataFactor,u=this.m_maxRealTimeReceiveDataFactor),te.sendTraceTag(595716104,r.PptSession,y.Warning,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:a,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:l,MaxRealTimeReceivingDataFactor:u,AvgReceivingDataDurationForInterval:o,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}}},{key:"logRealTimeReceiveStatsForEachTranscript",value:function(e,t,n,i,a,o){var s=0,c=0,l=0,u=0,h=0,m=0,d=0;0===this.m_totalTranscriptMessageCountInPreviousTimeInterval&&this.m_lastReceivedTranscriptTimeUTC<Number.MAX_VALUE&&(s=Date.now()-this.m_lastReceivedTranscriptTimeUTC),this.m_realTimeReceiveDataFactorCount>0&&(c=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,l=this.m_minRealTimeReceiveDataFactor,u=this.m_maxRealTimeReceiveDataFactor),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(h=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,m=this.m_minRealTimeReceiveDataFactorInTimeInterval,d=this.m_maxRealTimeReceiveDataFactorInTimeInterval),te.sendTraceTag(595716105,r.PptSession,y.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,RealTimeReceivingDataFactor:o,AvgRealTimeReceivingDataFactor:c,MinRealTimeReceivingDataFactor:l,MaxRealTimeReceivingDataFactor:u,AvgRealTimeReceivingDataFactorForInterval:h,MinRealTimeReceivingDataFactorForInterval:m,MaxRealTimeReceivingDataFactorForInterval:d,AvgReceivingDataDurationForInterval:a,RealTimeDurationForCurrentMessage:s,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}},{key:"logRealTimeReceiveStatsForEachInterval",value:function(e,t,n,i){var a=0,o=0,s=0,c=0,l=0,u=0;if(!ye.IsLogEachTranscriptMessage){this.m_realTimeReceiveDataFactorCount>0&&(a=1*this.m_realTimeReceiveDataFactorSum/this.m_realTimeReceiveDataFactorCount,o=this.m_minRealTimeReceiveDataFactor,s=this.m_maxRealTimeReceiveDataFactor);var h=0;this.m_totalAudioMessageCountInPreviousTimeInterval>0&&(h=this.m_intervalTranscript/this.m_totalAudioMessageCountInPreviousTimeInterval),this.m_realTimeReceiveDataFactorCountInTimeInterval>0&&(c=1*this.m_realTimeReceiveDataFactorSumInTimeInterval/this.m_realTimeReceiveDataFactorCountInTimeInterval,l=this.m_minRealTimeReceiveDataFactorInTimeInterval,u=this.m_maxRealTimeReceiveDataFactorInTimeInterval),te.sendTraceTag(595716106,r.PptSession,y.Info,JSON.stringify({MessageCorrelationID:e,MessageLatency:t,IsFinalMessage:i,AvgRealTimeReceivingDataFactor:a,MinRealTimeReceivingDataFactor:o,MaxRealTimeReceivingDataFactor:s,AvgRealTimeReceivingDataFactorForInterval:c,MinRealTimeReceivingDataFactorForInterval:l,MaxRealTimeReceivingDataFactorForInterval:u,AvgReceivingDataDurationForInterval:h,TotalTranscriptMessageCountInPreviousTimeInterval:this.m_totalTranscriptMessageCountInPreviousTimeInterval,AdjustedTimeInterval:this.m_intervalTranscript,HeartbeatRoundtripLatency:n,TranscriberID:this.m_transcriberId}))}this.m_totalTranscriptMessageCountInPreviousTimeInterval=this.m_totalTranscriptMessageCountInCurrentTimeInterval,this.m_totalTranscriptMessageCountInCurrentTimeInterval=0,this.m_realTimeReceiveDataFactorCountInTimeInterval=0,this.m_realTimeReceiveDataFactorSumInTimeInterval=0,this.m_minRealTimeReceiveDataFactorInTimeInterval=Number.MAX_VALUE,this.m_maxRealTimeReceiveDataFactorInTimeInterval=Number.MIN_VALUE,this.m_lastTranscriptLogUTC=Date.now(),this.resetTranscriptInterval()}},{key:"resetTranscriptInterval",value:function(){this.m_startLogIntervalTranscript<Number.MAX_VALUE&&(this.m_intervalTranscript=Date.now()-this.m_startLogIntervalTranscript),this.m_startLogIntervalTranscript=Date.now()}},{key:"onSessionEnd",value:function(){this.telemetryManager.recordAudioStatistics(this.m_audioFactorCalculationDuration,this.m_totalAudioFactorOutsideOfThresholdCount),this.telemetryManager.recordRealTimeReceiveFactorStats(this.m_totalTranscriptFactorOutsideOfThresholdCount,this.m_messageLatencyCalculationTime)}}]),e}(),oe=function e(){f()(this,e)};oe.HeartbeatInterval=5e3,oe.RoundtripLatencyWarnThreshold=500,oe.PongMessageReceieveMaxTimeout=oe.HeartbeatInterval+1e4,oe.NetworkPingPongWarningThresholdInMs=500,oe.NetworkPingPongErrorThresholdInMs=2e3,oe.NetworkPingPongMaxWarningCount=6,oe.NetworkPingPongMaxErrorCount=3,oe.NetworkQualityWarningPriority=10,oe.NetworkQualityErrorPriority=100,function(e){e[e.Normal=0]="Normal",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(re||(re={}));var se,ce,le=function(){function e(t,n){f()(this,e),this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.c_maxEntriesInLatencyTable=1200,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_pongMessageTimerId=0,this.m_isWaitingForPongResponse=!1,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0,this.events=new x.EventEmitter,ne=t,this.telemetryManager=n,this.m_realTimeFactorHandler=new ae(t,this.telemetryManager)}return v()(e,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"startSession",value:function(e){this.initialize(),this.m_transcriberId=e,this.m_realTimeFactorHandler.startSession(e),this.m_pongMessageTimerId=setInterval(this.checkForPongResponse.bind(this),oe.PongMessageReceieveMaxTimeout)}},{key:"resetMessageLatency",value:function(){this.m_messageLatencyTable={}}},{key:"initialize",value:function(){this.m_transcriberId="",this.m_heartbeatSendTime=0,this.m_currentHeartbeatSendInterval=0,this.m_gapNumberBetweenPingPongMessage=0,this.m_countRoundtripLatencyInWarnWindow=0,this.m_countRoundtripLatencyInErrorWindow=0,this.m_countFragmentLatencyInWarnWindow=0,this.m_countFragmentLatencyInErrorWindow=0,this.m_inFragmentLatencyWarnStatus=!1,this.m_inFragmentLatencyErrorStatus=!1,this.m_totalNetworkErrorMessageCount=0,this.m_totalNetworkWarningMessageCount=0,this.m_currentHeartbeatLatency=0,this.m_messageLatencyTable={},this.m_totalEntriesInLatencyTable=0,this.m_latencyTableDeletedCount=0,this.m_totalPartialMessagesCount=0,this.m_totalPartialMessageLatency=0,this.m_maxPartialMessageLatency=Number.MIN_VALUE,this.m_minPartialMessageLatency=Number.MAX_VALUE,this.m_totalHighLatencyPartialMessagesCount=0,this.m_maxFinalMessageLatency=Number.MIN_VALUE,this.m_minFinalMessageLatency=Number.MAX_VALUE,this.m_totalFinalMessagesCount=0,this.m_totalHighLatencyFinalMessagesCount=0,this.m_totalFinalMessageLatency=0,this.m_totalMessageCorrelationIDNotFoundCount=0,this.m_networkQualityWarningCount=0,this.m_networkQualityErrorCount=0,this.m_currentNetworkQualityStatus=0,this.m_frontdoorRoundTripLatencyCount=0,this.m_frontdoorTotalRoundTripLatency=0}},{key:"logRoundTripLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,RoundtripLatencyMS:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};ne.sendTraceTag(595716097,r.PptSession,y.Warning,JSON.stringify(n))}},{key:"logMessageLatencyInfo",value:function(e,t){var n={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,PartialMessageLatency:t,MessageCorrelationID:e,TranscriberID:this.m_transcriberId};ne.sendTraceTag(595716097,r.PptSession,y.Warning,JSON.stringify(n))}},{key:"calculateMessageLatencyStats",value:function(e,t){t>=ye.FragmentLatencyWarnThreshold?(this.m_countFragmentLatencyInWarnWindow=Math.min(ye.FragmentLatencyWarnWindow,this.m_countFragmentLatencyInWarnWindow+1),t>=ye.FragmentLatencyErrorThreshold?this.m_countFragmentLatencyInErrorWindow=Math.min(ye.FragmentLatencyErrorWindow,this.m_countFragmentLatencyInErrorWindow+1):this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)):(this.m_countFragmentLatencyInWarnWindow=Math.max(0,this.m_countFragmentLatencyInWarnWindow-1),this.m_countFragmentLatencyInErrorWindow=Math.max(0,this.m_countFragmentLatencyInErrorWindow-1)),t>=ye.FragmentLatencyWarnThreshold&&this.logMessageLatencyInfo(e,t)}},{key:"calculateRoundTripLatencyStats",value:function(e,t){t>=ye.RoundtripLatencyWarnThreshold?(this.m_countRoundtripLatencyInWarnWindow=Math.min(ye.FragmentLatencyWarnWindow,this.m_countRoundtripLatencyInWarnWindow+1),t>=ye.RoundtripLatencyErrorThreshold?this.m_countRoundtripLatencyInErrorWindow=Math.min(ye.FragmentLatencyErrorWindow,this.m_countRoundtripLatencyInErrorWindow+1):this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)):(this.m_countRoundtripLatencyInWarnWindow=Math.max(0,this.m_countRoundtripLatencyInWarnWindow-1),this.m_countRoundtripLatencyInErrorWindow=Math.max(0,this.m_countRoundtripLatencyInErrorWindow-1)),t>=ye.RoundtripLatencyWarnThreshold&&this.logRoundTripLatencyInfo(e,t)}},{key:"calculateNetworkQualityStats",value:function(e,t,n){var i=this.m_currentHeartbeatSendInterval>=ye.HeartbeatInterval+ye.RoundtripLatencyWarnThreshold,a=this.m_currentHeartbeatLatency>=ye.RoundtripLatencyWarnThreshold,o=!i&&a;this.m_countFragmentLatencyInErrorWindow>=ye.FragmentLatencyErrorWindow||this.m_countRoundtripLatencyInErrorWindow>=ye.FragmentLatencyErrorWindow?(this.m_inFragmentLatencyErrorStatus=!0,this.m_totalNetworkErrorMessageCount+=1):0===this.m_countFragmentLatencyInErrorWindow&&0===this.m_countRoundtripLatencyInErrorWindow&&(this.m_inFragmentLatencyErrorStatus=!1,this.m_gapNumberBetweenPingPongMessage=0),this.m_countFragmentLatencyInWarnWindow>=ye.FragmentLatencyWarnWindow||this.m_countRoundtripLatencyInWarnWindow>=ye.FragmentLatencyWarnWindow?(this.m_inFragmentLatencyWarnStatus=!0,this.m_totalNetworkWarningMessageCount+=1):0===this.m_countFragmentLatencyInWarnWindow&&0===this.m_countRoundtripLatencyInWarnWindow&&(this.m_inFragmentLatencyWarnStatus=!1);var s={CountFragmentLatencyInErrorWindow:this.m_countFragmentLatencyInErrorWindow,CountFragmentLatencyInWarnWindow:this.m_countFragmentLatencyInWarnWindow,CountRoundtripLatencyInErrorWindow:this.m_countRoundtripLatencyInErrorWindow,CountRoundtripLatencyInWarnWindow:this.m_countRoundtripLatencyInWarnWindow,PartialMessageLatency:t,RoundtripLatencyMS:n,MessageCorrelationID:e,TranscriberID:this.m_transcriberId,CurrentHearbeatSendInterval:this.m_currentHeartbeatSendInterval,CurrentHeartbeatLatency:this.m_currentHeartbeatLatency,IsHighHeartbeatLatency:a,IsBrowserFreeze:i,IsNetworkIssue:o};this.m_inFragmentLatencyErrorStatus?ne.sendTraceTag(595716098,r.PptSession,y.Error,JSON.stringify(s)):this.m_inFragmentLatencyWarnStatus&&ne.sendTraceTag(595716099,r.PptSession,y.Error,JSON.stringify(s))}},{key:"onPingMessageSent",value:function(e){this.m_isWaitingForPongResponse=!0;var t=0!==this.m_heartbeatSendTime?this.m_heartbeatSendTime:Date.now(),n=Date.now(),i=n-t;this.m_heartbeatSendTime=n,this.m_currentHeartbeatSendInterval=i;var a={RealHeartbeatSendInterval:i,PreHeartbeatSendTime:t,CurHeartbeatSendTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};if(i>oe.HeartbeatInterval+oe.RoundtripLatencyWarnThreshold?ne.sendTraceTag(595716173,r.PptSession,y.Warning,JSON.stringify(a)):ne.sendTraceTag(595716174,r.PptSession,y.Info,JSON.stringify(a)),this.m_gapNumberBetweenPingPongMessage>=2){var o=ye.NoInternetConnectionInMs;this.calculateRoundTripLatencyStats(e,o),this.calculateNetworkQualityStats(e,-1,o),ne.sendTraceTag(595716175,r.PptSession,y.Error,"Transcriber::startSpeechConnection Probably loss network connection: TranscriberID: ".concat(this.m_transcriberId," CorrelationID: ").concat(e)),this.telemetryManager.recordSpeechClientError(ve.LossInternetConnection,"gapNumberBetweenPingPongMessage :".concat(this.m_gapNumberBetweenPingPongMessage),Date.now(),!1)}this.m_gapNumberBetweenPingPongMessage+=1}},{key:"checkForPongResponse",value:function(){this.m_isWaitingForPongResponse&&this.updateNetworkQuality(re.Error)}},{key:"detectNetworkQuality",value:function(e){switch(e>=oe.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount<oe.NetworkPingPongMaxWarningCount?this.m_networkQualityWarningCount+=1:e<oe.NetworkPingPongWarningThresholdInMs&&this.m_networkQualityWarningCount>0&&(this.m_networkQualityWarningCount-=1),e>=oe.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount<oe.NetworkPingPongMaxErrorCount?this.m_networkQualityErrorCount+=1:e<oe.NetworkPingPongErrorThresholdInMs&&this.m_networkQualityErrorCount>0&&(this.m_networkQualityErrorCount-=1),this.m_currentNetworkQualityStatus){case re.Normal:this.m_networkQualityErrorCount===oe.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(re.Error):this.m_networkQualityWarningCount===oe.NetworkPingPongMaxWarningCount&&this.updateNetworkQuality(re.Warning);break;case re.Warning:this.m_networkQualityErrorCount===oe.NetworkPingPongMaxErrorCount?this.updateNetworkQuality(re.Error):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(re.Normal);break;case re.Error:0===this.m_networkQualityErrorCount&&this.m_networkQualityWarningCount>0?this.updateNetworkQuality(re.Warning):0===this.m_networkQualityErrorCount&&0===this.m_networkQualityWarningCount&&this.updateNetworkQuality(re.Normal)}}},{key:"updateNetworkQuality",value:function(e){if(this.m_currentNetworkQualityStatus!==e){this.m_currentNetworkQualityStatus=e;var t=0,n=0;switch(e){case re.Normal:t=0,n=h.None;break;case re.Warning:t=oe.NetworkQualityWarningPriority,n=h.Warning_SlowConnection;break;case re.Error:t=oe.NetworkQualityErrorPriority,n=h.Error_SlowConnection}var r={severity:0,priority:t,shortCode:n,longCode:0,shortString:"",longString:""};this.events.emit("qualityStatusUpdate",r)}}},{key:"onPongMessageReceived",value:function(e){var t;this.m_isWaitingForPongResponse=!1,this.m_gapNumberBetweenPingPongMessage-=1;var n=Date.now();t=n-this.m_heartbeatSendTime,this.calculateFrontDoorRoundTripLatency(e),this.m_currentHeartbeatLatency=t;var i={RoundtripLatency:t,HeartbeatSendTime:this.m_heartbeatSendTime,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};t>ye.RoundtripLatencyWarnThreshold?ne.sendTraceTag(595716113,r.PptSession,y.Warning,JSON.stringify(i)):ne.sendTraceTag(595716114,r.PptSession,y.Info,JSON.stringify(i)),this.calculateRoundTripLatencyStats(e,this.m_currentHeartbeatLatency),this.calculateNetworkQualityStats(e,-1,this.m_currentHeartbeatLatency)}},{key:"calculatePreMessageLatency",value:function(e){try{var t=Date.now();if(this.m_messageLatencyTable[e]=t,this.m_totalEntriesInLatencyTable+=1,this.m_totalEntriesInLatencyTable>this.c_maxEntriesInLatencyTable){for(var n in this.m_latencyTableDeletedCount+=1,this.m_messageLatencyTable)this.m_messageLatencyTable[n]<t-6e4&&(delete this.m_messageLatencyTable[n],this.m_totalEntriesInLatencyTable-=1);ne.sendTraceTag(595716171,r.PptSession,y.Info,"Transcriber::calculatePreMessageLatency Deleted all entries in the latency table older than 1 minute. Number of times entries in the latency table have surpassed allowed max: \n                ".concat(this.m_latencyTableDeletedCount," TranscriberID: ").concat(this.m_transcriberId))}}catch(e){ne.sendTraceTag(595716172,r.PptSession,y.Warning,"Transcriber::calculatePreMessageLatency Exception while calculating message latency ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePartialMessageLatency",value:function(e,t,n,i){var a=Date.now();if(this.m_totalPartialMessagesCount+=1,this.m_totalPartialMessageLatency+=n,this.m_maxPartialMessageLatency=Math.max(this.m_maxPartialMessageLatency,n),this.m_minPartialMessageLatency=Math.min(this.m_minPartialMessageLatency,n),n>ye.MaxAllowedFragmentLatencyMS&&(this.m_totalHighLatencyPartialMessagesCount+=1,!ye.IsLogEachTranscriptMessage)){var o=this.m_totalPartialMessageLatency/this.m_totalPartialMessagesCount;ne.sendTraceTag(595716101,r.PptSession,y.Warning,JSON.stringify({PartialMessageCount:this.m_totalPartialMessagesCount,PartialMessageLatency:n,MaxPartialMessageLatency:this.m_maxPartialMessageLatency,MinPartialMessageLatency:this.m_minPartialMessageLatency,AvePartialMessageLatency:o,TotalPartialMessageLatency:this.m_totalPartialMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:a,TotalHighLatencyPartialMessagesCount:this.m_totalHighLatencyPartialMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}this.calculateMessageLatencyStats(e,n),this.calculateRoundTripLatencyStats(e,t),this.calculateNetworkQualityStats(e,n,t)}},{key:"calculateFinalMessageLatency",value:function(e,t,n,i){var a=Date.now();if(this.m_totalFinalMessagesCount+=1,this.m_totalFinalMessageLatency+=n,this.m_maxFinalMessageLatency=Math.max(this.m_maxFinalMessageLatency,n),this.m_minFinalMessageLatency=Math.min(this.m_minFinalMessageLatency,n),n>ye.MaxAllowedFinalFragmentLatencyMS&&(this.m_totalHighLatencyFinalMessagesCount+=1,!ye.IsLogEachTranscriptMessage)){var o=this.m_totalFinalMessageLatency/this.m_totalFinalMessagesCount;ne.sendTraceTag(595716102,r.PptSession,y.Warning,JSON.stringify({FinalMessageCount:this.m_totalFinalMessagesCount,FinalMessageLatency:n,MaxFinalMessageLatency:this.m_maxFinalMessageLatency,MinFinalMessageLatency:this.m_minFinalMessageLatency,AveFinalMessageLatency:o,TotalFinalMessageLatency:this.m_totalFinalMessageLatency,MessageCorrelationID:e,MessageSentTime:i,CurrentTime:a,TotalHighLatencyFinalMessagesCount:this.m_totalHighLatencyFinalMessagesCount,HeartbeatRoundtripLatency:t,TranscriberID:this.m_transcriberId}))}for(var s in this.m_messageLatencyTable)this.m_messageLatencyTable[s]<=i&&(delete this.m_messageLatencyTable[s],this.m_totalEntriesInLatencyTable-=1)}},{key:"calculatePostMessageLatency",value:function(e,t,n){try{var i=Date.now(),a=0,o=this.m_messageLatencyTable[t];o?(a=Date.now()-o,e?this.calculateFinalMessageLatency(t,n,a,o):this.calculatePartialMessageLatency(t,n,a,o)):(this.m_totalMessageCorrelationIDNotFoundCount+=1,ne.sendTraceTag(595716103,r.PptSession,y.Warning,"calculatePostMessageLatency: correlationID: ".concat(t," was not present in the correlationID table. Total messages with the correlation id not found ").concat(this.m_totalMessageCorrelationIDNotFoundCount,"\n          TranscriberID: ").concat(this.m_transcriberId," isFinalMessage: ").concat(e))),this.m_realTimeFactorHandler.calculateAndLogRealTimeReceiveFactorStats(i,t,a,n,e)}catch(e){ne.sendTraceTag(595716107,r.PptSession,y.Warning,"calculatePostMessageLatency:Calculating the message latency threw an exception: ".concat(e," TranscriberID: ").concat(this.m_transcriberId))}}},{key:"calculatePreAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculatePreAudioMetrics(e)}},{key:"calculatePostAudioMessageStats",value:function(e){this.m_realTimeFactorHandler.calculateAndLogRealTimeSendFactorStats(e)}},{key:"isNetworkError",value:function(){return!!this.m_inFragmentLatencyErrorStatus&&(ne.sendTraceTag(595716115,r.PptSession,y.Warning,"SpeechHealthManager: Temporary network error"),this.telemetryManager.recordSpeechClientError(ve.TemporaryDisableSubtitleDueNetworkError,"Network error with error windows : ".concat(this.m_countFragmentLatencyInErrorWindow),Date.now(),!1),!0)}},{key:"stopSession",value:function(){this.m_pongMessageTimerId&&(clearInterval(this.m_pongMessageTimerId),this.m_pongMessageTimerId=0),this.m_realTimeFactorHandler.onSessionEnd();var e=this.m_frontdoorTotalRoundTripLatency/this.m_frontdoorRoundTripLatencyCount;this.telemetryManager.recordFrontdoorRoundTripLatency(e),this.telemetryManager.recordNetworkQuality(this.m_totalNetworkErrorMessageCount,this.m_totalNetworkWarningMessageCount),this.telemetryManager.recordMessageLatencyStats(this.m_totalMessageCorrelationIDNotFoundCount,this.m_latencyTableDeletedCount,this.m_totalEntriesInLatencyTable),this.telemetryManager.recordPartialMessageLatency(this.m_maxPartialMessageLatency,this.m_minPartialMessageLatency,this.m_totalPartialMessagesCount,this.m_totalHighLatencyPartialMessagesCount,this.m_totalPartialMessageLatency),this.telemetryManager.recordFinalMessageLatency(this.m_maxFinalMessageLatency,this.m_minFinalMessageLatency,this.m_totalFinalMessagesCount,this.m_totalHighLatencyFinalMessagesCount,this.m_totalFinalMessageLatency)}},{key:"calculateFrontDoorRoundTripLatency",value:function(e){var t=this.m_messageLatencyTable[e];if(t){var n=Date.now(),i=n-t,a={RoundtripLatency:i,HeartbeatSendTime:t,HeartbeatReceiveTime:n,TranscriberID:this.m_transcriberId,CorrelationID:e};ne.sendTraceTag(594032288,r.PptSession,y.Info,JSON.stringify(a)),this.m_frontdoorRoundTripLatencyCount+=1,this.m_frontdoorTotalRoundTripLatency+=i,this.detectNetworkQuality(i)}else ne.sendTraceTag(594346950,r.PptSession,y.Warning,"onPongMessageReceived: correlationID: ".concat(e," was not present in the correlationID table, TranscriberID: ").concat(this.m_transcriberId))}}]),e}();!function(e){e[e.SpeechRecognitionStarted=0]="SpeechRecognitionStarted",e[e.SpeechEnd=1]="SpeechEnd"}(ce||(ce={}));var ue=function e(){f()(this,e)};ue.ProcessVisionDataCommand="processVisionData",ue.HandleClientMetaData="handleClientMetaData";var he,me=function(){function e(t,n,r,i,a,o){var s=this;f()(this,e),this.speechRecognitionPaused=!1,this.telemetryManager={},this.webcamClient=null,this.speechHealthManager={},this.events=new x.EventEmitter,this.onText=function(e){if(s.speechClientObserver){var t=function(e){var t,n={},r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=E()(t.value,2),a=i[0],o=i[1];n[a]=o}}catch(e){r.e(e)}finally{r.f()}return n}(e.transcripts),n=s.getRecognitionResultMetadata(e.properties);e.isFinal?(s.speechClientObserver.onFinalText(e.transcripts,e.properties),s.speechClientObserver.onFinalRecognitionText&&s.speechClientObserver.onFinalRecognitionText(t,n),s.events.emit("FinalReceived")):(s.speechClientObserver.onFragmentText(e.transcripts,e.properties),s.speechClientObserver.onPartialRecognitionText&&s.speechClientObserver.onPartialRecognitionText(t,n))}},this.onErr=function(e){s.speechClientObserver&&s.speechClientObserver.onError(e)},this.onSpeechStatus=function(e,t){if(s.speechClientObserver)switch(e){case ce.SpeechRecognitionStarted:!s.speechRecognitionPaused&&s.speechClientObserver&&s.speechClientObserver.onSpeechRecognitionStarted&&(s.speechClientObserver.onSpeechRecognitionStarted(t),s.speechClientConfig.sendClientMetaDataOnSessionStart&&s.sendClientMetaData(t));break;case ce.SpeechEnd:s.speechClientObserver&&s.speechClientObserver.onSpeechEnd&&s.speechClientObserver.onSpeechEnd(),s.events.emit("SpeechEnd")}},this.onSpeechSessionStarted=function(e){s.speechClientObserver&&s.speechClientObserver.onSpeechSessionStarted&&s.speechClientObserver.onSpeechSessionStarted(e)},this.onAudioData=function(e){s.speechClientObserver&&s.speechClientObserver.onAudioData&&s.speechClientObserver.onAudioData(e)},this.onRehearsalUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:l.RehearsalDashboardUpdate,currentSlideIndex:e.currentSlideIndex,features:e.features};s.speechClientObserver.onEventUpdate(t)}e.isFinal&&s.events.emit("FinalReceived")},this.onQualityStatusUpdate=function(e){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var t={eventName:l.QualityStatusUpdate,severity:e.severity,priority:e.priority,shortCode:e.shortCode,longCode:e.longCode,shortString:e.shortString,longString:e.longString};s.speechClientObserver.onEventUpdate(t)}},this.onFrontDoorConnectionRetry=function(){if(s.speechClientObserver&&s.speechClientObserver.onEventUpdate){var e={eventName:l.ConnectionRetry};s.speechClientObserver.onEventUpdate(e)}},this.speechClientObserver=n,se=a,this.speechClientConfig=t,this.mediaSource=i||new z(this.speechClientConfig.speechProcessorScript,t.microphoneDeviceId),this.telemetryManager=new X(se),this.speechHealthManager=new le(se,this.telemetryManager),this.speechFrontDoorProxy=new Ce(this.speechClientConfig,r,o||new S,se,this.telemetryManager,this.speechHealthManager),this.startWebcamCapture(),this.registerSpeechFrontDoorEvents()}var t,n;return v()(e,[{key:"startSpeechRecognition",value:(n=R()(T.a.mark((function e(t){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryManager.recordSpeechClientConnectionStart(this.speechClientConfig),this.speechRecognitionPaused=!1,e.next=4,this.tryInitializeUserMedia();case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:this.speechFrontDoorProxy.startConnection(this.mediaSource,t||!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"startWebcamCapture",value:function(){this.speechClientConfig.webcamConfig&&(this.webcamClient?se.sendTraceTag(593019980,r.PptSession,y.Warning,"SpeechClient::startWebcamCapture webcam already exists"):this.webcamClient=new $(this.speechClientConfig.webcamConfig,this.onWebcamFrame.bind(this)))}},{key:"stopWebcamCapture",value:function(){this.webcamClient&&(this.webcamClient.stopMediaCapture(),this.webcamClient=null)}},{key:"resumeWebcamCapture",value:function(){if(this.webcamClient)if(this.speechClientConfig.captureAudioPauseResumeRecordingState){this.webcamClient.startMediaCapture();var e={eventName:l.MediaEvent,mediaStatus:u.VideoSetupCompleted};this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(e)}else this.webcamClient.resumeMediaCapture()}},{key:"pauseWebcamCapture",value:function(){this.webcamClient&&(this.speechClientConfig.captureAudioPauseResumeRecordingState?this.webcamClient.stopMediaCapture():this.webcamClient.pauseMediaCapture())}},{key:"stopSpeechRecognition",value:function(){var e=this;if(this.speechClientConfig.handleEndOfAudioInSpeechClientStopRecognition){this.sendEndOfAudio();var t=new Promise((function(e,t){setTimeout(e,5e3,c.WaitForSpeechEndTimeout)})),n=new Promise((function(t,n){e.events.on("SpeechEnd",t)}));Promise.race([t,n]).then((function(t){e.closeConnectionInternal(),e.speechClientObserver&&e.speechClientObserver.onSpeechRecognitionStopped&&(t?e.speechClientObserver.onSpeechRecognitionStopped(String(t)):e.speechClientObserver.onSpeechRecognitionStopped(c.Normal))}))}else this.mediaSource.stopAudioCapture(),this.closeConnectionInternal(),this.speechClientObserver&&this.speechClientObserver.onSpeechRecognitionStopped&&this.speechClientObserver.onSpeechRecognitionStopped(c.Normal)}},{key:"closeConnectionInternal",value:function(){this.speechFrontDoorProxy.stopConnection(),this.speechRecognitionPaused=!1}},{key:"sendEndOfAudio",value:function(){this.speechFrontDoorProxy.onSendEndOfAudio(),this.mediaSource.stopAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","endOfAudio"]]))}},{key:"pauseSpeechRecognition",value:function(){this.speechRecognitionPaused=!0,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.stopAudioCapture():this.mediaSource.pauseAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","pause"]])),this.speechFrontDoorProxy.pauseSpeechRecognition()}},{key:"resumeSpeechRecognition",value:function(){this.speechRecognitionPaused=!1,this.speechClientConfig.captureAudioPauseResumeRecordingState?this.mediaSource.startAudioCapture():this.mediaSource.resumeAudioCapture(),this.sendDictionaryRequestMessage(new Map([["command","resume"]])),this.speechFrontDoorProxy.resumeSpeechRecognition()}},{key:"setCustomSetting",value:function(e,t){this.speechFrontDoorProxy.setCustomSetting(e,t)}},{key:"getCustomSetting",value:function(e){return this.speechFrontDoorProxy.getCustomSetting(e)}},{key:"enableVoiceStreaming",value:function(){this.speechFrontDoorProxy.enableVoiceStreaming()}},{key:"disableVoiceStreaming",value:function(){this.speechFrontDoorProxy.disableVoiceStreaming()}},{key:"sendDictionaryRequestMessage",value:function(e){this.sendClientRequestMessage(U.fromMap(e))}},{key:"sendGenericRequestMessage",value:function(e,t){this.sendClientRequestMessage(new U(e,t))}},{key:"sendClientRequestMessage",value:function(e){this.speechFrontDoorProxy.sendClientRequestMessage(e)}},{key:"getRecognitionResultMetadata",value:function(e){var t={};return e.size>0&&e.forEach((function(e,n){if(e)if("JsonResult"===n){var i=JSON.parse(e);t.id=i.Id,t.duration=i.Duration,t.offset=i.Offset,t.properties=JSON.parse(e)}else null===t.properties||void 0===t.properties?t.properties={key:e}:t.properties[n]=e;else se.sendTraceTag(592229530,r.PptSession,y.Info,"SpeechClient::getRecognitionResultMetadata value is null for key: ".concat(n," }"))})),t}},{key:"tryInitializeUserMedia",value:(t=R()(T.a.mark((function e(){var t,n,r,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mediaSource.startAudioCapture();case 3:if((t=e.sent)!==s.ErrorNone){e.next=9;break}n={eventName:l.MediaEvent,mediaStatus:u.AudioDeviceConnected},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(n),e.next=12;break;case 9:return this.onErr(t),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,t,Date.now(),!1),e.abrupt("return",!1);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(0),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorAudio".concat(e.t0.name)),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,"ErrorAudio".concat(e.t0.name),Date.now(),!1),e.abrupt("return",!1);case 19:if(!this.webcamClient){e.next=39;break}return e.prev=20,e.next=23,this.webcamClient.startMediaCapture();case 23:if((r=e.sent)!==s.ErrorNone){e.next=29;break}i={eventName:l.MediaEvent,mediaStatus:u.VideoSetupCompleted},this.speechClientObserver&&this.speechClientObserver.onEventUpdate&&this.speechClientObserver.onEventUpdate(i),e.next=32;break;case 29:return this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(r)),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,r,Date.now(),!1),e.abrupt("return",!1);case 32:e.next=39;break;case 34:return e.prev=34,e.t1=e.catch(20),this.speechClientObserver&&this.speechClientObserver.onError&&this.speechClientObserver.onError("ErrorVideo".concat(e.t1.name)),this.telemetryManager.recordSpeechClientError(ve.GetUserMediaFailed,"ErrorVideo".concat(e.t1.name),Date.now(),!1),e.abrupt("return",!1);case 39:return e.abrupt("return",!0);case 40:case"end":return e.stop()}}),e,this,[[0,14],[20,34]])}))),function(){return t.apply(this,arguments)})},{key:"registerSpeechFrontDoorEvents",value:function(){var e=this;this.speechFrontDoorProxy.on("text",(function(t){e.onText(t)})),this.speechFrontDoorProxy.on("error",(function(t){e.onErr(t)})),this.speechFrontDoorProxy.on("speechStatus",(function(t,n){e.onSpeechStatus(t,n)})),this.speechFrontDoorProxy.on("speechSessionStarted",(function(t){e.onSpeechSessionStarted(t)})),this.speechFrontDoorProxy.on("audioData",(function(t){e.onAudioData(t)})),this.speechFrontDoorProxy.on("rehearsalUpdate",(function(t){e.onRehearsalUpdate(t)})),this.speechFrontDoorProxy.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)})),this.speechFrontDoorProxy.on("webSocketConnectionRetry",(function(){e.onFrontDoorConnectionRetry()})),this.speechHealthManager.on("qualityStatusUpdate",(function(t){e.onQualityStatusUpdate(t)}))}},{key:"sendClientMetaData",value:function(e){var t=new Map;t.set("command",ue.HandleClientMetaData),t.set("data",JSON.stringify(this.speechFrontDoorProxy.getClientMetaDataMap())),t.set("speechMode",this.speechClientConfig.speechMode),t.set("SessionId",e),this.sendDictionaryRequestMessage(t)}},{key:"onWebcamFrame",value:function(e,t){var n={clientSentTimeMS:Date.now(),clientSessionSentTimeMS:this.speechFrontDoorProxy.getElapsedSessionTimeInMS()},r=new Map;r.set("command",ue.ProcessVisionDataCommand),r.set("data",e),r.set("correlation",t||""),r.set("operationMetadata",JSON.stringify(n)),this.sendDictionaryRequestMessage(r)}}]),e}(),de=n(40);function pe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ge=function e(){f()(this,e)};ge.AudioFactorCalculationDurationMS="AudioFactorCalculationDurationMS",ge.BufferSize="BufferSize",ge.CustomEndpointEnabled="CustomEndpointEnabled",ge.CustomEndpointRequestCorrelationID="CustomEndpointRequestCorrelationID",ge.CurrentTimestampMS="CurrentTimestampMS",ge.DataLoggingTimeInterval="DataLoggingTimeInterval",ge.Endpoint="Endpoint",ge.FatalErrors="FatalErrors",ge.FirstMessageLatencyMS="FirstMessageLatencyMS",ge.InitializeWebSocketEndTimeMS="InitializeWebSocketEndTimeMS",ge.InitializeWebSocketStartTimeMS="InitializeWebSocketStartTimeMS",ge.LatencyTableDeletedCount="LatencyTableDeletedCount",ge.MaxFinalMessageLatencyMS="MaxFinalMessageLatencyMS",ge.MaxPartialMessageLatencyMS="MaxPartialMessageLatencyMS",ge.MessageLatencyCalculationTimeMS="MessageLatencyCalculationTimeMS",ge.MinFinalMessageLatencyMS="MinFinalMessageLatencyMS",ge.MinPartialMessageLatencyMS="MinPartialMessageLatencyMS",ge.NonFatalErrors="NonFatalErrors",ge.OnGetUserMediaSuccessEntryPoint="OnGetUserMediaSuccessEntryPoint",ge.RealTimeFactorLowerThreshold="RealTimeFactorLowerThreshold",ge.RealTimeFactorUpperThreshold="RealTimeFactorUpperThreshold",ge.RequestCustomEndpointEndTimeMS="RequestCustomEndpointEndTimeMS",ge.RequestCustomEndpointFailedEndTimeMS="RequestCustomEndpointFailedEndTimeMS",ge.RequestCustomEndpointStartTimeMS="RequestCustomEndpointStartTimeMS",ge.RequestCustomEndpointTimedOutEndTimeMS="RequestCustomEndpointTimedOutEndTimeMS",ge.SendFirstMessageTime="SendFirstMessageTime",ge.SpeechLanguage="SpeechLanguage",ge.TotalAudioFactorOutsideOfThresholdCount="TotalAudioFactorOutsideOfThresholdCount",ge.TotalEntriesInLatencyTable="TotalEntriesInLatencyTable",ge.TotalFinalMessagesCount="TotalFinalMessagesCount",ge.TotalFinalMessageLatency="TotalFinalMessageLatency",ge.TotalHighLatencyPartialMessagesCount="TotalHighLatencyPartialMessagesCount",ge.TotalHighLatencyFinalMessagesCount="TotalHighLatencyFinalMessagesCount",ge.TotalMessageCorrelationIDNotFoundCount="TotalMessageCorrelationIDNotFoundCount",ge.TotalNetworkErrorMessageCount="TotalNetworkErrorMessageCount",ge.TotalNetworkWarningMessageCount="TotalNetworkWarningMessageCount",ge.AverageFrontDoorRoundTripLatencyCount="AverageFrontDoorRoundTripLatencyCount",ge.TotalPartialMessageLatency="TotalPartialMessageLatency",ge.TotalPartialMessagesCount="TotalPartialMessagesCount",ge.TotalTranscriptOutsideOfThresholdCount="TotalTranscriptOutsideOfThresholdCount",ge.TranscriberID="TranscriberID",ge.TranscriptionEntryPointCalled="TranscriptionEntryPointCalled",ge.TranscriptionStartTime="TranscriptionStartTime",ge.TranscriptionEndTime="TranscriptionEndTime",ge.TranslationLanguage="TranslationLanguage",ge.WebSocketClosedTimestamp="WebSocketClosedTimestamp",ge.WebSocketConnectionDurationMS="WebSocketConnectionDurationMS",ge.WebSocketCreateTimestamp="WebSocketCreateTimestamp",ge.WebSocketCustomEndpoint="WebSocketCustomEndpoint",ge.WebSocketOpenedTimestamp="WebSocketOpenedTimestamp",ge.WebSocketRetryAttempts="WebSocketRetryAttempts",ge.WebSocketRetryReason="WebSocketRetryReason",ge.FEnableContentlogging="FEnableContentlogging",ge.SpeechMode="SpeechMode",ge.SpeechClientRecognitionStartTime="SpeechClientConnectionStartTime";var ve=function e(){f()(this,e)};ve.CustomEndpointClientError="CustomEndpointClientError",ve.CustomEndpointClientFailureReason="CustomEndpointClientFailureReason",ve.CustomEndpointServerError="CustomEndpointServerError",ve.CustomEndpointServerErrorCode="CustomEndpointServerErrorCode",ve.CustomEndpointServerFailureReason="CustomEndpointServerFailureReason",ve.ErrorStatus="ErrorStatus",ve.InvalidDocId="InvalidDocId",ve.MessageErrorCode="MessageErrorCode",ve.TranscriptErrorCode="TranscriptErrorCode",ve.WebSocketDisconnected="WebSocketDisconnected",ve.WebSocketErrorCode="WebSocketErrorCode",ve.WebSocketRetryConnectionFailed="WebSocketRetryConnectionFailed",ve.InitializeAudioContextFailed="InitializeAudioContextFailed",ve.InitializeTranscriberSessionFailed="InitializeTranscriberSessionFailed",ve.GetUserMediaFailed="GetUserMediaFailed",ve.ReadSettingsFailed="ReadSettingsFailed",ve.DisplayQualityStatusException="DisplayQualityStatusException",ve.TemporaryDisableSubtitleDueNetworkError="TemporaryDisableSubtitleDueNetworkError",ve.LossInternetConnection="LossInternetConnection";var ye=function e(){f()(this,e)};ye.MaxAllowedFragmentLatencyMS=5e3,ye.MaxAllowedFinalFragmentLatencyMS=2e4,ye.DefaultBufferSize=8192,ye.DataLoggingIntervalMS=3e4,ye.RetryEnabled=!0,ye.RealTimeFactorLowerThreshold=0,ye.RealTimeFactorUpperThreshold=999,ye.IsLogEachTranscriptMessage=!0,ye.IsContentLoggingEnabled=!1,ye.CustomEndpointRequestTimeoutInMs=5e3,ye.HeartbeatInterval=5e3,ye.RoundtripLatencyWarnThreshold=500,ye.RoundtripLatencyErrorThreshold=2500,ye.FragmentLatencyWarnThreshold=2e4,ye.FragmentLatencyErrorThreshold=3e4,ye.MaxAllowedRetryCountPerSession=15,ye.FragmentLatencyWarnWindow=6,ye.FragmentLatencyErrorWindow=3,ye.NoInternetConnectionInMs=12e4,ye.MessageType="mix",ye.SpeechFDBase="wss://pptservicescast.officeapps.live.com/";var Ce=function(e){I()(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return D()(this,n)}}(n);function n(e,r,i,a,o,s){var c;return f()(this,n),(c=t.call(this)).m_wsUri="",c.m_webSocketConnectionRetryAttempts=-1,c.m_webSocketTotalRetryCountInSession=-1,c.c_maxWebSocketRetryAttempts=5,c.c_websocketRetryInterval=5e3,c.m_wsTimer=0,c.m_sessionTimer=new ie,c.m_transcriberId="",c.m_isFirstWebSocketConnection=!0,c.m_roundLatencyTimerId=0,c.m_sendPingMessageFlag=!1,c.m_fSendClientMetadata=!0,c.m_endpointId=null,c.telemetryManager={},c.speechHealthManager={},c.webSocket=null,c.customSettingsMap=new Map,c.disableStreaming=!1,c.events=new x.EventEmitter,c.generatedUserSessionId=Object(G.v4)(),c.m_fSessionPaused=!1,c.m_fEndOfAudioSent=!1,he=a,c.speechConfig=e,c.authProvider=r,c.webSocketFactory=i,c.telemetryManager=o,c.speechHealthManager=s,c}return v()(n,[{key:"on",value:function(e,t){return this.events.on(e,t),this}},{key:"onSendEndOfAudio",value:function(){this.m_fEndOfAudioSent=!0}},{key:"setCustomSetting",value:function(e,t){this.customSettingsMap.set(e,t)}},{key:"getCustomSetting",value:function(e){return this.customSettingsMap.get(e)}},{key:"enableVoiceStreaming",value:function(){this.disableStreaming=!1,this.m_sessionTimer.resume(),he.sendTraceTag(595632129,r.PptSession,y.Info,"Voice streaming is enabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"disableVoiceStreaming",value:function(){this.disableStreaming=!0,this.m_sessionTimer.pause(),he.sendTraceTag(595632130,r.PptSession,y.Info,"Voice streaming is disabled: TranscriberID: ".concat(this.m_transcriberId))}},{key:"pauseSpeechRecognition",value:function(){this.speechHealthManager.resetMessageLatency(),this.m_fSessionPaused=!0,this.m_sessionTimer.pause()}},{key:"resumeSpeechRecognition",value:function(){this.m_fSessionPaused=!1,this.m_sessionTimer.resume()}},{key:"getElapsedSessionTimeInMS",value:function(){return this.m_sessionTimer.getElapsedSessionTimeInMS()}},{key:"startConnection",value:function(e,t){this.telemetryManager.recordSpeechRecognitionStart(),this.initialize();var n=Object(G.v4)();he.sendTraceTag(595126293,r.PptSession,y.Info,"Start speech connection: TranscriberID: ".concat(n)),this.disableStreaming=t,this.disableStreaming&&he.sendTraceTag(595632131,r.PptSession,y.Info,"Voice streaming is disabled: TranscriberID: ".concat(n));var i=ye.DefaultBufferSize;isNaN(i)||(ye.DefaultBufferSize=i),this.speechConfig.documentDownloadConfig&&!this.speechConfig.requestServiceCustomEndpoint?(he.sendTraceTag(595716118,r.PptSession,y.Info,JSON.stringify({EnableCustomEndpoint:this.speechConfig.documentDownloadConfig||!1,TranscriberID:n})),this.configureCustomEndpointRequest(e,n)):this.startSpeechConnection(e,n),this.speechHealthManager.startSession(n),this.m_sessionTimer.restart(!this.disableStreaming)}},{key:"initialize",value:function(){this.m_webSocketConnectionRetryAttempts=-1,this.m_webSocketTotalRetryCountInSession=-1,clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_transcriberId="",this.m_isFirstWebSocketConnection=!0,this.m_sendPingMessageFlag=!1,this.m_endpointId=""}},{key:"stopConnection",value:function(){try{this.speechHealthManager.stopSession(),this.telemetryManager.recordSpeechClientConnectionEnd(this.m_transcriberId),this.telemetryManager.recordWebSocketRetryCounts(this.m_webSocketTotalRetryCountInSession),this.telemetryManager.publishSessionTelemetry(),this.m_sessionTimer.stop()}catch(e){he.sendTraceTag(595716045,r.PptSession,y.Info,"Transcriber::stopFrontdoorConnection threw an exception:".concat(e,"TranscriberID: ").concat(this.m_transcriberId))}this.closeWebSocket(),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.removeAllListeners()}},{key:"sendClientRequestMessage",value:function(e){if(this.webSocket)if(this.webSocket.readyState===m.Open)try{this.webSocket.send(e.serializeBinary())}catch(e){he.sendTraceTag(595711878,r.PptSession,y.Error,"sendClientRequestMessage threw an exception:".concat(e,". TranscriberID: ").concat(this.m_transcriberId))}else he.sendTraceTag(595711877,r.PptSession,y.Info,"Cannot send client request message because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else he.sendTraceTag(595711876,r.PptSession,y.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"logTranscriberErrorTelemetry",value:function(e){e[ge.TranscriberID]=this.m_transcriberId,e[ge.CurrentTimestampMS]=Date.now(),he.sendTraceTag(595716049,r.PptSession,y.Error,JSON.stringify(e))}},{key:"setTranscriptionResult",value:function(e){this.events.emit("text",e)}},{key:"setTranscriptionErrorText",value:function(e){this.events.emit("error",e)}},{key:"triggerSpeechStatusEvent",value:function(e){this.events.emit("speechStatus",e,this.m_transcriberId)}},{key:"triggerAudioDataEvent",value:function(e){this.events.emit("audioData",e)}},{key:"triggerRehearsalUpdate",value:function(e){var t=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(t,e.correlationId,-1),this.events.emit("rehearsalUpdate",e)}},{key:"triggerQualityStatusUpdate",value:function(e){this.events.emit("qualityStatusUpdate",e)}},{key:"triggerFrontdoorConnectionRetryEvent",value:function(){this.events.emit("webSocketConnectionRetry")}},{key:"triggerSpeechSessionStarted",value:function(e){this.events.emit("speechSessionStarted",e)}},{key:"processAudioChunk",value:function(e,t){if(!this.disableStreaming&&!this.m_fSessionPaused)if(this.webSocket)if(this.webSocket.readyState===m.Open){var n=Date.now(),i=new H;i.correlationId=t||Object(G.v4)(),this.speechHealthManager.calculatePreMessageLatency(i.correlationId),this.triggerAudioDataEvent(new Int16Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/2)));var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);i.audio=a,i.sourceLanguage=this.speechConfig.sourceLanguage,i.settings.set("targetLanguageList",this.speechConfig.targetLanguages);var o,s=pe(this.customSettingsMap);try{for(s.s();!(o=s.n()).done;){var c=E()(o.value,2),l=c[0],u=c[1];"clientMetadata"===l&&(this.m_fSendClientMetadata=!0),i.settings.set(l,u)}}catch(e){s.e(e)}finally{s.f()}this.speechConfig.documentDownloadConfig&&this.m_endpointId&&i.settings.set("endpointId",this.m_endpointId),this.m_fSendClientMetadata&&(this.m_fSendClientMetadata=!1,i.setClientMetaData(this.getClientMetaDataMap())),this.m_sendPingMessageFlag&&(i.settings.set("isPingMessage","true"),this.m_sendPingMessageFlag=!1,this.speechHealthManager.onPingMessageSent(i.correlationId)),this.speechConfig.properties&&i.setProperties(this.speechConfig.properties),i.setOperationMetadata(Date.now(),this.m_sessionTimer.getElapsedSessionTimeInMS());var h=i.serializeBinary();this.telemetryManager.recordInitialAudioMessage(),this.speechHealthManager.calculatePreAudioMessageStats(n),this.webSocket.send(h),this.speechHealthManager.calculatePostAudioMessageStats(i.correlationId)}else he.sendTraceTag(595716170,r.PptSession,y.Info,"Cannot send audio data because WebSocket not open. WebSocketReadyState: ".concat(this.webSocket.readyState," TranscriberID: ").concat(this.m_transcriberId));else he.sendTraceTag(595716169,r.PptSession,y.Info,"WebSocket is null. TranscriberID: ".concat(this.m_transcriberId))}},{key:"enablePingMessage",value:function(){this.m_sendPingMessageFlag||(this.m_sendPingMessageFlag=!0)}},{key:"startSpeechConnection",value:function(e,t){this.m_transcriberId=t;var n=Object(G.v4)(),r=this.speechConfig.speechFDBase||ye.SpeechFDBase,i=this.speechConfig.clientType||o.web,s="".concat(r,"SpeechHandler.ashx?action=Transcribe&client=").concat(i,"&session=").concat(this.m_transcriberId,"&message=").concat(ye.MessageType,"&speechMode=").concat(this.speechConfig.speechMode,"&sampleRate=").concat(e.sampleRate,"&app=").concat(this.speechConfig.clientApp||a.PowerPoint,"&locale=").concat(this.speechConfig.sourceLanguage,"&contenttype=url&requestcorrelationid=").concat(n);if(this.speechConfig.scenarioName&&(s+="&scenarioName=".concat(this.speechConfig.scenarioName)),this.speechConfig.requestServiceCustomEndpoint&&(s+="&fCreateCustomEndpoint=".concat(this.speechConfig.requestServiceCustomEndpoint)),this.speechConfig.documentDownloadConfig){var c=this.sanitizeDocID(this.speechConfig.documentDownloadConfig.docId,t);s+="&PodSID=".concat(this.speechConfig.documentDownloadConfig.podsSessionId)+"&podurl=".concat(this.speechConfig.documentDownloadConfig.webServiceBase)+"&wacuserdatacluster=".concat(this.speechConfig.documentDownloadConfig.userDataCenterClusterId)+"&docid=".concat(c)}this.telemetryManager.recordWebSocketConnectionStart(r,t),this.m_wsUri=s,e.onaudioprocess=this.processAudioChunk.bind(this),this.openWebSocketConnection(),this.m_roundLatencyTimerId=0,this.m_sendPingMessageFlag=!1,this.telemetryManager.recordWebSocketConnectionEnd()}},{key:"sanitizeDocID",value:function(e,t){var n="";if(0===e.length)return n;var i=e.indexOf("access_token");return-1===i?he.sendTraceTag(573309463,r.PptSession,y.Warning,"Transcriber::startSpeechConnection access_token was not found in docID. TranscriberID: ".concat(t)):n=e.substring(0,i),n}},{key:"handleWebSocketOpenEvent",value:function(){this.m_roundLatencyTimerId=setInterval(this.enablePingMessage.bind(this),ye.HeartbeatInterval),this.m_isFirstWebSocketConnection&&(this.telemetryManager.recordWebSocketConnectionOpen(),this.m_isFirstWebSocketConnection=!1),clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.m_webSocketConnectionRetryAttempts=0,this.m_fSendClientMetadata=!0,this.triggerSpeechStatusEvent(ce.SpeechRecognitionStarted)}},{key:"handleRehearsalUpdate",value:function(e){this.triggerRehearsalUpdate(e)}},{key:"handleQualityStatusUpdate",value:function(e){this.triggerQualityStatusUpdate(e)}},{key:"handleTranscriptResultMessage",value:function(e){if(this.telemetryManager.recordInitialMessageLatency(),"success"===e.status){if(e.isPong)return void this.speechHealthManager.onPongMessageReceived(e.correlationId);var t=e.correlationId;this.setTranscriptionResult(e);var n=e.isFinal;this.speechHealthManager.calculatePostMessageLatency(n,t,-1)}else if("speechEnd"===e.status)this.triggerSpeechStatusEvent(ce.SpeechEnd);else if("nomatch"===e.status||"notranslation"===e.status){var r=e.messageErrorCode;switch(null!=r&&""!==r||(r="ErrorUnknown"),e.transcriptErrorCode){case"NoMatchReason:NotRecognized":break;case"NoMatchReason:InitialBabbleTimeout":this.setTranscriptionErrorText("ErrorInitialBabbleTimeout");break;case"NoMatchReason:InitialSilenceTimeout":this.setTranscriptionErrorText("ErrorInitialSilenceTimeout");break;case"NoMatchReason:KeywordNotRecognized":break;default:this.handleOnMessageTranscriptionError(e)}}else this.handleOnMessageTranscriptionError(e)}},{key:"handleOnMessageTranscriptionError",value:function(e){try{null==e&&he.sendTraceTag(595716051,r.PptSession,y.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"\n           Response received from speech service was null."));var t=e.messageErrorCode;null!=t&&""!==t||(t="Unknown");var n=e.transcriptErrorCode;-1===["ErrorProtobufDeserializationFailure","ErrorInvalidSubscriptionFromConfig","ErrorInvalidRegionFromConfig","ErrorAddSessionFailure","ErrorInvalidMessage","ErrorCreateSpeechSessionBadRequest","ErrorWaitAudioTimeout","ErrorSpeechHandlerWebSocketFailure","ErrorSpeechRecognitionFailure","ErrorTranslationFailure","ErrorFailedToGetSupportedTextLanguages","ErrorCustomEndpointTimeout"].indexOf(t)?this.telemetryManager.recordSpeechClientError(t,"".concat(n,"_").concat(e.status),Date.now(),!1):this.telemetryManager.recordSpeechClientError(t,"",Date.now(),!0),this.setTranscriptionErrorText(t);var i={};i[ve.MessageErrorCode]=t,i[ve.TranscriptErrorCode]=n,i[ve.ErrorStatus]=e.status,this.logTranscriberErrorTelemetry(i)}catch(e){he.sendTraceTag(595716052,r.PptSession,y.Warning,"Transcriber::handleOnMessageTranscriptionError TranscriberID".concat(this.m_transcriberId,"Exception thrown: ").concat(e))}}},{key:"handleSpeechResultMessage",value:function(e){this.handleTranscriptResultMessage(e)}},{key:"handleSpeechSessionStartedMessage",value:function(e){this.triggerSpeechSessionStarted(e)}},{key:"handleRehearsalResultMessage",value:function(e){this.handleRehearsalUpdate(e)}},{key:"handleQualityStatusMessage",value:function(e){this.handleQualityStatusUpdate(e)}},{key:"handleWebSocketMessage",value:function(e){q(e,this)}},{key:"handleWebSocketCloseEvent",value:function(e){if(this.closeIntervalTimer(),1e3!==e){var t={};t[ve.WebSocketErrorCode]=e,t[ge.WebSocketRetryReason]="WebSocketDisconnected",this.logTranscriberErrorTelemetry(t),this.telemetryManager.recordWebsocketCloseError(e),ye.RetryEnabled&&this.retryWebSocketConnectionWrapper()}}},{key:"openWebSocketConnection",value:function(){this.m_webSocketTotalRetryCountInSession+=1,this.m_webSocketConnectionRetryAttempts+=1,this.m_isFirstWebSocketConnection&&0===this.m_webSocketTotalRetryCountInSession&&this.telemetryManager.recordWebSocketCreation(),this.webSocket&&(he.sendTraceTag(595716109,r.PptSession,y.Warning,"Transcriber::OpenWebSocketConnection Found existing web socket connection. Closing it and will open a new one. TranscriberID: ".concat(this.m_transcriberId)),this.closeWebSocket()),this.webSocket=this.webSocketFactory.createWebSocket(this.m_wsUri),{}[ge.WebSocketRetryReason]="WebSocketConnectionTimeout",ye.RetryEnabled&&this.retryWebSocketConnectionWrapper(),this.webSocket.onopen=this.handleWebSocketOpenEvent.bind(this),this.webSocket.onmessage=this.handleWebSocketMessage.bind(this),this.webSocket.onclose=this.handleWebSocketCloseEvent.bind(this)}},{key:"retryWebSocketConnection",value:function(){if(clearTimeout(this.m_wsTimer),this.m_wsTimer=0,this.speechHealthManager.resetMessageLatency(),!this.m_fEndOfAudioSent){if(!this.shouldRetryConnection())return clearTimeout(this.m_wsTimer),this.m_wsTimer=0,void this.closeWebSocket();he.sendTraceTag(595716056,r.PptSession,y.Info,"Transcriber::RetryWebSocketConnection - WebSocket retry attempt: ".concat(this.m_webSocketConnectionRetryAttempts,"\n        TranscriberID: ").concat(this.m_transcriberId)),this.closeWebSocket(),this.triggerFrontdoorConnectionRetryEvent(),this.openWebSocketConnection()}}},{key:"retryWebSocketConnectionWrapper",value:function(){0===this.m_wsTimer&&(this.m_wsTimer=setTimeout(this.retryWebSocketConnection.bind(this),this.c_websocketRetryInterval))}},{key:"configureCustomEndpointRequest",value:function(e,t){var n=this;this.speechConfig.documentDownloadConfig&&Se({docId:this.speechConfig.documentDownloadConfig.docId,speechFrontDoorBase:this.speechConfig.speechFDBase||ye.SpeechFDBase,podUrl:this.speechConfig.documentDownloadConfig.webServiceBase,podSessionId:this.speechConfig.documentDownloadConfig.podsSessionId,speechLanguage:this.speechConfig.sourceLanguage,isContentLoggingEnabled:ye.IsContentLoggingEnabled,CustomEndpointRequestTimeoutInMs:ye.CustomEndpointRequestTimeoutInMs,transcriberID:t,logger:he,telemetryManager:this.telemetryManager,userDataCenterClusterId:this.speechConfig.documentDownloadConfig.userDataCenterClusterId,userSessionId:this.speechConfig.userSessionId||this.generatedUserSessionId,speechMode:this.speechConfig.speechMode,clientApp:this.speechConfig.clientApp||a.PowerPoint}).then((function(r){n.m_endpointId=r.customEndpointID,""===n.m_transcriberId&&n.startSpeechConnection(e,t)})).catch((function(r){n.telemetryManager.recordSpeechClientError(r.recordErrorCode,r.recordErrorReason,Date.now(),!1),n.logTranscriberErrorTelemetry(r.errorInfo),""===n.m_transcriberId&&n.startSpeechConnection(e,t)}))}},{key:"getClientMetaDataMap",value:function(){var e,t=pe(this.customSettingsMap);try{for(t.s();!(e=t.n()).done;){var n=E()(e.value,2),r=n[0],i=n[1];if("clientMetadata"===r){Object(de.isNullOrUndefined)(this.speechConfig.clientMetaData)&&(this.speechConfig.clientMetaData=new Map);for(var o=JSON.parse(i),s=0,c=Object.keys(o);s<c.length;s++){var l=c[s];this.speechConfig.clientMetaData.set(l,o[l])}}}}catch(e){t.e(e)}finally{t.f()}var u=this.speechConfig.clientApp||a.PowerPoint,h={supportedResponseTypes:"speechresultmixmessage,qualitystatusmixmessage,rehearsalresultmixMessage,speechSessionStartedMixMessage",authorization:this.authProvider.accessToken};if(Object(de.isNullOrUndefined)(u)||(h.app=u),!Object(de.isNullOrUndefined)(this.speechConfig.clientMetaData)){var m,d=pe(this.speechConfig.clientMetaData);try{for(d.s();!(m=d.n()).done;){var p=E()(m.value,2),f=p[0],g=p[1];h[f]=g}}catch(e){d.e(e)}finally{d.f()}}return h}},{key:"closeIntervalTimer",value:function(){0!==this.m_roundLatencyTimerId&&(clearInterval(this.m_roundLatencyTimerId),this.m_roundLatencyTimerId=0)}},{key:"closeWebSocket",value:function(){this.webSocket&&(this.closeIntervalTimer(),this.webSocket.onclose=function(){},this.webSocket.close(),this.webSocket=null)}},{key:"shouldRetryConnection",value:function(){var e=!0,t="",n="";if(this.speechConfig.maxRetryCountsInSession&&this.m_webSocketTotalRetryCountInSession>=this.speechConfig.maxRetryCountsInSession?(t=s.ErrorMaxConnectionRetryFailureInSession,n="Client specified maximum retry counts in session reached",e=!1):this.m_webSocketConnectionRetryAttempts>=this.c_maxWebSocketRetryAttempts&&(t=s.ErrorConnectionRetryFailure,n="Maximum retry count reached in current window",e=!1),!e){this.setTranscriptionErrorText(t),this.telemetryManager.recordSpeechClientError(ve.WebSocketRetryConnectionFailed,n,Date.now(),!0);var r={};return r[ve.WebSocketRetryConnectionFailed]="WebSocketRetryConnectionFailed",this.logTranscriberErrorTelemetry(r),!1}return!0}}]),n}(x.EventEmitter);function Se(e){var t={},n={};return new Promise(function(){var i=R()(T.a.mark((function i(a,o){var s,c,l,u,h,m,d;return T.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=e.logger,0!==e.docId.length){i.next=8;break}return n.recordErrorCode=ve.InvalidDocId,n.recordErrorReason="",t[ve.CustomEndpointClientFailureReason]="InvalidDocId",n.errorInfo=t,o(n),i.abrupt("return");case 8:c=e.docId,-1===(l=e.docId.indexOf("access_token"))?s.sendTraceTag(595716120,r.PptSession,y.Warning,"Transcriber::RequestCustomEndpoint access_token was not found in docID. TranscriberID: ".concat(e.transcriberID)):c=e.docId.substring(0,l),u=Object(G.v4)(),s.sendTraceTag(595716121,r.PptSession,y.Info,"Transcriber::RequestCustomEndpoint CorrelationID: ".concat(u," TranscriberID: ").concat(e.transcriberID)),h=(h=e.speechFrontDoorBase.replace("wss","https")).replace("ws","http"),m="".concat(h,"CustomEndpointHandler.ashx?action=GetOrCreateCustomEndpoint&podurl=").concat(e.podUrl,"&PODSID=").concat(e.podSessionId,"&docid=").concat(c,"&locale=").concat(e.speechLanguage,"&client=web&contenttype=url&fenablecontentlogging=").concat(e.isContentLoggingEnabled,"&correlationid=").concat(u,"&wacusersessionid=").concat(e.userSessionId,"&wacuserdatacluster=").concat(e.userDataCenterClusterId,"\n    &speechMode=").concat(e.speechMode,"&app=").concat(e.clientApp),d=new XMLHttpRequest,e.telemetryManager.recordCustomEndpointStart(u),d.open("POST",m,!0),d.timeout=e.CustomEndpointRequestTimeoutInMs,d.send(),d.onload=function(){s.sendTraceTag(595716160,r.PptSession,y.Info,"requestCustomEndpointHandler: OnLoad Transcriber ID: ".concat(e.transcriberID)),n.customEndpointID=d.getResponseHeader("X-EndpointID"),e.telemetryManager.recordCustomEndpointEnd(n.customEndpointID),a(n)},d.onerror=function(){s.sendTraceTag(595716161,r.PptSession,y.Info,"requestCustomEndpointHandler: OnError Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=ve.CustomEndpointServerError,n.recordErrorReason="".concat(d.getResponseHeader("X-ErrorCode")," ").concat(d.getResponseHeader("X-FailureReason")," ").concat(d.status),e.telemetryManager.recordCustomEndpointError();var t={};t[ve.CustomEndpointServerErrorCode]=d.getResponseHeader("X-ErrorCode"),t[ve.CustomEndpointServerFailureReason]=d.getResponseHeader("X-FailureReason"),n.errorInfo=t,o(n)},d.ontimeout=function(){s.sendTraceTag(595716162,r.PptSession,y.Info,"requestCustomEndpointHandler: OnTimeout Transcriber ID: ".concat(e.transcriberID)),n.recordErrorCode=ve.CustomEndpointClientError,n.recordErrorReason="CustomEndpointRequestTimeout";var t={};t[ve.CustomEndpointClientFailureReason]="CustomEndpointRequestTimeout",n.errorInfo=t,e.telemetryManager.recordCustomEndpointTimeout(),o(n)};case 24:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}var _e=function(){function e(){f()(this,e)}return v()(e,[{key:"createSpeechClient",value:function(e,t,n,r,i,a){if(t)return new me(e,t,n,r,i,a)}}]),e}()},function(e,t,n){"use strict";(function(e){var n="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,r=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(n&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}(),i=n&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),r))}};function a(e){return e&&"[object Function]"==={}.toString.call(e)}function o(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?n[t]:n}function s(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function c(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=o(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/(auto|scroll|overlay)/.test(n+i+r)?e:c(s(e))}function l(e){return e&&e.referenceNode?e.referenceNode:e}var u=n&&!(!window.MSInputMethodContext||!document.documentMode),h=n&&/MSIE 10/.test(navigator.userAgent);function m(e){return 11===e?u:10===e?h:u||h}function d(e){if(!e)return document.documentElement;for(var t=m(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===o(n,"position")?d(n):n:e?e.ownerDocument.documentElement:document.documentElement}function p(e){return null!==e.parentNode?p(e.parentNode):e}function f(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=n?e:t,i=n?t:e,a=document.createRange();a.setStart(r,0),a.setEnd(i,0);var o,s,c=a.commonAncestorContainer;if(e!==c&&t!==c||r.contains(i))return"BODY"===(s=(o=c).nodeName)||"HTML"!==s&&d(o.firstElementChild)!==o?d(c):c;var l=p(e);return l.host?f(l.host,t):f(e,p(t).host)}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n="top"===t?"scrollTop":"scrollLeft",r=e.nodeName;if("BODY"===r||"HTML"===r){var i=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||i;return a[n]}return e[n]}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=g(t,"top"),i=g(t,"left"),a=n?-1:1;return e.top+=r*a,e.bottom+=r*a,e.left+=i*a,e.right+=i*a,e}function y(e,t){var n="x"===t?"Left":"Top",r="Left"===n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+r+"Width"])}function C(e,t,n,r){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],m(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function S(e){var t=e.body,n=e.documentElement,r=m(10)&&getComputedStyle(n);return{height:C("Height",t,n,r),width:C("Width",t,n,r)}}var _=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function w(e){return R({},e,{right:e.left+e.width,bottom:e.top+e.height})}function E(e){var t={};try{if(m(10)){t=e.getBoundingClientRect();var n=g(e,"top"),r=g(e,"left");t.top+=n,t.left+=r,t.bottom+=n,t.right+=r}else t=e.getBoundingClientRect()}catch(e){}var i={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},a="HTML"===e.nodeName?S(e.ownerDocument):{},s=a.width||e.clientWidth||i.width,c=a.height||e.clientHeight||i.height,l=e.offsetWidth-s,u=e.offsetHeight-c;if(l||u){var h=o(e);l-=y(h,"x"),u-=y(h,"y"),i.width-=l,i.height-=u}return w(i)}function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m(10),i="HTML"===t.nodeName,a=E(e),s=E(t),l=c(e),u=o(t),h=parseFloat(u.borderTopWidth),d=parseFloat(u.borderLeftWidth);n&&i&&(s.top=Math.max(s.top,0),s.left=Math.max(s.left,0));var p=w({top:a.top-s.top-h,left:a.left-s.left-d,width:a.width,height:a.height});if(p.marginTop=0,p.marginLeft=0,!r&&i){var f=parseFloat(u.marginTop),g=parseFloat(u.marginLeft);p.top-=h-f,p.bottom-=h-f,p.left-=d-g,p.right-=d-g,p.marginTop=f,p.marginLeft=g}return(r&&!n?t.contains(l):t===l&&"BODY"!==l.nodeName)&&(p=v(p,t)),p}function I(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,r=M(e,n),i=Math.max(n.clientWidth,window.innerWidth||0),a=Math.max(n.clientHeight,window.innerHeight||0),o=t?0:g(n),s=t?0:g(n,"left"),c={top:o-r.top+r.marginTop,left:s-r.left+r.marginLeft,width:i,height:a};return w(c)}function F(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===o(e,"position"))return!0;var n=s(e);return!!n&&F(n)}function D(e){if(!e||!e.parentElement||m())return document.documentElement;for(var t=e.parentElement;t&&"none"===o(t,"transform");)t=t.parentElement;return t||document.documentElement}function A(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a={top:0,left:0},o=i?D(e):f(e,l(t));if("viewport"===r)a=I(o,i);else{var u=void 0;"scrollParent"===r?"BODY"===(u=c(s(t))).nodeName&&(u=e.ownerDocument.documentElement):u="window"===r?e.ownerDocument.documentElement:r;var h=M(u,o,i);if("HTML"!==u.nodeName||F(o))a=h;else{var m=S(e.ownerDocument),d=m.height,p=m.width;a.top+=h.top-h.marginTop,a.bottom=d+h.top,a.left+=h.left-h.marginLeft,a.right=p+h.left}}var g="number"==typeof(n=n||0);return a.left+=g?n:n.left||0,a.top+=g?n:n.top||0,a.right-=g?n:n.right||0,a.bottom-=g?n:n.bottom||0,a}function k(e){return e.width*e.height}function x(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var o=A(n,r,a,i),s={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},c=Object.keys(s).map((function(e){return R({key:e},s[e],{area:k(s[e])})})).sort((function(e,t){return t.area-e.area})),l=c.filter((function(e){var t=e.width,r=e.height;return t>=n.clientWidth&&r>=n.clientHeight})),u=l.length>0?l[0].key:c[0].key,h=e.split("-")[1];return u+(h?"-"+h:"")}function L(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=r?D(t):f(t,l(n));return M(n,i,r)}function P(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+n}}function W(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function N(e,t,n){n=n.split("-")[0];var r=P(e),i={width:r.width,height:r.height},a=-1!==["right","left"].indexOf(n),o=a?"top":"left",s=a?"left":"top",c=a?"height":"width",l=a?"width":"height";return i[o]=t[o]+t[c]/2-r[c]/2,i[s]=n===s?t[s]-r[l]:t[W(s)],i}function O(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function V(e,t,n){return(void 0===n?e:e.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===n}));var r=O(e,(function(e){return e[t]===n}));return e.indexOf(r)}(e,"name",n))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=e.function||e.fn;e.enabled&&a(n)&&(t.offsets.popper=w(t.offsets.popper),t.offsets.reference=w(t.offsets.reference),t=n(t,e))})),t}function B(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=L(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=x(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=N(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=V(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function H(e,t){return e.some((function(e){var n=e.name;return e.enabled&&n===t}))}function U(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var i=t[r],a=i?""+i+n:e;if(void 0!==document.body.style[a])return a}return null}function q(){return this.state.isDestroyed=!0,H(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[U("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function j(e){var t=e.ownerDocument;return t?t.defaultView:window}function G(){this.state.eventsEnabled||(this.state=function(e,t,n,r){n.updateBound=r,j(e).addEventListener("resize",n.updateBound,{passive:!0});var i=c(e);return function e(t,n,r,i){var a="BODY"===t.nodeName,o=a?t.ownerDocument.defaultView:t;o.addEventListener(n,r,{passive:!0}),a||e(c(o.parentNode),n,r,i),i.push(o)}(i,"scroll",n.updateBound,n.scrollParents),n.scrollElement=i,n.eventsEnabled=!0,n}(this.reference,this.options,this.state,this.scheduleUpdate))}function z(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,j(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function J(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function X(e,t){Object.keys(t).forEach((function(n){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&J(t[n])&&(r="px"),e.style[n]=t[n]+r}))}var Q=n&&/Firefox/i.test(navigator.userAgent);function Y(e,t,n){var r=O(e,(function(e){return e.name===t})),i=!!r&&e.some((function(e){return e.name===n&&e.enabled&&e.order<r.order}));if(!i){var a="`"+t+"`",o="`"+n+"`";console.warn(o+" modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return i}var K=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Z=K.slice(3);function $(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Z.indexOf(e),r=Z.slice(n+1).concat(Z.slice(0,n));return t?r.reverse():r}var ee={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],r=t.split("-")[1];if(r){var i=e.offsets,a=i.reference,o=i.popper,s=-1!==["bottom","top"].indexOf(n),c=s?"left":"top",l=s?"width":"height",u={start:b({},c,a[c]),end:b({},c,a[c]+a[l]-o[l])};e.offsets.popper=R({},o,u[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n,r=t.offset,i=e.placement,a=e.offsets,o=a.popper,s=a.reference,c=i.split("-")[0];return n=J(+r)?[+r,0]:function(e,t,n,r){var i=[0,0],a=-1!==["right","left"].indexOf(r),o=e.split(/(\+|\-)/).map((function(e){return e.trim()})),s=o.indexOf(O(o,(function(e){return-1!==e.search(/,|\s/)})));o[s]&&-1===o[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var c=/\s*,\s*|\s+/,l=-1!==s?[o.slice(0,s).concat([o[s].split(c)[0]]),[o[s].split(c)[1]].concat(o.slice(s+1))]:[o];return(l=l.map((function(e,r){var i=(1===r?!a:a)?"height":"width",o=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,o=!0,e):o?(e[e.length-1]+=t,o=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,n,r){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+i[1],o=i[2];if(!a)return e;if(0===o.indexOf("%")){var s=void 0;switch(o){case"%p":s=n;break;case"%":case"%r":default:s=r}return w(s)[t]/100*a}return"vh"===o||"vw"===o?("vh"===o?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,i,t,n)}))}))).forEach((function(e,t){e.forEach((function(n,r){J(n)&&(i[t]+=n*("-"===e[r-1]?-1:1))}))})),i}(r,o,s,c),"left"===c?(o.top+=n[0],o.left-=n[1]):"right"===c?(o.top+=n[0],o.left+=n[1]):"top"===c?(o.left+=n[0],o.top-=n[1]):"bottom"===c&&(o.left+=n[0],o.top+=n[1]),e.popper=o,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||d(e.instance.popper);e.instance.reference===n&&(n=d(n));var r=U("transform"),i=e.instance.popper.style,a=i.top,o=i.left,s=i[r];i.top="",i.left="",i[r]="";var c=A(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);i.top=a,i.left=o,i[r]=s,t.boundaries=c;var l=t.priority,u=e.offsets.popper,h={primary:function(e){var n=u[e];return u[e]<c[e]&&!t.escapeWithReference&&(n=Math.max(u[e],c[e])),b({},e,n)},secondary:function(e){var n="right"===e?"left":"top",r=u[n];return u[e]>c[e]&&!t.escapeWithReference&&(r=Math.min(u[n],c[e]-("right"===e?u.width:u.height))),b({},n,r)}};return l.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=R({},u,h[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,i=e.placement.split("-")[0],a=Math.floor,o=-1!==["top","bottom"].indexOf(i),s=o?"right":"bottom",c=o?"left":"top",l=o?"width":"height";return n[s]<a(r[c])&&(e.offsets.popper[c]=a(r[c])-n[l]),n[c]>a(r[s])&&(e.offsets.popper[c]=a(r[s])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var n;if(!Y(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var i=e.placement.split("-")[0],a=e.offsets,s=a.popper,c=a.reference,l=-1!==["left","right"].indexOf(i),u=l?"height":"width",h=l?"Top":"Left",m=h.toLowerCase(),d=l?"left":"top",p=l?"bottom":"right",f=P(r)[u];c[p]-f<s[m]&&(e.offsets.popper[m]-=s[m]-(c[p]-f)),c[m]+f>s[p]&&(e.offsets.popper[m]+=c[m]+f-s[p]),e.offsets.popper=w(e.offsets.popper);var g=c[m]+c[u]/2-f/2,v=o(e.instance.popper),y=parseFloat(v["margin"+h]),C=parseFloat(v["border"+h+"Width"]),S=g-e.offsets.popper[m]-y-C;return S=Math.max(Math.min(s[u]-f,S),0),e.arrowElement=r,e.offsets.arrow=(b(n={},m,Math.round(S)),b(n,d,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(H(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=A(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],i=W(r),a=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case"flip":o=[r,i];break;case"clockwise":o=$(r);break;case"counterclockwise":o=$(r,!0);break;default:o=t.behavior}return o.forEach((function(s,c){if(r!==s||o.length===c+1)return e;r=e.placement.split("-")[0],i=W(r);var l=e.offsets.popper,u=e.offsets.reference,h=Math.floor,m="left"===r&&h(l.right)>h(u.left)||"right"===r&&h(l.left)<h(u.right)||"top"===r&&h(l.bottom)>h(u.top)||"bottom"===r&&h(l.top)<h(u.bottom),d=h(l.left)<h(n.left),p=h(l.right)>h(n.right),f=h(l.top)<h(n.top),g=h(l.bottom)>h(n.bottom),v="left"===r&&d||"right"===r&&p||"top"===r&&f||"bottom"===r&&g,y=-1!==["top","bottom"].indexOf(r),C=!!t.flipVariations&&(y&&"start"===a&&d||y&&"end"===a&&p||!y&&"start"===a&&f||!y&&"end"===a&&g),S=!!t.flipVariationsByContent&&(y&&"start"===a&&p||y&&"end"===a&&d||!y&&"start"===a&&g||!y&&"end"===a&&f),_=C||S;(m||v||_)&&(e.flipped=!0,(m||v)&&(r=o[c+1]),_&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=r+(a?"-"+a:""),e.offsets.popper=R({},e.offsets.popper,N(e.instance.popper,e.offsets.reference,e.placement)),e=V(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,i=r.popper,a=r.reference,o=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return i[o?"left":"top"]=a[n]-(s?i[o?"width":"height"]:0),e.placement=W(t),e.offsets.popper=w(i),e}},hide:{order:800,enabled:!0,fn:function(e){if(!Y(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=O(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,i=e.offsets.popper,a=O(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,s,c=void 0!==a?a:t.gpuAcceleration,l=d(e.instance.popper),u=E(l),h={position:i.position},m=function(e,t){var n=e.offsets,r=n.popper,i=n.reference,a=Math.round,o=Math.floor,s=function(e){return e},c=a(i.width),l=a(r.width),u=-1!==["left","right"].indexOf(e.placement),h=-1!==e.placement.indexOf("-"),m=t?u||h||c%2==l%2?a:o:s,d=t?a:s;return{left:m(c%2==1&&l%2==1&&!h&&t?r.left-1:r.left),top:d(r.top),bottom:d(r.bottom),right:m(r.right)}}(e,window.devicePixelRatio<2||!Q),p="bottom"===n?"top":"bottom",f="right"===r?"left":"right",g=U("transform");if(s="bottom"===p?"HTML"===l.nodeName?-l.clientHeight+m.bottom:-u.height+m.bottom:m.top,o="right"===f?"HTML"===l.nodeName?-l.clientWidth+m.right:-u.width+m.right:m.left,c&&g)h[g]="translate3d("+o+"px, "+s+"px, 0)",h[p]=0,h[f]=0,h.willChange="transform";else{var v="bottom"===p?-1:1,y="right"===f?-1:1;h[p]=s*v,h[f]=o*y,h.willChange=p+", "+f}var C={"x-placement":e.placement};return e.attributes=R({},C,e.attributes),e.styles=R({},h,e.styles),e.arrowStyles=R({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return X(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach((function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&X(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,i){var a=L(i,t,e,n.positionFixed),o=x(n.placement,a,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",o),X(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},te=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=i(this.update.bind(this)),this.options=R({},e.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(R({},e.Defaults.modifiers,o.modifiers)).forEach((function(t){r.options.modifiers[t]=R({},e.Defaults.modifiers[t]||{},o.modifiers?o.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return R({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&a(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return T(e,[{key:"update",value:function(){return B.call(this)}},{key:"destroy",value:function(){return q.call(this)}},{key:"enableEventListeners",value:function(){return G.call(this)}},{key:"disableEventListeners",value:function(){return z.call(this)}}]),e}();te.Utils=("undefined"!=typeof window?window:e).PopperUtils,te.placements=K,te.Defaults=ee,t.a=te}).call(this,n(66))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.CoachActorManager=void 0;var i=n(59),a=n(109),o=n(12),s=n(65),c=n(60),l=n(370),u=n(151),h=n(372),m=n(373),d=n(26),p=n(108),f=n(57);n(374),n(375),n(376),n(153);var g,v=function(){function e(){}return e.MaxedTimer="59:59",e.ResetRehearsalIntervalInMS=5e3,e.RehearsalDashboardResizingWaitTimeInMS=500,e.RehearsalDashboardMinimizeTransition="all .5s linear",e.RehearsalDashboardDefaultTransition="all 0.5s linear 0s",e.RehearsalDashboardNoTransition="0ms",e.RehearsalKeyboardFocusTabIndex=3,e.RehearsalContainerFocusTabIndex=0,e}(),y=function(){function e(e,t){this.events=new o.EventEmitter,this.m_disabledRealtimeFeatures={},this.m_currentlyShownFeatureName="",this.m_rehearsalDiv=null,this.m_timerForClearingRehearsalDashboard=null,this.m_timerForShowActiveRehearsalTracker=null,this.m_rehearsalAlertAudio=null,this.m_rehearsalCoachDragDropPositionTracker=null,this.m_rehearsalCoachDragDropContainer=null,this.m_slideCount=0,this.m_currentSlideNumber=0,this.m_presentationTimeInSeconds=0,g=t,this.m_rehearsalState={playState:i.RehearsalPlayState.NotStarted,notificationState:i.RehearsalNotificationState.NotShowingNotification,actorState:i.RehearsalActorState.WelcomeActor,videoEnabled:!1,fRealtimeFeedbackEnabled:!0,fRehearsalAlreadyTriggeredDuringSession:!1,fVideoShownDuringSession:!0},this.m_coachActorConfig=e,this.m_document=this.m_coachActorConfig.rootContainer.ownerDocument||document,this.m_currentlyShownFeatureName="";var n=r(r({},e),{fUseCountdownWelcomeScreen:e.fUseCountdownWelcomeScreen||e.fUseNewRealtimePanel});if(this.m_coachVisionActor=new l.CoachVisionActor(n,this.togglePause.bind(this),this.toggleRealtimeFeedback.bind(this),this.toggleVideoFeedback.bind(this),this.turnOffVision.bind(this),t),this.m_coachAudioActor=new u.CoachAudioActor(n,this.togglePause.bind(this),this.toggleRealtimeFeedback.bind(this),t,[]),this.m_coachWelcomeActor=this.m_coachActorConfig.fUseCountdownWelcomeScreen?new m.CoachCountdownWelcomeActor(e,t,this.startRehearsalSession.bind(this)):new h.CoachWelcomeActor(r(r({},e),{fShowRealtimeFeedbackEnabledCheckbox:!e.fUseCountdownWelcomeScreen&&e.fShowRealtimeFeedbackEnabledCheckbox}),t,this.startRehearsalSession.bind(this)),this.updateCoachSlideComponent(this.m_coachActorConfig.slideState),this.m_timerForClearingRehearsalDashboard=null,this.m_timerForShowActiveRehearsalTracker=null,this.m_rehearsalAlertAudio=new Audio,this.m_rehearsalAlertAudio.src=""+(this.m_coachActorConfig.imagesBaseFilePath+d.RehearsalActorSettings.RehearsalAlertSoundFile),null!==this.m_rehearsalDiv&&this.m_rehearsalDiv.appendChild(this.m_rehearsalAlertAudio),this.m_rehearsalDiv=this.m_document.createElement("div"),null!=this.m_rehearsalDiv&&(this.m_rehearsalDiv.id="ppt-RehearsalDiv",this.m_rehearsalDiv.style.zIndex=this.m_coachActorConfig.zIndex.toString(),this.m_rehearsalDiv.tabIndex=v.RehearsalContainerFocusTabIndex,this.m_rehearsalDiv.style.transition=v.RehearsalDashboardDefaultTransition,this.m_rehearsalDiv.setAttribute("aria-label",d.RehearsalActorSettings.RehearseWithCoachDashboardAriaLabel),this.m_rehearsalDiv.className=this.containerClassFromActor(this.m_rehearsalState.actorState)),p.shouldHandleSpecialFocus(this.m_coachActorConfig.clientType)&&this.addEventHandlers(),this.m_rehearsalCoachDragDropContainer=this.generateRehearsalDragDropContainer(),p.shouldEnableDragDrop(this.m_coachActorConfig.clientType)&&this.m_rehearsalDiv&&this.m_rehearsalCoachDragDropContainer){var s=this.m_rehearsalDiv.style.transition,c=this.getElementsToAvoidDraggingOn();this.m_rehearsalCoachDragDropPositionTracker=new a.CoachDragDropPositionTracker(this.m_rehearsalDiv,s||"",this.m_rehearsalCoachDragDropContainer,c),this.m_rehearsalCoachDragDropPositionTracker.addEventHandlers()}this.m_coachActorConfig.rootContainer.appendChild(this.m_rehearsalDiv),this.m_coachActorConfig.rootContainer.appendChild(this.m_rehearsalCoachDragDropContainer),null!==this.m_rehearsalDiv&&(this.m_rehearsalDiv.style.display="none"),this.setDisabledRealtimeFeatureSet(),this.m_rehearsalDiv&&this.m_rehearsalDiv.appendChild(this.m_coachWelcomeActor.getActorContainer())}return e.prototype.getSupportedRehearsalTemplates=function(){var e="";for(var t in d.RehearsalTemplateName)null!=t&&t.length>0&&(e+=0===e.length?t:","+t);return e},e.prototype.fSupportsCoachTemplate=function(e){return null!==e&&!!this.m_coachFeedbackActor&&this.m_coachFeedbackActor.fSupportsCoachTemplate(e)},e.prototype.showCoachRealtimeUI=function(e){var t=this;this.m_coachWelcomeActor.on("CoachRelinquishControl",(function(){t.events.emit("CoachRelinquishControl")})),this.m_coachAudioActor.on("CoachRelinquishControl",(function(){t.events.emit("CoachRelinquishControl")})),this.m_rehearsalDiv&&(this.m_rehearsalDiv.style.display="block"),this.m_coachWelcomeActor.startWelcomeActor(e)},e.prototype.updateCoachSlideComponent=function(e){this.m_slideCount=e.totalSlideCount,this.m_currentSlideNumber=e.currentSlideIndex+1,this.updateSlideTracker()},e.prototype.updateCurrentSlideIndex=function(e){this.m_currentSlideNumber=e+1,this.updateSlideTracker()},e.prototype.updateTotalSlideCount=function(e){this.m_slideCount=e,this.updateSlideTracker()},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.hideCoachUI=function(){p.shouldHandleSpecialFocus(this.m_coachActorConfig.clientType)&&this.removeEventHandlers(),this.removeRehearsalDiv(),this.removeRehearsalDragDropContainer(),this.m_timerForClearingRehearsalDashboard&&(clearTimeout(this.m_timerForClearingRehearsalDashboard),this.m_timerForClearingRehearsalDashboard=null),this.m_rehearsalCoachDragDropPositionTracker&&this.m_rehearsalCoachDragDropPositionTracker.removeEventHandlers()},e.prototype.updateTimer=function(e){if(this.m_rehearsalState.playState===i.RehearsalPlayState.Started&&this.m_coachFeedbackActor){var t=Math.floor(e/60),n=e-60*t;t>59?this.m_coachFeedbackActor.updateTimer(v.MaxedTimer):this.m_coachFeedbackActor.updateTimer(this.formatTimerNumber(t)+":"+this.formatTimerNumber(n))}},e.prototype.updateCoachRealtimeNotification=function(e){var t=this,n=e.features,r="",i=-1;if(n.forEach((function(e,n){var a,o=n.toLowerCase();if(t.fValidTemplate(e)&&!t.fIsFeatureDisabled(o)){var s=e.get("templateInfo");s.has("priority")&&Number(s.has("priority"))>i&&(document.activeElement===document.querySelector("#ppt-RehearsalTrackerValue-pronunciation-audioButton")&&(null===(a=document.getElementById("ppt-Rehearsal-listeningButton"))||void 0===a||a.focus()),i=Number(s.get("priority")),r=n)}})),i>=0){var a=n.get(r);this.updateCoachRealTimeCritiqueComponent(a,r)}},e.prototype.updateSingleFeatureCoachRealtimeNotification=function(e){this.fValidTemplate(e)&&this.updateCoachRealTimeCritiqueComponent(e)},e.prototype.showStatusNotification=function(e,t){this.m_rehearsalState.actorState===i.RehearsalActorState.WelcomeActor?(this.m_rehearsalDiv&&(this.m_rehearsalDiv.style.display="block"),this.m_coachWelcomeActor.showStatusNotification(e,t)):this.m_coachAudioActor&&this.m_coachAudioActor.showStatusNotification(e,t)},e.prototype.getRehearsalVideoElement=function(){return this.m_coachVisionActor?this.m_coachVisionActor.getRehearsalVideoElement():null},e.prototype.getRehearsalVideoCanvas=function(){return this.m_coachVisionActor?this.m_coachVisionActor.getRehearsalVideoCanvas():null},e.prototype.enableCoachVideoUI=function(){this.m_rehearsalState.videoEnabled=!0},e.prototype.dismissActiveTooltips=function(){f.hideTooltips()},e.prototype.getTraceRequestMetadata=function(){var e={};return e.RealtimeFeedbackEnabled=String(this.m_rehearsalState.fRealtimeFeedbackEnabled),e.DashboardCreationTimeInMS=String(this.m_coachWelcomeActor.getCreationTimeInMs()),e},e.prototype.getCoachElement=function(e){var t=null;switch(e){case i.CoachActorElement.ContainerElement:t=this.m_document.getElementById("ppt-RehearsalDiv");break;case i.CoachActorElement.GetStartedButton:t=this.m_document.getElementById("ppt-RehearsalTrackerDiv-welcome-getStartedButton");break;case i.CoachActorElement.ListeningButtonPlayPauseButton:t=this.m_document.getElementById(this.m_rehearsalState.actorState===i.RehearsalActorState.AudioActor?"ppt-Rehearsal-listeningButton":"ppt-Rehearsal-videoListeningButton");break;case i.CoachActorElement.NotificationButtonElement:t=this.m_document.getElementById("ppt-Rehearsal-notificationContainer");break;case i.CoachActorElement.WelcomeCheckboxElement:t=this.m_document.getElementById("ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox");break;default:g.sendTraceTag(593892166,s.LogCategory.PptSession,c.TraceLevel.Error,"Rehearsal::getCoachElement Unknown element: "+e)}return t},e.prototype.on=function(e,t){return this.events.on(e,t),this},e.prototype.showCoachDisabledUI=function(e){this.m_rehearsalState.actorState===i.RehearsalActorState.WelcomeActor?(this.m_coachWelcomeActor.showCoachDisabledUI(e),this.m_rehearsalDiv&&(this.m_rehearsalDiv.style.display="block"),g.sendTraceTag(593892164,s.LogCategory.PptSession,c.TraceLevel.Info,"Rehearsal::showCoachDisabledUI Rehearsal error screen showing, Error Reason: "+String(e))):g.sendTraceTag(593892165,s.LogCategory.PptSession,c.TraceLevel.Error,"Rehearsal::showCoachDisabledUI not in Welcome state, no error dialog available")},e.prototype.containerClassWithoutThemeFromActor=function(e){switch(e){case i.RehearsalActorState.AudioActor:return"rehearsalDivAudio";case i.RehearsalActorState.VisionActor:return"rehearsalDivVideo";case i.RehearsalActorState.WelcomeActor:return this.m_coachActorConfig.fUseCountdownWelcomeScreen?"rehearsalDivCountdown":"rehearsalDivWelcome";case i.RehearsalActorState.ErrorActor:return"rehearsalDivError"}},e.prototype.containerClassFromActor=function(e){return this.containerClassWithoutThemeFromActor(e)+" "+f.getLightOrDarkThemeClassName(this.m_rehearsalDiv)},e.prototype.turnOffVision=function(){this.events.emit("CoachVisionTurnedOff"),this.showCoachAudioUI()},e.prototype.startRehearsalSession=function(e){this.m_rehearsalState.fRealtimeFeedbackEnabled=e,this.startRehearsal()},e.prototype.hideCurrentCoachUI=function(){this.m_rehearsalDiv&&(this.m_coachFeedbackActor&&this.m_rehearsalDiv.contains(this.m_coachFeedbackActor.getActorContainer())?this.m_rehearsalDiv.removeChild(this.m_coachFeedbackActor.getActorContainer()):this.m_coachWelcomeActor&&this.m_rehearsalDiv.contains(this.m_coachWelcomeActor.getActorContainer())&&this.m_rehearsalDiv.removeChild(this.m_coachWelcomeActor.getActorContainer()))},e.prototype.showCoachVideoUI=function(){if(this.m_rehearsalDiv&&this.m_coachVisionActor){this.hideCurrentCoachUI(),this.m_rehearsalDiv.appendChild(this.m_coachVisionActor.getActorContainer()),this.m_coachVisionActor.startRealTimeTrackers(this.m_rehearsalState.fRehearsalAlreadyTriggeredDuringSession,this.m_rehearsalState.fRealtimeFeedbackEnabled),this.m_coachFeedbackActor=this.m_coachVisionActor,this.m_rehearsalState.actorState=i.RehearsalActorState.VisionActor;var e=window.getComputedStyle(this.m_rehearsalDiv,null),t=e.getPropertyValue("height"),n=e.getPropertyValue("width");p.shouldAnimateRehearsalContainer(this.m_coachActorConfig.clientType)&&this.m_rehearsalDiv.animate([{height:t,width:n},{height:this.m_coachVisionActor.getActorContainer().offsetHeight+"px",width:this.m_coachVisionActor.getActorContainer().offsetWidth+"px"}],500),this.m_coachVisionActor.startCoachVideoSession(),this.m_rehearsalDiv.className=this.containerClassFromActor(this.m_rehearsalState.actorState),this.events.emit("CoachVisionTurnedOn")}},e.prototype.showCoachAudioUI=function(){if(this.m_rehearsalDiv&&this.m_coachAudioActor){var e=window.getComputedStyle(this.m_rehearsalDiv,null),t=e.getPropertyValue("height"),n=e.getPropertyValue("width");this.hideCurrentCoachUI(),this.m_rehearsalDiv.appendChild(this.m_coachAudioActor.getActorContainer()),this.m_coachAudioActor.startRealTimeTrackers(this.m_rehearsalState.fRehearsalAlreadyTriggeredDuringSession,this.m_rehearsalState.fRealtimeFeedbackEnabled),this.m_rehearsalState.actorState===i.RehearsalActorState.WelcomeActor&&this.m_coachAudioActor.restartTimerForClearingRehearsalDashboard(),p.shouldAnimateRehearsalContainer(this.m_coachActorConfig.clientType)&&this.m_rehearsalDiv.animate([{height:t,width:n},{height:this.m_coachAudioActor.getActorContainer().offsetHeight+"px",width:this.m_coachAudioActor.getActorContainer().offsetWidth+"px"}],500),this.m_coachFeedbackActor=this.m_coachAudioActor,this.m_rehearsalState.actorState=i.RehearsalActorState.AudioActor,this.m_rehearsalDiv.className=this.containerClassFromActor(this.m_rehearsalState.actorState)}},e.prototype.updateCoachRealTimeCritiqueComponent=function(e,t){if(this.m_rehearsalState.playState===i.RehearsalPlayState.Started&&this.m_rehearsalState.fRealtimeFeedbackEnabled){var n=t||"";t||(e.get("templateInfo").has("realtimeLabel")?n=e.get("templateInfo").get("realtimeLabel"):g.sendTraceTag(592720724,s.LogCategory.PptSession,c.TraceLevel.Error,"Rehearsal::updateCoachRealTimeCritiqueComponent:No realtime Label found")),this.generateRealtimeNotification(n,e)}},e.prototype.setDisabledRealtimeFeatureSet=function(){var e=this,t=this.m_coachActorConfig.disabledCoachRealtimeFeatures||"";this.m_disabledRealtimeFeatures={},t.split(",").forEach((function(t){t.length>0&&(e.m_disabledRealtimeFeatures[t.toLowerCase()]=!0)}))},e.prototype.fValidTemplate=function(e){return!(!e.has("featureTemplate")||!this.fSupportsCoachTemplate(e.get("featureTemplate"))||!e.has("templateInfo"))},e.prototype.fIsFeatureDisabled=function(e){return!(!(e in this.m_disabledRealtimeFeatures)||!this.m_disabledRealtimeFeatures[e])},e.prototype.getElementsToAvoidDraggingOn=function(){var e=[];return this.m_coachAudioActor&&(e=e.concat(this.m_coachAudioActor.getElementsToAvoidDraggingOn())),this.m_coachVisionActor&&(e=e.concat(this.m_coachVisionActor.getElementsToAvoidDraggingOn())),this.m_coachWelcomeActor&&(e=e.concat(this.m_coachWelcomeActor.getElementsToAvoidDraggingOn())),e},e.prototype.generateRehearsalDragDropContainer=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalDiv-DragDropContainer",e.style.zIndex=this.m_coachActorConfig.zIndex.toString(),e},e.prototype.resetRehearsalDashboard=function(){null!==this.m_rehearsalDiv&&this.m_rehearsalState.playState===i.RehearsalPlayState.Started&&this.m_rehearsalState.actorState===i.RehearsalActorState.VisionActor&&(this.m_coachFeedbackActor.resetRehearsalDashboard(),this.m_rehearsalDiv.style.transition=v.RehearsalDashboardMinimizeTransition,this.m_timerForClearingRehearsalDashboard=null,null!==this.m_currentlyShownFeatureName&&(this.m_currentlyShownFeatureName=""))},e.prototype.restartTimerForClearingRehearsalDashboard=function(){this.m_timerForClearingRehearsalDashboard&&clearTimeout(this.m_timerForClearingRehearsalDashboard),this.m_timerForClearingRehearsalDashboard=setTimeout(this.resetRehearsalDashboard.bind(this),v.ResetRehearsalIntervalInMS)},e.prototype.togglePause=function(){this.m_coachFeedbackActor&&(this.m_rehearsalState.playState===i.RehearsalPlayState.Paused?(this.m_rehearsalState.playState=i.RehearsalPlayState.Started,this.m_coachFeedbackActor.resumeSession(),this.restartTimerForClearingRehearsalDashboard(),this.events.emit("CoachSessionResumed")):(this.m_rehearsalState.playState=i.RehearsalPlayState.Paused,this.m_coachFeedbackActor.pauseSession(),this.events.emit("CoachSessionPaused")))},e.prototype.toggleVideoFeedback=function(){this.m_rehearsalState.actorState===i.RehearsalActorState.VisionActor&&this.m_coachFeedbackActor instanceof l.CoachVisionActor?(this.m_rehearsalState.fVideoShownDuringSession=!this.m_rehearsalState.fVideoShownDuringSession,this.m_coachFeedbackActor.toggleVideoUI(this.m_rehearsalState.fVideoShownDuringSession)):g.sendTraceTag(591736990,s.LogCategory.PptSession,c.TraceLevel.Error,"Rehearsal::toggleVideoFeedback called in invalid actor state: "+i.RehearsalActorState[this.m_rehearsalState.actorState])},e.prototype.toggleRealtimeFeedback=function(){this.m_rehearsalState.fRealtimeFeedbackEnabled=!this.m_rehearsalState.fRealtimeFeedbackEnabled,this.m_coachFeedbackActor.setRealtimeFeedbackButton(this.m_rehearsalState.fRealtimeFeedbackEnabled)},e.prototype.playRehearsalAlertSound=function(){null!==this.m_rehearsalAlertAudio&&this.m_rehearsalAlertAudio.play()},e.prototype.showActiveRehearsalTracker=function(){this.m_timerForShowActiveRehearsalTracker=null},e.prototype.formatTimerNumber=function(e){return e<10?"0"+e:e},e.prototype.startRehearsal=function(){this.m_rehearsalState.videoEnabled&&this.m_coachActorConfig.fEnableVision?this.showCoachVideoUI():this.showCoachAudioUI(),this.m_coachAudioActor.setRealtimeFeedbackButton(this.m_rehearsalState.fRealtimeFeedbackEnabled),this.m_rehearsalState.fRehearsalAlreadyTriggeredDuringSession=!0,this.m_rehearsalState.playState=i.RehearsalPlayState.Started,this.events.emit("CoachSessionStarted"),this.m_coachActorConfig.fEnableAutoCoachTimer&&(0!==this.m_timerId&&clearInterval(this.m_timerId),this.m_presentationTimeInSeconds=0,this.m_timerId=setInterval(this.updateCoachAutoTimer.bind(this),1e3)),this.restartTimerForClearingRehearsalDashboard()},e.prototype.updateCoachAutoTimer=function(){this.m_rehearsalState.playState!==i.RehearsalPlayState.Paused&&(this.m_presentationTimeInSeconds+=1,this.updateTimer(this.m_presentationTimeInSeconds))},e.prototype.removeRehearsalDiv=function(){this.m_rehearsalDiv&&this.m_rehearsalDiv.parentNode&&(this.m_rehearsalDiv.parentNode.removeChild(this.m_rehearsalDiv),this.m_rehearsalDiv=null)},e.prototype.removeRehearsalDragDropContainer=function(){this.m_rehearsalCoachDragDropContainer&&this.m_rehearsalCoachDragDropContainer.parentNode&&(this.m_rehearsalCoachDragDropContainer.parentNode.removeChild(this.m_rehearsalCoachDragDropContainer),this.m_rehearsalCoachDragDropContainer=null)},e.prototype.updateSlideTracker=function(){this.m_coachVisionActor&&this.m_coachVisionActor.updateCoachSlideComponent(this.m_currentSlideNumber,this.m_slideCount),this.m_coachAudioActor&&this.m_coachAudioActor.updateCoachSlideComponent(this.m_currentSlideNumber,this.m_slideCount)},e.prototype.generateRealtimeNotification=function(e,t,n){var r=this.m_rehearsalState.notificationState===i.RehearsalNotificationState.NotShowingNotification,a=null===this.m_currentlyShownFeatureName||this.m_currentlyShownFeatureName!==e;this.m_coachFeedbackActor&&this.m_coachFeedbackActor.showMessage(e,t,r)&&(this.m_rehearsalState.notificationState===i.RehearsalNotificationState.NotShowingNotification?(this.m_timerForShowActiveRehearsalTracker&&clearTimeout(this.m_timerForShowActiveRehearsalTracker),this.m_timerForShowActiveRehearsalTracker=setTimeout(this.showActiveRehearsalTracker.bind(this),v.RehearsalDashboardResizingWaitTimeInMS),this.playRehearsalAlertSound(),this.m_rehearsalState.notificationState=i.RehearsalNotificationState.ShowingNotification):null==this.m_timerForShowActiveRehearsalTracker&&this.showActiveRehearsalTracker(),n||(this.restartTimerForClearingRehearsalDashboard(),a&&this.m_coachFeedbackActor.fireTrackerAlert()),this.m_currentlyShownFeatureName=e)},e.prototype.handleKeyDown=function(e){this.m_coachActorConfig.fRemoveFocusTrapForWin32&&"Tab"===e.key&&e.shiftKey&&e.target===this.getCoachElement(i.CoachActorElement.ContainerElement)?(e.stopPropagation(),e.preventDefault(),e.target.blur(),this.events.emit("CoachRelinquishControl")):this.m_rehearsalState.actorState===i.RehearsalActorState.WelcomeActor?this.m_coachWelcomeActor.handleKeyDown(e):this.m_rehearsalState.actorState===i.RehearsalActorState.AudioActor&&this.m_coachAudioActor.handleKeyDown(e)},e.prototype.handleEvent=function(e){switch(e.type){case"keydown":this.handleKeyDown(e)}},e.prototype.addEventHandlers=function(){document.addEventListener("keydown",this,!0)},e.prototype.removeEventHandlers=function(){document.removeEventListener("keydown",this,!0)},e}();t.CoachActorManager=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachFREActorFactory=t.CoachActorFactory=void 0;var r=n(156),i=n(377),a=function(){function e(){}return e.prototype.createCoachActorManager=function(e,t){return new r.CoachActorManager(e,t)},e}();t.CoachActorFactory=a;var o=function(){function e(){}return e.prototype.createCoachFREActorManager=function(e,t){return new i.CoachFREActorManager(e,t)},e}();t.CoachFREActorFactory=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(79),a=n(154),o=n(176),s=n(12),c=n(20);n(182);var l=function(){function e(){}return e.getSupportedRehearsalTemplates=function(){var e="";for(var t in i.RehearsalTemplateName)null!=t&&t.length>0&&(e+=0===e.length?t:","+t);return e},e.getDefaultRequestedRehearsalFeatures=function(){return i.CoachFeatures.WordsPerMinute+",\n          "+i.CoachFeatures.FillerWords+",\n          "+i.CoachFeatures.SensitivePhrases+",\n          "+i.CoachFeatures.CorrectedSensitivePhrases+",\n          "+i.CoachFeatures.Originality+",\n          "+i.CoachFeatures.Positivity},e.getRehearsalMetadataJSON=function(t,n){var r;r=t.supportedRehearsalTemplates?t.supportedRehearsalTemplates:this.getSupportedRehearsalTemplates();var i={requestedRehearsalFeatures:null===t.requestedCoachFeatures||void 0===t.requestedCoachFeatures?e.getDefaultRequestedRehearsalFeatures():t.requestedCoachFeatures,supportedRehearsalTemplates:r,iscoachresultsummaryaggregationrequested:t.fEnableServiceSideAggregationForCoach};return t.fEnableServiceSideAggregationForCoach&&n&&(i[this.UserToken]=n),JSON.stringify(i)},e.UserToken="userToken",e}();t.RehearsalManagerSettings=l;var u=function(){function e(e){this.m_disabledRealtimeFeatures={},this.m_sessionTelemetry=new i.CoachSessionTelemetry,this.m_events=new s.EventEmitter,this.m_sessionPaused=!0,this.m_presentationTimeInSeconds=0,this.m_sessionTranscriptRequestInfo=new i.CoachSessionTranscriptRequestInfo,this.m_rehearsalId="",this.m_sourceLanguage="",this.m_userToken="",this.fValidateSessionConfig(e),this.m_sessionConfig=e,r=this.m_sessionConfig.logger,this.m_sourceLanguage=this.checkOrGetDefaultSourceLanguage(this.m_sessionConfig.sourceLanguage,this.m_sessionConfig.userSessionId),this.m_userToken=c.v4(),this.m_sessionConfig.sessionTranscriptionRequested||(this.m_sessionConfig.sessionTranscriptionRequested=!1),this.setDisabledRealtimeFeatureSet(),this.setUpSpeechClient(),this.m_coachSummaryCollector=o.CoachSummaryCollectorFactory.createCoachSummaryCollector(this.m_sessionConfig,this.m_userToken)}return e.prototype.fValidateSessionConfig=function(e){e.coachMode&&e.coachMode===i.CoachMode.ReadAlong&&this.fValidateReadAlongSessionConfig(e)},e.prototype.fValidateReadAlongSessionConfig=function(e){if(!e.referenceText||0===e.referenceText.length||!e.requestedCoachFeatures||!e.requestedCoachFeatures.toLowerCase().includes("pronunciationraw"))throw new Error("ReadAlong mode requires non-empty reference text and pronunciationRaw in requestedCoachFeatures")},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.startSession=function(e){if(this.m_sessionTelemetry=new i.CoachSessionTelemetry,this.initializeCoachSessionTelemetry(),this.m_coachSummaryCollector.startCoachSummary(),this.m_speechClient.startSpeechRecognition(e),e?this.disableVoiceStreaming():this.enableVoiceStreaming(),this.m_sessionConfig.customSettings){for(var t=0,n=Object.keys(this.m_sessionConfig.customSettings);t<n.length;t++){var r=n[t],a=this.m_sessionConfig.customSettings[r];this.m_speechClient.setCustomSetting(r,a)}"currentSlideIndex"in this.m_sessionConfig.customSettings&&this.m_sessionConfig.customSettings.currentSlideIndex&&this.m_coachSummaryCollector.addSlideRehearsed(Number(this.m_sessionConfig.customSettings.currentSlideIndex))}0!==this.m_timerId&&clearInterval(this.m_timerId),this.m_presentationTimeInSeconds=0,this.m_timerId=setInterval(this.updateTimer.bind(this),1e3)},e.prototype.getSessionDurationInMs=function(){return 1e3*this.m_presentationTimeInSeconds},e.prototype.sendEndOfAudio=function(){this.m_speechClient.sendEndOfAudio()},e.prototype.stopSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.stopWebcamCapture(),this.m_speechClient.stopSpeechRecognition();var e=this.getSessionDurationInMs();this.m_coachSummaryCollector.stopCoachSummary(e),this.logEndOfCoachSessionTelemetry(),this.m_sessionPaused=!1,0!==this.m_timerId&&clearInterval(this.m_timerId),this.m_presentationTimeInSeconds=0},e.prototype.pauseSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.pauseWebcamCapture(),this.m_sessionPaused=!0,this.m_speechClient.pauseSpeechRecognition(),this.m_sessionTelemetry.NumberOfPauses+=1},e.prototype.resumeSession=function(){this.m_sessionConfig.fEnableVision&&this.m_speechClient.resumeWebcamCapture(),this.m_speechClient.resumeSpeechRecognition(),this.m_sessionPaused=!1},e.prototype.enableVoiceStreaming=function(){this.m_speechClient.enableVoiceStreaming(),this.m_sessionTelemetry.RehearsalStartTime=Date.now(),this.m_sessionTelemetry.FRehearsalDidStart=!0,this.m_sessionPaused=!1},e.prototype.disableVoiceStreaming=function(){this.m_speechClient.disableVoiceStreaming(),this.m_sessionPaused=!0},e.prototype.updateSessionConfiguration=function(e){if(this.m_sessionConfig.fEnableVision&&!e.fEnableVision&&this.m_speechClient.stopWebcamCapture(),this.m_sessionConfig=e,this.m_sessionConfig.customSettings){for(var t=0,n=Object.keys(this.m_sessionConfig.customSettings);t<n.length;t++){var r=n[t],i=this.m_sessionConfig.customSettings[r];this.m_speechClient.setCustomSetting(r,i)}"currentSlideIndex"in this.m_sessionConfig.customSettings&&this.m_sessionConfig.customSettings.currentSlideIndex&&this.m_coachSummaryCollector.addSlideRehearsed(Number(this.m_sessionConfig.customSettings.currentSlideIndex))}},e.prototype.getSessionSummary=function(e){return null==e?this.m_coachSummaryCollector.getRehearsalSummary():this.m_coachSummaryCollector.getRehearsalSummary((function(t){e(t)}))},e.prototype.getSessionTranscriptRequestInfo=function(){return this.m_sessionTranscriptRequestInfo},e.prototype.getSessionDiagnostics=function(){return this.m_coachSummaryCollector.getSessionDiagnostics(this.m_sessionTelemetry)},e.prototype.getTraceRequestMetadata=function(){var e=this.m_coachSummaryCollector.getTraceRequestMetadata();return e.SessionTelemetry=JSON.stringify(this.m_sessionTelemetry),e},e.prototype.getSessionSummaryData=function(){return this.m_coachSummaryCollector.getRehearsalSummary()},e.prototype.onFinalText=function(e,t){},e.prototype.onFragmentText=function(e,t){},e.prototype.onError=function(e){r.sendTraceTag(595633888,a.LogCategory.PptSession,a.TraceLevel.Info,"Error from speech client: "+e),this.m_rehearsalId||(this.m_rehearsalId=c.v4(),this.m_sessionTelemetry.RehearsalId=this.m_rehearsalId),e?this.m_coachSummaryCollector.addError(e):this.m_coachSummaryCollector.addError("UnknownSpeechError"),this.m_events.emit("Error",e)},e.prototype.onSpeechEnd=function(){},e.prototype.onSpeechRecognitionStarted=function(e){this.m_rehearsalId=e,this.m_sessionTelemetry.RehearsalId=e,this.m_sessionTelemetry.FSpeechRecognitionStarted=!0,this.m_coachSummaryCollector&&this.m_coachSummaryCollector.setSessionId(this.m_rehearsalId),r.sendTraceTag(595633889,a.LogCategory.PptSession,a.TraceLevel.Info,"CoachManager: onSpeechRecognitionStarted Speech client Session id: "+e+" Coach Session id: "+this.m_rehearsalId),this.m_events.emit("SpeechRecognitionStarted",e)},e.prototype.onSpeechSessionStarted=function(e){this.m_sessionTranscriptRequestInfo={transcriptionSignature:e.transcriptionSignature,speechSessionHostDataCenter:e.speechSessionHostDataCenter},r.sendTraceTag(574406924,a.LogCategory.PptSession,a.TraceLevel.Info,"CoachManager: onSpeechSessionStarted Speech session host datacenter "+e.speechSessionHostDataCenter+", speech session id: "+e.speechSessionId),this.m_events.emit("SpeechSessionStarted",e)},e.prototype.onSpeechRecognitionStopped=function(e){r.sendTraceTag(574195550,a.LogCategory.PptSession,a.TraceLevel.Info,"CoachManager: onSpeechRecognitionStopped called with reason "+e),this.m_events.emit("SpeechRecognitionStopped",e)},e.prototype.onEventUpdate=function(e){if(e.eventName===a.IEventName.RehearsalDashboardUpdate){var t=e;this.updateRehearsalSummary(t.currentSlideIndex,t.features);var n={features:t.features,currentSlideIndex:t.currentSlideIndex};this.m_events.emit("PPTCoachRealtimeNotification",n),this.m_events.emit("CoachRealtimeNotification",t.features)}if(e.eventName===a.IEventName.MediaEvent){var r=e;if(r.mediaStatus===a.IMediaEventStatus.AudioDeviceConnected||r.mediaStatus===a.IMediaEventStatus.VideoSetupCompleted){var i={mediaStatus:r.mediaStatus};this.m_events.emit("MediaStatusChanged",i)}}if(e.eventName===a.IEventName.QualityStatusUpdate){var o=e,s={severity:o.severity,priority:o.priority,shortCode:o.shortCode,longCode:o.longCode,shortString:o.shortString,longString:o.longString};this.m_events.emit("QualityStatusChanged",s)}e.eventName===a.IEventName.ConnectionRetry&&(this.m_coachSummaryCollector.addError("ConnectionRetry"),this.m_events.emit("ConnectionRetry"))},e.prototype.setDisabledRealtimeFeatureSet=function(){var e=this,t=this.m_sessionConfig.disabledCoachRealtimeFeatures||"";this.m_disabledRealtimeFeatures={},t.split(",").forEach((function(t){t.length>0&&(e.m_disabledRealtimeFeatures[t.toLowerCase()]=!0)}))},e.prototype.fValidTemplate=function(e){return!(e in this.m_disabledRealtimeFeatures&&this.m_disabledRealtimeFeatures[e])},e.prototype.getClientSentTimeMS=function(e,t){var n=Date.now();if(t.has("operationMetadata")&&t.get("operationMetadata").length>0){var i=JSON.parse(t.get("operationMetadata"));i.clientSentTimeMS&&(n=Number(i.clientSentTimeMS),this.updateCritiqueLatencyInTelemetry(e,n))}else r.sendTraceTag(594616412,a.LogCategory.PptSession,a.TraceLevel.Info,"CoachManager: updateRehearsalSummary no Operation Metadata for critique name: "+e);return n},e.prototype.updateRehearsalSummary=function(e,t){var n=this,r="",a=-1;if(t.forEach((function(e,t){var i=t.toLowerCase();if(n.fValidTemplate(i)){var o=e.get("templateInfo"),s=n.getClientSentTimeMS(t,o);o.has("priority")&&Number(o.get("priority"))>a&&(a=Number(o.get("priority")),r=t,a>=0&&n.m_coachSummaryCollector.addTimestampedCritique(t,s,e))}})),a>=0&&this.updateSuggestionShownCountInTelemetry(r),t.has(i.CoachFeatures.FillerWords)){var o=[];(c=t.get(i.CoachFeatures.FillerWords)).has("featureValue")&&(o.push(String(c.get("featureValue"))),this.m_coachSummaryCollector.addFillers(o))}var s=this.getSessionDurationInMs();if(t.has(i.CoachFeatures.WordsPerMinute)&&(c=t.get(i.CoachFeatures.WordsPerMinute)).has("featureValue")&&this.m_coachSummaryCollector.addPace(Number(c.get("featureValue")),s),t.has(i.CoachFeatures.SensitivePhrases)){var c,l=[];(c=t.get(i.CoachFeatures.SensitivePhrases)).has("featureValue")&&l.push(String(c.get("featureValue")));var u=[];if(t.has(i.CoachFeatures.CorrectedSensitivePhrases)){var h=t.get(i.CoachFeatures.CorrectedSensitivePhrases);h&&u.push(String(h.get("featureValue")))}this.m_coachSummaryCollector.addSensitivePhrases(l,u)}if(t.has(i.CoachFeatures.Originality)&&this.m_coachSummaryCollector.addProblematicOriginalitySlide(e),t.has(i.CoachFeatures.Monotone)&&(c=t.get(i.CoachFeatures.Monotone))&&c.has("featureValue")&&this.m_coachSummaryCollector.addMonotone(Number(c.get("featureValue")),e,s),t.has(i.CoachFeatures.Grammar)&&(c=t.get(i.CoachFeatures.Grammar))&&(m=c.get("templateInfo"))&&this.m_coachSummaryCollector.addGrammarCritique(e,m.get("GrammarExplanation"),m.get("GrammarCategoryTitle"),m.get("GrammarContext"),m.get("GrammarCharStartInContext"),m.get("GrammarCharErrorLength"),m.get("GrammarSuggestion")),t.has(i.CoachFeatures.CrutchWords)&&(c=t.get(i.CoachFeatures.CrutchWords))&&c.has("templateInfo")&&(m=c.get("templateInfo"))&&this.m_coachSummaryCollector.addCrutchWords(JSON.parse(m.get("GenericCrutchWords")),JSON.parse(m.get("SentenceStartCrutchWord")),JSON.parse(m.get("SentenceEndCrutchWord")),Number(m.get("TotalWordsCount"))),t.has(i.CoachFeatures.Pronunciation)&&(c=t.get(i.CoachFeatures.Pronunciation))&&c.has("templateInfo"))for(var m=c.get("templateInfo"),d=JSON.parse(m.get("MispronouncedWordsKey")),p=0;p<d.length;p+=1){for(var f=[],g=d[p.toString()].Phonemes,v=0;v<g.length;v+=1)f.push(g[v.toString()].Phoneme);this.m_coachSummaryCollector.addMispronouncedWords(d[p.toString()].Word,parseInt(d[p.toString()].WordSlideNo,10),parseInt(d[p.toString()].LowestPhonemeScoreIndex,10),f.join("."),d[p.toString()].Syllables)}if(t.has(i.CoachFeatures.Gaze)){this.m_coachSummaryCollector.addVisionGaze(this.getSessionDurationInMs());var y=this.getVisionFrameData(t,i.CoachFeatures.Gaze);this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.Gaze,y.visionFrame,y.visionConfidenceScore)}t.has(i.CoachFeatures.GazeGood)&&(this.m_coachSummaryCollector.addVisionGaze(this.getSessionDurationInMs()),y=this.getVisionFrameData(t,i.CoachFeatures.GazeGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.GazeGood,y.visionFrame,y.visionConfidenceScore)),t.has(i.CoachFeatures.Occlusion)&&(this.m_coachSummaryCollector.addVisionOcclusion(this.getSessionDurationInMs()),y=this.getVisionFrameData(t,i.CoachFeatures.Occlusion),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.Occlusion,y.visionFrame,y.visionConfidenceScore)),t.has(i.CoachFeatures.OcclusionGood)&&(this.m_coachSummaryCollector.addVisionOcclusion(this.getSessionDurationInMs()),y=this.getVisionFrameData(t,i.CoachFeatures.OcclusionGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.OcclusionGood,y.visionFrame,y.visionConfidenceScore)),t.has(i.CoachFeatures.DistanceGood)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),i.CoachFeatures.DistanceGood),y=this.getVisionFrameData(t,i.CoachFeatures.DistanceGood),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.DistanceGood,y.visionFrame,y.visionConfidenceScore)),t.has(i.CoachFeatures.DistanceTooClose)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),i.CoachFeatures.DistanceTooClose),y=this.getVisionFrameData(t,i.CoachFeatures.DistanceTooClose),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.DistanceTooClose,y.visionFrame,y.visionConfidenceScore)),t.has(i.CoachFeatures.DistanceTooFar)&&(this.m_coachSummaryCollector.addVisionDistance(this.getSessionDurationInMs(),i.CoachFeatures.DistanceTooFar),y=this.getVisionFrameData(t,i.CoachFeatures.DistanceTooFar),this.m_coachSummaryCollector.addVisionCritiqueFrame(this.getSessionDurationInMs(),i.CoachFeatures.DistanceTooFar,y.visionFrame,y.visionConfidenceScore))},e.prototype.getVisionFrameData=function(e,t){var n,r=e.get(t),i=0;if(r&&r.has("templateInfo")){var a=r.get("templateInfo");n=a.get("visionFrame"),i=a.has("confidenceScore")?Number(JSON.parse(a.get("confidenceScore"))):i}return{visionFrame:n,visionConfidenceScore:i}},e.prototype.setUpSpeechClient=function(){var e={clientApp:this.m_sessionConfig.clientApp,clientMetaData:new Map([["rehearsalMetadata",l.getRehearsalMetadataJSON(this.m_sessionConfig,this.m_userToken)],["userID",this.m_sessionConfig.userId||""],["tenantId",this.m_sessionConfig.tenantId||""],["identityProvider",this.m_sessionConfig.identityProvider||""],["audienceChannel",this.m_sessionConfig.audienceChannel||""],["audienceGroup",this.m_sessionConfig.audienceGroup||""],["buildVersion",this.m_sessionConfig.buildVersion||""],["locale",this.m_sessionConfig.locale||""],["wacHost",this.m_sessionConfig.wacHost||""],["wacDatacenter",this.m_sessionConfig.wacDatacenter||""],["sessionTranscriptionRequested",String(this.m_sessionConfig.sessionTranscriptionRequested)||"false"],["referenceText",this.m_sessionConfig.referenceText||""]]),properties:null,sourceLanguage:this.m_sourceLanguage,speechFDBase:this.m_sessionConfig.speechFDBase,speechMode:this.m_sessionConfig.coachMode?a.ISpeechMode[this.m_sessionConfig.coachMode]:a.ISpeechMode.Rehearsal,targetLanguages:this.getTargetLanguagesFromSourceLanguage(this.m_sourceLanguage),handleEndOfAudioInSpeechClientStopRecognition:this.m_sessionConfig.fSendEndOfAudioOnSessionStop};this.m_sessionConfig.fEnableVision&&this.m_sessionConfig.webcamConfig&&(e.webcamConfig=this.m_sessionConfig.webcamConfig),this.m_sessionConfig.documentDownloadConfig&&(e.documentDownloadConfig=this.m_sessionConfig.documentDownloadConfig),this.m_speechClient=this.m_speechClient||(new a.SpeechClientFactory).createSpeechClient(e,this,{accessToken:"RehearsalAccessToken"},new a.MediaCaptureSource,r,new a.ClientWebSocketFactory)},e.prototype.checkOrGetDefaultSourceLanguage=function(e,t){return e&&null!=e&&0!==e.trim().length?e:(r.sendTraceTag(591995141,a.LogCategory.PptSession,a.TraceLevel.Error,"CoachManager: setUpSpeechClient source language is undefined/null/Empty/invalid for UserSessionId: "+t+", will default to english"),"en-US")},e.prototype.getTargetLanguagesFromSourceLanguage=function(e){return e.split("-")[0]},e.prototype.initializeCoachSessionTelemetry=function(){this.m_sessionTelemetry.FRehearsalDidStart=!1,this.m_sessionTelemetry.SuggestionCountsByName={},this.m_sessionTelemetry.CritiqueLatencyTelemetry={},this.m_sessionTelemetry.NumberOfPauses=0,this.m_sessionTelemetry.RehearsalStartTime=0,this.m_sessionTelemetry.RehearsalEndTime=0,this.m_sessionTelemetry.FDidSeeSuggestions=!1,this.m_sessionTelemetry.NumberOfSlidesWithOriginalitySuggestion=0,this.m_sessionTelemetry.NumberOfSlidesRehearsed=0,this.m_sessionTelemetry.RehearsalDurationInSeconds=0,this.m_sessionTelemetry.RehearsalId="",this.m_sessionTelemetry.FSpeechRecognitionStarted=!1,this.m_sessionTelemetry.AverageWPM=0},e.prototype.logEndOfCoachSessionTelemetry=function(){var e;this.m_sessionTelemetry.NumberOfSlidesRehearsed=this.m_coachSummaryCollector.getNumSlidesRehearsed(),this.m_sessionTelemetry.RehearsalDurationInSeconds=this.m_coachSummaryCollector.getTimeSpent(),this.m_sessionTelemetry.NumberOfSlidesWithOriginalitySuggestion=this.m_coachSummaryCollector.getOriginalityProblemSlides().length,this.m_sessionTelemetry.AverageWPM=this.m_coachSummaryCollector.getAveragePace(),this.m_sessionTelemetry.RehearsalEndTime=Date.now(),this.m_sessionTelemetry.FDidSeeSuggestions=Object.keys(this.m_sessionTelemetry.SuggestionCountsByName).length>0,this.m_sessionTelemetry.EntryPoint=this.m_sessionConfig.entryPoint||"",this.m_sessionTelemetry.SourceLanguage=this.m_sourceLanguage,this.m_sessionTelemetry.FVisionEnabled=null!==(e=this.m_sessionConfig.fEnableVision)&&void 0!==e&&e;var t=this.m_coachSummaryCollector.getCrutchWords();this.m_sessionTelemetry.SuggestionCountsByName.crutchwords=t.length,this.m_sessionTelemetry.CrutchWordUsageCounts=t.map((function(e){return e.count})),r.sendTraceTag(595641246,a.LogCategory.PptSession,a.TraceLevel.Info,JSON.stringify(this.m_sessionTelemetry))},e.prototype.updateSuggestionShownCountInTelemetry=function(e){e.toLowerCase()in this.m_sessionTelemetry.SuggestionCountsByName?this.m_sessionTelemetry.SuggestionCountsByName[e.toLowerCase()]+=1:this.m_sessionTelemetry.SuggestionCountsByName[e.toLowerCase()]=1},e.prototype.addFeatureToCritiqueLatencyTelemetry=function(e){this.m_sessionTelemetry.CritiqueLatencyTelemetry[e]={MaxCoachCritiqueLatencyInMS:0,TotalCoachCritiqueLatencyInMS:0,TotalCoachCritiqueLatencyCount:0}},e.prototype.updateCritiqueLatencyInTelemetry=function(e,t){var n=Date.now()-t;if(n<=0)r.sendTraceTag(593248641,a.LogCategory.PptSession,a.TraceLevel.Error,"updateCritiqueLatencyInTelemetry has negative or 0 latency. RehearsalId: "+this.m_rehearsalId);else{var i=e.toLowerCase();i in this.m_sessionTelemetry.CritiqueLatencyTelemetry||this.addFeatureToCritiqueLatencyTelemetry(i),n>this.m_sessionTelemetry.CritiqueLatencyTelemetry[i].MaxCoachCritiqueLatencyInMS&&(this.m_sessionTelemetry.CritiqueLatencyTelemetry[i].MaxCoachCritiqueLatencyInMS=n),this.m_sessionTelemetry.CritiqueLatencyTelemetry[i].TotalCoachCritiqueLatencyInMS+=n,this.m_sessionTelemetry.CritiqueLatencyTelemetry[i].TotalCoachCritiqueLatencyCount+=1}},e.prototype.updateTimer=function(){this.m_sessionPaused||(this.m_presentationTimeInSeconds+=1)},e}();t.CoachManager=u},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}},function(e,t,n){var r=n(162);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";(function(e){var r=n(168),i=n(169),a=n(170);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=m(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):m(e,t);if("Buffer"===t.type&&a(t.data))return m(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function m(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return B(e).length;t=(""+t).toLowerCase(),r=!0}}function f(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a,o=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var u=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===c)return u*o}else-1!==u&&(a-=a-u),u=-1}else for(n+c>s&&(n=s-c),a=n;a>=0;a--){for(var h=!0,m=0;m<c;m++)if(l(e,a+m)!==l(t,m)){h=!1;break}if(h)return a}return-1}function C(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function S(e,t,n,r){return U(B(t,e.length-n),e,n,r)}function _(e,t,n,r){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return _(e,t,n,r)}function b(e,t,n,r){return U(H(t),e,n,r)}function R(e,t,n,r){return U(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,c,l=e[i],u=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(a=e[i+1]))&&(c=(31&l)<<6|63&a)>127&&(u=c);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(c=(15&l)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function F(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=V(e[a]);return i}function D(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,i,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function x(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function P(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,r,a){return a||P(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,a){return a||P(e,0,n,8),i.write(e,t,n,r,52,8),n+8}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):f.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),u=e.slice(t,n),h=0;h<s;++h)if(l[h]!==u[h]){a=l[h],o=u[h];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return C(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=c.isBuffer(e)?e:B(new c(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var O=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(66))},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=l(e),o=r[0],s=r[1],c=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),u=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(u(e,o,o+16383>s?s:o+16383));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,c=(1<<s)-1,l=c>>1,u=-7,h=n?i-1:0,m=n?-1:1,d=e[t+h];for(h+=m,a=d&(1<<-u)-1,d>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=m,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=m,u-=8);if(0===a)a=1-l;else{if(a===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=l}return(d?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,c,l=8*a-i-1,u=(1<<l)-1,h=u>>1,m=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?m/c:m*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*c-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+d]=255&o,d+=p,o/=256,l-=8);e[n+d-p]|=128*f}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r,i,a=n(112),o=n(113),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],h=(e=e||{}).node||r,m=void 0!==e.clockseq?e.clockseq:i;if(null==h||null==m){var d=a();null==h&&(h=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==m&&(m=i=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:c+1,g=p-s+(f-c)/1e4;if(g<0&&void 0===e.clockseq&&(m=m+1&16383),(g<0||p>s)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,c=f,i=m;var v=(1e4*(268435455&(p+=122192928e5))+f)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var y=p/4294967296*1e4&268435455;u[l++]=y>>>8&255,u[l++]=255&y,u[l++]=y>>>24&15|16,u[l++]=y>>>16&255,u[l++]=m>>>8|128,u[l++]=255&m;for(var C=0;C<6;++C)u[l+C]=h[C];return t||o(u)}},function(e,t,n){var r=n(112),i=n(113);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||i(o)}},function(e,t,n){var r=n(16);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(177),i=n(181),a=function(){function e(){}return e.createCoachSummaryCollector=function(e,t){var n=e.logger,a=!(null===e.fEnableServiceSideAggregationForCoach||!e.fEnableServiceSideAggregationForCoach)&&e.fEnableServiceSideAggregationForCoach,o=null!==e.speechFDBase&&void 0!==e.speechFDBase?e.speechFDBase.replace("wss","https"):this.SpeechFDBase;return o=o.replace("ws","http"),a?new r.CoachSummaryCollectorServiceEnd(n,o,t):new i.CoachSummaryCollectorClientEnd(n)},e.SpeechFDBase="wss://pptservicescast.officeapps.live.com/",e}();t.CoachSummaryCollectorFactory=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(115),o=n(179),s=function(e){function t(t,n,r){var i=e.call(this)||this;return i.m_averagePace=0,i.m_totalSessionTimeInSec=-1,i.m_crutchWordsData=[],i.m_mispronouncedWordsData=[],i.m_serviceUrl=n,i.m_userToken=r,i}return i(t,e),t.prototype.reset=function(){this.m_averagePace=0,this.m_totalSessionTimeInSec=-1,this.m_crutchWordsData=[],this.m_mispronouncedWordsData=[],e.prototype.reset.call(this)},t.prototype.addPace=function(e,t){},t.prototype.addFillers=function(e){},t.prototype.addSensitivePhrases=function(e,t){},t.prototype.addProblematicOriginalitySlide=function(e){},t.prototype.addSlideRehearsed=function(e){},t.prototype.addMonotone=function(e,t,n){},t.prototype.addGrammarCritique=function(e,t,n,r,i,a,o){},t.prototype.addCrutchWords=function(e,t,n,r){},t.prototype.addMispronouncedWords=function(e,t,n,r,i){},t.prototype.addVisionGaze=function(e){},t.prototype.addVisionOcclusion=function(e){},t.prototype.addVisionDistance=function(e,t){},t.prototype.addVisionCritiqueFrame=function(e,t,n,r){},t.prototype.getAveragePace=function(){return Math.round(this.m_averagePace)},t.prototype.getCrutchWords=function(){var e=this.m_crutchWordsData?this.m_crutchWordsData:[];return e.sort((function(e,t){return t.count-e.count})),e},t.prototype.getMispronouncedWords=function(){var e=this.m_mispronouncedWordsData?this.m_mispronouncedWordsData:[];return e.sort((function(e,t){return t.count-e.count})),e},t.prototype.getMonotoneOverTime=function(){return this.m_monotoneOverTime},t.prototype.addFillerWords=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){0!==e.count&&(t.m_fillers[e.word]=e.count)}))},t.prototype.addProblematicOriginalitySlideIndexes=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){t.m_originalityScores[e]=!0}))},t.prototype.addSensitivePhraseData=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){void 0===t.m_sensitivePhrases[e.Phrase]&&(t.m_sensitivePhrases[e.Phrase]={count:0,correction:""}),t.m_sensitivePhrases[e.Phrase].count+=e.Count,t.m_sensitivePhrases[e.Phrase].correction=e.Correction}))},t.prototype.addSlideRehearsedIndexes=function(e){var t=this;e&&0!==e.length&&e.forEach((function(e){t.m_slidesRehearsed[e]=!0}))},t.prototype.prepareSummaryData=function(e){var t=JSON.parse(e);null!=t&&(this.m_averagePace=t.AveragePace?t.AveragePace:0,this.m_totalSessionTimeInSec=t.TimeSpentSeconds?t.TimeSpentSeconds:0,this.m_crutchWordsData=t.CrutchWords?t.CrutchWords:[],this.m_grammarCritiques=t.GrammarSuggestions?t.GrammarSuggestions:[],this.m_mispronouncedWordsData=t.MispronouncedWordsData?t.MispronouncedWordsData:[],this.m_monotoneOverTime=t.MonotoneOverTime?t.MonotoneOverTime:[],this.m_paceOverTime=t.PaceOverTime?t.PaceOverTime:[],this.m_paceOverTime.forEach((function(e){e.timePoint=1e3*e.timePoint})),this.m_visionCritiqueFrames=t.VisionCritiqueFrames?t.VisionCritiqueFrames:{},this.addFillerWords(t.Fillers?t.Fillers:[]),this.addProblematicOriginalitySlideIndexes(t.OriginalityProblemSlidesIndex?t.OriginalityProblemSlidesIndex:[]),this.addSensitivePhraseData(t.CorrectedSensitivePhraseData?t.CorrectedSensitivePhraseData:[]),this.addSlideRehearsedIndexes(t.SlidesRehearsedIndexes?t.SlidesRehearsedIndexes:[]));var n=this.getSortedSensitivePhrases(!0);return{fillers:this.getFillers(),sensitivePhrases:n.map((function(e){return e.phraseData})),sensitivePhrasesCorrected:n.map((function(e){return e.correction})),originalityProblemSlides:this.getOriginalityProblemSlides(),timeSpent:this.getTimeSpent(),averagePace:this.getAveragePace(),paceOverTime:this.getPaceOverTime(),slidesRehearsed:this.getNumSlidesRehearsed(),timestampedCritiques:this.getTimestampedCritiques(),monotoneOverTime:this.getMonotoneOverTime(),grammarInfos:this.getGrammar(),pronunciationInfo:this.getMispronouncedWords(),thumbIndices:this.getThumbIndicesForSummary(),visionGazeInfos:this.m_visionGazeCritiques,visionOcclusionInfos:this.m_visionOcclusionCritiques,visionDistanceInfos:this.m_visionDistanceCritiques,visionCritiqueFrames:this.m_visionCritiqueFrames,crutchWords:this.getCrutchWords()}},t.prototype.getRehearsalSummary=function(e){var t=this,n=this.m_serviceUrl+"CoachResultSummaryHandler.ashx?Client=web&usersessionid="+this.m_sessionId+"&action=GetCoachSummaryDataJSON";return o.makeCoachResultSummaryRequest(n,(function(n){var r=t.prepareSummaryData(n);e(r)}),this.m_userToken),{}},t}(a.BaseCoachSummaryCollector);t.CoachSummaryCollectorServiceEnd=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapToObjectHelper=function e(t){var n={};return t.forEach((function(t,r){t instanceof Map?n[r]=e(t):n[r]=t})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(180),a=function(){function e(){}return e.ContentType="Content-Type",e.Authorization="Authorization",e}();t.CoachSummaryRequestHeaderFieldNames=a,function(e){e.GET="get",e.POST="post"}(r=t.RequestMethod||(t.RequestMethod={}));var o=function(){function e(){}return e.CONTENT_TYPE="application/json",e.MAX_RETRIES=1,e}();t.CoachSummaryRequestSettings=o,t.makeCoachResultSummaryRequest=function(e,t,n){var s=null!=n?n:"",c={};return c[a.ContentType]=o.CONTENT_TYPE,c[a.Authorization]=s,i.makeHttpRequest(r.GET,e,"",null,c,(function(e,n,r){200!==e.status&&r(new Error("Non-200 response with status code: ${xhr.status}, status text: ${xhr.statusText}")),n(e),t(e.responseText)}),o.MAX_RETRIES)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHttpRequest=function(e,t,n,r,i,a,o){void 0===n&&(n={}),void 0===r&&(r=null),void 0===i&&(i={}),void 0===o&&(o=1);var s=function(o){return new Promise((function(c,l){var u=function(e,t){e>0?s(e-1).then(c,l):l(new Error(t))},h=new XMLHttpRequest,m=function(e,t){void 0===t&&(t={});var n=function(e){return void 0===e&&(e={}),Object.keys(e).map((function(t){return encodeURIComponent(t)+" = "+encodeURIComponent(e[t])})).join("&")}(t);return n?e+(-1===e.indexOf("?")?"?":"&")+n:e}(t,n);h.open(e,m,!0),i&&Object.keys(i).forEach((function(e){return h.setRequestHeader(e,i[e])})),h.timeout=2e3,h.onload=function(){a(h,c,l)},h.ontimeout=function(){u(o,o>0?"":"Request to '"+t+"' timed out. timeout: 2000")},h.onerror=function(){var e=o>0?"":"Request to '"+t+"' errored. "+h.status+": "+h.responseText;u(o,e)},"post"===e&&r?(h.setRequestHeader("Content-Type","application/json"),h.send(JSON.stringify(r))):h.send()}))};return s(o)}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(79),s=n(115),c=n(154),l=function(e){function t(t){var n=e.call(this)||this;return n.m_paceSamplingInverseRate=1,n.m_paceSamplingPortion=0,n.m_genericCrutchWordCounts={},n.m_sentenceStartCrutchWordCounts={},n.m_sentenceEndCrutchWordCounts={},n.m_totalWordCount=0,n.m_finalCrutchWords=[],n.m_mispronouncedWordsMap={},a=t,n}return i(t,e),t.prototype.reset=function(){this.m_paceSamplingInverseRate=1,this.m_paceSamplingPortion=0,this.m_mispronouncedWordsMap={},this.m_genericCrutchWordCounts={},this.m_sentenceStartCrutchWordCounts={},this.m_sentenceEndCrutchWordCounts={},this.m_totalWordCount=0,this.m_finalCrutchWords=[],e.prototype.reset.call(this)},t.prototype.stopCoachSummary=function(t){this.calculateCrutchWords(),e.prototype.stopCoachSummary.call(this,t)},t.prototype.addPace=function(e,t){if(this.ensureIsStarted(),this.m_paceSamplingPortion%this.m_paceSamplingInverseRate==0&&this.m_paceOverTime.push({pace:e,timePoint:t}),this.m_paceSamplingPortion+=1,this.m_paceOverTime.length>=s.BaseCoachSummaryCollector.MaxPaceTimePoints){for(var n=[],r=0;r<this.m_paceOverTime.length;r+=1)r%2==0&&n.push(this.m_paceOverTime[r]);this.m_paceOverTime=n,this.m_paceSamplingInverseRate*=2,this.m_paceSamplingPortion=0}},t.addCountsToHashMap=function(e,t){0!==t.length&&t.forEach((function(t){0!==t.length&&(void 0===e[t]&&(e[t]=0),e[t]+=1)}))},t.prototype.addFillers=function(e){this.ensureIsStarted(),t.addCountsToHashMap(this.m_fillers,e)},t.prototype.addSensitivePhrases=function(e,t){var n=this;this.ensureIsStarted();var r=void 0!==t&&t.length>0;r&&t.length!==e.length&&(r=!1,a.sendTraceTag(576583395,o.LogCategory.PptSession,c.TraceLevel.Error,"CoachSummaryCollectorClientEnd::AddSensitivePhrases Length of corrected phrases does not match length of phrases")),e.forEach((function(e,i){0!==e.length&&(void 0===n.m_sensitivePhrases[e]&&(n.m_sensitivePhrases[e]={count:0,correction:""}),n.m_sensitivePhrases[e].count+=1,n.m_sensitivePhrases[e].correction=r?t[i]:"")}))},t.prototype.addProblematicOriginalitySlide=function(e){this.ensureIsStarted(),this.m_originalityScores[e]=!0},t.prototype.addSlideRehearsed=function(e){this.ensureIsStarted(),this.m_slidesRehearsed[e]=!0},t.prototype.addMonotone=function(e,t,n){this.ensureIsStarted(),this.m_monotoneOverTime.length<s.BaseCoachSummaryCollector.MaxMonotoneTimePoints&&this.m_monotoneOverTime.push({pvq:e,slide:t,timePoint:n})},t.prototype.addGrammarCritique=function(e,t,n,r,i,a,o){this.m_grammarCritiques.push({slideIndex:e,helpText:t,category:n,originalText:r,triggerStart:i,triggerLength:a,suggestionText:o})},t.prototype.addCrutchWords=function(e,t,n,r){this.ensureIsStarted();for(var i=0,a=e;i<a.length;i++)(u=a[i])in this.m_genericCrutchWordCounts?this.m_genericCrutchWordCounts[u]+=1:this.m_genericCrutchWordCounts[u]=1;for(var o=0,s=t;o<s.length;o++)(u=s[o])in this.m_sentenceStartCrutchWordCounts?this.m_sentenceStartCrutchWordCounts[u]+=1:this.m_sentenceStartCrutchWordCounts[u]=1;for(var c=0,l=n;c<l.length;c++){var u;(u=l[c])in this.m_sentenceEndCrutchWordCounts?this.m_sentenceEndCrutchWordCounts[u]+=1:this.m_sentenceEndCrutchWordCounts[u]=1}this.m_totalWordCount+=r},t.prototype.calculateModeForLowestPhonemeIndex=function(e){var t={};if(0===e.length)return 0;e.forEach((function(e){void 0===t[e]&&(t[e]=0),t[e]+=1}));var n=0,r=-1;for(var i in t)t[i]>=r&&(r=t[i],n=Number(i));return n},t.prototype.addMispronouncedWords=function(e,t,n,r,i){this.ensureIsStarted(),void 0===this.m_mispronouncedWordsMap[e]&&(this.m_mispronouncedWordsMap[e]={count:0,slideNumber:new Set,lowestPhonemeIndex:[],phonemeSequence:"",syllables:""}),this.m_mispronouncedWordsMap[e].count+=1,this.m_mispronouncedWordsMap[e].slideNumber.add(t),this.m_mispronouncedWordsMap[e].lowestPhonemeIndex.push(n),this.m_mispronouncedWordsMap[e].phonemeSequence=r,this.m_mispronouncedWordsMap[e].syllables=i},t.prototype.addVisionGaze=function(e){this.m_visionGazeCritiques.push(e)},t.prototype.addVisionOcclusion=function(e){this.m_visionOcclusionCritiques.push(e)},t.prototype.addVisionDistance=function(e,t){this.m_visionDistanceCritiques.push({critiqueTime:e,distanceCritiqueName:t})},t.prototype.addVisionCritiqueFrame=function(e,t,n,r){n&&t&&(void 0!==this.m_visionCritiqueFrames[t]?this.m_visionCritiqueFrames[t].confidenceScore<r&&(this.m_visionCritiqueFrames[t]={critiqueTime:e,critiqueFrame:n,confidenceScore:r}):this.m_visionCritiqueFrames[t]={critiqueTime:e,critiqueFrame:n,confidenceScore:r})},t.prototype.getAveragePace=function(){if(this.m_paceOverTime.length>0){var e=0;return this.m_paceOverTime.forEach((function(t){e+=t.pace})),Math.round(e/this.m_paceOverTime.length)}return 0},t.prototype.calculateCrutchWords=function(){var e={},t=this.m_totalWordCount<200?2:Math.min(this.m_totalWordCount/100,20);Object.entries(this.m_genericCrutchWordCounts).forEach((function(n){var r=n[0],i=n[1];i>t&&(e[r]=i)})),Object.entries(this.m_sentenceStartCrutchWordCounts).forEach((function(t){var n=t[0],r=t[1];r>2&&(n in e?e[n]+=r:e[n]=r)})),Object.entries(this.m_sentenceEndCrutchWordCounts).forEach((function(t){var n=t[0],r=t[1];r>2&&(n in e?e[n]+=r:e[n]=r)}));var n=[];Object.entries(e).forEach((function(e){var t=e[0],r=e[1];n.push({word:t,count:r})})),n.sort((function(e,t){return t.count-e.count})),this.m_finalCrutchWords=n},t.prototype.getCrutchWords=function(){return this.m_finalCrutchWords},t.prototype.getMispronouncedWords=function(){var e=this,t=[];return Object.keys(this.m_mispronouncedWordsMap).forEach((function(n){t.push({word:n,count:e.m_mispronouncedWordsMap[n].count,slideNumber:Array.from(e.m_mispronouncedWordsMap[n].slideNumber.values()),lowestPhonemeIndex:e.calculateModeForLowestPhonemeIndex(e.m_mispronouncedWordsMap[n].lowestPhonemeIndex),phonemeSequence:e.m_mispronouncedWordsMap[n].phonemeSequence,syllables:e.m_mispronouncedWordsMap[n].syllables})})),t.sort((function(e,t){return t.count-e.count})),t},t.prototype.getMonotoneOverTime=function(){var e=[];return this.m_monotoneOverTime.forEach((function(t){e.push({pvq:Math.round(1e3*t.pvq),timePoint:Math.round(t.timePoint/1e3),slide:t.slide})})),e},t.prototype.getRehearsalSummary=function(e){var t=this.getSortedSensitivePhrases(!0),n={fillers:this.getFillers(),sensitivePhrases:t.map((function(e){return e.phraseData})),sensitivePhrasesCorrected:t.map((function(e){return e.correction})),originalityProblemSlides:this.getOriginalityProblemSlides(),timeSpent:this.getTimeSpent(),averagePace:this.getAveragePace(),paceOverTime:this.getPaceOverTime(),slidesRehearsed:this.getNumSlidesRehearsed(),timestampedCritiques:this.getTimestampedCritiques(),monotoneOverTime:this.getMonotoneOverTime(),grammarInfos:this.getGrammar(),pronunciationInfo:this.getMispronouncedWords(),thumbIndices:this.getThumbIndicesForSummary(),visionGazeInfos:this.m_visionGazeCritiques,visionOcclusionInfos:this.m_visionOcclusionCritiques,visionDistanceInfos:this.m_visionDistanceCritiques,visionCritiqueFrames:this.m_visionCritiqueFrames,crutchWords:this.getCrutchWords()};return null!=e&&e(n),n},t}(s.BaseCoachSummaryCollector);t.CoachSummaryCollectorClientEnd=l},function(e,t,n){"use strict";(function(e){function r(){return e._babelPolyfill||"undefined"!=typeof window&&window._babelPolyfill?null:n(183)}Object.defineProperty(t,"__esModule",{value:!0}),t.idempotentBabelPolyfill=r,t.default=void 0;var i=r();t.default=i}).call(this,n(66))},function(e,t,n){"use strict";n(184);var r,i=(r=n(355))&&r.__esModule?r:{default:r};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},function(e,t,n){"use strict";n(185),n(328),n(330),n(333),n(335),n(337),n(339),n(341),n(343),n(345),n(347),n(349),n(351),n(110)},function(e,t,n){n(186),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(267),n(268),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(100),n(291),n(136),n(292),n(137),n(293),n(294),n(295),n(296),n(138),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),e.exports=n(11)},function(e,t,n){"use strict";var r=n(4),i=n(21),a=n(14),o=n(0),s=n(18),c=n(37).KEY,l=n(5),u=n(67),h=n(51),m=n(42),d=n(8),p=n(81),f=n(117),g=n(188),v=n(70),y=n(6),C=n(7),S=n(17),_=n(23),T=n(36),b=n(41),R=n(46),w=n(120),E=n(30),M=n(69),I=n(15),F=n(44),D=E.f,A=I.f,k=w.f,x=r.Symbol,L=r.JSON,P=L&&L.stringify,W=d("_hidden"),N=d("toPrimitive"),O={}.propertyIsEnumerable,V=u("symbol-registry"),B=u("symbols"),H=u("op-symbols"),U=Object.prototype,q="function"==typeof x&&!!M.f,j=r.QObject,G=!j||!j.prototype||!j.prototype.findChild,z=a&&l((function(){return 7!=R(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=D(U,t);r&&delete U[t],A(e,t,n),r&&e!==U&&A(U,t,r)}:A,J=function(e){var t=B[e]=R(x.prototype);return t._k=e,t},X=q&&"symbol"==typeof x.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof x},Q=function(e,t,n){return e===U&&Q(H,t,n),y(e),t=T(t,!0),y(n),i(B,t)?(n.enumerable?(i(e,W)&&e[W][t]&&(e[W][t]=!1),n=R(n,{enumerable:b(0,!1)})):(i(e,W)||A(e,W,b(1,{})),e[W][t]=!0),z(e,t,n)):A(e,t,n)},Y=function(e,t){y(e);for(var n,r=g(t=_(t)),i=0,a=r.length;a>i;)Q(e,n=r[i++],t[n]);return e},K=function(e){var t=O.call(this,e=T(e,!0));return!(this===U&&i(B,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,W)&&this[W][e])||t)},Z=function(e,t){if(e=_(e),t=T(t,!0),e!==U||!i(B,t)||i(H,t)){var n=D(e,t);return!n||!i(B,t)||i(e,W)&&e[W][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=k(_(e)),r=[],a=0;n.length>a;)i(B,t=n[a++])||t==W||t==c||r.push(t);return r},ee=function(e){for(var t,n=e===U,r=k(n?H:_(e)),a=[],o=0;r.length>o;)!i(B,t=r[o++])||n&&!i(U,t)||a.push(B[t]);return a};q||(s((x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var e=m(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(H,n),i(this,W)&&i(this[W],e)&&(this[W][e]=!1),z(this,e,b(1,n))};return a&&G&&z(U,e,{configurable:!0,set:t}),J(e)}).prototype,"toString",(function(){return this._k})),E.f=Z,I.f=Q,n(47).f=w.f=$,n(62).f=K,M.f=ee,a&&!n(43)&&s(U,"propertyIsEnumerable",K,!0),p.f=function(e){return J(d(e))}),o(o.G+o.W+o.F*!q,{Symbol:x});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)d(te[ne++]);for(var re=F(d.store),ie=0;re.length>ie;)f(re[ie++]);o(o.S+o.F*!q,"Symbol",{for:function(e){return i(V,e+="")?V[e]:V[e]=x(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in V)if(V[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!q,"Object",{create:function(e,t){return void 0===t?R(e):Y(R(e),t)},defineProperty:Q,defineProperties:Y,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:ee});var ae=l((function(){M.f(1)}));o(o.S+o.F*ae,"Object",{getOwnPropertySymbols:function(e){return M.f(S(e))}}),L&&o(o.S+o.F*(!q||l((function(){var e=x();return"[null]"!=P([e])||"{}"!=P({a:e})||"{}"!=P(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(C(t)||void 0!==e)&&!X(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!X(t))return t}),r[1]=t,P.apply(L,r)}}),x.prototype[N]||n(22)(x.prototype,N,x.prototype.valueOf),h(x,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(e,t,n){e.exports=n(67)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(44),i=n(69),a=n(62);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var o,s=n(e),c=a.f,l=0;s.length>l;)c.call(e,o=s[l++])&&t.push(o);return t}},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(46)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(14),"Object",{defineProperty:n(15).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(14),"Object",{defineProperties:n(119)})},function(e,t,n){var r=n(23),i=n(30).f;n(31)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},function(e,t,n){var r=n(17),i=n(48);n(31)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(17),i=n(44);n(31)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(31)("getOwnPropertyNames",(function(){return n(120).f}))},function(e,t,n){var r=n(7),i=n(37).onFreeze;n(31)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(7),i=n(37).onFreeze;n(31)("seal",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(7),i=n(37).onFreeze;n(31)("preventExtensions",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(7);n(31)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(7);n(31)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(7);n(31)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(121)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(122)})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(85).set})},function(e,t,n){"use strict";var r=n(63),i={};i[n(8)("toStringTag")]="z",i+""!="[object z]"&&n(18)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(123)})},function(e,t,n){var r=n(15).f,i=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in i||n(14)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(7),i=n(48),a=n(8)("hasInstance"),o=Function.prototype;a in o||n(15).f(o,a,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(0),i=n(125);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(0),i=n(126);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(4),i=n(21),a=n(33),o=n(87),s=n(36),c=n(5),l=n(47).f,u=n(30).f,h=n(15).f,m=n(52).trim,d=r.Number,p=d,f=d.prototype,g="Number"==a(n(46)(f)),v="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,a=(t=v?t.trim():m(t,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,c=t.slice(2),l=0,u=c.length;l<u;l++)if((o=c.charCodeAt(l))<48||o>i)return NaN;return parseInt(c,r)}}return+t};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof d&&(g?c((function(){f.valueOf.call(n)})):"Number"!=a(n))?o(new p(y(t)),n,d):y(t)};for(var C,S=n(14)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;S.length>_;_++)i(p,C=S[_])&&!i(d,C)&&h(d,C,u(p,C));d.prototype=f,f.constructor=d,n(18)(r,"Number",d)}},function(e,t,n){"use strict";var r=n(0),i=n(29),a=n(127),o=n(88),s=1..toFixed,c=Math.floor,l=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",h=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*l[n],l[n]=r%1e7,r=c(r/1e7)},m=function(e){for(var t=6,n=0;--t>=0;)n+=l[t],l[t]=c(n/e),n=n%e*1e7},d=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==l[e]){var n=String(l[e]);t=""===t?n:t+o.call("0",7-n.length)+n}return t},p=function(e,t,n){return 0===t?n:t%2==1?p(e,t-1,n*e):p(e*e,t/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,n,r,s,c=a(this,u),l=i(e),f="",g="0";if(l<0||l>20)throw RangeError(u);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(f="-",c=-c),c>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(c*p(2,69,1))-69)<0?c*p(2,-t,1):c/p(2,t,1),n*=4503599627370496,(t=52-t)>0){for(h(0,n),r=l;r>=7;)h(1e7,0),r-=7;for(h(p(10,r,1),0),r=t-1;r>=23;)m(1<<23),r-=23;m(1<<r),h(1,1),m(2),g=d()}else h(0,n),h(1<<-t,0),g=d()+o.call("0",l);return l>0?f+((s=g.length)<=l?"0."+o.call("0",l-s)+g:g.slice(0,s-l)+"."+g.slice(s-l)):f+g}})},function(e,t,n){"use strict";var r=n(0),i=n(5),a=n(127),o=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==o.call(1,void 0)}))||!i((function(){o.call({})}))),"Number",{toPrecision:function(e){var t=a(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),i=n(4).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(128)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),i=n(128),a=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&a(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),i=n(126);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(0),i=n(125);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(0),i=n(129),a=Math.sqrt,o=Math.acosh;r(r.S+r.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+a(e-1)*a(e+1))}})},function(e,t,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),i=n(89);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(0),i=n(90);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(231)})},function(e,t,n){var r=n(89),i=Math.pow,a=i(2,-52),o=i(2,-23),s=i(2,127)*(2-o),c=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),l=r(e);return i<c?l*(i/c/o+1/a-1/a)*c*o:(n=(t=(1+o/a)*i)-(t-i))>s||n!=n?l*(1/0):l*n}},function(e,t,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,a=0,o=0,s=arguments.length,c=0;o<s;)c<(n=i(arguments[o++]))?(a=a*(r=c/n)*r+1,c=n):a+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(a)}})},function(e,t,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(5)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,a=65535&r;return 0|i*a+((65535&n>>>16)*a+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(129)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(89)})},function(e,t,n){var r=n(0),i=n(90),a=Math.exp;r(r.S+r.F*n(5)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(a(e-1)-a(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),i=n(90),a=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(a(e)+a(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(0),i=n(45),a=String.fromCharCode,o=String.fromCodePoint;r(r.S+r.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),i=n(23),a=n(9);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=a(t.length),r=arguments.length,o=[],s=0;n>s;)o.push(String(t[s++])),s<r&&o.push(String(arguments[s]));return o.join("")}})},function(e,t,n){"use strict";n(52)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,n){"use strict";var r=n(91)(!0);n(92)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(0),i=n(91)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(9),a=n(93),o="".endsWith;r(r.P+r.F*n(95)("endsWith"),"String",{endsWith:function(e){var t=a(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),c=String(e);return o?o.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,n){"use strict";var r=n(0),i=n(93);r(r.P+r.F*n(95)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(88)})},function(e,t,n){"use strict";var r=n(0),i=n(9),a=n(93),o="".startsWith;r(r.P+r.F*n(95)("startsWith"),"String",{startsWith:function(e){var t=a(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return o?o.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(19)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){"use strict";n(19)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,n){"use strict";n(19)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,n){"use strict";n(19)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,n){"use strict";n(19)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,n){"use strict";n(19)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";n(19)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";n(19)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,n){"use strict";n(19)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,n){"use strict";n(19)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,n){"use strict";n(19)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,n){"use strict";n(19)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";n(19)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(17),a=n(36);r(r.P+r.F*n(5)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=a(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),i=n(266);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(5),i=Date.prototype.getTime,a=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-50000000000001))}))||!r((function(){a.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:a},function(e,t,n){var r=Date.prototype,i=r.toString,a=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(18)(r,"toString",(function(){var e=a.call(this);return e==e?i.call(this):"Invalid Date"}))},function(e,t,n){var r=n(8)("toPrimitive"),i=Date.prototype;r in i||n(22)(i,r,n(269))},function(e,t,n){"use strict";var r=n(6),i=n(36);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(70)})},function(e,t,n){"use strict";var r=n(27),i=n(0),a=n(17),o=n(131),s=n(96),c=n(9),l=n(97),u=n(98);i(i.S+i.F*!n(71)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,m=a(e),d="function"==typeof this?this:Array,p=arguments.length,f=p>1?arguments[1]:void 0,g=void 0!==f,v=0,y=u(m);if(g&&(f=r(f,p>2?arguments[2]:void 0,2)),null==y||d==Array&&s(y))for(n=new d(t=c(m.length));t>v;v++)l(n,v,g?f(m[v],v):m[v]);else for(h=y.call(m),n=new d;!(i=h.next()).done;v++)l(n,v,g?o(h,f,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){"use strict";var r=n(0),i=n(97);r(r.S+r.F*n(5)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(23),a=[].join;r(r.P+r.F*(n(61)!=Object||!n(25)(a)),"Array",{join:function(e){return a.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(84),a=n(33),o=n(45),s=n(9),c=[].slice;r(r.P+r.F*n(5)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=a(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=o(e,n),l=o(t,n),u=s(l-i),h=new Array(u),m=0;m<u;m++)h[m]="String"==r?this.charAt(i+m):this[i+m];return h}})},function(e,t,n){"use strict";var r=n(0),i=n(28),a=n(17),o=n(5),s=[].sort,c=[1,2,3];r(r.P+r.F*(o((function(){c.sort(void 0)}))||!o((function(){c.sort(null)}))||!n(25)(s)),"Array",{sort:function(e){return void 0===e?s.call(a(this)):s.call(a(this),i(e))}})},function(e,t,n){"use strict";var r=n(0),i=n(32)(0),a=n(25)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(7),i=n(70),a=n(8)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),i=n(32)(1);r(r.P+r.F*!n(25)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(32)(2);r(r.P+r.F*!n(25)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(32)(3);r(r.P+r.F*!n(25)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(32)(4);r(r.P+r.F*!n(25)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(133);r(r.P+r.F*!n(25)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(133);r(r.P+r.F*!n(25)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(68)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(o||!n(25)(a)),"Array",{indexOf:function(e){return o?a.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(23),a=n(29),o=n(9),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(25)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=o(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,a(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(134)}),n(49)("copyWithin")},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(99)}),n(49)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(32)(5),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(49)("find")},function(e,t,n){"use strict";var r=n(0),i=n(32)(6),a="findIndex",o=!0;a in[]&&Array(1)[a]((function(){o=!1})),r(r.P+r.F*o,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(49)(a)},function(e,t,n){n(54)("Array")},function(e,t,n){var r=n(4),i=n(87),a=n(15).f,o=n(47).f,s=n(94),c=n(72),l=r.RegExp,u=l,h=l.prototype,m=/a/g,d=/a/g,p=new l(m)!==m;if(n(14)&&(!p||n(5)((function(){return d[n(8)("match")]=!1,l(m)!=m||l(d)==d||"/a/i"!=l(m,"i")})))){l=function(e,t){var n=this instanceof l,r=s(e),a=void 0===t;return!n&&r&&e.constructor===l&&a?e:i(p?new u(r&&!a?e.source:e,t):u((r=e instanceof l)?e.source:e,r&&a?c.call(e):t),n?this:h,l)};for(var f=function(e){e in l||a(l,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},g=o(u),v=0;g.length>v;)f(g[v++]);h.constructor=l,l.prototype=h,n(18)(r,"RegExp",l)}n(54)("RegExp")},function(e,t,n){"use strict";n(137);var r=n(6),i=n(72),a=n(14),o=/./.toString,s=function(e){n(18)(RegExp.prototype,"toString",e,!0)};n(5)((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?s((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=o.name&&s((function(){return o.call(this)}))},function(e,t,n){"use strict";var r=n(6),i=n(9),a=n(102),o=n(73);n(74)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var c=r(e),l=String(this);if(!c.global)return o(c,l);var u=c.unicode;c.lastIndex=0;for(var h,m=[],d=0;null!==(h=o(c,l));){var p=String(h[0]);m[d]=p,""===p&&(c.lastIndex=a(l,i(c.lastIndex),u)),d++}return 0===d?null:m}]}))},function(e,t,n){"use strict";var r=n(6),i=n(17),a=n(9),o=n(29),s=n(102),c=n(73),l=Math.max,u=Math.min,h=Math.floor,m=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(74)("replace",2,(function(e,t,n,p){return[function(r,i){var a=e(this),o=null==r?void 0:r[t];return void 0!==o?o.call(r,a,i):n.call(String(a),r,i)},function(e,t){var i=p(n,e,this,t);if(i.done)return i.value;var h=r(e),m=String(this),d="function"==typeof t;d||(t=String(t));var g=h.global;if(g){var v=h.unicode;h.lastIndex=0}for(var y=[];;){var C=c(h,m);if(null===C)break;if(y.push(C),!g)break;""===String(C[0])&&(h.lastIndex=s(m,a(h.lastIndex),v))}for(var S,_="",T=0,b=0;b<y.length;b++){C=y[b];for(var R=String(C[0]),w=l(u(o(C.index),m.length),0),E=[],M=1;M<C.length;M++)E.push(void 0===(S=C[M])?S:String(S));var I=C.groups;if(d){var F=[R].concat(E,w,m);void 0!==I&&F.push(I);var D=String(t.apply(void 0,F))}else D=f(R,m,w,E,I,t);w>=T&&(_+=m.slice(T,w)+D,T=w+R.length)}return _+m.slice(T)}];function f(e,t,r,a,o,s){var c=r+e.length,l=a.length,u=d;return void 0!==o&&(o=i(o),u=m),n.call(s,u,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":s=o[i.slice(1,-1)];break;default:var u=+i;if(0===u)return n;if(u>l){var m=h(u/10);return 0===m?n:m<=l?void 0===a[m-1]?i.charAt(1):a[m-1]+i.charAt(1):n}s=a[u-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";var r=n(6),i=n(122),a=n(73);n(74)("search",1,(function(e,t,n,o){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=o(n,e,this);if(t.done)return t.value;var s=r(e),c=String(this),l=s.lastIndex;i(l,0)||(s.lastIndex=0);var u=a(s,c);return i(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},function(e,t,n){"use strict";var r=n(94),i=n(6),a=n(64),o=n(102),s=n(9),c=n(73),l=n(101),u=n(5),h=Math.min,m=[].push,d="length",p=!u((function(){RegExp(4294967295,"y")}));n(74)("split",2,(function(e,t,n,u){var f;return f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[d]||2!="ab".split(/(?:ab)*/)[d]||4!=".".split(/(.?)(.?)/)[d]||".".split(/()()/)[d]>1||"".split(/.?/)[d]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var a,o,s,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,p=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,u+"g");(a=l.call(f,i))&&!((o=f.lastIndex)>h&&(c.push(i.slice(h,a.index)),a[d]>1&&a.index<i[d]&&m.apply(c,a.slice(1)),s=a[0][d],h=o,c[d]>=p));)f.lastIndex===a.index&&f.lastIndex++;return h===i[d]?!s&&f.test("")||c.push(""):c.push(i.slice(h)),c[d]>p?c.slice(0,p):c}:"0".split(void 0,0)[d]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,i,r):f.call(String(i),n,r)},function(e,t){var r=u(f,e,this,t,f!==n);if(r.done)return r.value;var l=i(e),m=String(this),d=a(l,RegExp),g=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(p?"y":"g"),y=new d(p?l:"^(?:"+l.source+")",v),C=void 0===t?4294967295:t>>>0;if(0===C)return[];if(0===m.length)return null===c(y,m)?[m]:[];for(var S=0,_=0,T=[];_<m.length;){y.lastIndex=p?_:0;var b,R=c(y,p?m:m.slice(_));if(null===R||(b=h(s(y.lastIndex+(p?0:_)),m.length))===S)_=o(m,_,g);else{if(T.push(m.slice(S,_)),T.length===C)return T;for(var w=1;w<=R.length-1;w++)if(T.push(R[w]),T.length===C)return T;_=S=b}}return T.push(m.slice(S)),T}]}))},function(e,t,n){var r=n(4),i=n(103).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,c="process"==n(33)(o);e.exports=function(){var e,t,n,l=function(){var r,i;for(c&&(r=o.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){o.nextTick(l)};else if(!a||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(l)}}else n=function(){i.call(r,l)};else{var h=!0,m=document.createTextNode("");new a(l).observe(m,{characterData:!0}),n=function(){m.data=h=!h}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(141),i=n(50);e.exports=n(77)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(141),i=n(50);e.exports=n(77)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(4),a=n(32)(0),o=n(18),s=n(37),c=n(121),l=n(142),u=n(7),h=n(50),m=n(50),d=!i.ActiveXObject&&"ActiveXObject"in i,p=s.getWeak,f=Object.isExtensible,g=l.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(u(e)){var t=p(e);return!0===t?g(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(h(this,"WeakMap"),e,t)}},C=e.exports=n(77)("WeakMap",v,y,l,!0,!0);m&&d&&(c((r=l.getConstructor(v,"WeakMap")).prototype,y),s.NEED=!0,a(["delete","has","get","set"],(function(e){var t=C.prototype,n=t[e];o(t,e,(function(t,i){if(u(t)&&!f(t)){this._f||(this._f=new r);var a=this._f[e](t,i);return"set"==e?this:a}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(142),i=n(50);n(77)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),i=n(78),a=n(104),o=n(6),s=n(45),c=n(9),l=n(7),u=n(4).ArrayBuffer,h=n(64),m=a.ArrayBuffer,d=a.DataView,p=i.ABV&&u.isView,f=m.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(u!==m),{ArrayBuffer:m}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return p&&p(e)||l(e)&&g in e}}),r(r.P+r.U+r.F*n(5)((function(){return!new m(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==f&&void 0===t)return f.call(o(this),e);for(var n=o(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),a=new(h(this,m))(c(i-r)),l=new d(this),u=new d(a),p=0;r<i;)u.setUint8(p++,l.getUint8(r++));return a}}),n(54)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(78).ABV,{DataView:n(104).DataView})},function(e,t,n){n(35)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(35)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(35)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(0),i=n(28),a=n(6),o=(n(4).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5)((function(){o((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=a(n);return o?o(r,t,c):s.call(r,t,c)}})},function(e,t,n){var r=n(0),i=n(46),a=n(28),o=n(6),s=n(7),c=n(5),l=n(123),u=(n(4).Reflect||{}).construct,h=c((function(){function e(){}return!(u((function(){}),[],e)instanceof e)})),m=!c((function(){u((function(){}))}));r(r.S+r.F*(h||m),"Reflect",{construct:function(e,t){a(e),o(t);var n=arguments.length<3?e:a(arguments[2]);if(m&&!h)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}var c=n.prototype,d=i(s(c)?c:Object.prototype),p=Function.apply.call(e,d,t);return s(p)?p:d}})},function(e,t,n){var r=n(15),i=n(0),a=n(6),o=n(36);i(i.S+i.F*n(5)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){a(e),t=o(t,!0),a(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(0),i=n(30).f,a=n(6);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(a(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),i=n(6),a=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(130)(a,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),r(r.S,"Reflect",{enumerate:function(e){return new a(e)}})},function(e,t,n){var r=n(30),i=n(48),a=n(21),o=n(0),s=n(7),c=n(6);o(o.S,"Reflect",{get:function e(t,n){var o,l,u=arguments.length<3?t:arguments[2];return c(t)===u?t[n]:(o=r.f(t,n))?a(o,"value")?o.value:void 0!==o.get?o.get.call(u):void 0:s(l=i(t))?e(l,n,u):void 0}})},function(e,t,n){var r=n(30),i=n(0),a=n(6);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(a(e),t)}})},function(e,t,n){var r=n(0),i=n(48),a=n(6);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(a(e))}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(0),i=n(6),a=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!a||a(e)}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(144)})},function(e,t,n){var r=n(0),i=n(6),a=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return a&&a(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(15),i=n(30),a=n(48),o=n(21),s=n(0),c=n(41),l=n(6),u=n(7);s(s.S,"Reflect",{set:function e(t,n,s){var h,m,d=arguments.length<4?t:arguments[3],p=i.f(l(t),n);if(!p){if(u(m=a(t)))return e(m,n,s,d);p=c(0)}if(o(p,"value")){if(!1===p.writable||!u(d))return!1;if(h=i.f(d,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(d,n,h)}else r.f(d,n,c(0,s));return!0}return void 0!==p.set&&(p.set.call(d,s),!0)}})},function(e,t,n){var r=n(0),i=n(85);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){n(329),e.exports=n(11).Array.includes},function(e,t,n){"use strict";var r=n(0),i=n(68)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(49)("includes")},function(e,t,n){n(331),e.exports=n(11).Array.flatMap},function(e,t,n){"use strict";var r=n(0),i=n(332),a=n(17),o=n(9),s=n(28),c=n(132);r(r.P,"Array",{flatMap:function(e){var t,n,r=a(this);return s(e),t=o(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(49)("flatMap")},function(e,t,n){"use strict";var r=n(70),i=n(7),a=n(9),o=n(27),s=n(8)("isConcatSpreadable");e.exports=function e(t,n,c,l,u,h,m,d){for(var p,f,g=u,v=0,y=!!m&&o(m,d,3);v<l;){if(v in c){if(p=y?y(c[v],v,n):c[v],f=!1,i(p)&&(f=void 0!==(f=p[s])?!!f:r(p)),f&&h>0)g=e(t,n,p,a(p.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=p}g++}v++}return g}},function(e,t,n){n(334),e.exports=n(11).String.padStart},function(e,t,n){"use strict";var r=n(0),i=n(145),a=n(76),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*o,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){n(336),e.exports=n(11).String.padEnd},function(e,t,n){"use strict";var r=n(0),i=n(145),a=n(76),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*o,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){n(338),e.exports=n(11).String.trimLeft},function(e,t,n){"use strict";n(52)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,n){n(340),e.exports=n(11).String.trimRight},function(e,t,n){"use strict";n(52)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){n(342),e.exports=n(81).f("asyncIterator")},function(e,t,n){n(117)("asyncIterator")},function(e,t,n){n(344),e.exports=n(11).Object.getOwnPropertyDescriptors},function(e,t,n){var r=n(0),i=n(144),a=n(23),o=n(30),s=n(97);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),c=o.f,l=i(r),u={},h=0;l.length>h;)void 0!==(n=c(r,t=l[h++]))&&s(u,t,n);return u}})},function(e,t,n){n(346),e.exports=n(11).Object.values},function(e,t,n){var r=n(0),i=n(146)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){n(348),e.exports=n(11).Object.entries},function(e,t,n){var r=n(0),i=n(146)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";n(138),n(350),e.exports=n(11).Promise.finally},function(e,t,n){"use strict";var r=n(0),i=n(11),a=n(4),o=n(64),s=n(140);r(r.P+r.R,"Promise",{finally:function(e){var t=o(this,i.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){n(352),n(353),n(354),e.exports=n(11)},function(e,t,n){var r=n(4),i=n(0),a=n(76),o=[].slice,s=/MSIE .\./.test(a),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&o.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(0),i=n(103);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(100),i=n(44),a=n(18),o=n(4),s=n(22),c=n(53),l=n(8),u=l("iterator"),h=l("toStringTag"),m=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),f=0;f<p.length;f++){var g,v=p[f],y=d[v],C=o[v],S=C&&C.prototype;if(S&&(S[u]||s(S,u,m),S[h]||s(S,h,v),c[v]=m,y))for(g in r)S[g]||a(S,g,r[g],!0)}},function(e,t,n){n(356),e.exports=n(147).global},function(e,t,n){var r=n(357);r(r.G,{global:n(105)})},function(e,t,n){var r=n(105),i=n(147),a=n(358),o=n(360),s=n(367),c=function(e,t,n){var l,u,h,m=e&c.F,d=e&c.G,p=e&c.S,f=e&c.P,g=e&c.B,v=e&c.W,y=d?i:i[t]||(i[t]={}),C=y.prototype,S=d?r:p?r[t]:(r[t]||{}).prototype;for(l in d&&(n=t),n)(u=!m&&S&&void 0!==S[l])&&s(y,l)||(h=u?S[l]:n[l],y[l]=d&&"function"!=typeof S[l]?n[l]:g&&u?a(h,r):v&&S[l]==h?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):f&&"function"==typeof h?a(Function.call,h):h,f&&((y.virtual||(y.virtual={}))[l]=h,e&c.R&&C&&!C[l]&&o(C,l,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(359);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(361),i=n(366);e.exports=n(107)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(362),i=n(363),a=n(365),o=Object.defineProperty;t.f=n(107)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(106);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(107)&&!n(148)((function(){return 7!=Object.defineProperty(n(364)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(106),i=n(105).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var r=n(106);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r,i,a=n(149),o=n(150),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],h=(e=e||{}).node||r,m=void 0!==e.clockseq?e.clockseq:i;if(null==h||null==m){var d=a();null==h&&(h=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==m&&(m=i=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:c+1,g=p-s+(f-c)/1e4;if(g<0&&void 0===e.clockseq&&(m=m+1&16383),(g<0||p>s)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,c=f,i=m;var v=(1e4*(268435455&(p+=122192928e5))+f)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var y=p/4294967296*1e4&268435455;u[l++]=y>>>8&255,u[l++]=255&y,u[l++]=y>>>24&15|16,u[l++]=y>>>16&255,u[l++]=m>>>8|128,u[l++]=255&m;for(var C=0;C<6;++C)u[l+C]=h[C];return t||o(u)}},function(e,t,n){var r=n(149),i=n(150);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||i(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachVisionActor=void 0;var r,i=n(59),a=n(151),o=n(60),s=n(26),c=n(57),l=function(){function e(t,n,i,o,s,c){this.m_rehearsalVideoElement=null,this.m_rehearsalVideoDiv=null,this.m_rehearsalVideoCanvasElement=null,this.m_rehearsalVideoGradientContainer=null;var l=Date.now();this.loadIconsCss(),r=c,this.m_toggleWebcamEnabledCallback=o,this.m_turnOffVisionCallback=s,this.m_coachVisionActorConfig=t,this.m_document=this.m_coachVisionActorConfig.rootContainer.ownerDocument||document,this.m_rehearsalVisionActorContainerDiv=this.m_document.createElement("div"),this.m_rehearsalVisionActorContainerDiv.id="ppt-RehearsalActorDiv-videoContainer",this.m_videoToggleContainer=this.generateVideoToggleContainer(),this.m_videoToggleButton=this.generateVideoToggleButton(),this.m_videoToggleContainer.appendChild(this.m_videoToggleButton),this.m_coachAudioActor=new a.CoachAudioActor(t,n,i,c,[this.m_videoToggleContainer]),this.m_rehearsalVideoDiv=e.generateVideoDiv(),this.m_rehearsalVideoElement=e.generateVideoElement(),this.m_rehearsalVideoCanvasElement=e.generateVideoCanvas(),this.m_rehearsalVideoGradientContainer=e.generateVideoGradientContainer(),this.m_rehearsalVideoDiv.appendChild(this.m_rehearsalVideoElement),this.m_rehearsalVideoDiv.appendChild(this.m_rehearsalVideoCanvasElement),this.m_rehearsalVideoElement.appendChild(this.m_rehearsalVideoGradientContainer),this.m_rehearsalVisionActorContainerDiv.appendChild(this.m_rehearsalVideoDiv),this.m_rehearsalVisionActorContainerDiv.appendChild(this.m_coachAudioActor.getActorContainer()),this.m_rehearsalVisionActorContainerDiv.addEventListener("contextmenu",this.disableContextMenu),this.addTooltips(),this.m_coachDashboardCreationTime=Date.now()-l}return e.prototype.toggleWebcamEnabledCallback=function(e,t){t&&(e.preventDefault(),e.stopPropagation(),this.m_toggleWebcamEnabledCallback())},e.prototype.generateVideoToggleContainer=function(){var e=this,t=this.m_document.createElement("button");return t.id="ppt-Rehearsal-videoToggleContainer",t.onclick=function(t){e.toggleWebcamEnabledCallback(t,!0)},t.onkeypress=function(t){e.toggleWebcamEnabledCallback(t,"Enter"===t.key)},t.setAttribute("aria-label",s.RehearsalActorSettings.RehearsalShowVideoTooltip),t.setAttribute("aria-pressed","true"),t},e.prototype.generateVideoToggleButton=function(){var e=this.m_document.createElement("img");return e.setAttribute("aria-hidden","true"),e.id="ppt-Rehearsal-videoToggleButton",e.src=this.m_coachVisionActorConfig.imagesBaseFilePath+"VideoOn.svg",e},e.prototype.loadIconsCss=function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css",document.head.appendChild(e)},e.prototype.disableContextMenu=function(e){return e.preventDefault(),!1},e.prototype.addTooltips=function(){this.m_coachVisionActorConfig.fDontShowTooltips||this.m_videoToggleContainer&&c.addTooltip(this.m_videoToggleContainer,s.RehearsalActorSettings.RehearsalHideVideoTooltip,this.m_coachVisionActorConfig.zIndex+1,this.m_coachVisionActorConfig.rootContainer,this.m_coachVisionActorConfig.clientType===i.ClientType.Win32&&!!this.m_coachVisionActorConfig.fUseFluentUIForWindows)},e.prototype.startRealTimeTrackers=function(e,t){this.m_coachAudioActor.startRealTimeTrackers(e,t),this.m_coachAudioActor.restartTimerForClearingRehearsalDashboard()},e.prototype.startCoachVideoSession=function(){try{if(this.m_rehearsalVideoElement&&this.m_rehearsalVideoDiv)if(this.m_rehearsalVideoElement.readyState!==HTMLMediaElement.HAVE_NOTHING&&0!==this.m_rehearsalVideoElement.videoWidth){var e=this.m_rehearsalVideoElement.videoHeight/this.m_rehearsalVideoElement.videoWidth*this.m_rehearsalVideoDiv.offsetWidth;this.m_rehearsalVideoDiv.style.height=e+"px"}else r.sendTraceTag(591736987,o.LogCategory.PptSession,o.TraceLevel.Error,"Rehearsal::startCoachVideoSession video element not ready for rehearsal, defaulting to audio, readyState: "+this.m_rehearsalVideoElement.readyState),this.m_turnOffVisionCallback()}catch(e){r.sendTraceTag(591736988,o.LogCategory.PptSession,o.TraceLevel.Error,"Rehearsal::startCoachVideoSession error: "+e.message)}},e.prototype.fSupportsCoachTemplate=function(e){if(null===e)return!1;switch(e.toLowerCase()){case s.RehearsalTemplateName.SingleMessage:case s.RehearsalTemplateName.DetectedValueWithMessage:case s.RehearsalTemplateName.GaugeWithMessage:case s.RehearsalTemplateName.IconWithMessage:case s.RehearsalTemplateName.TemperaturePillWithMessage:case s.RehearsalTemplateName.FontIconWithMessage:case s.RehearsalTemplateName.Pronunciation:return!0;default:return!1}},e.prototype.showMessage=function(e,t,n){return this.m_coachAudioActor.showMessage(e,t,n)},e.prototype.updateTimer=function(e){this.m_coachAudioActor.updateTimer(e)},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.getRehearsalVideoElement=function(){return this.m_rehearsalVideoElement},e.prototype.getRehearsalVideoCanvas=function(){return this.m_rehearsalVideoCanvasElement},e.prototype.fireTrackerAlert=function(){this.m_coachAudioActor.fireTrackerAlert()},e.prototype.resumeSession=function(){this.m_coachAudioActor.resumeSession()},e.prototype.resetRehearsalDashboard=function(){this.m_coachAudioActor.resetRehearsalDashboard()},e.prototype.setRealtimeFeedbackButton=function(e){this.m_coachAudioActor.setRealtimeFeedbackButton(e)},e.prototype.toggleVideoUI=function(e){this.m_videoToggleButton&&this.m_videoToggleContainer&&(e?(this.m_videoToggleButton.src=this.m_coachVisionActorConfig.imagesBaseFilePath+"VideoOn.svg",this.m_videoToggleContainer.setAttribute("aria-pressed","true"),c.updateTooltip(this.m_videoToggleContainer,s.RehearsalActorSettings.RehearsalHideVideoTooltip,this.m_coachVisionActorConfig.zIndex+1),this.m_rehearsalVideoDiv&&this.m_rehearsalVideoDiv.classList.remove(s.RehearsalActorSettings.RehearsalHideWebcamClassname)):(this.m_videoToggleButton.src=this.m_coachVisionActorConfig.imagesBaseFilePath+"VideoOff.svg",this.m_videoToggleContainer.setAttribute("aria-pressed","false"),c.updateTooltip(this.m_videoToggleContainer,s.RehearsalActorSettings.RehearsalShowVideoTooltip,this.m_coachVisionActorConfig.zIndex+1),this.m_rehearsalVideoDiv&&this.m_rehearsalVideoDiv.classList.add(s.RehearsalActorSettings.RehearsalHideWebcamClassname)))},e.prototype.pauseSession=function(){this.m_coachAudioActor.pauseSession()},e.prototype.getElementsToAvoidDraggingOn=function(){return this.m_coachAudioActor.getElementsToAvoidDraggingOn().concat(this.m_videoToggleContainer)},e.prototype.getActorContainer=function(){return this.m_rehearsalVisionActorContainerDiv},e.prototype.updateCoachSlideComponent=function(e,t){this.m_coachAudioActor.updateCoachSlideComponent(e,t)},e.generateVideoElement=function(){var e=document.createElement("video");return e.id="ppt-RehearsalDiv-videoElement",e},e.generateVideoCanvas=function(){var e=document.createElement("canvas");return e.id="ppt-RehearsalDiv-video-canvas",e},e.generateVideoDiv=function(){var e=document.createElement("div");return e.id="ppt-RehearsalDiv-video",e.style.display="block",e},e.generateVideoGradientContainer=function(){var e=document.createElement("div");return e.id="ppt-RehearsalDiv-videoGradientContainer",e},e.prototype.showStatusNotification=function(e,t){},e}();t.CoachVisionActor=l},function(e,t,n){"use strict";n.r(t);var r=n(155);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a="undefined"!=typeof window&&"undefined"!=typeof document,o=a?navigator.userAgent:"",s=/MSIE |Trident\//.test(o),c=/UCBrowser\//.test(o),l=a&&/iPhone|iPad|iPod/.test(navigator.platform)&&!window.MSStream,u={a11y:!0,allowHTML:!0,animateFill:!0,animation:"shift-away",appendTo:function(){return document.body},aria:"describedby",arrow:!1,arrowType:"sharp",boundary:"scrollParent",content:"",delay:0,distance:10,duration:[325,275],flip:!0,flipBehavior:"flip",flipOnUpdate:!1,followCursor:!1,hideOnClick:!0,ignoreAttributes:!1,inertia:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,lazy:!0,maxWidth:350,multiple:!1,offset:0,onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},placement:"top",popperOptions:{},role:"tooltip",showOnInit:!1,size:"regular",sticky:!1,target:"",theme:"dark",touch:!0,touchHold:!1,trigger:"mouseenter focus",triggerTarget:null,updateDuration:0,wait:null,zIndex:9999},h=["arrow","arrowType","boundary","distance","flip","flipBehavior","flipOnUpdate","offset","placement","popperOptions"],m=a?Element.prototype:{},d=m.matches||m.matchesSelector||m.webkitMatchesSelector||m.mozMatchesSelector||m.msMatchesSelector;function p(e){return[].slice.call(e)}function f(e,t){return g(e,(function(e){return d.call(e,t)}))}function g(e,t){for(;e;){if(t(e))return e;e=e.parentElement}return null}var v={passive:!0},y=".".concat("tippy-popper"),C=".".concat("tippy-tooltip"),S=".".concat("tippy-content"),_=".".concat("tippy-backdrop"),T=".".concat("tippy-arrow"),b=".".concat("tippy-roundarrow"),R=!1;function w(){R||(R=!0,l&&document.body.classList.add("tippy-iOS"),window.performance&&document.addEventListener("mousemove",M))}var E=0;function M(){var e=performance.now();e-E<20&&(R=!1,document.removeEventListener("mousemove",M),l||document.body.classList.remove("tippy-iOS")),E=e}function I(){var e=document.activeElement;e&&e.blur&&e._tippy&&e.blur()}var F=Object.keys(u);function D(e){return!!e._tippy&&!d.call(e,y)}function A(e,t){return{}.hasOwnProperty.call(e,t)}function k(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?n:r}return e}function x(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)};var n}function L(e,t){return e&&e.modifiers&&e.modifiers[t]}function P(e,t){return e.indexOf(t)>-1}function W(e){return e instanceof Element}function N(e){return!(!e||!A(e,"isVirtual"))||W(e)}function O(e,t){return"function"==typeof e?e.apply(null,t):e}function V(e,t){e.filter((function(e){return"flip"===e.name}))[0].enabled=t}function B(){return document.createElement("div")}function H(e,t){e.forEach((function(e){e&&(e.style.transitionDuration="".concat(t,"ms"))}))}function U(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function q(e,t){var n=i({},t,{content:O(t.content,[e])},t.ignoreAttributes?{}:function(e){return F.reduce((function(t,n){var r=(e.getAttribute("data-tippy-".concat(n))||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t}),{})}(e));return(n.arrow||c)&&(n.animateFill=!1),n}function j(e,t){Object.keys(e).forEach((function(e){if(!A(t,e))throw new Error("[tippy]: `".concat(e,"` is not a valid option"))}))}function G(e,t){e.innerHTML=W(t)?t.innerHTML:t}function z(e,t){W(t.content)?(G(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(e[t.allowHTML?"innerHTML":"textContent"]=t.content)}function J(e){return{tooltip:e.querySelector(C),backdrop:e.querySelector(_),content:e.querySelector(S),arrow:e.querySelector(T)||e.querySelector(b)}}function X(e){e.setAttribute("data-inertia","")}function Q(e){var t=B();return"round"===e?(t.className="tippy-roundarrow",G(t,'<svg viewBox="0 0 18 7" xmlns="http://www.w3.org/2000/svg"><path d="M0 7s2.021-.015 5.253-4.218C6.584 1.051 7.797.007 9 0c1.203-.007 2.416 1.035 3.761 2.782C16.012 7.005 18 7 18 7H0z"/></svg>')):t.className="tippy-arrow",t}function Y(){var e=B();return e.className="tippy-backdrop",e.setAttribute("data-state","hidden"),e}function K(e,t){e.setAttribute("tabindex","-1"),t.setAttribute("data-interactive","")}function Z(e,t,n){var r=c&&void 0!==document.body.style.webkitTransition?"webkitTransitionEnd":"transitionend";e[t+"EventListener"](r,n)}function $(e){var t=e.getAttribute("x-placement");return t?t.split("-")[0]:""}function ee(e,t,n){n.split(" ").forEach((function(n){e.classList[t](n+"-theme")}))}function te(e,t){var n=B();n.className="tippy-popper",n.id="tippy-".concat(e),n.style.zIndex=""+t.zIndex,n.style.position="absolute",n.style.top="0",n.style.left="0",t.role&&n.setAttribute("role",t.role);var r=B();r.className="tippy-tooltip",r.style.maxWidth=t.maxWidth+("number"==typeof t.maxWidth?"px":""),r.setAttribute("data-size",t.size),r.setAttribute("data-animation",t.animation),r.setAttribute("data-state","hidden"),ee(r,"add",t.theme);var i=B();return i.className="tippy-content",i.setAttribute("data-state","hidden"),t.interactive&&K(n,r),t.arrow&&r.appendChild(Q(t.arrowType)),t.animateFill&&(r.appendChild(Y()),r.setAttribute("data-animatefill","")),t.inertia&&X(r),z(i,t),r.appendChild(i),n.appendChild(r),n}function ne(e,t,n){var r=J(e),i=r.tooltip,a=r.content,o=r.backdrop,s=r.arrow;e.style.zIndex=""+n.zIndex,i.setAttribute("data-size",n.size),i.setAttribute("data-animation",n.animation),i.style.maxWidth=n.maxWidth+("number"==typeof n.maxWidth?"px":""),n.role?e.setAttribute("role",n.role):e.removeAttribute("role"),t.content!==n.content&&z(a,n),!t.animateFill&&n.animateFill?(i.appendChild(Y()),i.setAttribute("data-animatefill","")):t.animateFill&&!n.animateFill&&(i.removeChild(o),i.removeAttribute("data-animatefill")),!t.arrow&&n.arrow?i.appendChild(Q(n.arrowType)):t.arrow&&!n.arrow&&i.removeChild(s),t.arrow&&n.arrow&&t.arrowType!==n.arrowType&&i.replaceChild(Q(n.arrowType),s),!t.interactive&&n.interactive?K(e,i):t.interactive&&!n.interactive&&function(e,t){e.removeAttribute("tabindex"),t.removeAttribute("data-interactive")}(e,i),!t.inertia&&n.inertia?X(i):t.inertia&&!n.inertia&&function(e){e.removeAttribute("data-inertia")}(i),t.theme!==n.theme&&(ee(i,"remove",t.theme),ee(i,"add",n.theme))}var re=1,ie=[];function ae(e,t){var n,a,o,c,l,m=q(e,t);if(!m.multiple&&e._tippy)return null;var C,S,_,T,b,w=!1,E=!1,M=!1,I=!1,F=[],D=x(ve,m.interactiveDebounce),N=re++,B=te(N,m),G=J(B),z={id:N,reference:e,popper:B,popperChildren:G,popperInstance:null,props:m,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},clearDelayTimeouts:Fe,set:De,setContent:function(e){De({content:e})},show:Ae,hide:ke,enable:function(){z.state.isEnabled=!0},disable:function(){z.state.isEnabled=!1},destroy:function(t){if(!z.state.isDestroyed){E=!0,z.state.isMounted&&ke(0),pe(),delete e._tippy;var n=z.props.target;n&&t&&W(e)&&p(e.querySelectorAll(n)).forEach((function(e){e._tippy&&e._tippy.destroy()})),z.popperInstance&&z.popperInstance.destroy(),E=!1,z.state.isDestroyed=!0}}};return e._tippy=z,B._tippy=z,de(),m.lazy||Re(),m.showOnInit&&Ee(),!m.a11y||m.target||!W(b=Y())||d.call(b,"a[href],area[href],button,details,input,textarea,select,iframe,[tabindex]")&&!b.hasAttribute("disabled")||Y().setAttribute("tabindex","0"),B.addEventListener("mouseenter",(function(e){z.props.interactive&&z.state.isVisible&&"mouseenter"===n&&Ee(e,!0)})),B.addEventListener("mouseleave",(function(){z.props.interactive&&"mouseenter"===n&&document.addEventListener("mousemove",D)})),z;function X(){document.removeEventListener("mousemove",fe)}function Q(){document.body.removeEventListener("mouseleave",Me),document.removeEventListener("mousemove",D),ie=ie.filter((function(e){return e!==D}))}function Y(){return z.props.triggerTarget||e}function K(){document.addEventListener("click",Ie,!0)}function ee(){document.removeEventListener("click",Ie,!0)}function oe(){return[z.popperChildren.tooltip,z.popperChildren.backdrop,z.popperChildren.content]}function se(){var e=z.props.followCursor;return e&&"focus"!==n||R&&"initial"===e}function ce(){H([B],s?0:z.props.updateDuration);var t=e.getBoundingClientRect();!function n(){var r=e.getBoundingClientRect();t.top===r.top&&t.right===r.right&&t.bottom===r.bottom&&t.left===r.left||z.popperInstance.scheduleUpdate(),t=r,z.state.isMounted&&requestAnimationFrame(n)}()}function le(e,t){he(e,(function(){!z.state.isVisible&&B.parentNode&&B.parentNode.contains(B)&&t()}))}function ue(e,t){he(e,t)}function he(e,t){var n=z.popperChildren.tooltip;function r(e){e.target===n&&(Z(n,"remove",r),t())}if(0===e)return t();Z(n,"remove",_),Z(n,"add",r),_=r}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Y().addEventListener(e,t,n),F.push({eventType:e,handler:t,options:n})}function de(){z.props.touchHold&&!z.props.target&&(me("touchstart",ge,v),me("touchend",ye,v)),z.props.trigger.trim().split(" ").forEach((function(e){if("manual"!==e)if(z.props.target)switch(e){case"mouseenter":me("mouseover",Se),me("mouseout",_e);break;case"focus":me("focusin",Se),me("focusout",_e);break;case"click":me(e,Se)}else switch(me(e,ge),e){case"mouseenter":me("mouseleave",ye);break;case"focus":me(s?"focusout":"blur",Ce)}}))}function pe(){F.forEach((function(e){var t=e.eventType,n=e.handler,r=e.options;Y().removeEventListener(t,n,r)})),F=[]}function fe(t){var n=a=t,r=n.clientX,o=n.clientY;if(T){var s=g(t.target,(function(t){return t===e})),c=e.getBoundingClientRect(),l=z.props.followCursor,u="horizontal"===l,h="vertical"===l,m=P(["top","bottom"],$(B)),d=B.getAttribute("x-placement"),p=!!d&&!!d.split("-")[1],f=m?B.offsetWidth:B.offsetHeight,v=f/2,y=m?0:p?f:v,C=m?p?f:v:0;!s&&z.props.interactive||(z.popperInstance.reference=i({},z.popperInstance.reference,{referenceNode:e,clientWidth:0,clientHeight:0,getBoundingClientRect:function(){return{width:m?f:0,height:m?0:f,top:(u?c.top:o)-y,bottom:(u?c.bottom:o)+y,left:(h?c.left:r)-C,right:(h?c.right:r)+C}}}),z.popperInstance.update()),"initial"===l&&z.state.isVisible&&X()}}function ge(e){z.state.isEnabled&&!Te(e)&&(z.state.isVisible||(n=e.type,e instanceof MouseEvent&&(a=e,ie.forEach((function(t){return t(e)})))),"click"===e.type&&!1!==z.props.hideOnClick&&z.state.isVisible?Me():Ee(e))}function ve(t){var n=f(t.target,y)===B,r=g(t.target,(function(t){return t===e}));n||r||function(e,t,n,r){if(!e)return!0;var i=n.clientX,a=n.clientY,o=r.interactiveBorder,s=r.distance,c=t.top-a>("top"===e?o+s:o),l=a-t.bottom>("bottom"===e?o+s:o),u=t.left-i>("left"===e?o+s:o),h=i-t.right>("right"===e?o+s:o);return c||l||u||h}($(B),B.getBoundingClientRect(),t,z.props)&&(Q(),Me())}function ye(e){if(!Te(e))return z.props.interactive?(document.body.addEventListener("mouseleave",Me),document.addEventListener("mousemove",D),void ie.push(D)):void Me()}function Ce(e){e.target===Y()&&(z.props.interactive&&e.relatedTarget&&B.contains(e.relatedTarget)||Me())}function Se(e){f(e.target,z.props.target)&&Ee(e)}function _e(e){f(e.target,z.props.target)&&Me()}function Te(e){var t="ontouchstart"in window,n=P(e.type,"touch"),r=z.props.touchHold;return t&&R&&r&&!n||R&&!r&&n}function be(){!I&&S&&(I=!0,function(e){e.offsetHeight}(B),S())}function Re(){var t=z.props.popperOptions,n=z.popperChildren,a=n.tooltip,o=n.arrow,s=L(t,"preventOverflow");function c(e){z.props.flip&&!z.props.flipOnUpdate&&(e.flipped&&(z.popperInstance.options.placement=e.placement),V(z.popperInstance.modifiers,!1)),a.setAttribute("x-placement",e.placement),!1!==e.attributes["x-out-of-boundaries"]?a.setAttribute("x-out-of-boundaries",""):a.removeAttribute("x-out-of-boundaries"),C&&C!==e.placement&&M&&(a.style.transition="none",requestAnimationFrame((function(){a.style.transition=""}))),C=e.placement,M=z.state.isVisible;var t=$(B),n=a.style;n.top=n.bottom=n.left=n.right="",n[t]=-(z.props.distance-10)+"px";var r=s&&void 0!==s.padding?s.padding:4,o="number"==typeof r,c=i({top:o?r:r.top,bottom:o?r:r.bottom,left:o?r:r.left,right:o?r:r.right},!o&&r);c[t]=o?r+z.props.distance:(r[t]||0)+z.props.distance,z.popperInstance.modifiers.filter((function(e){return"preventOverflow"===e.name}))[0].padding=c,T=c}var l=i({eventsEnabled:!1,placement:z.props.placement},t,{modifiers:i({},t?t.modifiers:{},{preventOverflow:i({boundariesElement:z.props.boundary,padding:4},s),arrow:i({element:o,enabled:!!o},L(t,"arrow")),flip:i({enabled:z.props.flip,padding:z.props.distance+4,behavior:z.props.flipBehavior},L(t,"flip")),offset:i({offset:z.props.offset},L(t,"offset"))}),onCreate:function(e){c(e),be(),t&&t.onCreate&&t.onCreate(e)},onUpdate:function(e){c(e),be(),t&&t.onUpdate&&t.onUpdate(e)}});z.popperInstance=new r.a(e,B,l)}function we(){I=!1;var t=se();z.popperInstance?(V(z.popperInstance.modifiers,z.props.flip),t||(z.popperInstance.reference=e,z.popperInstance.enableEventListeners()),z.popperInstance.scheduleUpdate()):(Re(),t||z.popperInstance.enableEventListeners());var n=z.props.appendTo,r="parent"===n?e.parentNode:O(n,[e]);r.contains(B)||(r.appendChild(B),z.props.onMount(z),z.state.isMounted=!0)}function Ee(e,n){if(Fe(),!z.state.isVisible){if(z.props.target)return function(e){if(e){var n=f(e.target,z.props.target);n&&!n._tippy&&ae(n,i({},z.props,{content:O(t.content,[n]),appendTo:t.appendTo,target:"",showOnInit:!0}))}}(e);if(w=!0,e&&!n&&z.props.onTrigger(z,e),z.props.wait)return z.props.wait(z,e);se()&&!z.state.isMounted&&(z.popperInstance||Re(),document.addEventListener("mousemove",fe)),K();var r=k(z.props.delay,0,u.delay);r?o=setTimeout((function(){Ae()}),r):Ae()}}function Me(){if(Fe(),!z.state.isVisible)return X(),void ee();w=!1;var e=k(z.props.delay,1,u.delay);e?c=setTimeout((function(){z.state.isVisible&&ke()}),e):l=requestAnimationFrame((function(){ke()}))}function Ie(e){if(!z.props.interactive||!B.contains(e.target)){if(Y().contains(e.target)){if(R)return;if(z.state.isVisible&&P(z.props.trigger,"click"))return}!0===z.props.hideOnClick&&(Fe(),ke())}}function Fe(){clearTimeout(o),clearTimeout(c),cancelAnimationFrame(l)}function De(t){j(t=t||{},u),pe();var n=z.props,r=q(e,i({},z.props,{},t,{ignoreAttributes:!0}));r.ignoreAttributes=A(t,"ignoreAttributes")?t.ignoreAttributes||!1:n.ignoreAttributes,z.props=r,de(),Q(),D=x(ve,r.interactiveDebounce),ne(B,n,r),z.popperChildren=J(B),z.popperInstance&&(h.some((function(e){return A(t,e)&&t[e]!==n[e]}))?(z.popperInstance.destroy(),Re(),z.state.isVisible&&z.popperInstance.enableEventListeners(),z.props.followCursor&&a&&fe(a)):z.popperInstance.update())}function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k(z.props.duration,0,u.duration[1]);if(!z.state.isDestroyed&&z.state.isEnabled&&(!R||z.props.touch)&&!Y().hasAttribute("disabled")&&!1!==z.props.onShow(z)){K(),B.style.visibility="visible",z.state.isVisible=!0,z.props.interactive&&Y().classList.add("tippy-active");var t=oe();H(t.concat(B),0),S=function(){if(z.state.isVisible){var n=se();n&&a?fe(a):n||z.popperInstance.update(),z.popperChildren.backdrop&&(z.popperChildren.content.style.transitionDelay=Math.round(e/12)+"ms"),z.props.sticky&&ce(),H([B],z.props.updateDuration),H(t,e),U(t,"visible"),ue(e,(function(){z.props.aria&&Y().setAttribute("aria-".concat(z.props.aria),B.id),z.props.onShown(z),z.state.isShown=!0}))}},we()}}function ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k(z.props.duration,1,u.duration[1]);if(!z.state.isDestroyed&&(z.state.isEnabled||E)&&(!1!==z.props.onHide(z)||E)){ee(),B.style.visibility="hidden",z.state.isVisible=!1,z.state.isShown=!1,M=!1,z.props.interactive&&Y().classList.remove("tippy-active");var t=oe();H(t,e),U(t,"hidden"),le(e,(function(){w||X(),z.props.aria&&Y().removeAttribute("aria-".concat(z.props.aria)),z.popperInstance.disableEventListeners(),z.popperInstance.options.placement=z.props.placement,B.parentNode.removeChild(B),z.props.onHidden(z),z.state.isMounted=!1}))}}}var oe=!1;function se(e,t){j(t||{},u),oe||(document.addEventListener("touchstart",w,v),window.addEventListener("blur",I),oe=!0);var n,r=i({},u,{},t);n=e,"[object Object]"!=={}.toString.call(n)||n.addEventListener||function(e){var t={isVirtual:!0,attributes:e.attributes||{},contains:function(){},setAttribute:function(t,n){e.attributes[t]=n},getAttribute:function(t){return e.attributes[t]},removeAttribute:function(t){delete e.attributes[t]},hasAttribute:function(t){return t in e.attributes},addEventListener:function(){},removeEventListener:function(){},classList:{classNames:{},add:function(t){e.classList.classNames[t]=!0},remove:function(t){delete e.classList.classNames[t]},contains:function(t){return t in e.classList.classNames}}};for(var n in t)e[n]=t[n]}(e);var a=function(e){if(N(e))return[e];if(e instanceof NodeList)return p(e);if(Array.isArray(e))return e;try{return p(document.querySelectorAll(e))}catch(e){return[]}}(e).reduce((function(e,t){var n=t&&ae(t,r);return n&&e.push(n),e}),[]);return N(e)?a[0]:a}se.version="4.3.5",se.defaults=u,se.setDefaults=function(e){Object.keys(e).forEach((function(t){u[t]=e[t]}))},se.hideAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.exclude,n=e.duration;p(document.querySelectorAll(y)).forEach((function(e){var r=e._tippy;if(r){var i=!1;t&&(i=D(t)?r.reference===t:e===t.popper),i||r.hide(n)}}))},se.group=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.delay,r=void 0===n?e[0].props.delay:n,a=t.duration,o=void 0===a?0:a,s=!1;function c(e){s=e,m()}function l(t){t._originalProps.onShow(t),e.forEach((function(e){e.set({duration:o}),e.state.isVisible&&e.hide()})),c(!0)}function u(e){e._originalProps.onHide(e),c(!1)}function h(e){e._originalProps.onShown(e),e.set({duration:e._originalProps.duration})}function m(){e.forEach((function(e){e.set({onShow:l,onShown:h,onHide:u,delay:s?[0,Array.isArray(r)?r[1]:r]:r,duration:s?o:e._originalProps.duration})}))}e.forEach((function(e){e._originalProps?e.set(e._originalProps):e._originalProps=i({},e.props)})),m()},a&&setTimeout((function(){p(document.querySelectorAll("[data-tippy]")).forEach((function(e){var t=e.getAttribute("data-tippy");t&&se(e,{content:t})}))})),function(e){if(a){var t=document.createElement("style");t.type="text/css",t.textContent='.tippy-iOS{cursor:pointer!important;-webkit-tap-highlight-color:transparent}.tippy-popper{transition-timing-function:cubic-bezier(.165,.84,.44,1);max-width:calc(100% - 8px);pointer-events:none;outline:0}.tippy-popper[x-placement^=top] .tippy-backdrop{border-radius:40% 40% 0 0}.tippy-popper[x-placement^=top] .tippy-roundarrow{bottom:-7px;bottom:-6.5px;-webkit-transform-origin:50% 0;transform-origin:50% 0;margin:0 3px}.tippy-popper[x-placement^=top] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.tippy-popper[x-placement^=top] .tippy-arrow{border-top:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;bottom:-7px;margin:0 3px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-backdrop{-webkit-transform-origin:0 25%;transform-origin:0 25%}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-55%);transform:scale(1) translate(-50%,-55%)}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%,-45%);transform:scale(.2) translate(-50%,-45%);opacity:0}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(-20px);transform:translateY(-20px)}.tippy-popper[x-placement^=top] [data-animation=perspective]{-webkit-transform-origin:bottom;transform-origin:bottom}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=visible]{-webkit-transform:perspective(700px) translateY(-10px);transform:perspective(700px) translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:perspective(700px) rotateX(60deg);transform:perspective(700px) rotateX(60deg)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-popper[x-placement^=top] [data-animation=scale]{-webkit-transform-origin:bottom;transform-origin:bottom}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(-10px) scale(.5);transform:translateY(-10px) scale(.5)}.tippy-popper[x-placement^=bottom] .tippy-backdrop{border-radius:0 0 30% 30%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow{top:-7px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%;margin:0 3px}.tippy-popper[x-placement^=bottom] .tippy-roundarrow svg{position:absolute;left:0}.tippy-popper[x-placement^=bottom] .tippy-arrow{border-bottom:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;top:-7px;margin:0 3px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-backdrop{-webkit-transform-origin:0 -50%;transform-origin:0 -50%}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-45%);transform:scale(1) translate(-50%,-45%)}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%);transform:scale(.2) translate(-50%);opacity:0}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}.tippy-popper[x-placement^=bottom] [data-animation=perspective]{-webkit-transform-origin:top;transform-origin:top}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=visible]{-webkit-transform:perspective(700px) translateY(10px);transform:perspective(700px) translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:perspective(700px) rotateX(-60deg);transform:perspective(700px) rotateX(-60deg)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-popper[x-placement^=bottom] [data-animation=scale]{-webkit-transform-origin:top;transform-origin:top}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(10px) scale(.5);transform:translateY(10px) scale(.5)}.tippy-popper[x-placement^=left] .tippy-backdrop{border-radius:50% 0 0 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow{right:-12px;-webkit-transform-origin:33.33333333% 50%;transform-origin:33.33333333% 50%;margin:3px 0}.tippy-popper[x-placement^=left] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.tippy-popper[x-placement^=left] .tippy-arrow{border-left:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;right:-7px;margin:3px 0;-webkit-transform-origin:0 50%;transform-origin:0 50%}.tippy-popper[x-placement^=left] .tippy-backdrop{-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-75%,-50%);transform:scale(.2) translate(-75%,-50%);opacity:0}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(-20px);transform:translateX(-20px)}.tippy-popper[x-placement^=left] [data-animation=perspective]{-webkit-transform-origin:right;transform-origin:right}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=visible]{-webkit-transform:perspective(700px) translateX(-10px);transform:perspective(700px) translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:perspective(700px) rotateY(-60deg);transform:perspective(700px) rotateY(-60deg)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-popper[x-placement^=left] [data-animation=scale]{-webkit-transform-origin:right;transform-origin:right}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(-10px) scale(.5);transform:translateX(-10px) scale(.5)}.tippy-popper[x-placement^=right] .tippy-backdrop{border-radius:0 50% 50% 0}.tippy-popper[x-placement^=right] .tippy-roundarrow{left:-12px;-webkit-transform-origin:66.66666666% 50%;transform-origin:66.66666666% 50%;margin:3px 0}.tippy-popper[x-placement^=right] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.tippy-popper[x-placement^=right] .tippy-arrow{border-right:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;left:-7px;margin:3px 0;-webkit-transform-origin:100% 50%;transform-origin:100% 50%}.tippy-popper[x-placement^=right] .tippy-backdrop{-webkit-transform-origin:-50% 0;transform-origin:-50% 0}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-25%,-50%);transform:scale(.2) translate(-25%,-50%);opacity:0}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(20px);transform:translateX(20px)}.tippy-popper[x-placement^=right] [data-animation=perspective]{-webkit-transform-origin:left;transform-origin:left}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=visible]{-webkit-transform:perspective(700px) translateX(10px);transform:perspective(700px) translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:perspective(700px) rotateY(60deg);transform:perspective(700px) rotateY(60deg)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-popper[x-placement^=right] [data-animation=scale]{-webkit-transform-origin:left;transform-origin:left}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(10px) scale(.5);transform:translateX(10px) scale(.5)}.tippy-tooltip{position:relative;color:#fff;border-radius:.25rem;font-size:.875rem;padding:.3125rem .5625rem;line-height:1.4;text-align:center;background-color:#333}.tippy-tooltip[data-size=small]{padding:.1875rem .375rem;font-size:.75rem}.tippy-tooltip[data-size=large]{padding:.375rem .75rem;font-size:1rem}.tippy-tooltip[data-animatefill]{overflow:hidden;background-color:initial}.tippy-tooltip[data-interactive],.tippy-tooltip[data-interactive] .tippy-roundarrow path{pointer-events:auto}.tippy-tooltip[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-tooltip[data-inertia][data-state=hidden]{transition-timing-function:ease}.tippy-arrow,.tippy-roundarrow{position:absolute;width:0;height:0}.tippy-roundarrow{width:18px;height:7px;fill:#333;pointer-events:none}.tippy-backdrop{position:absolute;background-color:#333;border-radius:50%;width:calc(110% + 2rem);left:50%;top:50%;z-index:-1;transition:all cubic-bezier(.46,.1,.52,.98);-webkit-backface-visibility:hidden;backface-visibility:hidden}.tippy-backdrop:after{content:"";float:left;padding-top:100%}.tippy-backdrop+.tippy-content{transition-property:opacity;will-change:opacity}.tippy-backdrop+.tippy-content[data-state=hidden]{opacity:0}',t.setAttribute("data-tippy-stylesheet","");var n=document.head,r=n.querySelector("style,link");r?n.insertBefore(t,r):n.appendChild(t)}}(),t.default=se},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachWelcomeActor=void 0;var r=n(59),i=n(26),a=n(108),o=n(57),s=n(12),c=n(152),l=function(){function e(e,t,n){this.events=new s.EventEmitter,this.m_coachActorConfig=e,this.m_document=this.m_coachActorConfig.rootContainer.ownerDocument||document,this.m_getStartedCallback=n,this.m_svgGenerator=new c.RehearsalSVGGenerator(this.m_document,t);var r=Date.now();this.m_rehearsalActorContainerDiv=this.generateWelcomeScreen(this.m_coachActorConfig.fShowRealtimeFeedbackEnabledCheckbox||!1),this.m_rehearsalStatusValueDiv=this.generateStatusValueDiv(),this.m_rehearsalStatusTextDiv=this.generateWelcomeStatusText(),this.m_rehearsalWelcomeCheckbox=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox"),this.m_rehearsalWelcomeCheckboxSpan=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcome-realtimeCheckmarkSpan"),this.m_rehearsalGetStartedButton=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcome-getStartedButton"),this.m_rehearsalWelcomeValueDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcomeValue"),this.m_rehearsalWelcomeTopBarDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerLabel-realtimeWelcome"),this.m_coachDashboardCreationTime=Date.now()-r}return e.prototype.on=function(e,t){return this.events.on(e,t),this},e.prototype.addFocusTrapElements=function(){var e=[this.m_rehearsalGetStartedButton.id,"ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox"];this.focusTrap=new o.FocusTrap(e)},e.prototype.removeFocusTrapElements=function(){this.focusTrap.disable()},e.prototype.handleKeyDown=function(e){var t,n=this.m_document.getElementById("ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox");if(this.m_coachActorConfig.fRemoveFocusTrapForWin32&&"Tab"===e.key&&!e.shiftKey&&e.target===n)e.stopImmediatePropagation(),e.preventDefault(),e.target.blur(),this.events.emit("CoachRelinquishControl");else if(9===e.keyCode&&this.focusTrap.isTrapEnabled())if(e.stopImmediatePropagation(),e.preventDefault(),e.shiftKey)e.target===this.m_rehearsalGetStartedButton?(null===(t=this.m_rehearsalGetStartedButton)||void 0===t||t.blur(),this.events.emit("CoachRelinquishControl")):this.focusTrap.focusForward(!1);else{var r=document.getElementById("ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox");e.target===r?(null==r||r.blur(),this.events.emit("CoachRelinquishControl")):this.focusTrap.focusForward(!0)}},e.prototype.showStatusNotification=function(e,t){this.m_rehearsalWelcomeValueDiv&&(this.m_rehearsalWelcomeValueDiv.style.display="none"),this.m_rehearsalStatusValueDiv&&this.m_rehearsalActorContainerDiv&&this.m_rehearsalWelcomeTopBarDiv&&(this.m_rehearsalWelcomeTopBarDiv.innerText=i.RehearsalActorSettings.CoachTitleText,this.m_rehearsalStatusTextDiv&&(this.m_rehearsalStatusTextDiv.innerText=e,this.m_rehearsalStatusValueDiv.appendChild(this.m_rehearsalStatusTextDiv),this.m_rehearsalActorContainerDiv.appendChild(this.m_rehearsalStatusValueDiv)))},e.prototype.showCoachDisabledUI=function(){this.m_rehearsalGetStartedButton&&(this.m_rehearsalGetStartedButton.disabled=!0)},e.prototype.showCoachDisabledVisionUI=function(){this.showCoachDisabledUI()},e.prototype.startWelcomeActor=function(e){this.m_rehearsalStatusValueDiv&&(this.m_rehearsalStatusValueDiv.style.display="none"),this.m_rehearsalWelcomeValueDiv&&this.m_rehearsalWelcomeTopBarDiv&&(this.m_rehearsalWelcomeTopBarDiv.innerText=i.RehearsalActorSettings.RehearsalWelcomePlainText,this.m_rehearsalWelcomeValueDiv.style.display="block"),!this.m_coachActorConfig.fRemoveFocusTrapForWin32&&a.shouldHandleSpecialFocus(this.m_coachActorConfig.clientType)&&this.addFocusTrapElements(),e&&this.userClickedGetStarted(new CustomEvent("skip-welcome"))},e.prototype.getElementsToAvoidDraggingOn=function(){var e=[];return this.m_rehearsalWelcomeCheckbox&&e.push(this.m_rehearsalWelcomeCheckbox),this.m_rehearsalWelcomeCheckboxSpan&&e.push(this.m_rehearsalWelcomeCheckboxSpan),this.m_rehearsalGetStartedButton&&e.push(this.m_rehearsalGetStartedButton),e},e.prototype.getActorContainer=function(){return this.m_rehearsalActorContainerDiv},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.generateFirstRunWelcomeValueDiv=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeValue",e},e.prototype.generateStatusValueDiv=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeStatusContainer",e.className="ppt-RehearsalTrackerDiv-welcomeStatus",e},e.prototype.generateWelcomeStatusText=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeStatusTextContainer",e.className="ppt-RehearsalTrackerDiv-welcomeStatusText",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.setAttribute("focusable","true"),e.innerText="",e.setAttribute("role","text"),e.setAttribute("aria-role","text"),e},e.prototype.generateWelcomeImage=function(){var e=this.m_document.createElement("img");return e.id="ppt-RehearsalTrackerDiv-welcomeImage",e.src=this.m_coachActorConfig.imagesBaseFilePath+"welcomeGraphic.png",e.alt=i.RehearsalActorSettings.RehearsalWelcomeImageText,e},e.prototype.generateWelcomeTitle=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeTitle",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.setAttribute("focusable","true"),e.innerText=i.RehearsalActorSettings.RehearsalWelcomeScreenTitle,e.setAttribute("aria-label",i.RehearsalActorSettings.RehearsalWelcomeScreenTitle),e.setAttribute("role","heading"),e.setAttribute("aria-role","heading"),e},e.prototype.generateWelcomeText=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-welcomeText",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.setAttribute("focusable","true");var t=a.getWelcomeScreenText(this.m_coachActorConfig.clientType);return e.innerText=t,e.setAttribute("aria-label",t),e.setAttribute("role","text"),e.setAttribute("aria-role","text"),e},e.prototype.generateRealTimeLabel=function(e,t){var n=this.m_document.createElement("div");return n.id=t,n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",n.innerText=e,n},e.prototype.generateRehearsalTopBar=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalDiv-welcomeTopBar";var t=this.generateRealTimeLabel("Welcome","ppt-RehearsalTrackerLabel-realtimeWelcome");return e.appendChild(t),e},e.prototype.generateWelcomeScreen=function(e){var t=this.m_document.createElement("div");t.id="ppt-RehearsalTrackerDiv-welcome",t.classList.add("verboseWelcome");var n=this.generateRehearsalTopBar();t.appendChild(n);var r=this.generateFirstRunWelcomeValueDiv();if(!a.shouldShowMinimalWelcomeScreen(this.m_coachActorConfig.clientType)){if(this.m_coachActorConfig.fUseSVGResources){var i=this.m_svgGenerator.getSVGForCritique("welcomeImage");r.appendChild(i)}else{var o=this.generateWelcomeImage();r.appendChild(o)}var s=this.generateWelcomeTitle();r.appendChild(s)}var c=this.generateWelcomeText(),l=this.generateGetStartedButton();if(r.appendChild(c),r.appendChild(l),e){var u=this.m_coachActorConfig.fUseNewRealtimeCheckbox?this.generateRealtimeFeedbackEnabledDivNew():this.generateRealtimeFeedbackEnabledDiv();r.appendChild(u)}return t.appendChild(r),t},e.prototype.onMouseDownClickedGetStarted=function(e){return e.preventDefault(),!1},e.prototype.generateGetStartedButton=function(){var e="getStartedButton";this.m_coachActorConfig.clientType===r.ClientType.Win32&&this.m_coachActorConfig.fUseFluentUIForWindows&&(e+=" fluentUI");var t=this.m_document.createElement("button");return t.id="ppt-RehearsalTrackerDiv-welcome-getStartedButton",t.className=e,t.onmousedown=this.onMouseDownClickedGetStarted.bind(this),t.onclick=this.userClickedGetStarted.bind(this),t.addEventListener("touchend",this.userClickedGetStarted.bind(this),!0),t.setAttribute("focusable","true"),t.tabIndex=i.RehearsalActorSettings.RehearsalContainerFocusTabIndex,t.textContent=i.RehearsalActorSettings.RehearsalGetStartedButtonLabel,t.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",t},e.prototype.generateShowRealtimeFeedbackCheckbox=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackCheckbox",e.classList.add("checkboxContainer");var t=this.m_document.createElement("input");t.type="checkbox",t.id="ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox",t.checked=!0,t.setAttribute("focusable","true"),t.tabIndex=i.RehearsalActorSettings.RehearsalRealtimeCheckboxFocusTabIndex;var n=this.m_document.createElement("span");return n.classList.add("checkmarkSpan"),n.id="ppt-RehearsalTrackerDiv-welcome-realtimeCheckmarkSpan",e.appendChild(t),e.appendChild(n),t.addEventListener("keyup",(function(e){13===e.keyCode&&(t.checked=!t.checked)})),t.addEventListener("focus",(function(e){n.classList.add("focusedCheckbox");var t=document.getElementById("realtimeFeedbackEnabledContainer");t&&t.classList.add("realtimeFeedbackEnabledContainerOnFocus")})),t.addEventListener("blur",(function(e){n.classList.remove("focusedCheckbox");var t=document.getElementById("realtimeFeedbackEnabledContainer");t&&t.classList.remove("realtimeFeedbackEnabledContainerOnFocus")})),e},e.prototype.generateShowRealtimeFeedbackLabel=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcome-showRealtimeFeedbackLabel",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.innerText=i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel,e.setAttribute("aria-label",i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel),e},e.prototype.generateRealtimeFeedbackEnabledDivNew=function(){var e=this.m_document.createElement("div");e.id="realtimeFeedbackEnabledContainer",e.classList.add("realtimeFeedbackEnabledContainerDiv");var t=this.m_document.createElement("div");t.id="realtimeFeedbackEnabledCheckboxWrapper",t.classList.add("checkboxwrapper");var n=this.m_document.createElement("input");n.type="checkbox",n.checked=!0,n.id="ppt-RehearsalTrackerDiv-welcome-realtimeFeedbackEnabledCheckbox",n.setAttribute("aria-label",i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel),n.tabIndex=i.RehearsalActorSettings.RehearsalRealtimeCheckboxFocusTabIndex;var r=this.m_document.createElement("label");return r.id="ppt-RehearsalTrackerDiv-welcome-showRealtimeFeedbackLabel",r.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",r.innerText=i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel,r.setAttribute("aria-label",i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel),t.appendChild(n),t.appendChild(r),e.appendChild(t),e},e.prototype.generateRealtimeFeedbackEnabledDiv=function(){var e=this.m_document.createElement("div");e.id="realtimeFeedbackEnabledContainer",e.setAttribute("aria-label",i.RehearsalActorSettings.RehearsalShowRealtimeFeedbackLabel),e.setAttribute("aria-role","checkbox"),e.classList.add("realtimeFeedbackEnabledDiv");var t=this.generateShowRealtimeFeedbackCheckbox(),n=this.generateShowRealtimeFeedbackLabel();return e.appendChild(t),e.appendChild(n),e},e.prototype.userClickedGetStarted=function(e){return!this.m_coachActorConfig.fRemoveFocusTrapForWin32&&a.shouldHandleSpecialFocus(this.m_coachActorConfig.clientType)&&this.removeFocusTrapElements(),this.m_getStartedCallback&&this.m_getStartedCallback(!this.m_rehearsalWelcomeCheckbox||this.m_rehearsalWelcomeCheckbox.checked),e.stopPropagation(),!1},e}();t.CoachWelcomeActor=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachCountdownWelcomeActor=void 0;var r=n(26),i=n(12),a=n(57),o=function(){function e(e,t,n){this.FULL_DASH_ARRAY=283,this.TIME_LIMIT=5,this.m_timerInterval=null,this.m_timeLeft=this.TIME_LIMIT,this.events=new i.EventEmitter,this.m_coachActorConfig=e,this.m_document=this.m_coachActorConfig.rootContainer.ownerDocument||document,this.m_getStartedCallback=n;var r=Date.now();this.m_rehearsalActorContainerDiv=this.generateWelcomeScreen(),this.m_rehearsalCountdownDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-countdownDiv"),this.m_rehearsalCountdownTextDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcomeText"),this.m_rehearsalWelcomeValueDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerDiv-welcomeValue"),this.m_rehearsalWelcomeLabelDiv=this.m_rehearsalActorContainerDiv.querySelector("#ppt-RehearsalTrackerLabel-realtimeWelcome"),this.m_coachDashboardCreationTime=Date.now()-r,this.m_timeLeft=this.TIME_LIMIT}return e.prototype.on=function(e,t){return this.events.on(e,t),this},e.prototype.handleKeyDown=function(e){},e.prototype.showStatusNotification=function(e,t){},e.prototype.showCoachDisabledUI=function(e){var t="",n="";e===r.RehearsalErrorReason.NoCamera?(t=r.RehearsalActorSettings.RehearsalVisionCountdownWelcomeScreenErrorText,n=r.RehearsalActorSettings.RehearsalNoCameraAccessLabel):(t=r.RehearsalActorSettings.RehearsalCountdownWelcomeScreenErrorText,n=r.RehearsalActorSettings.RehearsalNoMicAccessLabel),clearInterval(this.m_timerInterval),this.m_rehearsalCountdownDiv&&(this.m_rehearsalCountdownDiv.style.display="none"),this.m_rehearsalCountdownTextDiv&&(this.m_rehearsalCountdownTextDiv.innerText=t),this.m_rehearsalWelcomeValueDiv&&this.m_rehearsalWelcomeValueDiv.classList.add("vertical-center"),this.m_rehearsalWelcomeLabelDiv&&(this.m_rehearsalWelcomeLabelDiv.innerText=n)},e.prototype.startWelcomeActor=function(){this.startTimer()},e.prototype.getElementsToAvoidDraggingOn=function(){return[]},e.prototype.getActorContainer=function(){return this.m_rehearsalActorContainerDiv},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.generateFirstRunWelcomeValueDiv=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeValue",e},e.prototype.calculateTimeFraction=function(){return(this.m_timeLeft-1)/this.TIME_LIMIT},e.prototype.setCircleDasharray=function(){var e=(this.calculateTimeFraction()*this.FULL_DASH_ARRAY).toFixed(0)+" 283",t=document.getElementById("base-timer-path-remaining");t&&t.setAttribute("stroke-dasharray",e)},e.prototype.startTimer=function(){var e=this;this.m_timerInterval=setInterval((function(){e.m_timeLeft=e.m_timeLeft-=1;var t=document.getElementById("base-timer-label");t&&(t.innerText=String(e.m_timeLeft)),e.setCircleDasharray(),0===e.m_timeLeft&&(e.m_getStartedCallback(!0),clearInterval(e.m_timerInterval))}),1e3)},e.prototype.setCountdownDiv=function(e,t){var n=' <div class="base-timer">\n        <svg class="base-timer__svg" viewBox="0 0 100 100">\n          <g class="base-timer__circle">\n          <linearGradient id="linearColors4" x1="0" y1="0.81" x2="0.3" y2="0">\n              <stop offset="0%" stop-color="#B7472A"></stop>\n              <stop offset="100%" stop-color="#ED9583"></stop>\n          </linearGradient>\n            <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>\n            <path\n              id="base-timer-path-remaining"\n              fill="none" stroke="url(#linearColors4)" stroke-width="5"\n              stroke-dasharray="283"\n              class="base-timer__path-remaining"\n              d="\n                M 50, 50\n                m -45, 0\n                a 45,45 0 1,0 90,0\n                a 45,45 0 1,0 -90,0\n              "\n            ></path>\n          </g>\n        </svg>\n        <span id="base-timer-label" class="base-timer__label">'+t+"</span>\n      </div>";a.setInnerHtml(e,n)},e.prototype.generateCountdownDiv=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-countdownDiv";var t=this.m_document.createElement("div");return t.id="ppt-RehearsalTrackerDiv-countdownSVG",this.setCountdownDiv(t,this.m_timeLeft),e.appendChild(t),e},e.prototype.generateWelcomeText=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalTrackerDiv-welcomeText",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.setAttribute("focusable","true"),e.innerText=r.RehearsalActorSettings.RehearsalCountdownWelcomeScreenText,e.setAttribute("aria-label",r.RehearsalActorSettings.RehearsalCountdownWelcomeScreenText),e.setAttribute("role","text"),e.setAttribute("aria-role","text"),e},e.prototype.generateRealTimeLabel=function(e,t){var n=this.m_document.createElement("div");return n.id=t,n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",n.innerText=e,n.style.cursor="default",n},e.prototype.generateRehearsalTopBar=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalDiv-welcomeTopBar";var t=this.generateRealTimeLabel(PowerpointPresenterCoachStrings.CoachTitleText,"ppt-RehearsalTrackerLabel-realtimeWelcome");return e.appendChild(t),e},e.prototype.generateWelcomeScreen=function(){var e=this.m_document.createElement("div");e.id="ppt-RehearsalTrackerDiv-welcome",e.classList.add("countdownWelcome");var t=this.generateRehearsalTopBar();e.appendChild(t);var n=this.generateFirstRunWelcomeValueDiv(),r=this.generateCountdownDiv(),i=this.generateWelcomeText();return n.appendChild(r),n.appendChild(i),e.appendChild(n),this.m_rehearsalCountdownDiv=r,this.m_rehearsalCountdownTextDiv=i,e},e}();t.CoachCountdownWelcomeActor=o},function(e,t){var n,r;r={},function(e,t){function n(){this._delay=0,this._endDelay=0,this._fill="none",this._iterationStart=0,this._iterations=1,this._duration=0,this._playbackRate=1,this._direction="normal",this._easing="linear",this._easingFunction=m}function r(){return e.isDeprecated("Invalid timing inputs","2016-03-02","TypeError exceptions will be thrown instead.",!0)}function i(t,r,i){var a=new n;return r&&(a.fill="both",a.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.getOwnPropertyNames(t).forEach((function(n){if("auto"!=t[n]){if(("number"==typeof a[n]||"duration"==n)&&("number"!=typeof t[n]||isNaN(t[n])))return;if("fill"==n&&-1==u.indexOf(t[n]))return;if("direction"==n&&-1==h.indexOf(t[n]))return;if("playbackRate"==n&&1!==t[n]&&e.isDeprecated("AnimationEffectTiming.playbackRate","2014-11-28","Use Animation.playbackRate instead."))return;a[n]=t[n]}})):a.duration=t,a}function a(e,t,n,r){return e<0||e>1||n<0||n>1?m:function(i){function a(e,t,n){return 3*e*(1-n)*(1-n)*n+3*t*(1-n)*n*n+n*n*n}if(i<=0){var o=0;return e>0?o=t/e:!t&&n>0&&(o=r/n),o*i}if(i>=1){var s=0;return n<1?s=(r-1)/(n-1):1==n&&e<1&&(s=(t-1)/(e-1)),1+s*(i-1)}for(var c=0,l=1;c<l;){var u=(c+l)/2,h=a(e,n,u);if(Math.abs(i-h)<1e-5)return a(t,r,u);h<i?c=u:l=u}return a(t,r,u)}}function o(e,t){return function(n){if(n>=1)return 1;var r=1/e;return(n+=t*r)-n%r}}function s(e){v||(v=document.createElement("div").style),v.animationTimingFunction="",v.animationTimingFunction=e;var t=v.animationTimingFunction;if(""==t&&r())throw new TypeError(e+" is not a valid value for easing");return t}function c(e){if("linear"==e)return m;var t=C.exec(e);if(t)return a.apply(this,t.slice(1).map(Number));var n=S.exec(e);if(n)return o(Number(n[1]),f);var r=_.exec(e);return r?o(Number(r[1]),{start:d,middle:p,end:f}[r[2]]):g[e]||m}function l(e,t,n){if(null==t)return T;var r=n.delay+e+n.endDelay;return t<Math.min(n.delay,r)?b:t>=Math.min(n.delay+e,r)?R:w}var u="backwards|forwards|both|none".split("|"),h="reverse|alternate|alternate-reverse".split("|"),m=function(e){return e};n.prototype={_setMember:function(t,n){this["_"+t]=n,this._effect&&(this._effect._timingInput[t]=n,this._effect._timing=e.normalizeTimingInput(this._effect._timingInput),this._effect.activeDuration=e.calculateActiveDuration(this._effect._timing),this._effect._animation&&this._effect._animation._rebuildUnderlyingAnimation())},get playbackRate(){return this._playbackRate},set delay(e){this._setMember("delay",e)},get delay(){return this._delay},set endDelay(e){this._setMember("endDelay",e)},get endDelay(){return this._endDelay},set fill(e){this._setMember("fill",e)},get fill(){return this._fill},set iterationStart(e){if((isNaN(e)||e<0)&&r())throw new TypeError("iterationStart must be a non-negative number, received: "+e);this._setMember("iterationStart",e)},get iterationStart(){return this._iterationStart},set duration(e){if("auto"!=e&&(isNaN(e)||e<0)&&r())throw new TypeError("duration must be non-negative or auto, received: "+e);this._setMember("duration",e)},get duration(){return this._duration},set direction(e){this._setMember("direction",e)},get direction(){return this._direction},set easing(e){this._easingFunction=c(s(e)),this._setMember("easing",e)},get easing(){return this._easing},set iterations(e){if((isNaN(e)||e<0)&&r())throw new TypeError("iterations must be non-negative, received: "+e);this._setMember("iterations",e)},get iterations(){return this._iterations}};var d=1,p=.5,f=0,g={ease:a(.25,.1,.25,1),"ease-in":a(.42,0,1,1),"ease-out":a(0,0,.58,1),"ease-in-out":a(.42,0,.58,1),"step-start":o(1,d),"step-middle":o(1,p),"step-end":o(1,f)},v=null,y="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",C=new RegExp("cubic-bezier\\("+y+","+y+","+y+","+y+"\\)"),S=/steps\(\s*(\d+)\s*\)/,_=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/,T=0,b=1,R=2,w=3;e.cloneTimingInput=function(e){if("number"==typeof e)return e;var t={};for(var n in e)t[n]=e[n];return t},e.makeTiming=i,e.numericTimingToObject=function(e){return"number"==typeof e&&(e=isNaN(e)?{duration:0}:{duration:e}),e},e.normalizeTimingInput=function(t,n){return i(t=e.numericTimingToObject(t),n)},e.calculateActiveDuration=function(e){return Math.abs(function(e){return 0===e.duration||0===e.iterations?0:e.duration*e.iterations}(e)/e.playbackRate)},e.calculateIterationProgress=function(e,t,n){var r=l(e,t,n),i=function(e,t,n,r,i){switch(r){case b:return"backwards"==t||"both"==t?0:null;case w:return n-i;case R:return"forwards"==t||"both"==t?e:null;case T:return null}}(e,n.fill,t,r,n.delay);if(null===i)return null;var a=function(e,t,n,r,i){var a=i;return 0===e?t!==b&&(a+=n):a+=r/e,a}(n.duration,r,n.iterations,i,n.iterationStart),o=function(e,t,n,r,i,a){var o=e===1/0?t%1:e%1;return 0!==o||n!==R||0===r||0===i&&0!==a||(o=1),o}(a,n.iterationStart,r,n.iterations,i,n.duration),s=function(e,t,n,r){return e===R&&t===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,o,a),c=function(e,t,n){var r=e;if("normal"!==e&&"reverse"!==e){var i=t;"alternate-reverse"===e&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,s,o);return n._easingFunction(c)},e.calculatePhase=l,e.normalizeEasing=s,e.parseEasingFunction=c}(n={}),function(e,t){function n(e,t){return e in c&&c[e][t]||t}function r(e,t,r){if(!function(e){return"display"===e||0===e.lastIndexOf("animation",0)||0===e.lastIndexOf("transition",0)}(e)){var i=a[e];if(i)for(var s in o.style[e]=t,i){var c=i[s],l=o.style[c];r[c]=n(c,l)}else r[e]=n(e,t)}}function i(e){var t=[];for(var n in e)if(!(n in["easing","offset","composite"])){var r=e[n];Array.isArray(r)||(r=[r]);for(var i,a=r.length,o=0;o<a;o++)(i={}).offset="offset"in e?e.offset:1==a?1:o/(a-1),"easing"in e&&(i.easing=e.easing),"composite"in e&&(i.composite=e.composite),i[n]=r[o],t.push(i)}return t.sort((function(e,t){return e.offset-t.offset})),t}var a={background:["backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","backgroundAttachment","backgroundOrigin","backgroundClip","backgroundColor"],border:["borderTopColor","borderTopStyle","borderTopWidth","borderRightColor","borderRightStyle","borderRightWidth","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderColor:["borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderWidth:["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],flex:["flexGrow","flexShrink","flexBasis"],font:["fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineHeight"],margin:["marginTop","marginRight","marginBottom","marginLeft"],outline:["outlineColor","outlineStyle","outlineWidth"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"]},o=document.createElementNS("http://www.w3.org/1999/xhtml","div"),s={thin:"1px",medium:"3px",thick:"5px"},c={borderBottomWidth:s,borderLeftWidth:s,borderRightWidth:s,borderTopWidth:s,fontSize:{"xx-small":"60%","x-small":"75%",small:"89%",medium:"100%",large:"120%","x-large":"150%","xx-large":"200%"},fontWeight:{normal:"400",bold:"700"},outlineWidth:s,textShadow:{none:"0px 0px 0px transparent"},boxShadow:{none:"0px 0px 0px 0px transparent"}};e.convertToArrayForm=i,e.normalizeKeyframes=function(t){if(null==t)return[];window.Symbol&&Symbol.iterator&&Array.prototype.from&&t[Symbol.iterator]&&(t=Array.from(t)),Array.isArray(t)||(t=i(t));for(var n=t.map((function(t){var n={};for(var i in t){var a=t[i];if("offset"==i){if(null!=a){if(a=Number(a),!isFinite(a))throw new TypeError("Keyframe offsets must be numbers.");if(a<0||a>1)throw new TypeError("Keyframe offsets must be between 0 and 1.")}}else if("composite"==i){if("add"==a||"accumulate"==a)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"add compositing is not supported"};if("replace"!=a)throw new TypeError("Invalid composite mode "+a+".")}else a="easing"==i?e.normalizeEasing(a):""+a;r(i,a,n)}return null==n.offset&&(n.offset=null),null==n.easing&&(n.easing="linear"),n})),a=!0,o=-1/0,s=0;s<n.length;s++){var c=n[s].offset;if(null!=c){if(c<o)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");o=c}else a=!1}return n=n.filter((function(e){return e.offset>=0&&e.offset<=1})),a||function(){var e=n.length;null==n[e-1].offset&&(n[e-1].offset=1),e>1&&null==n[0].offset&&(n[0].offset=0);for(var t=0,r=n[0].offset,i=1;i<e;i++){var a=n[i].offset;if(null!=a){for(var o=1;o<i-t;o++)n[t+o].offset=r+(a-r)*o/(i-t);t=i,r=a}}}(),n}}(n),function(e){var t={};e.isDeprecated=function(e,n,r,i){var a=i?"are":"is",o=new Date,s=new Date(n);return s.setMonth(s.getMonth()+3),!(o<s&&(e in t||console.warn("Web Animations: "+e+" "+a+" deprecated and will stop working on "+s.toDateString()+". "+r),t[e]=!0,1))},e.deprecated=function(t,n,r,i){var a=i?"are":"is";if(e.isDeprecated(t,n,r,i))throw new Error(t+" "+a+" no longer supported. "+r)}}(n),function(){if(document.documentElement.animate){var e=document.documentElement.animate([],0),t=!0;if(e&&(t=!1,"play|currentTime|pause|reverse|playbackRate|cancel|finish|startTime|playState".split("|").forEach((function(n){void 0===e[n]&&(t=!0)}))),!t)return}!function(e,t,n){t.convertEffectInput=function(n){var r=function(e){for(var t={},n=0;n<e.length;n++)for(var r in e[n])if("offset"!=r&&"easing"!=r&&"composite"!=r){var i={offset:e[n].offset,easing:e[n].easing,value:e[n][r]};t[r]=t[r]||[],t[r].push(i)}for(var a in t){var o=t[a];if(0!=o[0].offset||1!=o[o.length-1].offset)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"Partial keyframes are not supported"}}return t}(e.normalizeKeyframes(n)),i=function(n){var r=[];for(var i in n)for(var a=n[i],o=0;o<a.length-1;o++){var s=o,c=o+1,l=a[s].offset,u=a[c].offset,h=l,m=u;0==o&&(h=-1/0,0==u&&(c=s)),o==a.length-2&&(m=1/0,1==l&&(s=c)),r.push({applyFrom:h,applyTo:m,startOffset:a[s].offset,endOffset:a[c].offset,easingFunction:e.parseEasingFunction(a[s].easing),property:i,interpolation:t.propertyInterpolation(i,a[s].value,a[c].value)})}return r.sort((function(e,t){return e.startOffset-t.startOffset})),r}(r);return function(e,n){if(null!=n)i.filter((function(e){return n>=e.applyFrom&&n<e.applyTo})).forEach((function(r){var i=n-r.startOffset,a=r.endOffset-r.startOffset,o=0==a?0:r.easingFunction(i/a);t.apply(e,r.property,r.interpolation(o))}));else for(var a in r)"offset"!=a&&"easing"!=a&&"composite"!=a&&t.clear(e,a)}}}(n,r),function(e,t,n){function r(e){return e.replace(/-(.)/g,(function(e,t){return t.toUpperCase()}))}function i(e,t,n){a[n]=a[n]||[],a[n].push([e,t])}var a={};t.addPropertiesHandler=function(e,t,n){for(var a=0;a<n.length;a++)i(e,t,r(n[a]))};var o={backgroundColor:"transparent",backgroundPosition:"0% 0%",borderBottomColor:"currentColor",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomWidth:"3px",borderLeftColor:"currentColor",borderLeftWidth:"3px",borderRightColor:"currentColor",borderRightWidth:"3px",borderSpacing:"2px",borderTopColor:"currentColor",borderTopLeftRadius:"0px",borderTopRightRadius:"0px",borderTopWidth:"3px",bottom:"auto",clip:"rect(0px, 0px, 0px, 0px)",color:"black",fontSize:"100%",fontWeight:"400",height:"auto",left:"auto",letterSpacing:"normal",lineHeight:"120%",marginBottom:"0px",marginLeft:"0px",marginRight:"0px",marginTop:"0px",maxHeight:"none",maxWidth:"none",minHeight:"0px",minWidth:"0px",opacity:"1.0",outlineColor:"invert",outlineOffset:"0px",outlineWidth:"3px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"0px",right:"auto",strokeDasharray:"none",strokeDashoffset:"0px",textIndent:"0px",textShadow:"0px 0px 0px transparent",top:"auto",transform:"",verticalAlign:"0px",visibility:"visible",width:"auto",wordSpacing:"normal",zIndex:"auto"};t.propertyInterpolation=function(n,i,s){var c=n;/-/.test(n)&&!e.isDeprecated("Hyphenated property names","2016-03-22","Use camelCase instead.",!0)&&(c=r(n)),"initial"!=i&&"initial"!=s||("initial"==i&&(i=o[c]),"initial"==s&&(s=o[c]));for(var l=i==s?[]:a[c],u=0;l&&u<l.length;u++){var h=l[u][0](i),m=l[u][0](s);if(void 0!==h&&void 0!==m){var d=l[u][1](h,m);if(d){var p=t.Interpolation.apply(null,d);return function(e){return 0==e?i:1==e?s:p(e)}}}}return t.Interpolation(!1,!0,(function(e){return e?s:i}))}}(n,r),function(e,t,n){t.KeyframeEffect=function(n,r,i,a){var o,s=function(t){var n=e.calculateActiveDuration(t),r=function(r){return e.calculateIterationProgress(n,r,t)};return r._totalDuration=t.delay+n+t.endDelay,r}(e.normalizeTimingInput(i)),c=t.convertEffectInput(r),l=function(){c(n,o)};return l._update=function(e){return null!==(o=s(e))},l._clear=function(){c(n,null)},l._hasSameTarget=function(e){return n===e},l._target=n,l._totalDuration=s._totalDuration,l._id=a,l}}(n,r),function(e,t){function n(e,t,n){n.enumerable=!0,n.configurable=!0,Object.defineProperty(e,t,n)}function r(e){this._element=e,this._surrogateStyle=document.createElementNS("http://www.w3.org/1999/xhtml","div").style,this._style=e.style,this._length=0,this._isAnimatedProperty={},this._updateSvgTransformAttr=function(e,t){return!(!t.namespaceURI||-1==t.namespaceURI.indexOf("/svg"))&&(a in e||(e[a]=/Trident|MSIE|IEMobile|Edge|Android 4/i.test(e.navigator.userAgent)),e[a])}(window,e),this._savedTransformAttr=null;for(var t=0;t<this._style.length;t++){var n=this._style[t];this._surrogateStyle[n]=this._style[n]}this._updateIndices()}function i(e){if(!e._webAnimationsPatchedStyle){var t=new r(e);try{n(e,"style",{get:function(){return t}})}catch(t){e.style._set=function(t,n){e.style[t]=n},e.style._clear=function(t){e.style[t]=""}}e._webAnimationsPatchedStyle=e.style}}var a="_webAnimationsUpdateSvgTransformAttr",o={cssText:1,length:1,parentRule:1},s={getPropertyCSSValue:1,getPropertyPriority:1,getPropertyValue:1,item:1,removeProperty:1,setProperty:1},c={removeProperty:1,setProperty:1};for(var l in r.prototype={get cssText(){return this._surrogateStyle.cssText},set cssText(e){for(var t={},n=0;n<this._surrogateStyle.length;n++)t[this._surrogateStyle[n]]=!0;for(this._surrogateStyle.cssText=e,this._updateIndices(),n=0;n<this._surrogateStyle.length;n++)t[this._surrogateStyle[n]]=!0;for(var r in t)this._isAnimatedProperty[r]||this._style.setProperty(r,this._surrogateStyle.getPropertyValue(r))},get length(){return this._surrogateStyle.length},get parentRule(){return this._style.parentRule},_updateIndices:function(){for(;this._length<this._surrogateStyle.length;)Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,get:function(e){return function(){return this._surrogateStyle[e]}}(this._length)}),this._length++;for(;this._length>this._surrogateStyle.length;)this._length--,Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,value:void 0})},_set:function(t,n){this._style[t]=n,this._isAnimatedProperty[t]=!0,this._updateSvgTransformAttr&&"transform"==e.unprefixedPropertyName(t)&&(null==this._savedTransformAttr&&(this._savedTransformAttr=this._element.getAttribute("transform")),this._element.setAttribute("transform",e.transformToSvgMatrix(n)))},_clear:function(t){this._style[t]=this._surrogateStyle[t],this._updateSvgTransformAttr&&"transform"==e.unprefixedPropertyName(t)&&(this._savedTransformAttr?this._element.setAttribute("transform",this._savedTransformAttr):this._element.removeAttribute("transform"),this._savedTransformAttr=null),delete this._isAnimatedProperty[t]}},s)r.prototype[l]=function(e,t){return function(){var n=this._surrogateStyle[e].apply(this._surrogateStyle,arguments);return t&&(this._isAnimatedProperty[arguments[0]]||this._style[e].apply(this._style,arguments),this._updateIndices()),n}}(l,l in c);for(var u in document.documentElement.style)u in o||u in s||function(e){n(r.prototype,e,{get:function(){return this._surrogateStyle[e]},set:function(t){this._surrogateStyle[e]=t,this._updateIndices(),this._isAnimatedProperty[e]||(this._style[e]=t)}})}(u);e.apply=function(t,n,r){i(t),t.style._set(e.propertyName(n),r)},e.clear=function(t,n){t._webAnimationsPatchedStyle&&t.style._clear(e.propertyName(n))}}(r),function(e){window.Element.prototype.animate=function(t,n){var r="";return n&&n.id&&(r=n.id),e.timeline._play(e.KeyframeEffect(this,t,n,r))}}(r),function(e,t){e.Interpolation=function(e,t,n){return function(r){return n(function e(t,n,r){if("number"==typeof t&&"number"==typeof n)return t*(1-r)+n*r;if("boolean"==typeof t&&"boolean"==typeof n)return r<.5?t:n;if(t.length==n.length){for(var i=[],a=0;a<t.length;a++)i.push(e(t[a],n[a],r));return i}throw"Mismatched interpolation arguments "+t+":"+n}(e,t,r))}}}(r),function(e,t){var n=function(){function e(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=t[r][a]*e[a][i];return n}return function(t,n,r,i,a){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=a[s];for(s=0;s<3;s++)for(var c=0;c<3;c++)o[3][s]+=t[c]*o[c][s];var l=i[0],u=i[1],h=i[2],m=i[3],d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];d[0][0]=1-2*(u*u+h*h),d[0][1]=2*(l*u-h*m),d[0][2]=2*(l*h+u*m),d[1][0]=2*(l*u+h*m),d[1][1]=1-2*(l*l+h*h),d[1][2]=2*(u*h-l*m),d[2][0]=2*(l*h-u*m),d[2][1]=2*(u*h+l*m),d[2][2]=1-2*(l*l+u*u),o=e(o,d);var p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];for(r[2]&&(p[2][1]=r[2],o=e(o,p)),r[1]&&(p[2][1]=0,p[2][0]=r[0],o=e(o,p)),r[0]&&(p[2][0]=0,p[1][0]=r[0],o=e(o,p)),s=0;s<3;s++)for(c=0;c<3;c++)o[s][c]*=n[s];return function(e){return 0==e[0][2]&&0==e[0][3]&&0==e[1][2]&&0==e[1][3]&&0==e[2][0]&&0==e[2][1]&&1==e[2][2]&&0==e[2][3]&&0==e[3][2]&&1==e[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();e.composeMatrix=n,e.quat=function(t,n,r){var i=e.dot(t,n),a=[];if(1===(i=function(e,t,n){return Math.max(Math.min(e,1),-1)}(i)))a=t;else for(var o=Math.acos(i),s=1*Math.sin(r*o)/Math.sqrt(1-i*i),c=0;c<4;c++)a.push(t[c]*(Math.cos(r*o)-i*s)+n[c]*s);return a}}(r),function(e,t,n){e.sequenceNumber=0;var r=function(e,t,n){this.target=e,this.currentTime=t,this.timelineTime=n,this.type="finish",this.bubbles=!1,this.cancelable=!1,this.currentTarget=e,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()};t.Animation=function(t){this.id="",t&&t._id&&(this.id=t._id),this._sequenceNumber=e.sequenceNumber++,this._currentTime=0,this._startTime=null,this._paused=!1,this._playbackRate=1,this._inTimeline=!0,this._finishedFlag=!0,this.onfinish=null,this._finishHandlers=[],this._effect=t,this._inEffect=this._effect._update(0),this._idle=!0,this._currentTimePending=!1},t.Animation.prototype={_ensureAlive:function(){this.playbackRate<0&&0===this.currentTime?this._inEffect=this._effect._update(-1):this._inEffect=this._effect._update(this.currentTime),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,t.timeline._animations.push(this))},_tickCurrentTime:function(e,t){e!=this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this._ensureAlive())},get currentTime(){return this._idle||this._currentTimePending?null:this._currentTime},set currentTime(e){e=+e,isNaN(e)||(t.restart(),this._paused||null==this._startTime||(this._startTime=this._timeline.currentTime-e/this._playbackRate),this._currentTimePending=!1,this._currentTime!=e&&(this._idle&&(this._idle=!1,this._paused=!0),this._tickCurrentTime(e,!0),t.applyDirtiedAnimation(this)))},get startTime(){return this._startTime},set startTime(e){e=+e,isNaN(e)||this._paused||this._idle||(this._startTime=e,this._tickCurrentTime((this._timeline.currentTime-this._startTime)*this.playbackRate),t.applyDirtiedAnimation(this))},get playbackRate(){return this._playbackRate},set playbackRate(e){if(e!=this._playbackRate){var n=this.currentTime;this._playbackRate=e,this._startTime=null,"paused"!=this.playState&&"idle"!=this.playState&&(this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),t.applyDirtiedAnimation(this)),null!=n&&(this.currentTime=n)}},get _isFinished(){return!this._idle&&(this._playbackRate>0&&this._currentTime>=this._totalDuration||this._playbackRate<0&&this._currentTime<=0)},get _totalDuration(){return this._effect._totalDuration},get playState(){return this._idle?"idle":null==this._startTime&&!this._paused&&0!=this.playbackRate||this._currentTimePending?"pending":this._paused?"paused":this._isFinished?"finished":"running"},_rewind:function(){if(this._playbackRate>=0)this._currentTime=0;else{if(!(this._totalDuration<1/0))throw new DOMException("Unable to rewind negative playback rate animation with infinite duration","InvalidStateError");this._currentTime=this._totalDuration}},play:function(){this._paused=!1,(this._isFinished||this._idle)&&(this._rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),t.applyDirtiedAnimation(this)},pause:function(){this._isFinished||this._paused||this._idle?this._idle&&(this._rewind(),this._idle=!1):this._currentTimePending=!0,this._startTime=null,this._paused=!0},finish:function(){this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this._currentTimePending=!1,t.applyDirtiedAnimation(this))},cancel:function(){this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this._effect._update(null),t.applyDirtiedAnimation(this))},reverse:function(){this.playbackRate*=-1,this.play()},addEventListener:function(e,t){"function"==typeof t&&"finish"==e&&this._finishHandlers.push(t)},removeEventListener:function(e,t){if("finish"==e){var n=this._finishHandlers.indexOf(t);n>=0&&this._finishHandlers.splice(n,1)}},_fireEvents:function(e){if(this._isFinished){if(!this._finishedFlag){var t=new r(this,this._currentTime,e),n=this._finishHandlers.concat(this.onfinish?[this.onfinish]:[]);setTimeout((function(){n.forEach((function(e){e.call(t.target,t)}))}),0),this._finishedFlag=!0}}else this._finishedFlag=!1},_tick:function(e,t){this._idle||this._paused||(null==this._startTime?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this._tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this._currentTimePending=!1,this._fireEvents(e))},get _needsTick(){return this.playState in{pending:1,running:1}||!this._finishedFlag},_targetAnimations:function(){var e=this._effect._target;return e._activeAnimations||(e._activeAnimations=[]),e._activeAnimations},_markTarget:function(){var e=this._targetAnimations();-1===e.indexOf(this)&&e.push(this)},_unmarkTarget:function(){var e=this._targetAnimations(),t=e.indexOf(this);-1!==t&&e.splice(t,1)}}}(n,r),function(e,t,n){function r(e){var t=l;l=[],e<f.currentTime&&(e=f.currentTime),f._animations.sort(i),f._animations=s(e,!0,f._animations)[0],t.forEach((function(t){t[1](e)})),o()}function i(e,t){return e._sequenceNumber-t._sequenceNumber}function a(){this._animations=[],this.currentTime=window.performance&&performance.now?performance.now():0}function o(){d.forEach((function(e){e()})),d.length=0}function s(e,n,r){p=!0,m=!1,t.timeline.currentTime=e,h=!1;var i=[],a=[],o=[],s=[];return r.forEach((function(t){t._tick(e,n),t._inEffect?(a.push(t._effect),t._markTarget()):(i.push(t._effect),t._unmarkTarget()),t._needsTick&&(h=!0);var r=t._inEffect||t._needsTick;t._inTimeline=r,r?o.push(t):s.push(t)})),d.push.apply(d,i),d.push.apply(d,a),h&&requestAnimationFrame((function(){})),p=!1,[o,s]}var c=window.requestAnimationFrame,l=[],u=0;window.requestAnimationFrame=function(e){var t=u++;return 0==l.length&&c(r),l.push([t,e]),t},window.cancelAnimationFrame=function(e){l.forEach((function(t){t[0]==e&&(t[1]=function(){})}))},a.prototype={_play:function(n){n._timing=e.normalizeTimingInput(n.timing);var r=new t.Animation(n);return r._idle=!1,r._timeline=this,this._animations.push(r),t.restart(),t.applyDirtiedAnimation(r),r}};var h=!1,m=!1;t.restart=function(){return h||(h=!0,requestAnimationFrame((function(){})),m=!0),m},t.applyDirtiedAnimation=function(e){if(!p){e._markTarget();var n=e._targetAnimations();n.sort(i),s(t.timeline.currentTime,!1,n.slice())[1].forEach((function(e){var t=f._animations.indexOf(e);-1!==t&&f._animations.splice(t,1)})),o()}};var d=[],p=!1,f=new a;t.timeline=f}(n,r),function(e,t){function n(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function r(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]]}function i(e){var t=e.rad||0;return((e.deg||0)/360+(e.grad||0)/400+(e.turn||0))*(2*Math.PI)+t}function a(e){switch(e.t){case"rotatex":var t=i(e.d[0]);return[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1];case"rotatey":return t=i(e.d[0]),[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1];case"rotate":case"rotatez":return t=i(e.d[0]),[Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1,0,0,0,0,1];case"rotate3d":var n=e.d[0],r=e.d[1],a=e.d[2],o=(t=i(e.d[3]),n*n+r*r+a*a);if(0===o)n=1,r=0,a=0;else if(1!==o){var s=Math.sqrt(o);n/=s,r/=s,a/=s}var c=Math.sin(t/2),l=c*Math.cos(t/2),u=c*c;return[1-2*(r*r+a*a)*u,2*(n*r*u+a*l),2*(n*a*u-r*l),0,2*(n*r*u-a*l),1-2*(n*n+a*a)*u,2*(r*a*u+n*l),0,2*(n*a*u+r*l),2*(r*a*u-n*l),1-2*(n*n+r*r)*u,0,0,0,0,1];case"scale":return[e.d[0],0,0,0,0,e.d[1],0,0,0,0,1,0,0,0,0,1];case"scalex":return[e.d[0],0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,e.d[0],0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,e.d[0],0,0,0,0,1];case"scale3d":return[e.d[0],0,0,0,0,e.d[1],0,0,0,0,e.d[2],0,0,0,0,1];case"skew":var h=i(e.d[0]),m=i(e.d[1]);return[1,Math.tan(m),0,0,Math.tan(h),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return t=i(e.d[0]),[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return t=i(e.d[0]),[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,n=e.d[0].px||0,r=e.d[1].px||0,0,1];case"translatex":return[1,0,0,0,0,1,0,0,0,0,1,0,n=e.d[0].px||0,0,0,1];case"translatey":return[1,0,0,0,0,1,0,0,0,0,1,0,0,r=e.d[0].px||0,0,1];case"translatez":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,a=e.d[0].px||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,n=e.d[0].px||0,r=e.d[1].px||0,a=e.d[2].px||0,1];case"perspective":return[1,0,0,0,0,1,0,0,0,0,1,e.d[0].px?-1/e.d[0].px:0,0,0,0,1];case"matrix":return[e.d[0],e.d[1],0,0,e.d[2],e.d[3],0,0,0,0,1,0,e.d[4],e.d[5],0,1];case"matrix3d":return e.d}}function o(e){return 0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(a).reduce(r)}var s=function(){function e(e){return e[0][0]*e[1][1]*e[2][2]+e[1][0]*e[2][1]*e[0][2]+e[2][0]*e[0][1]*e[1][2]-e[0][2]*e[1][1]*e[2][0]-e[1][2]*e[2][1]*e[0][0]-e[2][2]*e[0][1]*e[1][0]}function t(e){var t=r(e);return[e[0]/t,e[1]/t,e[2]/t]}function r(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function i(e,t,n,r){return[n*e[0]+r*t[0],n*e[1]+r*t[1],n*e[2]+r*t[2]]}return function(a){var o=[a.slice(0,4),a.slice(4,8),a.slice(8,12),a.slice(12,16)];if(1!==o[3][3])return null;for(var s=[],c=0;c<4;c++)s.push(o[c].slice());for(c=0;c<3;c++)s[c][3]=0;if(0===e(s))return null;var l,u=[];o[0][3]||o[1][3]||o[2][3]?(u.push(o[0][3]),u.push(o[1][3]),u.push(o[2][3]),u.push(o[3][3]),l=function(e,t){for(var n=[],r=0;r<4;r++){for(var i=0,a=0;a<4;a++)i+=e[a]*t[a][r];n.push(i)}return n}(u,function(e){return[[e[0][0],e[1][0],e[2][0],e[3][0]],[e[0][1],e[1][1],e[2][1],e[3][1]],[e[0][2],e[1][2],e[2][2],e[3][2]],[e[0][3],e[1][3],e[2][3],e[3][3]]]}(function(t){for(var n=1/e(t),r=t[0][0],i=t[0][1],a=t[0][2],o=t[1][0],s=t[1][1],c=t[1][2],l=t[2][0],u=t[2][1],h=t[2][2],m=[[(s*h-c*u)*n,(a*u-i*h)*n,(i*c-a*s)*n,0],[(c*l-o*h)*n,(r*h-a*l)*n,(a*o-r*c)*n,0],[(o*u-s*l)*n,(l*i-r*u)*n,(r*s-i*o)*n,0]],d=[],p=0;p<3;p++){for(var f=0,g=0;g<3;g++)f+=t[3][g]*m[g][p];d.push(f)}return d.push(1),m.push(d),m}(s)))):l=[0,0,0,1];var h=o[3].slice(0,3),m=[];m.push(o[0].slice(0,3));var d=[];d.push(r(m[0])),m[0]=t(m[0]);var p=[];m.push(o[1].slice(0,3)),p.push(n(m[0],m[1])),m[1]=i(m[1],m[0],1,-p[0]),d.push(r(m[1])),m[1]=t(m[1]),p[0]/=d[1],m.push(o[2].slice(0,3)),p.push(n(m[0],m[2])),m[2]=i(m[2],m[0],1,-p[1]),p.push(n(m[1],m[2])),m[2]=i(m[2],m[1],1,-p[2]),d.push(r(m[2])),m[2]=t(m[2]),p[1]/=d[2],p[2]/=d[2];var f=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}(m[1],m[2]);if(n(m[0],f)<0)for(c=0;c<3;c++)d[c]*=-1,m[c][0]*=-1,m[c][1]*=-1,m[c][2]*=-1;var g,v,y=m[0][0]+m[1][1]+m[2][2]+1;return y>1e-4?(g=.5/Math.sqrt(y),v=[(m[2][1]-m[1][2])*g,(m[0][2]-m[2][0])*g,(m[1][0]-m[0][1])*g,.25/g]):m[0][0]>m[1][1]&&m[0][0]>m[2][2]?v=[.25*(g=2*Math.sqrt(1+m[0][0]-m[1][1]-m[2][2])),(m[0][1]+m[1][0])/g,(m[0][2]+m[2][0])/g,(m[2][1]-m[1][2])/g]:m[1][1]>m[2][2]?(g=2*Math.sqrt(1+m[1][1]-m[0][0]-m[2][2]),v=[(m[0][1]+m[1][0])/g,.25*g,(m[1][2]+m[2][1])/g,(m[0][2]-m[2][0])/g]):(g=2*Math.sqrt(1+m[2][2]-m[0][0]-m[1][1]),v=[(m[0][2]+m[2][0])/g,(m[1][2]+m[2][1])/g,.25*g,(m[1][0]-m[0][1])/g]),[h,d,p,v,l]}}();e.dot=n,e.makeMatrixDecomposition=function(e){return[s(o(e))]},e.transformListToMatrix=o}(r),function(e){function t(e,t){var n=e.exec(t);if(n)return[n=e.ignoreCase?n[0].toLowerCase():n[0],t.substr(n.length)]}function n(e,t){var n=e(t=t.replace(/^\s*/,""));if(n)return[n[0],n[1].replace(/^\s*/,"")]}function r(e,t,n,r,i){for(var a=[],o=[],s=[],c=function(e,t){for(var n=e,r=t;n&&r;)n>r?n%=r:r%=n;return e*t/(n+r)}(r.length,i.length),l=0;l<c;l++){var u=t(r[l%r.length],i[l%i.length]);if(!u)return;a.push(u[0]),o.push(u[1]),s.push(u[2])}return[a,o,function(t){var r=t.map((function(e,t){return s[t](e)})).join(n);return e?e(r):r}]}e.consumeToken=t,e.consumeTrimmed=n,e.consumeRepeated=function(e,r,i){e=n.bind(null,e);for(var a=[];;){var o=e(i);if(!o)return[a,i];if(a.push(o[0]),!(o=t(r,i=o[1]))||""==o[1])return[a,i];i=o[1]}},e.consumeParenthesised=function(e,t){for(var n=0,r=0;r<t.length&&(!/\s|,/.test(t[r])||0!=n);r++)if("("==t[r])n++;else if(")"==t[r]&&(0==--n&&r++,n<=0))break;var i=e(t.substr(0,r));return null==i?void 0:[i,t.substr(r)]},e.ignore=function(e){return function(t){var n=e(t);return n&&(n[0]=void 0),n}},e.optional=function(e,t){return function(n){return e(n)||[t,n]}},e.consumeList=function(t,n){for(var r=[],i=0;i<t.length;i++){var a=e.consumeTrimmed(t[i],n);if(!a||""==a[0])return;void 0!==a[0]&&r.push(a[0]),n=a[1]}if(""==n)return r},e.mergeNestedRepeated=r.bind(null,null),e.mergeWrappedNestedRepeated=r,e.mergeList=function(e,t,n){for(var r=[],i=[],a=[],o=0,s=0;s<n.length;s++)if("function"==typeof n[s]){var c=n[s](e[o],t[o++]);r.push(c[0]),i.push(c[1]),a.push(c[2])}else!function(e){r.push(!1),i.push(!1),a.push((function(){return n[e]}))}(s);return[r,i,function(e){for(var t="",n=0;n<e.length;n++)t+=a[n](e[n]);return t}]}}(r),function(e){function t(t){var n={inset:!1,lengths:[],color:null},r=e.consumeRepeated((function(t){var r=e.consumeToken(/^inset/i,t);return r?(n.inset=!0,r):(r=e.consumeLengthOrPercent(t))?(n.lengths.push(r[0]),r):(r=e.consumeColor(t))?(n.color=r[0],r):void 0}),/^/,t);if(r&&r[0].length)return[n,r[1]]}var n=function(t,n,r,i){function a(e){return{inset:e,color:[0,0,0,0],lengths:[{px:0},{px:0},{px:0},{px:0}]}}for(var o=[],s=[],c=0;c<r.length||c<i.length;c++){var l=r[c]||a(i[c].inset),u=i[c]||a(r[c].inset);o.push(l),s.push(u)}return e.mergeNestedRepeated(t,n,o,s)}.bind(null,(function(t,n){for(;t.lengths.length<Math.max(t.lengths.length,n.lengths.length);)t.lengths.push({px:0});for(;n.lengths.length<Math.max(t.lengths.length,n.lengths.length);)n.lengths.push({px:0});if(t.inset==n.inset&&!!t.color==!!n.color){for(var r,i=[],a=[[],0],o=[[],0],s=0;s<t.lengths.length;s++){var c=e.mergeDimensions(t.lengths[s],n.lengths[s],2==s);a[0].push(c[0]),o[0].push(c[1]),i.push(c[2])}if(t.color&&n.color){var l=e.mergeColors(t.color,n.color);a[1]=l[0],o[1]=l[1],r=l[2]}return[a,o,function(e){for(var n=t.inset?"inset ":" ",a=0;a<i.length;a++)n+=i[a](e[0][a])+" ";return r&&(n+=r(e[1])),n}]}}),", ");e.addPropertiesHandler((function(n){var r=e.consumeRepeated(t,/^,/,n);if(r&&""==r[1])return r[0]}),n,["box-shadow","text-shadow"])}(r),function(e,t){function n(e){return e.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}function r(e,t,n){return Math.min(t,Math.max(e,n))}function i(e){if(/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e))return Number(e)}function a(e,t){return function(i,a){return[i,a,function(i){return n(r(e,t,i))}]}}function o(e){var t=e.trim().split(/\s*[\s,]\s*/);if(0!==t.length){for(var n=[],r=0;r<t.length;r++){var a=i(t[r]);if(void 0===a)return;n.push(a)}return n}}e.clamp=r,e.addPropertiesHandler(o,(function(e,t){if(e.length==t.length)return[e,t,function(e){return e.map(n).join(" ")}]}),["stroke-dasharray"]),e.addPropertiesHandler(i,a(0,1/0),["border-image-width","line-height"]),e.addPropertiesHandler(i,a(0,1),["opacity","shape-image-threshold"]),e.addPropertiesHandler(i,(function(e,t){if(0!=e)return a(0,1/0)(e,t)}),["flex-grow","flex-shrink"]),e.addPropertiesHandler(i,(function(e,t){return[e,t,function(e){return Math.round(r(1,1/0,e))}]}),["orphans","widows"]),e.addPropertiesHandler(i,(function(e,t){return[e,t,Math.round]}),["z-index"]),e.parseNumber=i,e.parseNumberList=o,e.mergeNumbers=function(e,t){return[e,t,n]},e.numberToString=n}(r),function(e,t){e.addPropertiesHandler(String,(function(e,t){if("visible"==e||"visible"==t)return[0,1,function(n){return n<=0?e:n>=1?t:"visible"}]}),["visibility"])}(r),function(e,t){function n(e){e=e.trim(),a.fillStyle="#000",a.fillStyle=e;var t=a.fillStyle;if(a.fillStyle="#fff",a.fillStyle=e,t==a.fillStyle){a.fillRect(0,0,1,1);var n=a.getImageData(0,0,1,1).data;a.clearRect(0,0,1,1);var r=n[3]/255;return[n[0]*r,n[1]*r,n[2]*r,r]}}function r(t,n){return[t,n,function(t){function n(e){return Math.max(0,Math.min(255,e))}if(t[3])for(var r=0;r<3;r++)t[r]=Math.round(n(t[r]/t[3]));return t[3]=e.numberToString(e.clamp(0,1,t[3])),"rgba("+t.join(",")+")"}]}var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=i.height=1;var a=i.getContext("2d");e.addPropertiesHandler(n,r,["background-color","border-bottom-color","border-left-color","border-right-color","border-top-color","color","fill","flood-color","lighting-color","outline-color","stop-color","stroke","text-decoration-color"]),e.consumeColor=e.consumeParenthesised.bind(null,n),e.mergeColors=r}(r),function(e,t){function n(e){function t(){var t=o.exec(e);a=t?t[0]:void 0}function n(){if("("!==a)return function(){var e=Number(a);return t(),e}();t();var e=i();return")"!==a?NaN:(t(),e)}function r(){for(var e=n();"*"===a||"/"===a;){var r=a;t();var i=n();"*"===r?e*=i:e/=i}return e}function i(){for(var e=r();"+"===a||"-"===a;){var n=a;t();var i=r();"+"===n?e+=i:e-=i}return e}var a,o=/([\+\-\w\.]+|[\(\)\*\/])/g;return t(),i()}function r(e,t){if("0"==(t=t.trim().toLowerCase())&&"px".search(e)>=0)return{px:0};if(/^[^(]*$|^calc/.test(t)){t=t.replace(/calc\(/g,"(");var r={};t=t.replace(e,(function(e){return r[e]=null,"U"+e}));for(var i="U("+e.source+")",a=t.replace(/[-+]?(\d*\.)?\d+([Ee][-+]?\d+)?/g,"N").replace(new RegExp("N"+i,"g"),"D").replace(/\s[+-]\s/g,"O").replace(/\s/g,""),o=[/N\*(D)/g,/(N|D)[*\/]N/g,/(N|D)O\1/g,/\((N|D)\)/g],s=0;s<o.length;)o[s].test(a)?(a=a.replace(o[s],"$1"),s=0):s++;if("D"==a){for(var c in r){var l=n(t.replace(new RegExp("U"+c,"g"),"").replace(new RegExp(i,"g"),"*0"));if(!isFinite(l))return;r[c]=l}return r}}}function i(e,t){return a(e,t,!0)}function a(t,n,r){var i,a=[];for(i in t)a.push(i);for(i in n)a.indexOf(i)<0&&a.push(i);return t=a.map((function(e){return t[e]||0})),n=a.map((function(e){return n[e]||0})),[t,n,function(t){var n=t.map((function(n,i){return 1==t.length&&r&&(n=Math.max(n,0)),e.numberToString(n)+a[i]})).join(" + ");return t.length>1?"calc("+n+")":n}]}var o="px|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc",s=r.bind(null,new RegExp(o,"g")),c=r.bind(null,new RegExp(o+"|%","g")),l=r.bind(null,/deg|rad|grad|turn/g);e.parseLength=s,e.parseLengthOrPercent=c,e.consumeLengthOrPercent=e.consumeParenthesised.bind(null,c),e.parseAngle=l,e.mergeDimensions=a;var u=e.consumeParenthesised.bind(null,s),h=e.consumeRepeated.bind(void 0,u,/^/),m=e.consumeRepeated.bind(void 0,h,/^,/);e.consumeSizePairList=m;var d=e.mergeNestedRepeated.bind(void 0,i," "),p=e.mergeNestedRepeated.bind(void 0,d,",");e.mergeNonNegativeSizePair=d,e.addPropertiesHandler((function(e){var t=m(e);if(t&&""==t[1])return t[0]}),p,["background-size"]),e.addPropertiesHandler(c,i,["border-bottom-width","border-image-width","border-left-width","border-right-width","border-top-width","flex-basis","font-size","height","line-height","max-height","max-width","outline-width","width"]),e.addPropertiesHandler(c,a,["border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","bottom","left","letter-spacing","margin-bottom","margin-left","margin-right","margin-top","min-height","min-width","outline-offset","padding-bottom","padding-left","padding-right","padding-top","perspective","right","shape-margin","stroke-dashoffset","text-indent","top","vertical-align","word-spacing"])}(r),function(e,t){function n(t){return e.consumeLengthOrPercent(t)||e.consumeToken(/^auto/,t)}function r(t){var r=e.consumeList([e.ignore(e.consumeToken.bind(null,/^rect/)),e.ignore(e.consumeToken.bind(null,/^\(/)),e.consumeRepeated.bind(null,n,/^,/),e.ignore(e.consumeToken.bind(null,/^\)/))],t);if(r&&4==r[0].length)return r[0]}var i=e.mergeWrappedNestedRepeated.bind(null,(function(e){return"rect("+e+")"}),(function(t,n){return"auto"==t||"auto"==n?[!0,!1,function(r){var i=r?t:n;if("auto"==i)return"auto";var a=e.mergeDimensions(i,i);return a[2](a[0])}]:e.mergeDimensions(t,n)}),", ");e.parseBox=r,e.mergeBoxes=i,e.addPropertiesHandler(r,i,["clip"])}(r),function(e,t){function n(e){return function(t){var n=0;return e.map((function(e){return e===l?t[n++]:e}))}}function r(e){return e}function i(t){if("none"==(t=t.toLowerCase().trim()))return[];for(var n,r=/\s*(\w+)\(([^)]*)\)/g,i=[],a=0;n=r.exec(t);){if(n.index!=a)return;a=n.index+n[0].length;var o=n[1],s=m[o];if(!s)return;var c=n[2].split(","),l=s[0];if(l.length<c.length)return;for(var d=[],p=0;p<l.length;p++){var f,g=c[p],v=l[p];if(void 0===(f=g?{A:function(t){return"0"==t.trim()?h:e.parseAngle(t)},N:e.parseNumber,T:e.parseLengthOrPercent,L:e.parseLength}[v.toUpperCase()](g):{a:h,n:d[0],t:u}[v]))return;d.push(f)}if(i.push({t:o,d:d}),r.lastIndex==t.length)return i}}function a(e){return e.toFixed(6).replace(".000000","")}function o(t,n){if(t.decompositionPair!==n){t.decompositionPair=n;var r=e.makeMatrixDecomposition(t)}if(n.decompositionPair!==t){n.decompositionPair=t;var i=e.makeMatrixDecomposition(n)}return null==r[0]||null==i[0]?[[!1],[!0],function(e){return e?n[0].d:t[0].d}]:(r[0].push(0),i[0].push(1),[r,i,function(t){var n=e.quat(r[0][3],i[0][3],t[5]);return e.composeMatrix(t[0],t[1],t[2],n,t[4]).map(a).join(",")}])}function s(e){return e.replace(/[xy]/,"")}function c(e){return e.replace(/(x|y|z|3d)?$/,"3d")}var l=null,u={px:0},h={deg:0},m={matrix:["NNNNNN",[l,l,0,0,l,l,0,0,0,0,1,0,l,l,0,1],r],matrix3d:["NNNNNNNNNNNNNNNN",r],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",n([l,l,1]),r],scalex:["N",n([l,1,1]),n([l,1])],scaley:["N",n([1,l,1]),n([1,l])],scalez:["N",n([1,1,l])],scale3d:["NNN",r],skew:["Aa",null,r],skewx:["A",null,n([l,h])],skewy:["A",null,n([h,l])],translate:["Tt",n([l,l,u]),r],translatex:["T",n([l,u,u]),n([l,u])],translatey:["T",n([u,l,u]),n([u,l])],translatez:["L",n([u,u,l])],translate3d:["TTL",r]};e.addPropertiesHandler(i,(function(t,n){var r=e.makeMatrixDecomposition&&!0,i=!1;if(!t.length||!n.length){t.length||(i=!0,t=n,n=[]);for(var a=0;a<t.length;a++){var l=t[a].t,u=t[a].d,h="scale"==l.substr(0,5)?1:0;n.push({t:l,d:u.map((function(e){if("number"==typeof e)return h;var t={};for(var n in e)t[n]=h;return t}))})}}var d=function(e,t){return"perspective"==e&&"perspective"==t||("matrix"==e||"matrix3d"==e)&&("matrix"==t||"matrix3d"==t)},p=[],f=[],g=[];if(t.length!=n.length){if(!r)return;p=[(b=o(t,n))[0]],f=[b[1]],g=[["matrix",[b[2]]]]}else for(a=0;a<t.length;a++){var v=t[a].t,y=n[a].t,C=t[a].d,S=n[a].d,_=m[v],T=m[y];if(d(v,y)){if(!r)return;var b=o([t[a]],[n[a]]);p.push(b[0]),f.push(b[1]),g.push(["matrix",[b[2]]])}else{if(v==y)l=v;else if(_[2]&&T[2]&&s(v)==s(y))l=s(v),C=_[2](C),S=T[2](S);else{if(!_[1]||!T[1]||c(v)!=c(y)){if(!r)return;p=[(b=o(t,n))[0]],f=[b[1]],g=[["matrix",[b[2]]]];break}l=c(v),C=_[1](C),S=T[1](S)}for(var R=[],w=[],E=[],M=0;M<C.length;M++)b=("number"==typeof C[M]?e.mergeNumbers:e.mergeDimensions)(C[M],S[M]),R[M]=b[0],w[M]=b[1],E.push(b[2]);p.push(R),f.push(w),g.push([l,E])}}if(i){var I=p;p=f,f=I}return[p,f,function(e){return e.map((function(e,t){var n=e.map((function(e,n){return g[t][1][n](e)})).join(",");return"matrix"==g[t][0]&&16==n.split(",").length&&(g[t][0]="matrix3d"),g[t][0]+"("+n+")"})).join(" ")}]}),["transform"]),e.transformToSvgMatrix=function(t){var n=e.transformListToMatrix(i(t));return"matrix("+a(n[0])+" "+a(n[1])+" "+a(n[4])+" "+a(n[5])+" "+a(n[12])+" "+a(n[13])+")"}}(r),function(e){function t(t){return t=100*Math.round(t/100),400===(t=e.clamp(100,900,t))?"normal":700===t?"bold":String(t)}e.addPropertiesHandler((function(e){var t=Number(e);if(!(isNaN(t)||t<100||t>900||t%100!=0))return t}),(function(e,n){return[e,n,t]}),["font-weight"])}(r),function(e){function t(e){var t={};for(var n in e)t[n]=-e[n];return t}function n(t){return e.consumeToken(/^(left|center|right|top|bottom)\b/i,t)||e.consumeLengthOrPercent(t)}function r(t,r){var i=e.consumeRepeated(n,/^/,r);if(i&&""==i[1]){var o=i[0];if(o[0]=o[0]||"center",o[1]=o[1]||"center",3==t&&(o[2]=o[2]||{px:0}),o.length==t){if(/top|bottom/.test(o[0])||/left|right/.test(o[1])){var s=o[0];o[0]=o[1],o[1]=s}if(/left|right|center|Object/.test(o[0])&&/top|bottom|center|Object/.test(o[1]))return o.map((function(e){return"object"==typeof e?e:a[e]}))}}}function i(r){var i=e.consumeRepeated(n,/^/,r);if(i){for(var o=i[0],s=[{"%":50},{"%":50}],c=0,l=!1,u=0;u<o.length;u++){var h=o[u];"string"==typeof h?(l=/bottom|right/.test(h),s[c={left:0,right:0,center:c,top:1,bottom:1}[h]]=a[h],"center"==h&&c++):(l&&((h=t(h))["%"]=(h["%"]||0)+100),s[c]=h,c++,l=!1)}return[s,i[1]]}}var a={left:{"%":0},center:{"%":50},right:{"%":100},top:{"%":0},bottom:{"%":100}},o=e.mergeNestedRepeated.bind(null,e.mergeDimensions," ");e.addPropertiesHandler(r.bind(null,3),o,["transform-origin"]),e.addPropertiesHandler(r.bind(null,2),o,["perspective-origin"]),e.consumePosition=i,e.mergeOffsetList=o;var s=e.mergeNestedRepeated.bind(null,o,", ");e.addPropertiesHandler((function(t){var n=e.consumeRepeated(i,/^,/,t);if(n&&""==n[1])return n[0]}),s,["background-position","object-position"])}(r),function(e){var t=e.consumeParenthesised.bind(null,e.parseLengthOrPercent),n=e.consumeRepeated.bind(void 0,t,/^/),r=e.mergeNestedRepeated.bind(void 0,e.mergeDimensions," "),i=e.mergeNestedRepeated.bind(void 0,r,",");e.addPropertiesHandler((function(r){var i=e.consumeToken(/^circle/,r);if(i&&i[0])return["circle"].concat(e.consumeList([e.ignore(e.consumeToken.bind(void 0,/^\(/)),t,e.ignore(e.consumeToken.bind(void 0,/^at/)),e.consumePosition,e.ignore(e.consumeToken.bind(void 0,/^\)/))],i[1]));var a=e.consumeToken(/^ellipse/,r);if(a&&a[0])return["ellipse"].concat(e.consumeList([e.ignore(e.consumeToken.bind(void 0,/^\(/)),n,e.ignore(e.consumeToken.bind(void 0,/^at/)),e.consumePosition,e.ignore(e.consumeToken.bind(void 0,/^\)/))],a[1]));var o=e.consumeToken(/^polygon/,r);return o&&o[0]?["polygon"].concat(e.consumeList([e.ignore(e.consumeToken.bind(void 0,/^\(/)),e.optional(e.consumeToken.bind(void 0,/^nonzero\s*,|^evenodd\s*,/),"nonzero,"),e.consumeSizePairList,e.ignore(e.consumeToken.bind(void 0,/^\)/))],o[1])):void 0}),(function(t,n){if(t[0]===n[0])return"circle"==t[0]?e.mergeList(t.slice(1),n.slice(1),["circle(",e.mergeDimensions," at ",e.mergeOffsetList,")"]):"ellipse"==t[0]?e.mergeList(t.slice(1),n.slice(1),["ellipse(",e.mergeNonNegativeSizePair," at ",e.mergeOffsetList,")"]):"polygon"==t[0]&&t[1]==n[1]?e.mergeList(t.slice(2),n.slice(2),["polygon(",t[1],i,")"]):void 0}),["shape-outside"])}(r),function(e,t){function n(e,t){t.concat([e]).forEach((function(t){t in document.documentElement.style&&(r[e]=t),i[t]=e}))}var r={},i={};n("transform",["webkitTransform","msTransform"]),n("transformOrigin",["webkitTransformOrigin"]),n("perspective",["webkitPerspective"]),n("perspectiveOrigin",["webkitPerspectiveOrigin"]),e.propertyName=function(e){return r[e]||e},e.unprefixedPropertyName=function(e){return i[e]||e}}(r)}(),function(){if(void 0===document.createElement("div").animate([]).oncancel){if(window.performance&&performance.now)var e=function(){return performance.now()};else e=function(){return Date.now()};var t=function(e,t,n){this.target=e,this.currentTime=t,this.timelineTime=n,this.type="cancel",this.bubbles=!1,this.cancelable=!1,this.currentTarget=e,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()},n=window.Element.prototype.animate;window.Element.prototype.animate=function(r,i){var a=n.call(this,r,i);a._cancelHandlers=[],a.oncancel=null;var o=a.cancel;a.cancel=function(){o.call(this);var n=new t(this,null,e()),r=this._cancelHandlers.concat(this.oncancel?[this.oncancel]:[]);setTimeout((function(){r.forEach((function(e){e.call(n.target,n)}))}),0)};var s=a.addEventListener;a.addEventListener=function(e,t){"function"==typeof t&&"cancel"==e?this._cancelHandlers.push(t):s.call(this,e,t)};var c=a.removeEventListener;return a.removeEventListener=function(e,t){if("cancel"==e){var n=this._cancelHandlers.indexOf(t);n>=0&&this._cancelHandlers.splice(n,1)}else c.call(this,e,t)},a}}}(),function(e){var t=document.documentElement,n=null,r=!1;try{var i="0"==getComputedStyle(t).getPropertyValue("opacity")?"1":"0";(n=t.animate({opacity:[i,i]},{duration:1})).currentTime=0,r=getComputedStyle(t).getPropertyValue("opacity")==i}catch(e){}finally{n&&n.cancel()}if(!r){var a=window.Element.prototype.animate;window.Element.prototype.animate=function(t,n){return window.Symbol&&Symbol.iterator&&Array.prototype.from&&t[Symbol.iterator]&&(t=Array.from(t)),Array.isArray(t)||null===t||(t=e.convertToArrayForm(t)),a.call(this,t,n)}}}(n)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachFREActorManager=void 0;var r=n(378),i=n(379),a=n(109),o=n(26),s=function(){function e(e,t){this.m_FREDiv=null,this.m_coachFRECountdownWelcomeActor=null,this.m_FREWelcomeActorDiv=null,this.m_FREWelcomeActorDragDropPositionTracker=null,this.m_coachFREActorConfig=e,this.m_logger=t,this.m_document=this.m_coachFREActorConfig.rootContainer.ownerDocument||document}return e.prototype.showCoachFREUI=function(e){var t=this;this.m_startCoachSessionFromFRE=e,this.m_coachFRECountdownWelcomeActor=new i.CoachFRECountdownWelcomeActor(this.m_coachFREActorConfig,this.closeFREAndStartRehearsalSession.bind(this)),this.m_FREWelcomeActorDiv=this.m_coachFRECountdownWelcomeActor.getActorContainer(),this.m_FREWelcomeActorDragDropPositionTracker=new a.CoachDragDropPositionTracker(this.m_FREWelcomeActorDiv,"",this.generateRehearsalDragDropContainer(),[]),this.m_FREWelcomeActorDragDropPositionTracker.addEventHandlers(),this.m_coachFREActorConfig.rootContainer.appendChild(this.m_FREWelcomeActorDiv),this.m_coachFREActor=new r.CoachFREActor(this.m_coachFREActorConfig,(function(){t.hideCoachFRE(),t.hasMicAccess().then((function(e){var n,r;e?null===(n=t.m_coachFRECountdownWelcomeActor)||void 0===n||n.startWelcomeActor():null===(r=t.m_coachFRECountdownWelcomeActor)||void 0===r||r.showCoachDisabledUI(o.RehearsalErrorReason.NoMicrophone)}))})),this.m_FREDiv=this.m_coachFREActor.getFREActorContainer(),this.m_coachFREActorConfig.rootContainer.appendChild(this.m_FREDiv)},e.prototype.hideCoachFREAndWelcomeUI=function(){this.hideCoachFRE(),null!==this.m_FREWelcomeActorDiv&&(this.m_coachFREActorConfig.rootContainer.removeChild(this.m_FREWelcomeActorDiv),this.m_FREWelcomeActorDiv=null)},e.prototype.hideCoachFRE=function(){null!==this.m_FREDiv&&(this.m_coachFREActorConfig.rootContainer.removeChild(this.m_FREDiv),this.m_FREDiv=null)},e.prototype.closeFREAndStartRehearsalSession=function(e){this.hideCoachFREAndWelcomeUI(),this.m_startCoachSessionFromFRE(e)},e.prototype.generateRehearsalDragDropContainer=function(){var e=this.m_document.createElement("div");return e.id="ppt-RehearsalDiv-DragDropContainer",e},e.prototype.hasMicAccess=function(){return navigator.permissions.query({name:"microphone"}).then((function(e){return"granted"===e.state}))},e}();t.CoachFREActorManager=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachFREActor=void 0;var r=n(26),i=function(){function e(e,t){var n=this;this.m_coachFREActorConfig=e,this.m_document=this.m_coachFREActorConfig.rootContainer.ownerDocument||document,this.m_onDismissClicked=t,this.m_FREActorContainerDiv=this.generateFREContainer(),this.m_FRECoachPlaceholderContainerDiv=this.generateFRECoachPlaceholderContainer(),this.hasMicAccess().then((function(e){n.m_FREActorContainerDiv.appendChild(n.generateFREScreen(e))}))}return e.prototype.getFREActorContainer=function(){return this.m_FREActorContainerDiv},e.prototype.getFRECoachPlaceholderContainer=function(){return this.m_FRECoachPlaceholderContainerDiv},e.prototype.generateFREGraphic=function(e){var t=this.m_document.createElement("img");return t.id="ppt-FREGraphic",t.src=this.m_coachFREActorConfig.imagesBaseFilePath+"FREGIF"+e+".gif",t},e.prototype.generateFREContainer=function(){var e=this.m_document.createElement("div");return e.id="pptFREDiv",e.className="ppt-coach-FRE",e.style.zIndex=this.m_coachFREActorConfig.zIndex.toString(),e},e.prototype.generateFRECoachPlaceholderContainer=function(){var e=this.m_document.createElement("div");e.id="pptFREPlaceholderDiv-container";var t=this.m_document.createElement("div");t.id="pptFREPlaceholderDiv-innerContainerElement";var n=this.m_document.createElement("div");n.innerText="0:00",n.style.color="#FFFFFF",n.style.display="inline-block",n.style.margin="auto 0px",n.style.fontSize="14px",n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'";var i=this.m_document.createElement("div");i.style.height=r.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",i.style.width=r.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",i.style.borderRadius="50%",i.style.margin="auto",i.style.marginTop="4px",i.style.position="relative",i.style.color="#979797",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center";var a=this.generatePlayButtonImage();i.appendChild(a);var o=this.generateMuteButtonImage(),s=this.m_document.createElement("div");return s.style.width="100%",s.style.height="10px",s.style.background="#595958",s.style.borderRadius="4px",s.style.display="block",s.style.position="relative",t.appendChild(n),t.appendChild(i),t.appendChild(o),e.appendChild(t),e.appendChild(s),e},e.prototype.generatePlayButtonImage=function(){var e=this.m_document.createElement("img");return e.src=this.m_coachFREActorConfig.imagesBaseFilePath+"playButton.png",e.style.display="inline-block",e.style.height="12px",e.style.width="10px",e.style.textAlign="center",e.style.marginTop="3px",e.style.marginLeft="3px",e.style.color="#FFFFFF",e},e.prototype.generateMuteButtonImage=function(){var e=this.m_document.createElement("img");return e.src=this.m_coachFREActorConfig.imagesBaseFilePath+"notificationsEnabledButton.svg",e.style.textAlign="center",e.style.marginTop="3px",e.style.marginLeft="3px",e.style.color="#FFFFFF",e.style.margin="auto 0px",e},e.prototype.generatePageDots=function(e,t){var n=this.m_document.createElement("div");if(n.className="FREPaginationDotContainer",e)(r=this.m_document.createElement("div")).id="FREPagination-1OutOf2",r.className="FREPaginationDot-inactive",(i=this.m_document.createElement("div")).id="FREPagination-2OutOf2",i.className="FREPaginationDot-inactive","1"===t?r.className="FREPaginationDot-active":"2"===t&&(i.className="FREPaginationDot-active"),n.appendChild(r),n.appendChild(i);else{var r,i;(r=this.m_document.createElement("div")).id="FREPagination-1OutOf3",r.className="FREPaginationDot-inactive",(i=this.m_document.createElement("div")).id="FREPagination-2OutOf3",i.className="FREPaginationDot-inactive";var a=this.m_document.createElement("div");a.id="FREPagination-3OutOf3",a.className="FREPaginationDot-inactive","1"===t?r.className="FREPaginationDot-active":"2"===t?i.className="FREPaginationDot-active":"3"===t&&(a.className="FREPaginationDot-active"),n.appendChild(r),n.appendChild(i),n.appendChild(a)}return n},e.prototype.generateFREScreen=function(e){var t=this.m_document.createElement("div");t.id="ppt-FREScreenDiv";var n=this.generateFREGraphic("1"),r=this.m_document.createElement("div");r.innerText=PowerpointPresenterCoachStrings.FREValueOfCoachTitle,r.className="ppt-FRE-title";var i=this.m_document.createElement("div");i.innerText=PowerpointPresenterCoachStrings.FREValueOfCoachText,i.className="ppt-FRE-text";var a=this.generateHowButton(t,e),o=this.m_document.createElement("div"),s=this.generatePageDots(e,"1"),c=this.generateDismissButton();return o.appendChild(s),o.appendChild(c),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(a),t.appendChild(o),t},e.prototype.generateFREAskMicScreen=function(e){var t=this.m_document.createElement("div");t.id="ppt-FREAskMicScreenDiv";var n=this.generateFREGraphic("2"),r=this.m_document.createElement("div");r.innerText=PowerpointPresenterCoachStrings.FREHowItWorksTitle,r.className="ppt-FRE-title";var i=this.m_document.createElement("div");i.innerText=PowerpointPresenterCoachStrings.FREHowItWorksText,i.className="ppt-FRE-text";var a=this.generateMicEnableButton(t,e),o=this.m_document.createElement("div"),s=this.generatePageDots(e,"2"),c=this.generateDismissButton();return o.appendChild(s),o.appendChild(c),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(a),t.appendChild(o),t},e.prototype.generateFREStartScreen=function(e){var t=this.m_document.createElement("div");t.id="ppt-FREStartScreenDiv";var n=this.generateFREGraphic("2"),r=this.m_document.createElement("div");r.innerText=PowerpointPresenterCoachStrings.FREHowItWorksTitle,r.className="ppt-FRE-title";var i=this.m_document.createElement("div");i.innerText=PowerpointPresenterCoachStrings.FREHowItWorksText,i.className="ppt-FRE-text";var a=this.generateStartResearsalButton(t),o=this.m_document.createElement("div"),s=this.generatePageDots(e,"2"),c=this.generateDismissButton();return t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(a),o.appendChild(s),o.appendChild(c),t.appendChild(o),t},e.prototype.generateFREMicSetupScreen=function(e){var t=this.m_document.createElement("div");t.id="ppt-FREMicSetupDiv";var n=this.generateFREGraphic("3");t.appendChild(n);var r=this.m_document.createElement("div");r.innerText=PowerpointPresenterCoachStrings.FRESetUpMicTitle,r.className="ppt-FRE-title";var i=this.m_document.createElement("div");i.innerText=PowerpointPresenterCoachStrings.FRESetUpMicText,i.className="ppt-FRE-text",t.appendChild(r),t.appendChild(i);var a=this.m_document.createElement("div"),o=this.generatePageDots(e,"3"),s=this.generateDismissButton();return a.appendChild(o),a.appendChild(s),t.appendChild(a),t},e.prototype.generateDismissButton=function(){var e=this.m_document.createElement("button");return e.id="ppt-RehearsalTrackerDiv-FRE-dismissButton",e.className="dismissButton",e.onclick=this.userClickedDismiss.bind(this),e.textContent=PowerpointPresenterCoachStrings.FREDismissButtonLabel,e},e.prototype.generateMicEnableButton=function(e,t){var n=this.m_document.createElement("button");return n.id="ppt-RehearsalTrackerDiv-FRE-micEnableButton",n.className="ppt-FREButtons",n.onclick=this.userClickedMicEnable.bind(this,e,t),n.textContent=PowerpointPresenterCoachStrings.FRETryItButtonLabel,n},e.prototype.generateStartResearsalButton=function(e){var t=this.m_document.createElement("button");return t.id="ppt-ResearsalTrackerDiv-FRE-startResearsalButton",t.className="ppt-FREButtons",t.onclick=this.userClickedStartRehearsal.bind(this,e),t.textContent=PowerpointPresenterCoachStrings.FRETryItButtonLabel,t},e.prototype.generateHowButton=function(e,t){var n=this.m_document.createElement("button");return n.id="ppt-RehearsalTrackerDiv-FRE-howButton",n.className="ppt-FREButtons",n.onclick=this.userClickedHow.bind(this,e,t),n.textContent=PowerpointPresenterCoachStrings.FREHowItWorksButtonLabel,n},e.prototype.userClickedDismiss=function(){this.m_onDismissClicked()},e.prototype.userClickedMicEnable=function(e,t){var n=this,r=e;if(r.parentNode){var i=r.parentNode;i.removeChild(r),r=this.generateFREMicSetupScreen(t),i.appendChild(r)}navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(e){n.userClickedStartRehearsal(r)}),(function(e){console.log(e),n.userClickedStartRehearsal(r)}))},e.prototype.userClickedStartRehearsal=function(e){e.parentNode&&(e.parentNode.removeChild(e),this.userClickedDismiss())},e.prototype.userClickedHow=function(e,t){if(e.parentNode){var n=e.parentNode;n.removeChild(e),n.appendChild(t?this.generateFREStartScreen(t):this.generateFREAskMicScreen(t))}},e.prototype.hasMicAccess=function(){return navigator.permissions.query({name:"microphone"}).then((function(e){return"granted"===e.state}))},e}();t.CoachFREActor=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoachFRECountdownWelcomeActor=void 0;var r=n(26),i=n(12),a=function(){function e(e,t){this.TIME_LIMIT_IN_SECONDS=5,this.m_timerInterval=null,this.m_timeLeft=this.TIME_LIMIT_IN_SECONDS,this.events=new i.EventEmitter,this.m_coachActorConfig=e,this.m_document=this.m_coachActorConfig.rootContainer.ownerDocument||document,this.m_getStartedCallback=t;var n=Date.now();this.m_containerDiv=this.m_document.createElement("div"),this.m_containerDiv.id="ppt-FRE-RehearsalDivContainer",this.m_containerDiv.style.zIndex=this.m_coachActorConfig.zIndex.toString(),this.m_topLevelDiv=this.m_document.createElement("div"),this.m_topLevelDiv.id="ppt-FRE-RehearsalDiv",this.m_coachDashboardCreationTime=Date.now()-n,this.m_timeLeft=this.TIME_LIMIT_IN_SECONDS,this.m_welcomeDiv=this.generateWelcomeScreen(),this.m_topLevelDiv.appendChild(this.m_welcomeDiv),this.m_containerDiv.appendChild(this.m_topLevelDiv),this.m_topLevelDiv.style.display="none",this.m_mockDiv=this.generateFRECoachPlaceholderContainer(),this.m_mockDiv.id="ppt-FRE-RehearsalDivMockAudioActor",this.m_containerDiv.appendChild(this.m_mockDiv),this.m_disabledDiv=this.generateFRECoachMicDisabledContainer(),this.m_disabledDiv.style.display="none",this.m_containerDiv.appendChild(this.m_disabledDiv)}return e.prototype.on=function(e,t){return this.events.on(e,t),this},e.prototype.startWelcomeActor=function(){var e=document.getElementById(this.m_topLevelDiv.id);e&&(e.style.display="block"),this.startTimer()},e.prototype.showCoachDisabledUI=function(e){document.getElementById(this.m_mockDiv.id);var t=document.getElementById(this.m_disabledDiv.id);t&&(t.style.display="block")},e.prototype.getElementsToAvoidDraggingOn=function(){return[]},e.prototype.getActorContainer=function(){return this.m_containerDiv},e.prototype.getCreationTimeInMs=function(){return this.m_coachDashboardCreationTime},e.prototype.startTimer=function(){var e=this.tick.bind(this);this.m_timerInterval=setInterval((function(){e()}),1e3)},e.prototype.tick=function(){var e=document.getElementById("base-timer-label");e&&(this.m_timeLeft=this.m_timeLeft-=1,e&&(e.textContent=String(this.m_timeLeft)),0===this.m_timeLeft&&(this.m_getStartedCallback(!0),clearInterval(this.m_timerInterval)))},e.prototype.setCountdownDiv=function(e,t){var n=this.m_document.createElement("div");n.className="FRE-base-timer";var r=this.m_document.createElement("span");r.id="base-timer-label",r.className="FRE-base-timer__label",r.textContent=""+t,n.appendChild(r),e.appendChild(n)},e.prototype.generateCountdownDiv=function(){var e=this.m_document.createElement("div");e.id="ppt-FRE-RehearsalTrackerDiv-countdownDiv";var t=this.m_document.createElement("div");return t.id="ppt-FRE-RehearsalTrackerDiv-countdownSVG",this.setCountdownDiv(t,this.m_timeLeft),e.appendChild(t),e},e.prototype.generateFirstRunWelcomeValueDiv=function(){var e=this.m_document.createElement("div");return e.id="ppt-FRE-RehearsalTrackerDiv-welcomeValue",e},e.prototype.generateWelcomeText=function(){var e=this.m_document.createElement("div");return e.id="ppt-FRE-RehearsalTrackerDiv-welcomeText",e.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",e.setAttribute("focusable","true"),e.innerText=r.RehearsalActorSettings.FRECountdownText,e.setAttribute("aria-label",r.RehearsalActorSettings.FRECountdownText),e.setAttribute("role","text"),e.setAttribute("aria-role","text"),e},e.prototype.generateRealTimeLabel=function(e,t){var n=this.m_document.createElement("div");return n.id=t,n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'",n.innerText=e,n.style.cursor="default",n},e.prototype.generateFRECountdownImage=function(){var e=this.m_document.createElement("img");return e.id="ppt-FRECountdownImage",e.src=this.m_coachActorConfig.imagesBaseFilePath+"FRECountdownImage.png",e},e.prototype.generateRehearsalTopBar=function(){var e=this.m_document.createElement("div");e.id="ppt-FRE-RehearsalDiv-welcomeTopBar";var t=this.generateRealTimeLabel(PowerpointPresenterCoachStrings.FRECountdownTitle,"ppt-FRE-RehearsalTrackerLabel-realtimeWelcome");return e.appendChild(t),e},e.prototype.generateCloseButton=function(){var e=this.m_document.createElement("div");e.id="FRE-close-button-container";var t=this.m_document.createElement("div");t.className="FRE-close-button1",e.appendChild(t);var n=this.m_document.createElement("div");return n.className="FRE-close-button2",t.appendChild(n),e.onclick=this.userClickedClose.bind(this),e},e.prototype.userClickedClose=function(e){var t,n=document.getElementById("base-timer-label");return n&&(null===(t=n.parentNode)||void 0===t||t.removeChild(n)),this.m_getStartedCallback(!1),clearInterval(this.m_timerInterval),e.stopPropagation(),!1},e.prototype.generateWelcomeScreen=function(){var e=this.m_document.createElement("div");e.id="ppt-FRE-RehearsalTrackerDiv-welcome",e.classList.add("countdownWelcome");var t=this.m_document.createElement("div");t.id="ppt-FRE-RehearsalTrackerDiv-ImageContainer";var n=this.generateCloseButton(),r=this.generateFRECountdownImage();t.appendChild(n),t.appendChild(r),e.appendChild(t);var i=this.generateRehearsalTopBar();e.appendChild(i);var a=this.generateFirstRunWelcomeValueDiv(),o=this.generateWelcomeText(),s=this.generateCountdownDiv();return a.appendChild(o),a.appendChild(s),e.appendChild(a),this.m_welcomeDiv=e,e},e.prototype.generateFRECoachMicDisabledContainer=function(){var e=this.m_document.createElement("div");e.id="ppt-FRE-RehearsalDiv-MicDisabled";var t=this.m_document.createElement("div");t.id="ppt-FRE-RehearsalDiv-MicDisabled-Value",t.innerText=r.RehearsalActorSettings.FRENoMicAccessTitle;var n=this.getNoMicImage(),i=this.m_document.createElement("div");return i.id="ppt-FRE-RehearsalDiv-MicDisabled-Text",i.innerText=r.RehearsalActorSettings.FRENoMicAccessText,e.appendChild(t),e.appendChild(n),e.appendChild(i),e},e.prototype.generateFRECoachPlaceholderContainer=function(){var e=this.m_document.createElement("div");e.id="pptFREPlaceholderDiv-container";var t=this.m_document.createElement("div");t.id="pptFREPlaceholderDiv-innerContainerElement";var n=this.m_document.createElement("div");n.innerText="0:00",n.style.color="#FFFFFF",n.style.display="inline-block",n.style.margin="auto 0px",n.style.fontSize="14px",n.style.fontFamily="Segoe UI, sans-serif, mono-serif, proportional-serif, 'mono sans serif', casual, cursive, 'small caps'";var i=this.m_document.createElement("div");i.style.height=r.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",i.style.width=r.RehearsalActorSettings.RehearsalListeningButtonHeight+"px",i.style.borderRadius="50%",i.style.margin="auto",i.style.marginTop="4px",i.style.position="relative",i.style.color="#979797",i.style.backgroundColor="#797775",i.style.borderColor="transparent",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center";var a=this.generatePlayButtonImage();i.appendChild(a);var o=this.generateMuteButtonImage(),s=this.m_document.createElement("div");return s.style.width="100%",s.style.height="10px",s.style.background="#595958",s.style.borderRadius="4px",s.style.display="block",s.style.position="relative",t.appendChild(n),t.appendChild(i),t.appendChild(o),e.appendChild(t),e.appendChild(s),e},e.prototype.generatePlayButtonImage=function(){var e=this.m_document.createElement("img");return e.src=this.m_coachActorConfig.imagesBaseFilePath+"playButton.png",e.style.display="inline-block",e.style.height="12px",e.style.width="10px",e.style.textAlign="center",e.style.marginTop="3px",e.style.marginLeft="3px",e.style.color="#FFFFFF",e},e.prototype.generateMuteButtonImage=function(){var e=this.m_document.createElement("img");return e.src=this.m_coachActorConfig.imagesBaseFilePath+"notificationsEnabledButton.svg",e.style.textAlign="center",e.style.marginTop="3px",e.style.marginLeft="3px",e.style.color="#FFFFFF",e.style.margin="auto 0px",e},e.prototype.getNoMicImage=function(){var e=this.m_document.createElement("img");return e.id="ppt-FRE-RehearsalDiv-MicDisabled-Image",e.src=this.m_coachActorConfig.imagesBaseFilePath+"FRENoMicImage.png",e},e.prototype.handleKeyDown=function(e){},e.prototype.showStatusNotification=function(e,t){},e}();t.CoachFRECountdownWelcomeActor=a}])}));
//# sourceMappingURL=CoachActorPackage.js.map