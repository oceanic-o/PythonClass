!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PodsProxy=t():e.PodsProxy=t()}(self,(()=>(()=>{"use strict";var e={254:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeGate=void 0;var r=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=r},551:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},229:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var s=r(893);s.__exportStar(r(551),t),s.__exportStar(r(254),t)},244:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},464:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MultipartParser=void 0,t.MultipartParser=class{async processMultipartResponse(e,t,r){if(null==e)throw"multipartContentBuffer is empty";try{const s=new TextDecoder("utf-8").decode(e);this.parseMultipart(s,t).forEach((e=>{const t=this.parseResponsePart(e);r(t)}))}catch(e){const t={Err:new Error(e)};r(t)}}fetchBoundary(e){const t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,r){if(!e)throw"multipartContentBufferOrStream is empty";let s,o,n="",i=0,a=[],d=null;const l=e instanceof Uint8Array;try{for(;;){if(l)o=e;else{const{done:t,value:r}=await e.read();if(t)break;o=r}for(const e of o){const o=10===e||13===e,l=10===e&&13===d,c=10===d&&13===e;if(a.push(e),o||(n+=String.fromCharCode(e)),0===i&&l)`--${t}`===n&&(i=1,n="",a=[]);else if(1===i&&c)s=new Uint8Array(a),i=2,n="",a=[];else if(2===i&&l)i=3,n="",a=[];else if(3===i){if(n.length>t.length+4&&(n=""),`--${t}`===n){const e=a.length-n.length,t=a.slice(0,e-1);i=1;r({Headers:this.processHeader(s),Body:new Uint8Array(t)}),n="",s=void 0,a=[]}l&&(n="")}d=e}if(l)break}}catch(e){r({Err:new Error(e)})}}parseMultipart(e,t){const r=`--${t}`;return e.split(r).map((e=>e.trim())).filter((e=>""!==e&&"--"!==e))}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),r=new Map;t.forEach((e=>{const t=e.split(": ");2===t.length&&r.set(t[0],t[1])}));const s=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(s);return{Headers:r,Body:o}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){const t=new Map;if(e){let r="";for(let t=0;t<e.byteLength;t+=1)r+=String.fromCharCode(e[t]);r.split("\n").forEach((e=>{const r=e.split(": ");2===r.length&&t.set(r[0],r[1])}))}return t}}},763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=r(917);s.__exportStar(r(464),t),s.__exportStar(r(244),t)},7:e=>{var t,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function n(){n.init.call(this)}e.exports=n,e.exports.once=function(e,t){return new Promise((function(r,s){function o(r){e.removeListener(t,n),s(r)}function n(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}f(e,t,n,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,o)}))},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function l(e,t,r,s){var o,n,i,l;if(a(r),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),n=e._events),i=n[t]),void 0===i)i=n[t]=r,++e._eventsCount;else if("function"==typeof i?i=n[t]=s?[r,i]:[i,r]:s?i.unshift(r):i.push(r),(o=d(e))>0&&i.length>o&&!i.warned){i.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=i.length,l=c,console&&console.warn&&console.warn(l)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var s={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=c.bind(s);return o.listener=r,s.wrapFn=o,o}function u(e,t,r){var s=e._events;if(void 0===s)return[];var o=s[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):h(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function h(e,t){for(var r=new Array(t),s=0;s<t;++s)r[s]=e[s];return r}function f(e,t,r,s){if("function"==typeof e.on)s.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(n){s.once&&e.removeEventListener(t,o),r(n)}))}}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return d(this)},n.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,n=this._events;if(void 0!==n)o=o&&void 0===n.error;else if(!o)return!1;if(o){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var d=n[e];if(void 0===d)return!1;if("function"==typeof d)s(d,this,t);else{var l=d.length,c=h(d,l);for(r=0;r<l;++r)s(c[r],this,t)}return!0},n.prototype.addListener=function(e,t){return l(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return l(this,e,t,!0)},n.prototype.once=function(e,t){return a(t),this.on(e,p(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,p(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,s,o,n,i;if(a(t),void 0===(s=this._events))return this;if(void 0===(r=s[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,n=r.length-1;n>=0;n--)if(r[n]===t||r[n].listener===t){i=r[n].listener,o=n;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(s[e]=r[0]),void 0!==s.removeListener&&this.emit("removeListener",e,i||t)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(e){var t,r,s;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,n=Object.keys(r);for(s=0;s<n.length;++s)"removeListener"!==(o=n[s])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},n.prototype.listeners=function(e){return u(this,e,!0)},n.prototype.rawListeners=function(e){return u(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},n.prototype.listenerCount=m,n.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},893:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>L,__assign:()=>n,__asyncDelegator:()=>v,__asyncGenerator:()=>w,__asyncValues:()=>T,__await:()=>E,__awaiter:()=>h,__classPrivateFieldGet:()=>M,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>W,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>D,__esDecorate:()=>l,__exportStar:()=>_,__extends:()=>o,__generator:()=>f,__importDefault:()=>x,__importStar:()=>b,__makeTemplateObject:()=>R,__metadata:()=>m,__param:()=>d,__propKey:()=>p,__read:()=>I,__rest:()=>i,__runInitializers:()=>c,__setFunctionName:()=>u,__spread:()=>S,__spreadArray:()=>P,__spreadArrays:()=>C,__values:()=>y,default:()=>N});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function i(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]])}return r}function a(e,t,r,s){var o,n=arguments.length,i=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function d(e,t){return function(r,s){t(r,s,e)}}function l(e,t,r,s,o,n){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,d=s.kind,l="getter"===d?"get":"setter"===d?"set":"value",c=!t&&e?s.static?e:e.prototype:null,p=t||(c?Object.getOwnPropertyDescriptor(c,s.name):{}),u=!1,m=r.length-1;m>=0;m--){var h={};for(var f in s)h[f]="access"===f?{}:s[f];for(var f in s.access)h.access[f]=s.access[f];h.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");n.push(i(e||null))};var g=(0,r[m])("accessor"===d?{get:p.get,set:p.set}:p[l],h);if("accessor"===d){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=i(g.get))&&(p.get=a),(a=i(g.set))&&(p.set=a),(a=i(g.init))&&o.unshift(a)}else(a=i(g))&&("field"===d?o.unshift(a):p[l]=a)}c&&Object.defineProperty(c,s.name,p),u=!0}function c(e,t,r){for(var s=arguments.length>2,o=0;o<t.length;o++)r=s?t[o].call(e,r):t[o].call(e);return s?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))}function f(e,t){var r,s,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(a){return function(d){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,a[0]&&(i=0)),i;)try{if(r=1,s&&(o=2&a[0]?s.return:a[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,a[1])).done)return o;switch(s=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,s=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],s=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,d])}}}var g=Object.create?function(e,t,r,s){void 0===s&&(s=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,o)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]};function _(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(e){o={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(I(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var s=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,a=n.length;i<a;i++,o++)s[o]=n[i];return s}function P(e,t,r){if(r||2===arguments.length)for(var s,o=0,n=t.length;o<n;o++)!s&&o in t||(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,o=r.apply(e,t||[]),n=[];return s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s;function i(e){o[e]&&(s[e]=function(t){return new Promise((function(r,s){n.push([e,t,r,s])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof E?Promise.resolve(r.value.v).then(d,l):c(n[0][2],r)}catch(e){c(n[0][3],e)}var r}function d(e){a("next",e)}function l(e){a("throw",e)}function c(e,t){e(t),n.shift(),n.length&&a(n[0][0],n[0][1])}}function v(e){var t,r;return t={},s("next"),s("throw",(function(e){throw e})),s("return"),t[Symbol.iterator]=function(){return this},t;function s(s,o){t[s]=e[s]?function(t){return(r=!r)?{value:E(e[s](t)),done:!1}:o?o(t):t}:o}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(r){t[r]=e[r]&&function(t){return new Promise((function(s,o){!function(e,t,r,s){Promise.resolve(s).then((function(t){e({value:t,done:r})}),t)}(s,o,(t=e[r](t)).done,t.value)}))}}}function R(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return O(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)}function W(e,t,r,s,o){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?o.call(e,r):o?o.value=r:t.set(e,r),r}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose]}if("function"!=typeof s)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var H="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function D(e){function t(t){e.error=e.hasError?new H(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var s=e.stack.pop();try{var o=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const N={__extends:o,__assign:n,__rest:i,__decorate:a,__param:d,__metadata:m,__awaiter:h,__generator:f,__createBinding:g,__exportStar:_,__values:y,__read:I,__spread:S,__spreadArrays:C,__spreadArray:P,__await:E,__asyncGenerator:w,__asyncDelegator:v,__asyncValues:T,__makeTemplateObject:R,__importStar:b,__importDefault:x,__classPrivateFieldGet:M,__classPrivateFieldSet:W,__classPrivateFieldIn:A,__addDisposableResource:L,__disposeResources:D}},917:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>L,__assign:()=>n,__asyncDelegator:()=>v,__asyncGenerator:()=>w,__asyncValues:()=>T,__await:()=>E,__awaiter:()=>h,__classPrivateFieldGet:()=>M,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>W,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>D,__esDecorate:()=>l,__exportStar:()=>_,__extends:()=>o,__generator:()=>f,__importDefault:()=>x,__importStar:()=>b,__makeTemplateObject:()=>R,__metadata:()=>m,__param:()=>d,__propKey:()=>p,__read:()=>I,__rest:()=>i,__runInitializers:()=>c,__setFunctionName:()=>u,__spread:()=>S,__spreadArray:()=>P,__spreadArrays:()=>C,__values:()=>y,default:()=>N});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},s(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function i(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]])}return r}function a(e,t,r,s){var o,n=arguments.length,i=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function d(e,t){return function(r,s){t(r,s,e)}}function l(e,t,r,s,o,n){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,d=s.kind,l="getter"===d?"get":"setter"===d?"set":"value",c=!t&&e?s.static?e:e.prototype:null,p=t||(c?Object.getOwnPropertyDescriptor(c,s.name):{}),u=!1,m=r.length-1;m>=0;m--){var h={};for(var f in s)h[f]="access"===f?{}:s[f];for(var f in s.access)h.access[f]=s.access[f];h.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");n.push(i(e||null))};var g=(0,r[m])("accessor"===d?{get:p.get,set:p.set}:p[l],h);if("accessor"===d){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=i(g.get))&&(p.get=a),(a=i(g.set))&&(p.set=a),(a=i(g.init))&&o.unshift(a)}else(a=i(g))&&("field"===d?o.unshift(a):p[l]=a)}c&&Object.defineProperty(c,s.name,p),u=!0}function c(e,t,r){for(var s=arguments.length>2,o=0;o<t.length;o++)r=s?t[o].call(e,r):t[o].call(e);return s?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,s){return new(r||(r=Promise))((function(o,n){function i(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}d((s=s.apply(e,t||[])).next())}))}function f(e,t){var r,s,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(a){return function(d){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,a[0]&&(i=0)),i;)try{if(r=1,s&&(o=2&a[0]?s.return:a[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,a[1])).done)return o;switch(s=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,s=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],s=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,d])}}}var g=Object.create?function(e,t,r,s){void 0===s&&(s=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,o)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]};function _(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var s,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(e){o={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(I(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var s=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,a=n.length;i<a;i++,o++)s[o]=n[i];return s}function P(e,t,r){if(r||2===arguments.length)for(var s,o=0,n=t.length;o<n;o++)!s&&o in t||(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return e.concat(s||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,o=r.apply(e,t||[]),n=[];return s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s;function i(e){o[e]&&(s[e]=function(t){return new Promise((function(r,s){n.push([e,t,r,s])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof E?Promise.resolve(r.value.v).then(d,l):c(n[0][2],r)}catch(e){c(n[0][3],e)}var r}function d(e){a("next",e)}function l(e){a("throw",e)}function c(e,t){e(t),n.shift(),n.length&&a(n[0][0],n[0][1])}}function v(e){var t,r;return t={},s("next"),s("throw",(function(e){throw e})),s("return"),t[Symbol.iterator]=function(){return this},t;function s(s,o){t[s]=e[s]?function(t){return(r=!r)?{value:E(e[s](t)),done:!1}:o?o(t):t}:o}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(r){t[r]=e[r]&&function(t){return new Promise((function(s,o){!function(e,t,r,s){Promise.resolve(s).then((function(t){e({value:t,done:r})}),t)}(s,o,(t=e[r](t)).done,t.value)}))}}}function R(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return O(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)}function W(e,t,r,s,o){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?o.call(e,r):o?o.value=r:t.set(e,r),r}function A(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose]}if("function"!=typeof s)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var H="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function D(e){function t(t){e.error=e.hasError?new H(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var s=e.stack.pop();try{var o=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const N={__extends:o,__assign:n,__rest:i,__decorate:a,__param:d,__metadata:m,__awaiter:h,__generator:f,__createBinding:g,__exportStar:_,__values:y,__read:I,__spread:S,__spreadArrays:C,__spreadArray:P,__await:E,__asyncGenerator:w,__asyncDelegator:v,__asyncValues:T,__makeTemplateObject:R,__importStar:b,__importDefault:x,__classPrivateFieldGet:M,__classPrivateFieldSet:W,__classPrivateFieldIn:A,__addDisposableResource:L,__disposeResources:D}}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{var e,t,o,n,i,a;r.r(s),r.d(s,{ClientColorSettings:()=>o,ErrorCategory:()=>a,ErrorCode:()=>i,GetRequestItemIds:()=>l,ItemType:()=>c,PodsProxy:()=>P,PodsProxyConstants:()=>d,PodsProxyRequestStageType:()=>t,PodsProxyRequestType:()=>e,SlideImageAppendOption:()=>n,exposed:()=>S,setupGlobals_PodsProxy:()=>C}),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(e||(e={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(t||(t={}));class d{}d.unknown="unknown",d.ErrorCode="ErrorCode",d.ErrorCategory="ErrorCategory",d.errorCategory="errorCategory",d.errorCode="errorCode",d.IsIntentional="IsIntentional",d.isIntentional="isIntentional",d.XCorrelationId="X-CorrelationId",d.ContentType="Content-Type",d.ContentLength="Content-Length",d.ContenEncoding="Content-Encoding",d.TransferEncoding="Transfer-Encoding",d.XusedOutputCache="X-usedOutputCache",d.Xnewsnapurl="x-newsnapurl",d.ContentDisposition="Content-Disposition",d.CallerCorrelationId="CallerCorrelationId",d.action="action",d.parser="parser",d.server="server",d.callId="callId",d.dateHeader="x-ms-date",d.clientTimeoutHeader="x-ms-client-timeout",d.clientRequestIdHeader="x-ms-client-request-id",d.newSnapUrlHeader="x-newsnapurl",d.correlationId="correlationId",d.firstResponseCheck="firstResponseCheck",d.fetchBoundary="fetchBoundary",d.downloadResponse="downloadResponse",d.parserCallback="parserCallback",d.createResponse="createResponse",d.contentLength="contentLength",d.usedOutputCache="usedOutputCache",d.itemUsedOutputCacheMap="itemUsedOutputCacheMap",d.podsProxyCallSuceeded="podsProxyCallSuceeded",d.PriorityHint="PriorityHint",d.RequestInfo="RequestInfo",d.ResponseHeaders="ResponseHeaders",d.IsBootRequest="IsBootRequest",d.XErrorCode="X-ErrorCode",function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(o||(o={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(n||(n={}));class l{}l.PresInfoMetaData="presinfo/metadata",l.PresinfoslimSlideOrder="presinfo/slimSlideOrder",l.slideInfoIndex="pres/sldIdx",l.slideInfoSid="pres/sldSid",l.slideNotesIndex="pres/NotesSldIdx",l.slideNotesSid="pres/NotesSldSid",l.slideCommentsIndex="pres/CommentsSldIdx",l.slideCommentsSid="pres/CommentsSldSid",l.slideMetadataIndex="pres/SlideMetadatasldIdx",l.slideMetadataSid="pres/SlideMetadataSldSid",l.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",l.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(i||(i={})),function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(a||(a={}));class c{}c.JsonType="application/json",c.ImagePng="image/png",c.ImageJpg="image/jpg",c.PlainTextType="text/plain";var p,u,m=r(763),h=r(229),f=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),g=new(function(){function e(){this.externalLogger=new f}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,r,s){this.externalLogger.sendTraceTag(e,t,r,s)},e.prototype.debugAssertTag=function(e,t,r,s){this.externalLogger.debugAssertTag(e,t,r,s)},e.prototype.shipAssertTag=function(e,t,r,s){this.externalLogger.shipAssertTag(e,t,r,s)},e}());!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(p||(p={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(u||(u={}));var _=r(7);class y{constructor(e,t,r,s){this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=e,this.m_responses=t,this.m_perfDictionary=r,this.m_parsedBasedResponse=s}parsePart(e){if(e&&e.Headers){this.m_perfDictionary[d.parserCallback]?(this.m_perfDictionary[d.parserCallback].callCounter=this.m_perfDictionary[d.parserCallback].callCounter+1,this.m_perfDictionary[d.parserCallback].lastCallStart=P.performanceNowTrimmed()):this.m_perfDictionary[d.parserCallback]={lastCallStart:P.performanceNowTrimmed(),lastCallEnd:P.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};const t=e.Headers.get(d.ContentDisposition),r=e.Headers.get(d.ContentType);this.m_parsedBasedResponse.usedOutputCache=e.Headers.get(d.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=e.Headers.get(d.Xnewsnapurl);const s=e.Headers.get(d.ErrorCode)||i.ErrorRESERVEDSuccess,o=e.Headers.get(d.ErrorCategory)||a.ErrorRESERVEDSuccess,n=e.Headers.get(d.XusedOutputCache);if(t){let a;const l=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{a=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){g.sendTraceTag(595641600,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - partResponse Error:${e}`)}if(a){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(a,s),this.m_parsedBasedResponse.itemErrorCategoryMap.set(a,o),n&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(a,n),s&&s.trim().toLowerCase()===i.ErrorRESERVEDSuccess.toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));for(const e of t)this.parsedResponse.slideOrder.push({sid:e,cid:0})}else if(t.indexOf("presinfo%2fmetadata")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body)),r=[],s=[];for(const e of t.SidSlideOrder)r.push({sid:e,cid:0});if(t.SidHiddenSlides)for(const e of t.SidHiddenSlides)s.push({sid:e,cid:0});let o={Item:null};t.SlideShowProperties.Item||(o={Item:null}),t.SlideShowProperties.Item.s?o={Item:{sid:t.SlideShowProperties.Item.s}}:t.SlideShowProperties.Item.st&&(o={Item:{start:t.SlideShowProperties.Item.st,end:t.SlideShowProperties.Item.end}});const n={SlideOrder:r,HiddenSlideOrder:s,SlideEmuWidth:t.SlideEmuWidth,SlideEmuHeight:t.SlideEmuHeight,ViewScalingFactor:t.ViewScalingFactor,SlideShowProperties:o,Sections:t.Sections};this.parsedResponse.slideAllInfo.push(n)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&r&&y.getSupportedImageType(r)){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx");let o="";for(let t=0;t<e.Body.length;t+=1)o+=String.fromCharCode(e.Body[t]);const n=`data:${y.getSupportedImageType(r)};base64, ${btoa(o)}`;this.m_perfDictionary[d.parserCallback].slidesHaveImages.push(s),this.m_responses[s]||(this.m_responses[s]={ID:{sid:s,cid:0}}),this.m_responses[s].SlideImageData=n}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&r&&-1!==r.indexOf("application/json")){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),s=JSON.parse(new TextDecoder("utf-8").decode(e.Body));h.ChangeGate.isChangeGateEnabled("PodsProxy.getItemsMediaResourceMapping")&&s.mediaUrls?(this.m_responses[r]||(this.m_responses[r]={ID:{sid:s.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[r].SlideShowInfo=s.slideShowInfo,this.m_responses[r].MediaUrls=s.mediaUrls):(this.m_responses[r]||(this.m_responses[r]={ID:{sid:s.sld[0].id,cid:0}}),this.m_responses[r].SlideShowInfo=s)}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),s=new TextDecoder("utf-8").decode(e.Body);this.m_responses[r]||(this.m_responses[r]={ID:{sid:r,cid:0}}),this.m_responses[r].NoteHtml=s}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),s=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[r]||(this.m_responses[r]={ID:{sid:r,cid:0}}),this.m_responses[r].Comments=s}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||l){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),s=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[r]||(this.m_responses[r]={ID:s.ID}),this.m_responses[r].Title=s.Title,this.m_responses[r].HasAnimation=s.HasAnimation,this.m_responses[r].Hidden=s.Hidden,this.m_responses[r].HasTransition=s.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),s=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[r]||(this.m_responses[r]={ID:s.ID}),this.m_responses[r].AccessibilityModel=s.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&r&&y.getSupportedImageType(r)){const s=y.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),o=y.extractStringInBetweenStrings(t,"filename=","\r");if(s&&o){const t={sid:+s,cid:0},n=y.getSupportedImageType(r);let i,a;if(e.Body)if(this.m_settings.allowImagesAsBinary)i={Id:o,Base64:"",Binary:e.Body,MimeType:n,ByteCount:e.Body.length};else{let t="";for(let r=0;r<e.Body.length;r+=1)t+=String.fromCharCode(e.Body[r]);const r=`data:${n};base64,${btoa(t)}`;i={Id:o,Base64:r,MimeType:n,ByteCount:r.length}}else g.sendTraceTag(529331297,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - Body is undefined. slideId:${s}, resourceId:${o}`),i={Id:o,Base64:"",MimeType:n,ByteCount:0};this.m_perfDictionary[d.parserCallback].slidesHaveImageResources.push(t.sid);for(const[,e]of Object.entries(this.m_responses))e.ID&&e.ID.sid===t.sid&&(a=e);a?a.ResourceData?a.ResourceData.push(i):a.ResourceData=[i]:this.m_responses[t.sid]={ID:t,ResourceData:[i]}}else g.sendTraceTag(595628568,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:${s}, resourceId:${o}`),this.m_parsedBasedResponse.responseErrorCode=i.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=i.ErrorItemNameNotValid}else e.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(e.Headers.get("x-ms-content-id"),s),this.m_parsedBasedResponse.itemErrorCategoryMap.set(e.Headers.get("x-ms-content-id"),o)),this.m_parsedBasedResponse.responseErrorCode=i.ErrorContentDispositionHeaderNotValid;this.m_perfDictionary[d.parserCallback].lastCallEnd=P.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=i.ErrorResponseNotValid;e.Err&&(this.m_parsedBasedResponse.responseErrorCode=i.ErrorResponseNotValid,g.sendTraceTag(595687003,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::parseMultipartResponse - partResponse Error:${e.Err}`))}static getSupportedImageType(e){return P.s_supportedImageType.find((t=>-1!==e.indexOf(t)))||""}static getSlideKeyFromHeader(e,t){const r=new RegExp(`.*${t}(.*)`);if(!e)return g.sendTraceTag(529331298,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;const s=r.exec(e);return null!=s&&s.length>=2?+s[1]:(g.sendTraceTag(529331299,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::getSlideLocationFromHeader - regex result is null header:${e}, itemId: ${t}`),-1)}static extractStringInBetweenStrings(e,t,r){const s=e.indexOf(t)+t.length,o=r?e.indexOf(r,s):-1;return-1===o?e.substring(s):e.substring(s,o)}}class I{static m_settings={};static load(e){for(const t in e)I.m_settings[t]=e[t]}static readBooleanOrDefault(e,t){const r=void 0===I.m_settings?"":typeof I.m_settings[e];return"string"===r?"true"===I.m_settings[e].toLowerCase():"boolean"===r?I.m_settings[e]:t}static readNumberOrDefault(e,t){const r=void 0===I.m_settings?"":typeof I.m_settings[e];return"string"===r||"number"===r?Number(I.m_settings[e]):t}static readStringOrDefault(e,t){return void 0===I.m_settings||"string"!=typeof I.m_settings[e]?t:I.m_settings[e]}static addOrUpdateSettingsFromUrl(e,t){const r=t.get("wdset");if(!r)return e;for(const t of r.split(",")){const r=t.split(":"),s=r[0].split("."),o=s[0],n=s[1],i=r[1];n&&i&&I.addOrUpdateSetting(e,o,n,i)}return e}static addOrUpdateSetting(e,t,r,s){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][r]=s)}}const S={};function C(e){e.logger&&g.setLogger(e.logger),e.settings&&I.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=S)}class P{constructor(e,t,r,s,o,n,i){if(this.events=new _.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new m.MultipartParser,g.setLogger(s),g.sendTraceTag(595686994,p.msoulscat_Wac_PptSession,e&&t&&t.DownloadUrl&&r&&t.DocID?u.Info:u.Warning,`PodsProxy::constructor - podsUrl:${e}, fileExtension:${r}, docId:${t.DocID}}`),g.sendTraceTag(508638473,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::constructor - presentUrl:${o}}`),this.m_podsUrl=e,this.m_presentUrl=o,this.m_settings=i||{timeout:3e4,throwHttpErrors:!0},h.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),n&&n.forEach(((e,t)=>{this.m_requestHeaders.append(t,e)})),this.m_getPresInfoRequest={Source:t,FileExtension:r||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:r||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),i&&i.perfTimingMonitorEnabled)try{const e=new Set;this.m_presentUrl&&h.ChangeGate.isChangeGateEnabled("PodsProxy.logPFDPerfTiming")&&(e.add(`${this.m_presentUrl}/items`),e.add(`${this.m_presentUrl}/ping`)),e.add("getitems.ashx"),e.add("getmedia.ashx"),e.add("remoteuls.ashx"),e.add("podhandler.ashx"),e.add("remotetelemetry.ashx"),new PerformanceObserver((t=>P.logPerformanceEntries(t,e))).observe({entryTypes:["resource"]})}catch(e){g.sendTraceTag(572379985,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:PerformanceObserver failed with exception ${e}`)}}async getSlideOrderAsync(){const e=await this.getPresInfoAsync("getSlideOrderAsync"),t=await e.json();return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:t.SlideOrder}}async getSlideInfosAsync(e){e.RenderOptions&&(this.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map((e=>e.slideId)),RenderOptions:e.RenderOptions}]),this.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_getPresInfoRequest.ClientWidth,this.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_getPresInfoRequest.ClientHeight,this.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:this.m_getPresInfoRequest.DevicePixelRatio,this.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_getPresInfoRequest.IsHighContrast,this.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_getPresInfoRequest.ClientColorSettings,this.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_getPresInfoRequest.MinClientWidth,this.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_getPresInfoRequest.MinClientHeight,this.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_getPresInfoRequest.MaxClientWidth,this.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_getPresInfoRequest.MaxClientHeight;const t=await this.getPresInfoAsync("getSlideInfosAsync"),r=await t.json();return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:r.Slides}}async getItemsSlideOrderAsync(){this.m_itemsList=new Array,this.m_itemsList.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[c.JsonType]}),this.m_getItemsRequest.Items=this.m_itemsList;const e=await this.getItemsAsync("getItemsSlideOrderAsync");return await this.createSlideIdResponse(this.parseMultipartResponseAsync(e,{}))}async getItemsPresInfoAsync(e){this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||"");const t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(t));const r=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(d.clientRequestIdHeader,r),this.m_requestHeaders.set(d.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const s={action:"getItemsPresInfoAsync",correlationId:e.CorrelationId,server:{start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()}};P.logPerf(s);const o=await this.getItemsAsync("getItemsPresInfoAsync");s[d.server].end=P.performanceNowTrimmed(),o&&o.response&&o.response.headers&&(s[d.contentLength]=o.response.headers.get(d.ContentLength)),P.logPerf(s),s[d.parser]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()};const n=this.setTimeoutForParsingResponse(s),i=await this.createPresInfoResponse(this.parseMultipartResponseAsync(o,s));return clearTimeout(n),s[d.parser].end=P.performanceNowTrimmed(),s[d.usedOutputCache]=!!i.usedOutputCache&&"true"===i.usedOutputCache.trim().toLowerCase(),s[d.itemUsedOutputCacheMap]=!!i.itemUsedOutputCacheMap&&Array.from(i.itemUsedOutputCacheMap.entries()),P.logPerf(s),i.metadata=this.generateReportPerfDictionary(s),i}async getItemsPresInfoAndSlideInfosAsync(r,s,o){const n={action:"getItemsPresInfoAndSlideInfoAsync"};let m=null;try{this.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_imageOptions.InputProperties.ClientWidth=s.ClientWidth?s.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=s.ClientHeight?s.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=s.IsHighContrast?s.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ClientColorSettings=s.ClientColorSettings?s.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=s.MinClientWidth?s.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=s.MinClientHeight?s.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=s.MaxClientWidth?s.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=s.MaxClientHeight?s.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=s.TranslateLanguage?s.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage;for(let e=0;e<s.SlideLocations.length;e+=1)s.GetSlideImage?this.m_itemsList.push({Id:s.SlideLocations[e].slideId?l.slideInfoSid+s.SlideLocations[e].slideId.sid.toString():l.slideInfoIndex+s.SlideLocations[e].slideIndex.toString(),AcceptTypes:P.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):s.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:s.ClientWidth?s.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:s.ClientHeight?s.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:s.IsHighContrast?s.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:s.ColorMode?s.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:s.ClientColorSettings?s.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=s.TranslateLanguage?s.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:s.LocaleName?s.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=P.ensureISlideInfoFilters(s.Filters),this.m_itemsList.push({Id:s.SlideLocations[e].slideId?l.slideInfoSid+s.SlideLocations[e].slideId.sid.toString():l.slideInfoIndex+s.SlideLocations[e].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=s.TranslateLanguage?s.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:s.LocaleName?s.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==s.GetSlideAccessibilityModelData&&s.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:s.SlideLocations[e].slideId?l.slideAccessibilityModelSid+s.SlideLocations[e].slideId.sid.toString():l.slideAccessibilityModelIndex+s.SlideLocations[e].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),s.GetSlideNotes&&this.m_itemsList.push({Id:s.SlideLocations[e].slideId?l.slideNotesSid+s.SlideLocations[e].slideId.sid.toString():l.slideCommentsIndex+s.SlideLocations[e].slideIndex.toString(),AcceptTypes:[c.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),s.GetSlideComments&&this.m_itemsList.push({Id:s.SlideLocations[e].slideId?l.slideCommentsSid+s.SlideLocations[e].slideId.sid.toString():l.slideCommentsIndex+s.SlideLocations[e].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:s.CommentOptions});this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,r.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,r.CorrelationId||"");const p={...r.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:r.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(p));const u=this.objectDictionaryToRequestIdString(p);this.m_requestHeaders.set(d.clientRequestIdHeader,u),this.m_requestHeaders.set(d.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),n.correlationId=r.CorrelationId,n[d.server]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},P.logPerf(n),this.events.emit("requestStageChanged",{requestType:e.getItemsPresInfoAndSlideInfoAsync,stageInfo:t.GetItemsCall});const h=await this.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:o&&o.overrideGetItemsTimeoutMs});if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&h.errorCode===i.ServerErrorFileDownloadResourceInconsistent)return{presInfo:void 0,slideInfo:[],responseErrorCode:i.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:h.errorCategory,responseIsIntentional:h.isIntentional,itemErrorCodeMap:void 0};if(n[d.server].end=P.performanceNowTrimmed(),h&&h.response&&h.response.headers){n[d.contentLength]=h.response.headers.get(d.ContentLength),n[d.ContenEncoding]=h.response.headers.get(d.ContenEncoding),n[d.TransferEncoding]=h.response.headers.get(d.TransferEncoding);const e=h.response.headers.keys();if(e){const t=[];for(const r of e)t.push(r);n[d.ResponseHeaders]=t}}P.logPerf(n),n[d.parser]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},m=this.setTimeoutForParsingResponse(n);const f=await this.parseMultipartResponseAsync(h,n,{shouldTimeoutResponseStreamDownload:o&&o.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:o&&o.overrideDownloadTimeoutMs,requestType:e.getItemsPresInfoAndSlideInfoAsync});if(f&&f.responseErrorCode===i.ErrorDownloadResponseStreamTimeout)return{presInfo:void 0,slideInfo:[],responseErrorCode:i.ErrorDownloadResponseStreamTimeout,responseErrorCategory:a.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0};const g=this.createPresInfoAndSlideInfoResponse(f,n);return null!==m&&(clearTimeout(m),m=null),n[d.parser].end=P.performanceNowTrimmed(),n[d.usedOutputCache]=!!g.usedOutputCache&&"true"===g.usedOutputCache.trim().toLowerCase(),n[d.itemUsedOutputCacheMap]=!!g.itemUsedOutputCacheMap&&Array.from(g.itemUsedOutputCacheMap.entries()),n[d.podsProxyCallSuceeded]=!0,P.logPerf(n),g.metadata=this.generateReportPerfDictionary(n),g}catch(e){return g.sendTraceTag(571548234,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: ${e}`),n[d.podsProxyCallSuceeded]=!1,P.logPerf(n),null!==m&&(clearTimeout(m),m=null),{presInfo:void 0,slideInfo:[],responseErrorCode:i.ErrorRESERVEDItemFailed,responseErrorCategory:a.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}}}async getItemsSlideInfosAsync(e){const t={action:"getItemsSlideInfosAsync"};try{this.m_imageOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=null!=e.IsHighContrast?e.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ColorMode=null!=e.ColorMode?e.ColorMode:this.m_imageInputProperties.ColorMode,this.m_imageOptions.InputProperties.ClientColorSettings=null!=e.ClientColorSettings?e.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=e.TranslateLanguage?e.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,this.m_itemsList=new Array;for(let t=0;t<e.SlideLocations.length;t+=1)e.GetSlideImage?this.m_itemsList.push({Id:e.SlideLocations[t].slideId?l.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():l.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:P.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):e.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=P.ensureISlideInfoFilters(e.Filters),e.SkipGetSlideInfo||this.m_itemsList.push({Id:e.SlideLocations[t].slideId?l.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():l.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==e.GetSlideAccessibilityModelData&&e.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?l.slideAccessibilityModelSid+e.SlideLocations[t].slideId.sid.toString():l.slideAccessibilityModelIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),e.GetSlideNotes&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?l.slideNotesSid+e.SlideLocations[t].slideId.sid.toString():l.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[c.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),e.GetSlideComments&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?l.slideCommentsSid+e.SlideLocations[t].slideId.sid.toString():l.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[c.JsonType],Options:e.CommentOptions});if(0===this.m_itemsList.length)return g.sendTraceTag(595076497,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRequestFailed,responseErrorCategory:a.BadRequest,responseIsIntentional:!1,slideInfo:[]};this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||"");const t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(d.RequestInfo,JSON.stringify(t));const r=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(d.clientRequestIdHeader,r),this.m_requestHeaders.set(d.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const s={action:"getItemsSlideInfosAsync",correlationId:e.CorrelationId,server:{start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()}};s.correlationId=e.CorrelationId,s[d.server]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},P.logPerf(s);const o=await this.getItemsAsync("getItemsSlideInfosAsync");if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&o.errorCode===i.ServerErrorFileDownloadResourceInconsistent)return{slideInfo:[],responseErrorCode:i.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:o.errorCategory,responseIsIntentional:!!o.headers.get(d.IsIntentional)&&o.headers.get(d.IsIntentional),itemErrorCodeMap:void 0};s[d.server].end=P.performanceNowTrimmed(),o&&o.response&&o.response.headers&&(s[d.contentLength]=o.response.headers.get(d.ContentLength)),s[d.parser]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},P.logPerf(s);const n=this.setTimeoutForParsingResponse(s),m=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(o,s),s);return clearTimeout(n),s[d.parser].end=P.performanceNowTrimmed(),s[d.usedOutputCache]=!!m.usedOutputCache&&"true"===m.usedOutputCache.trim().toLowerCase(),s[d.itemUsedOutputCacheMap]=!!m.itemUsedOutputCacheMap&&Array.from(m.itemUsedOutputCacheMap.entries()),s[d.podsProxyCallSuceeded]=!0,P.logPerf(s),m.metadata=this.generateReportPerfDictionary(s),m}catch(e){return g.sendTraceTag(570950493,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:getItemsSlideInfosAsync - exception happened: ${e}`),t[d.podsProxyCallSuceeded]=!1,P.logPerf(t),{slideInfo:[],responseErrorCode:i.ErrorRESERVEDItemFailed,responseErrorCategory:a.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}}}async getItemsResourceAsync(e){this.m_slideResourceOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideResourceInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideResourceInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideResourceInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideResourceInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideResourceInputProperties.LocaleName},this.m_slideResourceOptions.Filters.EnableClustering=void 0!==e.EnableClustering&&e.EnableClustering,this.m_itemsList=new Array;for(const t of e.ResourceParams){this.m_slideResourceOptions.InputProperties.ResourceId=t.Id;let e="";switch(String(t.Name.match("[^.]+$"))){case"jpg":e=c.ImageJpg;break;case"png":e=c.ImagePng}this.m_itemsList.push({Id:t.Name,AcceptTypes:e?[e]:P.s_supportedImageType,Options:JSON.stringify(this.m_slideResourceOptions)})}this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(d.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.XCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(d.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const t={action:"getItemsResourceAsync",correlationId:e.CorrelationId,server:{start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()}};P.logPerf(t);const r=await this.getItemsAsync("getItemsResourceAsync");t[d.server].end=P.performanceNowTrimmed(),r&&r.response&&r.response.headers&&(t[d.contentLength]=r.response.headers.get(d.ContentLength)),t[d.parser]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},P.logPerf(t);const s=this.setTimeoutForParsingResponse(t),o=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(r,t),t);return clearTimeout(s),t[d.parser].end=P.performanceNowTrimmed(),t[d.usedOutputCache]=!!o.usedOutputCache&&"true"===o.usedOutputCache.trim().toLowerCase(),t[d.itemUsedOutputCacheMap]=!!o.itemUsedOutputCacheMap&&Array.from(o.itemUsedOutputCacheMap.entries()),P.logPerf(t),o.metadata=this.generateReportPerfDictionary(t),o}async getItemsSlideOrderAndSlidesInfoIndexAsync(e,t,r){this.m_getItemsRequest.Items.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[c.JsonType],Options:JSON.stringify(r)});const s=JSON.stringify(t);e&&e.forEach((e=>{this.m_getItemsRequest.Items.push({Id:`${l.slideInfoIndex}${e}`,AcceptTypes:[c.ImagePng,c.ImageJpg],Options:s})}));const o={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()}};P.logPerf(o);const n=await this.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync");o[d.server].end=P.performanceNowTrimmed(),o[d.parser]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},n&&n.response&&n.response.headers&&(o[d.contentLength]=n.response.headers.get(d.ContentLength)),P.logPerf(o);const i=this.setTimeoutForParsingResponse(o),a=await this.createSlideOrderAndSlidesInfoIndexResponse(this.parseMultipartResponseAsync(n,o));return clearTimeout(i),o[d.parser].end=P.performanceNowTrimmed(),o[d.usedOutputCache]=!!a.usedOutputCache&&"true"===a.usedOutputCache.trim().toLowerCase(),o[d.itemUsedOutputCacheMap]=!!a.itemUsedOutputCacheMap&&Array.from(a.itemUsedOutputCacheMap.entries()),P.logPerf(o),a.metadata=this.generateReportPerfDictionary(o),a}async getPresInfoAsync(e){g.sendTraceTag(593896001,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::getPresInfoAsync - Function:${e}, requestCorrelation:${this.m_requestHeaders.get(d.CallerCorrelationId)}`);const t=new AbortController,r=setTimeout((()=>t.abort()),3e4),s=await fetch(`${this.m_podsUrl}/presinfo.ashx`,{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getPresInfoRequest),signal:t.signal}).catch((async t=>{throw g.sendTraceTag(595686995,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:getPresInfo - Function: ${e}, Error: ${t}`),t}));return clearTimeout(r),g.sendTraceTag(595686996,p.msoulscat_Wac_PptSession,s.ok?u.Info:u.Error,`PodsProxy::getPresInfo - Function: ${e}, Status:${s.status}, StatusText: ${s.statusText}, CorrelationId: ${s.headers.get(d.XCorrelationId)}`),s}static getFieldFromReponseHeader(e,t){return e.headers?e.headers.get(t):d.unknown}async logGetItemFailureServerHeaders(e,t,r,s){const o={functionName:e,requestCorrelation:t,usePresentFrontDoor:r};o.headerCorrelationId=s&&s.headers?s.headers.get(d.XCorrelationId):d.unknown,o.headerErrorCode=s&&s.headers?s.headers.get(d.ErrorCode):d.unknown,o.xHeaderErrorCode=s&&s.headers?s.headers.get(d.XErrorCode):d.unknown,o.headerErrorCategory=s&&s.headers?s.headers.get(d.ErrorCategory):d.unknown,o.headerErrorIntentional=!(!s||!s.headers)&&s.headers.get(d.IsIntentional),o.status=s&&s.status?s.status:d.unknown,g.sendTraceTag(506860099,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:logGetItemFailureServerHeaders - ${JSON.stringify(o)}`)}async getItemsAsync(e,t){const r=this.m_requestHeaders.get(d.CallerCorrelationId);g.sendTraceTag(593896002,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::getItemsAsync - Function:${e}, requestCorrelation:${r}`);const s={errorCode:i.ErrorRESERVEDSuccess};let o=s,n="getItemsPresInfoAndSlideInfoAsync"===e&&this.m_settings.shouldUseBootRequestTimeout&&this.m_settings.bootRequestTimeout?this.m_settings.bootRequestTimeout:this.m_settings.timeout;t&&t.overrideGetItemsTimeoutMs&&(n=t.overrideGetItemsTimeoutMs),this.m_requestHeaders.set(d.dateHeader,(new Date).toISOString()),this.m_requestHeaders.set(d.clientTimeoutHeader,n.toString()),this.m_requestHeaders.set(d.callId,this.m_settings.callId||"empty");let l=!1,c=`${this.m_podsUrl}/getitems.ashx`;(this.m_settings.pptoPresentFrontDoorEnabled||I.readBooleanOrDefault("enableUsePresentFrontdoor",!1))&&(this.m_presentUrl?(c=`${this.m_presentUrl}/items`,l=!0):g.sendTraceTag(508638343,p.msoulscat_Wac_PptSession,u.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }"));const m=this.m_getItemsRequest.Items.map((e=>e.Id));P.s_events.emit("networkCall",{url:c,itemIds:m});const h=new AbortController,f=setTimeout((()=>h.abort()),n);o=await fetch(c,{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getItemsRequest),signal:h.signal}).catch((async t=>{const o=t.response&&t.response.headers?t.response.headers.get(d.XCorrelationId):d.unknown,n=t.response&&t.response.headers?t.response.headers.get(d.ErrorCode):d.unknown,c=t.response&&t.response.headers?t.response.headers.get(d.XErrorCode):d.unknown,m=t.response&&t.response.headers?t.response.headers.get(d.ErrorCategory):d.unknown,h=!(!t.response||!t.response.headers)&&t.response.headers.get(d.IsIntentional),f=t.response&&t.response.status?t.response.status:d.unknown;let _=t.toString();_.length>0&&("."===_.slice(-1)||"。"===_.slice(-1))&&(_=_.slice(0,-1));const y=this.getMappedError(_);return y?s.errorCode=y:"HTTPError"===t.name&&f!==d.unknown&&500!==f&&this.m_errorMap.has(f)?s.errorCode=this.m_errorMap.get(f):"TimeoutError"===t.name?s.errorCode=i.ErrorRequestTimeout:s.errorCode=P.convertServerError(n,this.m_settings.enableServerSpecificErrorCode),this.m_settings.shouldUpdateNewFileUrlFromSnap&&s.errorCode===i.ServerErrorFileDownloadResourceInconsistent&&(s.newSnapUrl=P.getFieldFromReponseHeader(t.response,d.newSnapUrlHeader)),s.errorCategory=m&&""!==m.trim()&&m!==d.unknown?m:a.Transient,s.isIntentional=h!==d.unknown&&h,g.sendTraceTag(595687001,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:getItems - Function:${e}, Error:${t}, ErrorName:${t.name}, Status:${t.status}, HeaderCorrelationId:${o}, HeaderErrorCode:${n}, HeaderErrorCategory:${m}, result.isIntentional:${s.isIntentional}, result.errorCode:${s.errorCode}, requestCorrelation:${r}, status:${f}, xErrorCode:${c}, usePresentFrontDoor:${l}`),s})),g.sendTraceTag(506860124,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: ${I.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)}`),I.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)&&o&&!1===o.ok&&await this.logGetItemFailureServerHeaders(e,r,l,o),clearTimeout(f),s.response=o;try{if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&(s.errorCode===i.ServerErrorFileDownloadResourceInconsistent||s.newSnapUrl)){if(g.sendTraceTag(541403227,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),s.newSnapUrl)return s.errorCode===i.ErrorRESERVEDSuccess&&g.sendTraceTag(509875216,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:got new snap url without errorcode"),g.sendTraceTag(541403228,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",s.newSnapUrl),s;g.sendTraceTag(541345432,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){g.sendTraceTag(541403229,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}200!==o.status&&s.errorCode===i.ErrorRESERVEDSuccess&&(o.headers&&o.headers.get(d.ErrorCode)?(s[d.errorCode]=P.convertServerError(o.headers.get(d.ErrorCode),this.m_settings.enableServerSpecificErrorCode),s[d.errorCategory]=o.headers.get(d.ErrorCategory)?o.headers.get(d.ErrorCategory):a.BadRequest,s[d.IsIntentional]=!!o.headers.get(d.IsIntentional)&&o.headers.get(d.IsIntentional)):(o.status!==d.unknown&&this.m_errorMap.has(o.status)?s[d.errorCode]=this.m_errorMap.get(o.status):s[d.errorCode]=i.ErrorRequestFailed,s[d.errorCategory]=a.Transient,s[d.IsIntentional]=!1));const _={functionName:e,status:o.status,statusText:o.statusText,headerCorrelation:o.headers?o.headers.get(d.XCorrelationId):"",headerErrorCode:o.headers?o.headers.get(d.ErrorCode):"",headerErrorCategory:o.headers?o.headers.get(d.ErrorCategory):"",headerErrorIntentional:!!o.headers&&o.headers.get(d.IsIntentional),requestCorrelation:r,resultErrorCode:s.errorCode,resultErrorCategory:s.errorCategory,resultIsIntentional:s.IsIntentional};return g.sendTraceTag(595687002,p.msoulscat_Wac_PptSession,o.ok?u.Info:u.Error,JSON.stringify(_)),s}async getSessionUtcAsync(){let e=-1;const t=new AbortController,r=setTimeout((()=>t.abort()),2500),s=await fetch(`${this.m_podsUrl}/podhandler.ashx?action=GetSessionUTC&format=jsms`,{headers:new Headers,method:"GET",signal:t.signal}).catch((async e=>{g.sendTraceTag(587831243,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:getSessionUtcAsync - Error: ${e}`)}));clearTimeout(r);try{s?(e=parseInt(await s.text(),10),g.sendTraceTag(587831244,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::getSessionUtcAsync: ${e}`)):g.sendTraceTag(572613792,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getSessionUtcAsync - Null response.")}catch(e){g.sendTraceTag(587831245,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::getSessionUtcAsync - error parsing response. ${e}`)}return e}updateDocSource(e){g.sendTraceTag(573855198,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:g.sendTraceTag(573855199,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:g.sendTraceTag(573855200,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}async generateSnapDownloadUrlAsync(e,t){try{g.sendTraceTag(573875969,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ${e.ID}.`);const r=new Headers;r.append(d.ContentType,"application/json; charset=utf-8"),r.append(d.CallerCorrelationId,e.ID),t&&t.forEach(((e,t)=>{r.append(t,e)}));const s=`${this.m_podsUrl}/SnapUrlHandler.ashx`,o=new AbortController,n=setTimeout((()=>o.abort()),this.m_settings.timeout),i=await fetch(s,{headers:r,method:"POST",body:JSON.stringify(e),signal:o.signal}).catch((async e=>{g.sendTraceTag(573875971,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : ${e}`)}));clearTimeout(n);let a="";if(i){const e=await i.json();g.sendTraceTag(573875972,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:${e.FSuccess}, ErrorCode:${e.ErrorCode}`),e.FSuccess?a=e.SnapUrl:g.sendTraceTag(573875973,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : ${e.ErrorCode}`)}return a}catch(e){return g.sendTraceTag(573875974,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy:generateSnapDownloadUrlAsync - exception: ${e}`),""}}setErrorMap(){const e=["cancelled","cancelado","キャンセルしました","Abgebrochen","취소됨","已取消","annulé","مُلغى","avbruten","отменено","annullato","zrušeno","poništeno","geannuleerd","ถูกยกเลิก","avbrutt","annulleret","скасовано","בוטל","đã huỷ","Kumottu","dibatalkan","vazgeçildi","anulat","anulowane","ακυρώθηκε","visszavonva"];for(let t=0;t<e.length;t+=1)this.m_errorMap.set(e[t],i.ErrorRequestCanceled);const t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexión de red se perdió","ネットワーク接続が切れました","La connexion réseau a été perdue","Сетевое соединение потеряно","網路連線中斷","การเชื่อมต่อกับเครือข่ายหายไป","Зʼєднання з мережею втрачено","网络连接已中断","Nätverksanslutningen förlorades","A conexão de rede foi perdida","Ağ bağlantısı kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione è stata persa","A ligação à rede foi interrompida","Mistet nettverksforbindelsen","La conexión de red se ha perdido","網絡連線中斷","Đã mất kết nối mạng","Kehilangan jaringan koneksi","تم فقدان اتصال الشبكة","無法連接伺服器","네트워크 연결이 유실되었습니다","Verkkoyhteys katkesi","Netværksforbindelsen gik tabt","Bylo ztraceno připojení k síti","Połączenie sieciowe zostało utracone","A conexão à internet parece estar desativada","The Internet connection appears to be offline","La conexión a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de rețea a fost pierdută","ネットワーク接続が切れました","החיבור לרשת אבד","NetworkError when attempting to fetch resource","无法连接服务器","No se ha podido establecer conexión con el servidor","Tidak dapat terhubung ke server","ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้","No se pudo establecer conexión con el servidor","A hálózati kapcsolat megszakadt"];for(let e=0;e<t.length;e+=1)this.m_errorMap.set(t[e],i.ErrorConnectionLost);const r=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operación. El software causó la anulación de la conexión","Không thể hoàn tất tác vụ. Phần mềm đã khiến kết nối bị hủy bỏ","تعذر إكمال العملية. ‏نتج عن البرنامج إيقاف الاتصال قبل اكتماله","Не удалось завершить операцию. Программа вызвала разрыв подключения","The operation couldn’t be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","L’opération n’a pas pu s’achever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operación. El software causó la anulación de la conexión","A operação não pôde ser concluída. O software provocou o cancelamento da conexão","No se ha podido completar la operación. El software ha causado la anulación de la conexión","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","未能完成该操作。软件导致连接中止","無法完成作業。軟體導致連線失敗","無法完成操作。軟件導致連線失敗","ไม่สามารถดำเนินการให้เสร็จสิ้นได้ ซอฟต์แวร์เป็นสาเหตุให้ยกเลิกการเชื่อมต่อ","操作を完了できませんでした。ソフトウェアにより接続が中止されました","Postupak se nije mogao dovršiti. Softver je uzrokovao prekid veze","Åtgärden kunde inte slutföras. Program orsakade avbrott i anslutningen","İşlem tamamlanamadı. Yazılım bağlantının kesilmesine neden oldu","Не вдалося завершити операцію. Програма обірвала звʼязок"];for(let e=0;e<r.length;e+=1)this.m_errorMap.set(r[e],i.ErrorSoftwareConnectionAbort);const s=["The request timed out","要求がタイムアウトになりました","La requête a expiré","要求がタイムアウトになりました","Se agotó el tiempo de espera","Esgotou-se o tempo limite da solicitação","请求超时"];for(let e=0;e<s.length;e+=1)this.m_errorMap.set(s[e],i.ErrorRequestTimeout);const o=["cannot parse response","impossible d’analyser la réponse","无法解析响应"];for(let e=0;e<o.length;e+=1)this.m_errorMap.set(o[e],i.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",i.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",i.ErrorFailedToFetch),this.m_errorMap.set(404,i.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,i.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,i.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,i.ErrorRequestFailedGatewayTimeout)}getMappedError(e){let t=e;return t=P.trimErrorName(t,["TypeError:","Loading failed:"]),t.indexOf("Bylo ztraceno")>=0?i.ErrorConnectionLost:t.indexOf("AbortError:")>=0?i.ErrorRequestAbort:this.m_errorMap.get(t)}static trimErrorName(e,t){let r=e;for(let e=0;e<t.length;e+=1)r.lastIndexOf(t[e])>=0&&(r=r.substring(r.lastIndexOf(t[e])+t[e].length));return r?r.trim():""}static convertServerError(e,t){return t&&e&&""!==e.trim()&&e!==d.unknown?`Server${e}`:i.ErrorRequestFailed}async parseMultipartResponseAsync(r,s,o){const n={},l={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0};let c={slideOrder:[],slideAllInfo:[]};if(s[d.firstResponseCheck]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},r.response&&r.response.body&&r.response.headers&&r.response.headers.get(d.ContentType)){const m=r.response;let f="";try{s[d.fetchBoundary]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},f=this.m_multipartParser.fetchBoundary(m.headers.get(d.ContentType)),s[d.fetchBoundary].end=P.performanceNowTrimmed()}catch(e){const t=m.headers.get(d.ErrorCode),s=m.headers.get(d.ErrorCategory),o=!!r[d.IsIntentional]&&r[d.IsIntentional],n=m.headers.get(d.XCorrelationId);return g.sendTraceTag(593253142,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ${m.headers.get(d.ContentType)}, ErrorCode:${t}, ErrorCategory:${s}, IsIntentional:${o} , Correlation:${n}, Exception:${e}`),l.responseErrorCode=t||i.ErrorRequestFailed,l.responseErrorCategory=s||a.BadRequest,l}const _=P.performanceNowTrimmed();s[d.downloadResponse]={start:_,end:_},g.sendTraceTag(561640520,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::parseMultipartResponse - download response stream start: ${_}`),o&&o.requestType===e.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:o.requestType,stageInfo:t.DownloadResponseStream});let S,C,E=!1,w=null;const v=m.headers?m.headers.get(d.ContentLength):-1;let T=-1;if(g.sendTraceTag(545063708,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: ${this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength}`),this.m_settings.parsingWhileDownloadingEnabled){let r=!1,S=!1;const C=n=>{r=!0,S=n;const i={receivedDataLength:T,responseContentLength:v,duration:P.performanceNowTrimmed()-_,downloadFailed:S};g.sendTraceTag(529331328,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy - return from response stream reading. ${JSON.stringify(i)}`);const a=P.performanceNowTrimmed();g.sendTraceTag(529331329,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${a}, duration: ${a-_}`),s[d.downloadResponse].end=a,s[d.downloadResponse].length=T,!E&&o&&o.requestType===e.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:o.requestType,stageInfo:t.ParseMultipartResponse})};T=0;const w=m.body,[R,O]=w.tee(),b=new Promise((async e=>{try{const t=I.readNumberOrDefault("hackMaxBytes",-1),r=R.getReader();for(;;){const{done:s,value:o}=await r.read();if(s){C(!1),e();break}if(o&&(T+=o.length,t>0&&T>t))throw"hackMaxBytes hit"}}catch(t){g.sendTraceTag(528766114,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::measuringDownloadPromise - exception ${t}.`),C(!0),e()}}));let x;if(o&&o.shouldTimeoutResponseStreamDownload){const e=o&&o.overrideDownloadTimeoutMs?o.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4;x=window.setTimeout((()=>{r||(E=!0,g.sendTraceTag(529331330,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),g.sendTraceTag(529331331,p.msoulscat_Wac_PptSession,u.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),R.cancel(),O.cancel())}),e)}const M=new y(this.m_settings,n,s,l),W=this.m_multipartParser.processMultipartBinaryResponse(O.getReader(),f,(e=>{M.parsePart(e)}));if(await Promise.all([b,W]),S)return h.ChangeGate.isChangeGateEnabled("retryOnNetworkFailure")&&(l.responseErrorCode=i.ErrorRequestFailed,l.responseErrorCategory=a.Transient),l.data=void 0,l;if(o&&o.shouldTimeoutResponseStreamDownload&&(clearTimeout(x),g.sendTraceTag(529331332,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy - response download check. ${JSON.stringify({hasTimeout:E,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:T,responseContentLength:v})}`)),E){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&v>0&&T>0&&v===T))return l.responseErrorCode=i.ErrorDownloadResponseStreamTimeout,l;g.sendTraceTag(529331333,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}c=M.parsedResponse}else{if(o&&o.shouldTimeoutResponseStreamDownload){const e=o&&o.overrideDownloadTimeoutMs?o.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,t="downloadResponseStreamTimeout";let r;const s=new Promise((s=>{S=setTimeout((()=>{g.sendTraceTag(560347103,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),r&&(g.sendTraceTag(558465244,p.msoulscat_Wac_PptSession,u.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),r.cancel()),s(t)}),e)}));r=m.body.getReader(),w=this.readResponseStream(r,v),w.then((e=>{T=e&&e.length||-1;const t={receivedDataLength:T,responseContentLength:v,duration:P.performanceNowTrimmed()-_};g.sendTraceTag(558465177,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy - return from response stream reading. ${JSON.stringify(t)}`)})),C=await Promise.race([w,s]),C===t?E=!0:void 0!==S&&clearTimeout(S)}else{C=new Uint8Array(await m.arrayBuffer());const e=I.readNumberOrDefault("hackMaxBytes",-1);e>0&&C.length>e&&(C=C.slice(0,e))}if(o&&o.shouldTimeoutResponseStreamDownload&&g.sendTraceTag(543019648,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy - response download check. ${JSON.stringify({hasTimeout:E,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:T,responseContentLength:v})}`),E){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&w&&v>0&&T>0&&v===T))return l.responseErrorCode=i.ErrorDownloadResponseStreamTimeout,l;g.sendTraceTag(558465245,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),C=await w}const r=P.performanceNowTrimmed();g.sendTraceTag(561640521,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${r}, duration: ${r-_}`);const a=C;s[d.downloadResponse].end=r,a&&a.length&&(s[d.downloadResponse].length=a.length),o&&o.requestType===e.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:o.requestType,stageInfo:t.ParseMultipartResponse});const h=new y(this.m_settings,n,s,l);await this.m_multipartParser.processMultipartBinaryResponse(a,f,(e=>{h.parsePart(e)})),c=h.parsedResponse}}else{const e=r.hasOwnProperty(d.errorCode)&&r[d.errorCode]!==i.ErrorRESERVEDSuccess?r[d.errorCode]:i.ErrorRequestFailed,t=r[d.errorCategory]?r[d.errorCategory]:a.BadRequest,s=!!r[d.IsIntentional]&&r[d.IsIntentional];l.responseErrorCode=e,l.responseErrorCategory=t,g.sendTraceTag(593253143,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - responseErrorCode:${e}, responseErrorCategory:${t}, IsIntentional:${s}`)}s[d.firstResponseCheck].end=P.performanceNowTrimmed(),l.responseErrorCode!==i.ErrorRESERVEDSuccess&&l.responseErrorCategory===a.ErrorRESERVEDSuccess&&(l.responseErrorCategory=a.BadRequest,g.sendTraceTag(593253145,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:${l.responseErrorCode}`));for(const e in n)c.slideAllInfo.push({ID:n[e].ID,SlideImageData:n[e].SlideImageData,SlideShowInfo:n[e].SlideShowInfo,Title:n[e].Title,NoteHtml:n[e].NoteHtml,Comments:n[e].Comments,HasAnimation:n[e].HasAnimation,Hidden:n[e].Hidden,HasTransition:n[e].HasTransition,ResourceData:n[e].ResourceData,AccessibilityModel:n[e].AccessibilityModel,MediaUrls:n[e].MediaUrls});try{if(I.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(l.itemErrorCodeMap&&Object.values(l.itemErrorCodeMap).includes(i.ServerErrorFileDownloadResourceInconsistent)||l.newSnapUrl)){if(l.newSnapUrl)return 0===l.itemErrorCodeMap.size&&g.sendTraceTag(509875215,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:got new snap url without errorcode"),g.sendTraceTag(510251348,p.msoulscat_Wac_PptSession,u.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",l.newSnapUrl),l;g.sendTraceTag(510251347,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){g.sendTraceTag(510251346,p.msoulscat_Wac_PptSession,u.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return l.data=c,l}async readResponseStream(e,t){let r=new Uint8Array(0);try{let s=await e.read();for(;!s.done;){r=new Uint8Array([...r,...s.value]);const o=I.readNumberOrDefault("hackMaxBytes",-1);if(o>0&&r.length>o)throw r=r.slice(0,o),"hackMaxBytes hit";if(t>0&&r.length===t&&(g.sendTraceTag(545063709,p.msoulscat_Wac_PptSession,u.Info,`PodsProxy::readResponseStream - received length reached content length: ${t}`),this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength))break;s=await e.read()}}catch(e){return g.sendTraceTag(558465246,p.msoulscat_Wac_PptSession,u.Error,`PodsProxy::readResponseStream - exception ${e}.`),new Uint8Array(0)}return r}generateReportPerfDictionary(e){const t={};return e[d.action]&&(t[d.action]=e[d.action]),e[d.correlationId]&&(t[d.correlationId]=e[d.correlationId]),e[d.server]&&(t[d.server]=e[d.server]),e[d.parser]&&(t[d.parser]=e[d.parser]),e[d.downloadResponse]&&(t[d.downloadResponse]=e[d.downloadResponse]),e[d.usedOutputCache]&&(t[d.usedOutputCache]=e[d.usedOutputCache]),e[d.contentLength]&&(t[d.contentLength]=e[d.contentLength]),t}createPresInfoAndSlideInfoResponse(e,t){let r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0,slideInfo:[]};return t[d.createResponse]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap},t[d.createResponse].end=P.performanceNowTrimmed(),r}async createSlideInfoResponse(e,t){let r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]};return t[d.createResponse]={start:P.performanceNowTrimmed(),end:P.performanceNowTrimmed()},await e.then((e=>{r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}})),t[d.createResponse].end=P.performanceNowTrimmed(),r}async createSlideIdResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]};return await e.then((e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}})),t}async createPresInfoResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:i.ErrorRESERVEDSuccess,responseErrorCategory:a.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0};return await e.then((e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}})),t}static logPerf(e){}static ensureISlideInfoFilters(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}static performanceNowTrimmed(){return Math.round(performance.now())}async createSlideOrderAndSlidesInfoIndexResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:a.ErrorRESERVEDSuccess,responseErrorCode:i.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]};return await e.then((e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}})),t}static logPerformanceEntries(e,t){const r=e.getEntriesByType("resource"),s={};for(const e of r){const r=e;if("fetch"!==r.initiatorType)continue;let o=!1;for(const e of t)if(r.name.indexOf(e)>0||r.name.startsWith(e)){o=!0;break}if(o){if(s.name=r.name,s.dateTime=performance.now(),h.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){const e=new URL(r.name);s.hostname=e.hostname,s.pathname=e.pathname}s.start=r.startTime,s.redirectStart=r.redirectStart,s.redirectEnd=r.redirectEnd,s.domainLookupStart=r.domainLookupStart,s.domainLookupEnd=r.domainLookupEnd,s.tcpHandshakeStart=r.connectStart,s.tcpHandshakeEnd=r.connectEnd,s.secureConnectionStart=r.secureConnectionStart,s.responseStart=r.responseStart,s.responseEnd=r.responseEnd,s.fetchStart=r.fetchStart,s.requestStart=r.requestStart,"decodedBodySize"in r&&(s.decodedBodySize=r.decodedBodySize),"encodedBodySize"in r&&(s.encodedBodySize=r.encodedBodySize),"transferSize"in r&&(s.transferSize=r.transferSize),Object.keys(s).length>0&&g.sendTraceTag(572379986,p.msoulscat_Wac_PptSession,u.Info,`${JSON.stringify(s)}`)}}}setTimeoutForParsingResponse(e){return window.setTimeout((()=>{g.sendTraceTag(571342915,p.msoulscat_Wac_PptSession,u.Warning,`Parsing didn't finish in the time. ${JSON.stringify(e)}`)}),this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}objectDictionaryToRequestIdString(e){let t="";for(const r in e)e[r]&&(t=`${t}${r}=${e[r]};`);return t}}P.s_events=new _.EventEmitter,P.s_supportedImageType=[c.ImagePng,c.ImageJpg]})(),s})()));